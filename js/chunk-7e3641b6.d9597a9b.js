(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7e3641b6"],{"1ccd":function(a,e,t){"use strict";t("c08c")},c08c:function(a,e,t){},e48a:function(a,e,t){"use strict";t.r(e);var r=function(){var a=this,e=a._self._c;return e("el-dialog",{attrs:{visible:a.visible,title:a.dataForm.id?a.$t("update"):a.$t("add"),"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":a.handleClose},on:{"update:visible":function(e){a.visible=e},opened:a.handleDialogOpenChange}},[e("el-form",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],ref:"dataForm",attrs:{model:a.dataForm,rules:a.rules,"label-width":(a.$i18n.locale,"120px")},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&a._k(e.keyCode,"enter",13,e.key,"Enter")?null:a.dataFormSubmitHandle()}}},[e("el-row",[e("el-col",{attrs:{span:12}},[a.dataForm.id?a._e():e("el-form-item",{attrs:{label:a.$t("channelInfo.chlname"),prop:"chlname",inline:""}},[e("tooltip",{attrs:{placement:"top-left",mode:"manual",visible:a.tooltipChannelvisible}},[e("div",{attrs:{slot:"outlet"},slot:"outlet"}),e("div",{attrs:{slot:"tooltip"},slot:"tooltip"},[a._v(a._s(a.$t("channelInfo.addChlName")))])]),e("el-input",{ref:"chlname",attrs:{placeholder:a.$t("channelInfo.chlname"),maxlength:48,clearable:""},model:{value:a.dataForm.chlname,callback:function(e){a.$set(a.dataForm,"chlname","string"===typeof e?e.trim():e)},expression:"dataForm.chlname"}})],1),a.dataForm.id?e("el-form-item",{attrs:{label:a.$t("channelInfo.chlname"),prop:"chlname",inline:""}},[e("el-input",{ref:"chlname",attrs:{placeholder:a.$t("channelInfo.chlname"),maxlength:48,clearable:""},model:{value:a.dataForm.chlname,callback:function(e){a.$set(a.dataForm,"chlname","string"===typeof e?e.trim():e)},expression:"dataForm.chlname"}})],1):a._e()],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:a.$t("channelInfo.chlcomment"),prop:"chlcomment",inline:""}},[e("el-input",{attrs:{placeholder:a.$t("channelInfo.chlcomment"),maxlength:24,clearable:""},model:{value:a.dataForm.chlcomment,callback:function(e){a.$set(a.dataForm,"chlcomment",e)},expression:"dataForm.chlcomment"}})],1)],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:a.$t("channelInfo.chladdr"),prop:"chladdr"}},[e("el-input",{attrs:{placeholder:a.$t("channelInfo.chladdr"),maxlength:10,clearable:""},model:{value:a.dataForm.chladdr,callback:function(e){a.$set(a.dataForm,"chladdr",e)},expression:"dataForm.chladdr"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:a.$t("channelInfo.chltype"),prop:"chltype"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:a.$t("channelInfo.pleaseSelect"),disabled:""},model:{value:a.dataForm.chltype,callback:function(e){a.$set(a.dataForm,"chltype",e)},expression:"dataForm.chltype"}},a._l(a.chltype,(function(a){return e("el-option",{key:a.value,attrs:{label:a.label,value:a.value}})})),1)],1)],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:a.$t("channelInfo.chlcoltfrq"),prop:"chlcoltfrq"}},[e("el-input",{attrs:{placeholder:a.$t("channelInfo.chlcoltfrq"),maxlength:10,clearable:""},model:{value:a.dataForm.chlcoltfrq,callback:function(e){a.$set(a.dataForm,"chlcoltfrq",e)},expression:"dataForm.chlcoltfrq"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:a.$t("channelInfo.chlcoltfrmstopms"),prop:"chlcoltfrmstopms"}},[e("el-input",{attrs:{placeholder:a.$t("channelInfo.chlcoltfrmstopms"),maxlength:10,clearable:""},model:{value:a.dataForm.chlcoltfrmstopms,callback:function(e){a.$set(a.dataForm,"chlcoltfrmstopms",e)},expression:"dataForm.chlcoltfrmstopms"}})],1)],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:a.$t("channelInfo.chlprotocol"),prop:"chlprotocol"}},[e("el-cascader",{key:a.refreshItem,attrs:{options:a.options,"show-all-levels":!1,filterable:"","filter-method":a.dataFilter},on:{change:a.handleChlpro},model:{value:a.dataForm.chlprotocol,callback:function(e){a.$set(a.dataForm,"chlprotocol",e)},expression:"dataForm.chlprotocol"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:a.$t("channelInfo.protocoltype"),prop:"protocoltype"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:a.$t("channelInfo.pleaseSelect")},on:{change:a.selectProtocolType},model:{value:a.dataForm.protocoltype,callback:function(e){a.$set(a.dataForm,"protocoltype",e)},expression:"dataForm.protocoltype"}},a._l(a.protocolType,(function(a){return e("el-option",{key:a.value,attrs:{label:a.label,value:a.value}})})),1)],1)],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:a.$t("channelInfo.channelValid"),prop:"valid"}},[e("el-radio-group",{model:{value:a.dataForm.valid,callback:function(e){a.$set(a.dataForm,"valid",e)},expression:"dataForm.valid"}},[e("el-radio",{attrs:{label:0}},[a._v(a._s(a.$t("yes")))]),e("el-radio",{attrs:{label:2}},[a._v(a._s(a.$t("no")))])],1)],1)],1)],1),e("el-form-item",{attrs:{label:a.$t("channelInfo.mainParams")}}),e("div",[e("el-row",[e("el-col",{attrs:{span:12}},[0===a.dataForm.protocoltype?e("el-form-item",{attrs:{label:a.$t("channelInfo.role"),prop:"chlmasterparam.role"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:a.$t("channelInfo.pleaseSelect")},model:{value:a.dataForm.chlmasterparam.role,callback:function(e){a.$set(a.dataForm.chlmasterparam,"role",e)},expression:"dataForm.chlmasterparam.role"}},a._l(a.roleList,(function(a){return e("el-option",{key:a.value,attrs:{label:a.label,value:a.value}})})),1)],1):a._e()],1),e("el-col",{attrs:{span:12}},[0===a.dataForm.protocoltype?e("el-form-item",{attrs:{label:a.$t("channelInfo.reserve0"),prop:"chlmasterparam.reserve0"}},[e("el-input",{attrs:{placeholder:a.$t("attribute.canEmpet"),maxlength:64,clearable:""},model:{value:a.dataForm.chlmasterparam.reserve0,callback:function(e){a.$set(a.dataForm.chlmasterparam,"reserve0",e)},expression:"dataForm.chlmasterparam.reserve0"}})],1):a._e()],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[0===a.dataForm.protocoltype?e("el-form-item",{attrs:{label:a.$t("channelInfo.ip_addr"),prop:"chlmasterparam.ip_addr"}},[e("el-input",{attrs:{placeholder:a.$t("channelInfo.ip_addr"),clearable:""},model:{value:a.dataForm.chlmasterparam.ip_addr,callback:function(e){a.$set(a.dataForm.chlmasterparam,"ip_addr",e)},expression:"dataForm.chlmasterparam.ip_addr"}})],1):a._e()],1),e("el-col",{attrs:{span:12}},[0===a.dataForm.protocoltype?e("el-form-item",{attrs:{label:a.$t("channelInfo.reserve1"),prop:"chlmasterparam.reserve1"}},[e("el-input",{attrs:{placeholder:a.$t("attribute.canEmpet"),maxlength:64,clearable:""},model:{value:a.dataForm.chlmasterparam.reserve1,callback:function(e){a.$set(a.dataForm.chlmasterparam,"reserve1",e)},expression:"dataForm.chlmasterparam.reserve1"}})],1):a._e()],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[0===a.dataForm.protocoltype?e("el-form-item",{attrs:{label:a.$t("channelInfo.port"),prop:"chlmasterparam.port"}},[e("el-input",{attrs:{placeholder:a.$t("channelInfo.port"),maxLength:8,clearable:""},model:{value:a.dataForm.chlmasterparam.port,callback:function(e){a.$set(a.dataForm.chlmasterparam,"port",e)},expression:"dataForm.chlmasterparam.port"}})],1):a._e()],1),e("el-col",{attrs:{span:12}},[0===a.dataForm.protocoltype?e("el-form-item",{attrs:{label:a.$t("channelInfo.reserve2"),prop:"chlmasterparam.reserve2"}},[e("el-input",{attrs:{placeholder:a.$t("attribute.canEmpet"),maxlength:64,clearable:""},model:{value:a.dataForm.chlmasterparam.reserve2,callback:function(e){a.$set(a.dataForm.chlmasterparam,"reserve2",e)},expression:"dataForm.chlmasterparam.reserve2"}})],1):a._e()],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[0===a.dataForm.protocoltype?e("el-form-item",{attrs:{label:a.$t("channelInfo.timeout"),prop:"chlmasterparam.timeout"}},[e("el-input",{attrs:{placeholder:a.$t("channelInfo.timeout"),maxlength:10,clearable:""},model:{value:a.dataForm.chlmasterparam.timeout,callback:function(e){a.$set(a.dataForm.chlmasterparam,"timeout",e)},expression:"dataForm.chlmasterparam.timeout"}})],1):a._e()],1),e("el-col",{attrs:{span:12}},[0===a.dataForm.protocoltype?e("el-form-item",{attrs:{label:a.$t("channelInfo.reserve3"),prop:"chlmasterparam.reserve3"}},[e("el-input",{attrs:{placeholder:a.$t("attribute.canEmpet"),maxlength:64,clearable:""},model:{value:a.dataForm.chlmasterparam.reserve3,callback:function(e){a.$set(a.dataForm.chlmasterparam,"reserve3",e)},expression:"dataForm.chlmasterparam.reserve3"}})],1):a._e()],1)],1)],1),e("div",[e("el-row",[e("el-col",{attrs:{span:12}},[1===a.dataForm.protocoltype||3===a.dataForm.protocoltype?e("el-form-item",{attrs:{label:a.$t("channelInfo.com_name"),prop:"chlmasterparam.com_name"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:a.$t("channelInfo.pleaseSelect")},model:{value:a.dataForm.chlmasterparam.com_name,callback:function(e){a.$set(a.dataForm.chlmasterparam,"com_name",e)},expression:"dataForm.chlmasterparam.com_name"}},a._l(a.com_nameList,(function(a){return e("el-option",{key:a.value,attrs:{label:a.label,value:a.value}})})),1)],1):a._e()],1),e("el-col",{attrs:{span:12}},[1===a.dataForm.protocoltype||3===a.dataForm.protocoltype?e("el-form-item",{attrs:{label:a.$t("channelInfo.baud"),prop:"chlmasterparam.baud"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:a.$t("channelInfo.pleaseSelect")},model:{value:a.dataForm.chlmasterparam.baud,callback:function(e){a.$set(a.dataForm.chlmasterparam,"baud",e)},expression:"dataForm.chlmasterparam.baud"}},a._l(a.baudList,(function(a){return e("el-option",{key:a.value,attrs:{label:a.label,value:a.value}})})),1)],1):a._e()],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[1===a.dataForm.protocoltype||3===a.dataForm.protocoltype?e("el-form-item",{attrs:{label:a.$t("channelInfo.data_bit"),prop:"chlmasterparam.data_bit"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:a.$t("channelInfo.pleaseSelect")},model:{value:a.dataForm.chlmasterparam.data_bit,callback:function(e){a.$set(a.dataForm.chlmasterparam,"data_bit",e)},expression:"dataForm.chlmasterparam.data_bit"}},a._l(a.data_bitList,(function(a){return e("el-option",{key:a.value,attrs:{label:a.label,value:a.value}})})),1)],1):a._e()],1),e("el-col",{attrs:{span:12}},[1===a.dataForm.protocoltype||3===a.dataForm.protocoltype?e("el-form-item",{attrs:{label:a.$t("channelInfo.stop_bit"),prop:"chlmasterparam.stop_bit"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:a.$t("channelInfo.pleaseSelect")},model:{value:a.dataForm.chlmasterparam.stop_bit,callback:function(e){a.$set(a.dataForm.chlmasterparam,"stop_bit",e)},expression:"dataForm.chlmasterparam.stop_bit"}},a._l(a.stopbitList,(function(a){return e("el-option",{key:a.value,attrs:{label:a.label,value:a.value}})})),1)],1):a._e()],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[1===a.dataForm.protocoltype||3===a.dataForm.protocoltype?e("el-form-item",{attrs:{label:a.$t("channelInfo.check_bit"),prop:"chlmasterparam.check_bit"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:a.$t("channelInfo.pleaseSelect")},model:{value:a.dataForm.chlmasterparam.check_bit,callback:function(e){a.$set(a.dataForm.chlmasterparam,"check_bit",e)},expression:"dataForm.chlmasterparam.check_bit"}},a._l(a.checkbitList,(function(a){return e("el-option",{key:a.value,attrs:{label:a.label,value:a.value}})})),1)],1):a._e()],1),e("el-col",{attrs:{span:12}},[1===a.dataForm.protocoltype||3===a.dataForm.protocoltype?e("el-form-item",{attrs:{label:a.$t("channelInfo.reserve0")}},[e("el-input",{attrs:{placeholder:a.$t("attribute.canEmpet"),maxlength:64,clearable:""},model:{value:a.dataForm.chlmasterparam.reserve0,callback:function(e){a.$set(a.dataForm.chlmasterparam,"reserve0",e)},expression:"dataForm.chlmasterparam.reserve0"}})],1):a._e()],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[1===a.dataForm.protocoltype||3===a.dataForm.protocoltype?e("el-form-item",{attrs:{label:a.$t("channelInfo.timeout"),prop:"chlmasterparam.timeout"}},[e("el-input",{attrs:{placeholder:a.$t("channelInfo.timeout"),maxlength:10,clearable:""},model:{value:a.dataForm.chlmasterparam.timeout,callback:function(e){a.$set(a.dataForm.chlmasterparam,"timeout",e)},expression:"dataForm.chlmasterparam.timeout"}})],1):a._e()],1),e("el-col",{attrs:{span:12}},[1===a.dataForm.protocoltype||3===a.dataForm.protocoltype?e("el-form-item",{attrs:{label:a.$t("channelInfo.reserve1")}},[e("el-input",{attrs:{placeholder:a.$t("attribute.canEmpet"),maxlength:64,clearable:""},model:{value:a.dataForm.chlmasterparam.reserve1,callback:function(e){a.$set(a.dataForm.chlmasterparam,"reserve1",e)},expression:"dataForm.chlmasterparam.reserve1"}})],1):a._e()],1)],1)],1),e("el-form-item",{attrs:{label:a.$t("channelInfo.minChannel"),prop:"enablebackupchl"}},[e("el-button-group",[e("el-button",{attrs:{size:"small",type:1===a.dataForm.enablebackupchl?"primary":"default",autofocus:1===a.dataForm.enablebackupchl},on:{click:function(e){return a.openBackup()}}},[a._v(a._s(a.$t("channelInfo.open"))+" ")]),e("el-button",{attrs:{size:"small",type:0===a.dataForm.enablebackupchl?"primary":"default",autofocus:0===a.dataForm.enablebackupchl},on:{click:function(e){return a.closeBackup()}}},[a._v(a._s(a.$t("channelInfo.close"))+" ")])],1)],1),1===a.dataForm.enablebackupchl?e("el-form-item",{attrs:{label:a.$t("channelInfo.minorParams")}}):a._e(),[e("el-row",[e("el-col",{attrs:{span:12}},[1===a.dataForm.enablebackupchl&&0===a.dataForm.protocoltype?e("el-form-item",{attrs:{label:a.$t("channelInfo.reserve0"),prop:"chlbackupparam.reserve0"}},[e("el-input",{attrs:{placeholder:a.$t("attribute.canEmpet"),maxlength:64,clearable:""},model:{value:a.dataForm.chlbackupparam.reserve0,callback:function(e){a.$set(a.dataForm.chlbackupparam,"reserve0",e)},expression:"dataForm.chlbackupparam.reserve0"}})],1):a._e()],1),e("el-col",{attrs:{span:12}},[1===a.dataForm.enablebackupchl&&0===a.dataForm.protocoltype?e("el-form-item",{attrs:{label:a.$t("channelInfo.ip_addr"),prop:"chlbackupparam.ip_addr"}},[e("el-input",{attrs:{placeholder:a.$t("channelInfo.ip_addr"),clearable:""},model:{value:a.dataForm.chlbackupparam.ip_addr,callback:function(e){a.$set(a.dataForm.chlbackupparam,"ip_addr",e)},expression:"dataForm.chlbackupparam.ip_addr"}})],1):a._e()],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[1===a.dataForm.enablebackupchl&&0===a.dataForm.protocoltype?e("el-form-item",{attrs:{label:a.$t("channelInfo.reserve1"),prop:"chlbackupparam.reserve1"}},[e("el-input",{attrs:{placeholder:a.$t("attribute.canEmpet"),maxlength:64,clearable:""},model:{value:a.dataForm.chlbackupparam.reserve1,callback:function(e){a.$set(a.dataForm.chlbackupparam,"reserve1",e)},expression:"dataForm.chlbackupparam.reserve1"}})],1):a._e()],1),e("el-col",{attrs:{span:12}},[1===a.dataForm.enablebackupchl&&0===a.dataForm.protocoltype?e("el-form-item",{attrs:{label:a.$t("channelInfo.port"),prop:"chlbackupparam.port"}},[e("el-input",{attrs:{placeholder:a.$t("channelInfo.port"),maxLength:8,clearable:""},model:{value:a.dataForm.chlbackupparam.port,callback:function(e){a.$set(a.dataForm.chlbackupparam,"port",e)},expression:"dataForm.chlbackupparam.port"}})],1):a._e()],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[1===a.dataForm.enablebackupchl&&0===a.dataForm.protocoltype?e("el-form-item",{attrs:{label:a.$t("channelInfo.reserve2"),prop:"chlbackupparam.reserve2"}},[e("el-input",{attrs:{placeholder:a.$t("attribute.canEmpet"),maxlength:64,clearable:""},model:{value:a.dataForm.chlbackupparam.reserve2,callback:function(e){a.$set(a.dataForm.chlbackupparam,"reserve2",e)},expression:"dataForm.chlbackupparam.reserve2"}})],1):a._e()],1),e("el-col",{attrs:{span:12}},[1===a.dataForm.enablebackupchl&&0===a.dataForm.protocoltype?e("el-form-item",{attrs:{label:a.$t("channelInfo.timeout"),prop:"chlbackupparam.timeout"}},[e("el-input",{attrs:{placeholder:a.$t("channelInfo.timeout"),maxlength:10,clearable:""},model:{value:a.dataForm.chlbackupparam.timeout,callback:function(e){a.$set(a.dataForm.chlbackupparam,"timeout",e)},expression:"dataForm.chlbackupparam.timeout"}})],1):a._e()],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[1===a.dataForm.enablebackupchl&&0===a.dataForm.protocoltype?e("el-form-item",{attrs:{label:a.$t("channelInfo.reserve3"),prop:"chlbackupparam.reserve3"}},[e("el-input",{attrs:{placeholder:a.$t("attribute.canEmpet"),maxlength:64,clearable:""},model:{value:a.dataForm.chlbackupparam.reserve3,callback:function(e){a.$set(a.dataForm.chlbackupparam,"reserve3",e)},expression:"dataForm.chlbackupparam.reserve3"}})],1):a._e()],1)],1)],e("div",[[e("el-row",[e("el-col",{attrs:{span:12}},[1!==a.dataForm.enablebackupchl||1!==a.dataForm.protocoltype&&3!==a.dataForm.protocoltype?a._e():e("el-form-item",{attrs:{label:a.$t("channelInfo.com_name"),prop:"chlbackupparam.com_name"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:a.$t("channelInfo.pleaseSelect")},model:{value:a.dataForm.chlbackupparam.com_name,callback:function(e){a.$set(a.dataForm.chlbackupparam,"com_name",e)},expression:"dataForm.chlbackupparam.com_name"}},a._l(a.com_nameList,(function(a){return e("el-option",{key:a.value,attrs:{label:a.label,value:a.value}})})),1)],1)],1),e("el-col",{attrs:{span:12}},[1!==a.dataForm.enablebackupchl||1!==a.dataForm.protocoltype&&3!==a.dataForm.protocoltype?a._e():e("el-form-item",{attrs:{label:a.$t("channelInfo.baud"),prop:"chlbackupparam.baud"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:a.$t("channelInfo.pleaseSelect")},model:{value:a.dataForm.chlbackupparam.baud,callback:function(e){a.$set(a.dataForm.chlbackupparam,"baud",e)},expression:"dataForm.chlbackupparam.baud"}},a._l(a.baudList,(function(a){return e("el-option",{key:a.value,attrs:{label:a.label,value:a.value}})})),1)],1)],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[1!==a.dataForm.enablebackupchl||1!==a.dataForm.protocoltype&&3!==a.dataForm.protocoltype?a._e():e("el-form-item",{attrs:{label:a.$t("channelInfo.data_bit"),prop:"chlbackupparam.data_bit"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:a.$t("channelInfo.pleaseSelect")},model:{value:a.dataForm.chlbackupparam.data_bit,callback:function(e){a.$set(a.dataForm.chlbackupparam,"data_bit",e)},expression:"dataForm.chlbackupparam.data_bit"}},a._l(a.data_bitList,(function(a){return e("el-option",{key:a.value,attrs:{label:a.label,value:a.value}})})),1)],1)],1),e("el-col",{attrs:{span:12}},[1!==a.dataForm.enablebackupchl||1!==a.dataForm.protocoltype&&3!==a.dataForm.protocoltype?a._e():e("el-form-item",{attrs:{label:a.$t("channelInfo.stop_bit"),prop:"chlbackupparam.stop_bit"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:a.$t("channelInfo.pleaseSelect")},model:{value:a.dataForm.chlbackupparam.stop_bit,callback:function(e){a.$set(a.dataForm.chlbackupparam,"stop_bit",e)},expression:"dataForm.chlbackupparam.stop_bit"}},a._l(a.stopbitList,(function(a){return e("el-option",{key:a.value,attrs:{label:a.label,value:a.value}})})),1)],1)],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[1!==a.dataForm.enablebackupchl||1!==a.dataForm.protocoltype&&3!==a.dataForm.protocoltype?a._e():e("el-form-item",{attrs:{label:a.$t("channelInfo.check_bit"),prop:"chlbackupparam.check_bit"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:a.$t("channelInfo.pleaseSelect")},model:{value:a.dataForm.chlbackupparam.check_bit,callback:function(e){a.$set(a.dataForm.chlbackupparam,"check_bit",e)},expression:"dataForm.chlbackupparam.check_bit"}},a._l(a.checkbitList,(function(a){return e("el-option",{key:a.value,attrs:{label:a.label,value:a.value}})})),1)],1)],1),e("el-col",{attrs:{span:12}},[1!==a.dataForm.enablebackupchl||1!==a.dataForm.protocoltype&&3!==a.dataForm.protocoltype?a._e():e("el-form-item",{attrs:{label:a.$t("channelInfo.reserve0")}},[e("el-input",{attrs:{placeholder:a.$t("attribute.canEmpet"),maxlength:64,clearable:""},model:{value:a.dataForm.chlbackupparam.reserve0,callback:function(e){a.$set(a.dataForm.chlbackupparam,"reserve0",e)},expression:"dataForm.chlbackupparam.reserve0"}})],1)],1)],1),e("el-row",[e("el-col",{attrs:{span:12}},[1!==a.dataForm.enablebackupchl||1!==a.dataForm.protocoltype&&3!==a.dataForm.protocoltype?a._e():e("el-form-item",{attrs:{label:a.$t("channelInfo.timeout"),prop:"chlbackupparam.timeout"}},[e("el-input",{attrs:{placeholder:a.$t("channelInfo.timeout"),maxlength:10,clearable:""},model:{value:a.dataForm.chlbackupparam.timeout,callback:function(e){a.$set(a.dataForm.chlbackupparam,"timeout",e)},expression:"dataForm.chlbackupparam.timeout"}})],1)],1),e("el-col",{attrs:{span:12}},[1!==a.dataForm.enablebackupchl||1!==a.dataForm.protocoltype&&3!==a.dataForm.protocoltype?a._e():e("el-form-item",{attrs:{label:a.$t("channelInfo.reserve1")}},[e("el-input",{attrs:{placeholder:a.$t("attribute.canEmpet"),maxlength:64,clearable:""},model:{value:a.dataForm.chlbackupparam.reserve1,callback:function(e){a.$set(a.dataForm.chlbackupparam,"reserve1",e)},expression:"dataForm.chlbackupparam.reserve1"}})],1)],1)],1)]],2)],2),e("template",{slot:"footer"},[e("el-button",{on:{click:function(e){return a.handleClose()}}},[a._v(a._s(a.$t("cancel")))]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return a.dataFormSubmitHandle()}}},[a._v(a._s(a.$t("confirm")))])],1)],2)},l=[],o=(t("8e6e"),t("456d"),t("ac4d"),t("8a81"),t("5df3"),t("1c4c"),t("6b54"),t("28a5"),t("c5f6"),t("ade3")),c=(t("ac6a"),t("7f7f"),t("96cf"),t("1da1")),m=(t("3b2b"),t("4917"),t("a481"),t("2ef0"),t("b047")),s=t.n(m);function n(a,e){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),t.push.apply(t,r)}return t}function p(a){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?n(Object(t),!0).forEach((function(e){Object(o["a"])(a,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):n(Object(t)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(t,e))}))}return a}function i(a,e){var t="undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(!t){if(Array.isArray(a)||(t=d(a))||e&&a&&"number"==typeof a.length){t&&(a=t);var r=0,l=function(){};return{s:l,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(a){throw a},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,m=!1;return{s:function(){t=t.call(a)},n:function(){var a=t.next();return c=a.done,a},e:function(a){m=!0,o=a},f:function(){try{c||null==t.return||t.return()}finally{if(m)throw o}}}}function d(a,e){if(a){if("string"==typeof a)return h(a,e);var t={}.toString.call(a).slice(8,-1);return"Object"===t&&a.constructor&&(t=a.constructor.name),"Map"===t||"Set"===t?Array.from(a):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?h(a,e):void 0}}function h(a,e){(null==e||e>a.length)&&(e=a.length);for(var t=0,r=Array(e);t<e;t++)r[t]=a[t];return r}var u={data:function(){var a=this;return{refreshItem:0,chlprotocolName:"",selectedProtocoltype:null,tooltipChannelvisible:!0,id:"",comNumber:0,visible:!1,loading:!1,defaultcfg:{},paramsData:[],dataForm:{id:"",chlname:this.$t("channelInfo.defaultChlname"),chlcomment:"",chladdr:"1",chltype:0,chlcoltfrq:"500",chlcoltfrmstopms:"300",chlprotocol:[],protocoltype:null,enablebackupchl:0,valid:0,chlmasterparam:{role:0,reserve0:"",ip_addr:"",reserve1:"",port:"",reserve2:"",reserve3:"",com_name:"",baud:null,stop_bit:null,data_bit:null,check_bit:null,timeout:1200},chlbackupparam:{role:0,reserve0:"",ip_addr:"",reserve1:"",port:"",reserve2:"",reserve3:"",com_name:"",baud:null,stop_bit:null,data_bit:null,check_bit:null,timeout:1200},gwsn:""},chltype:[{label:this.$t("channelInfo.collectChannel"),value:0},{label:this.$t("channelInfo.transChannel"),value:1}],protocolType:[{label:"TCP/IP",value:0},{label:this.$t("channelInfo.com"),value:1},{label:"CAN",value:3}],options:[],roleList:[{label:this.$t("channelInfo.initiative"),value:0},{label:this.$t("channelInfo.waitiative"),value:1}],stopbitList:[{label:1,value:1},{label:2,value:2}],data_bitList:[{label:5,value:5},{label:6,value:6},{label:7,value:7},{label:8,value:8}],checkbitList:[{label:this.$t("channelInfo.nocheck"),value:0},{label:this.$t("channelInfo.oddcheck"),value:1},{label:this.$t("channelInfo.evencheck"),value:2}],com_nameList:[],baudList:[{label:"300",value:300},{label:"600",value:600},{label:"1200",value:1200},{label:"2400",value:2400},{label:"4800",value:4800},{label:"5000",value:5e3},{label:"9600",value:9600},{label:"10000",value:1e4},{label:"19200",value:19200},{label:"20000",value:2e4},{label:"38400",value:38400},{label:"40000",value:4e4},{label:"50000",value:5e4},{label:"57600",value:57600},{label:"80000",value:8e4},{label:"100000",value:1e5},{label:"115200",value:115200},{label:"125000",value:125e3},{label:"187500",value:187500},{label:"200000",value:2e5},{label:"250000",value:25e4},{label:"400000",value:4e5},{label:"500000",value:5e5},{label:"666000",value:666e3},{label:"800000",value:8e5},{label:"1000000",value:1e6}],rules:{chlname:[{required:!0,message:this.$t("validate.required"),trigger:"change"},{validator:function(e,t,r){if(a.dataForm.id){var l=/^[a-zA-Z0-9-_#\u4e00-\u9fa5]+$/,o=l.test(t);if(!o)return r(new Error(a.$t("channelInfo.tagnameNoSpecial")));r()}else if(t)if(-1!=t.indexOf("-")){var c=Math.abs(t.substring(t.lastIndexOf("-")).replace(/[^0-9]/gi,""));if(null==t.substring(0,t.lastIndexOf("-")).match(/(\d+)[^0-9]*$/)||null==t.substring(t.lastIndexOf("-"),t.length).match(/(\d+)[^0-9]*$/))return r(new Error(a.$t("channelInfo.chlnameNoRules")));var m=t.substring(0,t.lastIndexOf("-")).match(/(\d+)[^0-9]*$/)[1],s=c-m+1;if(s<=0)return r(new Error(a.$t("channelInfo.chlnameNoRules")));var n=t.lastIndexOf("-"),p=t.substring(0,n),i=t.substring(n+1,t.length),d=/^[a-zA-Z0-9_#\u4e00-\u9fa5]+$/,h=d.test(p),u=new RegExp("^[0-9]([0-9])*$").test(i);if(!h)return r(new Error(a.$t("channelInfo.tagnameNoSpecial")));if(!u)return r(new Error(a.$t("channelInfo.chlnameNoRules")));r()}else{var f=/^[a-zA-Z0-9_#\u4e00-\u9fa5]+$/,b=f.test(t);if(!b)return r(new Error(a.$t("channelInfo.tagnameNoSpecial")));r()}},trigger:"change"}],chladdr:[{required:!0,message:this.$t("validate.required"),trigger:"change"},{pattern:/^[1-9]\d*/,message:this.$t("channelInfo.enterIntNumber")}],chltype:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],chlcoltfrq:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],chlcoltfrmstopms:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],chlprotocol:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],protocoltype:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],enablebackupchl:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],"chlmasterparam.role":[{required:!0,message:this.$t("channelInfo.enterRole"),trigger:"change"}],"chlmasterparam.ip_addr":[{required:!0,message:this.$t("channelInfo.enterIpaddr"),trigger:"change"},{validator:function(e,t,r){var l="^((https|http|ftp|rtsp|mms)?://)?(([0-9a-z_!~*'().&=+$%-]+: )?[0-9a-z_!~*'().&=+$%-]+@)?(([0-9]{1,3}.){3}[0-9]{1,3}|([0-9a-z_!~*'()-]+.)*([0-9a-z][0-9a-z-]{0,61})?[0-9a-z].[a-z]{2,6})(:[0-9]{1,4})?((/?)|(/[0-9a-z_!~*'().;?:@&=+$,%#-]+)+/?)$",o=new RegExp(l);if(!o.test(t))return r(new Error(a.$t("channelInfo.enterCorrectIpaddr")));r()}}],"chlmasterparam.port":[{required:!0,message:this.$t("channelInfo.enterPort"),trigger:"change"},{pattern:/^[0-9]*$/,message:this.$t("channelInfo.enterCorrectPort")}],"chlmasterparam.timeout":[{required:!0,message:this.$t("channelInfo.enterTimeout"),trigger:"change"}],"chlbackupparam.role":[{required:!0,message:this.$t("channelInfo.enterRole"),trigger:"change"}],"chlbackupparam.ip_addr":[{required:!0,message:this.$t("channelInfo.enterIpaddr"),trigger:"change"},{validator:function(e,t,r){var l="^((https|http|ftp|rtsp|mms)?://)?(([0-9a-z_!~*'().&=+$%-]+: )?[0-9a-z_!~*'().&=+$%-]+@)?(([0-9]{1,3}.){3}[0-9]{1,3}|([0-9a-z_!~*'()-]+.)*([0-9a-z][0-9a-z-]{0,61})?[0-9a-z].[a-z]{2,6})(:[0-9]{1,4})?((/?)|(/[0-9a-z_!~*'().;?:@&=+$,%#-]+)+/?)$",o=new RegExp(l);if(!o.test(t))return r(new Error(a.$t("channelInfo.enterCorrectIpaddr")));r()}}],"chlbackupparam.port":[{required:!0,message:this.$t("channelInfo.enterPort"),trigger:"change"},{pattern:/^[0-9]*$/,message:this.$t("channelInfo.enterCorrectPort")}],"chlbackupparam.timeout":[{required:!0,message:this.$t("channelInfo.enterTimeout"),trigger:"change"}],"chlmasterparam.com_name":[{required:!0,message:this.$t("channelInfo.enterComname"),trigger:"change"}],"chlmasterparam.baud":[{required:!0,message:this.$t("channelInfo.enterBaud"),trigger:"change"}],"chlmasterparam.stop_bit":[{required:!0,message:this.$t("channelInfo.enterStopbit"),trigger:"change"}],"chlmasterparam.data_bit":[{required:!0,message:this.$t("channelInfo.enterDatabit"),trigger:"change"}],"chlmasterparam.check_bit":[{required:!0,message:this.$t("channelInfo.enterCheckbit"),trigger:"change"}],"chlbackupparam.com_name":[{required:!0,message:this.$t("channelInfo.enterComname"),trigger:"change"}],"chlbackupparam.baud":[{required:!0,message:this.$t("channelInfo.enterBaud"),trigger:"change"}],"chlbackupparam.stop_bit":[{required:!0,message:this.$t("channelInfo.enterStopbit"),trigger:"change"}],"chlbackupparam.data_bit":[{required:!0,message:this.$t("channelInfo.enterDatabit"),trigger:"change"}],"chlbackupparam.check_bit":[{required:!0,message:this.$t("channelInfo.enterCheckbit"),trigger:"change"}]}}},methods:{init:function(){var a=this;a.visible=!0,a.loading=!0},handleDialogOpenChange:function(){var a=Object(c["a"])(regeneratorRuntime.mark((function a(){var e;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e=this,e.$refs["dataForm"].resetFields(),e.id="",e.chlprotocolName="",e.$refs.chlname.focus(),a.next=1,e.getComnameList();case 1:if(!e.dataForm.id){a.next=3;break}return a.next=2,e.getInfo();case 2:a.next=4;break;case 3:e.selectedProtocoltype=null,e.id="{11B642F4-4D18-4a6b-89F8-B15564BB3EB5}",e.getguidInfo(e.id,(function(a){if(e.chlprotocolName=a.data[0].name,e.dataForm.protocoltype=a.data[0].type,0===e.dataForm.protocoltype)e.dataForm.chlcoltfrmstopms=20,e.defaultcfg=JSON.parse(a.data[0].defaultcfg),"{}"!=JSON.stringify(e.defaultcfg)?(e.$set(e.dataForm.chlmasterparam,"role",e.defaultcfg.role),e.$set(e.dataForm.chlmasterparam,"ip_addr",e.defaultcfg.ip_addr),e.$set(e.dataForm.chlmasterparam,"port",e.defaultcfg.port),e.$set(e.dataForm.chlmasterparam,"timeout",e.defaultcfg.timeout),e.$set(e.dataForm.chlmasterparam,"reserve0",e.defaultcfg.reserve0),e.$set(e.dataForm.chlmasterparam,"reserve1",e.defaultcfg.reserve1),e.$set(e.dataForm.chlmasterparam,"reserve2",e.defaultcfg.reserve2),e.$set(e.dataForm.chlmasterparam,"reserve3",e.defaultcfg.reserve3),1===e.dataForm.enablebackupchl&&e.openBackup()):(e.defaultcfg=JSON.parse(a.data[0].defaultcfg),e.$set(e.dataForm.chlmasterparam,"role",0),e.$set(e.dataForm.chlmasterparam,"ip_addr",""),e.$set(e.dataForm.chlmasterparam,"port",""),e.$set(e.dataForm.chlmasterparam,"timeout",1e3),e.$set(e.dataForm.chlmasterparam,"reserve0",""),e.$set(e.dataForm.chlmasterparam,"reserve1",""),e.$set(e.dataForm.chlmasterparam,"reserve2",""),e.$set(e.dataForm.chlmasterparam,"reserve3",""),1===e.dataForm.enablebackupchl&&e.openBackup());else{if(e.dataForm.chlcoltfrmstopms=300,!(e.com_nameList.length>0))return e.$message.info(e.$t("channelInfo.noCom"));e.$set(e.dataForm.chlmasterparam,"com_name",e.com_nameList[0].value),e.$set(e.dataForm.chlmasterparam,"baud",9600),e.$set(e.dataForm.chlmasterparam,"stop_bit",1),e.$set(e.dataForm.chlmasterparam,"data_bit",8),e.$set(e.dataForm.chlmasterparam,"check_bit",0),e.$set(e.dataForm.chlmasterparam,"timeout",1200),e.$set(e.dataForm.chlmasterparam,"reserve0",""),e.$set(e.dataForm.chlmasterparam,"reserve1",""),1===e.dataForm.enablebackupchl&&e.openBackup()}e.loading=!1}));case 4:case"end":return a.stop()}}),a,this)})));function e(){return a.apply(this,arguments)}return e}(),getprotocolinfoList:function(){var a=this;a.options=[],a.$http.get("/info/groupinfo/getNode").then((function(e){var t=e.data,r=t.data;r.length>0&&(r.forEach((function(e){if(-1===e.upgroupid&&-1===e.groupname.indexOf("*")){var t={label:e.groupname,value:String(e.groupid),children:[]};a.options.push(t)}})),a.getSecondData(r))})).catch((function(a){return!1}))},getSecondData:function(a){var e=this;if(a.length>0){var t,r=i(e.options);try{for(r.s();!(t=r.n()).done;){var l,o=t.value,c=i(a);try{for(c.s();!(l=c.n()).done;){var m=l.value;if(o.value==m.upgroupid&&-1===m.groupname.indexOf("*")){var s={label:m.groupname,value:String(m.groupid),children:[]};o.children.push(s)}}}catch(n){c.e(n)}finally{c.f()}}}catch(n){r.e(n)}finally{r.f()}e.getThirdData()}},getThirdData:function(){var a=this;a.$hasPermission("protocolinfo:select:permission.do")?a.$http.get("/info/protocolinfo/proGuidAll",{params:{attribute:0}}).then((function(e){var t,r=e.data,l=i(a.options);try{for(l.s();!(t=l.n()).done;){var o=t.value;if(o.children.length>0){var c,m=i(o.children);try{for(m.s();!(c=m.n()).done;){var s,n=c.value,p=i(r.data);try{for(p.s();!(s=p.n()).done;){var d=s.value;if(n.value==d.groupid&&-1===d.name.indexOf("*")){var h={label:d.name,value:d.guid};n.children.push(h)}}}catch(u){p.e(u)}finally{p.f()}}}catch(u){m.e(u)}finally{m.f()}}}}catch(u){l.e(u)}finally{l.f()}a.getFinallyData(a.options)})).catch((function(a){return!1})):a.$message.warning("暂无协议查询权限, 请联系管理员")},getFinallyData:function(a){if(a.length>0){for(var e=a.length-1;e>=0;e--){for(var t=a[e].children,r=t.length-1;r>=0;r--)0===t[r].children.length&&t.splice(r,1);0===a[e].children.length&&a.splice(e,1)}return a}},dataFilter:function(a,e){if(~a.text.indexOf(e)||~a.text.toUpperCase().indexOf(e.toUpperCase()))return!0},handleChlpro:function(a){var e=this;e.id=a[a.length-1],e.getguidInfo(e.id,(function(a){if(e.chlprotocolName=a.data[0].name,e.dataForm.protocoltype=a.data[0].type,0===e.dataForm.protocoltype)e.dataForm.chlcoltfrmstopms=20,e.defaultcfg=JSON.parse(a.data[0].defaultcfg),"{}"!=JSON.stringify(e.defaultcfg)?e.dataForm.id?(0==e.selectedProtocoltype||(e.$set(e.dataForm.chlmasterparam,"role",e.defaultcfg.role),e.$set(e.dataForm.chlmasterparam,"ip_addr",e.defaultcfg.ip_addr),e.$set(e.dataForm.chlmasterparam,"port",e.defaultcfg.port),e.$set(e.dataForm.chlmasterparam,"timeout",e.defaultcfg.timeout),e.$set(e.dataForm.chlmasterparam,"reserve0",e.defaultcfg.reserve0),e.$set(e.dataForm.chlmasterparam,"reserve1",e.defaultcfg.reserve1),e.$set(e.dataForm.chlmasterparam,"reserve2",e.defaultcfg.reserve2),e.$set(e.dataForm.chlmasterparam,"reserve3",e.defaultcfg.reserve3)),1===e.dataForm.enablebackupchl&&e.openBackup()):(e.$set(e.dataForm.chlmasterparam,"role",e.defaultcfg.role),e.$set(e.dataForm.chlmasterparam,"ip_addr",e.defaultcfg.ip_addr),e.$set(e.dataForm.chlmasterparam,"port",e.defaultcfg.port),e.$set(e.dataForm.chlmasterparam,"timeout",e.defaultcfg.timeout),e.$set(e.dataForm.chlmasterparam,"reserve0",e.defaultcfg.reserve0),e.$set(e.dataForm.chlmasterparam,"reserve1",e.defaultcfg.reserve1),e.$set(e.dataForm.chlmasterparam,"reserve2",e.defaultcfg.reserve2),e.$set(e.dataForm.chlmasterparam,"reserve3",e.defaultcfg.reserve3),1===e.dataForm.enablebackupchl&&e.openBackup()):(e.$set(e.dataForm.chlmasterparam,"role",0),e.$set(e.dataForm.chlmasterparam,"ip_addr",""),e.$set(e.dataForm.chlmasterparam,"port",""),e.$set(e.dataForm.chlmasterparam,"timeout",1e3),e.$set(e.dataForm.chlmasterparam,"reserve0",""),e.$set(e.dataForm.chlmasterparam,"reserve1",""),e.$set(e.dataForm.chlmasterparam,"reserve2",""),e.$set(e.dataForm.chlmasterparam,"reserve3",""),1===e.dataForm.enablebackupchl&&e.openBackup());else if(e.dataForm.chlcoltfrmstopms=300,e.defaultcfg=JSON.parse(a.data[0].defaultcfg),"{}"!=JSON.stringify(e.defaultcfg))e.dataForm.id?(1==e.selectedProtocoltype||(e.$set(e.dataForm.chlmasterparam,"com_name",e.defaultcfg.com_name),e.$set(e.dataForm.chlmasterparam,"baud",e.defaultcfg.baud),e.$set(e.dataForm.chlmasterparam,"stop_bit",e.defaultcfg.stop_bit),e.$set(e.dataForm.chlmasterparam,"data_bit",e.defaultcfg.data_bit),e.$set(e.dataForm.chlmasterparam,"check_bit",e.defaultcfg.check_bit),e.$set(e.dataForm.chlmasterparam,"timeout",e.defaultcfg.timeout),e.$set(e.dataForm.chlmasterparam,"reserve0",e.defaultcfg.reserve0),e.$set(e.dataForm.chlmasterparam,"reserve1",e.defaultcfg.reserve1)),1===e.dataForm.enablebackupchl&&e.openBackup()):(e.$set(e.dataForm.chlmasterparam,"com_name",e.defaultcfg.com_name),e.$set(e.dataForm.chlmasterparam,"baud",e.defaultcfg.baud),e.$set(e.dataForm.chlmasterparam,"stop_bit",e.defaultcfg.stop_bit),e.$set(e.dataForm.chlmasterparam,"data_bit",e.defaultcfg.data_bit),e.$set(e.dataForm.chlmasterparam,"check_bit",e.defaultcfg.check_bit),e.$set(e.dataForm.chlmasterparam,"timeout",e.defaultcfg.timeout),e.$set(e.dataForm.chlmasterparam,"reserve0",e.defaultcfg.reserve0),e.$set(e.dataForm.chlmasterparam,"reserve1",e.defaultcfg.reserve1),1===e.dataForm.enablebackupchl&&e.openBackup());else{if(!(e.com_nameList.length>0))return e.$message.info(e.$t("channelInfo.noCom"));e.$set(e.dataForm.chlmasterparam,"com_name",e.com_nameList[0].value),e.$set(e.dataForm.chlmasterparam,"baud",9600),e.$set(e.dataForm.chlmasterparam,"stop_bit",1),e.$set(e.dataForm.chlmasterparam,"data_bit",8),e.$set(e.dataForm.chlmasterparam,"check_bit",0),e.$set(e.dataForm.chlmasterparam,"timeout",1200),e.$set(e.dataForm.chlmasterparam,"reserve0",""),e.$set(e.dataForm.chlmasterparam,"reserve1",""),1===e.dataForm.enablebackupchl&&e.openBackup()}}))},selectProtocolType:function(a){var e=this;e.id?e.getguidInfo(e.id,(function(t){0===a?(e.dataForm.chlcoltfrmstopms=20,e.defaultcfg=JSON.parse(t.data[0].defaultcfg),"{}"!=JSON.stringify(e.defaultcfg)?(e.$set(e.dataForm.chlmasterparam,"role",e.defaultcfg.role),e.$set(e.dataForm.chlmasterparam,"ip_addr",e.defaultcfg.ip_addr),e.$set(e.dataForm.chlmasterparam,"port",e.defaultcfg.port),e.$set(e.dataForm.chlmasterparam,"timeout",e.defaultcfg.timeout),e.$set(e.dataForm.chlmasterparam,"reserve0",e.defaultcfg.reserve0),e.$set(e.dataForm.chlmasterparam,"reserve1",e.defaultcfg.reserve1),e.$set(e.dataForm.chlmasterparam,"reserve2",e.defaultcfg.reserve2),e.$set(e.dataForm.chlmasterparam,"reserve3",e.defaultcfg.reserve3),1===e.dataForm.enablebackupchl&&e.openBackup()):(e.$set(e.dataForm.chlmasterparam,"role",0),e.$set(e.dataForm.chlmasterparam,"ip_addr",""),e.$set(e.dataForm.chlmasterparam,"port",""),e.$set(e.dataForm.chlmasterparam,"timeout",1e3),e.$set(e.dataForm.chlmasterparam,"reserve0",""),e.$set(e.dataForm.chlmasterparam,"reserve1",""),e.$set(e.dataForm.chlmasterparam,"reserve2",""),e.$set(e.dataForm.chlmasterparam,"reserve3",""),1===e.dataForm.enablebackupchl&&e.openBackup())):(e.dataForm.chlcoltfrmstopms=300,e.defaultcfg=JSON.parse(t.data[0].defaultcfg),e.getComnameList())})):0===a?(e.dataForm.chlcoltfrmstopms=20,e.defaultcfg={},"{}"!=JSON.stringify(e.defaultcfg)?(e.$set(e.dataForm.chlmasterparam,"role",e.defaultcfg.role),e.$set(e.dataForm.chlmasterparam,"ip_addr",e.defaultcfg.ip_addr),e.$set(e.dataForm.chlmasterparam,"port",e.defaultcfg.port),e.$set(e.dataForm.chlmasterparam,"timeout",e.defaultcfg.timeout),e.$set(e.dataForm.chlmasterparam,"reserve0",e.defaultcfg.reserve0),e.$set(e.dataForm.chlmasterparam,"reserve1",e.defaultcfg.reserve1),e.$set(e.dataForm.chlmasterparam,"reserve2",e.defaultcfg.reserve2),e.$set(e.dataForm.chlmasterparam,"reserve3",e.defaultcfg.reserve3),1===e.dataForm.enablebackupchl&&e.openBackup()):(e.$set(e.dataForm.chlmasterparam,"role",0),e.$set(e.dataForm.chlmasterparam,"ip_addr",""),e.$set(e.dataForm.chlmasterparam,"port",""),e.$set(e.dataForm.chlmasterparam,"timeout",1e3),e.$set(e.dataForm.chlmasterparam,"reserve0",""),e.$set(e.dataForm.chlmasterparam,"reserve1",""),e.$set(e.dataForm.chlmasterparam,"reserve2",""),e.$set(e.dataForm.chlmasterparam,"reserve3",""),1===e.dataForm.enablebackupchl&&e.openBackup())):(e.dataForm.chlcoltfrmstopms=300,e.defaultcfg={},e.getComnameList())},getguidInfo:function(a,e){var t=this;t.$hasPermission("protocolinfo:select:permission.do")?t.$http.get("/info/protocolinfo/proguid",{params:{guid:a}}).then((function(a){var r=a.data;if(0!=r.code)return t.$message.error(r.msg);t.$http.get("/info/groupinfo/getNodeTreesss",{params:{GroupID:r.data[0].groupid}}).then((function(a){var l=a.data;t.dataForm.chlprotocol=[String(l[0].upgroupid),String(r.data[0].groupid),t.id],e(r)}))})).catch((function(a){return!1})):t.$message.warning("暂无协议查询权限, 请联系管理员")},openBackup:s()((function(){if(this.dataForm.enablebackupchl=1,0===this.dataForm.protocoltype&&(this.dataForm.chlcoltfrmstopms=20,"{}"!=JSON.stringify(this.defaultcfg)?this.dataForm.id&&0==this.selectProtocolType?(this.$set(this.dataForm.chlbackupparam,"role",this.dataForm.chlmasterparam.role),this.$set(this.dataForm.chlbackupparam,"ip_addr",this.dataForm.chlmasterparam.ip_addr),this.$set(this.dataForm.chlbackupparam,"port",this.dataForm.chlmasterparam.port),this.$set(this.dataForm.chlbackupparam,"timeout",this.dataForm.chlmasterparam.timeout),this.$set(this.dataForm.chlbackupparam,"reserve0",this.dataForm.chlmasterparam.reserve0),this.$set(this.dataForm.chlbackupparam,"reserve1",this.dataForm.chlmasterparam.reserve1),this.$set(this.dataForm.chlbackupparam,"reserve2",this.dataForm.chlmasterparam.reserve2),this.$set(this.dataForm.chlbackupparam,"reserve3",this.dataForm.chlmasterparam.reserve3)):(this.$set(this.dataForm.chlbackupparam,"role",this.defaultcfg.role),this.$set(this.dataForm.chlbackupparam,"ip_addr",this.defaultcfg.ip_addr),this.$set(this.dataForm.chlbackupparam,"port",this.defaultcfg.port),this.$set(this.dataForm.chlbackupparam,"timeout",this.defaultcfg.timeout),this.$set(this.dataForm.chlbackupparam,"reserve0",this.defaultcfg.reserve0),this.$set(this.dataForm.chlbackupparam,"reserve1",this.defaultcfg.reserve1),this.$set(this.dataForm.chlbackupparam,"reserve2",this.defaultcfg.reserve2),this.$set(this.dataForm.chlbackupparam,"reserve3",this.defaultcfg.reserve3)):(this.$set(this.dataForm.chlbackupparam,"role",0),this.$set(this.dataForm.chlbackupparam,"ip_addr",""),this.$set(this.dataForm.chlbackupparam,"port",""),this.$set(this.dataForm.chlbackupparam,"timeout",1e3),this.$set(this.dataForm.chlbackupparam,"reserve0",""),this.$set(this.dataForm.chlbackupparam,"reserve1",""),this.$set(this.dataForm.chlbackupparam,"reserve2",""),this.$set(this.dataForm.chlbackupparam,"reserve3",""))),1===this.dataForm.protocoltype)if(this.dataForm.chlcoltfrmstopms=300,"{}"!=JSON.stringify(this.defaultcfg))this.dataForm.id&&1==this.selectProtocolType?(this.$set(this.dataForm.chlbackupparam,"com_name",this.dataForm.chlmasterparam.com_name),this.$set(this.dataForm.chlbackupparam,"baud",this.dataForm.chlmasterparam.baud),this.$set(this.dataForm.chlbackupparam,"stop_bit",this.dataForm.chlmasterparam.stop_bit),this.$set(this.dataForm.chlbackupparam,"data_bit",this.dataForm.chlmasterparam.data_bit),this.$set(this.dataForm.chlbackupparam,"check_bit",this.dataForm.chlmasterparam.check_bit),this.$set(this.dataForm.chlbackupparam,"timeout",this.dataForm.chlmasterparam.timeout),this.$set(this.dataForm.chlbackupparam,"reserve0",this.dataForm.chlmasterparam.reserve0),this.$set(this.dataForm.chlbackupparam,"reserve1",this.dataForm.chlmasterparam.reserve1)):(this.$set(this.dataForm.chlbackupparam,"com_name",this.defaultcfg.com_name),this.$set(this.dataForm.chlbackupparam,"baud",this.defaultcfg.baud),this.$set(this.dataForm.chlbackupparam,"stop_bit",this.defaultcfg.stop_bit),this.$set(this.dataForm.chlbackupparam,"data_bit",this.defaultcfg.data_bit),this.$set(this.dataForm.chlbackupparam,"check_bit",this.defaultcfg.check_bit),this.$set(this.dataForm.chlbackupparam,"timeout",this.defaultcfg.timeout),this.$set(this.dataForm.chlbackupparam,"reserve0",this.defaultcfg.reserve0),this.$set(this.dataForm.chlbackupparam,"reserve1",this.defaultcfg.reserve1));else{if(!(this.com_nameList.length>0))return this.$message.info(this.$t("channelInfo.noCom"));this.$set(this.dataForm.chlbackupparam,"com_name",this.com_nameList[0].value),this.$set(this.dataForm.chlbackupparam,"baud",9600),this.$set(this.dataForm.chlbackupparam,"stop_bit",1),this.$set(this.dataForm.chlbackupparam,"data_bit",8),this.$set(this.dataForm.chlbackupparam,"check_bit",0),this.$set(this.dataForm.chlbackupparam,"timeout",1200),this.$set(this.dataForm.chlbackupparam,"reserve0",""),this.$set(this.dataForm.chlbackupparam,"reserve1","")}}),1e3,{leading:!0,trailing:!1}),closeBackup:s()((function(){this.dataForm.enablebackupchl=0}),1e3,{leading:!0,trailing:!1}),getComnameList:function(){var a=this,e={page:1,limit:1,model:sessionStorage.getItem("model")};if(a.com_nameList=[],!a.$hasPermission("interface:select:permission.do"))return a.loading=!1,void a.$message.warning("暂无串口查询权限, 请联系管理员");a.$http.get("/gwtype/interface/selectByModel",{params:e}).then((function(e){var t=e.data;if(!(t.list.length>0))return a.visible=!1,a.$message.info(a.$t("channelInfo.noModel"));if(t.list[0].gwInterface){var r=JSON.parse(t.list[0].gwInterface).uart.list;if(a.comNumber=JSON.parse(t.list[0].gwInterface).uart.num,r.length>0&&(r.forEach((function(e){var t={label:e,value:e};a.com_nameList.push(t)})),!a.dataForm.id&&1===a.dataForm.protocoltype))if(a.dataForm.chlcoltfrmstopms=300,"{}"!=JSON.stringify(a.defaultcfg))a.$set(a.dataForm.chlmasterparam,"com_name",a.defaultcfg.com_name),a.$set(a.dataForm.chlmasterparam,"baud",a.defaultcfg.baud),a.$set(a.dataForm.chlmasterparam,"stop_bit",a.defaultcfg.stop_bit),a.$set(a.dataForm.chlmasterparam,"data_bit",a.defaultcfg.data_bit),a.$set(a.dataForm.chlmasterparam,"check_bit",a.defaultcfg.check_bit),a.$set(a.dataForm.chlmasterparam,"timeout",a.defaultcfg.timeout),a.$set(a.dataForm.chlmasterparam,"reserve0",a.defaultcfg.reserve0),a.$set(a.dataForm.chlmasterparam,"reserve1",a.defaultcfg.reserve1),1===a.dataForm.enablebackupchl&&a.openBackup();else{if(!(a.com_nameList.length>0))return a.$message.info(a.$t("channelInfo.noCom"));a.$set(a.dataForm.chlmasterparam,"com_name",a.com_nameList[0].value),a.$set(a.dataForm.chlmasterparam,"baud",9600),a.$set(a.dataForm.chlmasterparam,"stop_bit",1),a.$set(a.dataForm.chlmasterparam,"data_bit",8),a.$set(a.dataForm.chlmasterparam,"check_bit",0),a.$set(a.dataForm.chlmasterparam,"timeout",1200),a.$set(a.dataForm.chlmasterparam,"reserve0",""),a.$set(a.dataForm.chlmasterparam,"reserve1",""),1===a.dataForm.enablebackupchl&&a.openBackup()}}})).catch((function(a){return!1}))},getInfo:function(){var a=this,e={};if(!a.$hasPermission("channelinfo:info:select:permission.do"))return a.loading=!1,void a.$message.warning("暂无通道信息查询权限, 请联系管理员");a.$http.get("/info/channelinfo/".concat(a.dataForm.id)).then((function(t){var r=t.data;if(0!==r.code)return a.loading=!1,a.$message.error(r.msg);if(e=p({},r.data),e.chlprotocol){if(a.id=e.chlprotocol,e.chlmasterparam=JSON.parse(e.chlmasterparam),e.chlbackupparam=JSON.parse(e.chlbackupparam),a.dataForm=e,a.selectedProtocoltype=r.data.protocoltype,!a.$hasPermission("protocolinfo:select:permission.do"))return a.loading=!1,void a.$message.warning("暂无协议查询权限, 请联系管理员");a.$http.get("/info/protocolinfo/proguid",{params:{guid:a.id}}).then((function(e){var t=e.data;if(0!==t.code)return a.loading=!1,a.$message.error(t.msg);a.defaultcfg=JSON.parse(t.data[0].defaultcfg),a.$http.get("/info/groupinfo/getNodeTreesss",{params:{GroupID:t.data[0].groupid}}).then((function(e){var r=e.data;a.loading=!1,a.dataForm.chlprotocol=[String(r[0].upgroupid),String(t.data[0].groupid),a.id]}))})).catch((function(a){}))}else a.loading=!1,a.dataForm=p(p({},e),{},{chlmasterparam:e.chlmasterparam?e.chlmasterparam:{},chlbackupparam:e.chlbackupparam?e.chlbackupparam:{}}),null!=r.data.protocoltype&&(a.selectedProtocoltype=r.data.protocoltype)})).catch((function(e){return a.loading=!1,!1}))},sortByArr:function(a,e){return e=void 0==e||e?1:-1,function(t,r){for(var l=0;l<a.length;l++){var o=a[l];if(t[o]!=r[o])return t[o]>r[o]?1*e:-1*e}}},dataFormSubmitHandle:s()((function(){var a=this,e=this,t={},r="/info/channelinfo/insertAdd",l=null;if(e.$hasSessionStorageGwsn()){if(e.dataForm.id){if(!e.$hasPermission("channelinfo:info:update:permission.do"))return void e.$message.warning("暂无通道修改权限, 请联系管理员")}else if(!e.$hasPermission("channelinfo:insertAdd:permission.do"))return void e.$message.warning("暂无通道新增权限, 请联系管理员");e.paramsData=[],e.$refs["dataForm"].validate((function(o){if(!o)return!1;if(0===e.dataForm.protocoltype?(e.dataForm.chlmasterparam={role:Number(e.dataForm.chlmasterparam.role),ip_addr:e.dataForm.chlmasterparam.ip_addr,port:Number(e.dataForm.chlmasterparam.port),timeout:Number(e.dataForm.chlmasterparam.timeout),reserve0:e.dataForm.chlmasterparam.reserve0,reserve1:e.dataForm.chlmasterparam.reserve1,reserve2:e.dataForm.chlmasterparam.reserve2,reserve3:e.dataForm.chlmasterparam.reserve3},e.dataForm.chlbackupparam={role:Number(e.dataForm.chlbackupparam.role),ip_addr:e.dataForm.chlbackupparam.ip_addr,port:Number(e.dataForm.chlbackupparam.port),timeout:Number(e.dataForm.chlbackupparam.timeout),reserve0:e.dataForm.chlbackupparam.reserve0,reserve1:e.dataForm.chlbackupparam.reserve1,reserve2:e.dataForm.chlbackupparam.reserve2,reserve3:e.dataForm.chlbackupparam.reserve3}):(e.dataForm.chlmasterparam={com_name:e.dataForm.chlmasterparam.com_name,baud:Number(e.dataForm.chlmasterparam.baud),stop_bit:Number(e.dataForm.chlmasterparam.stop_bit),data_bit:Number(e.dataForm.chlmasterparam.data_bit),check_bit:Number(e.dataForm.chlmasterparam.check_bit),timeout:Number(e.dataForm.chlmasterparam.timeout),reserve0:e.dataForm.chlmasterparam.reserve0,reserve1:e.dataForm.chlmasterparam.reserve1},e.dataForm.chlbackupparam={com_name:e.dataForm.chlbackupparam.com_name,baud:Number(e.dataForm.chlbackupparam.baud),stop_bit:Number(e.dataForm.chlbackupparam.stop_bit),data_bit:Number(e.dataForm.chlbackupparam.data_bit),check_bit:Number(e.dataForm.chlbackupparam.check_bit),timeout:Number(e.dataForm.chlbackupparam.timeout),reserve0:e.dataForm.chlbackupparam.reserve0,reserve1:e.dataForm.chlbackupparam.reserve1}),e.loading=!0,!e.dataForm.id)if(-1!=e.dataForm.chlname.indexOf("-")){for(var c=Math.abs(a.dataForm.chlname.substring(a.dataForm.chlname.lastIndexOf("-")).replace(/[^0-9]/gi,"")),m=e.dataForm.chlname.split(/-(?![^-]*-)/),s=e.dataForm.chlname.substring(0,e.dataForm.chlname.lastIndexOf("-")).match(/(\d+)[^0-9]*$/)[1],n=s.replace(/[^0]/g,""),i=s,d=m[0],h=d.substring(0,d.length-d.match(/(\d+)[^0-9]*$/)[1].length),u=c-s+1,f=0;f<u;f++){var b=i++,F={};F.chlname=0==parseInt(s)?n.length>0?String(b).length>=n.length?h+b:h+n.substring(0,n.length-String(b).length)+b:h+b:n.length>0?b>=10?h+n.substring(0,n.length-String(b).length+1)+b:h+n.substring(0,n.length)+b:h+b,F.chladdr=e.dataForm.chladdr,F.chlcomment=e.dataForm.chlcomment,F.chltype=e.dataForm.chltype,F.chlcoltfrq=e.dataForm.chlcoltfrq,F.chlcoltfrmstopms=e.dataForm.chlcoltfrmstopms,F.chlprotocol=e.id,F.protocoltype=e.dataForm.protocoltype,F.enablebackupchl=e.dataForm.enablebackupchl,F.gwsn=sessionStorage.getItem("gwsn"),F.chlmasterparam=e.dataForm.chlmasterparam,F.chlbackupparam=e.dataForm.chlbackupparam,F.valid=e.dataForm.valid,e.paramsData.push(F)}var g=0;if(1===e.paramsData[0].protocoltype&&(g=Number(e.paramsData[0].chlmasterparam.com_name.slice(3))),e.paramsData.length>0)for(var v=0;v<e.paramsData.length;v++){if(1===e.paramsData[v].protocoltype){var $=g++,k={};$>=e.comNumber&&($=e.comNumber),k.com_name="COM"+$,k.baud=Number(e.paramsData[v].chlmasterparam.baud),k.stop_bit=Number(e.paramsData[v].chlmasterparam.stop_bit),k.data_bit=Number(e.paramsData[v].chlmasterparam.data_bit),k.check_bit=Number(e.paramsData[v].chlmasterparam.check_bit),k.timeout=Number(e.paramsData[v].chlmasterparam.timeout),k.reserve0=e.paramsData[v].chlmasterparam.reserve0,k.reserve1=e.paramsData[v].chlmasterparam.reserve1,e.paramsData[v].chlmasterparam=k}else{var _={};_.role=Number(e.paramsData[v].chlmasterparam.role),_.ip_addr=e.paramsData[v].chlmasterparam.ip_addr,_.port=Number(e.paramsData[v].chlmasterparam.port),_.timeout=Number(e.paramsData[v].chlmasterparam.timeout),_.reserve0=e.paramsData[v].chlmasterparam.reserve0,_.reserve1=e.paramsData[v].chlmasterparam.reserve1,_.reserve2=e.paramsData[v].chlmasterparam.reserve2,_.reserve3=e.paramsData[v].chlmasterparam.reserve3,e.paramsData[v].chlmasterparam=_}if(1===e.paramsData[v].enablebackupchl)if(1===e.paramsData[v].protocoltype){var y=g++,I={};y>=e.comNumber&&(y=e.comNumber),I.com_name="COM"+y,I.baud=Number(e.paramsData[v].chlbackupparam.baud),I.stop_bit=Number(e.paramsData[v].chlbackupparam.stop_bit),I.data_bit=Number(e.paramsData[v].chlbackupparam.data_bit),I.check_bit=Number(e.paramsData[v].chlbackupparam.check_bit),I.timeout=Number(e.paramsData[v].chlbackupparam.timeout),I.reserve0=e.paramsData[v].chlbackupparam.reserve0,I.reserve1=e.paramsData[v].chlbackupparam.reserve1,e.paramsData[v].chlbackupparam=I}else{var w={};w.role=Number(e.paramsData[v].chlbackupparam.role),w.ip_addr=e.paramsData[v].chlbackupparam.ip_addr,w.port=Number(e.paramsData[v].chlbackupparam.port),w.timeout=Number(e.paramsData[v].chlbackupparam.timeout),w.reserve0=e.paramsData[v].chlbackupparam.reserve0,w.reserve1=e.paramsData[v].chlbackupparam.reserve1,w.reserve2=e.paramsData[v].chlbackupparam.reserve2,w.reserve3=e.paramsData[v].chlbackupparam.reserve3,e.paramsData[v].chlbackupparam=w}}}else t={chlname:e.dataForm.chlname,chlcomment:e.dataForm.chlcomment,chladdr:e.dataForm.chladdr,chltype:e.dataForm.chltype,chlcoltfrq:e.dataForm.chlcoltfrq,chlcoltfrmstopms:e.dataForm.chlcoltfrmstopms,chlprotocol:e.id,protocoltype:e.dataForm.protocoltype,enablebackupchl:e.dataForm.enablebackupchl,gwsn:sessionStorage.getItem("gwsn"),chlmasterparam:e.dataForm.chlmasterparam,chlbackupparam:e.dataForm.chlbackupparam,valid:e.dataForm.valid},e.paramsData.push(t);e.dataForm.id?(r="/info/channelinfo",e.dataForm.chlmasterparam.timeout=Number(e.dataForm.chlmasterparam.timeout),t={id:e.dataForm.id,chlname:e.dataForm.chlname,chlcomment:e.dataForm.chlcomment,chladdr:e.dataForm.chladdr,chltype:e.dataForm.chltype,chlcoltfrq:e.dataForm.chlcoltfrq,chlcoltfrmstopms:e.dataForm.chlcoltfrmstopms,chlprotocol:e.id,protocoltype:e.dataForm.protocoltype,enablebackupchl:e.dataForm.enablebackupchl,gwsn:sessionStorage.getItem("gwsn"),chlmasterparam:JSON.stringify(e.dataForm.chlmasterparam),chlbackupparam:JSON.stringify(e.dataForm.chlbackupparam),valid:e.dataForm.valid},e.dataForm.chlbackupparam.timeout=Number(e.dataForm.chlbackupparam.timeout),l=t):(e.paramsData.forEach((function(a){a.chlmasterparam=JSON.stringify(a.chlmasterparam),a.chlbackupparam=JSON.stringify(a.chlbackupparam)})),l=e.paramsData);var x=[];e.$http[e.dataForm.id?"put":"post"](r,l).then((function(a){var t=a.data;if(0!==t.code)return e.loading=!1,e.$message.error(t.data||t.msg),!1;if(e.loading=!1,e.dataForm.id)if(-1!=e.chlprotocolName.toLowerCase().indexOf("modbus")){if(e.$message({message:e.$t("prompt.success"),type:"success",duration:500}),!e.$hasPermission("protocolSetattr:select:permission.do"))return e.loading=!1,void e.$message.warning("暂无规约参数查询权限, 请联系管理员");e.$http.get("/info/protocolSetattr/selectByGwsn",{params:{gwsn:sessionStorage.getItem("gwsn"),chlid:e.dataForm.id}}).then((function(a){var t=a.data;return 0!=t.code||t.data.length>0?(e.dataForm.chlprotocol=[],e.loading=!1,e.visible=!1,e.$emit("refreshDataList"),!1):e.$hasPermission("protocolDefattr:select:permission.do")?void e.$http.get("/info/protocolDefattr/selectByfpno",{params:{fpno:e.id}}).then((function(a){var t=a.data;if(0!=t.code)return e.dataForm.chlprotocol=[],e.loading=!1,e.visible=!1,e.$emit("refreshDataList"),!1;if(0==t.data.length)e.dataForm.chlprotocol=[],e.loading=!1,e.visible=!1,e.$emit("refreshDataList");else{if(x=t.data.map((function(a,t){return Object.assign(a,{chlId:e.dataForm.id,fpno:e.id,gwSn:sessionStorage.getItem("gwsn")})})),!e.$hasPermission("protocolSetattr:insert:permission.do"))return e.loading=!1,void e.$message.warning("暂无规约参数新增权限, 请联系管理员");e.$http.post("/info/protocolSetattr/insertBacth",x).then((function(a){var t=a.data;if(0!=t.code)return e.dataForm.chlprotocol=[],e.loading=!1,e.visible=!1,e.$emit("refreshDataList"),!1;e.dataForm.chlprotocol=[],e.loading=!1,e.visible=!1,e.$emit("refreshDataList")})).catch((function(a){}))}})).catch((function(a){})):(e.loading=!1,void e.$message.warning("暂无默认规约参数查询权限, 请联系管理员"))}))}else e.$message({message:e.$t("prompt.success"),type:"success",duration:500,onClose:function(){e.dataForm.chlprotocol=[],e.visible=!1,e.$emit("refreshDataList")}});else-1!=e.chlprotocolName.toLowerCase().indexOf("modbus")?(e.$message({message:e.$t("prompt.success"),type:"success",duration:500}),e.$http.get("/info/channelinfo/channelist",{params:{page:1,limit:200,gwsn:sessionStorage.getItem("gwsn"),chltype:0}}).then((function(a){var t=a.data;if(t.hasOwnProperty("code")&&0!=t.code)return e.dataForm.chlprotocol=[],e.loading=!1,e.visible=!1,e.$emit("refreshDataList"),!1;var r=t.list,o=[];if(r.forEach((function(a){l.forEach((function(e){a.chlname==e.chlname&&o.push(a.id)}))})),!e.$hasPermission("protocolDefattr:select:permission.do"))return e.loading=!1,void e.$message.warning("暂无默认规约参数查询权限, 请联系管理员");e.$http.get("/info/protocolDefattr/selectByfpno",{params:{fpno:e.id}}).then((function(a){var t=a.data;if(0!=t.code)return e.dataForm.chlprotocol=[],e.loading=!1,e.visible=!1,e.$emit("refreshDataList"),!1;if(0==t.data.length)e.dataForm.chlprotocol=[],e.loading=!1,e.visible=!1,e.$emit("refreshDataList");else{if(t.data.map((function(a,t){o.forEach((function(t){var r={};r=p(p({},a),{chlId:t,fpno:e.id,gwSn:sessionStorage.getItem("gwsn")}),x.push(r)}))})),!e.$hasPermission("protocolSetattr:insert:permission.do"))return e.loading=!1,void e.$message.warning("暂无规约参数新增权限, 请联系管理员");e.$http.post("/info/protocolSetattr/insertBacth",x).then((function(a){var t=a.data;if(0!=t.code)return e.dataForm.chlprotocol=[],e.loading=!1,e.visible=!1,e.$emit("refreshDataList"),!1;e.dataForm.chlprotocol=[],e.loading=!1,e.visible=!1,e.$emit("refreshDataList")})).catch((function(a){}))}})).catch((function(a){}))})).catch((function(a){}))):e.$message({message:e.$t("prompt.success"),type:"success",duration:500,onClose:function(){e.dataForm.chlprotocol=[],e.visible=!1,e.$emit("refreshDataList")}})})).catch((function(a){return e.loading=!1,e.dataForm.chlprotocol=[],e.visible=!1,e.$emit("refreshDataList")}))}))}else e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),handleClose:function(){this.dataForm.chlprotocol=[],this.refreshItem++,this.visible=!1}},beforeMount:function(){var a=Object(c["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=1,this.getprotocolinfoList();case 1:case"end":return a.stop()}}),a,this)})));function e(){return a.apply(this,arguments)}return e}()},f=u,b=(t("1ccd"),t("2877")),F=Object(b["a"])(f,r,l,!1,null,"96826c2c",null);e["default"]=F.exports}}]);
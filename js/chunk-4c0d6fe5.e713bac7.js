(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4c0d6fe5"],{"0cef":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.visible,title:e.dataForm.id?e.$t("update"):e.$t("add"),"close-on-click-modal":!1,"close-on-press-escape":!1,width:"40%","before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t},opened:e.openFun}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataForm",attrs:{model:e.dataForm,rules:e.rules,"label-width":"en-US"===e.$i18n.locale?"150px":"120px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dataFormSubmitHandle()}}},[t("el-form-item",{attrs:{label:"网关编号",prop:"sn"}},[t("el-select",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.handleGwsnScroll,expression:"handleGwsnScroll"}],staticStyle:{width:"100%"},attrs:{clearable:""},on:{"visible-change":e.handleGwsnVisibleChange},model:{value:e.dataForm.sn,callback:function(t){e.$set(e.dataForm,"sn",t)},expression:"dataForm.sn"}},[[t("div",{staticStyle:{width:"100%",position:"absolute",left:"0",top:"0","z-index":"99","background-color":"#fff"}},[t("el-input",{ref:"gwsnInput",staticStyle:{width:"98%","margin-left":"1%","margin-top":"5px","margin-bottom":"5px"},attrs:{size:"small",clearable:"",placeholder:e.$t("gwsn.pleaseEnterSearchContent")},model:{value:e.gwsnSearch,callback:function(t){e.gwsnSearch=t},expression:"gwsnSearch"}})],1),t("div",{staticStyle:{width:"100%",height:"42px"}}),e._l(e.tgwList,(function(a){return t("el-option",{key:a.sn,attrs:{label:a.sn,value:a.sn,disabled:!!a.hasOwnProperty("disabled")&&a.disabled}},[t("span",{staticStyle:{width:"100%",display:"inline-block","text-align":"left",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:a.sn}},[e._v("\n                            "+e._s(a.sn)+"\n                        ")])])}))]],2)],1),t("el-form-item",{attrs:{label:"共享用户名",prop:"sharename"}},[t("el-input",{attrs:{placeholder:"请输入共享用户名",clearable:""},model:{value:e.dataForm.sharename,callback:function(t){e.$set(e.dataForm,"sharename","string"===typeof t?t.trim():t)},expression:"dataForm.sharename"}})],1),t("el-form-item",{attrs:{label:"共享用户手机号",prop:"sharemobile"}},[t("el-input",{attrs:{maxlength:11,placeholder:"请输入共享用户手机号"},nativeOn:{keyup:function(t){return e.mobileValidate.apply(null,arguments)}},model:{value:e.dataForm.sharemobile,callback:function(t){e.$set(e.dataForm,"sharemobile",t)},expression:"dataForm.sharemobile"}})],1),t("el-form-item",{attrs:{label:"权限",prop:"type"}},[t("el-radio-group",{model:{value:e.dataForm.type,callback:function(t){e.$set(e.dataForm,"type",t)},expression:"dataForm.type"}},[t("el-radio",{attrs:{label:0}},[e._v("仅查看")]),t("el-radio",{attrs:{label:1}},[e._v("可编辑")])],1)],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:e.handleClose}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmitHandle()}}},[e._v(e._s(e.$t("confirm")))])],1)],2)},n=[],r=(a("7f7f"),a("c5f6"),a("a481"),a("b047")),i=a.n(r),o=a("61f7"),l={props:["id"],directives:{loadmore:{inserted:function(e,t){var a=e.querySelector(".el-select-dropdown .el-select-dropdown__wrap");a.addEventListener("scroll",(function(){var e=this.scrollHeight-Math.ceil(this.scrollTop)<=this.clientHeight;e&&0!==this.scrollTop&&t.value()}))}}},data:function(){return{isCloseDialog:!1,visible:!1,loading:!1,gwsnPage:1,gwsnTotal:0,gwsnSearch:"",tgwList:[],queryParamas:{},oldGwsnDesc:"",dataForm:{sn:"",sharename:"",sharemobile:"",shareId:null,type:0},rules:{sn:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],sharename:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],sharemobile:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]}}},methods:{init:function(){this.visible=!0},openFun:function(){var e=this;e.isCloseDialog=!1,e.$refs["dataForm"].resetFields(),e.dataForm.id=e.id,e.gwsnPage=1,e.gwsnTotal=0,e.tgwList=[],e.getAllGwsnDataList(),e.dataForm.id?e.$http.get("/shareSn/getById.do",{params:{id:e.dataForm.id}}).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);e.gwsnSearch=a.data.sn,e.dataForm.sn=a.data.sn,e.oldGwsnDesc=a.data.sn,e.dataForm.sharename=a.data.sname,e.dataForm.type=a.data.per})).catch((function(e){return!1})):e.getAllGwsnDataList()},mobileValidate:function(){this.dataForm.sharemobile=this.dataForm.sharemobile.replace(/[^\.\d]/g,""),this.dataForm.sharemobile=this.dataForm.sharemobile.replace(".","")},getAllGwsnDataList:function(){var e=this,t={pageNum:e.gwsnPage,pageSize:200,sn:e.gwsnSearch,_t:(new Date).getTime()};e.$http.get("/shareSn/getShareSnList.do",{params:t}).then((function(t){var a=t.data;if(a.hasOwnProperty("code")&&0!=a.code)return e.$message.error(a.data||a.msg);1==e.gwsnPage?e.tgwList=a.data.list.map((function(t){return{sn:t,gwDesc:e.$t("noMatchingDataYet")}})):e.tgwList=e.tgwList.concat(a.data.list.map((function(t){return{sn:t,gwDesc:e.$t("noMatchingDataYet")}}))),0==e.tgwList.length&&e.tgwList.push({sn:e.$t("noMatchingDataYet"),gwDesc:e.$t("noMatchingDataYet"),disabled:!0}),e.gwsnTotal=Number(a.data.total)})).catch((function(e){return!1}))},handleGwsnVisibleChange:function(e){var t=this;e&&this.$nextTick((function(){t.$refs.gwsnInput.focus()}))},handleGwsnScroll:function(){this.tgwList.length<this.gwsnTotal&&(this.gwsnPage++,this.getAllGwsnDataList())},handleClose:function(){this.isCloseDialog=!0,this.gwsnSearch="",this.visible=!1},dataFormSubmitHandle:i()((function(){var e=this,t=null;e.$refs["dataForm"].validate((function(a){return!!a&&(Object(o["b"])(e.dataForm.sharemobile)?void(e.$store.state.user.name!==e.dataForm.sharename.trim()?e.$http.get("/shareSn/getIdByUname.do",{params:{uname:e.dataForm.sharename,mobile:e.dataForm.sharemobile}}).then((function(a){var s=a.data;if(0!=s.code)e.$message.error(s.data||s.msg);else{if(!s.data)return e.$message.warning("暂无该用户，请确认后在进行操作"),!1;e.dataForm.id?(t=e.oldGwsnDesc===e.dataForm.sn?[{id:e.dataForm.id,suid:s.data,per:e.dataForm.type}]:[{id:e.dataForm.id,sn:e.dataForm.sn,suid:s.data,per:e.dataForm.type}],e.$http.put("/shareSn/update.do",t).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);e.$message({message:e.$t("prompt.success"),type:"success",duration:500,onClose:function(){e.isCloseDialog=!0,e.gwsnSearch="",e.visible=!1,e.$emit("refreshDataList")}})})).catch((function(e){return!1}))):(t=[{sn:e.dataForm.sn,suid:s.data,per:e.dataForm.type}],e.$http.post("/shareSn/insert.do",t).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);e.$message({message:e.$t("prompt.success"),type:"success",duration:500,onClose:function(){e.isCloseDialog=!0,e.gwsnSearch="",e.visible=!1,e.$emit("refreshDataList")}})})).catch((function(e){return!1})))}})).catch((function(e){return!1})):e.$message.warning("禁止共享给自己，请重新操作")):e.$message.error("请输入正确的手机号"))}))}),1e3,{leading:!0,trailing:!1}),watchGwsnSearch:i()((function(){var e=document.getElementsByClassName("el-scrollbar__wrap").length;document.getElementsByClassName("el-scrollbar__wrap")[e-1].scrollTo(0,0),this.gwsnPage=1,this.getAllGwsnDataList(),this.$refs.gwsnInput.focus()}),500)},watch:{gwsnSearch:function(e,t){this.isCloseDialog||this.watchGwsnSearch()}}},d=l,c=(a("5e64"),a("2877")),m=Object(c["a"])(d,s,n,!1,null,"6d99bbe4",null);t["default"]=m.exports},"5e64":function(e,t,a){"use strict";a("c67b")},c67b:function(e,t,a){}}]);
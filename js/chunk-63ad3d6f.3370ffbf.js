(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-63ad3d6f"],{2452:function(e,t,r){"use strict";r("3ab3")},"3ab3":function(e,t,r){},b2fc:function(e,t,r){"use strict";r.r(t);r("7f7f");var a=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.visible,title:e.dataForm.id?e.$t("update"):e.$t("add"),"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.visible=t},opened:e.handleDialogOpenChange}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataForm",attrs:{model:e.dataForm,rules:e.dataRule,"label-width":"120px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dataFormSubmitHandle()}}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"username",label:e.$t("user.username")}},[t("el-input",{attrs:{placeholder:e.$t("user.username"),clearable:""},model:{value:e.dataForm.username,callback:function(t){e.$set(e.dataForm,"username",t)},expression:"dataForm.username"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{staticClass:"dept-list",attrs:{prop:"deptName",label:e.$t("user.deptName")}},[t("el-popover",{ref:"deptListPopover",attrs:{placement:"bottom-start",trigger:"click"},model:{value:e.deptListVisible,callback:function(t){e.deptListVisible=t},expression:"deptListVisible"}},[t("el-input",{attrs:{size:"small",clearable:""},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),t("el-tree",{ref:"deptListTree",attrs:{id:"singleTree",data:e.deptList,props:{label:"name",children:"children"},"node-key":"id","highlight-current":!0,"expand-on-click-node":!1,accordion:"","filter-node-method":e.filterNode},on:{"current-change":e.deptListTreeCurrentChangeHandle}})],1),t("el-input",{directives:[{name:"popover",rawName:"v-popover:deptListPopover",arg:"deptListPopover"}],attrs:{readonly:!0,placeholder:e.$t("user.deptName")},model:{value:e.dataForm.deptName,callback:function(t){e.$set(e.dataForm,"deptName",t)},expression:"dataForm.deptName"}})],1)],1)],1),e.dataForm.id?e._e():t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{class:{"is-required":!e.dataForm.id},attrs:{prop:"password",label:e.$t("user.password")}},[t("el-input",{attrs:{type:"password",placeholder:e.$t("user.password"),"show-password":"",clearable:""},model:{value:e.dataForm.password,callback:function(t){e.$set(e.dataForm,"password",t)},expression:"dataForm.password"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{class:{"is-required":!e.dataForm.id},attrs:{prop:"comfirmPassword",label:e.$t("user.comfirmPassword")}},[t("el-input",{attrs:{type:"password",placeholder:e.$t("user.comfirmPassword"),"show-password":"",clearable:""},model:{value:e.dataForm.comfirmPassword,callback:function(t){e.$set(e.dataForm,"comfirmPassword",t)},expression:"dataForm.comfirmPassword"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"realName",label:e.$t("user.realName")}},[t("el-input",{attrs:{placeholder:e.$t("user.realName"),clearable:""},model:{value:e.dataForm.realName,callback:function(t){e.$set(e.dataForm,"realName",t)},expression:"dataForm.realName"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"gender",label:e.$t("user.gender"),size:"mini"}},[t("el-radio-group",{model:{value:e.dataForm.gender,callback:function(t){e.$set(e.dataForm,"gender",t)},expression:"dataForm.gender"}},[t("el-radio",{attrs:{label:0}},[e._v(e._s(e.$t("user.gender0")))]),t("el-radio",{attrs:{label:1}},[e._v(e._s(e.$t("user.gender1")))]),t("el-radio",{attrs:{label:2}},[e._v(e._s(e.$t("user.gender2")))])],1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"email",label:e.$t("user.email")}},[t("el-input",{attrs:{placeholder:e.$t("user.email"),clearable:""},model:{value:e.dataForm.email,callback:function(t){e.$set(e.dataForm,"email",t)},expression:"dataForm.email"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"mobile",label:e.$t("user.mobile")}},[t("el-input",{attrs:{placeholder:e.$t("user.mobile"),maxlength:11,clearable:""},nativeOn:{keyup:function(t){return e.mobileValidate.apply(null,arguments)}},model:{value:e.dataForm.mobile,callback:function(t){e.$set(e.dataForm,"mobile",t)},expression:"dataForm.mobile"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{staticClass:"role-list",attrs:{prop:"roleIdList",label:e.$t("user.roleIdList")}},[t("el-select",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.handleRoleScroll,expression:"handleRoleScroll"}],staticStyle:{width:"100%"},attrs:{multiple:"",clearable:"",placeholder:e.$t("user.roleIdList")},on:{"visible-change":e.handleRoleVisibleChange},model:{value:e.dataForm.roleIdList,callback:function(t){e.$set(e.dataForm,"roleIdList",t)},expression:"dataForm.roleIdList"}},[[t("div",{staticStyle:{width:"100%",position:"absolute",left:"0",top:"0","z-index":"99","background-color":"#fff"}},[t("el-input",{ref:"roleInput",staticStyle:{width:"98%","margin-left":"1%","margin-top":"5px","margin-bottom":"5px"},attrs:{size:"small",clearable:"",placeholder:e.$t("gwsn.pleaseEnterSearchContent")},model:{value:e.roleSearch,callback:function(t){e.roleSearch=t},expression:"roleSearch"}})],1),t("div",{staticStyle:{width:"100%",height:"42px"}}),e._l(e.roleList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id,disabled:!!e.hasOwnProperty("disabled")&&e.disabled}})}))]],2)],1)],1),1==e.superAdmin?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"pod",label:"pod"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("select"),filterable:""},model:{value:e.dataForm.pod,callback:function(t){e.$set(e.dataForm,"pod",t)},expression:"dataForm.pod"}},e._l(e.podList,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1):e._e(),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"status",label:e.$t("user.status"),size:"mini"}},[t("el-radio-group",{model:{value:e.dataForm.status,callback:function(t){e.$set(e.dataForm,"status",t)},expression:"dataForm.status"}},[t("el-radio",{attrs:{label:0}},[e._v(e._s(e.$t("user.status0")))]),t("el-radio",{attrs:{label:1}},[e._v(e._s(e.$t("user.status1")))])],1)],1)],1)],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:function(t){e.visible=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmitHandle()}}},[e._v(e._s(e.$t("confirm")))])],1)],2)},s=[],i=(r("8e6e"),r("456d"),r("4f7f"),r("1c4c"),r("2909")),o=r("ade3"),l=(r("c5f6"),r("a481"),r("ac6a"),r("5df3"),r("96cf"),r("1da1")),n=r("b047"),d=r.n(n),c=r("61f7");function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){Object(o["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var p={directives:{loadmore:{inserted:function(e,t){var r=e.querySelector(".el-select-dropdown .el-select-dropdown__wrap");r.addEventListener("scroll",(function(){var e=this.scrollHeight-Math.ceil(this.scrollTop)<=this.clientHeight;e&&0!==this.scrollTop&&t.value()}))}}},data:function(){return{rolePage:1,roleTotal:0,roleSearch:"",superAdmin:0,filterText:"",loading:!1,visible:!1,podList:[],deptList:[],deptListVisible:!1,roleList:[],roleIdListDefault:[],storeDateForm:null,dataForm:{id:"",username:"",deptId:0,deptName:"",password:"",comfirmPassword:"",realName:"",gender:0,email:"",mobile:"",roleIdList:[],status:1,pod:""}}},computed:{dataRule:function(){var e=this,t=function(t,r,a){if(!e.dataForm.id&&!/\S/.test(r))return a(new Error(e.$t("validate.required")));a()},r=function(t,r,a){return e.dataForm.id||/\S/.test(r)?e.dataForm.password!==r?a(new Error(e.$t("user.validate.comfirmPassword"))):void a():a(new Error(e.$t("validate.required")))},a=function(t,r,a){if(r&&!Object(c["a"])(r))return a(new Error(e.$t("validate.format",{attr:e.$t("user.email")})));a()},s=function(t,r,a){if(r&&!Object(c["b"])(r))return a(new Error(e.$t("validate.format",{attr:e.$t("user.mobile")})));a()};return{username:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],deptName:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],password:[{required:!0,validator:t,trigger:"change"},{min:6,message:this.$t("register.limitSix"),trigger:"change"}],comfirmPassword:[{required:!0,validator:r,trigger:"change"}],realName:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],email:[{required:!1,message:this.$t("validate.required"),trigger:"change"},{validator:a,trigger:"change"}],mobile:[{required:!1,message:this.$t("validate.required"),trigger:"change"},{validator:s,trigger:"change"}],roleIdList:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]}}},methods:{init:function(){this.rolePage=1,this.superAdmin=this.$store.state.user.superAdmin,this.visible=!0},handleDialogOpenChange:function(){var e=this;e.$refs["dataForm"].resetFields(),e.filterText="",e.roleIdListDefault=[],e.getUsedPodList(Object(l["a"])(regeneratorRuntime.mark((function t(){var r,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.dataForm.id){t.next=1;break}e.getInfo(),t.next=4;break;case 1:return r=Promise,t.next=2,e.getDeptList();case 2:return a=t.sent,t.next=3,e.getRoleList();case 3:s=t.sent,r.all.call(r,[a,s]).then((function(){}));case 4:case"end":return t.stop()}}),t)}))))},mobileValidate:function(){this.dataForm.mobile=this.dataForm.mobile.replace(/[^\.\d]/g,""),this.dataForm.mobile=this.dataForm.mobile.replace(".","")},getUsedPodList:function(e){var t=this,r={_t:(new Date).getTime()};t.podList=[],t.$hasPermission("pythonScript:select:permission.do")?t.$http.get("/pythonScript/getPodList.do",{params:r}).then((function(r){var a=r.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.podList=a.data,e()})).catch((function(e){return!1})):t.$message.warning("暂无Pod查询权限, 请联系管理员")},getDeptList:function(){var e=this;if(this.$hasPermission("dept:select:permission.do"))return this.$http.get("/sys/dept/getDeptList",{params:{}}).then((function(t){var r=t.data;if(0!==r.code)return e.$message.error(r.data||r.msg);e.deptList=r.data})).catch((function(e){return!1}));this.$message.warning("暂无部门查询权限, 请联系管理员")},filterNode:function(e,t,r){if(!e)return!0;r.level;var a=[];this.getReturnNode(r,a,e);var s=!1;return a.forEach((function(e){s=s||e})),s},getReturnNode:function(e,t,r){var a=e.data&&e.data.name&&-1!==e.data.name.indexOf(r);a&&t.push(a),!a&&1!=e.level&&e.parent&&this.getReturnNode(e.parent,t,r)},getRoleList:function(){var e=this,t={page:this.rolePage,limit:1e4,name:this.roleSearch};if(this.$hasPermission("role:select:permission.do"))return this.$http.get("/sys/role/getRoleList",{params:t}).then((function(t){var r=t.data;if(r.hasOwnProperty("code"))return e.$message.error(r.data||r.msg);1==e.rolePage?e.roleList=r.list:e.roleList=e.roleList.concat(r.list),0==e.roleList.length&&e.roleList.push({id:e.$t("noMatchingDataYet"),username:e.$t("noMatchingDataYet"),disabled:!0}),e.roleTotal=Number(r.total)})).catch((function(e){return!1}));this.$message.warning("暂无角色查询权限, 请联系管理员")},handleRoleVisibleChange:function(e){var t=this;e&&this.$nextTick((function(){t.$refs.roleInput.focus()}))},handleRoleScroll:function(){this.roleList.length<this.roleTotal&&(this.rolePage++,this.getRoleList())},getInfo:function(){var e=this;e.$hasPermission("sys:user:info")?(e.loading=!0,e.$http.get("/sys/user/".concat(e.dataForm.id)).then((function(t){var r=t.data;if(0!==r.code)return e.loading=!1,e.$message.error(r.data||r.msg);Promise.all([e.getDeptList(),e.getRoleList()]).then((function(){e.dataForm=u(u(u({},e.dataForm),r.data),{},{roleIdList:[]}),e.$refs.deptListTree.setCurrentKey(e.dataForm.deptId);for(var t=0;t<r.data.roleIdList.length;t++)e.roleList.filter((function(e){return e.id===r.data.roleIdList[t]}))[0]&&-1===e.dataForm.roleIdList.indexOf(r.data.roleIdList[t])?e.dataForm.roleIdList.push(r.data.roleIdList[t]):e.roleIdListDefault.push(r.data.roleIdList[t]);e.loading=!1}))})).catch((function(t){return e.loading=!1,!1}))):e.$message.warning("暂无用户信息查询权限, 请联系管理员")},deptListTreeCurrentChangeHandle:function(e,t){this.dataForm.deptId=e.id,this.dataForm.deptName=e.name,this.deptListVisible=!1,this.getRoleList()},dataFormSubmitHandle:d()((function(){var e=this,t="";this.$refs["dataForm"].validate((function(r){if(!r)return!1;if(!e.dataForm.email&&!e.dataForm.mobile)return e.$message.error("邮箱、手机号至少填写一个");if(e.loading=!0,e.dataForm.id){if(t="/sys/user",!e.$hasPermission("sys:user:update"))return void e.$message.error("暂无用户修改权限, 请联系管理员")}else if(t="/sys/user/insertShiro",!e.$hasPermission("sys:user:save"))return void e.$message.error("暂无用户新增权限, 请联系管理员");var a=[].concat(Object(i["a"])(e.dataForm.roleIdList),Object(i["a"])(e.roleIdListDefault));e.$http[e.dataForm.id?"put":"post"](t,u(u({},e.dataForm),{},{roleIdList:Array.from(new Set(a))})).then((function(t){var r=t.data;if(0!==r.code)return e.loading=!1,e.$message.error(r.data||r.msg);e.loading=!1,e.$message({message:e.$t("prompt.success"),type:"success",duration:500,onClose:function(){e.visible=!1,e.$emit("refreshDataList")}})})).catch((function(t){return e.loading=!1,!1}))}))}),1e3,{leading:!0,trailing:!1}),watchRoleSearch:d()((function(){var e=document.getElementsByClassName("el-scrollbar__wrap").length;document.getElementsByClassName("el-scrollbar__wrap")[e-1].scrollTo(0,0),this.rolePage=1,this.getRoleList(),this.$refs.roleInput.focus()}),500)},watch:{filterText:function(e){this.$refs.deptListTree.filter(e)},roleSearch:function(e,t){this.watchRoleSearch()}}},f=p,h=(r("2452"),r("ec86"),r("2877")),g=Object(h["a"])(f,a,s,!1,null,"92612150",null);t["default"]=g.exports},b8dd:function(e,t,r){},ec86:function(e,t,r){"use strict";r("b8dd")}}]);
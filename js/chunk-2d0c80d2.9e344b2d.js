(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c80d2"],{"52dc":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.visible,title:e.dataForm.id?e.$t("update"):e.$t("add"),"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.visible=t},opened:e.handleDialogOpenChange}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataForm",attrs:{model:e.dataForm,rules:e.rules,"label-width":(e.$i18n.locale,"150px")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dataFormSubmitHandle()}}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.belongDevicce"),prop:"devid"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("attribute.placeholderSelect")},on:{change:e.selectdevice},model:{value:e.dataForm.devid,callback:function(t){e.$set(e.dataForm,"devid",t)},expression:"dataForm.devid"}},e._l(e.equipmentList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.devId}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.tagname"),prop:"tagname"}},[t("el-select",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.handleTagScroll,expression:"handleTagScroll"}],staticStyle:{width:"100%"},attrs:{placeholder:e.$t("attribute.placeholderSelect")},on:{change:e.handleTagname,"visible-change":e.handleTagVisibleChange},model:{value:e.dataForm.tagname,callback:function(t){e.$set(e.dataForm,"tagname",t)},expression:"dataForm.tagname"}},[[t("div",{staticStyle:{width:"100%",position:"absolute",left:"0",top:"0","z-index":"99","background-color":"#fff"}},[t("el-input",{ref:"tagInput",staticStyle:{width:"98%","margin-left":"1%","margin-top":"5px","margin-bottom":"5px"},attrs:{size:"small",clearable:"",placeholder:e.$t("gwsn.pleaseEnterSearchContent")},model:{value:e.tagSearch,callback:function(t){e.tagSearch=t},expression:"tagSearch"}})],1),t("div",{staticStyle:{width:"100%",height:"42px"}}),e._l(e.tagList,(function(a,i){return t("el-option",{key:i,attrs:{label:a.label,value:a.value,disabled:!!a.hasOwnProperty("disabled")&&a.disabled}},[t("span",{staticStyle:{width:"50%",display:"inline-block","text-align":"left",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:a.label}},[e._v(e._s(a.label))]),t("span",{staticStyle:{color:"#8492a6","font-size":"13px",display:"inline-block","margin-left":"2%",width:"48%","text-align":"right",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:a.tagcomment}},[e._v(e._s(a.tagcomment||e.$t("none")))])])}))]],2)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.modelattribute"),prop:"tagcomment"}},[t("el-input",{ref:"tagcomment",attrs:{placeholder:e.$t("attribute.pleaseInputModelattribute"),maxlength:96,clearable:""},model:{value:e.dataForm.tagcomment,callback:function(t){e.$set(e.dataForm,"tagcomment",t)},expression:"dataForm.tagcomment"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.tagk"),prop:"k"}},[t("el-input",{attrs:{placeholder:e.$t("attribute.tagk"),onkeyup:"value=value.replace(/^([+-]?\\D*(\\d*(?:\\.\\d{0,6})?)).*$/g, '$1')",clearable:""},model:{value:e.dataForm.k,callback:function(t){e.$set(e.dataForm,"k",t)},expression:"dataForm.k"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.collecttypec"),prop:"collecttypec"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("attribute.placeholderSelect")},on:{change:e.handleFuncode},model:{value:e.dataForm.collecttypec,callback:function(t){e.$set(e.dataForm,"collecttypec",t)},expression:"dataForm.collecttypec"}},e._l(e.functionCodeType,(function(e){return t("el-option",{key:e.FuncCode,attrs:{label:e.description,value:e.FuncCode}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.address"),prop:"objaddr"}},[t("el-input",{attrs:{placeholder:e.$t("attribute.address"),maxlength:128,clearable:""},model:{value:e.dataForm.objaddr,callback:function(t){e.$set(e.dataForm,"objaddr",t)},expression:"dataForm.objaddr"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.datatype"),prop:"datatype"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("attribute.placeholderSelect")},on:{change:e.handleDataType},model:{value:e.dataForm.datatype,callback:function(t){e.$set(e.dataForm,"datatype",t)},expression:"dataForm.datatype"}},e._l(e.dataType,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.dataformat"),prop:"dataformat"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("attribute.placeholderSelect")},model:{value:e.dataForm.dataformat,callback:function(t){e.$set(e.dataForm,"dataformat",t)},expression:"dataForm.dataformat"}},e._l(e.hiloType,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),e.isYK?t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.remoteControl")}},[t("el-checkbox-group",{on:{change:e.changeType},model:{value:e.isTwoPointCtrl,callback:function(t){e.isTwoPointCtrl=t},expression:"isTwoPointCtrl"}},e._l(e.singleDoubleList,(function(a){return t("el-checkbox",{key:a.value,attrs:{label:a.value}},[e._v("\n                            "+e._s(a.label)+"\n                        ")])})),1)],1)],1)],1):e._e(),e.isYK&&0!=e.isTwoPointCtrl[0]?t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.controlPoints")}},[t("el-select",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.handleKfTagScroll,expression:"handleKfTagScroll"}],staticStyle:{width:"100%"},attrs:{placeholder:e.$t("attribute.placeholderSelect"),disabled:0===e.isTwoPointCtrl[0]},on:{"visible-change":e.handleKfTagVisibleChange},model:{value:e.dataForm.tagIdF,callback:function(t){e.$set(e.dataForm,"tagIdF",t)},expression:"dataForm.tagIdF"}},[[t("div",{staticStyle:{width:"100%",position:"absolute",left:"0",top:"0","z-index":"99","background-color":"#fff"}},[t("el-input",{ref:"kfTagInput",staticStyle:{width:"98%","margin-left":"1%","margin-top":"5px","margin-bottom":"5px"},attrs:{size:"small",clearable:"",placeholder:e.$t("gwsn.pleaseEnterSearchContent")},model:{value:e.kfTagSearch,callback:function(t){e.kfTagSearch=t},expression:"kfTagSearch"}})],1),t("div",{staticStyle:{width:"100%",height:"42px"}}),e._l(e.kfTagIdList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value,disabled:!!e.hasOwnProperty("disabled")&&e.disabled}})}))]],2)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.pointsValue")}},[t("el-input",{attrs:{placeholder:e.$t("attribute.pointsValue"),disabled:0===e.isTwoPointCtrl[0],onkeyup:"value=value.match(/\\d+\\.?\\d{0,10}/,'')",clearable:""},model:{value:e.dataForm.wvalueF,callback:function(t){e.$set(e.dataForm,"wvalueF",t)},expression:"dataForm.wvalueF"}})],1)],1)],1):e._e(),e.isYK&&0!=e.isTwoPointCtrl[0]?t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.chargedUs")}},[t("el-select",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.handleKhTagScroll,expression:"handleKhTagScroll"}],staticStyle:{width:"100%"},attrs:{placeholder:e.$t("attribute.placeholderSelect"),disabled:0===e.isTwoPointCtrl[0]},on:{"visible-change":e.handleKhTagVisibleChange},model:{value:e.dataForm.tagIdH,callback:function(t){e.$set(e.dataForm,"tagIdH",t)},expression:"dataForm.tagIdH"}},[[t("div",{staticStyle:{width:"100%",position:"absolute",left:"0",top:"0","z-index":"99","background-color":"#fff"}},[t("el-input",{ref:"khTagInput",staticStyle:{width:"98%","margin-left":"1%","margin-top":"5px","margin-bottom":"5px"},attrs:{size:"small",clearable:"",placeholder:e.$t("gwsn.pleaseEnterSearchContent")},model:{value:e.khTagSearch,callback:function(t){e.khTagSearch=t},expression:"khTagSearch"}})],1),t("div",{staticStyle:{width:"100%",height:"42px"}}),e._l(e.khTagIdList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value,disabled:!!e.hasOwnProperty("disabled")&&e.disabled}})}))]],2)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.chargedUsValue")}},[t("el-input",{attrs:{placeholder:e.$t("attribute.chargedUsValue"),disabled:0===e.isTwoPointCtrl[0],onkeyup:"value=value.match(/\\d+\\.?\\d{0,10}/,'')",clearable:""},model:{value:e.dataForm.wvalueH,callback:function(t){e.$set(e.dataForm,"wvalueH",t)},expression:"dataForm.wvalueH"}})],1)],1)],1):e._e()],1),t("template",{slot:"footer"},[t("el-button",{on:{click:function(t){e.visible=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmitHandle()}}},[e._v(e._s(e.$t("confirm")))])],1)],2)},l=[],r=(a("8e6e"),a("456d"),a("ade3")),o=(a("6762"),a("2fdb"),a("7514"),a("55dd"),a("a481"),a("c5f6"),a("53ca")),s=(a("ac6a"),a("5df3"),a("96cf"),a("1da1")),n=a("b047"),d=a.n(n);function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){Object(r["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var h={props:["queryParams"],directives:{loadmore:{inserted:function(e,t){var a=e.querySelector(".el-select-dropdown .el-select-dropdown__wrap");a.addEventListener("scroll",(function(){var e=this.scrollHeight-Math.ceil(this.scrollTop)<=this.clientHeight;e&&0!==this.scrollTop&&t.value()}))}}},data:function(){return{transId:null,storeDevId:"",storeTagChlid:"",paramsDevid:null,loading:!1,isYK:!1,childguid:"",visible:!1,tagSearch:"",paramsData:[],tagPage:1,tagTotal:0,tagList:[],isTwoPointCtrl:[],kfTagSearch:"",kfTagPage:1,kfTagTotal:0,kfTagIdList:[],khTagSearch:"",khTagPage:1,khTagTotal:0,khTagIdList:[],functionCodeType:[],equipmentList:[],dataForm:{id:null,tagchlid:"",devid:"",tagname:"",tagcomment:"",k:1,collecttypec:null,objaddr:"0",datatype:4,dataformat:0,isTwoPointCtrl:null,tagIdF:0,tagIdH:0,wvalueF:0,wvalueH:1,tagsource:2,gwsn:""},singleDoubleList:[{label:this.$t("attribute.singlePointControl"),value:0},{label:this.$t("attribute.doublePointControl"),value:1}],dataType:[{label:this.$t("attribute.bit"),value:0},{label:this.$t("attribute.eightNoSymbol"),value:1},{label:this.$t("attribute.eightSymbol"),value:2},{label:this.$t("attribute.sixteenNoSymbol"),value:3},{label:this.$t("attribute.sixteenSymbol"),value:4},{label:this.$t("attribute.thirtySecondNoSymbol"),value:5},{label:this.$t("attribute.thirtySecondSymbol"),value:6},{label:this.$t("attribute.sixteenBCD"),value:7},{label:this.$t("attribute.thirtySecondBCD"),value:8},{label:this.$t("attribute.singleFloat"),value:9},{label:this.$t("attribute.doubleFloat"),value:10},{label:this.$t("attribute.string"),value:11},{label:this.$t("attribute.sixtyFourUnsigned"),value:12},{label:this.$t("attribute.sixtyFourSigned"),value:13}],hiloType:[{label:"12",value:0},{label:"21",value:1},{label:"1234",value:2},{label:"2143",value:3},{label:"3412",value:4},{label:"4321",value:5}],rules:{devid:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],tagrwprop:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],k:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],collecttypec:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],objaddr:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],datatype:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],dataformat:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]}}},methods:{init:function(){this.visible=!0,this.loading=!0},handleDialogOpenChange:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,i,l=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.isYK=!1,t=Promise,e.next=1,this.getdevList();case 1:return a=e.sent,e.next=2,this.getInitTagList();case 2:i=e.sent,t.all.call(t,[a,i]).then((function(){l.$nextTick(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(l.$refs["dataForm"].resetFields(),l.$refs.tagcomment.focus(),!l.dataForm.id){e.next=2;break}return e.next=1,l.getInfo();case 1:e.next=4;break;case 2:if(!String(l.dataForm.datatype)){e.next=3;break}return e.next=3,l.handleDataType(l.dataForm.datatype);case 3:l.isTwoPointCtrl=[],l.isTwoPointCtrl.push(0),l.dataForm.wvalueF=0,l.dataForm.wvalueH=1;case 4:case"end":return e.stop()}}),e)}))))}));case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getInitTagList:function(){var e=this,t={page:1,limit:500,sort:"id asc",gwsn:sessionStorage.getItem("gwsn")};if(e.$hasSessionStorageGwsn()){if(e.tagList=[],e.kfTagIdList=[],e.khTagIdList=[],!e.$hasPermission("taginfo:select:permission.do"))return void e.$message.warning("暂无采集测点查询权限, 请联系管理员");e.$http.get("/info/taginfo/selectTags.do",{params:t}).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);"object"==Object(o["a"])(a.data)?(e.tagTotal=Number(a.data.total),e.kfTagTotal=Number(a.data.total),e.khTagTotal=Number(a.data.total),a.data.rows.length>0&&(a.data.rows.forEach((function(t){var a={},i={};a={label:t.tagname,value:t.tagname,tagId:t.tagid,tagcomment:t.tagcomment||""},i={label:t.tagname,value:Number(t.tagid)},e.tagList.push(a),e.kfTagIdList.push(i),e.khTagIdList.push(i)})),e.dataForm.id||(e.dataForm.tagname=e.tagList[0].value,e.dataForm.tagcomment=e.tagList[0].tagcomment||"",e.dataForm.tagIdF=e.kfTagIdList[0].value,e.dataForm.tagIdH=e.khTagIdList[0].value))):(e.tagList.push({value:e.$t("noMatchingDataYet"),label:e.$t("noMatchingDataYet"),tagId:"",tagcomment:"",disabled:!0}),e.kfTagIdList.push({value:e.$t("noMatchingDataYet"),label:e.$t("noMatchingDataYet"),disabled:!0}),e.khTagIdList.push({value:e.$t("noMatchingDataYet"),label:e.$t("noMatchingDataYet"),disabled:!0}))})).catch((function(e){return!1}))}else e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},getTagList:function(){var e=this,t={page:e.tagPage,limit:500,sort:"id asc",gwsn:sessionStorage.getItem("gwsn")};if(e.tagSearch&&(t["sname"]=e.tagSearch.replace(/_/g,"\\_").replace(/%/g,"\\%")),e.$hasSessionStorageGwsn()){if(1==e.tagPage&&(e.tagList=[]),!e.$hasPermission("taginfo:select:permission.do"))return void e.$message.warning("暂无采集测点查询权限, 请联系管理员");e.$http.get("/info/taginfo/selectTags.do",{params:t}).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);"object"==Object(o["a"])(a.data)?(e.tagTotal=Number(a.data.total),a.data.rows.length>0&&a.data.rows.forEach((function(t){var a={label:t.tagname,value:t.tagname,tagId:t.tagid,tagcomment:t.tagcomment||""};e.tagList.push(a)}))):e.tagList.push({value:e.$t("noMatchingDataYet"),label:e.$t("noMatchingDataYet"),tagId:"",tagcomment:"",disabled:!0})})).catch((function(e){return!1}))}else e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},handleTagVisibleChange:function(e){var t=this;e&&this.$nextTick((function(){t.$refs.tagInput.focus()}))},handleTagScroll:function(){this.tagList.length<this.tagTotal&&(this.tagPage++,this.getTagList())},getKfTagList:function(){var e=this,t={page:e.kfTagPage,limit:500,sort:"id asc",gwsn:sessionStorage.getItem("gwsn")};if(e.kfTagSearch&&(t["sname"]=e.kfTagSearch.replace(/_/g,"\\_").replace(/%/g,"\\%")),e.$hasSessionStorageGwsn()){if(1==e.kfTagPage&&(e.kfTagIdList=[]),!e.$hasPermission("taginfo:select:permission.do"))return void e.$message.warning("暂无采集测点查询权限, 请联系管理员");e.$http.get("/info/taginfo/selectTags.do",{params:t}).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);"object"==Object(o["a"])(a.data)?(e.kfTagTotal=Number(a.data.total),a.data.rows.length>0&&a.data.rows.forEach((function(t){var a={label:t.tagname,value:Number(t.tagid)};e.kfTagIdList.push(a)}))):e.kfTagIdList.push({value:e.$t("noMatchingDataYet"),label:e.$t("noMatchingDataYet"),disabled:!0})})).catch((function(e){return!1}))}else e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},handleKfTagVisibleChange:function(e){var t=this;e&&this.$nextTick((function(){t.$refs.kfTagInput.focus()}))},handleKfTagScroll:function(){this.kfTagIdList.length<this.kfTagTotal&&(this.kfTagPage++,this.getKfTagList())},getKhTagList:function(){var e=this,t={page:e.khTagPage,limit:500,sort:"id asc",gwsn:sessionStorage.getItem("gwsn")};if(e.khTagSearch&&(t["sname"]=e.khTagSearch.replace(/_/g,"\\_").replace(/%/g,"\\%")),e.$hasSessionStorageGwsn()){if(1==e.khTagPage&&(e.khTagIdList=[]),!e.$hasPermission("taginfo:select:permission.do"))return void e.$message.warning("暂无采集测点查询权限, 请联系管理员");e.$http.get("/info/taginfo/selectTags.do",{params:t}).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);"object"==Object(o["a"])(a.data)?(e.khTagTotal=Number(a.data.total),a.data.rows.length>0&&a.data.rows.forEach((function(t){var a={label:t.tagname,value:Number(t.tagid)};e.khTagIdList.push(a)}))):e.khTagIdList.push({value:e.$t("noMatchingDataYet"),label:e.$t("noMatchingDataYet"),disabled:!0})})).catch((function(e){return!1}))}else e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},handleKhTagVisibleChange:function(e){var t=this;e&&this.$nextTick((function(){t.$refs.khTagInput.focus()}))},handleKhTagScroll:function(){this.khTagIdList.length<this.khTagTotal&&(this.khTagPage++,this.getKhTagList())},compareBySort:function(e,t){return e.sort((function(e,a){return e[t]-a[t]}))},getdevList:function(){var e=this;if(this.$hasSessionStorageGwsn()){this.equipmentList=[];var t={gwsn:sessionStorage.getItem("gwsn")};if(!this.$hasPermission("list:getChlList:select:permission.do"))return void this.$message.warning("暂无通道查询权限, 请联系管理员");this.$http.get("/list/getChlList.do",{params:t}).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);if(a.data.length>0)if(a.data.forEach((function(t){1==t.chlType&&t.dev2PojoList&&t.dev2PojoList.length>0&&t.dev2PojoList.forEach((function(a){var i={label:a.devName+"-"+t.chlName,devId:a.devID,chlId:t.chlID};e.equipmentList.push(i)}))})),e.equipmentList.length>0){if(e.equipmentList=e.compareBySort(e.equipmentList,"devId"),!e.dataForm.id&&e.equipmentList.length>0){if(e.paramsDevid)for(var i=0;i<e.equipmentList.length;i++){var l=e.equipmentList[i];if(e.paramsDevid==l.devId){e.dataForm.devid=l.devId;break}}else if(e.queryParams.devId)for(var r=0;r<e.equipmentList.length;r++){var o=e.equipmentList[r];if(e.queryParams.devId==o.devId){e.dataForm.devid=o.devId;break}}else e.dataForm.devid=e.equipmentList[0].devId;e.selectdevice(e.dataForm.devid)}}else e.loading=!1,setTimeout((function(){return e.visible=!1,e.$message.warning(e.$t("attribute.currentlyNoForwardingDevices"))}),1e3)})).catch((function(e){return!1}))}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},selectdevice:function(e){var t=this;if(t.$hasSessionStorageGwsn()){if(!t.$hasPermission("deviceinfo:selectByDevidAndGwsn:permission.do"))return void t.$message.warning("暂无设备信息查询权限, 请联系管理员");t.$http.get("/info/deviceinfo/getByDevidAndGwsn",{params:{devid:e,gwsn:sessionStorage.getItem("gwsn")}}).then((function(e){var a=e.data;if(0!==a.code)return t.$message.error(a.data||a.msg);t.$hasPermission("channelinfo:info:select:permission.do")?t.$http.get("/info/channelinfo/getByChliId",{params:{chlid:a.data[0].chlid,gwsn:sessionStorage.getItem("gwsn")}}).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.dataForm.tagchlid=a.data[0].chlid,t.childguid=a.data[0].chlprotocol,t.getguidinfo(t.childguid)})).catch((function(e){})):t.$message.warning("暂无通道信息查询权限, 请联系管理员")})).catch((function(e){return!1}))}else t.$message({showClose:!1,message:t.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}})},handleTagname:function(e){this.dataForm.tagcomment=this.tagList.find((function(t){return e===t.label})).tagcomment||"";for(var t=0;t<this.tagIdList.length;t++){var a=this.tagIdList[t];if(e===a.label&&0===this.isTwoPointCtrl[0]){this.dataForm.tagIdF=a.value,this.dataForm.tagIdH=a.value;break}}},handleFuncode:function(e){var t=this.functionCodeType.find((function(t){return t.FuncCode===e}));this.isYK=!!t&&t.description.includes(this.$t("attribute.remoteControl"))},changeType:function(e){if(e.length>1&&this.isTwoPointCtrl.splice(0,1),0===e[0])for(var t=0;t<this.tagIdList.length;t++){var a=this.tagIdList[t];if(this.dataForm.tagname===a.label){this.dataForm.tagIdF=a.value,this.dataForm.tagIdH=a.value;break}}},getguidinfo:function(e){var t=this;this.functionCodeType=[],this.$hasPermission("protocolinfo:select:permission.do")?this.$http.get("/info/protocolinfo/proguid",{params:{guid:e}}).then((function(e){var a=e.data;if(t.loading=!1,0!==a.code)return t.$message.error(a.data||a.msg);if(a.data.length>0&&(t.functionCodeType=JSON.parse(a.data[0].funccode).data,t.functionCodeType.length>0))if(t.dataForm.id)for(var i=0;i<t.functionCodeType.length;i++){var l=t.functionCodeType[i];if(t.dataForm.collecttypec==l.FuncCode&&-1!=l.description.indexOf(t.$t("attribute.remoteControl"))){t.isYK=!0;break}}else t.dataForm.collecttypec=t.functionCodeType[0].FuncCode})).catch((function(e){return!1})):this.$message.warning("暂无协议信息查询权限, 请联系管理员")},handleDataType:function(e){var t=this,a=!1;if(0==e){a=!1,this.hiloType=[{label:"12",value:0},{label:"21",value:1}];for(var i=0;i<this.hiloType.length;i++){var l=this.hiloType[i];if(this.dataForm.dataformat==l.value){a=!0;break}}}else if(1==e){a=!1,this.hiloType=[{label:"12",value:0},{label:"21",value:1}];for(var r=0;r<this.hiloType.length;r++){var o=this.hiloType[r];if(this.dataForm.dataformat==o.value){a=!0;break}}}else if(2==e){a=!1,this.hiloType=[{label:"12",value:0},{label:"21",value:1}];for(var s=0;s<this.hiloType.length;s++){var n=this.hiloType[s];if(this.dataForm.dataformat==n.value){a=!0;break}}}else if(3==e){a=!1,this.hiloType=[{label:"12",value:0},{label:"21",value:1}];for(var d=0;d<this.hiloType.length;d++){var c=this.hiloType[d];if(this.dataForm.dataformat==c.value){a=!0;break}}}else if(4==e){a=!1,this.hiloType=[{label:"12",value:0},{label:"21",value:1}];for(var g=0;g<this.hiloType.length;g++){var h=this.hiloType[g];if(this.dataForm.dataformat==h.value){a=!0;break}}}else if(5==e){a=!1,this.hiloType=[{label:"1234",value:2},{label:"2143",value:3},{label:"3412",value:4},{label:"4321",value:5}];for(var u=0;u<this.hiloType.length;u++){var m=this.hiloType[u];if(this.dataForm.dataformat==m.value){a=!0;break}}}else if(6==e){a=!1,this.hiloType=[{label:"1234",value:2},{label:"2143",value:3},{label:"3412",value:4},{label:"4321",value:5}];for(var f=0;f<this.hiloType.length;f++){var p=this.hiloType[f];if(this.dataForm.dataformat==p.value){a=!0;break}}}else if(7==e){a=!1,this.hiloType=[{label:"12",value:0},{label:"21",value:1}];for(var v=0;v<this.hiloType.length;v++){var b=this.hiloType[v];if(this.dataForm.dataformat==b.value){a=!0;break}}}else if(8==e){a=!1,this.hiloType=[{label:"1234",value:2},{label:"2143",value:3},{label:"3412",value:4},{label:"4321",value:5}];for(var T=0;T<this.hiloType.length;T++){var $=this.hiloType[T];if(this.dataForm.dataformat==$.value){a=!0;break}}}else if(9==e){a=!1,this.hiloType=[{label:"1234",value:2},{label:"2143",value:3},{label:"3412",value:4},{label:"4321",value:5}];for(var w=0;w<this.hiloType.length;w++){var y=this.hiloType[w];if(this.dataForm.dataformat==y.value){a=!0;break}}}else if(10==e){a=!1,this.hiloType=[{label:"1234",value:2},{label:"2143",value:3},{label:"3412",value:4},{label:"4321",value:5}];for(var F=0;F<this.hiloType.length;F++){var k=this.hiloType[F];if(this.dataForm.dataformat==k.value){a=!0;break}}}else if(11==e){a=!1,this.hiloType=[{label:"12",value:0},{label:"21",value:1},{label:"1234",value:2},{label:"2143",value:3},{label:"3412",value:4},{label:"4321",value:5}];for(var S=0;S<this.hiloType.length;S++){var I=this.hiloType[S];if(this.dataForm.dataformat==I.value){a=!0;break}}}else if(12==e){a=!1,this.hiloType=[{label:"1234",value:2},{label:"2143",value:3},{label:"3412",value:4},{label:"4321",value:5}];for(var C=0;C<this.hiloType.length;C++){var L=this.hiloType[C];if(this.dataForm.dataformat==L.value){a=!0;break}}}else if(13==e){a=!1,this.hiloType=[{label:"1234",value:2},{label:"2143",value:3},{label:"3412",value:4},{label:"4321",value:5}];for(var P=0;P<this.hiloType.length;P++){var x=this.hiloType[P];if(this.dataForm.dataformat==x.value){a=!0;break}}}this.$nextTick((function(){a||(t.dataForm.id?t.dataForm.dataformat=void 0:t.dataForm.dataformat=t.hiloType[0].value)}))},getInfo:function(){var e=this;this.$hasPermission("transtaginfo:select:permission.do")?this.$hasPermission("channelinfo:info:select:permission.do")?(this.loading=!0,this.$http.get("/info/transtaginfo/selectById.do",{params:{transid:this.transId,sn:sessionStorage.getItem("gwsn")}}).then((function(t){var a=t.data;if(0!==a.code)return e.loading=!1,e.$message.error(a.data||a.msg);e.isTwoPointCtrl=[],e.isTwoPointCtrl.push(a.data.isTwoPointCtrl),e.dataForm=g(g({},e.dataForm),a.data),e.storeDevId=e.dataForm.devid,e.storeTagChlid=e.dataForm.tagchlid,e.dataForm.devid=Number(a.data.devid),e.tagSearch=a.data.tagname,a.data.fname&&(e.kfTagSearch=a.data.fname),a.data.hname&&(e.khTagSearch=a.data.hname),String(e.dataForm.datatype)&&e.handleDataType(e.dataForm.datatype),e.$http.get("/info/channelinfo/getByChliId",{params:{chlid:e.dataForm.tagchlid,gwsn:sessionStorage.getItem("gwsn")}}).then((function(t){var a=t.data;if(0!=a.code)return e.loading=!1,e.$message.error(a.data||a.msg);e.getguidinfo(a.data[0].chlprotocol)})).catch((function(t){return e.loading=!1,!1}))})).catch((function(t){return e.loading=!1,!1}))):this.$message.warning("暂无通道信息查询权限, 请联系管理员"):this.$message.warning("暂无转发测点信息查询权限, 请联系管理员")},dataFormSubmitHandle:d()((function(){var e=this,t=this,a="",i=null;if(t.$hasSessionStorageGwsn()){if(t.dataForm.id){if(!t.$hasPermission("transtaginfo:update:permission.do"))return void t.$message.warning("暂无转发测点修改权限, 请联系管理员");if(t.dataForm.devid==t.storeDevId&&t.dataForm.tagchlid==t.storeTagChlid);else if(!t.$hasPermission("channelinfo:updateTagDevId:permission.do"))return void t.$message.warning("暂无转发测点修改至设备权限, 请联系管理员")}else if(!t.$hasPermission("transtaginfo:insert:permission.do"))return void t.$message.warning("暂无转发测点新增权限, 请联系管理员");t.paramsData=[],t.$refs["dataForm"].validate((function(l){return!!l&&(t.dataForm.tagname?(t.dataForm.isTwoPointCtrl=Number(t.isTwoPointCtrl.join(",")),void(1==t.dataForm.isTwoPointCtrl?t.$nextTick((function(){t.loading=!0,t.dataForm.id?(a="/info/transtaginfo",i=t.dataForm):(a="/info/transtaginfo/insertAdd",t.dataForm.gwsn=sessionStorage.getItem("gwsn"),t.paramsData.push(t.dataForm),i=t.paramsData),t.$http[t.dataForm.id?"put":"post"](a,i).then((function(a){var i=a.data;if(0!==i.code)return t.loading=!1,t.$message.error(i.data||i.msg);e.dataForm.id?t.dataForm.devid==t.storeDevId&&t.dataForm.tagchlid==t.storeTagChlid?(t.loading=!1,t.$message({message:t.$t("prompt.success"),type:"success",duration:500,onClose:function(){t.storeDevId="",t.storeTagChlid="",t.visible=!1,t.$emit("refreshDataList")}})):t.$http.get("/info/channelinfo/updateTagDevId.do",{params:{sn:sessionStorage.getItem("gwsn"),tagIds:t.dataForm.transid,devId:t.dataForm.devid,type:1,chlId:t.dataForm.tagchlid}}).then((function(e){var a=e.data;if(0!=a.code)return t.loading=!1,t.$message.error(a.data||a.msg);t.loading=!1,t.$message({message:t.$t("prompt.success"),type:"success",duration:500,onClose:function(){t.storeDevId="",t.storeTagChlid="",t.visible=!1,t.$emit("refreshDataList")}})})).catch((function(e){return t.loading=!1,!1})):(t.loading=!1,t.$message({message:t.$t("prompt.success"),type:"success",duration:500,onClose:function(){t.storeDevId="",t.storeTagChlid="",t.visible=!1,t.$emit("refreshDataList")}}))})).catch((function(e){return t.loading=!1,t.visible=!1,t.$emit("refreshDataList")}))})):(t.loading=!0,t.dataForm.tagIdH=0,t.dataForm.tagIdF=0,t.dataForm.id?(a="/info/transtaginfo",i=t.dataForm):(a="/info/transtaginfo/insertAdd",t.dataForm.gwsn=sessionStorage.getItem("gwsn"),t.paramsData.push(t.dataForm),i=t.paramsData),t.$http[t.dataForm.id?"put":"post"](a,i).then((function(a){var i=a.data;if(0!==i.code)return t.loading=!1,t.$message.error(i.data||i.msg);e.dataForm.id?t.dataForm.devid==t.storeDevId&&t.dataForm.tagchlid==t.storeTagChlid?(t.loading=!1,t.$message({message:t.$t("prompt.success"),type:"success",duration:500,onClose:function(){t.storeDevId="",t.storeTagChlid="",t.visible=!1,t.$emit("refreshDataList")}})):t.$http.get("/info/channelinfo/updateTagDevId.do",{params:{sn:sessionStorage.getItem("gwsn"),tagIds:t.dataForm.transid,devId:t.dataForm.devid,type:1,chlId:t.dataForm.tagchlid}}).then((function(e){var a=e.data;if(0!=a.code)return t.loading=!1,t.$message.error(a.data||a.msg);t.loading=!1,t.$message({message:t.$t("prompt.success"),type:"success",duration:500,onClose:function(){t.storeDevId="",t.storeTagChlid="",t.visible=!1,t.$emit("refreshDataList")}})})).catch((function(e){return t.loading=!1,!1})):(t.loading=!1,t.$message({message:t.$t("prompt.success"),type:"success",duration:500,onClose:function(){t.storeDevId="",t.storeTagChlid="",t.visible=!1,t.$emit("refreshDataList")}}))})).catch((function(e){return t.storeDevId="",t.storeTagChlid="",t.loading=!1,t.visible=!1,t.$emit("refreshDataList")}))))):t.$message.warning(t.$t("attribute.measuringPointNameCannotBeEmpty")))}))}else t.$message({showClose:!1,message:t.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),watchTagSearch:d()((function(){var e=document.getElementsByClassName("el-scrollbar__wrap").length;document.getElementsByClassName("el-scrollbar__wrap")[e-1].scrollTo(0,0),this.tagPage=1,this.getTagList(),this.$refs.tagInput.focus()}),500),watchKfTagSearch:d()((function(){var e=document.getElementsByClassName("el-scrollbar__wrap").length;document.getElementsByClassName("el-scrollbar__wrap")[e-1].scrollTo(0,0),this.kfTagPage=1,this.getKfTagList(),this.$refs.kfTagInput.focus()}),500),watchKhTagSearch:d()((function(){var e=document.getElementsByClassName("el-scrollbar__wrap").length;document.getElementsByClassName("el-scrollbar__wrap")[e-1].scrollTo(0,0),this.khTagPage=1,this.getKhTagList(),this.$refs.khTagInput.focus()}),500)},watch:{tagSearch:function(e,t){this.watchTagSearch()},kfTagSearch:function(e,t){this.watchKfTagSearch()},khTagSearch:function(e,t){this.watchKhTagSearch()}}},u=h,m=a("2877"),f=Object(m["a"])(u,i,l,!1,null,null,null);t["default"]=f.exports}}]);
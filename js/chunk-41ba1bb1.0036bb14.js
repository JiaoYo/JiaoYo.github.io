(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-41ba1bb1"],{2836:function(e,t,a){"use strict";a("d02a")},"3b30":function(e,t,a){},d02a:function(e,t,a){},de64:function(e,t,a){"use strict";a("3b30")},f747:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.debuggerVisible,title:e.$t("debuggerInfo.title")+"("+e.dataForm.sn+"-"+(e.gwDesc||e.$t("gwsn.noDesc"))+")","close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":e.handleClose,width:"60%"},on:{"update:visible":function(t){e.debuggerVisible=t}}},[t("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.handleClick,edit:e.handleTabsCancelWebsocketChange},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$t("debuggerInfo.gwsnDebugger"),name:"first"}},[t("el-form",{ref:"debugForm",attrs:{model:e.debugForm,rules:e.rules,"label-width":"80px"}},[t("el-row",[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{prop:"comname",label:e.$t("debuggerInfo.com_name")}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",filterable:"",placeholder:e.$t("debuggerInfo.pleaseSelect"),disabled:!e.isOpenOrClose},model:{value:e.debugForm.comname,callback:function(t){e.$set(e.debugForm,"comname",t)},expression:"debugForm.comname"}},e._l(e.comnameList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{prop:"timeout",label:e.$t("debuggerInfo.timeOut")}},[t("el-input",{attrs:{clearable:"",size:"small",placeholder:e.$t("debuggerInfo.enterTimeout"),maxlength:10,disabled:!e.isOpenOrClose},model:{value:e.debugForm.timeout,callback:function(t){e.$set(e.debugForm,"timeout",t)},expression:"debugForm.timeout"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",[e.isOpenOrClose?t("el-button",{attrs:{size:"small"},on:{click:e.handleOpenPort}},[e._v(e._s(e.$t("debuggerInfo.openComName"))+" ")]):e._e(),e.isOpenOrClose?e._e():t("el-button",{attrs:{size:"small"},on:{click:e.handleClosePort}},[e._v(e._s(e.$t("debuggerInfo.closeCom"))+" ")])],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{prop:"baud",label:e.$t("debuggerInfo.baud")}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",filterable:"",placeholder:e.$t("debuggerInfo.pleaseSelect"),disabled:!e.isOpenOrClose},model:{value:e.debugForm.baud,callback:function(t){e.$set(e.debugForm,"baud",t)},expression:"debugForm.baud"}},e._l(e.baudList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{prop:"databit",label:e.$t("debuggerInfo.databit")}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",filterable:"",placeholder:e.$t("debuggerInfo.pleaseSelect"),disabled:!e.isOpenOrClose},model:{value:e.debugForm.databit,callback:function(t){e.$set(e.debugForm,"databit",t)},expression:"debugForm.databit"}},e._l(e.databitList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{prop:"stopbit",label:e.$t("debuggerInfo.stopbit")}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",filterable:"",placeholder:e.$t("debuggerInfo.pleaseSelect"),disabled:!e.isOpenOrClose},model:{value:e.debugForm.stopbit,callback:function(t){e.$set(e.debugForm,"stopbit",t)},expression:"debugForm.stopbit"}},e._l(e.stopbitList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{prop:"checkbit",label:e.$t("debuggerInfo.checkbit")}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",filterable:"",placeholder:e.$t("debuggerInfo.pleaseSelect"),disabled:!e.isOpenOrClose},model:{value:e.debugForm.checkbit,callback:function(t){e.$set(e.debugForm,"checkbit",t)},expression:"debugForm.checkbit"}},e._l(e.checkbitList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1)],1),t("el-form",{ref:"sendForm",attrs:{model:e.sendForm,rules:e.sendRules,"label-width":"20px"}},[t("el-row",[t("el-col",{attrs:{span:10}},[t("el-form-item",[t("el-checkbox-group",{on:{change:e.handleChecked},model:{value:e.sendForm.checkedList,callback:function(t){e.$set(e.sendForm,"checkedList",t)},expression:"sendForm.checkedList"}},e._l(e.checkList,(function(a){return t("el-checkbox",{key:a.value,staticStyle:{"margin-right":"0"},attrs:{size:"small",label:a.value}},[e._v("\n                                    "+e._s(a.label)+"\n                                ")])})),1)],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",[t("el-button",{attrs:{size:"small"},on:{click:e.clearView}},[e._v(e._s(e.$t("debuggerInfo.clearView"))+" ")]),t("el-button",{staticClass:"receiveTextareaCopy",attrs:{size:"small","data-clipboard-target":"#receiveTextarea",id:"receiveTextareaCopy"},on:{click:e.copyView}},[e._v(e._s(e.$t("debuggerInfo.copyView"))+" ")])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",[t("el-button",{attrs:{size:"small"},on:{click:e.sendData}},[e._v(e._s(e.$t("debuggerInfo.sendData")))]),t("el-checkbox",{staticStyle:{"margin-left":"10px"},on:{change:e.handleRepeat},model:{value:e.sendForm.isRepeat,callback:function(t){e.$set(e.sendForm,"isRepeat",t)},expression:"sendForm.isRepeat"}}),t("span",{staticStyle:{margin:"0 5px"}},[e._v(e._s(e.$t("debuggerInfo.repeat")))]),t("el-input",{staticStyle:{width:"35%"},attrs:{clearable:"",size:"small",placeholder:e.$t("debuggerInfo.enterNumber")},on:{input:e.setRepeatInterval},nativeOn:{keyup:function(t){return e.handleRepeatIntervalChange.apply(null,arguments)}},model:{value:e.sendForm.interval,callback:function(t){e.$set(e.sendForm,"interval",t)},expression:"sendForm.interval"}}),t("span",{staticStyle:{"margin-left":"5px"}},[e._v("ms")])],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{prop:"content"}},[t("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:e.$t("debuggerInfo.enterContent"),maxlength:255},model:{value:e.sendForm.content,callback:function(t){e.$set(e.sendForm,"content",t)},expression:"sendForm.content"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",[t("div",{staticStyle:{width:"100%",height:"260px","overflow-y":"auto",border:"1px solid #dcdfe6"},attrs:{id:"receiveTextarea"}})])],1)],1)],1)],1),t("el-tab-pane",{attrs:{label:e.$t("debuggerInfo.commandLine"),name:"second",closable:!("second"!==e.activeName||!e.loading)}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataForm",attrs:{model:e.dataForm,rules:e.dataFormRules,"label-width":"50px"},nativeOn:{submit:function(e){e.preventDefault()},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.send()}}},[1==e.superAdmin?t("el-row",[t("el-col",{attrs:{span:9}},[t("el-form-item",{attrs:{label:e.$t("debuggerInfo.command"),prop:"inputValue"}},[t("input-select",{staticStyle:{width:"100%"},attrs:{"empty-value":"",parameter:e.paramsData},on:{change:e.onChangeFun,changeCmdData:e.changeCmdData},model:{value:e.dataForm.inputValue,callback:function(t){e.$set(e.dataForm,"inputValue",t)},expression:"dataForm.inputValue"}})],1)],1),t("el-col",{attrs:{span:11}},[-1!=String(this.dataForm.inputValue).indexOf("tail")?t("el-form-item",{attrs:{label:"——",prop:"addContent"}},[t("el-input",{attrs:{type:"text",clearable:"",placeholder:e.$t("debuggerInfo.enterContent")},on:{input:e.handleInputAddContentChange},model:{value:e.dataForm.addContent,callback:function(t){e.$set(e.dataForm,"addContent",t)},expression:"dataForm.addContent"}})],1):t("el-form-item",{attrs:{label:"——",prop:"addContent"}},[t("el-input",{attrs:{type:"text",placeholder:e.$t("debuggerInfo.enterContent"),clearable:""},model:{value:e.dataForm.addContent,callback:function(t){e.$set(e.dataForm,"addContent",t)},expression:"dataForm.addContent"}})],1)],1),t("el-col",{staticStyle:{"text-align":"right"},attrs:{span:3}},[t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.send}},[e._v(e._s(e.$t("debuggerInfo.send")))])],1)],1)],1):e._e(),0==e.superAdmin?t("el-row",[t("el-col",{attrs:{span:9}},[t("el-form-item",{attrs:{label:e.$t("debuggerInfo.command"),prop:"inputValue"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("debuggerInfo.pleaseSelect")},on:{change:e.selectCommand},model:{value:e.dataForm.inputValue,callback:function(t){e.$set(e.dataForm,"inputValue",t)},expression:"dataForm.inputValue"}},e._l(e.commandList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:9}},[-1!=String(this.dataForm.inputValue).indexOf("tail")?t("el-form-item",{attrs:{label:"——",prop:"addContent"}},[t("el-input",{attrs:{type:"text",clearable:"",placeholder:e.$t("debuggerInfo.enterContent")},on:{input:e.handleInputAddContentChange},model:{value:e.dataForm.addContent,callback:function(t){e.$set(e.dataForm,"addContent",t)},expression:"dataForm.addContent"}})],1):t("el-form-item",{attrs:{label:"——",prop:"addContent"}},[t("el-input",{attrs:{type:"text",placeholder:e.$t("debuggerInfo.enterContent"),clearable:""},model:{value:e.dataForm.addContent,callback:function(t){e.$set(e.dataForm,"addContent",t)},expression:"dataForm.addContent"}})],1)],1),t("el-col",{attrs:{span:4,offset:2}},[t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.send}},[e._v(e._s(e.$t("debuggerInfo.send")))])],1)],1)],1):e._e(),t("el-row",[t("el-form-item",{attrs:{label:"",prop:"content"}},[t("el-input",{attrs:{type:"textarea",autosize:{minRows:15,maxRows:12},placeholder:"",readonly:""},model:{value:e.dataForm.content,callback:function(t){e.$set(e.dataForm,"content",t)},expression:"dataForm.content"}})],1)],1)],1)],1)],1)],1)},o=[],s=a("53ca"),i=(a("6762"),a("2fdb"),a("f559"),a("4917"),a("a481"),a("ac6a"),a("28a5"),a("7f7f"),a("6b54"),a("bc3a")),r=a.n(i),l=a("b311"),d=a.n(l),u=a("b047"),g=a.n(u),c=function(){var e=this,t=e._self._c;return t("div",{class:e.innerContainerClass,on:{click:function(t){e.isShow=!e.isShow}}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.currName,expression:"currName"}],class:[e.innerInputClass,{active:e.isShow}],staticStyle:{height:"40px"},domProps:{value:e.currName},on:{input:[function(t){t.target.composing||(e.currName=t.target.value)},e.handleInput]}}),t("i",{class:["vue-input-select-triangle",{active:e.isShow}]}),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],ref:"itemlist",class:e.innerListClass,style:e.listHeightStyle},e._l(e.currParameter,(function(a,n){return t("div",{key:n,class:[e.innerItemClass,{selected:e.currValue===a.value.toString()}],on:{click:function(t){return e.setValue(a.value)}}},[e._v("\n            "+e._s(a.label)+"\n        ")])})),0)])},m=[];a("ac4d"),a("8a81"),a("5df3"),a("1c4c");function b(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=p(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,r=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return i=e.done,e},e:function(e){r=!0,s=e},f:function(){try{i||null==a.return||a.return()}finally{if(r)throw s}}}}function p(e,t){if(e){if("string"==typeof e)return h(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}var f={name:"input-select",data:function(){return{isShow:!1,currValue:"",currName:"",storeParameter:[],currParameter:[{value:"",label:""}],innerContainerClass:"vue-input-select",innerInputClass:"vue-input-select-input",innerListClass:"vue-input-select-list",innerItemClass:"vue-input-select-item",listHeightStyle:{}}},model:{prop:"modelValue"},props:{containerClass:{type:String,default:"vue-input-select"},inputClass:{type:String,default:"vue-input-select-input"},listClass:{type:String,default:"vue-input-select-list"},itemClass:{type:String,default:"vue-input-select-item"},emptyValue:{type:String,default:""},parameter:{type:Array,default:[],required:!0},modelValue:{required:!0}},created:function(){this.updateList(this.emptyValue,this.parameter),this.setValue(this.modelValue)},mounted:function(){this.initDom(),this.setName(this.modelValue)},computed:{list:function(){return this.$refs.itemlist}},watch:{modelValue:function(e){this.setValue(e),this.setName(e)},parameter:function(e){this.updateList(this.emptyValue,e)},currValue:{handler:function(e,t){this.setName(e),this.$emit("input",e),String(e)!==String(t)&&""!==String(t)&&String(e)!==String(this.modelValue)&&e!==t&&this.$emit("change",e)},deep:!0},emptyValue:function(e){this.updateList(e,this.parameter)},isShow:function(e){e?this.$nextTick((function(){this.updateListSize()})):this.listHeightStyle={}}},methods:{handleInput:function(){if(this.currName){this.currParameter=[];var e={value:this.currName,list:this.currParameter};return this.isShow=!1,this.listHeightStyle={},void this.$emit("changeCmdData",e)}this.currParameter=this.storeParameter;var t={value:this.currName,list:this.currParameter};return this.isShow=!0,void this.$emit("changeCmdData",t)},updateList:function(e,t){if(e&&""!==e){if(this.currParameter=[{value:"",name:e}],t){var a,n=b(t);try{for(n.s();!(a=n.n()).done;){var o=a.value;this.currParameter.push(o)}}catch(s){n.e(s)}finally{n.f()}}}else this.currParameter=t;this.storeParameter=this.currParameter,this.setValue(this.currValue),this.setName(this.currValue),this.$forceUpdate()},updateListSize:function(){var e=this.$refs.itemlist,t=e.getBoundingClientRect().bottom,a=e.getBoundingClientRect().right,n=document.documentElement.clientHeight,o=document.documentElement.clientWidth;if(t-n<=0&&a-o<=0)this.listHeightStyle={};else{if(t-n>0){var s=n-e.getBoundingClientRect().top;this.listHeightStyle={overflow:"auto",height:s+"px"}}if(a-o>0){var i=o-e.getBoundingClientRect().left,r={overflow:"auto",width:i+"px"},l=this.listHeightStyle;Object.assign(l,r),this.listHeightStyle=l}}},setValue:function(e){this.currValue=e.toString()},setName:function(e){var t=this,a=!1,n="";this.currParameter.map((function(t){String(t.value)===String(e)&&(a=!0,n=t)})),a&&(t.currName=n.label)},initDom:function(){this.innerContainerClass=this.containerClass!==this.innerContainerClass?this.innerContainerClass+" "+this.containerClass:this.innerContainerClass,this.innerInputClass=this.inputClass!==this.innerInputClass?this.innerInputClass+" "+this.inputClass:this.innerInputClass,this.innerListClass=this.listClass!==this.innerListClass?this.innerListClass+" "+this.listClass:this.innerListClass,this.innerItemClass=this.itemClass!==this.innerItemClass?this.innerItemClass+" "+this.itemClass:this.innerItemClass,document.addEventListener("click",this.loadBind,!0),document.addEventListener("contextmenu",this.loadBind,!0),document.addEventListener("keydown",this.loadBindKey,!1)},loadBind:function(e){this.isShow&&!this.$el.contains(e.target)&&(this.isShow=!1)},loadBindKey:function(e){this.isShow&&"Escape"===e.key&&(this.isShow=!1)}},beforeDestroy:function(){document.removeEventListener("click",this.loadBind,!0),document.removeEventListener("contextmenu",this.loadBind,!0),document.removeEventListener("keydown",this.loadBindKey,!1)}},v=f,w=(a("2836"),a("2877")),y=Object(w["a"])(v,c,m,!1,null,"003858c9",null),$=y.exports,I=a("ed08"),T={props:["rowDetail"],data:function(){return{paramsData:[],getMQTTTimer:null,guid:"",gwDesc:"",wsUrl:"",resname:"comdebugger",textarea:"",repeatTimer:null,superAdmin:0,activeName:"first",debuggerVisible:!1,websocket:null,lockReconnect:!1,loading:!1,isStopView:!1,isOpenOrClose:!0,dataForm:{sn:"",model:"",gwSoftVer:"",content:"",inputValue:"ping",addContent:"www.baidu.com"},debugForm:{type:0,act:1,role:0,ipAddr:"",port:"",timeout:1e3,comname:"",baud:9600,databit:8,checkbit:0,stopbit:1},sendForm:{checkedList:[0,1],content:"",isRepeat:!1,interval:2e3,receiveData:""},gwsnTypes:[{label:this.$t("debuggerInfo.com"),value:0}],roleList:[{label:this.$t("debuggerInfo.initiative"),value:0},{label:this.$t("debuggerInfo.waitiative"),value:1}],comnameList:[],baudList:[{label:"300",value:300},{label:"600",value:600},{label:"1200",value:1200},{label:"2400",value:2400},{label:"4800",value:4800},{label:"9600",value:9600},{label:"19200",value:19200},{label:"38400",value:38400},{label:"57600",value:57600},{label:"115200",value:115200},{label:"187500",value:187500}],databitList:[{label:5,value:5},{label:6,value:6},{label:7,value:7},{label:8,value:8}],checkbitList:[{label:this.$t("debuggerInfo.noCheck"),value:0},{label:this.$t("debuggerInfo.oddCheck"),value:1},{label:this.$t("debuggerInfo.evenCheck"),value:2},{label:this.$t("debuggerInfo.logo"),value:3},{label:this.$t("debuggerInfo.space"),value:4}],stopbitList:[{label:1,value:1},{label:2,value:2}],checkList:[{label:this.$t("debuggerInfo.autoWrap"),value:0},{label:this.$t("debuggerInfo.viewTime"),value:1},{label:"CRC Modbus",value:2}],commandList:[{label:this.$t("debuggerInfo.pingNetworkTest"),value:"ping"},{label:this.$t("debuggerInfo.telnetPortDetection"),value:"Telnet"},{label:this.$t("debuggerInfo.ifconfigCheckIPAddress"),value:"ifconfig"},{label:this.$t("debuggerInfo.routeViewRoutingTable"),value:"route"},{label:this.$t("debuggerInfo.lsViewFileList"),value:"ls"},{label:this.$t("debuggerInfo.psViewProcessList"),value:"ps"},{label:this.$t("debuggerInfo.rebootRestartGateway"),value:"reboot"},{label:this.$t("debuggerInfo.tailViewDialUpLog"),value:"tail -100 /logs/dial-daemon.log"},{label:this.$t("debuggerInfo.tailViewCollectionLog"),value:"tail -100 /logs/ioserver.log"},{label:"tail(查看Lua日志)",value:"tail -f /logs/lua.log"},{label:this.$t("debuggerInfo.tailViewRmoteMaintenanceLog"),value:"tail -100 /logs/iosysmgr.log"},{label:this.$t("debuggerInfo.tailViewRestartOperationLog"),value:"tail -100 /logs/reboot.log"},{label:this.$t("debuggerInfo.tailViewUpgradeOperationLog"),value:"tail -200 /logs/update.log"},{label:this.$t("debuggerInfo.tailViewPythonLog"),value:"tail -100 /logs/python3.11.log"},{label:this.$t("debuggerInfo.tailViewPythonStartAndStopLog"),value:"tail -100 /logs/iopython.log"},{label:this.$t("debuggerInfo.uptimeViewTimeInformation"),value:"uptime"},{label:this.$t("debuggerInfo.dfCheckDiskUsage"),value:"df"},{label:this.$t("debuggerInfo.setRootModel"),value:"set_rmodel"},{label:this.$t("debuggerInfo.setModel"),value:"set_model"},{label:this.$t("debuggerInfo.getProVersion"),value:"get_pro_ver"},{label:this.$t("debuggerInfo.setServer"),value:"set_server"},{label:this.$t("debuggerInfo.setHardver"),value:"set_hardver"},{label:this.$t("debuggerInfo.wget"),value:"wget http://47.97.250.62/help-doc/protocol.json -O /data/config/protocol.json"},{label:this.$t("debuggerInfo.cat"),value:"cat /tmp/machine.enc"},{label:this.$t("debuggerInfo.rmProtocols"),value:"rm /data/protocols/*"},{label:"rm /data/tuya_key.json(删除涂鸦秘钥)",value:"rm /data/tuya_key.json"},{label:"netstat(查看端口占用)",value:"netstat"},{label:"lproxy(启动反向代理)",value:"/data/bin/lproxy -f -a"}],dataFormRules:{inputValue:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]},rules:{ipAddr:[{required:!0,message:this.$t("debuggerInfo.enterIp"),trigger:"blchangeur"},{pattern:/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,message:this.$t("debuggerInfo.pleaseEnterCorrectIp")}],port:[{required:!0,message:this.$t("debuggerInfo.enterPort"),trigger:"change"},{pattern:/^([0-9]|[1-9]\d{1,3}|[1-5]\d{4}|6[0-5]{2}[0-3][0-5])$/,message:this.$t("debuggerInfo.enterCorrectPort")}],comname:[{required:!0,message:this.$t("debuggerInfo.pleaseSelectCom"),trigger:"change"}],timeout:[{required:!0,message:this.$t("debuggerInfo.pleaseEnterTimeout"),trigger:"change"}],baud:[{required:!0,message:this.$t("debuggerInfo.pleaseEnterBaud"),trigger:"change"}],databit:[{required:!0,message:this.$t("debuggerInfo.pleaseEnterDatabit"),trigger:"change"}],checkbit:[{required:!0,message:this.$t("debuggerInfo.pleaseEnterCheckbit"),trigger:"change"}],stopbit:[{required:!0,message:this.$t("debuggerInfo.pleaseEnterStopbit"),trigger:"change"}]},sendRules:{content:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]}}},components:{inputSelect:$},methods:{handleTabsCancelWebsocketChange:function(e,t){if("remove"===t){var a=this.activeName;a===e&&(this.loading=!1,this.websocket&&this.websocket.readyState===WebSocket.OPEN&&(this.websocket.close(),this.websocket=null))}},init:function(){var e=this;this.wsUrl="",this.activeName="first",this.debuggerVisible=!0,this.paramsData=this.commandList,this.$nextTick((function(){e.dataForm.content="",e.dataForm.addContent="",e.$refs["debugForm"].resetFields(),e.$refs["sendForm"].resetFields(),e.textarea="",e.lockReconnect=!1,e.repeatTimer=null,e.isOpenOrClose=!0,e.dataForm={sn:"",model:"",content:"",inputValue:"ping",addContent:"www.baidu.com"},e.debugForm={type:0,act:1,role:0,ipAddr:"",port:"",timeout:1e3,comname:"",baud:9600,databit:8,checkbit:0,stopbit:1},e.sendForm={checkedList:[0,1],content:"",isRepeat:!1,interval:2e3,receiveData:""},document.getElementById("receiveTextarea").innerHTML="",e.resname="comdebugger",e.dataForm.sn=e.rowDetail.gwSn,e.gwDesc=e.rowDetail.gwDesc,e.dataForm.model=e.rowDetail.gwModel,e.getSoftVer(),e.getSuperAdmin(),e.generateGuid(),e.handleType(0)}))},isExpired:function(e){var t=e.startTime.toString(),a=parseInt(t.slice(0,4),10),n=parseInt(t.slice(4,6),10)-1,o=parseInt(t.slice(6,8),10),s=new Date(a,n,o),i=new Date(s);return i.setDate(i.getDate()+e.timeInterval),Date.now()>i.getTime()},getSoftVer:function(){var e=this;this.$hasPermission("info:gwbaseinfo:select")?this.$http.get("/info/gwbaseinfo",{params:{sn:this.dataForm.sn}}).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);a.data&&(e.dataForm.gwSoftVer=a.data?a.data.softV:"",e.dataForm.gwSoftVer&&(e.checkPlugin(e.dataForm.gwSoftVer.substring(1,e.dataForm.gwSoftVer.length),"1.2.94"),1==e.superAdmin?(e.commandList=[{label:e.$t("debuggerInfo.pingNetworkTest"),value:"ping"},{label:e.$t("debuggerInfo.telnetPortDetection"),value:"Telnet"},{label:e.$t("debuggerInfo.ifconfigCheckIPAddress"),value:"ifconfig"},{label:e.$t("debuggerInfo.routeViewRoutingTable"),value:"route"},{label:e.$t("debuggerInfo.lsViewFileList"),value:"ls"},{label:e.$t("debuggerInfo.psViewProcessList"),value:"ps"},{label:e.$t("debuggerInfo.rebootRestartGateway"),value:"reboot"},{label:e.$t("debuggerInfo.tailViewDialUpLog"),value:"tail -100 /logs/dial-daemon.log"},{label:e.$t("debuggerInfo.tailViewCollectionLog"),value:"tail -100 /logs/ioserver.log"},{label:"tail(查看Lua日志)",value:"tail -f /logs/lua.log"},{label:e.$t("debuggerInfo.tailViewRmoteMaintenanceLog"),value:"tail -100 /logs/iosysmgr.log"},{label:e.$t("debuggerInfo.tailViewRestartOperationLog"),value:"tail -100 /logs/reboot.log"},{label:e.$t("debuggerInfo.tailViewUpgradeOperationLog"),value:"tail -200 /logs/update.log"},{label:e.$t("debuggerInfo.tailViewPythonLog"),value:"tail -100 /logs/python3.11.log"},{label:e.$t("debuggerInfo.tailViewPythonStartAndStopLog"),value:"tail -100 /logs/iopython.log"},{label:e.$t("debuggerInfo.uptimeViewTimeInformation"),value:"uptime"},{label:e.$t("debuggerInfo.dfCheckDiskUsage"),value:"df"},{label:e.$t("debuggerInfo.setRootModel"),value:"set_rmodel"},{label:e.$t("debuggerInfo.setModel"),value:"set_model"},{label:e.$t("debuggerInfo.getProVersion"),value:"get_pro_ver"},{label:e.$t("debuggerInfo.setServer"),value:"set_server"},{label:e.$t("debuggerInfo.setHardver"),value:"set_hardver"},{label:e.$t("debuggerInfo.wget"),value:"wget http://47.97.250.62/help-doc/protocol.json -O /data/config/protocol.json"},{label:e.$t("debuggerInfo.cat"),value:"cat /tmp/machine.enc"},{label:e.$t("debuggerInfo.rmProtocols"),value:"rm /data/protocols/*"},{label:"rm /data/tuya_key.json(删除涂鸦秘钥)",value:"rm /data/tuya_key.json"},{label:"netstat(查看端口占用)",value:"netstat"},{label:"lproxy(启动反向代理)",value:"/data/bin/lproxy -f -a"}],e.paramsData=e.commandList):"peirenbo"===e.$store.state.user.name||"qianjiang"===e.$store.state.user.name||"weitongtong"===e.$store.state.user.name?r.a.get("/commandtimeout.json?_t="+(new Date).getTime()).then((function(t){e.isExpired(t.data)?(e.commandList=[{label:e.$t("debuggerInfo.pingNetworkTest"),value:"ping"},{label:e.$t("debuggerInfo.telnetPortDetection"),value:"Telnet"},{label:e.$t("debuggerInfo.ifconfigCheckIPAddress"),value:"ifconfig"},{label:e.$t("debuggerInfo.routeViewRoutingTable"),value:"route"},{label:e.$t("debuggerInfo.lsViewFileList"),value:"ls"},{label:e.$t("debuggerInfo.psViewProcessList"),value:"ps"},{label:e.$t("debuggerInfo.rebootRestartGateway"),value:"reboot"},{label:e.$t("debuggerInfo.tailViewDialUpLog"),value:"tail -100 /logs/dial-daemon.log"},{label:e.$t("debuggerInfo.tailViewCollectionLog"),value:"tail -100 /logs/ioserver.log"},{label:"tail(查看Lua日志)",value:"tail -f /logs/lua.log"},{label:e.$t("debuggerInfo.tailViewRmoteMaintenanceLog"),value:"tail -100 /logs/iosysmgr.log"},{label:e.$t("debuggerInfo.tailViewRestartOperationLog"),value:"tail -100 /logs/reboot.log"},{label:e.$t("debuggerInfo.tailViewUpgradeOperationLog"),value:"tail -200 /logs/update.log"},{label:e.$t("debuggerInfo.tailViewPythonLog"),value:"tail -100 /logs/python3.11.log"},{label:e.$t("debuggerInfo.tailViewPythonStartAndStopLog"),value:"tail -100 /logs/iopython.log"},{label:e.$t("debuggerInfo.uptimeViewTimeInformation"),value:"uptime"},{label:e.$t("debuggerInfo.dfCheckDiskUsage"),value:"df"},{label:e.$t("debuggerInfo.setRootModel"),value:"set_rmodel"},{label:e.$t("debuggerInfo.setModel"),value:"set_model"},{label:e.$t("debuggerInfo.getProVersion"),value:"get_pro_ver"},{label:e.$t("debuggerInfo.setServer"),value:"set_server"},{label:e.$t("debuggerInfo.setHardver"),value:"set_hardver"},{label:e.$t("debuggerInfo.wget"),value:"wget http://47.97.250.62/help-doc/protocol.json -O /data/config/protocol.json"},{label:e.$t("debuggerInfo.cat"),value:"cat /tmp/machine.enc"},{label:e.$t("debuggerInfo.rmProtocols"),value:"rm /data/protocols/*"},{label:"rm /data/tuya_key.json(删除涂鸦秘钥)",value:"rm /data/tuya_key.json"},{label:"netstat(查看端口占用)",value:"netstat"},{label:"lproxy(启动反向代理)",value:"/data/bin/lproxy -f -a"}],e.paramsData=e.commandList):(e.commandList=[{label:e.$t("debuggerInfo.pingNetworkTest"),value:"ping"},{label:e.$t("debuggerInfo.telnetPortDetection"),value:"Telnet"},{label:e.$t("debuggerInfo.ifconfigCheckIPAddress"),value:"ifconfig"},{label:e.$t("debuggerInfo.routeViewRoutingTable"),value:"route"},{label:e.$t("debuggerInfo.lsViewFileList"),value:"ls"},{label:e.$t("debuggerInfo.psViewProcessList"),value:"ps"},{label:e.$t("debuggerInfo.rebootRestartGateway"),value:"reboot"},{label:e.$t("debuggerInfo.tailViewDialUpLog"),value:"tail -100 /logs/dial-daemon.log"},{label:e.$t("debuggerInfo.tailViewCollectionLog"),value:"tail -100 /logs/ioserver.log"},{label:"tail(查看Lua日志)",value:"tail -f /logs/lua.log"},{label:e.$t("debuggerInfo.tailViewRmoteMaintenanceLog"),value:"tail -100 /logs/iosysmgr.log"},{label:e.$t("debuggerInfo.tailViewRestartOperationLog"),value:"tail -100 /logs/reboot.log"},{label:e.$t("debuggerInfo.tailViewUpgradeOperationLog"),value:"tail -200 /logs/update.log"},{label:e.$t("debuggerInfo.tailViewPythonLog"),value:"tail -100 /logs/python3.11.log"},{label:e.$t("debuggerInfo.tailViewPythonStartAndStopLog"),value:"tail -100 /logs/iopython.log"},{label:e.$t("debuggerInfo.uptimeViewTimeInformation"),value:"uptime"},{label:e.$t("debuggerInfo.dfCheckDiskUsage"),value:"df"},{label:e.$t("debuggerInfo.setRootModel"),value:"set_rmodel"},{label:e.$t("debuggerInfo.setModel"),value:"set_model"},{label:e.$t("debuggerInfo.getProVersion"),value:"get_pro_ver"},{label:e.$t("debuggerInfo.setServer"),value:"set_server"},{label:e.$t("debuggerInfo.setHardver"),value:"set_hardver"},{label:e.$t("debuggerInfo.wget"),value:"wget http://47.97.250.62/help-doc/protocol.json -O /data/config/protocol.json"},{label:e.$t("debuggerInfo.cat"),value:"cat /tmp/machine.enc"},{label:e.$t("debuggerInfo.rmProtocols"),value:"rm /data/protocols/*"},{label:"rm /data/tuya_key.json(删除涂鸦秘钥)",value:"rm /data/tuya_key.json"},{label:"netstat(查看端口占用)",value:"netstat"},{label:"lproxy(启动反向代理)",value:"/data/bin/lproxy -f -a"},{label:"wget(下载文件)",value:"wget"},{label:"curl(推送文件)",value:"/data/bin/curl"},{label:"wget(下载bmse升级包)",value:"wgetbmse1"},{label:"wget(下载bmse升级工具)",value:"wgetbmse2"},{label:"chmod(赋权bmse升级工具)",value:"chmod +x"},{label:"bmser(探测bmse)",value:"/data/bin/bmser_exota -d 1 -n 1 --cmd 2 1 --tcp"},{label:"bmser(推送bmse升级包)",value:'/data/bin/bmser_exota -f "/tmp/bmse.bin" -d 1 -n 1 --tcp'},{label:"cat(查看bmse升级结果)",value:"cat /tmp/debug_status.json"},{label:"tftp(启动tftp服务器)",value:"/data/bin/tftpd-hpa -l -s"}],e.paramsData=e.commandList)})).catch((function(t){e.commandList=[{label:e.$t("debuggerInfo.pingNetworkTest"),value:"ping"},{label:e.$t("debuggerInfo.telnetPortDetection"),value:"Telnet"},{label:e.$t("debuggerInfo.ifconfigCheckIPAddress"),value:"ifconfig"},{label:e.$t("debuggerInfo.routeViewRoutingTable"),value:"route"},{label:e.$t("debuggerInfo.lsViewFileList"),value:"ls"},{label:e.$t("debuggerInfo.psViewProcessList"),value:"ps"},{label:e.$t("debuggerInfo.rebootRestartGateway"),value:"reboot"},{label:e.$t("debuggerInfo.tailViewDialUpLog"),value:"tail -100 /logs/dial-daemon.log"},{label:e.$t("debuggerInfo.tailViewCollectionLog"),value:"tail -100 /logs/ioserver.log"},{label:"tail(查看Lua日志)",value:"tail -f /logs/lua.log"},{label:e.$t("debuggerInfo.tailViewRmoteMaintenanceLog"),value:"tail -100 /logs/iosysmgr.log"},{label:e.$t("debuggerInfo.tailViewRestartOperationLog"),value:"tail -100 /logs/reboot.log"},{label:e.$t("debuggerInfo.tailViewUpgradeOperationLog"),value:"tail -200 /logs/update.log"},{label:e.$t("debuggerInfo.tailViewPythonLog"),value:"tail -100 /logs/python3.11.log"},{label:e.$t("debuggerInfo.tailViewPythonStartAndStopLog"),value:"tail -100 /logs/iopython.log"},{label:e.$t("debuggerInfo.uptimeViewTimeInformation"),value:"uptime"},{label:e.$t("debuggerInfo.dfCheckDiskUsage"),value:"df"},{label:e.$t("debuggerInfo.setRootModel"),value:"set_rmodel"},{label:e.$t("debuggerInfo.setModel"),value:"set_model"},{label:e.$t("debuggerInfo.getProVersion"),value:"get_pro_ver"},{label:e.$t("debuggerInfo.setServer"),value:"set_server"},{label:e.$t("debuggerInfo.setHardver"),value:"set_hardver"},{label:e.$t("debuggerInfo.wget"),value:"wget http://47.97.250.62/help-doc/protocol.json -O /data/config/protocol.json"},{label:e.$t("debuggerInfo.cat"),value:"cat /tmp/machine.enc"},{label:e.$t("debuggerInfo.rmProtocols"),value:"rm /data/protocols/*"},{label:"rm /data/tuya_key.json(删除涂鸦秘钥)",value:"rm /data/tuya_key.json"},{label:"netstat(查看端口占用)",value:"netstat"},{label:"lproxy(启动反向代理)",value:"/data/bin/lproxy -f -a"}],e.paramsData=e.commandList})):(e.commandList=[{label:e.$t("debuggerInfo.pingNetworkTest"),value:"ping"},{label:e.$t("debuggerInfo.telnetPortDetection"),value:"Telnet"},{label:e.$t("debuggerInfo.ifconfigCheckIPAddress"),value:"ifconfig"},{label:e.$t("debuggerInfo.routeViewRoutingTable"),value:"route"},{label:e.$t("debuggerInfo.lsViewFileList"),value:"ls"},{label:e.$t("debuggerInfo.psViewProcessList"),value:"ps"},{label:e.$t("debuggerInfo.rebootRestartGateway"),value:"reboot"},{label:e.$t("debuggerInfo.tailViewDialUpLog"),value:"tail -100 /logs/dial-daemon.log"},{label:e.$t("debuggerInfo.tailViewCollectionLog"),value:"tail -100 /logs/ioserver.log"},{label:"tail(查看Lua日志)",value:"tail -f /logs/lua.log"},{label:e.$t("debuggerInfo.tailViewRmoteMaintenanceLog"),value:"tail -100 /logs/iosysmgr.log"},{label:e.$t("debuggerInfo.tailViewRestartOperationLog"),value:"tail -100 /logs/reboot.log"},{label:e.$t("debuggerInfo.tailViewUpgradeOperationLog"),value:"tail -200 /logs/update.log"},{label:e.$t("debuggerInfo.tailViewPythonLog"),value:"tail -100 /logs/python3.11.log"},{label:e.$t("debuggerInfo.tailViewPythonStartAndStopLog"),value:"tail -100 /logs/iopython.log"},{label:e.$t("debuggerInfo.uptimeViewTimeInformation"),value:"uptime"},{label:e.$t("debuggerInfo.dfCheckDiskUsage"),value:"df"},{label:e.$t("debuggerInfo.setRootModel"),value:"set_rmodel"},{label:e.$t("debuggerInfo.setModel"),value:"set_model"},{label:e.$t("debuggerInfo.getProVersion"),value:"get_pro_ver"},{label:e.$t("debuggerInfo.setServer"),value:"set_server"},{label:e.$t("debuggerInfo.setHardver"),value:"set_hardver"},{label:e.$t("debuggerInfo.wget"),value:"wget http://47.97.250.62/help-doc/protocol.json -O /data/config/protocol.json"},{label:e.$t("debuggerInfo.cat"),value:"cat /tmp/machine.enc"},{label:e.$t("debuggerInfo.rmProtocols"),value:"rm /data/protocols/*"},{label:"rm /data/tuya_key.json(删除涂鸦秘钥)",value:"rm /data/tuya_key.json"},{label:"netstat(查看端口占用)",value:"netstat"},{label:"lproxy(启动反向代理)",value:"/data/bin/lproxy -f -a"}],e.paramsData=e.commandList)))})):this.$message.warning("暂无查询网关信息权限, 请联系管理员")},toNum:function(e){e=e.toString();for(var t=e.split("."),a=["","0","00","000","0000"],n=a.reverse(),o=0;o<t.length;o++){var s=t[o].length;t[o]=n[s]+t[o]}var i=t.join("");return i},checkPlugin:function(e,t){e=this.toNum(e),t=this.toNum(t);return e==t||e>t},handleClick:function(e,t){var a=this;this.loading=!1,this.websocket&&this.websocket.readyState===WebSocket.OPEN&&(this.websocket.close(),this.websocket=null),this.getMQTTTimer&&(clearTimeout(this.getMQTTTimer),this.getMQTTTimer=null),this.$nextTick((function(){"first"===e.name?(a.handleType(0),a.sendForm.isRepeat&&a.sendData()):"second"===e.name&&(a.resname="commandline")}))},handleType:function(e){var t=this;if(this.$refs["debugForm"].clearValidate(),0===e){if(this.comnameList=[],!this.$hasPermission("interface:select:permission.do"))return void this.$message.warning("暂无串口查询权限, 请联系管理员");this.$http.get("/gwtype/interface/selectByModel",{params:{page:1,limit:100,model:this.dataForm.model}}).then((function(e){var a=e.data,n=a.list;n.length>0&&JSON.parse(n[0].gwInterface).uart.list.forEach((function(e){var a={label:e,value:e};t.comnameList.push(a)}))})).catch((function(e){return!1}))}},encryMD5:function(e){var t=this.$randomStrFun();return this.$md5(t+e)+"/"+String(parseInt((new Date).getTime().toString().substring(0,10)))},encryMD5List:function(){var e=this.$randomStrFun();return this.$md5(e)+"/"+String(parseInt((new Date).getTime().toString().substring(0,10)))},handleOpenPort:g()((function(){var e=this,t=[{com:parseInt(e.debugForm.comname.replace(/[^0-9]/gi,"")),gwsn:e.dataForm.sn,status:3}];e.$refs["debugForm"].validate((function(a){if(!a)return!1;e.$confirm(e.$t("debuggerInfo.openSerialPortInterruptCollectionChannel"),e.$t("prompt.title"),{confirmButtonText:e.$t("confirm"),cancelButtonText:e.$t("cancel"),type:"warning"}).then((function(){var a=Object(I["p"])(JSON.stringify(t));e.$nextTick((function(){e.resname="setchlstatus",e.wsUrl="socketList/setchlstatusCds/"+e.stringToHex(a)+"/"+e.encryMD5List(),e.$hasPermission("socketList:setchlstatusCds:websocket")?(e.createWebSocket(),e.getMQTTTimer=setTimeout((function(){return e.loading=!1,e.websocket&&"setchlstatus"==e.resname&&(e.websocket.close(),e.websocket=null),e.getMQTTTimer&&(clearTimeout(e.getMQTTTimer),e.getMQTTTimer=null),e.$message.error(e.$t("issue.timeout"))}),"30000")):e.$message.warning("暂无设置串口状态权限, 请联系管理员")}))})).catch((function(e){}))}))}),1e3,{leading:!0,trailing:!1}),openCOMDebug:function(){var e=this,t=[{guid:e.guid,gwsn:e.dataForm.sn,act:1,type:0,comname:e.debugForm.comname,baud:e.debugForm.baud,databit:e.debugForm.databit,stopbit:e.debugForm.stopbit,checkbit:e.debugForm.checkbit,timeout:e.debugForm.timeout}],a=Object(I["p"])(JSON.stringify(t));e.resname="comdebugger",e.wsUrl="socketList/debug/"+e.stringToHex(a)+"/"+e.encryMD5List(),e.$hasPermission("socketList:debug:websocket")?(e.loading=!0,e.createWebSocket(),e.getMQTTTimer=setTimeout((function(){if(e.loading)return e.loading=!1,e.websocket&&"comdebugger"==e.resname&&(e.websocket.close(),e.websocket=null),e.getMQTTTimer&&(clearTimeout(e.getMQTTTimer),e.getMQTTTimer=null),e.$message.error(e.$t("issue.timeout"))}),"30000")):e.$message.warning("暂无设置Debug调试权限, 请联系管理员")},generateGuid:function(){this.guid="";for(var e=1;e<=32;e++){var t=Math.floor(16*Math.random()).toString(16);this.guid+=t}return this.guid},handleClosePort:g()((function(){var e=this,t=[{com:parseInt(e.debugForm.comname.replace(/[^0-9]/gi,"")),gwsn:e.dataForm.sn,status:0}];e.$refs["debugForm"].validate((function(a){if(!a)return!1;e.repeatTimer&&(clearInterval(e.repeatTimer),e.repeatTimer=null);var n=Object(I["p"])(JSON.stringify(t));e.$nextTick((function(){e.resname="setchlstatusClose",e.wsUrl="socketList/setchlstatusCds/"+e.stringToHex(n)+"/"+e.encryMD5List(),e.$hasPermission("socketList:setchlstatusCds:websocket")?(e.createWebSocket(),e.getMQTTTimer=setTimeout((function(){if(e.loading)return e.loading=!1,e.websocket&&"setchlstatusClose"==e.resname&&(e.websocket.close(),e.websocket=null),e.getMQTTTimer&&(clearTimeout(e.getMQTTTimer),e.getMQTTTimer=null),e.$message.error(e.$t("issue.timeout"))}),"30000")):e.$message.warning("暂无设置串口状态权限, 请联系管理员")}))}))}),1e3,{leading:!0,trailing:!1}),closeCOMDebug:function(){var e=this,t=[{guid:e.guid,gwsn:e.dataForm.sn,act:0,type:0}];e.resname="comdebugger";var a=Object(I["p"])(JSON.stringify(t));e.$nextTick((function(){e.wsUrl="socketList/debug/"+e.stringToHex(a)+"/"+e.encryMD5List(),e.$hasPermission("socketList:debug:websocket")?(e.loading=!0,e.createWebSocket(),e.getMQTTTimer=setTimeout((function(){if(e.loading)return e.loading=!1,e.websocket&&"comdebugger"==e.resname&&(e.websocket.close(),e.websocket=null),e.getMQTTTimer&&(clearTimeout(e.getMQTTTimer),e.getMQTTTimer=null),e.$message.error(e.$t("issue.timeout"))}),"30000")):e.$message.warning("暂无设置Debug调试权限, 请联系管理员")}))},resetCOMDebug:function(){var e=this,t=[{com:parseInt(e.debugForm.comname.replace(/[^0-9]/gi,"")),gwsn:e.dataForm.sn,status:1}];e.$refs["debugForm"].validate((function(a){if(!a)return!1;e.repeatTimer&&(clearInterval(e.repeatTimer),e.repeatTimer=null);var n=Object(I["p"])(JSON.stringify(t));e.$nextTick((function(){e.resname="setchlstatusReset",e.wsUrl="socketList/setchlstatusCds/"+e.stringToHex(n)+"/"+e.encryMD5List(),e.$hasPermission("socketList:setchlstatusCds:websocket")?(e.createWebSocket(),e.getMQTTTimer=setTimeout((function(){if(e.loading)return e.loading=!1,e.websocket&&"setchlstatusReset"==e.resname&&(e.websocket.close(),e.websocket=null),e.getMQTTTimer&&(clearTimeout(e.getMQTTTimer),e.getMQTTTimer=null),e.$message.error(e.$t("issue.timeout"))}),"30000")):e.$message.warning("暂无设置串口状态权限, 请联系管理员")}))}))},handleChecked:function(e){this.resname="sendMessage",e&&(this.sendForm.checkedList=e)},isInArray:function(e,t){for(var a=0;a<e.length;a++)if(t==e[a])return!0;return!1},startView:g()((function(){var e=this,t=[{gwsn:e.dataForm.sn,type:0,act:3,guid:e.guid,buff:""}],a=e.$CRC.ToModbusCRC16(e.sendForm.content,!0);t[0]["buff"]=e.isInArray(e.sendForm.checkedList,"2")?e.sendForm.content+" "+a:e.sendForm.content,e.resname="sendMessage",e.repeatTimer&&(clearInterval(e.repeatTimer),e.repeatTimer=null),e.isStopView=!1;var n=Object(I["p"])(JSON.stringify(t));e.$nextTick((function(){e.appendToDiv(),e.wsUrl="socketList/debug/"+e.stringToHex(n)+"/"+e.encryMD5List(),e.$hasPermission("socketList:debug:websocket")?(e.createWebSocket(),e.sendForm.isRepeat&&(e.repeatTimer=setInterval((function(){e.createWebSocket(),e.appendToDiv()}),e.sendForm.interval))):e.$message.warning("暂无设置Debug调试权限, 请联系管理员")}))}),1e3,{leading:!0,trailing:!1}),stopView:g()((function(){this.isStopView=!0,this.resname="sendMessage",this.repeatTimer&&(clearInterval(this.repeatTimer),this.repeatTimer=null)}),1e3,{leading:!0,trailing:!1}),clearView:g()((function(){this.sendForm.receiveData="",document.getElementById("receiveTextarea").innerHTML=""}),1e3,{leading:!0,trailing:!1}),copyView:g()((function(){var e=this,t=document.getElementById("receiveTextarea").innerText,a=new d.a(".receiveTextareaCopy",{text:function(){return t}});a.on("success",(function(t){e.$message({message:e.$t("upgrade.copySuccess"),showClose:!0,type:"success"}),a.destroy()})),a.on("error",(function(t){e.$message({message:e.$t("upgrade.copyFail"),showClose:!0,type:"error"}),a.destroy()}))}),200,{leading:!0,trailing:!1}),handleRepeat:function(e){var t=this;if(t.resname="sendMessage",t.repeatTimer&&(clearInterval(t.repeatTimer),t.repeatTimer=null),e){var a=[{gwsn:t.dataForm.sn,type:0,act:3,guid:t.guid,buff:""}],n=t.$CRC.ToModbusCRC16(t.sendForm.content,!0);a[0]["buff"]=t.isInArray(t.sendForm.checkedList,"2")?t.sendForm.content+" "+n:t.sendForm.content,t.$refs["sendForm"].validate((function(e){if(!e)return!1;if(!t.isStopView){t.appendToDiv();var n=Object(I["p"])(JSON.stringify(a));if(t.wsUrl="socketList/debug/"+t.stringToHex(n)+"/"+t.encryMD5List(),!t.$hasPermission("socketList:debug:websocket"))return void t.$message.warning("暂无设置Debug调试权限, 请联系管理员");t.createWebSocket(),t.repeatTimer=setInterval((function(){t.wsUrl="socketList/debug/"+t.stringToHex(n)+"/"+t.encryMD5List(),t.$hasPermission("socketList:debug:websocket")?(t.createWebSocket(),t.appendToDiv()):t.$message.warning("暂无设置Debug调试权限, 请联系管理员")}),t.sendForm.interval)}}))}else t.repeatTimer&&(clearInterval(t.repeatTimer),t.repeatTimer=null)},handleRepeatIntervalChange:function(){this.sendForm.interval=String(this.sendForm.interval).replace(/[^\.\d]/g,""),this.sendForm.interval=String(this.sendForm.interval).replace(".","")},setRepeatInterval:function(e){var t=this;if(e-2e3<0&&t.$set(t.sendForm,"interval",2e3),t.repeatTimer&&(clearInterval(t.repeatTimer),t.repeatTimer=null),t.resname="sendMessage",t.sendForm.isRepeat){var a=[{gwsn:t.dataForm.sn,type:0,act:3,guid:t.guid,buff:""}],n=t.$CRC.ToModbusCRC16(t.sendForm.content,!0);a[0]["buff"]=t.isInArray(t.sendForm.checkedList,"2")?t.sendForm.content+" "+n:t.sendForm.content,t.$refs["sendForm"].validate((function(e){if(!e)return!1;if(!t.isStopView){t.appendToDiv();var n=Object(I["p"])(JSON.stringify(a));if(t.wsUrl="socketList/debug/"+t.stringToHex(n)+"/"+t.encryMD5List(),!t.$hasPermission("socketList:debug:websocket"))return void t.$message.warning("暂无设置Debug调试权限, 请联系管理员");t.createWebSocket(),t.repeatTimer=setInterval((function(){t.wsUrl="socketList/debug/"+t.stringToHex(n)+"/"+t.encryMD5List(),t.$hasPermission("socketList:debug:websocket")?(t.createWebSocket(),t.appendToDiv()):t.$message.warning("暂无设置Debug调试权限, 请联系管理员")}),t.sendForm.interval)}}))}else t.repeatTimer&&(clearInterval(t.repeatTimer),t.repeatTimer=null)},appendToDiv:function(){var e=this,t=e.getNowTime(),a=e.$CRC.ToModbusCRC16(e.sendForm.content,!0),n=e.sendForm.content,o=document.getElementById("receiveTextarea"),s=n.replace(/\s*/g,"").length/2;if(0==e.sendForm.checkedList.length){var i=document.createElement("span");i.style.width="auto",i.style.height="auto",i.style.padding="5px 10px",i.style.fontSize="15px",i.style.color="#00C000",i.style.lineHeight="22px",i.innerHTML=e.$t("debuggerInfo.sendSymbol")+"  "+e.sendForm.content+"   ("+s+" bytes)",o.appendChild(i),e.$nextTick((function(){e.downBottom()}))}else if(1==e.sendForm.checkedList.length){if(0==e.sendForm.checkedList[0]){var r=document.createElement("span");r.style.width="auto",r.style.height="auto",r.style.padding="5px 10px",r.style.fontSize="15px",r.style.color="#00C000",r.style.lineHeight="22px",r.innerHTML=e.$t("debuggerInfo.sendSymbol")+"  "+e.sendForm.content+"   ("+s+" bytes)<br/>",o.appendChild(r),e.$nextTick((function(){e.downBottom()}))}else if(1==e.sendForm.checkedList[0]){var l=document.createElement("span");l.style.width="auto",l.style.height="auto",l.style.padding="5px 10px",l.style.fontSize="15px",l.style.color="#00C000",l.style.lineHeight="22px",l.innerHTML="["+t+"]  "+e.$t("debuggerInfo.sendSymbol")+"  "+e.sendForm.content+"   ("+s+" bytes)",o.appendChild(l),e.$nextTick((function(){e.downBottom()}))}else if(2==e.sendForm.checkedList[0]){var d=document.createElement("span");d.style.width="auto",d.style.height="auto",d.style.padding="5px 10px",d.style.fontSize="15px",d.style.color="#00C000",d.style.lineHeight="22px",d.innerHTML="["+t+"]  "+e.$t("debuggerInfo.sendSymbol")+"  "+e.sendForm.content+" "+a.substring(0,2)+" "+a.substring(2,a.length)+"  ("+(s+2)+"  bytes)",o.appendChild(d),e.$nextTick((function(){e.downBottom()}))}}else if(2==e.sendForm.checkedList.length)if(e.isInArray(e.sendForm.checkedList,"0"))if(e.isInArray(e.sendForm.checkedList,"1")){if(!e.isInArray(e.sendForm.checkedList,"2")){var u=document.createElement("span");u.style.width="auto",u.style.height="auto",u.style.padding="5px 10px",u.style.fontSize="15px",u.style.color="#00C000",u.style.lineHeight="22px",u.innerHTML="["+t+"]  "+e.$t("debuggerInfo.sendSymbol")+"  "+e.sendForm.content+"   ("+s+" bytes)<br/>",o.appendChild(u),e.$nextTick((function(){e.downBottom()}))}}else{var g=document.createElement("span");g.style.width="auto",g.style.height="auto",g.style.padding="5px 10px",g.style.fontSize="15px",g.style.color="#00C000",g.style.lineHeight="22px",g.innerHTML=e.$t("debuggerInfo.sendSymbol")+"  "+e.sendForm.content+" "+a.substring(0,2)+" "+a.substring(2,a.length)+"  ("+(s+2)+"  bytes)<br/>",o.appendChild(g),e.$nextTick((function(){e.downBottom()}))}else{var c=document.createElement("span");c.style.width="auto",c.style.height="auto",c.style.padding="5px 10px",c.style.fontSize="15px",c.style.color="#00C000",c.style.lineHeight="22px",c.innerHTML="["+t+"]  "+e.$t("debuggerInfo.sendSymbol")+"  "+e.sendForm.content+" "+a.substring(0,2)+" "+a.substring(2,a.length)+"  ("+(s+2)+"  bytes)",o.appendChild(c),e.$nextTick((function(){e.downBottom()}))}else if(3==e.sendForm.checkedList.length){var m=document.createElement("span");m.style.width="auto",m.style.height="auto",m.style.padding="5px 10px",m.style.fontSize="15px",m.style.color="#00C000",m.style.lineHeight="22px",m.innerHTML="["+t+"]  "+e.$t("debuggerInfo.sendSymbol")+"  "+e.sendForm.content+" "+a.substring(0,2)+" "+a.substring(2,a.length)+"  ("+(s+2)+" bytes)<br/>",o.appendChild(m),e.$nextTick((function(){e.downBottom()}))}},sendData:g()((function(){var e=this,t=[{gwsn:e.dataForm.sn,type:0,act:3,guid:e.guid,buff:""}],a=e.$CRC.ToModbusCRC16(e.sendForm.content,!0);if(t[0]["buff"]=e.isInArray(e.sendForm.checkedList,"2")?e.sendForm.content+" "+a:e.sendForm.content,e.isOpenOrClose)return e.$message.info(e.$t("debuggerInfo.openCom"));e.repeatTimer&&(clearInterval(e.repeatTimer),e.repeatTimer=null),e.resname="sendMessage",e.$refs["sendForm"].validate((function(a){if(!a)return!1;if(!e.isStopView){e.appendToDiv();var n=Object(I["p"])(JSON.stringify(t));if(e.wsUrl="socketList/debug/"+e.stringToHex(n)+"/"+e.encryMD5List(),!e.$hasPermission("socketList:debug:websocket"))return void e.$message.warning("暂无设置Debug调试权限, 请联系管理员");e.$nextTick((function(){e.createWebSocket(),e.sendForm.isRepeat&&(e.repeatTimer=setInterval((function(){e.wsUrl="socketList/debug/"+e.stringToHex(n)+"/"+e.encryMD5List(),e.$hasPermission("socketList:debug:websocket")?(e.createWebSocket(),e.appendToDiv()):e.$message.warning("暂无设置Debug调试权限, 请联系管理员")}),e.sendForm.interval))}))}}))}),1e3,{leading:!0,trailing:!1}),focus:function(){this.$refs["siteInput"].select()},getSuperAdmin:function(){this.superAdmin=this.$store.state.user.superAdmin},selectCommand:function(e){this.dataForm.content="","ping"==e?this.dataForm.addContent="www.baidu.com":"Telnet"==e?this.dataForm.addContent="192.168.11.177 22":"ifconfig"==e?this.dataForm.addContent="":"route"==e?this.dataForm.addContent="-n":"ls"==e?this.dataForm.addContent="":"ps"==e?this.dataForm.addContent="-aux":"reboot"==e?this.dataForm.addContent="":"tail -100 /logs/dial-daemon.log"==e||"tail -100 /logs/ioserver.log"==e||"tail -100 /logs/iosysmgr.log"==e||"tail -100 /logs/reboot.log"==e?this.dataForm.addContent="100":"tail -200 /logs/update.log"==e?this.dataForm.addContent="200":"tail -100 /logs/python3.11.log"==e?this.dataForm.addContent="100":"tail -200 /logs/iopython.log"==e?this.dataForm.addContent="200":"uptime"==e?this.dataForm.addContent="":"df"==e?this.dataForm.addContent="-h":"set_rmodel"==e||"set_model"==e?this.dataForm.addContent="":"get_pro_ver"==e?this.dataForm.addContent="modbusrtu,104client":"set_server"==e||"set_hardver"==e||"wget http://47.97.250.62/help-doc/protocol.json -O /data/config/protocol.json"==e||"cat /tmp/machine.enc"==e||"rm /data/protocols/*"==e||"rm /data/tuya_key.json"==e?this.dataForm.addContent="":"netstat"===e?this.dataForm.addContent="-tuln":"wget"===e||"/data/bin/curl"===e||"wgetbmse1"===e||"wgetbmse2"===e||"chmod +x"===e||"/data/bin/bmser_exota -d 1 -n 1 --cmd 2 1 --tcp"===e||'/data/bin/bmser_exota -f "/tmp/bmse.bin" -d 1 -n 1 --tcp'===e||"cat /tmp/debug_status.json"===e?this.dataForm.addContent="":"/data/bin/tftpd-hpa -l -s"===e?this.dataForm.addContent="/tmp -c":("/data/bin/lproxy -f -a"===e||"tail -f /logs/lua.log"===e)&&(this.dataForm.addContent="")},stringToHex:function(e){for(var t=/[\u4E00-\u9FA5]/,a=[],n=0;n<e.length;n++){var o="";o=t.test(e.charAt(n))?encodeURI(e.charAt(n)).replace(/%/g,""):e.charCodeAt(n).toString(16),a.push(o)}return e=a.join(""),e},onChangeFun:function(e){},changeCmdData:function(e){this.dataForm.inputValue=e.value,this.paramsData=e.list},handleInputAddContentChange:function(){1==this.dataForm.addContent.length?this.dataForm.addContent=this.dataForm.addContent.replace(/[^1-9]/g,""):(this.dataForm.addContent=this.dataForm.addContent.replace(/\D/g,"").replace(/^0+/g,""),this.dataForm.addContent-300>0&&(this.dataForm.addContent=300))},validateWgetCommand:function(e){var t=e.match(/-O\s+([^\s]+)/);if(!t)return!1;var a=t[1];if(!a.startsWith("/tmp/"))return!1;if(a.includes("..")||a.includes(";"))return!1;var n=e.match(/\s+(http:\/\/[^\s]+)/);if(!n)return!1;var o=n[1];return!!o.startsWith("http://www.smartwuxi.com/")},validateWgetBmseCommand:function(e){var t=e.match(/https?:\/\/([^\s/]+)/);if(!t)return!1;var a=t[1];return"www.smartwuxi.com"===a||"smartwuxi.com"===a},validateCurlCommand:function(e){var t=/^\/data\/bin\/curl\s+-X\s+POST\b/;if(!t.test(e))return!1;var a=/-F\s+"file=@(\/tmp\/[^"]+)"/,n=e.match(a);if(!n)return!1;var o=n[1];if(o.includes(".."))return!1;var s=/\s(http:\/\/(\d{1,3}\.){3}\d{1,3}(?:\:\d+)?\/[^\s"]+)/,i=e.match(s);if(!i)return!1;var r=i[1].match(/^http:\/\/([^/:]+)/)[1],l=r.split(".");return!l.some((function(e){return+e<0||+e>255}))},send:g()((function(){var e=this,t="";e.$refs["dataForm"].validate((function(a){if(a){if(-1!=e.dataForm.inputValue.indexOf("tail"))t="tail -100 /logs/python3.11.log"==e.dataForm.inputValue?e.dataForm.addContent?e.dataForm.inputValue.replace("tail -100","tail -"+e.dataForm.addContent):e.dataForm.inputValue:"tail -200 /logs/iopython.log"==e.dataForm.inputValue?e.dataForm.addContent?e.dataForm.inputValue.replace("tail -200","tail -"+e.dataForm.addContent):e.dataForm.inputValue:e.dataForm.addContent?e.dataForm.inputValue.replace(/[\d]+/g,e.dataForm.addContent):e.dataForm.inputValue;else{if(0==e.superAdmin){if("wget"==e.dataForm.inputValue){if(!e.dataForm.addContent)return e.$message.warning("请输入正确的wget命令，示例：wget -O /tmp/opt_up.tar http://www.smartwuxi.com/_files/opt_ancheng_up_20250822_180133.tar");if(!e.validateWgetCommand(e.dataForm.inputValue+" "+e.dataForm.addContent))return e.$message.warning("请输入正确的wget命令，示例：wget -O /tmp/opt_up.tar http://www.smartwuxi.com/_files/opt_ancheng_up_20250822_180133.tar")}if("/data/bin/curl"==e.dataForm.inputValue){if(!e.dataForm.addContent)return e.$message.warning('请输入正确的curl命令，示例：/data/bin/curl -X POST -F "file=@/tmp/opt_up.tar" http://192.168.2.11/api/update_file?opt');if(!e.validateCurlCommand(e.dataForm.inputValue+" "+e.dataForm.addContent))return e.$message.warning('请输入正确的curl命令，示例：/data/bin/curl -X POST -F "file=@/tmp/opt_up.tar" http://192.168.2.11/api/update_file?opt')}if("wgetbmse1"==e.dataForm.inputValue){if(!e.dataForm.addContent)return e.$message.warning("请输入正确的wget命令，示例：wget http://www.smartwuxi.com/_files/SeIbuV13.92.7.16_XN3158_0008-BCU-B30-208_0x1493_20250904.bin -O /tmp/bmse.bin");if(!e.validateWgetBmseCommand("wget "+e.dataForm.addContent))return e.$message.warning("请输入正确的wget命令，示例：wget http://www.smartwuxi.com/_files/SeIbuV13.92.7.16_XN3158_0008-BCU-B30-208_0x1493_20250904.bin -O /tmp/bmse.bin")}if("wgetbmse2"==e.dataForm.inputValue){if(!e.dataForm.addContent)return e.$message.warning("请输入正确的wget命令，示例：wget http://www.smartwuxi.com/_files/bmser_exota -O /data/bin/bmser_exota");if(!e.validateWgetBmseCommand("wget "+e.dataForm.addContent))return e.$message.warning("请输入正确的wget命令，示例：wget http://www.smartwuxi.com/_files/bmser_exota -O /data/bin/bmser_exota")}}t=e.dataForm.addContent?"wgetbmse1"==e.dataForm.inputValue||"wgetbmse2"==e.dataForm.inputValue?"wget "+e.dataForm.addContent:e.dataForm.inputValue+" "+e.dataForm.addContent:"wgetbmse1"==e.dataForm.inputValue||"wgetbmse2"==e.dataForm.inputValue?"wget":e.dataForm.inputValue,"cat /tmp/debug_status.json"==e.dataForm.inputValue&&(e.dataForm.addContent="",t="cat /tmp/debug_status.json")}if(("set_model"==e.dataForm.inputValue||"set_rmodel"==e.dataForm.inputValue)&&!e.dataForm.addContent)return e.$message.warning(e.$t("debuggerInfo.gatewayModelCannotBeEmpty"));"/data/bin/lproxy -f -a"==e.dataForm.inputValue&&(t=e.dataForm.inputValue),e.resname="",e.wsUrl="socketTwo9030/cmd.do/"+e.dataForm.sn+"/"+e.stringToHex(t)+"/"+e.encryMD5(e.dataForm.sn),e.$hasPermission("socketTwo9030:cmd:websocket")?(e.content="",e.createWebSocket(),e.loading=!0,e.getMQTTTimer=setTimeout((function(){if(e.loading)return e.loading=!1,e.websocket&&""==e.resname&&(e.websocket.close(),e.websocket=null),e.getMQTTTimer&&(clearTimeout(e.getMQTTTimer),e.getMQTTTimer=null),e.$message.error(e.$t("issue.timeout"))}),"30000")):e.$message.warning("暂无发送命令行请求的权限, 请联系管理员")}}))}),1e3,{leading:!0,trailing:!1}),getNowTime:function(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,n=e.getDate(),o=e.getHours()<10?"0"+e.getHours():e.getHours(),s=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),i=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds(),r=e.getMilliseconds();r=0==String(r).length?"000":1==String(r).length?r+"00":2==String(r).length?r+"0":r;var l=t+"-"+a+"-"+n+" "+o+":"+s+":"+i+"."+r;return l},downBottom:function(){var e=document.getElementById("receiveTextarea");e.scrollTop=e.scrollHeight},createWebSocket:function(){var e=this;if(!("WebSocket"in window))return e.$message.error(e.$t("websocket.notSupportWebsocket"));try{var t="";t=(e.resname,window.SITE_CONFIG["socketUrl"]+e.wsUrl+"?token="+e.$getToken()),e.websocket=new WebSocket(t),e.initWebSocket()}catch(a){}},initWebSocket:function(){this.websocket.onopen=this.websocketonopen,this.websocket.onerror=this.websocketonerror,this.websocket.onmessage=this.websocketonmessage,this.websocket.onclose=this.websocketonclose},websocketonopen:function(){this.lockReconnect=!0},websocketonerror:function(e){this.lockReconnect=!1},openOrCloseCOM:function(e,t){var a=this,n=this.getNowTime();if(0==this.sendForm.checkedList.length){var o=document.createElement("span");o.style.width="auto",o.style.height="auto",o.style.padding="5px 10px",o.style.fontSize="15px",o.style.color="#00C000",o.style.lineHeight="22px",o.innerHTML=this.$t("debuggerInfo.sendSymbol")+"  "+e+"  ("+t+" bytes)",receiveData.appendChild(o),this.$nextTick((function(){a.downBottom()}))}else if(1==this.sendForm.checkedList.length){if(0==this.sendForm.checkedList[0]){var s=document.createElement("span");s.style.width="auto",s.style.height="auto",s.style.padding="5px 10px",s.style.fontSize="15px",s.style.color="#00C000",s.style.lineHeight="22px",s.innerHTML=this.$t("debuggerInfo.sendSymbol")+"  "+e+"  ("+t+" bytes)<br/>",receiveData.appendChild(s),this.$nextTick((function(){a.downBottom()}))}else if(1==this.sendForm.checkedList[0]){var i=document.createElement("span");i.style.width="auto",i.style.height="auto",i.style.padding="5px 10px",i.style.fontSize="15px",i.style.color="#00C000",i.style.lineHeight="22px",i.innerHTML="["+n+"]  "+this.$t("debuggerInfo.sendSymbol")+"  "+e+"  ("+t+" bytes)",receiveData.appendChild(i),this.$nextTick((function(){a.downBottom()}))}else if(2==this.sendForm.checkedList[0]){var r=document.createElement("span");r.style.width="auto",r.style.height="auto",r.style.padding="5px 10px",r.style.fontSize="15px",r.style.color="#00C000",r.style.lineHeight="22px",r.innerHTML="["+n+"]  "+this.$t("debuggerInfo.sendSymbol")+"  "+e+"  ("+t+" bytes)",receiveData.appendChild(r),this.$nextTick((function(){a.downBottom()}))}}else if(2==this.sendForm.checkedList.length)if(this.isInArray(this.sendForm.checkedList,"0"))if(this.isInArray(this.sendForm.checkedList,"1")){if(!this.isInArray(this.sendForm.checkedList,"2")){var l=document.createElement("span");l.style.width="auto",l.style.height="auto",l.style.padding="5px 10px",l.style.fontSize="15px",l.style.color="#00C000",l.style.lineHeight="22px",l.innerHTML="["+n+"]  "+this.$t("debuggerInfo.sendSymbol")+"  "+e+"  ("+t+" bytes)<br/>",receiveData.appendChild(l),this.$nextTick((function(){a.downBottom()}))}}else{var d=document.createElement("span");d.style.width="auto",d.style.height="auto",d.style.padding="5px 10px",d.style.fontSize="15px",d.style.color="#00C000",d.style.lineHeight="22px",d.innerHTML=this.$t("debuggerInfo.sendSymbol")+"  "+e+"  ("+t+" bytes)<br/>",receiveData.appendChild(d),this.$nextTick((function(){a.downBottom()}))}else{var u=document.createElement("span");u.style.width="auto",u.style.height="auto",u.style.padding="5px 10px",u.style.fontSize="15px",u.style.color="#00C000",u.style.lineHeight="22px",u.innerHTML="["+n+"]  "+this.$t("debuggerInfo.sendSymbol")+"  "+e+"  ("+t+" bytes)",receiveData.appendChild(u),this.$nextTick((function(){a.downBottom()}))}else if(3==this.sendForm.checkedList.length){var g=document.createElement("span");g.style.width="auto",g.style.height="auto",g.style.padding="5px 10px",g.style.fontSize="15px",g.style.color="#00C000",g.style.lineHeight="22px",g.innerHTML="["+n+"]  "+this.$t("debuggerInfo.sendSymbol")+"  "+e+"  ("+t+" bytes)<br/>",receiveData.appendChild(g),this.$nextTick((function(){a.downBottom()}))}},isJsonString:function(e){if("string"===typeof e)try{var t=JSON.parse(e);return!("object"!==Object(s["a"])(t)||!t)}catch(a){return!1}},websocketonmessage:function(e){var t=this;if(!t.isJsonString(e.data))return!1;if(t.getMQTTTimer&&(clearTimeout(this.getMQTTTimer),t.getMQTTTimer=null),t.websocket&&(t.websocket.close(),t.websocket=null),"setchlstatus"==t.resname&&"setchlstatus"==JSON.parse(e.data).res_name){var a=JSON.parse(e.data).res_content;if(a.hasOwnProperty("err_code"))return t.$message.error(a.err_msg);1==a.received&&setTimeout((function(){t.openCOMDebug()}),500)}else if("setchlstatusClose"==t.resname&&"setchlstatus"==JSON.parse(e.data).res_name){var n=JSON.parse(e.data).res_content;if(n.hasOwnProperty("err_code"))return t.$message.error(n.err_msg);1==n.received&&setTimeout((function(){t.closeCOMDebug()}),2e3)}else if("setchlstatusCloseDebug"==t.resname&&"setchlstatus"==JSON.parse(e.data).res_name){var o=JSON.parse(e.data).res_content;if(o.hasOwnProperty("err_code"))return t.$message.error(o.err_msg);1==o.received&&setTimeout((function(){t.handleCloseDebug()}),500)}else if("comdebuggerClose"==t.resname&&"debug"==JSON.parse(e.data).res_name)t.repeatTimer&&(clearInterval(t.repeatTimer),t.repeatTimer=null),t.isOpenOrClose||t.resetCOMDebug(),setTimeout((function(){t.debuggerVisible=!1}),500);else if("comdebugger"==t.resname&&"debug"==JSON.parse(e.data).res_name){var s=JSON.parse(e.data).res_content;if(s.hasOwnProperty("err_code"))return t.$message.error(s.err_msg);if(s.hasOwnProperty("successed")){var i=s.successed,r=s.data_buff;s.data_len;return 1==i?(t.loading=!1,r&&"打开成功!"==r&&(t.isOpenOrClose=!1),r&&"关闭成功!"==r&&(t.isOpenOrClose=!0,t.resetCOMDebug()),t.$message.success(r)):(t.loading=!1,t.$message.error(r))}}else if("cmd"==JSON.parse(e.data).res_name)t.loading=!1,t.dataForm.content=JSON.parse(e.data).res_content.reslut;else if("sendMessage"==t.resname&&"debug"==JSON.parse(e.data).res_name){var l=JSON.parse(e.data).res_content;t.handleReciveData(l.successed,l.data_type,l.data_buff,l.data_len)}},handleReciveData:function(e,t,a,n){var o=this,s=this.getNowTime(),i=document.getElementById("receiveTextarea");if(0==this.sendForm.checkedList.length){var r=document.createElement("span");r.style.width="auto",r.style.height="auto",r.style.padding="5px 10px",r.style.fontSize="15px",r.style.color="#0000FF",r.style.lineHeight="22px",r.innerHTML=(0==t?this.$t("debuggerInfo.sendSymbol"):1==t?this.$t("debuggerInfo.receive"):2==t?this.$t("debuggerInfo.message"):3==t?this.$t("debuggerInfo.alarm"):this.$t("debuggerInfo.error"))+"  "+a+"   ("+n+" bytes)",i.appendChild(r),this.$nextTick((function(){o.downBottom()}))}else if(1==this.sendForm.checkedList.length){if(0==this.sendForm.checkedList[0]){var l=document.createElement("span");l.style.width="auto",l.style.height="auto",l.style.padding="5px 10px",l.style.fontSize="15px",l.style.color="#0000FF",l.style.lineHeight="22px",l.innerHTML=(0==t?this.$t("debuggerInfo.sendSymbol"):1==t?this.$t("debuggerInfo.receive"):2==t?this.$t("debuggerInfo.message"):3==t?this.$t("debuggerInfo.alarm"):this.$t("debuggerInfo.error"))+"  "+a+"   ("+n+" bytes)<br/>",i.appendChild(l),this.$nextTick((function(){o.downBottom()}))}else if(1==this.sendForm.checkedList[0]){var d=document.createElement("span");d.style.width="auto",d.style.height="auto",d.style.padding="5px 10px",d.style.fontSize="15px",d.style.color="#0000FF",d.style.lineHeight="22px",d.innerHTML="["+s+"]  "+(0==t?this.$t("debuggerInfo.sendSymbol"):1==t?this.$t("debuggerInfo.receive"):2==t?this.$t("debuggerInfo.message"):3==t?this.$t("debuggerInfo.alarm"):this.$t("debuggerInfo.error"))+"  "+a+"   ("+n+" bytes)",i.appendChild(d),this.$nextTick((function(){o.downBottom()}))}else if(2==this.sendForm.checkedList[0]){var u=document.createElement("span");u.style.width="auto",u.style.height="auto",u.style.padding="5px 10px",u.style.fontSize="15px",u.style.color="#0000FF",u.style.lineHeight="22px",u.innerHTML=(0==t?this.$t("debuggerInfo.sendSymbol"):1==t?this.$t("debuggerInfo.receive"):2==t?this.$t("debuggerInfo.message"):3==t?this.$t("debuggerInfo.alarm"):this.$t("debuggerInfo.error"))+"  "+a+"   ("+n+" bytes)",i.appendChild(u),this.$nextTick((function(){o.downBottom()}))}}else if(2==this.sendForm.checkedList.length)if(this.isInArray(this.sendForm.checkedList,"0"))if(this.isInArray(this.sendForm.checkedList,"1")){if(!this.isInArray(this.sendForm.checkedList,"2")){var g=document.createElement("span");g.style.width="auto",g.style.height="auto",g.style.padding="5px 10px",g.style.fontSize="15px",g.style.color="#0000FF",g.style.lineHeight="22px",g.innerHTML="["+s+"]  "+(0==t?this.$t("debuggerInfo.sendSymbol"):1==t?this.$t("debuggerInfo.receive"):2==t?this.$t("debuggerInfo.message"):3==t?this.$t("debuggerInfo.alarm"):this.$t("debuggerInfo.error"))+"  "+a+"   ("+n+" bytes)<br/>",i.appendChild(g),this.$nextTick((function(){o.downBottom()}))}}else{var c=document.createElement("span");c.style.width="auto",c.style.height="auto",c.style.padding="5px 10px",c.style.fontSize="15px",c.style.color="#0000FF",c.style.lineHeight="22px",c.innerHTML=(0==t?this.$t("debuggerInfo.sendSymbol"):1==t?this.$t("debuggerInfo.receive"):2==t?this.$t("debuggerInfo.message"):3==t?this.$t("debuggerInfo.alarm"):this.$t("debuggerInfo.error"))+"  "+a+"   ("+n+" bytes)<br/>",i.appendChild(c),this.$nextTick((function(){o.downBottom()}))}else{var m=document.createElement("span");m.style.width="auto",m.style.height="auto",m.style.padding="5px 10px",m.style.fontSize="15px",m.style.color="#0000FF",m.style.lineHeight="22px",m.innerHTML="["+s+"]  "+(0==t?this.$t("debuggerInfo.sendSymbol"):1==t?this.$t("debuggerInfo.receive"):2==t?this.$t("debuggerInfo.message"):3==t?this.$t("debuggerInfo.alarm"):this.$t("debuggerInfo.error"))+"  "+a+"   ("+n+" bytes)",i.appendChild(m),this.$nextTick((function(){o.downBottom()}))}else if(3==this.sendForm.checkedList.length){var b=document.createElement("span");b.style.width="auto",b.style.height="auto",b.style.padding="5px 10px",b.style.fontSize="15px",b.style.color="#0000FF",b.style.lineHeight="22px",b.innerHTML="["+s+"]  "+(0==t?this.$t("debuggerInfo.sendSymbol"):1==t?this.$t("debuggerInfo.receive"):2==t?this.$t("debuggerInfo.message"):3==t?this.$t("debuggerInfo.alarm"):this.$t("debuggerInfo.error"))+"  "+a+"   ("+n+" bytes)<br/>",i.appendChild(b),this.$nextTick((function(){o.downBottom()}))}},websocketonclose:function(e){this.lockReconnect=!1},handleClose:function(){var e=this;if(e.isOpenOrClose)e.repeatTimer&&(clearInterval(e.repeatTimer),e.repeatTimer=null),e.websocket&&e.websocket.readyState===WebSocket.OPEN&&(e.websocket.close(),e.websocket=null),e.debuggerVisible=!1;else if(e.debugForm.comname){var t=[{com:parseInt(e.debugForm.comname.replace(/[^0-9]/gi,"")),gwsn:e.dataForm.sn,status:0}],a=Object(I["p"])(JSON.stringify(t));e.$nextTick((function(){e.resname="setchlstatusCloseDebug",e.wsUrl="socketList/setchlstatusCds/"+e.stringToHex(a)+"/"+e.encryMD5List(),e.$hasPermission("socketList:setchlstatusCds:websocket")?(e.createWebSocket(),e.getMQTTTimer=setTimeout((function(){if(e.loading)return e.loading=!1,e.websocket&&"setchlstatusCloseDebug"==e.resname&&e.websocket.readyState===WebSocket.OPEN&&(e.websocket.close(),e.websocket=null),e.getMQTTTimer&&(clearTimeout(e.getMQTTTimer),e.getMQTTTimer=null),e.$message.error(e.$t("issue.timeout"))}),"30000")):e.$message.warning("暂无设置串口状态权限, 请联系管理员")}))}else e.handleCloseDebug()},handleCloseDebug:function(){var e=this,t=[{guid:e.guid,gwsn:e.dataForm.sn,act:0,type:0}];e.resname="comdebuggerClose";var a=Object(I["p"])(JSON.stringify(t));e.$nextTick((function(){e.wsUrl="socketList/debug/"+e.stringToHex(a)+"/"+e.encryMD5List(),e.$hasPermission("socketList:debug:websocket")?(e.createWebSocket(),e.getMQTTTimer=setTimeout((function(){if(e.loading)return e.loading=!1,e.websocket&&"comdebuggerClose"==e.resname&&e.websocket.readyState===WebSocket.OPEN&&(e.websocket.close(),e.websocket=null),e.getMQTTTimer&&(clearTimeout(e.getMQTTTimer),e.getMQTTTimer=null),e.$message.error(e.$t("issue.timeout"))}),"30000")):e.$message.warning("暂无设置Debug调试权限, 请联系管理员")}))}},watch:{resname:function(e,t){"sendMessage"!=e&&this.repeatTimer&&(clearInterval(this.repeatTimer),this.repeatTimer=null)},"dataForm.inputValue":{handler:function(e,t){e||(this.paramsData=this.commandList),"ping"==e?this.dataForm.addContent="www.baidu.com":"Telnet"==e?this.dataForm.addContent="192.168.11.177 22":"ifconfig"==e?this.dataForm.addContent="":"route"==e?this.dataForm.addContent="-n":"ls"==e?this.dataForm.addContent="":"ps"==e?this.dataForm.addContent="-aux":"reboot"==e?this.dataForm.addContent="":"tail -100 /logs/dial-daemon.log"==e||"tail -100 /logs/ioserver.log"==e||"tail -100 /logs/iosysmgr.log"==e||"tail -100 /logs/reboot.log"==e?this.dataForm.addContent="100":"tail -200 /logs/update.log"==e?this.dataForm.addContent="200":"tail -100 /logs/python3.11.log"==e?this.dataForm.addContent="100":"tail -200 /logs/iopython.log"==e?this.dataForm.addContent="200":"uptime"==e?this.dataForm.addContent="":"df"==e?this.dataForm.addContent="-h":"set_rmodel"==e||"set_model"==e?this.dataForm.addContent="":"get_pro_ver"==e?this.dataForm.addContent="modbusrtu,104client":"set_server"==e||"set_hardver"==e||"wget http://47.97.250.62/help-doc/protocol.json -O /data/config/protocol.json"==e||"cat /tmp/machine.enc"==e||"rm /data/protocols/*"==e||"mv /sbin/dhcpcd /sbin/dhcpcd.bak && killall -9 dhcpcd"==e||"rm /data/tuya_key.json"==e?this.dataForm.addContent="":"netstat"===e?this.dataForm.addContent="-tuln":"wget"===e||"/data/bin/curl"===e||"wgetbmse1"===e||"wgetbmse2"===e||"chmod +x"===e||"/data/bin/bmser_exota -d 1 -n 1 --cmd 2 1 --tcp"===e||'/data/bin/bmser_exota -f "/tmp/bmse.bin" -d 1 -n 1 --tcp'===e||"cat /tmp/debug_status.json"===e?this.dataForm.addContent="":"/data/bin/tftpd-hpa -l -s"===e?this.dataForm.addContent="/tmp -c":("/data/bin/lproxy -f -a"===e||"tail -f /logs/lua.log"===e)&&(this.dataForm.addContent="")}}}},k=T,C=(a("de64"),Object(w["a"])(k,n,o,!1,null,"46a020b2",null));t["default"]=C.exports}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-de564914"],{"19f8":function(e,t,a){},"25c7":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("section",[t("el-dialog",{attrs:{visible:e.visible,title:e.$t("attribute.addMultipe"),"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.visible=t},opened:e.handleDialogOpenChange}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataForm",attrs:{model:e.dataForm,rules:e.rules,"label-width":(e.$i18n.locale,"120px")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dataFormSubmitHandle()}}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.belongDevicce"),prop:"devid"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("attribute.placeholderSelect")},on:{change:e.selectdevice},model:{value:e.dataForm.devid,callback:function(t){e.$set(e.dataForm,"devid",t)},expression:"dataForm.devid"}},e._l(e.equipmentList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.devId}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.tagname")}},[t("el-input",{attrs:{placeholder:e.$t("attribute.placeholderSelect"),readonly:""},on:{focus:e.handleTag},model:{value:e.names,callback:function(t){e.names=t},expression:"names"}},[this.tagnameList.length>1?t("template",{slot:"append"},[t("el-button",{attrs:{type:"small"}},[e._v(e._s("+")+e._s(this.tagnameList.length-1))])],1):e._e()],2)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.tagk"),prop:"k"}},[t("el-input",{attrs:{clearable:"",placeholder:e.$t("attribute.tagk"),onkeyup:"value=value.replace(/^\\D*(\\d*(?:\\.\\d{0,6})?).*$/g, '$1')"},model:{value:e.dataForm.k,callback:function(t){e.$set(e.dataForm,"k",t)},expression:"dataForm.k"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.collecttypec"),prop:"collecttypec"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("attribute.placeholderSelect")},model:{value:e.dataForm.collecttypec,callback:function(t){e.$set(e.dataForm,"collecttypec",t)},expression:"dataForm.collecttypec"}},e._l(e.functionCodeType,(function(e){return t("el-option",{key:e.FuncCode,attrs:{label:e.description,value:e.FuncCode}})})),1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.address"),prop:"objaddr"}},[t("el-input",{attrs:{clearable:"",placeholder:e.$t("attribute.address")},model:{value:e.dataForm.objaddr,callback:function(t){e.$set(e.dataForm,"objaddr",t)},expression:"dataForm.objaddr"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.datatype"),prop:"datatype"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("attribute.placeholderSelect")},on:{change:e.handleDataType},model:{value:e.dataForm.datatype,callback:function(t){e.$set(e.dataForm,"datatype",t)},expression:"dataForm.datatype"}},e._l(e.dataType,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.dataformat"),prop:"dataformat"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("attribute.placeholderSelect")},model:{value:e.dataForm.dataformat,callback:function(t){e.$set(e.dataForm,"dataformat",t)},expression:"dataForm.dataformat"}},e._l(e.hiloType,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:function(t){e.visible=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmitHandle()}}},[e._v(e._s(e.$t("confirm")))])],1)],2),t("el-dialog",{attrs:{visible:e.tagVisible,width:"60%",title:e.$t("attribute.collectTagName"),"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":e.handleTagnameClose},on:{"update:visible":function(t){e.tagVisible=t}}},[t("el-row"),t("el-row",[t("el-col",{attrs:{span:6}},[t("el-tree",{ref:"tree",attrs:{data:e.blocClasstreeData,"show-checkbox":"","node-key":"id","default-expand-all":""},on:{check:e.handleCheckChange}})],1),t("el-col",{attrs:{span:18}},[t("el-select",{attrs:{placeholder:e.$t("select"),filterable:"",clearable:"",size:"small"},on:{change:function(t){e.tagPage=1,e.getTagsList()},clear:function(t){e.tagPage=1,e.getTagsList()}},model:{value:e.alarmtype,callback:function(t){e.alarmtype=t},expression:"alarmtype"}},e._l(e.alarmtypeList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("el-virtual-transfer",{directives:[{name:"loading",rawName:"v-loading",value:e.transferLoading,expression:"transferLoading"}],staticStyle:{"margin-top":"10px"},attrs:{titles:[e.$t("attribute.unSelect"),e.$t("attribute.selected")],filterable:"","filter-method":e.filterMethod,"target-order":"push",data:e.data},on:{change:e.handleTransferChange,"left-reach-bottom":e.getTagScrollList},scopedSlots:e._u([{key:"default",fn:function(a){var i=a.option;return t("span",{},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:i.label,placement:"top"}},[t("span",{staticClass:"div1"},[e._v(e._s(i.label))])]),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:i.tagcomment||e.$t("none"),placement:"top"}},[t("span",{staticClass:"div2"},[e._v(e._s(i.tagcomment||e.$t("none")))])])],1)}}]),model:{value:e.tagnameList,callback:function(t){e.tagnameList=t},expression:"tagnameList"}})],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:function(t){return e.handleDialogClose()}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmit()}}},[e._v(e._s(e.$t("confirm")))])],1)],2)],1)},l=[],r=(a("4917"),a("7f7f"),a("28a5"),a("c5f6"),a("53ca")),s=(a("a481"),a("ac6a"),a("55dd"),a("96cf"),a("1da1")),n=a("4328"),o=a.n(n),d=a("b047"),h=a.n(d),c={props:["queryParams"],data:function(){return{alarmtype:"",paramsDevid:null,names:"",tagPage:1,tagTotal:0,data:[],taganameArr:[],isParamK:!0,loading:!1,visible:!1,childguid:"",equipmentList:[],functionCodeType:[],tagnameList:[],transferLoading:!1,nameObjList:[],tagIdList:[],tagVisible:!1,blocClasstreeData:[],checkedId:[],storeIds:[],storeChecked:[],paramsData:[],devObj:{},dataForm:{tagchlid:"",devid:"",tagcomment:"",k:1,collecttypec:null,objaddr:"0",datatype:4,dataformat:0,gwsn:""},filterMethod:function(e,t){return t.label.indexOf(e)>-1||t.tagcomment.indexOf(e)>-1},alarmtypeList:[{label:this.$t("attribute.all"),value:""},{label:this.$t("attribute.visualValue"),value:0},{label:this.$t("attribute.switchValue"),value:1},{label:this.$t("attribute.ym"),value:2},{label:this.$t("attribute.yk"),value:3},{label:this.$t("attribute.yt"),value:4}],dataType:[{label:this.$t("attribute.bit"),value:0},{label:this.$t("attribute.eightNoSymbol"),value:1},{label:this.$t("attribute.eightSymbol"),value:2},{label:this.$t("attribute.sixteenNoSymbol"),value:3},{label:this.$t("attribute.sixteenSymbol"),value:4},{label:this.$t("attribute.twentyFourNoSymbol"),value:14},{label:this.$t("attribute.twentyFourSymbol"),value:15},{label:this.$t("attribute.thirtySecondNoSymbol"),value:5},{label:this.$t("attribute.thirtySecondSymbol"),value:6},{label:this.$t("attribute.sixteenBCD"),value:7},{label:this.$t("attribute.thirtySecondBCD"),value:8},{label:this.$t("attribute.singleFloat"),value:9},{label:this.$t("attribute.doubleFloat"),value:10},{label:this.$t("attribute.string"),value:11},{label:this.$t("attribute.sixtyFourUnsigned"),value:12},{label:this.$t("attribute.sixtyFourSigned"),value:13}],hiloType:[{label:"12",value:0},{label:"21",value:1},{label:"1234",value:2},{label:"2143",value:3},{label:"3412",value:4},{label:"4321",value:5}],rules:{devid:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],tagrwprop:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],k:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],collecttypec:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],objaddr:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],datatype:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],dataformat:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]}}},methods:{init:function(){this.visible=!0,this.loading=!0},handleDialogOpenChange:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.$refs["dataForm"].resetFields(),!String(this.dataForm.datatype)){e.next=1;break}return e.next=1,this.handleDataType(this.dataForm.datatype);case 1:return this.names="",this.checkedId=[],this.tagnameList=[],e.next=2,this.getdevList();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),compareBySort:function(e,t){return e.sort((function(e,a){return e[t]-a[t]}))},getdevList:function(){var e=this;if(this.$hasSessionStorageGwsn()){this.equipmentList=[];var t={gwsn:sessionStorage.getItem("gwsn")};if(!this.$hasPermission("list:getChlList:select:permission.do"))return void this.$message.warning("暂无通道查询权限, 请联系管理员");this.$http.get("/list/getChlList.do",{params:t}).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);if(a.data.length>0?(a.data.forEach((function(t){1==t.chlType&&t.dev2PojoList&&t.dev2PojoList.length>0&&t.dev2PojoList.forEach((function(a){var i={label:a.devName+"-"+t.chlName,devId:a.devID,chlId:t.chlID};e.equipmentList.push(i)}))})),e.equipmentList=e.compareBySort(e.equipmentList,"devId")):(e.$message.warning(e.$t("attribute.currentlyNoForwardingDevices")),e.loading=!1,setTimeout((function(){e.visible=!1}),1e3)),e.equipmentList.length>0){if(e.paramsDevid)for(var i=0;i<e.equipmentList.length;i++){var l=e.equipmentList[i];if(e.paramsDevid==l.devId){e.dataForm.devid=l.devId;break}}else if(e.queryParams.devId)for(var r=0;r<e.equipmentList.length;r++){var s=e.equipmentList[r];if(e.queryParams.devId==s.devId){e.dataForm.devid=s.devId;break}}else e.dataForm.devid=e.equipmentList[0].devId;e.selectdevice(e.dataForm.devid)}else e.$message.warning(e.$t("attribute.currentlyNoForwardingDevices")),e.loading=!1,setTimeout((function(){e.visible=!1}),1e3)})).catch((function(e){return!1}))}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},selectdevice:function(e){var t=this;if(t.$hasSessionStorageGwsn()){if(!t.$hasPermission("deviceinfo:selectByDevidAndGwsn:permission.do"))return void t.$message.warning("暂无设备信息查询权限, 请联系管理员");t.$http.get("/info/deviceinfo/getByDevidAndGwsn",{params:{devid:e,gwsn:sessionStorage.getItem("gwsn")}}).then((function(e){var a=e.data;if(0!==a.code)return t.$message.error(a.data||a.msg);t.devObj=a.data[0],t.$hasPermission("channelinfo:info:select:permission.do")?t.$http.get("/info/channelinfo/getByChliId",{params:{chlid:a.data[0].chlid,gwsn:sessionStorage.getItem("gwsn")}}).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.dataForm.tagchlid=a.data[0].chlid,t.childguid=a.data[0].chlprotocol,t.getguidinfo(t.childguid)})):t.$message.warning("暂无通道信息查询权限, 请联系管理员")})).catch((function(e){return!1}))}else t.$message({showClose:!1,message:t.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}})},getguidinfo:function(e){var t=this;this.functionCodeType=[],this.$hasPermission("protocolinfo:select:permission.do")?this.$http.get("/info/protocolinfo/proguid",{params:{guid:e}}).then((function(e){var a=e.data;if(t.loading=!1,0!==a.code)return t.$message.error(a.data||a.msg);a.data.length>0&&(t.functionCodeType=JSON.parse(a.data[0].funccode).data,t.functionCodeType.length>0&&!t.dataForm.id&&(t.dataForm.collecttypec=t.functionCodeType[0].FuncCode))})).catch((function(e){return t.loading=!1,!1})):this.$message.warning("暂无协议信息查询权限, 请联系管理员")},handleDataType:function(e){var t=this,a=!1;if(0==e){a=!1,this.hiloType=[{label:"12",value:0},{label:"21",value:1}];for(var i=0;i<this.hiloType.length;i++){var l=this.hiloType[i];if(this.dataForm.dataformat==l.value){a=!0;break}}}else if(1==e){a=!1,this.hiloType=[{label:"12",value:0},{label:"21",value:1}];for(var r=0;r<this.hiloType.length;r++){var s=this.hiloType[r];if(this.dataForm.dataformat==s.value){a=!0;break}}}else if(2==e){a=!1,this.hiloType=[{label:"12",value:0},{label:"21",value:1}];for(var n=0;n<this.hiloType.length;n++){var o=this.hiloType[n];if(this.dataForm.dataformat==o.value){a=!0;break}}}else if(3==e){a=!1,this.hiloType=[{label:"12",value:0},{label:"21",value:1}];for(var d=0;d<this.hiloType.length;d++){var h=this.hiloType[d];if(this.dataForm.dataformat==h.value){a=!0;break}}}else if(4==e){a=!1,this.hiloType=[{label:"12",value:0},{label:"21",value:1}];for(var c=0;c<this.hiloType.length;c++){var u=this.hiloType[c];if(this.dataForm.dataformat==u.value){a=!0;break}}}else if(5==e){a=!1,this.hiloType=[{label:"1234",value:2},{label:"2143",value:3},{label:"3412",value:4},{label:"4321",value:5}];for(var g=0;g<this.hiloType.length;g++){var m=this.hiloType[g];if(this.dataForm.dataformat==m.value){a=!0;break}}}else if(6==e){a=!1,this.hiloType=[{label:"1234",value:2},{label:"2143",value:3},{label:"3412",value:4},{label:"4321",value:5}];for(var f=0;f<this.hiloType.length;f++){var p=this.hiloType[f];if(this.dataForm.dataformat==p.value){a=!0;break}}}else if(7==e){a=!1,this.hiloType=[{label:"12",value:0},{label:"21",value:1}];for(var b=0;b<this.hiloType.length;b++){var v=this.hiloType[b];if(this.dataForm.dataformat==v.value){a=!0;break}}}else if(8==e){a=!1,this.hiloType=[{label:"1234",value:2},{label:"2143",value:3},{label:"3412",value:4},{label:"4321",value:5}];for(var y=0;y<this.hiloType.length;y++){var $=this.hiloType[y];if(this.dataForm.dataformat==$.value){a=!0;break}}}else if(9==e){a=!1,this.hiloType=[{label:"1234",value:2},{label:"2143",value:3},{label:"3412",value:4},{label:"4321",value:5}];for(var w=0;w<this.hiloType.length;w++){var k=this.hiloType[w];if(this.dataForm.dataformat==k.value){a=!0;break}}}else if(10==e){a=!1,this.hiloType=[{label:"1234",value:2},{label:"2143",value:3},{label:"3412",value:4},{label:"4321",value:5}];for(var S=0;S<this.hiloType.length;S++){var T=this.hiloType[S];if(this.dataForm.dataformat==T.value){a=!0;break}}}else if(11==e){a=!1,this.hiloType=[{label:"12",value:0},{label:"21",value:1},{label:"1234",value:2},{label:"2143",value:3},{label:"3412",value:4},{label:"4321",value:5}];for(var F=0;F<this.hiloType.length;F++){var C=this.hiloType[F];if(this.dataForm.dataformat==C.value){a=!0;break}}}else if(12==e){a=!1,this.hiloType=[{label:"1234",value:2},{label:"2143",value:3},{label:"3412",value:4},{label:"4321",value:5}];for(var L=0;L<this.hiloType.length;L++){var j=this.hiloType[L];if(this.dataForm.dataformat==j.value){a=!0;break}}}else if(13==e){a=!1,this.hiloType=[{label:"1234",value:2},{label:"2143",value:3},{label:"3412",value:4},{label:"4321",value:5}];for(var x=0;x<this.hiloType.length;x++){var D=this.hiloType[x];if(this.dataForm.dataformat==D.value){a=!0;break}}}this.$nextTick((function(){a||(t.dataForm.dataformat=t.hiloType[0].value)}))},handleTag:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.$hasPermission("channelinfo:selectChlAndDev:permission.do")){e.next=1;break}return this.$message.warning("暂无设备查询权限, 请联系管理员"),e.abrupt("return");case 1:return this.tagVisible=!0,e.next=2,this.getTreeList();case 2:this.storeChecked.length>0&&this.$nextTick((function(){var e=this;setTimeout((function(){e.storeChecked.forEach((function(t){if(t.label==e.$t("attribute.own")){var a=[];a.push(t.id),t.children.forEach((function(e){a.push(e.id)})),e.$refs.tree.setCheckedKeys(a,!1)}else{var i=[];i.push(t.id),e.$refs.tree.setCheckedKeys(i,!1)}}))}),500)}));case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getTreeList:function(){var e=this,t={chltype:0,gwsn:sessionStorage.getItem("gwsn")};if(e.blocClasstreeData=[{id:0,label:e.$t("attribute.own"),children:[{id:1,label:e.$t("attribute.ownCenter"),p_id:0}]}],e.$hasSessionStorageGwsn()){if(!e.$hasPermission("channelinfo:selectChlAndDev:permission.do"))return void e.$message.warning("暂无设备查询权限, 请联系管理员");e.$http.post("/info/channelinfo/selectChlAndDev",o.a.stringify(t)).then((function(t){var a=t.data;a.length>0&&a.forEach((function(t){var a={id:t.chlid,label:t.chlname,p_id:0};t.children.length>0&&(a.children=[],t.children.forEach((function(e){var t={id:e.devid,label:e.devname,children:[]};a.children.push(t)}))),e.blocClasstreeData[0].children.push(a)}))})).catch((function(e){return!1}))}else e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},getSimpleCheckedNodes:function(e){var t=[],a=function(e){var i=e.root?e.root.childNodes:e.childNodes;i.forEach((function(e){e.checked&&t.push(e.data),e.indeterminate&&a(e)}))};return a(e),t},handleCheckChange:function(){this.storeIds=this.getSimpleCheckedNodes(this.$refs.tree.store),this.checkedId=this.$refs.tree.getCheckedNodes(),this.checkedId.length>0?(this.tagPage=1,this.getTagsList()):this.data=[]},handleTransferChange:function(e,t,a){"right"===t&&this.data.length<this.tagTotal&&(this.tagPage++,this.getTagsList())},getTagScrollList:h()((function(){this.data.length<this.tagTotal&&(this.tagPage++,this.getTagsList())}),100,{leading:!0,trailing:!1}),getTagsList:function(){var e=this,t=[],a="/info/taginfo/selectTags.do",i=[],l={page:e.tagPage,limit:500,alarmtype:e.alarmtype,gwsn:sessionStorage.getItem("gwsn")};if(e.$hasSessionStorageGwsn()){if(0==e.checkedId.length)return e.$message.warning(e.$t("attribute.pleaseSelectTheDeviceFirst"));if(e.checkedId.forEach((function(a){0!=a.id&&(0==a.p_id&&-1!=a.label.indexOf(e.$t("attribute.ownCenter"))||0!=a.p_id)&&t.push(a.id)})),l["deviceid"]=t.join(","),t.length>0){if(!e.$hasPermission("taginfo:select:permission.do"))return void e.$message.warning("暂无测点查询权限, 请联系管理员");1==e.tagPage&&(e.data=[]),e.transferLoading=!0,e.$http.get(a,{params:l}).then((function(t){var a=t.data;if(0!=a.code)return e.transferLoading=!1,e.$message.error(a.data||a.msg);"object"==Object(r["a"])(a.data)&&(e.tagTotal=Number(a.data.total),a.data.rows.forEach((function(e){i.push({key:e.tagname+"?"+(e.tagcomment||""),label:e.tagname,tagcomment:e.tagcomment})})),e.data=e.data.concat(i)),e.transferLoading=!1})).catch((function(t){return e.transferLoading=!1,!1}))}}else e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},handleDialogClose:function(){this.data=[],this.tagnameList=[],this.names="",this.tagVisible=!1},handleTagnameClose:function(){this.tagVisible=!1},dataFormSubmit:h()((function(){var e=this;this.nameObjList=[],this.tagnameList.length>0&&(this.tagnameList.forEach((function(t){var a={name:t.split("?")[0],tagcomment:t.split("?")[1]};e.nameObjList.push(a)})),this.names=this.nameObjList[0].name),this.tagVisible=!1,this.storeChecked=this.storeIds}),1e3,{leading:!0,trailing:!1}),dataFormSubmitHandle:h()((function(){var e=this,t=null,a=/.*\..*/,i=[];if(this.$hasSessionStorageGwsn()){if(this.paramsData=[],0===this.tagnameList.length)return this.$message.error(this.$t("attribute.pleaseSelectTagName"));if(!this.$hasPermission("transtaginfo:insert:permission.do"))return void this.$message.warning("暂无转发测点新增权限, 请联系管理员");this.$refs["dataForm"].validate((function(l){if(!l)return!1;if(e.loading=!0,-1!=e.$chineseChar2englishChar(String(e.dataForm.objaddr)).indexOf(",")){var r=e.$chineseChar2englishChar(String(e.dataForm.objaddr)).split(",")[0],s=e.$chineseChar2englishChar(String(e.dataForm.objaddr)).split(",")[1],n=null,o=null,d=e.$chineseChar2englishChar(String(s)),h=d.match(/\d+\.*\d*/g);if(h&&h.length>0){a.test(h[h.length-1])?(n=h[h.length-1].split(".")[1],o=d.substring(0,d.length-String(n).length)):(n=h[h.length-1],o=d.substring(0,d.length-String(n).length));var c=parseInt(n),u=0,g="",m=parseInt(n);if(a.test(n)&&(u=n.split(".")[1]),a.test(n))for(var f=0;f<e.nameObjList.length;f++){if(String(n).length>String(m).length){g="";for(var p=0;p<String(n).length-String(m).length;p++)g+="0"}else g="";""!=g?i.push(r?r+","+o+g+m:o+g+m):i.push(r?r+","+o+m:o+m),u++,m=c+"."+u}else for(var b=0;b<e.nameObjList.length;b++){if(String(n).length>String(m).length){g="";for(var v=0;v<String(n).length-String(m).length;v++)g+="0"}else g="";""!=g?i.push(r?r+","+o+String(g)+m:o+g+m):i.push(r?r+","+o+m:o+m),m++}}else for(var y=0;y<e.nameObjList.length;y++)i.push(String(e.dataForm.objaddr)+String(y))}else{var $=null,w=null,k=e.$chineseChar2englishChar(String(e.dataForm.objaddr)),S=k.match(/\d+\.*\d*/g);if(S&&S.length>0){a.test(S[S.length-1])?($=S[S.length-1].split(".")[1],w=k.substring(0,k.length-String($).length)):($=S[S.length-1],w=k.substring(0,k.length-String($).length));var T=parseInt($),F=0,C="",L=parseInt($);if(a.test($)&&(F=$.split(".")[1]),a.test($))for(var j=0;j<e.nameObjList.length;j++){if(String($).length>String(L).length){C="";for(var x=0;x<String($).length-String(L).length;x++)C+="0"}else C="";""!=C?i.push(w?w+C+L:L):i.push(w?w+L:L),F++,L=T+"."+F}else for(var D=0;D<e.nameObjList.length;D++){if(String($).length>String(L).length){C="";for(var I=0;I<String($).length-String(L).length;I++)C+="0"}else C="";""!=C?i.push(w?w+String(C)+L:C+L):i.push(w?w+L:L),L++}}else for(var O=0;O<e.nameObjList.length;O++)i.push(String(e.dataForm.objaddr)+String(O))}for(var q=0;q<e.nameObjList.length;q++){var _={};_.tagname=e.nameObjList[q].name,_.tagchlid=e.dataForm.tagchlid,_.devid=e.dataForm.devid,_.tagcomment=e.nameObjList[q].tagcomment,_.k=e.dataForm.k,_.collecttypec=e.dataForm.collecttypec,_.objaddr=i[q],_.datatype=e.dataForm.datatype,_.dataformat=e.dataForm.dataformat,_.gwsn=sessionStorage.getItem("gwsn"),_.tagsource=2,e.paramsData.push(_)}t=e.paramsData,e.$http.post("/info/transtaginfo/insertAdd",t).then((function(t){var a=t.data;if(0!==a.code)return e.loading=!1,e.$message.error(a.data||a.msg);e.loading=!1,e.$message({message:e.$t("prompt.success"),type:"success",duration:500,onClose:function(){e.visible=!1,e.data=[],e.storeChecked=[],e.$refs.tree.setCheckedKeys([]),e.$refs["dataForm"].resetFields(),e.$emit("refreshDataList")}})})).catch((function(t){return e.loading=!1,e.visible=!1,e.data=[],e.storeChecked=[],e.$refs.tree.setCheckedKeys([]),e.$refs["dataForm"].resetFields(),e.$emit("refreshDataList")}))}))}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1})},watch:{tagnameList:{handler:function(e,t){this.tagnameList=e}}}},u=c,g=(a("cbb9"),a("2877")),m=Object(g["a"])(u,i,l,!1,null,"897bcb54",null);t["default"]=m.exports},cbb9:function(e,t,a){"use strict";a("19f8")}}]);
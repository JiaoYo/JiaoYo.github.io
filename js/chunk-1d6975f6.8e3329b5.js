(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1d6975f6"],{6664:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{width:"800px",visible:e.visible,title:e.dataForm.id?e.$t("update")+e.propSoftname:e.$t("add"),"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.visible=t},close:e.handleClose}},[t("el-descriptions",{attrs:{direction:"vertical",column:5,border:""}},[t("el-descriptions-item",{attrs:{label:e.$t("licenseinfo.totalNumberOfGeneralAuthorizations")}},[e._v(e._s(e.propNormalTotal))]),t("el-descriptions-item",{attrs:{label:e.$t("licenseinfo.usedNumberOfGeneralAuthorizationsAddress")}},[e._v(e._s(e.propNormalUsed))]),t("el-descriptions-item",{attrs:{label:e.$t("licenseinfo.totalIncreaseOrDecrease")}},[t("el-select",{staticStyle:{width:"140px"},attrs:{size:"small",filterable:"",placeholder:e.$t("channelInfo.pleaseSelect")},model:{value:e.dataForm.commonType,callback:function(t){e.$set(e.dataForm,"commonType",t)},expression:"dataForm.commonType"}},e._l(e.typeList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-descriptions-item",{attrs:{label:e.$t("licenseinfo.number")}},[t("el-input-number",{staticStyle:{width:"160px"},attrs:{size:"small","controls-position":"right",min:1,placeholder:e.$t("licenseinfo.pleaseEnterNumber")},model:{value:e.dataForm.commonValue,callback:function(t){e.$set(e.dataForm,"commonValue",t)},expression:"dataForm.commonValue"}})],1),t("el-descriptions-item",[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handleConfirmChange(2)}}},[e._v(e._s(e.$t("confirm")))])],1)],1),t("el-descriptions",{staticStyle:{"margin-top":"20px"},attrs:{direction:"vertical",column:5,border:""}},[t("el-descriptions-item",{attrs:{label:e.$t("licenseinfo.totalNumberOfExtendedAuthorizations")}},[e._v(e._s(e.propExTotal))]),t("el-descriptions-item",{attrs:{label:e.$t("licenseinfo.usedNumberOfExtendedAuthorizationsAddress")}},[e._v(e._s(e.propExUsed))]),t("el-descriptions-item",{attrs:{label:e.$t("licenseinfo.totalIncreaseOrDecrease")}},[t("el-select",{staticStyle:{width:"140px"},attrs:{size:"small",filterable:"",placeholder:e.$t("channelInfo.pleaseSelect")},model:{value:e.dataForm.licenseType,callback:function(t){e.$set(e.dataForm,"licenseType",t)},expression:"dataForm.licenseType"}},e._l(e.typeList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-descriptions-item",{attrs:{label:e.$t("licenseinfo.number")}},[t("el-input-number",{staticStyle:{width:"160px"},attrs:{size:"small","controls-position":"right",min:1,placeholder:e.$t("licenseinfo.pleaseEnterNumber")},model:{value:e.dataForm.licenseValue,callback:function(t){e.$set(e.dataForm,"licenseValue",t)},expression:"dataForm.licenseValue"}})],1),t("el-descriptions-item",[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handleConfirmChange(1)}}},[e._v(e._s(e.$t("confirm")))])],1)],1)],1)},r=[],o=a("2909"),s=(a("28a5"),a("b047")),n=a.n(s),l={props:["propId","propSoftname","propNormalTotal","propNormalUsed","propExTotal","propExUsed"],data:function(){return{visible:!1,loading:!1,dataForm:{id:"",commonType:1,commonValue:"",licenseType:1,licenseValue:""},rules:{sns:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],way:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],softwareName:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],expireTime:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],tagCount:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]},typeList:[{label:this.$t("licenseinfo.increase"),value:1},{label:this.$t("licenseinfo.decrease"),value:2}]}},methods:{init:function(){var e=this;e.visible=!0,e.$nextTick((function(){e.dataForm={id:"",commonType:1,commonValue:1,licenseType:1,licenseValue:1},e.dataForm.id=e.propId,e.dataForm.id&&e.getInfo()}))},getInfo:function(){var e=this;e.$hasPermission("sys:authorizes:info")?(e.loading=!0,e.$http.get("/authorizes/task/".concat(e.propId),{params:{id:e.propId}}).then((function(t){var a=t.data;if(0!=a.code)return e.loading=!1,e.$message.error(a.msg);e.selectRow={sn:a.data.sn},e.dataForm={id:a.data.id,sns:a.data.sn,way:a.data.updateType,softwareChecked:!0,softwareName:a.data.softName,expireTimeChecked:!0,expireTime:a.data.ovDate,tagCountChecked:!0,tagCount:a.data.tagNum},e.loading=!1})).catch((function(t){return e.loading=!1,!1}))):e.$message.warning("暂无出厂授权信息详情查询权限, 请联系管理员")},handleConfirmChange:function(e){var t=this,a={id:t.dataForm.id};if(1==e){if(!t.dataForm.licenseValue)return t.$message.error(t.$t("licenseinfo.pleaseEnterNumber"));a["opEx"]=t.dataForm.licenseType,a["opExAmount"]=t.dataForm.licenseValue}else{if(!t.dataForm.commonValue)return t.$message.error(t.$t("licenseinfo.pleaseEnterNumber"));a["opNormal"]=t.dataForm.commonType,a["opNormalAmount"]=t.dataForm.commonValue}t.$hasPermission("sys:authorizes:update")?(t.loading=!0,t.$http.post("/sys/authorizes/changeAmount",a).then((function(e){var a=e.data;if(0!=a.code)return t.loading=!1,t.$message.error(a.msg);t.loading=!1,t.$message.success(a.msg),t.visible=!1,t.$emit("refreshDataList")})).catch((function(e){return t.loading=!1,!1}))):t.$message.warning("暂无出厂授权信息修改权限, 请联系管理员")},handleClose:n()((function(){this.visible=!1}),1e3,{leading:!0,trailing:!1}),dataFormSubmitHandle:n()((function(){var e=this,t="/authorizes/task/wg_authorize",a=[],i={protocolIdList:[],updateType:e.dataForm.way};e.$refs["dataForm"].validate((function(r){if(!r)return!1;if(e.dataForm.id?(t="/authorizes/task",i={id:e.dataForm.id,sn:e.dataForm.sns,protocols:"",updateType:e.dataForm.way}):i={protocolIdList:[],updateType:e.dataForm.way,snList:e.dataForm.sns.split(",")},!e.dataForm.softwareChecked)return e.$message.error(e.$t("authorization.pleaseCheckSoftwareName"));if(!e.dataForm.softwareName)return e.$message.error(e.$t("authorization.authorizedSoftwareNameEmpty"));if(e.dataForm.id?i["softName"]=e.dataForm.softwareName:i["name"]=e.dataForm.softwareName,!e.dataForm.expireTimeChecked)return e.$message.error(e.$t("authorization.pleaseCheckExpirationDate"));if(!e.dataForm.expireTime)return e.$message.error(e.$t("authorization.authorizedExpirationDateEmpty"));if(i["ovDate"]=e.dataForm.expireTime,!e.dataForm.tagCountChecked)return e.$message.error(e.$t("authorization.pleaseCheckTagNum"));if(!e.dataForm.tagCount)return e.$message.error(e.$t("authorization.authorizedTagNumEmpty"));for(var s in e.dataForm.id?i["tagNum"]=e.dataForm.tagCount:i["tnum"]=e.dataForm.tagCount,e.checkedObj)e.checkedObj[s]&&(a=[].concat(Object(o["a"])(a),Object(o["a"])(e.checkedObj[s])));if(0==a.length)return e.$message.error(e.$t("authorization.pleaseSelectExtandedAuthorizationinformation"));e.dataForm.id?i["protocols"]=a.join(","):i["protocolIdList"]=a,e.loading=!0,e.$http[e.dataForm.id?"put":"post"](t,i).then((function(t){var a=t.data;if(0!=a.code)return e.loading=!1,e.$message.error(a.msg);e.loading=!1,e.$message.success(a.msg),e.prjList=[],e.dataList=[],e.multipleSelectionAll=[],e.visible=!1,e.$emit("refreshDataList")})).catch((function(t){return e.prjList=[],e.dataList=[],e.multipleSelectionAll=[],e.visible=!1,e.$emit("refreshDataList"),!1}))}))}),1e3,{leading:!0,trailing:!1})}},d=l,m=(a("7472"),a("2877")),c=Object(m["a"])(d,i,r,!1,null,"0c05968e",null);t["default"]=c.exports},7472:function(e,t,a){"use strict";a("be11")},be11:function(e,t,a){}}]);
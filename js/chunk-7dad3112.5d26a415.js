(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7dad3112"],{"27ae":function(e,t,n){(function(n){var r,a;(function(t,n){e.exports=n(t)})("undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof n?n:this,(function(n){"use strict";n=n||{};var o,i=n.Base64,s="2.6.4",c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=function(e){for(var t={},n=0,r=e.length;n<r;n++)t[e.charAt(n)]=n;return t}(c),u=String.fromCharCode,p=function(e){if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?u(192|t>>>6)+u(128|63&t):u(224|t>>>12&15)+u(128|t>>>6&63)+u(128|63&t)}t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return u(240|t>>>18&7)+u(128|t>>>12&63)+u(128|t>>>6&63)+u(128|63&t)},d=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,f=function(e){return e.replace(d,p)},h=function(e){var t=[0,2,1][e.length%3],n=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0),r=[c.charAt(n>>>18),c.charAt(n>>>12&63),t>=2?"=":c.charAt(n>>>6&63),t>=1?"=":c.charAt(63&n)];return r.join("")},g=n.btoa&&"function"==typeof n.btoa?function(e){return n.btoa(e)}:function(e){if(e.match(/[^\x00-\xFF]/))throw new RangeError("The string contains invalid characters.");return e.replace(/[\s\S]{1,3}/g,h)},m=function(e){return g(f(String(e)))},y=function(e){return e.replace(/[+\/]/g,(function(e){return"+"==e?"-":"_"})).replace(/=/g,"")},b=function(e,t){return t?y(m(e)):m(e)},v=function(e){return b(e,!0)};n.Uint8Array&&(o=function(e,t){for(var n="",r=0,a=e.length;r<a;r+=3){var o=e[r],i=e[r+1],s=e[r+2],l=o<<16|i<<8|s;n+=c.charAt(l>>>18)+c.charAt(l>>>12&63)+("undefined"!=typeof i?c.charAt(l>>>6&63):"=")+("undefined"!=typeof s?c.charAt(63&l):"=")}return t?y(n):n});var F,_=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,x=function(e){switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),n=t-65536;return u(55296+(n>>>10))+u(56320+(1023&n));case 3:return u((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return u((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},A=function(e){return e.replace(_,x)},w=function(e){var t=e.length,n=t%4,r=(t>0?l[e.charAt(0)]<<18:0)|(t>1?l[e.charAt(1)]<<12:0)|(t>2?l[e.charAt(2)]<<6:0)|(t>3?l[e.charAt(3)]:0),a=[u(r>>>16),u(r>>>8&255),u(255&r)];return a.length-=[0,0,2,1][n],a.join("")},O=n.atob&&"function"==typeof n.atob?function(e){return n.atob(e)}:function(e){return e.replace(/\S{1,4}/g,w)},$=function(e){return O(String(e).replace(/[^A-Za-z0-9\+\/]/g,""))},k=function(e){return A(O(e))},C=function(e){return String(e).replace(/[-_]/g,(function(e){return"-"==e?"+":"/"})).replace(/[^A-Za-z0-9\+\/]/g,"")},S=function(e){return k(C(e))};n.Uint8Array&&(F=function(e){return Uint8Array.from($(C(e)),(function(e){return e.charCodeAt(0)}))});var B=function(){var e=n.Base64;return n.Base64=i,e};if(n.Base64={VERSION:s,atob:$,btoa:g,fromBase64:S,toBase64:b,utob:f,encode:b,encodeURI:v,btou:A,decode:S,noConflict:B,fromUint8Array:o,toUint8Array:F},"function"===typeof Object.defineProperty){var P=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};n.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",P((function(){return S(this)}))),Object.defineProperty(String.prototype,"toBase64",P((function(e){return b(this,e)}))),Object.defineProperty(String.prototype,"toBase64URI",P((function(){return b(this,!0)})))}}return n["Meteor"]&&(Base64=n.Base64),e.exports?e.exports.Base64=n.Base64:(r=[],a=function(){return n.Base64}.apply(t,r),void 0===a||(e.exports=a)),{Base64:n.Base64}}))}).call(this,n("c8ba"))},"51ed":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.visible,title:e.dataForm.id?e.$t("update"):e.$t("add"),"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.visible=t},opened:e.handleDialogOpenChange}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataForm",attrs:{model:e.dataForm,rules:e.rules,"label-width":"en-US"===e.$i18n.locale?"120px":"80px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dataFormSubmitHandle()},submit:function(e){e.preventDefault()}}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:e.$t("scriptInfo.scriptname"),prop:"pname"}},[t("el-input",{ref:"pname",attrs:{clearable:"",placeholder:e.$t("scriptInfo.scriptname")},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dataFormSubmitHandle()}},model:{value:e.dataForm.pname,callback:function(t){e.$set(e.dataForm,"pname",t)},expression:"dataForm.pname"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:e.$t("scriptInfo.scriptdesc"),prop:"re2"}},[t("el-input",{attrs:{clearable:"",placeholder:e.$t("scriptInfo.scriptdesc")},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dataFormSubmitHandle()}},model:{value:e.dataForm.re2,callback:function(t){e.$set(e.dataForm,"re2",t)},expression:"dataForm.re2"}})],1)],1)],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:function(t){e.visible=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmitHandle()}}},[e._v(e._s(e.$t("confirm")))])],1)],2)},a=[],o=(n("8e6e"),n("ac6a"),n("456d"),n("a481"),n("ade3")),i=n("b047"),s=n.n(i);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u=n("27ae").Base64,p={data:function(){return{loading:!1,visible:!1,dataForm:{id:"",pname:"Python1",content:"",sn:"",re2:""},rules:{pname:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]}}},methods:{init:function(){this.loading=!0,this.visible=!0},handleDialogOpenChange:function(){this.$refs["dataForm"].resetFields(),this.$refs.pname.focus(),this.dataForm.id?this.getInfo():this.loading=!1},getInfo:function(){var e=this;if(!this.$hasPermission("pythonscript:select:permission.do"))return this.loading=!1,void this.$message.warning("暂无Python脚本运算信息查询权限, 请联系管理员");this.$http.get("/pythonscript/select.do",{params:{id:this.dataForm.id}}).then((function(t){var n=t.data;if(0!==n.code)return e.loading=!1,e.$message.error(n.data||n.msg);e.dataForm=l(l({},e.dataForm),n.data),e.loading=!1})).catch((function(t){return e.loading=!1,!1}))},dataFormSubmitHandle:s()((function(){var e=this;this.$hasSessionStorageGwsn()?this.$refs["dataForm"].validate((function(t){if(!t)return!1;e.dataForm.sn=sessionStorage.getItem("gwsn");var n=e.dataForm.id?"/pythonscript/update.do":"/pythonscript/insert.do";if(e.dataForm.id){if(!e.$hasPermission("pythonscript:update:permission.do"))return void e.$message.warning("暂无Python脚本运算修改权限, 请联系管理员")}else{if(!e.$hasPermission("pythonscript:insert:permission.do"))return void e.$message.warning("暂无Python脚本运算新增权限, 请联系管理员");e.dataForm.content=u.encode('import c4py\nimport signal\nimport ptvsd\n\n# 声明全局变量\napp_exit_signal = 0\n\n# 系统信号处理函数\ndef handle_sigterm(signum, frame):\n    global app_exit_signal\n    app_exit_signal = signum\n\nif __name__ == \'__main__\':\n    # Enable the debugger to attach to the process\n    ptvsd.enable_attach(address=(\'0.0.0.0\', 5678))\n    # Pause the execution until a debugger is attached\n    ptvsd.wait_for_attach()\n\n    # 注册信号处理函数\n    signal.signal(signal.SIGTERM, handle_sigterm)\n    signal.signal(signal.SIGUSR1, handle_sigterm)\n    # 导入c4py库\n    c4py.py_load_so()\n    c4py.global_init()\n\n    while True:\n        c4py.msleep(1000)\n\n        c4py.clog_info(b"hello from python!")\n        print("hello from python!")\n\n        if app_exit_signal != 0:\n        # 判断是否接收到kill信号，如果是，则退出循环\n        # killall python3时，app_exit_signal=15\n        # killall -9 python3时，python3进程会被强制退出\n        # killall -10 python3时，app_exit_signal=10；！！！注意：在重启应用、重启网关时，python进程会收到该消息\n            print("app exit signal: [{}]".format(app_exit_signal))\n            break\n    # 退出程序\n    c4py.global_release()')}e.$http[e.dataForm.id?"put":"post"](n,[e.dataForm]).then((function(t){var n=t.data;if(0!==n.code)return e.$message.error(n.data||n.msg);e.$message({message:e.$t("prompt.success"),type:"success",duration:500,onClose:function(){e.visible=!1,e.$emit("refreshDataList")}})})).catch((function(e){return!1}))})):this.$message({showClose:!1,message:"未获取到网关编号",type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1})}},d=p,f=n("2877"),h=Object(f["a"])(d,r,a,!1,null,null,null);t["default"]=h.exports}}]);
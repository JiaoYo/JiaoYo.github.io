(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-31c4dee4"],{"0e1a":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;return t("section",[t("div",{attrs:{id:"deviceQueryContainer"}},[t("el-form",{attrs:{inline:!0,model:e.dataForm},nativeOn:{submit:function(e){e.preventDefault()},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.querySearch()}}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.channel")}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",filterable:"",clearable:"",placeholder:e.$t("deviceInfo.pleaseSelect")},on:{change:e.querySearch},model:{value:e.dataForm.chlname,callback:function(t){e.$set(e.dataForm,"chlname",t)},expression:"dataForm.chlname"}},e._l(e.chlList,(function(i,a){return t("el-option",{key:a,attrs:{label:i.label,value:i.chlId}},[t("div",{staticStyle:{display:"flex","justify-content":"space-between",padding:"0 10px","align-items":"center","max-width":"577px"}},[t("span",{style:{display:"inline-block",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis",minWidth:"160px"},attrs:{title:i.label}},[e._v(e._s(i.label))]),t("span",{staticStyle:{color:"#8492a6","font-size":"13px",display:"inline-block","margin-left":"20px","text-align":"right",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis","max-width":"200px"},attrs:{title:i.chlcomment}},[e._v("\n                                "+e._s(i.chlcomment)+"\n                            ")])])])})),1)],1),t("el-form-item",{attrs:{label:e.$t("deviceInfo.devname")}},[t("el-input",{attrs:{size:"small",placeholder:e.$t("pleaseEnter")+e.$t("deviceInfo.devname"),clearable:""},on:{clear:e.querySearch},model:{value:e.dataForm.devname,callback:function(t){e.$set(e.dataForm,"devname",t)},expression:"dataForm.devname"}})],1),e.$hasPermission("deviceinfo:selectdevlist:permission.do")?t("el-form-item",[t("el-button",{attrs:{size:"small",icon:"el-icon-search"},on:{click:function(t){return e.querySearch()}}},[e._v(e._s(e.$t("query")))])],1):e._e(),e.$hasPermission("deviceinfo:insert:permission.do")&&e.isShowSetting?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.handleAddOrUpdate(!0)}}},[e._v("\n                    "+e._s(e.$t("add"))+"\n                ")])],1):e._e(),(e.$hasPermission("deviceinfo:updateNamesOrDescByIds:permission.do")||e.$hasPermission("deviceinfo:updateAddrs:permission.do")||e.$hasPermission("deviceinfo:updateTagsAddr:permission.do")||e.$hasPermission("deviceinfo:updateTagsK:permission.do")||e.$hasPermission("deviceinfo:DevBatchUpdate:permission.do")||e.$hasPermission("deviceinfo:updateVal:permission.do"))&&e.isShowSetting?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-edit",disabled:0===e.devIds.length||0===e.dataList.length},on:{click:function(t){return e.editAll()}}},[e._v("\n                    "+e._s(e.$t("deviceInfo.editMultiple"))+"\n                ")])],1):e._e(),e.$hasPermission("device:delete:permission.do")&&e.isShowSetting?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete",disabled:0===e.devIds.length||0===e.dataList.length},on:{click:function(t){return e.deleteHandle()}}},[e._v("\n                    "+e._s(e.$t("deleteBatch"))+"\n                ")])],1):e._e(),e.$hasPermission("deviceinfo:exports:permission.do")&&e.isShowSetting?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-download",disabled:0===e.devIds.length||0===e.dataList.length},on:{click:function(t){return e.exportHandle()}}},[e._v("\n                    "+e._s(e.$t("export"))+"\n                ")])],1):e._e(),e.$hasPermission("channelinfo:copyDev:permission.do")&&!e.showSpecialDesign&&e.isShowSetting?t("el-form-item",[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("deviceInfo.pleaseSelectDeviceDataSourceToCopyFrom"),placement:"top"}},[t("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-copy-document"},on:{click:function(t){return e.handleCopyDevice()}}},[e._v("\n                        "+e._s(e.$t("copy"))+"\n                    ")])],1)],1):e._e(),e.$hasPermission("deviceinfo:getYaoExcelInsert:permission.do")&&!e.showSpecialDesign&&e.isShowSetting?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-upload",disabled:0==e.rapidChlList.length},on:{click:e.handleRapidImport}},[e._v("\n                    "+e._s(e.$t("deviceInfo.rapidImport"))+"\n                ")])],1):e._e(),e.$hasPermission("channelinfo:updateTagDevId2:permission.do")&&!e.showSpecialDesign&&e.isShowSetting?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-connection"},on:{click:e.handleDevicesToOtherDevice}},[e._v("\n                    "+e._s(e.$t("deviceInfo.deviceMerge"))+"\n                ")])],1):e._e(),e.$hasPermission("channelinfo:updateDevicesChlId:permission.do")&&!e.showSpecialDesign&&e.isShowSetting?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-bangzhu"},on:{click:e.handleDevicesToChannelChange}},[e._v("\n                    "+e._s(e.$t("deviceInfo.deviceMovesToChannel"))+"\n                ")])],1):e._e(),e.$hasPermission("deviceinfo:selectdevlist:permission.do")?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"success"},on:{click:e.getDataList}},[t("i",{staticClass:"el-icon-refresh"})])],1):e._e(),e.$hasPermission("deviceinfo:DevicesBywsnAndPtypeSelect:permission.do")&&!e.showSpecialDesign?t("el-form-item",[t("el-checkbox",{attrs:{size:"small"},on:{change:e.allCheckEvent},model:{value:e.allCheck,callback:function(t){e.allCheck=t},expression:"allCheck"}},[e._v("\n                    "+e._s(e.$t("deviceInfo.continueCheckedAll"))+"\n                ")])],1):e._e()],1)],1),e.scrollTableHeight?t("div",[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dataListLoading,expression:"dataListLoading"}],ref:"recordTable",staticStyle:{width:"100%"},attrs:{size:"mini",data:e.dataList,border:"","max-height":e.scrollTableHeight,"row-key":e.getRowKey,"default-sort":{prop:"id",order:"ascending"}},on:{"select-all":e.selectAll,"selection-change":e.dataListSelectionHandle,"sort-change":e.sortChange}},[t("el-table-column",{key:1,attrs:{type:"selection","header-align":"center",align:"center",width:"50","reserve-selection":!0,selectable:e.checkSelectable,fixed:""}}),t("el-table-column",{key:2,attrs:{prop:"id",label:e.$t("deviceInfo.deviceId"),"header-align":"center",align:"center",sortable:"","show-overflow-tooltip":!0,width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(t.row.devid)+"\n                ")]}}],null,!1,1005223655)}),t("el-table-column",{key:3,attrs:{prop:"devname",label:e.$t("deviceInfo.devname"),"header-align":"center",align:"center","show-overflow-tooltip":!0}}),t("el-table-column",{key:4,attrs:{prop:"channelInfoEntityList[0].chlname",label:e.$t("deviceInfo.channel"),"header-align":"center",align:"center","show-overflow-tooltip":!0}}),t("el-table-column",{key:5,attrs:{prop:"devcomment",label:e.$t("deviceInfo.devcomment"),"header-align":"center",align:"center","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.devcomment||e.$t("deviceInfo.no")))])]}}],null,!1,4040148778)}),t("el-table-column",{key:6,attrs:{prop:"devcommaddr",label:e.$t("deviceInfo.devicecommaddr"),"header-align":"center",align:"center",sortable:"custom"}}),t("el-table-column",{key:7,attrs:{prop:"devpublicaddr",label:e.$t("deviceInfo.devicepublicaddr"),"header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.devpublicaddr||e.$t("deviceInfo.no")))])]}}],null,!1,1592435915)}),e.showSpecialDesign?e._e():t("el-table-column",{key:8,attrs:{prop:"devmanu",label:e.$t("deviceInfo.devmanu"),"header-align":"center",align:"center",formatter:e.formatterDevManu,"show-overflow-tooltip":!0}}),e.showSpecialDesign?e._e():t("el-table-column",{key:9,attrs:{prop:"devmodel",label:e.$t("deviceInfo.devmodel"),"header-align":"center",align:"center",formatter:e.formatterDevModel,"show-overflow-tooltip":!0}}),t("el-table-column",{key:10,attrs:{prop:"valid",label:e.$t("valid"),"header-align":"center",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-tag",{attrs:{size:"small",type:2==i.row.valid?"danger":"success"}},[e._v("\n                        "+e._s(2==i.row.valid?e.$t("no"):e.$t("yes"))+"\n                    ")])]}}],null,!1,243820786)}),e.showSpecialDesign?t("el-table-column",{key:11,attrs:{prop:"reserve0",label:e.$t("deviceInfo.protocolEnergyCode"),"header-align":"center",align:"center",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(t.row.devmanu)+"\n                ")]}}],null,!1,1818433917)}):e._e(),e.showSpecialDesign?t("el-table-column",{key:12,attrs:{prop:"reserve1",label:e.$t("deviceInfo.comPort"),"header-align":"center",align:"center",width:"100"}}):e._e(),t("el-table-column",{attrs:{label:e.$t("handle"),fixed:"right","header-align":"center",align:"center",width:"180"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.collect(i.$index,i.row)}}},[e._v(e._s(e.$t("deviceInfo.tagManage"))+" ")]),e.$hasPermission("deviceinfo:update:permission.do")&&e.isShowSetting?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleAddOrUpdate(!1,i.$index,i.row)}}},[e._v(e._s(e.$t("update")))]):e._e(),e.$hasPermission("device:delete:permission.do")&&e.isShowSetting?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.deleteHandle(i.row.id)}}},[e._v(e._s(e.$t("delete")))]):e._e()]}}],null,!1,1651989911)})],1),t("el-pagination",{staticStyle:{"text-align":"right","margin-top":"20px"},attrs:{"current-page":e.page,"page-sizes":[20,50,100,200],"page-size":e.limit,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"size-change":e.pageSizeChangeHandle,"current-change":e.pageCurrentChangeHandle}})],1):e._e(),t("el-dialog",{attrs:{title:e.$t("deviceInfo.editMultiple"),"close-on-click-modal":!1,"close-on-press-escape":!1,visible:e.editAllVisible},on:{"update:visible":function(t){e.editAllVisible=t}}},[t("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.rules,"label-width":(e.$i18n.locale,"120px")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dataFormSubmitHandle()}}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.editType"),prop:"type"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("deviceInfo.pleaseSelect")},on:{change:e.selectChanged},model:{value:e.editForm.type,callback:function(t){e.$set(e.editForm,"type",t)},expression:"editForm.type"}},e._l(e.editTypeLists,(function(e,i){return t("el-option",{key:i,attrs:{label:e.label,value:e.value}})})),1)],1)],1),"devname"==e.editForm.type||"devcomment"===e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.prefix"),prop:"pre"}},[t("el-input",{attrs:{placeholder:e.$t("deviceInfo.pleaseEnterPrefix")},model:{value:e.editForm.pre,callback:function(t){e.$set(e.editForm,"pre",t)},expression:"editForm.pre"}})],1)],1):e._e(),"devname"==e.editForm.type||"devcomment"===e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.startValue"),prop:"fex"}},[t("el-input",{attrs:{placeholder:e.$t("deviceInfo.pleaseEnterStartingValue")},model:{value:e.editForm.fex,callback:function(t){e.$set(e.editForm,"fex",e._n(t))},expression:"editForm.fex"}})],1)],1):e._e(),"devmanu"==e.editForm.type||"devmodel"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.editValue"),prop:"changeValue",rules:"devmanu"===this.editForm.type||"devmodel"===this.editForm.type?e.rules.changeValue:[{required:!1,message:e.$t("validate.required"),trigger:"change"}]}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",placeholder:e.$t("deviceInfo.pleaseSelect")},model:{value:e.editForm.changeValue,callback:function(t){e.$set(e.editForm,"changeValue",t)},expression:"editForm.changeValue"}},e._l(e.changeList,(function(e,i){return t("el-option",{key:i,attrs:{label:e.label,value:e.value}})})),1)],1)],1):e._e(),"devcommaddr"==e.editForm.type||"devpublicaddr"===e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.startValue"),prop:"startValue",rules:"devcommaddr"===this.editForm.type||"devpublicaddr"===this.editForm.type?e.rules.startValue:[{required:!1,message:e.$t("validate.required"),trigger:"change"}]}},[t("el-input",{attrs:{placeholder:e.$t("deviceInfo.startValue")},model:{value:e.editForm.startValue,callback:function(t){e.$set(e.editForm,"startValue",t)},expression:"editForm.startValue"}})],1)],1):e._e(),"tagObjaddr"==e.editForm.type||"tagK"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.alarmtype"),prop:"tagType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",placeholder:e.$t("deviceInfo.pleaseSelect")},model:{value:e.editForm.tagType,callback:function(t){e.$set(e.editForm,"tagType",t)},expression:"editForm.tagType"}},e._l(e.tagTypeList,(function(e,i){return t("el-option",{key:i,attrs:{label:e.label,value:e.value}})})),1)],1)],1):e._e(),"reserve0"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.protocolEnergyCode"),prop:"reserve0",rules:"reserve0"===this.editForm.type?e.rules.reserve0:[{required:!1,message:e.$t("validate.required"),trigger:"change"}]}},[t("el-input",{attrs:{placeholder:e.$t("deviceInfo.pleaseEnterTheProtocolEnergyCode"),maxlength:64,clearable:""},model:{value:e.editForm.reserve0,callback:function(t){e.$set(e.editForm,"reserve0",t)},expression:"editForm.reserve0"}})],1)],1):e._e(),"reserve1"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.comPort"),prop:"reserve1",rules:"reserve1"===this.editForm.type?e.rules.reserve1:[{required:!1,message:e.$t("validate.required"),trigger:"change"}]}},[t("el-input",{attrs:{placeholder:e.$t("deviceInfo.pleaseEnterComPort"),clearable:"",oninput:"value=value.replace(/^(0+)|[^\\d]+/g, '')",maxlength:2},model:{value:e.editForm.reserve1,callback:function(t){e.$set(e.editForm,"reserve1","string"===typeof t?t.trim():t)},expression:"editForm.reserve1"}})],1)],1):e._e(),"valid"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.equipmentAvailability"),prop:"changeValue"}},[t("el-radio-group",{model:{value:e.editForm.changeValue,callback:function(t){e.$set(e.editForm,"changeValue",t)},expression:"editForm.changeValue"}},[t("el-radio",{attrs:{label:0}},[e._v(e._s(e.$t("yes")))]),t("el-radio",{attrs:{label:2}},[e._v(e._s(e.$t("no")))])],1)],1)],1):e._e()],1),t("el-row",["devcommaddr"==e.editForm.type||"devpublicaddr"===e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.step"),prop:"step",rules:"devcommaddr"===this.editForm.type||"devpublicaddr"===this.editForm.type?e.rules.step:[{required:!1,message:e.$t("validate.required"),trigger:"change"}]}},[t("el-input",{attrs:{placeholder:e.$t("deviceInfo.step")},model:{value:e.editForm.step,callback:function(t){e.$set(e.editForm,"step",t)},expression:"editForm.step"}})],1)],1):e._e(),"tagObjaddr"==e.editForm.type||"tagK"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.collectType"),prop:"collectTypec"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",placeholder:e.$t("deviceInfo.pleaseSelect")},model:{value:e.editForm.collectTypec,callback:function(t){e.$set(e.editForm,"collectTypec",t)},expression:"editForm.collectTypec"}},e._l(e.collectTypecList,(function(e,i){return t("el-option",{key:i,attrs:{label:e.description,value:e.FuncCode}})})),1)],1)],1):e._e(),"tagObjaddr"==e.editForm.type||"tagK"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.startValue"),prop:"tagObjaddrOrKStartValue"}},[t("el-input",{attrs:{placeholder:e.$t("deviceInfo.pleaseEnterStartingValue")},model:{value:e.editForm.tagObjaddrOrKStartValue,callback:function(t){e.$set(e.editForm,"tagObjaddrOrKStartValue",t)},expression:"editForm.tagObjaddrOrKStartValue"}})],1)],1):e._e(),"tagObjaddr"==e.editForm.type||"tagK"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.step"),prop:"tagObjaddrOrKStep"}},[t("el-input",{attrs:{placeholder:e.$t("deviceInfo.pleaseEnterStepSize"),type:"number"},model:{value:e.editForm.tagObjaddrOrKStep,callback:function(t){e.$set(e.editForm,"tagObjaddrOrKStep",t)},expression:"editForm.tagObjaddrOrKStep"}})],1)],1):e._e()],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:function(t){e.editAllVisible=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmitHandle()}}},[e._v(e._s(e.$t("confirm")))])],1)],2),t("el-dialog",{attrs:{title:e.$t("deviceInfo.rapidImport"),"close-on-click-modal":!1,"close-on-press-escape":!1,visible:e.rapidimportVisible,"before-close":e.handleRapidCancel},on:{"update:visible":function(t){e.rapidimportVisible=t}}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.rapidLoading,expression:"rapidLoading"}],ref:"rapidimportForm",attrs:{model:e.rapidimportForm,rules:e.rapidimportrules,"label-width":(e.$i18n.locale,"120px")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.rapidimportFormSubmitHandle()}}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.channel"),prop:"rapidchlId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("deviceInfo.pleaseSelect")},on:{change:e.handleRapidchlId},model:{value:e.rapidimportForm.rapidchlId,callback:function(t){e.$set(e.rapidimportForm,"rapidchlId",t)},expression:"rapidimportForm.rapidchlId"}},e._l(e.rapidChlList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.chlId}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.devnamePrepend"),prop:"devnamePrefix"}},[t("el-input",{attrs:{type:"text",placeholder:e.$t("deviceInfo.devnamePrepend")},model:{value:e.rapidimportForm.devnamePrefix,callback:function(t){e.$set(e.rapidimportForm,"devnamePrefix",t)},expression:"rapidimportForm.devnamePrefix"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.devmanu"),prop:"rapiddevmanu"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("deviceInfo.pleaseSelect")},model:{value:e.rapidimportForm.rapiddevmanu,callback:function(t){e.$set(e.rapidimportForm,"rapiddevmanu",t)},expression:"rapidimportForm.rapiddevmanu"}},e._l(e.rapiddevManuList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.devmodel"),prop:"rapiddevmodel"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("deviceInfo.pleaseSelect")},on:{change:e.handleModelAddress},model:{value:e.rapidimportForm.rapiddevmodel,callback:function(t){e.$set(e.rapidimportForm,"rapiddevmodel",t)},expression:"rapidimportForm.rapiddevmodel"}},e._l(e.rapiddevModelList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",[t("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:"","on-change":e.handleChange,"http-request":e.uploadSectionFile,"on-remove":e.handleRemove,"file-list":e.fileList}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text",domProps:{innerHTML:e._s(e.$t("upload.text"))}})])],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.downLoadTemplate")}},[e.modeldownLoadAddress?t("div",[t("div",{staticStyle:{width:"80%",display:"inline-flex"}},[t("div",{staticStyle:{width:"100%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},attrs:{title:e.modeldownLoadAddress}},[e._v("\n                                    "+e._s(e.modeldownLoadAddress)+"\n                                ")])]),t("el-button",{staticStyle:{width:"20%"},attrs:{type:"text"},on:{click:e.handleModelDownload}},[e._v("\n                                "+e._s(e.$t("deviceInfo.downLoad"))+"\n                            ")])],1):t("div",[e._v(e._s(e.$t("deviceInfo.noTemplate")))])])],1)],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:e.handleRapidCancel}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.rapidimportFormSubmitHandle()}}},[e._v(e._s(e.$t("confirm")))])],1)],2),e.addOrUpdateVisible?t("add-or-update",{ref:"addOrUpdate",attrs:{queryParams:e.queryParams},on:{refreshDataList:e.getDataList}}):e._e(),t("el-dialog",{attrs:{visible:e.copyDeviceVisible,title:e.$t("deviceInfo.copyDevice"),"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":e.handleCopyDeviceClose},on:{"update:visible":function(t){e.copyDeviceVisible=t}}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.copyDeviceFormloading,expression:"copyDeviceFormloading"}],ref:"copyDeviceForm",attrs:{model:e.copyDeviceForm,rules:e.copyDeviceRules,"label-width":(e.$i18n.locale,"160px")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.copyDeviceFormSubmitHandle()}}},[t("el-row",[t("el-col",{attrs:{xl:12,md:12,sm:24}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.devicenamePrefixAfterCopying"),prop:"devname"}},[t("el-input",{ref:"devname",attrs:{placeholder:e.$t("deviceInfo.pleaseEnterDevnamePrefix"),maxlength:48},model:{value:e.copyDeviceForm.devname,callback:function(t){e.$set(e.copyDeviceForm,"devname","string"===typeof t?t.trim():t)},expression:"copyDeviceForm.devname"}})],1)],1),t("el-col",{attrs:{xl:12,md:12,sm:24}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.copyCount"),prop:"copyCount"}},[t("el-input",{attrs:{placeholder:e.$t("deviceInfo.pleaseEnterCopycount"),onKeypress:"return (/[\\d]/.test(String.fromCharCode(event.keyCode)))",onpaste:"return (/[\\d]/.test(String.fromCharCode(event.keyCode)))"},model:{value:e.copyDeviceForm.copyCount,callback:function(t){e.$set(e.copyDeviceForm,"copyCount",t)},expression:"copyDeviceForm.copyCount"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{xl:12,md:12,sm:24}},[t("el-form-item",{attrs:{label:e.$t("configuration.intelligentMatchingOfMeasurementPointNamePrefix"),prop:"flag"}},[t("el-radio-group",{model:{value:e.copyDeviceForm.flag,callback:function(t){e.$set(e.copyDeviceForm,"flag",t)},expression:"copyDeviceForm.flag"}},[t("el-radio",{attrs:{label:0}},[e._v(e._s(e.$t("yes")))]),t("el-radio",{attrs:{label:1}},[e._v(e._s(e.$t("no")))])],1)],1)],1)],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:e.handleCopyDeviceClose}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.copyDeviceFormSubmitHandle()}}},[e._v(e._s(e.$t("confirm")))])],1)],2),t("el-dialog",{attrs:{visible:e.mergeDevicesToChannelVisible,title:e.$t("deviceInfo.deviceMovesToChannel"),"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":e.handleMergeDeviceIdsToChannelClose},on:{"update:visible":function(t){e.mergeDevicesToChannelVisible=t}}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.mergeDevicesToChannelFormloading,expression:"mergeDevicesToChannelFormloading"}],ref:"mergeDevicesToChannelForm",attrs:{model:e.mergeDevicesToChannelForm,rules:e.mergeDevicesToChannelRules,"label-width":(e.$i18n.locale,"120px")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleMergeDeviceIdsToChannelSubmit()}}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.targetChannel"),prop:"chlId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("select")},on:{change:e.hanleMergeChlIdChanage},model:{value:e.mergeDevicesToChannelForm.chlId,callback:function(t){e.$set(e.mergeDevicesToChannelForm,"chlId",t)},expression:"mergeDevicesToChannelForm.chlId"}},e._l(e.mergeTargetChannelList,(function(e){return t("el-option",{key:e.chlID,attrs:{label:e.chlName,value:e.chlID}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.waitMoveDevices"),prop:"deviceIds"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"","collapse-tags":"",filterable:"",placeholder:e.$t("select")},on:{change:e.handleMergeDeviceChange},model:{value:e.mergeDevicesToChannelForm.deviceIds,callback:function(t){e.$set(e.mergeDevicesToChannelForm,"deviceIds",t)},expression:"mergeDevicesToChannelForm.deviceIds"}},[e.mergeDeviceList.length>0?t("el-option",{attrs:{label:e.$t("all"),value:"all"},nativeOn:{click:function(t){return e.selectAllMergeDevcie.apply(null,arguments)}}}):e._e(),e._l(e.mergeDeviceList,(function(i){return t("el-option",{key:i.devID,attrs:{label:i.devName,value:i.devID}},[t("span",{staticStyle:{width:"50%",display:"inline-block","text-align":"left",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:i.devName}},[e._v(e._s(i.devName))]),t("span",{staticStyle:{color:"#8492a6","font-size":"13px",display:"inline-block","margin-left":"2%",width:"48%","text-align":"right",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:i.devComment}},[e._v(e._s(i.devComment))])])}))],2)],1)],1)],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:e.handleMergeDeviceIdsToChannelClose}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleMergeDeviceIdsToChannelSubmit()}}},[e._v(e._s(e.$t("confirm")))])],1)],2),t("el-dialog",{attrs:{visible:e.mergeDevicesToOtherDeviceVisible,title:e.$t("deviceInfo.deviceMerge"),"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":e.handleMergeDeviceIdsToOtherDeviceClose},on:{"update:visible":function(t){e.mergeDevicesToOtherDeviceVisible=t}}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.mergeDevicesToOtherDeviceFormloading,expression:"mergeDevicesToOtherDeviceFormloading"}],ref:"mergeDevicesToOtherDeviceForm",attrs:{model:e.mergeDevicesToOtherDeviceForm,rules:e.mergeDevicesToOtherDeviceRules,"label-width":(e.$i18n.locale,"120px")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleMergeDeviceIdsToOtherDeviceSubmit()}}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.targetDevice"),prop:"devId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("deviceInfo.pleaseSelectTargetDevice")},on:{change:e.hanleMergeTargetDevicesChanage},model:{value:e.mergeDevicesToOtherDeviceForm.devId,callback:function(t){e.$set(e.mergeDevicesToOtherDeviceForm,"devId",t)},expression:"mergeDevicesToOtherDeviceForm.devId"}},e._l(e.mergeTargetDeviceList,(function(i){return t("el-option",{key:i.devID,attrs:{label:i.devName,value:i.devID}},[t("span",{staticStyle:{width:"50%",display:"inline-block","text-align":"left",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:i.devName}},[e._v("\n                                    "+e._s(i.devName))]),t("span",{staticStyle:{color:"#8492a6","font-size":"13px",display:"inline-block","margin-left":"2%",width:"48%","text-align":"right",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:i.devComment}},[e._v(e._s(i.devComment))])])})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.waitMergeDevices"),prop:"devIds"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"","collapse-tags":"",filterable:"",placeholder:e.$t("deviceInfo.pleaseSelectWaitMergeDevices")},on:{change:e.handleMergePrepareDevicesChange},model:{value:e.mergeDevicesToOtherDeviceForm.devIds,callback:function(t){e.$set(e.mergeDevicesToOtherDeviceForm,"devIds",t)},expression:"mergeDevicesToOtherDeviceForm.devIds"}},[e.mergePrepareDeviceList.length>0?t("el-option",{attrs:{label:e.$t("all"),value:"all"},nativeOn:{click:function(t){return e.selectAllPrepareDevcie.apply(null,arguments)}}}):e._e(),e._l(e.mergePrepareDeviceList,(function(i){return t("el-option",{key:i.devID,attrs:{label:i.devName,value:i.devID}},[t("span",{staticStyle:{width:"50%",display:"inline-block","text-align":"left",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:i.devName}},[e._v(e._s(i.devName))]),t("span",{staticStyle:{color:"#8492a6","font-size":"13px",display:"inline-block","margin-left":"2%",width:"48%","text-align":"right",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:i.devComment}},[e._v(e._s(i.devComment))])])}))],2)],1)],1)],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:e.handleMergeDeviceIdsToOtherDeviceClose}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleMergeDeviceIdsToOtherDeviceSubmit()}}},[e._v(e._s(e.$t("confirm"))+"\n            ")])],1)],2)],1)},n=[],r=(i("20d6"),i("6762"),i("2fdb"),i("c5f6"),i("55dd"),i("7f7f"),i("ac6a"),i("7514"),i("a481"),i("4328")),s=i.n(r),o=i("9dce"),l=i("b047"),d=i.n(l),c=i("e1a5"),h=i("bde1"),m=(i("2ef0"),{name:"deviceinfo",mixins:[c["a"]],data:function(){var e=this;return{isShowSetting:!1,showSpecialDesign:!1,superAdmin:0,page:1,limit:20,total:0,devmodelIds:[],sname:"id",sort:"asc",queryParams:{},dataForm:{chlname:"",devname:""},rapidimportForm:{rapidchlId:"",rapidchlname:"",devnamePrefix:"",rapiddevmanu:"",rapiddevmodel:""},rapidLoading:!1,fileList:[],rapiddevManuList:[],rapiddevModelList:[],rapidChlList:[],allCheck:!1,editAllVisible:!1,deleteIds:[],rapidimportVisible:!1,currentPageCheccked:!1,multipleSelectionDevIdAndChlIds:[],multipleSameChlIdFlag:!0,multipleSelectionDevIds:[],multipleSelectionAll:[],changeList:[],devModelList:[],chlList:[],dataList:[],devIds:[],platForm:[],platFormDevList:[],addDisabled:!1,dataListLoading:!1,exportIds:null,scrollTableHeight:0,mixinViewModuleOptions:{exportURL:"/info/deviceinfo/exports"},editForm:{type:"devcommaddr",startValue:0,step:1,changeValue:"",pre:"",fex:"",tagType:"",collectTypec:null,tagObjaddrOrKStartValue:0,tagObjaddrOrKStep:1,reserve0:"",reserve1:""},editTypeLists:[{label:this.$t("deviceInfo.devname"),value:"devname"},{label:this.$t("deviceInfo.devcomment"),value:"devcomment"},{label:this.$t("deviceInfo.devcommaddr"),value:"devcommaddr"},{label:this.$t("deviceInfo.devpublicaddr"),value:"devpublicaddr"},{label:this.$t("deviceInfo.devmanu"),value:"devmanu"},{label:this.$t("deviceInfo.devmodel"),value:"devmodel"},{label:this.$t("configuration.collectMeasurementPointRegisterAddress"),value:"tagObjaddr"},{label:this.$t("configuration.collectMeasurementPointCoefficientK"),value:"tagK"},{label:this.$t("valid"),value:"valid"}],tagTypeList:[{label:this.$t("all"),value:""},{label:this.$t("attribute.visualValue"),value:0},{label:this.$t("attribute.switchValue"),value:1}],collectTypecList:[],modeldownLoadAddress:"https://pictures.linkqi.cn/xlsx/%E9%80%86%E5%8F%98%E5%99%A8.xlsx",rapidimportrules:{rapidchlId:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],devnamePrefix:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],rapiddevmanu:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],rapiddevmodel:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]},rules:{type:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],fex:[{pattern:/^[0-9]\d*/,message:this.$t("deviceInfo.enterInt")}],startValue:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],step:[{required:!0,message:this.$t("validate.required"),trigger:"change"},{validator:function(t,i,a){if(i){var n=/^[-]?[0-9]\d*$/;n.test(i)?a():a(new Error(e.$t("deviceInfo.enterInt")))}},trigger:"change"}],changeValue:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],reserve0:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],reserve1:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]},copyList:[],copyDeviceVisible:!1,copyDeviceFormloading:!1,copyDeviceForm:{devPreName:"",copyCount:1,flag:0},copyDeviceRules:{copyCount:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]},mergeDevicesToChannelVisible:!1,mergeDevicesToChannelFormloading:!1,mergeDevicesToChannelForm:{chlId:"",deviceIds:[]},mergeDeviceList:[],mergeTargetChannelList:[],mergeDevicesToChannelRules:{chlId:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],deviceIds:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]},mergeTargetDeviceList:[],mergePrepareDeviceList:[],mergeDevicesToOtherDeviceFormloading:!1,mergeDevicesToOtherDeviceVisible:!1,mergeDevicesToOtherDeviceForm:{devId:"",devIds:[]},mergeDevicesToOtherDeviceRules:{devId:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],devIds:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]}}},components:{AddOrUpdate:h["default"]},methods:{handleRapidImport:function(){var e=this;if(this.$hasSessionStorageGwsn()){var t=!1;if(this.rapidimportForm.rapidchlId)for(var i=0;i<this.rapidChlList.length;i++){var a=this.rapidChlList[i];if(a.chlId==this.rapidimportForm.rapidchlId){t=!0;break}}else t=!0;this.$nextTick((function(){t||(e.$message.info(e.$t("configuration.theChannelYouHaveSelectedDoesNotMatchTheExistingChannel")),e.rapidimportForm.rapidchlId=""),setTimeout((function(){e.rapidimportVisible=!0,e.fileList=[],e.handleRapidchlId(),e.getrapiddevModelList()}),t?0:1e3)}))}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},handleRapidchlId:function(){var e=this;this.rapidimportForm.rapidchlname=this.rapidimportForm.rapidchlId?this.rapidChlList.find((function(t){return e.rapidimportForm.rapidchlId==t.chlId})).label:""},getrapiddevModelList:function(){var e=this,t=[],i={};e.rapiddevManuList=[],e.rapiddevModelList=[],e.$hasPermission("devtypeinfo:selectlistAll:permission.do")?e.$http.post("/info/devtypeinfo/listAll",s.a.stringify({devPlatform:1})).then((function(a){var n=a.data,r=n.data;if(r.length>0){for(var s=0;s<r.length;s++){var o={label:r[s].devDesc,value:r[s].devIndex};0!=o.value&&e.rapiddevModelList.push(o);var l=r[s].devPlatform;i[l]||(t.push(r[s]),i[l]=!0)}t.forEach((function(t){var i={label:t.platformName,value:t.devPlatform};e.rapiddevManuList.push(i)})),e.rapiddevManuList.length>0&&(e.rapidimportForm.rapiddevmanu=e.rapiddevManuList[0].value),e.rapiddevModelList.length>0&&(e.rapidimportForm.rapiddevmodel=e.rapiddevModelList[0].value)}})).catch((function(e){return!1})):e.$message.warning("暂无设备型号查询权限, 请联系管理员")},handleModelAddress:function(e){this.modeldownLoadAddress=1==e?"https://pictures.linkqi.cn/xlsx/%E9%80%86%E5%8F%98%E5%99%A8.xlsx":2==e?"https://pictures.linkqi.cn/xlsx/%E6%B1%87%E6%B5%81%E7%AE%B1.xlsx":3==e?"https://pictures.linkqi.cn/xlsx/%E8%AE%A1%E9%87%8F%E7%94%B5%E8%A1%A8.xlsx":4==e?"https://pictures.linkqi.cn/xlsx/%E7%8E%AF%E5%A2%83%E7%9B%91%E6%B5%8B%E4%BB%AA.xlsx":5==e?"":6==e?"https://pictures.linkqi.cn/xlsx/%E4%BF%9D%E6%8A%A4%E6%B5%8B%E6%8E%A7.xlsx":10==e?"https://pictures.linkqi.cn/xlsx/%E7%9B%B4%E6%B5%81%E5%B1%8F.xlsx":11==e?"https://pictures.linkqi.cn/xlsx/%E6%B8%A9%E6%8E%A7%E4%BB%AA.xlsx":12==e?"https://pictures.linkqi.cn/xlsx/%E7%9B%B8%E5%8F%98.xlsx":13==e?"https://pictures.linkqi.cn/xlsx/%E6%97%A0%E5%8A%9F%E8%A1%A5%E5%81%BFSVG.xlsx":14==e?"https://pictures.linkqi.cn/xlsx/%E7%94%B5%E8%A1%A8%E6%95%B0%E6%8D%AE%28%E4%BA%8C%E6%AC%A1%E4%BE%A7%29.xlsx\n":15==e?"https://pictures.linkqi.cn/xlsx/PCS.xlsx":16==e?"https://pictures.linkqi.cn/xlsx/%E7%94%B5%E6%B1%A0%E5%A0%86%28BMS%E6%80%BB%29.xlsx":17==e?"https://pictures.linkqi.cn/xlsx/%E7%94%B5%E6%B1%A0%E7%B0%87%28BMS%29.xlsx":21==e?"https://pictures.linkqi.cn/xlsx/%E6%B8%85%E6%89%AB%E6%9C%BA%E5%99%A8%E4%BA%BA.xlsx":22==e?"https://pictures.linkqi.cn/xlsx/%E7%94%B5%E6%B1%A0%E6%A8%A1%E7%BB%84%28BMU%29.xlsx":""},handleModelDownload:function(){window.location.href=this.modeldownLoadAddress},handleChange:function(e,t){this.fileList=t},handleRemove:function(e,t){this.fileList=t},uploadSectionFile:function(e,t){if("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=e.file.type&&"application/vnd.ms-excel"!=e.file.type&&-1==e.file.name.indexOf(".xlsx")&&-1==e.file.name.indexOf(".xls"))return this.$message.error(this.$t("upload.tip",{format:"xlsx、xls"})),new Promise((function(t,i){i(e.file)}));this.fileList=[],this.fileList.push(e.file)},handleRapidCancel:function(){this.rapidimportVisible=!1},rapidimportFormSubmitHandle:function(){var e=this;if(this.$hasSessionStorageGwsn()){if(!this.$hasPermission("deviceinfo:getYaoExcelInsert:permission.do"))return void this.$message.warning("暂无104快速导入权限, 请联系管理员");this.$refs["rapidimportForm"].validate((function(t){if(!t)return!1;if(0==e.fileList.length)return e.$message.info(e.$t("deviceInfo.uploadFileFirst"));e.rapidLoading=!0;var i=new FormData;i.append("mFile",e.fileList[0]),i.append("gwsn",sessionStorage.getItem("gwsn")),i.append("chlid",e.rapidimportForm.rapidchlId),i.append("chlname",e.rapidimportForm.rapidchlname),i.append("devname",e.rapidimportForm.devnamePrefix),i.append("devmanu",e.rapidimportForm.rapiddevmanu),i.append("devmodel",e.rapidimportForm.rapiddevmodel),e.$http.post("/info/deviceinfo/getYaoExcel ",i).then((function(t){var i=t.data;if(0!=i.code)return e.rapidLoading=!1,e.$message.error(i.data||i.msg);e.rapidLoading=!1,e.rapidimportVisible=!1,e.getDataList()})).catch((function(t){return e.rapidLoading=!1,e.rapidimportVisible=!1,e.getDataList()}))}))}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},pageSizeChangeHandle:function(e){this.page=1,this.limit=e,this.getDataList(),sessionStorage.setItem("limit1",this.limit),sessionStorage.setItem("page1",this.page)},pageCurrentChangeHandle:function(e){this.page=e,this.getDataList(),sessionStorage.setItem("page1",this.page)},sortChange:function(e,t,i){this.sname=e.prop,this.sort="ascending"==e.order?"asc":"desc",this.getDataList()},querySearch:function(){var e=this;this.$hasSessionStorageGwsn()?(this.page=1,this.getDataList()):this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},compareBySort:function(e,t){return e.sort((function(e,i){return e[t]-i[t]}))},getChlList:function(){var e=this,t={gwsn:sessionStorage.getItem("gwsn")};if(e.$hasSessionStorageGwsn()){if(e.rapidChlList=[],e.chlList=[{label:e.$t("deviceInfo.all"),value:"",chlId:"",chlcomment:""}],!e.$hasPermission("list:getChlList:select:permission.do"))return e.$message.warning("暂无通道查询权限, 请联系管理员"),void setTimeout((function(){e.getDataList()}),200);e.$http.get("/list/getChlList.do",{params:t}).then((function(t){var i=t.data;if(0!=i.code)return e.$message.error(i.data||i.msg);if(i.data.length>0)if(e.addDisabled=!1,i.data.forEach((function(t){if(0==t.chlType){var i={label:t.chlName,value:t.id,chlId:t.chlID,chlcomment:t.chlComment||e.$t("none")},a={label:t.chlName,value:t.id,chlId:t.chlID,chlprotocol:t.chlProtocol,chlcomment:t.chlComment||e.$t("none")};e.chlList.push(i),"{348E12D3-308A-40da-B1AA-489F326C5695}"!=a.chlprotocol&&"{FD3ADE44-CD42-43E2-BE78-AD0010D87373}"!=a.chlprotocol||e.rapidChlList.push(a)}})),e.chlList.length>0)if(e.chlList=e.compareBySort(e.chlList,"chlId"),e.queryParams.chlId)for(var a=0;a<e.chlList.length;a++){var n=e.chlList[a];if(e.queryParams.chlId==n.chlId){e.dataForm.chlname=n.chlId,e.rapidimportForm.rapidchlId=n.chlId,e.rapidimportForm.rapidchlname=n.chlname,e.getDataList();break}}else e.dataForm.chlname="",e.getDataList();else e.addDisabled=!0;else e.addDisabled=!0})).catch((function(t){return e.addDisabled=!0,!1}))}else e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},getDataList:d()((function(){var e=this;if(this.$hasSessionStorageGwsn()){var t={ptype:0,page:this.page,limit:this.limit,sname:this.sname,sort:this.sort,chlid:this.dataForm.chlname,gwsn:sessionStorage.getItem("gwsn")};if(this.dataForm.devname&&(t["devname"]=this.dataForm.devname.replace(/_/g,"\\_").replace(/%/g,"\\%")),this.total=0,this.dataList=[],!this.$hasPermission("deviceinfo:selectdevlist:permission.do"))return void this.$message.warning("暂无设备查询权限, 请联系管理员");this.dataListLoading=!0,this.$http.post("/ProcotolTemplate/getAu.do",{}).then((function(i){var a=i.data;0!=a.code?(e.showSpecialDesign=!1,e.editTypeLists=[{label:e.$t("deviceInfo.devname"),value:"devname"},{label:e.$t("deviceInfo.devcomment"),value:"devcomment"},{label:e.$t("deviceInfo.devcommaddr"),value:"devcommaddr"},{label:e.$t("deviceInfo.devpublicaddr"),value:"devpublicaddr"},{label:e.$t("deviceInfo.devmanu"),value:"devmanu"},{label:e.$t("deviceInfo.devmodel"),value:"devmodel"},{label:e.$t("configuration.collectMeasurementPointRegisterAddress"),value:"tagObjaddr"},{label:e.$t("configuration.collectMeasurementPointCoefficientK"),value:"tagK"},{label:e.$t("valid"),value:"valid"}],e.$http.get("/info/deviceinfo/devlist",{params:t}).then((function(i){var a=i.data;e.page=t.page,e.dataListLoading=!1,e.dataList=a.list||[],e.total=Number(a.total)||0,e.$nextTick((function(){e.dataList.length>0?(e.currentPageCheccked&&!e.allCheck&&(e.$refs.recordTable&&e.$refs.recordTable.clearSelection(),e.devIds=[],e.deleteIds=[],e.devmodelIds=[],e.multipleSelectionAll=[],e.multipleSelectionDevIds=[],e.multipleSelectionDevIdAndChlIds=[],e.dataList.forEach((function(t){e.devIds.push(t.id),e.deleteIds.push(t.id),e.devmodelIds.push(t.devmanu),e.multipleSelectionAll.push(t.id),e.multipleSelectionDevIds.push(t.devid),e.multipleSelectionDevIdAndChlIds.push({id:t.id,chlid:t.chlid,devid:t.devid})})),e.exportIds=e.devIds.join(","),e.$store.dispatch("changeExportIds",e.exportIds),e.dataList.forEach((function(t){t&&e.$refs.recordTable&&e.$refs.recordTable.toggleRowSelection(t,!0)}))),e.currentPageCheccked||e.allCheck||e.$refs.recordTable&&e.$refs.recordTable.clearSelection(),e.allCheck&&(e.dataList.forEach((function(t){t&&e.$refs.recordTable&&e.$refs.recordTable.toggleRowSelection(t,!0)})),e.getAllChecked())):e.$refs.recordTable&&e.$refs.recordTable.clearSelection()}))})).catch((function(t){return e.dataListLoading=!1,!1}))):(e.showSpecialDesign=!0,e.editTypeLists=[{label:e.$t("deviceInfo.devname"),value:"devname"},{label:e.$t("deviceInfo.devcomment"),value:"devcomment"},{label:e.$t("deviceInfo.devcommaddr"),value:"devcommaddr"},{label:e.$t("deviceInfo.devpublicaddr"),value:"devpublicaddr"},{label:e.$t("configuration.collectMeasurementPointRegisterAddress"),value:"tagObjaddr"},{label:e.$t("configuration.collectMeasurementPointCoefficientK"),value:"tagK"},{label:e.$t("deviceInfo.protocolEnergyCode"),value:"reserve0"},{label:e.$t("deviceInfo.comPort"),value:"reserve1"},{label:e.$t("valid"),value:"valid"}],e.$http.get("/info/deviceinfo/devlist",{params:t}).then((function(i){var a=i.data;e.page=t.page,e.dataListLoading=!1,e.dataList=a.list||[],e.total=Number(a.total)||0,e.$nextTick((function(){e.dataList.length>0?(e.currentPageCheccked&&!e.allCheck&&(e.$refs.recordTable&&e.$refs.recordTable.clearSelection(),e.devIds=[],e.deleteIds=[],e.devmodelIds=[],e.multipleSelectionAll=[],e.multipleSelectionDevIds=[],e.multipleSelectionDevIdAndChlIds=[],e.dataList.forEach((function(t){e.devIds.push(t.id),e.deleteIds.push(t.id),e.devmodelIds.push(t.devmanu),e.multipleSelectionAll.push(t.id),e.multipleSelectionDevIds.push(t.devid),e.multipleSelectionDevIdAndChlIds.push({id:t.id,chlid:t.chlid,devid:t.devid})})),e.exportIds=e.devIds.join(","),e.$store.dispatch("changeExportIds",e.exportIds),e.dataList.forEach((function(t){t&&e.$refs.recordTable&&e.$refs.recordTable.toggleRowSelection(t,!0)}))),e.currentPageCheccked||e.allCheck||e.$refs.recordTable&&e.$refs.recordTable.clearSelection(),e.allCheck&&(e.dataList.forEach((function(t){t&&e.$refs.recordTable&&e.$refs.recordTable.toggleRowSelection(t,!0)})),e.getAllChecked())):e.$refs.recordTable&&e.$refs.recordTable.clearSelection()}))})).catch((function(t){return e.dataListLoading=!1,!1})))})).catch((function(i){e.showSpecialDesign=!1,e.editTypeLists=[{label:e.$t("deviceInfo.devname"),value:"devname"},{label:e.$t("deviceInfo.devcomment"),value:"devcomment"},{label:e.$t("deviceInfo.devcommaddr"),value:"devcommaddr"},{label:e.$t("deviceInfo.devpublicaddr"),value:"devpublicaddr"},{label:e.$t("deviceInfo.devmanu"),value:"devmanu"},{label:e.$t("deviceInfo.devmodel"),value:"devmodel"},{label:e.$t("configuration.collectMeasurementPointRegisterAddress"),value:"tagObjaddr"},{label:e.$t("configuration.collectMeasurementPointCoefficientK"),value:"tagK"},{label:e.$t("valid"),value:"valid"}],e.$http.get("/info/deviceinfo/devlist",{params:t}).then((function(i){var a=i.data;e.page=t.page,e.dataListLoading=!1,e.dataList=a.list||[],e.total=Number(a.total)||0,e.$nextTick((function(){e.dataList.length>0?(e.currentPageCheccked&&!e.allCheck&&(e.$refs.recordTable&&e.$refs.recordTable.clearSelection(),e.devIds=[],e.deleteIds=[],e.devmodelIds=[],e.multipleSelectionAll=[],e.multipleSelectionDevIds=[],e.multipleSelectionDevIdAndChlIds=[],e.dataList.forEach((function(t){e.devIds.push(t.id),e.deleteIds.push(t.id),e.devmodelIds.push(t.devmanu),e.multipleSelectionAll.push(t.id),e.multipleSelectionDevIds.push(t.devid),e.multipleSelectionDevIdAndChlIds.push({id:t.id,chlid:t.chlid,devid:t.devid})})),e.exportIds=e.devIds.join(","),e.$store.dispatch("changeExportIds",e.exportIds),e.dataList.forEach((function(t){t&&e.$refs.recordTable&&e.$refs.recordTable.toggleRowSelection(t,!0)}))),e.currentPageCheccked||e.allCheck||e.$refs.recordTable&&e.$refs.recordTable.clearSelection(),e.allCheck&&(e.dataList.forEach((function(t){t&&e.$refs.recordTable&&e.$refs.recordTable.toggleRowSelection(t,!0)})),e.getAllChecked())):e.$refs.recordTable&&e.$refs.recordTable.clearSelection()}))})).catch((function(t){return e.dataListLoading=!1,!1}))}))}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),formatterDevManu:function(e,t){return this.getDevManu(e.devmanu)||this.$t("deviceInfo.no")},getDevManu:function(e){return this.devModelList.find((function(t){return t.devPlatform==e}))?this.devModelList.find((function(t){return t.devPlatform==e})).platformName:this.$t("deviceInfo.no")},formatterDevModel:function(e,t){return this.getDevModel(e.devmanu,e.devmodel)||this.$t("deviceInfo.no")},getDevModel:function(e,t){for(var i="",a=!1,n=0;n<this.devModelList.length;n++)if(this.devModelList[n].devPlatform==e&&this.devModelList[n].devIndex==t){i=this.devModelList[n].devDesc,a=!0;break}return a?i:null!=e?e:""},getdevModelList:function(){var e=this;if(e.devModelList=[],!e.$hasPermission("devtypeinfo:selectlistAll:permission.do"))return e.$message.warning("暂无设备型号查询权限, 请联系管理员"),void setTimeout((function(){e.getChlList()}),200);e.$http.post("/info/devtypeinfo/listAll",s.a.stringify({})).then((function(t){var i=t.data;e.devModelList=i.data,e.getChlList()})).catch((function(e){return!1}))},getRowKey:function(e){return e.id},selectAll:function(e){e.length>0?this.currentPageCheccked=!0:this.currentPageCheccked=!1},dataListSelectionHandle:function(e){var t=this;this.exportIds=null,this.devIds=[],this.deleteIds=[],this.devmodelIds=[],this.multipleSelectionAll=[],this.multipleSelectionDevIds=[],this.multipleSelectionDevIdAndChlIds=[],this.copyList=e,e.length>0&&!this.allCheck?(this.multipleSelectionAll=this.reduceSame(e),this.multipleSelectionAll=this.multipleSelectionAll.map((function(e){return e.id})),e.forEach((function(e){t.devIds.push(e.id),t.deleteIds.push(e.id),t.devmodelIds.push(e.devmanu),t.multipleSelectionDevIds.push(e.devid),t.multipleSelectionDevIdAndChlIds.push({id:e.id,chlid:e.chlid,devid:e.devid})})),this.exportIds=this.devIds.join(","),this.$store.dispatch("changeExportIds",this.exportIds),e.length==this.dataList.length?this.currentPageCheccked=!0:this.currentPageCheccked=!1):this.$store.dispatch("changeExportIds","")},handleCopyDevice:function(){var e=this;if(this.$hasSessionStorageGwsn()){if(0===this.copyList.length||0===this.dataList.length)return this.$message.warning(this.$t("deviceInfo.pleaseSelectDeviceAsReplicationDataSource"));if(this.copyList.length>1)return this.$message.warning(this.$t("deviceInfo.onlyOneDeviceCanBeSelectedAsReplicationDataSource"));if(!this.$hasPermission("channelinfo:copyDev:permission.do"))return void this.$message.warning("暂无复制设备权限, 请联系管理员");this.copyDeviceVisible=!0}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},handleCopyDeviceClose:function(){this.copyDeviceForm.copyCount=1,this.copyDeviceForm.devname="",this.$refs["copyDeviceForm"].resetFields(),this.copyDeviceVisible=!1},copyDeviceFormSubmitHandle:d()((function(){var e=this,t={gwsn:sessionStorage.getItem("gwsn"),devId:e.copyList[0].devid,devPreName:e.copyDeviceForm.devname,num:e.copyDeviceForm.copyCount,flag:e.copyDeviceForm.flag};if(e.$hasSessionStorageGwsn()){if(!e.$hasPermission("channelinfo:copyDev:permission.do"))return void e.$message.warning("暂无复制设备权限, 请联系管理员");e.$refs["copyDeviceForm"].validate((function(i){if(!i)return!1;e.copyDeviceFormloading=!0,e.$http.get("/info/channelinfo/copyDev.do",{params:t}).then((function(t){var i=t.data;if(0!=i.code)return e.copyDeviceFormloading=!1,e.$message.error(i.data||i.msg),!1;e.$message({message:e.$t("deviceInfo.copyDeviceSuccess"),type:"success",duration:500,onClose:function(){e.copyDeviceFormloading=!1,e.copyDeviceVisible=!1,e.getDataList()}})})).catch((function(t){e.copyDeviceFormloading=!1,e.copyDeviceVisible=!1,e.getDataList()}))}))}else e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),reduceSame:function(e){var t={};return e.reduce((function(e,i){return!t[i.id]&&(t[i.id]=e.push(i)),e}),[])},checkSelectable:function(e,t){return!this.allCheck},allCheckEvent:function(){var e=this;e.allCheck?(e.dataList.forEach((function(t){t&&e.$refs.recordTable&&e.$refs.recordTable.toggleRowSelection(t,!0)})),e.getAllChecked()):e.$refs.recordTable&&e.$refs.recordTable.clearSelection()},getAllChecked:function(){var e=this;if(this.$hasSessionStorageGwsn()){var t={ptype:0,chlid:this.dataForm.chlname,gwsn:sessionStorage.getItem("gwsn")};if(this.dataForm.devname&&(t["devname"]=this.dataForm.devname),!this.$hasPermission("deviceinfo:DevicesBywsnAndPtypeSelect:permission.do"))return void this.$message.warning("暂无全部采集设备查询权限, 请联系管理员");this.$http.get("/info/deviceinfo/DevicesBywsnAndPtype",{params:t}).then((function(t){var i=t.data;if(0!=i.code)return e.$message.error(i.data||i.msg);e.devIds=[],e.deleteIds=[],e.devmodelIds=[],e.multipleSelectionAll=[],e.multipleSelectionDevIds=[],e.multipleSelectionDevIdAndChlIds=[];for(var a=0;i.data<array.length;a++){var n=i.data[a];e.devIds.push(n.id),e.deleteIds.push(n.id),e.devmodelIds.push(n.devmanu),e.multipleSelectionAll.push(n.id),e.multipleSelectionDevIds.push(n.devid),e.multipleSelectionDevIdAndChlIds.push({id:n.id,chlid:n.chlid,devid:n.devid})}e.exportIds=e.devIds.join(","),e.$store.dispatch("changeExportIds",e.exportIds)})).catch((function(e){return!1}))}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},collect:function(e,t){var i={label:t.devname+"-"+t.channelInfoEntityList[0].chlname,value:t.id,chlId:t.chlid,devId:t.devid};this.$router.push({path:"taginfo",name:"taginfo",query:i}),o["a"].$emit("activeIndex2","/taginfo")},handleAddOrUpdate:function(e,t,i){var a=this;if(this.$hasSessionStorageGwsn()){if(this.addDisabled)return this.$message.warning(this.$t("deviceInfo.noCollect"));this.addOrUpdateVisible=!0,this.$nextTick((function(){if(e){if(!a.$hasPermission("deviceinfo:insert:permission.do"))return void a.$message.warning("暂无设备新增权限, 请联系管理员");a.queryParams["chlId"]=a.dataForm.chlname}else{if(!a.$hasPermission("deviceinfo:update:permission.do"))return void a.$message.warning("暂无设备修改权限, 请联系管理员");a.$refs.addOrUpdate.dataForm.id=i.id,a.$refs.addOrUpdate.dataForm.chlid=i.chlid}a.$refs.addOrUpdate.init()}))}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),a.$router.replace({path:"/tgw-tgwinfo"})}})},editAll:function(){var e=this;if(this.$hasSessionStorageGwsn()){if(!(this.devIds.length>0))return this.$message.info(this.$t("deviceInfo.selectEditData"));if(!this.$hasPermission("deviceinfo:updateNamesOrDescByIds:permission.do")&&!this.$hasPermission("deviceinfo:updateAddrs:permission.do")&&!this.$hasPermission("deviceinfo:updateTagsAddr:permission.do")&&!this.$hasPermission("deviceinfo:updateTagsK:permission.do")&&!this.$hasPermission("deviceinfo:DevBatchUpdate:permission.do")&&!this.$hasPermission("deviceinfo:updateVal:permission.do"))return void this.$message.warning("暂无设备批量修改权限, 请联系管理员");this.editAllVisible=!0,this.selectChanged(this.editForm.type),this.getPlatFormList()}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},getPlatFormList:function(){var e=this,t=[],i={};e.platForm=[],e.$hasPermission("devtypeinfo:selectlistAll:permission.do")?e.$http.post("/info/devtypeinfo/listAll",s.a.stringify({})).then((function(a){var n=a.data,r=n.data;if(r.length>0){for(var s=0;s<r.length;s++){var o=r[s].devPlatform;i[o]||(t.push(r[s]),i[o]=!0)}t.forEach((function(t){var i={label:t.platformName,value:t.devPlatform};e.platForm.push(i)}))}e.$nextTick((function(){e.handleManu()}))})).catch((function(e){return!1})):e.$message.warning("暂无设备型号查询权限, 请联系管理员")},handleManu:function(){var e=this,t={devPlatform:e.devmodelIds[0]};e.platFormDevList=[],e.$hasPermission("devtypeinfo:selectlistAll:permission.do")?e.$http.post("/info/devtypeinfo/listAll",s.a.stringify(t)).then((function(t){var i=t.data,a=i.data;a.length>0&&(a.forEach((function(t){var i={label:t.devDesc,value:t.devIndex};e.platFormDevList.push(i)})),e.changeList=e.platFormDevList,e.editForm.devmodel=e.devModelList[0].value)})).catch((function(e){return!1})):e.$message.warning("暂无设备型号查询权限, 请联系管理员")},getFuncodeListByChlid:function(e){var t=this,i="",a=!1,n={gwsn:sessionStorage.getItem("gwsn"),chltype:0};if(t.$hasSessionStorageGwsn()){if(!t.$hasPermission("channelinfo:selectChannelByGwsnAndChltype:permission.do"))return void t.$message.warning("暂无全部采集通道查询权限, 请联系管理员");t.$http.get("/info/channelinfo/selectChannelByGwsnAndChltype",{params:n}).then((function(n){var r=n.data;if(0!=r.code)return t.collectTypecList=[],t.editForm.collectTypec=null,t.$message.error(r.data||r.msg);for(var s=0;s<r.data.length;s++){var o=r.data[s];if(o.chlid==e){i=o.chlprotocol;break}}if(!i)return t.collectTypecList=[],t.editForm.collectTypec=null,t.$message.error(t.$t("deviceInfo.failedToGetChannelProtocol"));t.$hasPermission("protocolinfo:select:permission.do")?t.$http.get("/info/protocolinfo/proguid",{params:{guid:i}}).then((function(e){var i=e.data;if(0!=i.code)return t.$message.error(i.data||i.msg);if(t.collectTypecList=i.data.length>0?JSON.parse(i.data[0].funccode).data:[],t.collectTypecList.length>0){if(null!=t.editForm.collectTypec){for(var n=0;n<t.collectTypecList.length;n++){var r=t.collectTypecList[n];if(r.FuncCode==t.editForm.collectTypec){a=!0;break}}a||(t.editForm.collectTypec=null)}}else t.editForm.collectTypec=null})):t.$message.warning("暂无协议查询权限, 请联系管理员")}))}else t.$message({showClose:!1,message:t.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}})},selectChanged:function(e){if(this.changeList=[],this.editForm.changeValue="","devmanu"===e)this.changeList=this.platForm,this.editForm.changeValue=this.changeList[0].value;else if("devmodel"===e){for(var t=this.devmodelIds[0],i=!0,a=0;a<this.devmodelIds.length;a++){var n=this.devmodelIds[a];if(n!=t){i=!1;break}}if(!i)return this.$message.error(this.$t("deviceInfo.samePlantform"));this.changeList=this.platFormDevList,this.editForm.changeValue=this.changeList[0].value}else if("tagObjaddr"==e||"tagK"==e){var r=this.multipleSelectionDevIdAndChlIds[0].chlid;this.multipleSameChlIdFlag=!0;for(var s=0;s<this.multipleSelectionDevIdAndChlIds.length;s++){var o=this.multipleSelectionDevIdAndChlIds[s];if(o.chlid!=r){this.multipleSameChlIdFlag=!1;break}}if(!this.multipleSameChlIdFlag)return this.$message.warning(this.$t("deviceInfo.pleaseSelectTheDeviceOfTheSameChannel"));this.getFuncodeListByChlid(r)}else"valid"==e&&(this.editForm.changeValue=0)},dataFormSubmitHandle:d()((function(){var e=this;if(this.$hasSessionStorageGwsn()){var t=[];if("devname"===this.editForm.type||"devcomment"===this.editForm.type){if(!this.$hasPermission("deviceinfo:updateNamesOrDescByIds:permission.do"))return void this.$message.warning("暂无设备批量修改权限, 请联系管理员");var i={sn:sessionStorage.getItem("gwsn"),ids:this.multipleSelectionAll.length>0?this.multipleSelectionAll.join(","):"",pre:this.editForm.pre,fex:this.editForm.fex,type:"devname"===this.editForm.type?0:1};if("devname"===this.editForm.type){if(""===this.editForm.fex||null===this.editForm.fex||void 0===this.editForm.fex)return this.$message.warning(this.$t("deviceInfo.theStartingValueCannotBeEmpty"));i["fex"]=Number(this.editForm.fex)}if(!/^[0-9]\d*/.test(this.editForm.fex))return this.$message.error(this.$t("deviceInfo.enterInt"));if(!i.sn)return this.$message.error(this.$t("deviceInfo.failedToObtainGatewayNumber"));if(!this.editForm.pre)return this.$message.warning(this.$t("deviceInfo.prefixCannotBeEmpty"));this.$http.put("/info/deviceinfo/uodateNamesOrDescByIds.do",s.a.stringify(i)).then((function(t){var i=t.data;if(0!=i.code)return e.$message.error(i.data||i.msg);e.$message.success(i.data),e.editAllVisible=!1,e.getDataList()}))}else if("devcommaddr"===this.editForm.type||"devpublicaddr"===this.editForm.type){if(!this.$hasPermission("deviceinfo:updateAddrs:permission.do"))return void this.$message.warning("暂无设备批量修改权限, 请联系管理员");var a={ids:this.devIds.join(","),pre:this.editForm.startValue,fex:this.editForm.step,type:"devcommaddr"===this.editForm.type?0:1};this.$refs["editForm"].validate((function(t){if(!t)return!1;e.$http.put("/info/deviceinfo/updateAddrs.do",s.a.stringify(a)).then((function(t){var i=t.data;if(0!=i.code)return e.$message.error(i.data||i.msg);e.$message.success(i.data),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList()}))}))}else if("tagObjaddr"==this.editForm.type||"tagK"==this.editForm.type){if("tagObjaddr"==this.editForm.type&&!this.$hasPermission("deviceinfo:updateTagsAddr:permission.do"))return void this.$message.warning("暂无设备批量修改权限, 请联系管理员");if("tagObjaddr"!=this.editForm.type&&!this.$hasPermission("deviceinfo:updateTagsK:permission.do"))return void this.$message.warning("暂无设备批量修改权限, 请联系管理员");var n="tagObjaddr"==this.editForm.type?"/info/deviceinfo/updateTagsAddr.do":"/info/deviceinfo/updateTagsK.do",r={devIds:this.multipleSelectionDevIds.join(","),sn:sessionStorage.getItem("gwsn"),pre:this.editForm.tagObjaddrOrKStartValue,fex:this.editForm.tagObjaddrOrKStep,tagType:this.editForm.tagType,collet:this.editForm.collectTypec,type:0};this.$refs["editForm"].validate((function(t){if(!t)return!1;e.$http.put(n,s.a.stringify(r)).then((function(t){var i=t.data;if(0!=i.code)return e.$message.error(i.data||i.msg);e.$message.success(i.data||i.msg),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList()}))}))}else if("reserve0"==this.editForm.type||"reserve1"==this.editForm.type){if(!this.$hasPermission("deviceinfo:DevBatchUpdate:permission.do"))return void this.$message.warning("暂无设备批量修改权限, 请联系管理员");var o=this.editForm.type;this.devIds.forEach((function(i){var a={id:Number(i)};a["reserve0"==o?"devmanu":"reserve1"]="reserve1"==o?e.editForm.reserve1:e.editForm.reserve0,t.push(a)})),this.$refs["editForm"].validate((function(i){if(!i)return!1;e.$http.post("/info/deviceinfo/DevBatchUpdate",t).then((function(t){var i=t.data;if("OK"!==i.msg)return e.$message.error(i.data||i.msg);e.$message.success(i.data),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList(),!1}))}))}else if("valid"==this.editForm.type){if(!this.$hasPermission("deviceinfo:updateVal:permission.do"))return void this.$message.warning("暂无设备批量修改权限, 请联系管理员");var l={devIds:this.multipleSelectionDevIds.join(","),sn:sessionStorage.getItem("gwsn"),param:this.editForm.changeValue};this.$refs["editForm"].validate((function(t){if(!t)return!1;e.$http.post("/info/deviceinfo/updateVal.do",s.a.stringify(l)).then((function(t){var i=t.data;if("OK"!==i.msg)return e.$message.error(i.data||i.msg);e.$message.success(i.msg),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList(),!1}))}))}else{if(!this.$hasPermission("deviceinfo:DevBatchUpdate:permission.do"))return void this.$message.warning("暂无设备批量修改权限, 请联系管理员");var d=this.editForm.type;this.devIds.forEach((function(i){var a={id:i};a[d]=e.editForm.changeValue,t.push(a)})),this.$refs["editForm"].validate((function(i){if(!i)return!1;e.$http.post("/info/deviceinfo/DevBatchUpdate",t).then((function(t){var i=t.data;if("OK"!==i.msg)return e.$message.error(i.data||i.msg);e.$message.success(i.data),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList()}))}))}}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),deleteHandle:d()((function(e){var t=this;if(t.$hasSessionStorageGwsn()){if(e&&(t.deleteIds=[],t.deleteIds.push(e)),0===t.deleteIds.length)return t.$message.error(t.$t("deleteInfo.noData"));if(!t.$hasPermission("device:delete:permission.do"))return void t.$message.warning("暂无设备删除权限, 请联系管理员");t.$confirm(t.$t("deleteInfo.noticeTitle"),t.$t("deleteInfo.noticePrompt"),{confirmButtonText:t.$t("deleteInfo.confirm"),cancelButtonText:t.$t("deleteInfo.cancel"),type:"warning"}).then((function(){t.dataListLoading=!0,t.$http.post("/delcmd/device/delete.do",t.deleteIds).then((function(e){var i=e.data;if(0!=i.code)return t.dataListLoading=!1,t.$message.error(i.data||t.$t("deleteInfo.deleteFail"));t.$message.success(t.$t("deleteInfo.deleteSuccess")),t.dataListLoading=!1,t.getDataList(),t.allCheck=!1,t.$refs.recordTable.clearSelection()})).catch((function(e){return t.dataListLoading=!1,t.getDataList(),t.allCheck=!1,t.$refs.recordTable.clearSelection(),!1}))})).catch((function(e){}))}else t.$message({showClose:!1,message:t.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),handleDevicesToChannelChange:function(){this.mergeDevicesToChannelForm.chlId="",this.mergeDevicesToChannelForm.deviceIds=[],this.mergeDeviceList=[],this.mergeTargetChannelList=[],this.getMergeChannelList()},handleMergeDeviceIdsToChannelClose:function(){this.$refs.mergeDevicesToChannelForm.resetFields(),this.mergeDevicesToChannelVisible=!1},hanleMergeChlIdChanage:function(e){var t=this;if(this.mergeDeviceList=[],e){var i=this.mergeTargetChannelList.filter((function(i){return i.chlID!=e&&i.chlProtocol==t.mergeTargetChannelList.find((function(t){return t.chlID==e})).chlProtocol}));i.length>0&&i.forEach((function(e){e.hasOwnProperty("dev2PojoList")&&e.dev2PojoList.length>0&&(t.mergeDeviceList=t.mergeDeviceList.concat(e.dev2PojoList))}))}},selectAllMergeDevcie:function(){var e=this;this.mergeDevicesToChannelForm.deviceIds.length<this.mergeDeviceList.length?(this.mergeDevicesToChannelForm.deviceIds=[],this.mergeDeviceList.forEach((function(t){e.mergeDevicesToChannelForm.deviceIds.push(t.devID)})),this.mergeDevicesToChannelForm.deviceIds.unshift("all")):this.mergeDevicesToChannelForm.deviceIds=[]},handleMergeDeviceChange:function(e){e.includes("all")||e.length!==this.mergeDeviceList.length?e.includes("all")&&e.length-1<this.mergeDeviceList.length&&(this.mergeDevicesToChannelForm.deviceIds=this.mergeDevicesToChannelForm.deviceIds.filter((function(e){return"all"!==e}))):this.mergeDevicesToChannelForm.deviceIds.unshift("all")},getMergeChannelList:function(){var e=this;if(this.$hasSessionStorageGwsn()){var t={gwsn:sessionStorage.getItem("gwsn")};if(this.mergeDevicesToChannelVisible=!1,!this.$hasPermission("list:getChlList:select:permission.do"))return void this.$message.warning("暂无全部采集通道查询权限, 请联系管理员");this.$http.get("/list/getChlList.do",{params:t}).then((function(t){var i=t.data;return 0!=i.code?e.$message.error(i.data||i.msg):i.data.length>0?(i.data.forEach((function(t){0==t.chlType&&e.mergeTargetChannelList.push(t)})),e.mergeTargetChannelList.length>1?void(e.mergeDevicesToChannelVisible=!0):e.$message.warning(e.$t("deviceInfo.thereIsCurrentlyNoMovingTargetChannel"))):e.$message.warning(e.$t("deviceInfo.thereIsCurrentlyNoMovingTargetChannel"))}))}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},handleMergeDeviceIdsToChannelSubmit:d()((function(){var e=this,t={sn:sessionStorage.getItem("gwsn"),deviceIds:"",chlId:e.mergeDevicesToChannelForm.chlId,type:0};if(e.$hasSessionStorageGwsn()){if(!e.$hasPermission("channelinfo:updateDevicesChlId:permission.do"))return void e.$message.warning("暂无设备移动至通道权限, 请联系管理员");e.$refs["mergeDevicesToChannelForm"].validate((function(i){if(!i)return!1;if(e.mergeDevicesToChannelForm.deviceIds.includes("all")){var a=JSON.parse(JSON.stringify(e.mergeDevicesToChannelForm.deviceIds));a.splice(a.findIndex((function(e){return"all"===e})),1),t["deviceIds"]=a.join(",")}else t["deviceIds"]=e.mergeDevicesToChannelForm.deviceIds.join(",");e.$confirm(e.$t("deviceInfo.areYouWantToMoveDevicesToChannel"),e.$t("deleteInfo.noticePrompt"),{confirmButtonText:e.$t("deleteInfo.confirm"),cancelButtonText:e.$t("deleteInfo.cancel"),type:"warning"}).then((function(){e.mergeDevicesToChannelFormloading=!0,e.$http.get("/info/channelinfo/updateDevicesChlId.do",{params:t}).then((function(t){var i=t.data;if(0!=i.code)return e.mergeDevicesToChannelFormloading=!1,e.$message.error(i.data||i.msg);e.$message.success(e.$t("prompt.success")),e.mergeDevicesToChannelFormloading=!1,e.handleMergeDeviceIdsToChannelClose(),e.getDataList(),e.allCheck=!1,e.$refs.recordTable.clearSelection()})).catch((function(t){return e.mergeDevicesToChannelFormloading=!1,!1}))})).catch((function(e){}))}))}else e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),handleDevicesToOtherDevice:function(){if(this.mergeDevicesToOtherDeviceForm.devId="",this.mergeDevicesToOtherDeviceForm.devIds=[],this.mergeTargetDeviceList=[],this.mergePrepareDeviceList=[],this.multipleSelectionDevIds.length==this.total)return this.$message.warning(this.$t("deviceInfo.selectedAllDevicesAndCannotMergeDevices"));this.$hasPermission("channelinfo:updateTagDevId2:permission.do")?this.getMergeAllDevicesList():this.$message.warning("暂无设备合并权限, 请联系管理员")},getMergeAllDevicesList:function(){var e=this,t={gwsn:sessionStorage.getItem("gwsn")};if(e.$hasSessionStorageGwsn()){if(e.mergeTargetDeviceList=[],!e.$hasPermission("list:getChlList:select:permission.do"))return void e.$message.warning("暂无全部通道查询权限, 请联系管理员");e.$http.get("/list/getChlList.do",{params:t}).then((function(t){var i=t.data;return 0!=i.code?e.$message.error(i.data||i.msg):i.data.length>0?(i.data.forEach((function(t){0==t.chlType&&(e.dataForm.chlname?t.chlID==e.dataForm.chlname&&t.hasOwnProperty("dev2PojoList")&&t.dev2PojoList.length>0&&(t.dev2PojoList.forEach((function(i){e.$set(i,"chlID",t.chlID),e.$set(i,"chlProtocol",t.chlProtocol)})),e.mergeTargetDeviceList=t.hasOwnProperty("dev2PojoList")?t.dev2PojoList:[]):t.hasOwnProperty("dev2PojoList")&&t.dev2PojoList.length>0&&(t.dev2PojoList.forEach((function(i){e.$set(i,"chlID",t.chlID),e.$set(i,"chlProtocol",t.chlProtocol)})),e.mergeTargetDeviceList=e.mergeTargetDeviceList.concat(t.hasOwnProperty("dev2PojoList")?t.dev2PojoList:[])))})),e.mergeTargetDeviceList.length>1?(e.multipleSelectionDevIds.length>0&&(e.mergePrepareDeviceList=e.mergeTargetDeviceList,e.mergeDevicesToOtherDeviceForm.devIds=e.multipleSelectionDevIds),void(e.mergeDevicesToOtherDeviceVisible=!0)):e.$message.error(e.$t("deviceInfo.noCurrentlyDevicesToMerge"))):e.$message.error(e.$t("deviceInfo.noChannelPleaseCreateChannel"))}))}else e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},handleMergeDeviceIdsToOtherDeviceClose:function(){this.$refs.mergeDevicesToOtherDeviceForm.resetFields(),this.mergeDevicesToOtherDeviceVisible=!1},hanleMergeTargetDevicesChanage:function(e){var t=this;if(this.mergePrepareDeviceList=[],e){var i=this.mergeTargetDeviceList.filter((function(t){return t.devID!=e}));i.length>0&&(this.mergePrepareDeviceList=i),this.mergeDevicesToOtherDeviceForm.devIds.length>0&&(this.mergeDevicesToOtherDeviceForm.devIds=this.mergeDevicesToOtherDeviceForm.devIds.filter((function(e){return e!=t.mergeDevicesToOtherDeviceForm.devId&&t.mergePrepareDeviceList.find((function(t){return t.devID==e}))})),this.mergeDevicesToOtherDeviceForm.devIds.includes("all")||this.mergeDevicesToOtherDeviceForm.devIds.length!==this.mergePrepareDeviceList.length?this.mergeDevicesToOtherDeviceForm.devIds.includes("all")&&this.mergeDevicesToOtherDeviceForm.devIds.length-1<this.mergePrepareDeviceList.length&&(this.mergeDevicesToOtherDeviceForm.devIds=this.mergeDevicesToOtherDeviceForm.devIds.filter((function(e){return"all"!==e}))):this.mergeDevicesToOtherDeviceForm.devIds.unshift("all"))}},selectAllPrepareDevcie:function(){var e=this;this.mergeDevicesToOtherDeviceForm.devIds.length<this.mergePrepareDeviceList.length?(this.mergeDevicesToOtherDeviceForm.devIds=[],this.mergePrepareDeviceList.forEach((function(t){e.mergeDevicesToOtherDeviceForm.devIds.push(t.devID)})),this.mergeDevicesToOtherDeviceForm.devIds.unshift("all")):this.mergeDevicesToOtherDeviceForm.devIds=[]},handleMergePrepareDevicesChange:function(e){e.includes("all")||e.length!==this.mergePrepareDeviceList.length?e.includes("all")&&e.length-1<this.mergePrepareDeviceList.length&&(this.mergeDevicesToOtherDeviceForm.devIds=this.mergeDevicesToOtherDeviceForm.devIds.filter((function(e){return"all"!==e}))):this.mergeDevicesToOtherDeviceForm.devIds.unshift("all")},handleMergeDeviceIdsToOtherDeviceSubmit:d()((function(){var e=this,t={sn:sessionStorage.getItem("gwsn"),devIds:"",devId:e.mergeDevicesToOtherDeviceForm.devId,chlId:"",type:0};if(e.$hasSessionStorageGwsn()){if(!e.$hasPermission("channelinfo:updateTagDevId2:permission.do"))return void e.$message.warning("暂无设备合并权限, 请联系管理员");e.$refs["mergeDevicesToOtherDeviceForm"].validate((function(i){if(!i)return!1;if(t["chlId"]=e.mergeTargetDeviceList.find((function(t){return t.devID==e.mergeDevicesToOtherDeviceForm.devId})).chlID,e.mergeDevicesToOtherDeviceForm.devIds.includes("all")){var a=JSON.parse(JSON.stringify(e.mergeDevicesToOtherDeviceForm.devIds));a.splice(a.findIndex((function(e){return"all"===e})),1),t["devIds"]=a.join(",")}else t["devIds"]=e.mergeDevicesToOtherDeviceForm.devIds.join(",");e.$confirm(e.$t("deviceInfo.areYouWantToMergeDevicesIntoDevice"),e.$t("deleteInfo.noticePrompt"),{confirmButtonText:e.$t("deleteInfo.confirm"),cancelButtonText:e.$t("deleteInfo.cancel"),type:"warning"}).then((function(){e.mergeDevicesToOtherDeviceFormloading=!0,e.$http.get("/info/channelinfo/updateTagDevId2.do",{params:t}).then((function(t){var i=t.data;if(0!=i.code)return e.mergeDevicesToOtherDeviceFormloading=!1,e.$message.error(i.data||i.msg);e.$message.success(e.$t("prompt.success")),e.mergeDevicesToOtherDeviceFormloading=!1,e.handleMergeDeviceIdsToOtherDeviceClose(),e.getDataList(),e.allCheck=!1,e.$refs.recordTable.clearSelection()})).catch((function(t){return e.mergeDevicesToOtherDeviceFormloading=!1,!1}))})).catch((function(e){}))}))}else e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1})},created:function(){this.page=Number(sessionStorage.getItem("page1"))||1,this.limit=Number(sessionStorage.getItem("limit1"))||20},mounted:function(){var e=this;e.isShowSetting=0!=sessionStorage.getItem("per"),e.superAdmin=localStorage.getItem("superAdmin"),e.$erd.listenTo(document.getElementById("deviceQueryContainer"),(function(t){var i=document.getElementById("deviceQueryContainer").offsetHeight;e.scrollTableHeight=window.innerHeight-145-i})),e.queryParams=e.$route.query,e.getdevModelList(),window.onresize=function(){return function(){var t=document.getElementById("deviceQueryContainer").offsetHeight;e.scrollTableHeight=window.innerHeight-145-t}()}},watch:{total:function(){this.total==(this.page-1)*this.limit&&0!=this.total&&(this.page-=1,sessionStorage.setItem("page1",this.page),this.getDataList())},multipleSelectionAll:function(){0!=this.multipleSelectionAll.length&&this.multipleSelectionAll.length==this.dataList.length||(this.currentPageCheccked=!1)},dataList:{handler:function(e){var t=this;this.allCheck&&this.dataList.forEach((function(e){e&&t.$refs.recordTable&&t.$refs.recordTable.toggleRowSelection(e,!0)}))},deep:!0},"mergeDevicesToChannelForm.chlId":{handler:function(e,t){if(e){var i=[],a=this.mergeTargetChannelList.filter((function(t){return t.chlID!=e}));a.length>0&&(a.forEach((function(e){e.hasOwnProperty("dev2PojoList")&&e.dev2PojoList.length>0&&(i=i.concat(e.dev2PojoList))})),this.mergeDeviceList=i,this.mergeDevicesToChannelForm.deviceIds=[])}},deep:!0}}}),p=m,v=i("2877"),u=Object(v["a"])(p,a,n,!1,null,null,null);t["default"]=u.exports},e1a5:function(e,t,i){"use strict";i("ac4d"),i("8a81"),i("5df3"),i("1c4c"),i("7f7f"),i("6b54"),i("8e6e"),i("ac6a"),i("456d"),i("4917"),i("6762"),i("2fdb"),i("a481");var a=i("ade3"),n=i("a78e"),r=i.n(n),s=i("4328"),o=i.n(s),l=i("b047"),d=i.n(l);function c(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=h(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var a=0,n=function(){};return{s:n,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,o=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return s=e.done,e},e:function(e){o=!0,r=e},f:function(){try{s||null==i.return||i.return()}finally{if(o)throw r}}}}function h(e,t){if(e){if("string"==typeof e)return m(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,a=Array(t);i<t;i++)a[i]=e[i];return a}function p(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function v(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?p(Object(i),!0).forEach((function(t){Object(a["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var u=["/channelinfo","/deviceinfo","/taginfo","/transchannelinfo","/transdeviceinfo","/transtaginfo","/centervar","/scriptinfo","/integralmodule"];t["a"]={data:function(){return{ids:"",exportIds:null,mixinViewModuleOptions:{activatedIsNeed:!0,getDataListURL:"",getDataListIsPage:!1,deleteURL:"",deleteIsBatch:!1,deleteIsBatchKey:"id",exportURL:""},dataForm:{},dataList:[],order:"",orderField:"",page:1,limit:20,total:0,dataListLoading:!1,dataListSelections:[],addOrUpdateVisible:!1,storeselection:[]}},activated:function(){this.mixinViewModuleOptions.activatedIsNeed&&this.getDataList()},methods:{getDataList:function(){var e=this;this.dataListLoading=!0,this.$http.get(this.mixinViewModuleOptions.getDataListURL,{params:v({order:this.order,orderField:this.orderField,page:this.mixinViewModuleOptions.getDataListIsPage?this.page:null,limit:this.mixinViewModuleOptions.getDataListIsPage?this.limit:null},this.dataForm)}).then((function(t){var i=t.data;if(e.dataListLoading=!1,0!==i.code)return e.dataList=[],e.total=0,e.$message.error(i.msg);e.dataList=(e.mixinViewModuleOptions.getDataListIsPage,Array.isArray(i.data)?i.data:i.data.list),e.total=e.mixinViewModuleOptions.getDataListIsPage?i.data.total:0})).catch((function(t){return e.dataListLoading=!1,!1}))},dataListSelectionChangeHandle:function(e){this.storeselection=[],this.dataListSelections=e;var t,i=c(this.dataListSelections);try{for(i.s();!(t=i.n()).done;){var a=t.value;this.storeselection.push(a.id)}}catch(n){i.e(n)}finally{i.f()}this.ids=this.storeselection.join(","),this.$store.dispatch("changeIds",this.ids)},dataListSortChangeHandle:function(e){if(!e.order||!e.prop)return this.order="",this.orderField="",!1;this.order=e.order.replace(/ending$/,""),this.orderField=e.prop.replace(/([A-Z])/g,"_$1").toLowerCase(),this.getDataList()},pageSizeChangeHandle:function(e){this.page=1,this.limit=e,this.getDataList()},pageCurrentChangeHandle:function(e){this.page=e,this.getDataList()},addOrUpdateHandle:function(e){var t=this,i=!1;u.forEach((function(e){window.location.href.includes(e)&&(i=!0)})),i?this.$hasSessionStorageGwsn()?(this.addOrUpdateVisible=!0,this.$nextTick((function(){t.$refs.addOrUpdate.dataForm.id=e,t.$refs.addOrUpdate.init()}))):this.$message({showClose:!1,message:"未获取到网关编号",type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}}):(this.addOrUpdateVisible=!0,this.$nextTick((function(){t.$refs.addOrUpdate.dataForm.id=e,t.$refs.addOrUpdate.init()})))},deleteHandle:d()((function(e){var t=this;if(this.mixinViewModuleOptions.deleteIsBatch&&!e&&this.dataListSelections.length<=0)return this.$message.warning(this.$t("prompt.deleteBatch"));this.$confirm(this.$t("prompt.info",{handle:this.$t("delete")}),this.$t("prompt.title"),{confirmButtonText:this.$t("confirm"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((function(){t.dataListLoading=!0,t.$http.delete("".concat(t.mixinViewModuleOptions.deleteURL).concat(t.mixinViewModuleOptions.deleteIsBatch?"":"/"+e),t.mixinViewModuleOptions.deleteIsBatch?{data:e?[e]:t.dataListSelections.map((function(e){return e[t.mixinViewModuleOptions.deleteIsBatchKey]}))}:{}).then((function(e){var i=e.data;if(0!==i.code)return t.dataListLoading=!1,t.$message.error(i.msg);t.$message({message:t.$t("prompt.success"),type:"success",duration:500,onClose:function(){t.getDataList()}})})).catch((function(e){return t.dataListLoading=!1,!1}))})).catch((function(e){}))}),1e3,{leading:!0,trailing:!1}),postExcelFile:function(e,t){var i=document.createElement("form");for(var a in i.style.display="none",i.action=t,i.method="post",document.body.appendChild(i),e){var n=document.createElement("input");n.type="hidden",n.name=a,n.value=e[a],i.appendChild(n)}i.submit(),i.remove()},exportHandle:d()((function(){var e=!1,t={token:r.a.get("token"),ids:null};if(this.exportIds&&(t.ids=this.exportIds,e=!0),this.ids&&(t.ids=this.ids,e=!0),"/info/taginfo/exports"==this.mixinViewModuleOptions.exportURL||"/info/transtaginfo/exportss"==this.mixinViewModuleOptions.exportURL)return t.ids=this.exportIds,"/info/taginfo/exports"==this.mixinViewModuleOptions.exportURL&&-1!=window.location.href.indexOf("/taginfo")&&(t.devtype=window.devTagType),this.$message.success(this.$t("exportData.exportSuccess")),this.postExcelFile(t,"".concat(window.SITE_CONFIG["apiURL"]).concat(this.mixinViewModuleOptions.exportURL));"/sys/log/login/export"!=this.mixinViewModuleOptions.exportURL&&"/sys/log/operation/export"!=this.mixinViewModuleOptions.exportURL&&"/sys/log/error/export"!=this.mixinViewModuleOptions.exportURL||(e=!0);var i=o.a.stringify(t);if(!e)return this.$message.info(this.$t("exportData.noExportData"));var a=this,n="".concat(window.SITE_CONFIG["apiURL"]).concat(this.mixinViewModuleOptions.exportURL,"?").concat(i),s=new XMLHttpRequest;s.open("get",n),s.responseType="blob",s.send(),s.onreadystatechange=function(){if(4==s.readyState&&200==s.status){var e=a.browserType();if("ie"!==e.browser||"10.0"!=e.version&&"11.0"!=e.version)if("chrome"===e.browser){window.URL.createObjectURL(this.response),t=document.createElement("iframe");t.src="".concat(window.SITE_CONFIG["apiURL"]).concat(a.mixinViewModuleOptions.exportURL,"?").concat(i),t.style.display="none",document.body.appendChild(t)}else window.location.href="".concat(window.SITE_CONFIG["apiURL"]).concat(a.mixinViewModuleOptions.exportURL,"?").concat(i);else{window.URL.createObjectURL(this.response);var t=document.createElement("iframe");t.src="".concat(window.SITE_CONFIG["apiURL"]).concat(a.mixinViewModuleOptions.exportURL,"?").concat(i),t.style.display="none",document.body.appendChild(t)}return a.$message.success(a.$t("exportData.exportSuccess"))}}}),1e3,{leading:!0,trailing:!1}),browserType:function(){var e=navigator.userAgent.toLowerCase(),t={ie:function(){return!(!window.ActiveXObject&&!("ActiveXObject"in window))},edge:function(){return/dge/.test(e)},chrome:function(){return/chrome/.test(e)},safari:function(){return/safari/.test(e)&&!/chrome/.test(e)},opera:function(){return/opera/.test(e)},msie:function(){return/msie/.test(e)&&!/opera/.test(e)},mozilla:function(){return/mozilla/.test(e)&&!/(compatible|webkit)/.test(e)}},i={};for(var a in t){var n=t[a](),r=(e.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1];if(n)return i.browser=a,i.version=r,i}}}}}}]);
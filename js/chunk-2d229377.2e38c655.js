(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d229377"],{dd01:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("section",[t("div",{attrs:{id:"transTagQueryContainer"}},[t("el-form",{attrs:{inline:!0,model:e.dataForm},nativeOn:{submit:function(e){e.preventDefault()},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.querySearch()}}},[t("el-form-item",{attrs:{label:e.$t("attribute.belongChannel")}},[t("el-select",{attrs:{size:"small",filterable:"",placeholder:e.$t("attribute.placeholderSelect")},on:{change:e.handleChannelChange},model:{value:e.dataForm.chlId,callback:function(t){e.$set(e.dataForm,"chlId",t)},expression:"dataForm.chlId"}},e._l(e.chlIdList,(function(a,i){return t("el-option",{key:i,attrs:{label:a.label,value:a.value}},[t("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center","max-width":"577px"}},[t("span",{style:{display:"inline-block",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis",minWidth:"160px"},attrs:{title:a.label}},[e._v(e._s(a.label))]),t("span",{staticStyle:{color:"#8492a6","font-size":"13px",display:"inline-block","margin-left":"20px","text-align":"right",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis","max-width":"200px"},attrs:{title:a.chlcomment}},[e._v("\n                                "+e._s(a.chlcomment)+"\n                            ")])])])})),1)],1),t("el-form-item",{attrs:{label:e.$t("attribute.devive")}},[t("el-select",{attrs:{size:"small",filterable:"",clearable:"",placeholder:e.$t("attribute.placeholderSelect")},on:{change:e.handleDevice},model:{value:e.dataForm.devname,callback:function(t){e.$set(e.dataForm,"devname",t)},expression:"dataForm.devname"}},e._l(e.devList,(function(a,i){return t("el-option",{key:i,attrs:{label:a.devName,value:a.devID}},[t("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center","max-width":"577px"}},[t("span",{style:{display:"inline-block",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis",minWidth:"160px"},attrs:{title:a.devName}},[e._v(e._s(a.devName))]),t("span",{staticStyle:{color:"#8492a6","font-size":"13px",display:"inline-block","margin-left":"20px","text-align":"right",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis","max-width":"200px"},attrs:{title:a.devComment}},[e._v("\n                                "+e._s(a.devComment)+"\n                            ")])])])})),1)],1),t("el-form-item",{attrs:{label:e.$t("attribute.alarmtype")}},[t("div",{staticStyle:{width:"150px"}},[t("el-select",{attrs:{size:"small",clearable:"",placeholder:e.$t("attribute.placeholderSelect")},on:{change:e.querySearch},model:{value:e.dataForm.alarmtype,callback:function(t){e.$set(e.dataForm,"alarmtype",t)},expression:"dataForm.alarmtype"}},e._l(e.alarmtypeList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),t("el-form-item",{attrs:{label:e.$t("attribute.transType")}},[t("el-select",{attrs:{size:"small",filterable:"",multiple:"","collapse-tags":"",clearable:"",placeholder:e.$t("attribute.placeholderSelect")},on:{change:e.handleFuncode},model:{value:e.dataForm.collecttypec,callback:function(t){e.$set(e.dataForm,"collecttypec",t)},expression:"dataForm.collecttypec"}},e._l(e.guidSelectList,(function(e){return t("el-option",{key:e.FuncCode,attrs:{label:e.description,value:e.FuncCode}})})),1)],1),t("el-form-item",[t("el-input",{attrs:{size:"small",placeholder:e.$t("formulacalculation.pleaseEnterTagnameOrDescription"),clearable:""},on:{clear:e.querySearch},model:{value:e.dataForm.tagname,callback:function(t){e.$set(e.dataForm,"tagname",t)},expression:"dataForm.tagname"}})],1),e.$hasPermission("transtaginfo:select:permission.do")?t("el-form-item",[t("el-button",{attrs:{size:"small",icon:"el-icon-search"},on:{click:function(t){return e.querySearch()}}},[e._v(e._s(e.$t("query")))])],1):e._e(),e.$hasPermission("transtaginfo:insert:permission.do")&&e.isShowSetting?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.addOrUpdate()}}},[e._v(e._s(e.$t("add"))+" ")])],1):e._e(),e.$hasPermission("transtaginfo:insert:permission.do")&&e.isShowSetting?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.addAll()}}},[e._v(e._s(e.$t("attribute.addMultipe"))+" ")])],1):e._e(),e.$hasPermission("transtaginfo:update:permission.do")&&e.isShowSetting?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-edit",disabled:0==e.tagIds.length||0===e.dataList.length},on:{click:function(t){return e.editAll()}}},[e._v(e._s(e.$t("attribute.editMultiple"))+" ")])],1):e._e(),e.$hasPermission("transtag:delete:permission.do")&&e.isShowSetting?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete",disabled:0==e.tagIds.length||0===e.dataList.length},on:{click:function(t){return e.deleteHandle()}}},[e._v(e._s(e.$t("deleteBatch"))+" ")])],1):e._e(),e.$hasPermission("transtaginfo:import:permission.do")&&e.isShowSetting?t("el-form-item",[t("el-upload",{staticClass:"upload-demo",attrs:{size:"small",disabled:e.importDisabled||e.noTag,action:"","on-change":e.handleChange,"http-request":e.uploadSectionFile,"on-remove":e.handleRemove,"file-list":e.fileList,limit:1,"before-upload":e.beforeUploadHandle,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel","show-file-list":!1}},[t("el-tooltip",{attrs:{content:e.$t("onlyXlsxFilesUploaded"),placement:"top"}},[t("el-button",{attrs:{size:"small",icon:"el-icon-upload",disabled:e.importDisabled||e.noTag,type:"primary"}},[e._v(e._s(e.$t("import")))])],1)],1)],1):e._e(),e.$hasPermission("transtaginfo:export:permission.do")&&e.isShowSetting?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-download",disabled:0==e.tagIds.length||0===e.dataList.length},on:{click:function(t){return e.handleExportTransTagsChange()}}},[e._v("\n                    "+e._s(e.$t("export"))+"\n                ")])],1):e._e(),e.$hasPermission("channelinfo:updateTagDevId:permission.do")&&e.isShowSetting?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-bangzhu"},on:{click:e.handleTagsToDeviceChange}},[e._v(e._s(e.$t("attribute.moveTheMeasuringPointToTheDevice")))])],1):e._e(),e.$hasPermission("transtaginfo:select:permission.do")?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"success"},on:{click:e.getDataList}},[t("i",{staticClass:"el-icon-refresh"})])],1):e._e()],1)],1),e.scrollTableHeight?t("div",[t("vxe-table",{ref:"recordTable",staticStyle:{width:"100%"},attrs:{size:"mini",border:"",resizable:"","show-overflow":"","show-header-overflow":"","highlight-hover-row":"","highlight-current-row":"","max-height":e.scrollTableHeight,loading:e.dataListLoading,"row-config":{keyField:"id"},"sort-config":e.sortConfig,"checkbox-config":e.checkboxConfig,"scroll-y":{enabled:!0}},on:{"checkbox-all":e.selectAll,"checkbox-change":e.dataListSelectionHandleChange,"sort-change":e.sortChange}},[t("vxe-table-column",{key:"1",attrs:{type:"checkbox","header-align":"center",align:"center",width:"60",fixed:"left",checked:!1}}),t("vxe-table-column",{key:"2",attrs:{field:"id",title:e.$t("measuringPointID"),"header-align":"center",align:"center",sortable:"",width:"90",fixed:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(t.row.transid)+"\n                ")]}}],null,!1,1813388202)}),t("vxe-table-column",{key:"3",attrs:{field:"tagname",title:e.$t("attribute.tagname"),"header-align":"center",align:"center",width:"260",fixed:"left","show-overflow-tooltip":!0}}),t("vxe-table-column",{key:"4",attrs:{field:"tagcomment",title:e.$t("attribute.modelattribute"),"header-align":"center",align:"center",width:"260","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.tagcomment||e.$t("attribute.noContent")))])]}}],null,!1,385731756)}),e.dataForm.devname?e._e():t("vxe-table-column",{key:"5",attrs:{field:"devid",title:e.$t("attribute.devive"),"header-align":"center",align:"center",width:"160","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(e.devDataMap[a.row.devid]))])]}}],null,!1,554329313)}),t("vxe-table-column",{key:"6",attrs:{field:"devnameO",title:e.$t("attribute.equipmentSource"),"header-align":"center",align:"center",width:"160","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.devnameO||"--"))])]}}],null,!1,3028272793)}),t("vxe-table-column",{key:"7",attrs:{field:"k",title:e.$t("attribute.tagkk"),"header-align":"center",align:"center",width:"120"}}),t("vxe-table-column",{key:"8",attrs:{field:"tp",title:e.$t("attribute.alarmtype"),"header-align":"center",align:"center",width:"100",formatter:e.formatterAlarmtype}}),t("vxe-table-column",{key:"9",attrs:{field:"collDescript",title:e.$t("attribute.transCollecttypec"),"header-align":"center",align:"center",width:"200",formatter:e.formatterCollecttypec,"show-overflow-tooltip":!0}}),t("vxe-table-column",{key:"10",attrs:{field:"objaddr",title:e.$t("attribute.registerAddress"),"header-align":"center",align:"center",width:"180",sortable:"","show-overflow-tooltip":!0}}),t("vxe-table-column",{key:"11",attrs:{field:"datatype",title:e.$t("attribute.datatype"),"header-align":"center",align:"center",width:e.dataForm.devname?180:160,formatter:e.formatterDatatype}}),t("vxe-table-column",{key:"12",attrs:{field:"dataformat",title:e.$t("attribute.dataformat"),"header-align":"center",align:"center",width:e.dataForm.devname?180:120,formatter:e.formatterDataformat}}),(e.$hasPermission("transtaginfo:update:permission.do")||e.$hasPermission("transtag:delete:permission.do"))&&e.isShowSetting?t("vxe-table-column",{key:"13",attrs:{title:e.$t("handle"),"header-align":"center",align:"center",width:"120",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[e.$hasPermission("transtaginfo:update:permission.do")?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.addOrUpdate(a.row)}}},[e._v(e._s(e.$t("update"))+" ")]):e._e(),e.$hasPermission("transtag:delete:permission.do")?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.deleteHandle(a.row.id)}}},[e._v(e._s(e.$t("delete"))+" ")]):e._e()]}}],null,!1,2985308583)}):e._e()],1),t("vxe-pager",{attrs:{perfect:"",size:"mini",loading:e.pagerLoading,"current-page":e.page,"page-size":e.limit,"page-sizes":[100,200,500,1e3,2e3,5e3,1e4],total:e.total,layouts:["PrevPage","JumpNumber","NextPage","FullJump","Sizes","Total"]},on:{"page-change":e.handlePageChange}})],1):e._e(),e.addOrUpdateVisible?t("add-or-update",{ref:"addOrUpdate",attrs:{queryParams:e.queryParams},on:{refreshDataList:e.getDataList}}):e._e(),e.addallVisible?t("Addall",{ref:"addTagAll",attrs:{queryParams:e.queryParams},on:{refreshDataList:e.getDataList}}):e._e(),t("el-dialog",{attrs:{title:e.$t("attribute.editMultiple"),"close-on-click-modal":!1,"close-on-press-escape":!1,visible:e.editAllVisible},on:{"update:visible":function(t){e.editAllVisible=t}}},[t("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.rules,"label-width":(e.$i18n.locale,"120px")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dataFormSubmitHandle()}}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.editType"),prop:"type"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("attribute.placeholderSelect"),filterable:""},on:{change:e.selectChanged},model:{value:e.editForm.type,callback:function(t){e.$set(e.editForm,"type",t)},expression:"editForm.type"}},e._l(e.editTypeLists,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),"k"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.smartConversion")}},[t("el-switch",{model:{value:e.editForm.smartTransform,callback:function(t){e.$set(e.editForm,"smartTransform",t)},expression:"editForm.smartTransform"}}),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("attribute.smartConversionTip"),placement:"top-start"}},[t("i",{staticClass:"el-icon-question",staticStyle:{"margin-left":"5px"}})])],1)],1):e._e(),"k"==e.editForm.type&&e.editForm.smartTransform?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.dataSourceConversionList")}},[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:e.handleAddSmartTransDataChange}},[e._v(e._s(e.$t("attribute.addTo")))]),t("el-button",{attrs:{size:"small",icon:"el-icon-refresh-left"},on:{click:e.handleResetSmartTransDataChange}},[e._v(e._s(e.$t("attribute.restoreDefaultSettings")))])],1)],1):e._e(),"k"==e.editForm.type&&e.editForm.smartTransform?t("el-col",{attrs:{span:24}},[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",size:"small",data:e.editForm.smartTransformTableData,"max-height":300}},[t("el-table-column",{attrs:{type:"index",fixed:"left",width:"60",label:e.$t("attribute.number"),align:"center"}}),t("el-table-column",{attrs:{prop:"sourceK",label:e.$t("attribute.sourceCoefficient"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{size:"small",clearable:"",placeholder:e.$t("attribute.pleaseEnterTheSourceCoefficient")},model:{value:a.row.sourceK,callback:function(t){e.$set(a.row,"sourceK",t)},expression:"scope.row.sourceK"}})]}}],null,!1,2012649611)}),t("el-table-column",{attrs:{prop:"targetK",label:e.$t("attribute.targetCoefficient"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{size:"small",clearable:"",placeholder:e.$t("attribute.pleaseEnterTheTargetCoefficient")},model:{value:a.row.targetK,callback:function(t){e.$set(a.row,"targetK",t)},expression:"scope.row.targetK"}})]}}],null,!1,1408891147)}),t("el-table-column",{attrs:{fixed:"right",label:e.$t("handle"),width:"60",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleDeleteSmartTransDataChange(a.$index)}}},[e._v(e._s(e.$t("delete")))])]}}],null,!1,3290636014)})],1)],1):e._e(),"k"!=e.editForm.type||e.editForm.smartTransform?e._e():t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.editValue"),prop:"value"}},[t("el-input",{attrs:{placeholder:e.$t("attribute.editValue")},model:{value:e.editForm.value,callback:function(t){e.$set(e.editForm,"value",t)},expression:"editForm.value"}})],1)],1),"dataformat"==e.editForm.type||"datatype"==e.editForm.type||"tagrwprop"==e.editForm.type||"alarmtype"==e.editForm.type||"collecttypec"===e.editForm.type||"enablealarm"===e.editForm.type||"enablehissave"===e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.editValue"),prop:"changeValue",rules:"dataformat"===this.editForm.type||"datatype"===this.editForm.type||"alarmtype"===this.editForm.type||"tagrwprop"===this.editForm.type||"collecttypec"===this.editForm.type||"enablealarm"===this.editForm.type||"enablehissave"===this.editForm.type?e.rules.changeValue:[{required:!1,message:e.$t("attribute.requireNotNull"),trigger:"change"}]}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("attribute.placeholderSelect"),filterable:""},model:{value:e.editForm.changeValue,callback:function(t){e.$set(e.editForm,"changeValue",t)},expression:"editForm.changeValue"}},e._l(e.changeList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1):e._e(),"objaddr"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.editWay"),prop:"objaddrWay",rules:"objaddr"===this.editForm.type?e.rules.objaddrWay:[{required:!1,message:e.$t("attribute.requireNotNull"),trigger:"change"}]}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("attribute.placeholderSelect"),filterable:""},model:{value:e.editForm.objaddrWay,callback:function(t){e.$set(e.editForm,"objaddrWay",t)},expression:"editForm.objaddrWay"}},e._l(e.objaddrTypeList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1)],1):e._e(),"tagname"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.editWay"),prop:"way"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("attribute.placeholderSelect")},model:{value:e.editForm.way,callback:function(t){e.$set(e.editForm,"way",t)},expression:"editForm.way"}},e._l(e.wayLists,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1):e._e(),"tagcomment"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.startValue"),prop:"tagcomment"}},[t("el-input",{attrs:{placeholder:e.$t("attribute.editValue")},model:{value:e.editForm.tagcomment,callback:function(t){e.$set(e.editForm,"tagcomment",t)},expression:"editForm.tagcomment"}})],1)],1):e._e()],1),t("el-row",["objaddr"==e.editForm.type&&"step"==e.editForm.objaddrWay?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.startValue"),prop:"startValue",rules:"objaddr"===this.editForm.type?e.rules.startValue:[{required:!1,message:e.$t("attribute.requireNotNull"),trigger:"change"}]}},[t("el-input",{attrs:{placeholder:e.$t("attribute.placeholderSelect")},model:{value:e.editForm.startValue,callback:function(t){e.$set(e.editForm,"startValue",t)},expression:"editForm.startValue"}})],1)],1):e._e(),"objaddr"==e.editForm.type&&"step"==e.editForm.objaddrWay?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.step"),prop:"step",rules:"objaddr"===this.editForm.type?e.rules.step:[{required:!1,message:e.$t("attribute.requireNotNull"),trigger:"change"}]}},[t("el-input",{attrs:{placeholder:e.$t("attribute.step")},model:{value:e.editForm.step,callback:function(t){e.$set(e.editForm,"step",t)},expression:"editForm.step"}})],1)],1):e._e(),"objaddr"==e.editForm.type&&"fixed"==e.editForm.objaddrWay?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.fixedValue"),prop:"fixedValue",rules:"objaddr"===this.editForm.type&&"fixed"==e.editForm.objaddrWay?e.rules.fixedValue:[{required:!1,message:e.$t("attribute.requireNotNull"),trigger:"change"}]}},[t("el-input",{attrs:{placeholder:e.$t("attribute.fixedValuePlaceholder")},model:{value:e.editForm.fixedValue,callback:function(t){e.$set(e.editForm,"fixedValue",t)},expression:"editForm.fixedValue"}})],1)],1):e._e()],1),t("el-row",["tagname"==e.editForm.type&&"replace"==e.editForm.way?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.replaceSource"),prop:"replaceStr",rules:"tagname"===this.editForm.type&&"replace"==e.editForm.way?e.rules.replaceStr:[{required:!1,message:e.$t("attribute.requireNotNull"),trigger:"change"}]}},[t("el-input",{attrs:{placeholder:e.$t("attribute.enterReplaceSource")},model:{value:e.editForm.replaceStr,callback:function(t){e.$set(e.editForm,"replaceStr",t)},expression:"editForm.replaceStr"}})],1)],1):e._e(),"tagname"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.editValue")}},[t("el-input",{attrs:{placeholder:"replace"==e.editForm.way?e.$t("attribute.replaceName"):"prepend"==e.editForm.way?e.$t("attribute.replacePrependName"):e.$t("attribute.replaceAppendName")},model:{value:e.editForm.tagnameStr,callback:function(t){e.$set(e.editForm,"tagnameStr",t)},expression:"editForm.tagnameStr"}})],1)],1):e._e(),"tagcomment"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.step"),prop:"tagcommentStep"}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{"step-strictly":"","controls-position":"right",placeholder:e.$t("attribute.pleaseEnterTheStepSize")},model:{value:e.editForm.tagcommentStep,callback:function(t){e.$set(e.editForm,"tagcommentStep",t)},expression:"editForm.tagcommentStep"}})],1)],1):e._e()],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:function(t){e.editAllVisible=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmitHandle()}}},[e._v(e._s(e.$t("confirm")))])],1)],2),t("el-dialog",{attrs:{title:e.$t("attribute.devive"),"close-on-click-modal":!1,"close-on-press-escape":!1,visible:e.tagVisible,"before-close":e.handleCancel},on:{"update:visible":function(t){e.tagVisible=t}}},[t("el-form",{ref:"importForm",attrs:{model:e.importForm,rules:e.rules,"label-width":(e.$i18n.locale,"120px")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.tagListConfirm()}}},[t("el-tree",{ref:"tree",attrs:{data:e.dataTree,"show-checkbox":"","node-key":"id","default-expand-all":""},on:{check:e.handleCheckChange}})],1),t("template",{slot:"footer"},[t("el-button",{on:{click:e.handleCancel}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.tagListConfirm()}}},[e._v(e._s(e.$t("confirm")))])],1)],2),t("el-dialog",{attrs:{visible:e.mergeTagsToDeviceVisible,title:e.$t("attribute.moveTheMeasuringPointToTheDevice"),"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":e.handleMergeTagsToDeviceClose},on:{"update:visible":function(t){e.mergeTagsToDeviceVisible=t}}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.mergeTagsToDeviceFormloading,expression:"mergeTagsToDeviceFormloading"}],ref:"mergeTagsToDeviceForm",attrs:{model:e.mergeTagsToDeviceForm,rules:e.mergeTagsToDeviceRules,"label-width":(e.$i18n.locale,"120px")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleMergeTagsToDeviceSubmit()}}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("deviceInfo.targetDevice"),prop:"devId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("select")},on:{change:e.hanleMergeDevIdChanage},model:{value:e.mergeTagsToDeviceForm.devId,callback:function(t){e.$set(e.mergeTagsToDeviceForm,"devId",t)},expression:"mergeTagsToDeviceForm.devId"}},e._l(e.mergeTargetDeviceList,(function(a){return t("el-option",{key:a.devID,attrs:{label:a.devName,value:a.devID}},[t("span",{staticStyle:{width:"50%",display:"inline-block","text-align":"left",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:a.devName}},[e._v(e._s(a.devName))]),t("span",{staticStyle:{color:"#8492a6","font-size":"13px",display:"inline-block","margin-left":"2%",width:"48%","text-align":"right",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:a.devComment}},[e._v(e._s(a.devComment))])])})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.measurementPointToBeMoved"),prop:"tagIds"}},[t("el-select",{directives:[{name:"el-select-loadmore",rawName:"v-el-select-loadmore:rangeNumber",value:e.loadMore(e.rangeNumber),expression:"loadMore(rangeNumber)",arg:"rangeNumber"}],staticStyle:{width:"100%"},attrs:{multiple:"","collapse-tags":"",placeholder:e.$t("select")},on:{"visible-change":e.handleTagNameOrVisibleChange,change:e.handleMergeTagNameOrDescChange},model:{value:e.mergeTagsToDeviceForm.tagIds,callback:function(t){e.$set(e.mergeTagsToDeviceForm,"tagIds",t)},expression:"mergeTagsToDeviceForm.tagIds"}},[[t("el-input",{ref:"tagNameOrDescInput",staticStyle:{width:"98%",position:"absolute",left:"1%",top:"0","z-index":"99"},attrs:{size:"small",clearable:"",placeholder:e.$t("integralmodule.pleaseEnterSearchContent")},model:{value:e.tagNameOrDescSearch,callback:function(t){e.tagNameOrDescSearch=t},expression:"tagNameOrDescSearch"}}),t("div",{staticStyle:{width:"100%",height:"32px"}}),e.mergeTagsList.length>0?t("el-option",{attrs:{label:e.$t("all"),value:"all"},nativeOn:{click:function(t){return e.selectAllPrepareTag.apply(null,arguments)}}}):e._e(),e._l(e.showMergeTagsList.slice(0,e.rangeNumber),(function(a){return t("el-option",{key:a.transID,attrs:{label:a.tagName,value:a.transID}},[a.tagComment?t("div",[t("span",{staticStyle:{width:"50%",display:"inline-block","text-align":"left",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:a.tagName}},[e._v(e._s(a.tagName))]),t("span",{staticStyle:{color:"#8492a6","font-size":"13px",display:"inline-block","margin-left":"2%",width:"48%","text-align":"right",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:a.tagComment}},[e._v(e._s(a.tagComment))])]):t("div",[t("span",{staticStyle:{width:"92%",display:"inline-block","text-align":"left",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:a.tagName}},[e._v(e._s(a.tagName))]),t("span",{staticStyle:{color:"#8492a6","font-size":"13px",display:"inline-block","margin-left":"2%","margin-right":"2%",width:"4%","text-align":"right",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},[e._v(e._s(e.$t("none")))])])])}))]],2)],1)],1)],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:e.handleMergeTagsToDeviceClose}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleMergeTagsToDeviceSubmit()}}},[e._v(e._s(e.$t("confirm")))])],1)],2)],1)},r=[],s=(a("ac4d"),a("8a81"),a("5df3"),a("1c4c"),a("6b54"),a("20d6"),a("2909")),n=(a("6762"),a("2fdb"),a("96cf"),a("1da1")),o=(a("3b2b"),a("7f7f"),a("f576"),a("f559"),a("4917"),a("28a5"),a("7514"),a("c5f6"),a("ac6a"),a("55dd"),a("a481"),a("4328")),l=a.n(o),d=a("2b0e"),c=a("bc3a"),g=a.n(c),m=a("a78e"),h=a.n(m),u=a("b047"),p=a.n(u),f=a("52dc"),b=a("25c7");function v(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=$(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,n=!0,o=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return n=e.done,e},e:function(e){o=!0,s=e},f:function(){try{n||null==a.return||a.return()}finally{if(o)throw s}}}}function $(e,t){if(e){if("string"==typeof e)return y(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?y(e,t):void 0}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,i=Array(t);a<t;a++)i[a]=e[a];return i}d["default"].directive("el-select-loadmore",{bind:function(e,t){var a=e.querySelector(".el-select-dropdown .el-select-dropdown__wrap");a.addEventListener("scroll",(function(){var e=this.scrollHeight-this.scrollTop<=this.clientHeight;e&&t.value()}))}});var w={name:"transtaginfo",data:function(){var e=this;return{isShowSetting:!1,pagerLoading:!1,sortConfig:{defaultSort:{field:"objaddr",order:"asc"},remote:!0},checkboxConfig:{checkStrictly:!1,reserve:!0,highlight:!0,checkField:"checked"},currentPageCheccked:!1,multipleSelectionAll:[],scrollTableHeight:0,page:1,limit:1e3,total:0,dataListLoading:!1,addOrUpdateVisible:!1,nodevice:!1,allCheck:!1,addDisabled:!1,noTag:!1,importDisabled:!1,dataList:[],chlIdList:[],devList:[],devDataMap:{},guidList:[],fileList:[],file:null,fileParams:null,dataTree:[],guidSelectList:[],selectFuncCode:[],selectedTagIdAndObjAddrList:[],tagIds:[],sname:"objaddr",sort:"asc",scrollleft:0,scorlltop:0,queryParams:{},tagVisible:!1,addallVisible:!1,editAllVisible:!1,importForm:{deviceId:null},datatypeList:[{label:this.$t("attribute.all"),value:""},{label:this.$t("attribute.bit"),value:0},{label:this.$t("attribute.eightNoSymbol"),value:1},{label:this.$t("attribute.eightSymbol"),value:2},{label:this.$t("attribute.sixteenNoSymbol"),value:3},{label:this.$t("attribute.sixteenSymbol"),value:4},{label:this.$t("attribute.twentyFourNoSymbol"),value:14},{label:this.$t("attribute.twentyFourSymbol"),value:15},{label:this.$t("attribute.thirtySecondNoSymbol"),value:5},{label:this.$t("attribute.thirtySecondSymbol"),value:6},{label:this.$t("attribute.sixteenBCD"),value:7},{label:this.$t("attribute.thirtySecondBCD"),value:8},{label:this.$t("attribute.singleFloat"),value:9},{label:this.$t("attribute.doubleFloat"),value:10},{label:this.$t("attribute.string"),value:11}],alarmtypeList:[{label:this.$t("attribute.all"),value:""},{label:this.$t("attribute.visualValue"),value:0},{label:this.$t("attribute.switchValue"),value:1},{label:this.$t("attribute.ym"),value:2},{label:this.$t("attribute.yk"),value:3},{label:this.$t("attribute.yt"),value:4}],dataForm:{chlId:"",devname:"",alarmtype:"",tagname:"",collecttypec:[]},editForm:{type:"objaddr",objaddrWay:"step",fixedValue:"",value:"1.0",startValue:0,step:1,changeValue:"",way:"replace",replaceStr:"",tagnameStr:"",tagcomment:"",tagcommentStep:1,smartTransform:!1,smartTransformTableData:[{sourceK:.1,targetK:10},{sourceK:.01,targetK:100},{sourceK:.001,targetK:1e3}]},tagIdNameList:[],tagIdKList:[],tagIdCommentList:[],wayLists:[{label:this.$t("attribute.replace"),value:"replace"},{label:this.$t("attribute.prepend"),value:"prepend"},{label:this.$t("attribute.append"),value:"append"}],objaddrTypeList:[{label:this.$t("attribute.step"),value:"step"},{label:this.$t("attribute.tagb"),value:"fixed"},{label:this.$t("attribute.clipboardSource"),value:"clipboardSource"}],editTypeLists:[],dataType:[{label:this.$t("attribute.bit"),value:0},{label:this.$t("attribute.eightNoSymbol"),value:1},{label:this.$t("attribute.eightSymbol"),value:2},{label:this.$t("attribute.sixteenNoSymbol"),value:3},{label:this.$t("attribute.sixteenSymbol"),value:4},{label:this.$t("attribute.thirtySecondNoSymbol"),value:5},{label:this.$t("attribute.thirtySecondSymbol"),value:6},{label:this.$t("attribute.sixteenBCD"),value:7},{label:this.$t("attribute.thirtySecondBCD"),value:8},{label:this.$t("attribute.singleFloat"),value:9},{label:this.$t("attribute.doubleFloat"),value:10},{label:this.$t("attribute.string"),value:11}],hiloType:[{label:"12",value:0},{label:"21",value:1},{label:"1234",value:2},{label:"2143",value:3},{label:"3412",value:4},{label:"4321",value:5}],collecttypecList:[],rules:{type:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],replaceStr:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],tagnameStr:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],tagcomment:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],value:[{required:!0,message:this.$t("validate.required"),trigger:"change"},{validator:function(t,a,i){if(a){var r=/^[-]?[0-9]+(\.[0-9]+)?$/;r.test(a)?i():i(new Error(e.$t("debuggerInfo.enterNumber")))}},trigger:"change"}],startValue:[{required:!0,message:this.$t("validate.required"),trigger:"change"},{validator:function(t,a,i){if(String(a)){var r=/[-]?[0-9]$/;r.test(a)?i():i(new Error(e.$t("chlwatch.pleaseEnterIntNumber")))}},trigger:"change"}],step:[{required:!0,message:this.$t("validate.required"),trigger:"change"},{validator:function(t,a,i){if(a){var r=/^[-]?[0-9]\d*$/;r.test(a)?i():i(new Error(e.$t("chlwatch.pleaseEnterIntNumber")))}},trigger:"change"}],objaddrWay:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],fixedValue:[{required:!0,message:this.$t("validate.required"),trigger:"change"},{validator:function(t,a,i){if(a){var r=/^[-]?[0-9]+(\.[0-9]+)?$/;r.test(a)?i():i(new Error(e.$t("debuggerInfo.enterNumber")))}},trigger:"change"}],changeValue:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]},rangeNumber:300,tagNameOrDescSearch:"",showMergeTagsList:[],mergeTagsList:[],mergeTagIdList:[],mergeTargetDeviceList:[],mergeTagsToDeviceVisible:!1,mergeTagsToDeviceFormloading:!1,mergeTagsToDeviceForm:{devId:"",tagIds:[]},mergeTagsToDeviceRules:{devId:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],tagIds:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]}}},components:{AddOrUpdate:f["default"],Addall:b["default"]},methods:{querySearch:function(){var e=this;this.$hasSessionStorageGwsn()?(this.page=1,this.getDataList()):this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},sortChange:function(e){e.column;var t=e.property,a=e.order;a&&(this.sname="transid"==t?"id":t,this.sort=a,this.getDataList())},compareBySort:function(e,t){return e.sort((function(e,a){return e[t]-a[t]}))},getDevlist:function(){var e=this,t=[],a={gwsn:sessionStorage.getItem("gwsn")};if(e.$hasSessionStorageGwsn()){if(e.chlIdList=[],e.devList=[],e.devDataMap={},!e.$hasPermission("list:getChlList:select:permission.do"))return void this.$message.warning("暂无通道、设备查询权限, 请联系管理员");e.$http.get("/list/getChlList.do",{params:a}).then((function(a){var i=a.data;if(0!=i.code)return e.$message.error(i.data||i.msg);if(!(i.data.length>0))return e.nodevice=!0,e.importDisabled=!0,e.tagIdNameList=[],e.tagIdKList=[],e.tagIdCommentList=[],e.mergeTagIdList=[],e.$message.warning(e.$t("attribute.noForwardingChannel"));if(i.data.forEach((function(t){1==t.chlType&&e.chlIdList.push({label:t.chlName,value:t.chlID,chlcomment:t.chlComment,chlProtocol:t.chlProtocol,dev2PojoList:t.dev2PojoList})})),!(e.chlIdList.length>0))return e.nodevice=!0,e.importDisabled=!0,e.tagIdNameList=[],e.tagIdKList=[],e.tagIdCommentList=[],e.mergeTagIdList=[],e.$message.warning(e.$t("attribute.noForwardingChannel"));if(e.queryParams.chlId)e.nodevice=!1,e.dataForm.chlId=Number(e.queryParams.chlId),e.getFuncodeList(e.queryParams.chlId),e.chlIdList.forEach((function(a){e.dataForm.chlId==a.value&&(t=e.compareBySort(a.dev2PojoList,"devID"),e.devList=a.dev2PojoList.length>0?[{devName:e.$t("all"),devID:"",devComment:""}].concat(t):[],t.forEach((function(t){e.devDataMap[t.devID]=t.devName})),e.dataForm.devname=Number(e.queryParams.devId),e.getDataList())}));else{if(e.dataForm.chlId=e.chlIdList[0].value,e.getFuncodeList(e.chlIdList[0].value),t=e.compareBySort(e.chlIdList[0].dev2PojoList,"devID"),e.devList=e.chlIdList[0].dev2PojoList.length>0?[{devName:e.$t("all"),devID:"",devComment:""}].concat(t):[],t.forEach((function(t){e.devDataMap[t.devID]=t.devName})),!(e.devList.length>0))return e.nodevice=!0,e.importDisabled=!0,e.tagIdNameList=[],e.tagIdKList=[],e.tagIdCommentList=[],e.mergeTagIdList=[],e.$message.warning(e.$t("attribute.noForwardingDevice"));e.nodevice=!1,e.importDisabled=!1,e.dataForm.devname=e.devList[1].devID,e.getDataList()}})).catch((function(t){return e.nodevice=!0,e.importDisabled=!0,!1}))}else e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},handleChannelChange:function(e){var t=this,a=this.chlIdList.find((function(t){return t.value==e})).dev2PojoList;this.devList=a.length>0?[{devName:this.$t("attribute.all"),devID:"",devComment:""}].concat(this.compareBySort(a,"devID")):[],this.devList.length>0?(this.nodevice=!1,this.importDisabled=!1,a.forEach((function(e){t.devDataMap[e.devID]=e.devName})),this.dataForm.devname=this.devList[1].devID,this.getFuncodeList(e)):(this.nodevice=!0,this.importDisabled=!0,this.dataForm.devname=null,this.getFuncodeList(e))},handleDevice:function(e){this.querySearch()},getFuncodeList:function(e){var t=this;if(t.$hasSessionStorageGwsn()){if(!t.$hasPermission("channelinfo:info:select:permission.do"))return void t.$message.warning("暂无通道信息查询权限, 请联系管理员");t.$http.get("/info/channelinfo/getByChliId",{params:{chlid:e,gwsn:sessionStorage.getItem("gwsn")}}).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.$hasPermission("protocolinfo:select:permission.do")?t.$http.get("/info/protocolinfo/proguid",{params:{guid:a.data[0].chlprotocol}}).then((function(e){var a=e.data;t.guidSelectList=JSON.parse(a.data[0].funccode).data,t.getDataList()})).catch((function(e){return!1})):t.$message.warning("暂无协议信息查询权限, 请联系管理员")})).catch((function(e){return!1}))}else t.$message({showClose:!1,message:t.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}})},handleFuncode:function(e){this.selectFuncCode=e,this.querySearch()},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.page=t,this.limit=a,sessionStorage.setItem("limit5",this.limit),sessionStorage.setItem("page5",this.page),this.getDataList()},getDataList:p()((function(){var e=this;if(this.$hasSessionStorageGwsn()){var t={page:this.page,limit:this.limit,sort:"objaddr"==this.sname?"a."+this.sname+"+0 "+this.sort:this.sname+" "+this.sort,tagchlid:this.dataForm.chlId,alarmtype:this.dataForm.alarmtype,gwsn:sessionStorage.getItem("gwsn")};if(this.dataForm.devname&&(t["deviceid"]=this.dataForm.devname),this.dataForm.collecttypec.length>0&&(t["collecttypec"]=this.dataForm.collecttypec.join(",")),this.dataForm.tagname&&(t["sname"]=this.dataForm.tagname.replace(/_/g,"\\_").replace(/%/g,"\\%")),this.total=0,this.dataList=[],!this.$hasPermission("transtaginfo:select:permission.do"))return void this.$message.warning("暂无转发测点查询权限, 请联系管理员");this.dataListLoading=!0,this.pagerLoading=!0,this.$http.get("/info/transtaginfo/selectTransTags.do",{params:t}).then((function(a){var i=a.data;e.page=t.page,0!=i.code?e.$refs.recordTable&&e.$refs.recordTable.loadData([]).then((function(){e.dataListLoading=!1,e.pagerLoading=!1})).finally((function(){return e.$message.error(i.data||i.msg)})):(e.dataList=i.data.rows||[],e.$refs.recordTable&&(e.$refs.recordTable.clearCheckboxRow(),e.$refs.recordTable.loadData(e.dataList).then((function(){e.dataListLoading=!1,e.pagerLoading=!1,e.total=Number(i.data.total)||0})).finally((function(){if(e.dataList.length>0){if(e.isAddOrUpdate?e.$refs.recordTable.scrollTo(e.scrollleft,e.scorlltop):e.$refs.recordTable.scrollTo(0,0),e.currentPageCheccked&&!e.allCheck&&(e.$set(e.checkboxConfig,"checkStrictly",!1),e.$refs.recordTable.setAllCheckboxRow(!1),e.tagIds=[],e.tagIdNameList=[],e.tagIdKList=[],e.tagIdCommentList=[],e.mergeTagIdList=[],e.multipleSelectionAll=[],e.selectedTagIdAndObjAddrList=[],e.dataList.forEach((function(t){var a={id:t.id,name:t.tagname},i={id:t.id,k:t.k},r={id:t.id,objaddr:t.objaddr},s={id:t.id,tagcomment:t.tagcomment};e.tagIds.push(t.id),e.mergeTagIdList.push(t.transid),e.tagIdNameList.push(a),e.tagIdKList.push(i),e.tagIdCommentList.push(s),e.multipleSelectionAll.push(t.id),e.selectedTagIdAndObjAddrList.push(r)})),e.$refs.recordTable.setAllCheckboxRow(!0)),!e.currentPageCheccked&&!e.allCheck)if(e.multipleSelectionAll.length>0){e.$set(e.checkboxConfig,"checkStrictly",!1),e.$refs.recordTable.setAllCheckboxRow(!1),e.tagIds=[],e.tagIdNameList=[],e.tagIdKList=[],e.tagIdCommentList=[],e.mergeTagIdList=[],e.selectedTagIdAndObjAddrList=[];var t=!1;e.dataList.forEach((function(t){var a=e.multipleSelectionAll.length>0&&-1!==e.multipleSelectionAll.indexOf(t.id);if(a){var i={id:t.id,name:t.tagname},r={id:t.id,k:t.k},s={id:t.id,objaddr:t.objaddr},n={id:t.id,tagcomment:t.tagcomment};e.tagIds.push(t.id),e.mergeTagIdList.push(t.transid),e.tagIdNameList.push(i),e.tagIdKList.push(r),e.tagIdCommentList.push(n),e.selectedTagIdAndObjAddrList.push(s)}})),e.multipleSelectionAll.forEach((function(a){e.dataList.forEach((function(i){i.id==a&&(t=!0,e.$refs.recordTable.setCheckboxRow(i,!0))}))})),t||(e.tagIds=[],e.tagIdNameList=[],e.tagIdKList=[],e.tagIdCommentList=[],e.mergeTagIdList=[],e.multipleSelectionAll=[],e.selectedTagIdAndObjAddrList=[])}else e.$set(e.checkboxConfig,"checkStrictly",!1),e.$refs.recordTable.setAllCheckboxRow(!1);e.allCheck&&(e.$set(e.checkboxConfig,"checkStrictly",!1),e.$refs.recordTable.setAllCheckboxRow(!0),e.$set(e.checkboxConfig,"checkStrictly",!0),e.getAllChecked())}}))))})).catch((function(t){return e.dataListLoading=!1,!1}))}else _this.$message({showClose:!1,message:_this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),_this.$router.replace({path:"/tgw-tgwinfo"})}})}),100,{leading:!0,trailing:!1}),formatterAlarmtype:function(e){var t=e.row;e.column;return 0===t.tp?this.$t("attribute.visualValue"):1===t.tp?this.$t("attribute.switchValue"):2===t.tp?this.$t("attribute.ym"):3===t.tp?this.$t("attribute.yk"):4===t.tp?this.$t("attribute.yt"):""},formatterCollecttypec:function(e){var t=e.row;e.column;if(!t.collDescript)return"";if(-1==t.collDescript.indexOf("("))return t.collDescript;var a=t.collDescript.indexOf("(");if(a>0){var i=t.collDescript.substring(0,a);return i}},getDescription:function(e,t){for(var a=0;a<this.guidList.length;a++){var i=this.guidList[a];if(i.guid==e){var r,s=JSON.parse(i.funccode).data,n=v(s);try{for(n.s();!(r=n.n()).done;){var o=r.value;if(o.FuncCode===t)return-1!=o.description.indexOf("(")?o.description.split("(")[0]:o.description}}catch(l){n.e(l)}finally{n.f()}break}}},formatterDatatype:function(e){var t=e.row;e.column;return 0===t.datatype?this.$t("attribute.bit"):1===t.datatype?this.$t("attribute.eightNoSymbol"):2===t.datatype?this.$t("attribute.eightSymbol"):3===t.datatype?this.$t("attribute.sixteenNoSymbol"):4===t.datatype?this.$t("attribute.sixteenSymbol"):14===t.datatype?this.$t("attribute.twentyFourNoSymbol"):15===t.datatype?this.$t("attribute.twentyFourSymbol"):5===t.datatype?this.$t("attribute.thirtySecondNoSymbol"):6===t.datatype?this.$t("attribute.thirtySecondSymbol"):7===t.datatype?this.$t("attribute.sixteenBCD"):8===t.datatype?this.$t("attribute.thirtySecondBCD"):9===t.datatype?this.$t("attribute.singleFloat"):10===t.datatype?this.$t("attribute.doubleFloat"):11===t.datatype?this.$t("attribute.string"):12===t.datatype?this.$t("attribute.sixtyFourUnsigned"):13===t.datatype?this.$t("attribute.sixtyFourSigned"):""},formatterDataformat:function(e){var t=e.row;e.column;return 0===t.dataformat?"12":1===t.dataformat?"21":2===t.dataformat?"1234":3===t.dataformat?"2143":4===t.dataformat?"3412":"4321"},selectAll:function(e){var t=this;this.tagIds=[],this.tagIdNameList=[],this.tagIdKList=[],this.tagIdCommentList=[],this.mergeTagIdList=[],this.multipleSelectionAll=[],this.selectedTagIdAndObjAddrList=[],e.records.length>0?(this.currentPageCheccked=!0,e.records.forEach((function(e){var a={id:e.id,name:e.tagname},i={id:e.id,k:e.k},r={id:e.id,objaddr:e.objaddr},s={id:e.id,tagcomment:e.tagcomment};t.tagIds.push(e.id),t.mergeTagIdList.push(e.transid),t.tagIdNameList.push(a),t.tagIdKList.push(i),t.tagIdCommentList.push(s),t.multipleSelectionAll.push(e.id),t.selectedTagIdAndObjAddrList.push(r)}))):this.currentPageCheccked=!1},dataListSelectionHandleChange:function(e){var t=this;this.tagIds=[],this.tagIdNameList=[],this.tagIdKList=[],this.tagIdCommentList=[],this.mergeTagIdList=[],this.multipleSelectionAll=[],this.selectedTagIdAndObjAddrList=[],e.records.length>0&&e.records.forEach((function(e){var a={id:e.id,name:e.tagname},i={id:e.id,k:e.k},r={id:e.id,objaddr:e.objaddr},s={id:e.id,tagcomment:e.tagcomment};t.tagIds.push(e.id),t.mergeTagIdList.push(e.transid),t.tagIdNameList.push(a),t.tagIdKList.push(i),t.tagIdCommentList.push(s),t.multipleSelectionAll.push(e.id),t.selectedTagIdAndObjAddrList.push(r)})),this.allCheck&&!e.checked&&this.$refs.recordTable&&this.$refs.recordTable.setCheckboxRow(this.$refs.recordTable.getRowById(e.row.id),!0)},reduceSame:function(e){var t={};return e.reduce((function(e,a){return!t[a.id]&&(t[a.id]=e.push(a)),e}),[])},allCheckEvent:function(){var e=this;e.allCheck?(e.$refs.recordTable&&e.$refs.recordTable.setAllCheckboxRow(!0),e.$set(this.checkboxConfig,"checkStrictly",!0),e.getAllChecked()):(e.tagIds=[],e.multipleSelectionAll=[],e.tagIdNameList=[],e.tagIdKList=[],e.tagIdCommentList=[],e.mergeTagIdList=[],e.selectedTagIdAndObjAddrList=[],e.$set(e.checkboxConfig,"checkStrictly",!1),e.$refs.recordTable&&e.$refs.recordTable.setAllCheckboxRow(!1),e.currentPageCheccked=!1)},getAllChecked:function(){var e=this;if(this.$hasSessionStorageGwsn()){var t=[],a={type:1,sort:"objaddr"==this.sname?this.sname+"+0 "+this.sort:this.sname+" "+this.sort,devIds:this.dataForm.devname,gwsn:sessionStorage.getItem("gwsn")};if(this.dataForm.devname?a["devIds"]=this.dataForm.devname:this.devList.forEach((function(e){e.devID&&t.push(e.devID)})),!this.$hasPermission("list:getTagList:select:permission.do"))return void this.$message.warning("暂无测点查询权限, 请联系管理员");this.$http.post("",l.a.stringify(a)).then((function(a){var i=a.data;if(0!=i.code)return e.$message.error(i.data);e.tagIds=[],e.tagIdNameList=[],e.tagIdKList=[],e.tagIdCommentList=[],e.mergeTagIdList=[],e.selectedTagIdAndObjAddrList=[];for(var r=0;r<i.data.length;r++){var s=i.data[r];if(e.dataForm.tagname){if(e.dataForm.collecttypec.length>0){if(e.dataForm.devname){if((-1!=s.tagName.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase())||s.tagComment&&-1!=s.tagComment.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase()))&&-1!=e.dataForm.collecttypec.indexOf(s.collectTypeC)){var n={id:s.id,name:s.tagName},o={id:s.id,k:s.k},l={id:s.id,objaddr:s.objAddr},d={id:s.id,tagcomment:s.tagcomment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.transID),e.tagIdNameList.push(n),e.tagIdKList.push(o),e.tagIdCommentList.push(d),e.selectedTagIdAndObjAddrList.push(l)}}else if((-1!=s.tagName.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase())||s.tagComment&&-1!=s.tagComment.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase()))&&-1!=e.dataForm.collecttypec.indexOf(s.collectTypeC)&&-1!=t.indexOf(s.devID)){var c={id:s.id,name:s.tagName},g={id:s.id,k:s.k},m={id:s.id,objaddr:s.objAddr},h={id:s.id,tagcomment:s.tagcomment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.transID),e.tagIdNameList.push(c),e.tagIdKList.push(g),e.tagIdCommentList.push(h),e.selectedTagIdAndObjAddrList.push(m)}}else if(e.dataForm.devname){if(-1!=s.tagName.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase())||s.tagComment&&-1!=s.tagComment.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase())){var u={id:s.id,name:s.tagName},p={id:s.id,k:s.k},f={id:s.id,objaddr:s.objAddr},b={id:s.id,tagcomment:s.tagcomment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.transID),e.tagIdNameList.push(u),e.tagIdKList.push(p),e.tagIdCommentList.push(b),e.selectedTagIdAndObjAddrList.push(f)}}else if(-1!=t.indexOf(s.devID)&&(-1!=s.tagName.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase())||s.tagComment&&-1!=s.tagComment.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase()))){var v={id:s.id,name:s.tagName},$={id:s.id,k:s.k},y={id:s.id,objaddr:s.objAddr},w={id:s.id,tagcomment:s.tagcomment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.transID),e.tagIdNameList.push(v),e.tagIdKList.push($),e.tagIdCommentList.push(w),e.selectedTagIdAndObjAddrList.push(y)}}else if(e.dataForm.collecttypec.length>0){if(e.dataForm.devname){if(-1!=e.dataForm.collecttypec.indexOf(s.collectTypeC)){var T={id:s.id,name:s.tagName},L={id:s.id,k:s.k},I={id:s.id,objaddr:s.objAddr},S={id:s.id,tagcomment:s.tagcomment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.transID),e.tagIdNameList.push(T),e.tagIdKList.push(L),e.tagIdCommentList.push(S),e.selectedTagIdAndObjAddrList.push(I)}}else if(-1!=e.dataForm.collecttypec.indexOf(s.collectTypeC)&&-1!=t.indexOf(s.devID)){var F={id:s.id,name:s.tagName},C={id:s.id,k:s.k},D={id:s.id,objaddr:s.objAddr},k={id:s.id,tagcomment:s.tagcomment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.transID),e.tagIdNameList.push(F),e.tagIdKList.push(C),e.tagIdCommentList.push(k),e.selectedTagIdAndObjAddrList.push(D)}}else if(e.dataForm.devname){var x={id:s.id,name:s.tagName},N={id:s.id,k:s.k},A={id:s.id,objaddr:s.objAddr},_={id:s.id,tagcomment:s.tagcomment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.transID),e.tagIdNameList.push(x),e.tagIdKList.push(N),e.tagIdCommentList.push(_),e.selectedTagIdAndObjAddrList.push(A)}else if(-1!=t.indexOf(s.devID)){var O={id:s.id,name:s.tagName},j={id:s.id,k:s.k},P={id:s.id,objaddr:s.objAddr},V={id:s.id,tagcomment:s.tagcomment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.transID),e.tagIdNameList.push(O),e.tagIdKList.push(j),e.tagIdCommentList.push(V),e.selectedTagIdAndObjAddrList.push(P)}}})).catch((function(e){return!1}))}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},getTreeList:function(){var e=this,t={chltype:1,gwsn:sessionStorage.getItem("gwsn")};if(e.dataTree=[{id:0,label:e.$t("attribute.own"),children:[]}],e.$hasSessionStorageGwsn()){if(!e.$hasPermission("channelinfo:selectChlAndDev:permission.do"))return void e.$message.warning("暂无通道设备查询权限, 请联系管理员");e.$http.post("/info/channelinfo/selectChlAndDev",l.a.stringify(t)).then((function(t){var a=t.data;a.length>0&&a.forEach((function(t){var a={id:t.chlid,label:t.chlname,p_id:0};t.children.length>0&&(a.children=[],t.children.forEach((function(e){var t={id:e.devid,label:e.devname,p_id:e.chlid,children:[]};a.children.push(t)}))),e.dataTree[0].children.push(a)}))})).catch((function(e){return!1}))}else e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},handleCheckChange:function(){var e=[],t=[];e=this.$refs.tree.getCheckedNodes(),e.forEach((function(e){0!=e.id&&0!=e.p_id&&t.push(e.id)})),this.importForm.deviceId=t.join(",")},addOrUpdate:function(e){var t=this;if(this.$hasSessionStorageGwsn()){if(this.nodevice)return this.$message.warning(this.$t("attribute.noTransDevice"));if(this.addDisabled)return this.$message.warning(this.$t("attribute.noCollectAndCenterTag"));this.addOrUpdateVisible=!0,this.$nextTick((function(){var a=t.$refs.recordTable?t.$refs.recordTable.getScroll().scrollLeft:0,i=t.$refs.recordTable?t.$refs.recordTable.getScroll().scrollTop:0;if(t.scrollleft=a,t.scorlltop=i,e){if(!t.$hasPermission("transtaginfo:update:permission.do"))return void t.$message.warning("暂无转发测点修改权限, 请联系管理员");t.isAddOrUpdate=!0}else{if(!t.$hasPermission("transtaginfo:insert:permission.do"))return void t.$message.warning("暂无转发测点新增权限, 请联系管理员");t.isAddOrUpdate=!1}t.$refs.addOrUpdate.dataForm.id=e?e.id:"",t.$refs.addOrUpdate.transId=e?e.transid:"",t.$refs.addOrUpdate.paramsDevid=t.dataForm.devname,t.$refs.addOrUpdate.init()}))}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}})},addAll:function(){var e=this;if(this.$hasSessionStorageGwsn()){if(this.nodevice)return this.$message.warning(this.$t("attribute.noTransDevice"));if(this.addDisabled)return this.$message.warning(this.$t("attribute.noCollectAndCenterTag"));if(!this.$hasPermission("transtaginfo:insert:permission.do"))return void this.$message.warning("暂无转发测点新增权限, 请联系管理员");this.addallVisible=!0,this.$nextTick((function(){e.$refs.addTagAll.paramsDevid=e.dataForm.devname,e.$refs.addTagAll.init()}))}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},deleteHandle:p()((function(e){var t=this;if(t.$hasSessionStorageGwsn()){if(e&&(t.tagIds=[],t.tagIds.push(e)),0===t.tagIds.length)return t.$message.error(t.$t("deleteInfo.noData"));if(!t.$hasPermission("transtag:delete:permission.do"))return void t.$message.warning("暂无转发测点新增权限, 请联系管理员");t.$confirm(t.$t("deleteInfo.noticeTitle"),t.$t("deleteInfo.noticePrompt"),{confirmButtonText:t.$t("deleteInfo.confirm"),cancelButtonText:t.$t("deleteInfo.cancel"),type:"warning"}).then((function(){t.dataListLoading=!0,t.$http.post("/delcmd/transtag/delete.do",t.tagIds).then((function(e){var a=e.data;if(0!=a.code)return t.dataListLoading=!1,t.$message.error(a.data||t.$t("deleteInfo.deleteFail"));t.$message.success(t.$t("deleteInfo.deleteSuccess")),t.dataListLoading=!1,t.allCheck=!1,t.currentPageCheccked=!1,t.getDataList()})).catch((function(e){return t.dataListLoading=!1,t.allCheck=!1,t.currentPageCheccked=!1,t.getDataList(),!1}))})).catch((function(e){}))}else t.$message({showClose:!1,message:t.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),editAll:function(){var e=this;if(this.$hasSessionStorageGwsn()){if(!(this.tagIds.length>0))return this.$message.info(this.$t("attribute.selectEditData"));if(!this.$hasPermission("transtaginfo:update:permission.do"))return void this.$message.warning("暂无转发测点批量修改权限, 请联系管理员");this.editAllVisible=!0,this.getCollectTypeList()}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},selectChanged:function(e){this.$refs.editForm.clearValidate(),this.editForm.changeValue="","dataformat"===e?(this.changeList=this.hiloType,this.editForm.changeValue=this.changeList[0].value):"datatype"===e?(this.changeList=this.dataType,this.editForm.changeValue=this.changeList[0].value):"alarmtype"===e?(this.changeList=this.alarmRecordList,this.editForm.changeValue=this.changeList[0].value):"tagrwprop"===e?(this.changeList=this.writeReadType,this.editForm.changeValue=this.changeList[0].value):"collecttypec"===e?(this.changeList=this.collecttypecList,this.editForm.changeValue=this.changeList[0].value):"enablealarm"===e?(this.changeList=this.enablealarmList,this.editForm.changeValue=this.changeList[0].value):"enablehissave"===e&&(this.changeList=this.enablehissaveList,this.editForm.changeValue=this.changeList[0].value)},handleAddSmartTransDataChange:function(){this.editForm.smartTransformTableData.push({sourceK:1,targetK:1})},handleResetSmartTransDataChange:function(){this.editForm.smartTransformTableData=[{sourceK:.1,targetK:10},{sourceK:.01,targetK:100},{sourceK:.001,targetK:1e3}]},handleDeleteSmartTransDataChange:function(e){this.editForm.smartTransformTableData.splice(e,1)},getCollectTypeList:function(){var e=this,t=e.tagIds[0];if(e.$hasSessionStorageGwsn()){if(e.collecttypecList=[],!e.$hasPermission("transtaginfo:select:permission.do"))return void e.$message.warning("暂无转发测点信息查询权限, 请联系管理员");e.$http.get("/info/transtaginfo/".concat(t)).then((function(t){var a=t.data;if(0===a.code){if(!e.$hasPermission("channelinfo:info:select:permission.do"))return void e.$message.warning("暂无通道信息查询权限, 请联系管理员");e.$http.get("/info/channelinfo/getByChliId",{params:{chlid:a.data.tagchlid,gwsn:sessionStorage.getItem("gwsn")}}).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);e.$hasPermission("protocolinfo:select:permission.do")?e.$http.get("/info/protocolinfo/proguid",{params:{guid:a.data[0].chlprotocol}}).then((function(t){var a=t.data;if(a.data.length>0){var i=JSON.parse(a.data[0].funccode).data;i.length>0&&i.forEach((function(t){var a={label:t.description,value:t.FuncCode};e.collecttypecList.push(a)}))}})).catch((function(e){return!1})):e.$message.warning("暂无协议信息查询权限, 请联系管理员")})).catch((function(e){return!1}))}})).catch((function(e){return!1}))}else e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},isRepeat:function(e){var t={};for(var a in e){if(t[e[a]])return!0;t[e[a]]=!0}return!1},generateAddresses:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,i=[];if("number"===typeof e){for(var r=0;r<a;r++)i.push(String(e+r*t));return i}var s=e.match(/\d+/g);if(!s){for(var n=0;n<a;n++)i.push(0==t?"".concat(e):"".concat(e).concat(n*t));return i}for(var o=s[s.length-1],l=e.lastIndexOf(o),d=e.substring(0,l),c=e.substring(l+o.length),g=parseInt(o,10),m=0;m<a;m++){var h=g+m*t,u=o.startsWith("0")?String(h).padStart(o.length,"0"):String(h);i.push("".concat(d).concat(u).concat(c))}return i},dataFormSubmitHandle:p()((function(){var e=this;if(this.$hasSessionStorageGwsn()){if(!this.$hasPermission("transtaginfo:update:permission.do"))return void this.$message.warning("暂无转发点批量修改权限, 请联系管理员");var t=[];if("tagname"===this.editForm.type){if("replace"==this.editForm.way?this.tagIdNameList.forEach((function(a){if(-1!=a.name.toLowerCase().indexOf(e.editForm.replaceStr.toLowerCase())){var i={};i.id=a.id,i.tagname=a.name.replace(new RegExp(e.editForm.replaceStr,"gi"),e.editForm.tagnameStr),t.push(i)}})):"prepend"==this.editForm.way?this.tagIdNameList.forEach((function(a){var i={};i.id=a.id,i.tagname=e.editForm.tagnameStr+a.name,t.push(i)})):"append"==this.editForm.way&&this.tagIdNameList.forEach((function(a){var i={};i.id=a.id,i.tagname=a.name+e.editForm.tagnameStr,t.push(i)})),0==t.length)return this.editForm.replaceStr="",this.$message.warning(this.$t("attribute.measuringPointNameReenterIt"));this.$refs["editForm"].validate((function(a){if(!a)return!1;e.$http.post("/info/transtaginfo/batchUpdateTransName.do",t).then((function(t){var a=t.data;if("OK"!==a.msg)return e.$message.error(a.data||a.msg);e.$message.success(a.msg),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList(),!1}))}))}else if("tagcomment"===this.editForm.type){var a={ids:this.tagIds.join(","),pre:this.editForm.tagcomment,fex:this.editForm.tagcommentStep};this.$http.put("/info/transtaginfo/updateCommendByIds",l.a.stringify(a)).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);e.$message.success(e.$t("prompt.success")),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList()}))}else if("objaddr"===this.editForm.type)if("clipboardSource"==this.editForm.objaddrWay){var i=navigator.clipboard.readText();i.then((function(a){return a=a.split("\r\n"),0==a.length||1==a.length&&""==a[a.length-1]?(e.$message.warning(e.$t("clipboardNoContent")),!1):(a=""==a[a.length-1]?a.slice(0,a.length-1):a,void(a.length<e.tagIds.length?e.$confirm(e.$t("attribute.clipboardContentLessThanNumberOfRows"),e.$t("prompt.title"),{confirmButtonText:e.$t("confirm"),cancelButtonText:e.$t("cancel"),type:"warning"}).then((function(){a.forEach((function(a,i){var r={};r.id=e.tagIds[i],r.objaddr=a,t.push(r)})),e.$refs["editForm"].validate((function(a){if(!a)return!1;e.$http.post("/info/transtaginfo/batchUpdateTrans",t).then((function(t){var a=t.data;if("OK"!==a.msg)return e.$message.error(a.data||a.msg);e.$message.success(a.data),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList(),!1}))}))})).catch((function(){})):(e.tagIds.forEach((function(e,i){var r={};r.id=e,r.objaddr=a[i],t.push(r)})),e.$refs["editForm"].validate((function(a){if(!a)return!1;e.$http.post("/info/transtaginfo/batchUpdateTrans",t).then((function(t){var a=t.data;if("OK"!==a.msg)return e.$message.error(a.data||a.msg);e.$message.success(a.data),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList(),!1}))})))))})).catch((function(t){return e.$message.error(e.$t("failedToObtainClipboardContent"))}))}else{var r=/.*\..*/;if("step"==this.editForm.objaddrWay)if(-1!=this.$chineseChar2englishChar(String(this.editForm.startValue)).indexOf(",")){var s=this.$chineseChar2englishChar(String(this.editForm.startValue)).split(",")[0],n=this.$chineseChar2englishChar(String(this.editForm.startValue)).split(",")[1],o=null,d=null,c=this.$chineseChar2englishChar(String(n)),g=c.match(/\d+\.*\d*/g);if(g&&g.length>0){r.test(g[g.length-1])?(o=g[g.length-1].split(".")[1],d=c.substring(0,c.length-String(o).length)):(o=g[g.length-1],d=c.substring(0,c.length-String(o).length));var m=parseInt(o),h=Number(this.editForm.step),u=0,p="",f=parseInt(o);r.test(o)&&(u=o.split(".")[1]),r.test(o)?this.tagIds.forEach((function(a){if(String(o).length>String(f).length){p="";for(var i=0;i<String(o).length-String(f).length;i++)p+="0"}else p="";var r={};r.id=a,r.objaddr=""!=p?s?s+","+d+p+f:d+p+f:s?s+","+d+f:d+f,u=Number(u)+Number(e.editForm.step),f=m+"."+u,t.push(r)})):this.tagIds.forEach((function(e){if(String(o).length>String(f).length){p="";for(var a=0;a<String(o).length-String(f).length;a++)p+="0"}else p="";var i={};i.id=e,i.objaddr=""!=p?s?s+","+d+String(p)+f:d+p+f:s?s+","+d+f:d+f,f+=h,t.push(i)}))}}else{var b=this.generateAddresses(String(this.editForm.startValue),Number(this.editForm.step),this.tagIds.length);this.tagIds.forEach((function(e,a){var i={id:e,objaddr:b[a]};t.push(i)}))}else this.selectedTagIdAndObjAddrList.forEach((function(a){if(-1!=e.$chineseChar2englishChar(String(a.objaddr)).indexOf(",")){var i=e.$chineseChar2englishChar(String(a.objaddr)).split(",")[0],s=e.$chineseChar2englishChar(String(a.objaddr)).split(",")[1],n=null,o=null,l=e.$chineseChar2englishChar(String(s)),d=l.match(/\d+\.*\d*/g);if(d&&d.length>0){r.test(d[d.length-1])?(n=d[d.length-1].split(".")[1],o=l.substring(0,l.length-String(n).length)):(n=d[d.length-1],o=l.substring(0,l.length-String(n).length));var c=parseInt(n),g=Number(e.editForm.fixedValue),m=0,h="",u=parseInt(n);if(r.test(n)&&(m=n.split(".")[1]),r.test(n)){if(String(n).length>String(u).length){h="";for(var p=0;p<String(n).length-String(u).length;p++)h+="0"}else h="";var f={};f.id=a.id,m=Number(m)+Number(e.editForm.fixedValue),u=c+"."+m,f.objaddr=""!=h?i?i+","+o+h+u:o+h+u:i?i+","+o+u:o+u,t.push(f)}else{if(String(n).length>String(u).length){h="";for(var b=0;b<String(n).length-String(u).length;b++)h+="0"}else h="";var v={};v.id=a.id,u+=g,v.objaddr=""!=h?i?i+","+o+String(h)+u:o+h+u:i?i+","+o+u:o+u,t.push(v)}}}else{var $=null,y=null,w=e.$chineseChar2englishChar(String(a.objaddr)),T=w.match(/\d+\.*\d*/g);if(T&&T.length>0){r.test(T[T.length-1])?($=T[T.length-1].split(".")[1],y=w.substring(0,w.length-String($).length)):($=T[T.length-1],y=w.substring(0,w.length-String($).length));var L=parseInt($),I=0,S="",F=parseInt($);if(r.test($)&&(I=$.split(".")[1]),r.test($)){if(String($).length>String(F).length){S="";for(var C=0;C<String($).length-String(F).length;C++)S+="0"}else S="";var D={};D.id=a.id,I=Number(I)+Number(e.editForm.fixedValue),F=L+"."+I,D.objaddr=""!=S?y?y+S+F:S+F:y?y+F:F,t.push(D)}else{if(String($).length>String(F).length){S="";for(var k=0;k<String($).length-String(F).length;k++)S+="0"}else S="";var x={};x.id=a.id,F+=Number(e.editForm.fixedValue),x.objaddr=""!=S?y?y+String(S)+F:S+F:y?y+F:F,t.push(x)}}}}));this.$refs["editForm"].validate((function(a){if(!a)return!1;e.$http.post("/info/transtaginfo/batchUpdateTrans",t).then((function(t){var a=t.data;if("OK"!==a.msg)return e.$message.error(a.data||a.msg);e.$message.success(a.data),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList(),!1}))}))}else if("k"===this.editForm.type)if(this.editForm.smartTransform){if(0==this.editForm.smartTransformTableData.length)return this.$message.warning(this.$t("attribute.addModificationRules"));var v=[];if(this.editForm.smartTransformTableData.forEach((function(e){v.push(e.sourceK)})),this.isRepeat(v))return this.$message.warning(this.$t("attribute.duplicateDataInRules"));if(this.editForm.smartTransformTableData.forEach((function(a){e.tagIdKList.forEach((function(e){if(a.sourceK==e.k){var i={id:e.id,k:a.targetK};t.push(i)}}))})),0==t.length)return this.$message.warning(this.$t("attribute.noDataSourceMatchedYet"));this.$refs["editForm"].validate((function(a){if(!a)return!1;e.$http.post("/info/transtaginfo/batchUpdateTrans",t).then((function(t){var a=t.data;if("OK"!==a.msg)return e.$message.error(a.data||a.msg);e.$message.success(a.data),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList(),!1}))}))}else this.tagIdKList.forEach((function(a){var i={};i.id=a.id,i.k=e.editForm.value,t.push(i)})),this.$refs["editForm"].validate((function(a){if(!a)return!1;e.$http.post("/info/transtaginfo/batchUpdateTrans",t).then((function(t){var a=t.data;if("OK"!==a.msg)return e.$message.error(a.data||a.msg);e.$message.success(a.data),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList(),!1}))}));else{var $=this.editForm.type;this.tagIds.forEach((function(a){var i={};i.id=a,i[$]=e.editForm.changeValue,t.push(i)})),this.$refs["editForm"].validate((function(a){if(!a)return!1;e.$http.post("/info/transtaginfo/batchUpdateTrans",t).then((function(t){var a=t.data;if("OK"!==a.msg)return e.$message.error(a.data||a.msg);e.$message.success(a.data),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList(),!1}))}))}}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),beforeUploadHandle:function(e){var t=e.size/1024/1024<65;return t||this.$message.error(this.$t("attribute.uploadFileLimitExceeded")),t},handleChange:function(e,t){},handleRemove:function(e,t){this.fileList=[]},uploadSectionFile:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t,a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.$hasPermission("transtaginfo:import:permission.do")){e.next=1;break}return this.$message.warning("暂无转发点导入权限, 请联系管理员"),e.abrupt("return");case 1:return e.next=2,this.getTreeList();case 2:this.fileParams=null,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==t.file.type||"application/vnd.ms-excel"==t.file.type||-1!=t.file.name.indexOf(".xlsx")||-1!=t.file.name.indexOf(".xls")?(this.fileParams=t.file,this.tagVisible=!0):(this.$message.warning(this.$t("attribute.errorType")),this.handleRemove());case 3:case"end":return e.stop()}}),e,this)})));function t(t,a){return e.apply(this,arguments)}return t}(),handleCancel:function(){this.fileList=[],this.tagVisible=!1},tagListConfirm:function(){var e=this;if(this.$hasSessionStorageGwsn()){if(!this.importForm.deviceId)return this.$message.info(this.$t("attribute.selectImportevice"));this.file=new FormData,this.file.append("file",this.fileParams),this.file.append("tagsource",2),this.file.append("gwsn",sessionStorage.getItem("gwsn")),this.file.append("typeid",0),this.file.append("devid",this.importForm.deviceId),this.tagVisible=!1,this.importfile(this.file)}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},importfile:p()((function(e){var t=this;this.$hasPermission("transtaginfo:import:permission.do")?this.$http.post("/info/transtaginfo/importExcle",e).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg),!1;t.$message.success(t.$t("importSuccess")),t.getDataList(),t.handleRemove()})).catch((function(e){return!1})):this.$message.warning("暂无转发点导入权限, 请联系管理员")}),1e3,{leading:!0,trailing:!1}),handleExportTransTagsChange:function(){var e=this,t={sn:sessionStorage.getItem("gwsn"),chlId:e.dataForm.chlId,ids:e.tagIds.join(","),sort:"objaddr"==e.sname?e.sname+"+0 "+e.sort:e.sname+" "+this.sort};if(e.$hasSessionStorageGwsn()){if(!e.$hasPermission("transtaginfo:export:permission.do"))return void e.$message.warning("暂无转发点导出权限, 请联系管理员");e.dataListLoading=!0,g()({url:"".concat(window.SITE_CONFIG["apiURL"],"/info/transtaginfo/export.do"),method:"post",data:l.a.stringify(t),responseType:"blob",headers:{token:h.a.get("token")}}).then((function(t){if(e.dataListLoading=!1,t.data){var a=window.URL.createObjectURL(new Blob([t.data])),i=document.createElement("a");return i.href=a,i.setAttribute("download",(new Date).getTime()+".xls"),document.body.appendChild(i),i.click(),e.$message.success(e.$t("exportData.exportSuccess"))}})).catch((function(t){return e.dataListLoading=!1,e.$message.error(e.$t("exportData.exportError"))}))}else e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},getprotocolinfoList:function(){var e=this;e.$hasPermission("protocolinfo:select:permission.do")?e.$http.get("/info/protocolinfo/proGuidAll",{params:{attribute:1}}).then((function(t){var a=t.data;if(0!==a.code)return e.$message.error(a.data||a.msg);e.guidList=a.data,e.getDevlist()})).catch((function(e){return!1})):e.$message.warning("暂无协议查询权限, 请联系管理员")},getTagList:function(){var e=this,t={type:0,gwsn:sessionStorage.getItem("gwsn")};if(e.$hasSessionStorageGwsn()){if(!e.$hasPermission("list:getTagList:select:permission.do"))return void setTimeout((function(){e.$message.warning("暂无采集测点查询权限, 请联系管理员")}),500);e.$http.post("/list/getTagList.do",l.a.stringify(t)).then((function(t){var a=t.data;if(0!=a.code)return e.addDisabled=!0,e.noTag=!0,e.$message.error(a.data||a.msg);0==a.data.length?(e.addDisabled=!0,e.noTag=!0):(e.addDisabled=!1,e.noTag=!1)})).catch((function(e){return!1}))}else e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},handleTagsToDeviceChange:function(){this.$hasPermission("channelinfo:updateTagDevId:permission.do")?(this.mergeTagsToDeviceForm.devId="",this.mergeTagsToDeviceForm.tagIds=[],this.mergeTagsList=[],this.mergeTargetDeviceList=[],this.getMergeDeviceList()):this.$message.warning("暂无测点移动至设备权限, 请联系管理员")},handleTagNameOrVisibleChange:function(e){var t=this;e&&this.$nextTick((function(){t.$refs.tagNameOrDescInput.focus()}))},loadMore:function(e){var t=this;return function(){return t.rangeNumber+=300}},handleMergeTagsToDeviceClose:function(){this.tagNameOrDescSearch="",this.showMergeTagsList=[],this.mergeTagsList=[],this.$refs.mergeTagsToDeviceForm.resetFields(),this.mergeTagsToDeviceVisible=!1},hanleMergeDevIdChanage:function(e){var t=this;if(this.$hasSessionStorageGwsn()){if(this.mergeTagsList=[],e){var a={gwsn:sessionStorage.getItem("gwsn"),type:1};if(!this.$hasPermission("list:getTagList:select:permission.do"))return void this.$message.warning("暂无转发测点查询权限, 请联系管理员");this.$http.post("/list/getTagList.do",l.a.stringify(a)).then((function(a){var i=a.data;if(0!=i.code)return t.$message.error(i.data||i.msg);if(i.data.forEach((function(a){a.devID!=e&&1!=a.devID&&t.mergeTagsList.push(a)})),t.showMergeTagsList=t.mergeTagsList,0==t.mergeTagsList.length)t.mergeTagsToDeviceForm.tagIds=[];else if(t.mergeTagsToDeviceForm.tagIds.length>0){var r=[];t.mergeTagsToDeviceForm.tagIds=t.mergeTagsToDeviceForm.tagIds.filter((function(e){return"all"!=e}));for(var s=t.mergeTagsList.length-1;s>=0;s--)t.mergeTagsToDeviceForm.tagIds.includes(t.mergeTagsList[s].transID)&&r.push(t.mergeTagsList[s].transID);t.mergeTagsToDeviceForm.tagIds=r,t.mergeTagsToDeviceForm.tagIds.length==t.mergeTagsList.length&&t.mergeTagsToDeviceForm.tagIds.unshift("all")}else t.mergeTagsToDeviceForm.tagIds=[]}))}}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}})},getMergeDeviceList:function(){var e=this;if(this.$hasSessionStorageGwsn()){var t={gwsn:sessionStorage.getItem("gwsn")};if(this.mergeTagsToDeviceVisible=!1,!this.$hasPermission("list:getChlList:select:permission.do"))return void this.$message.warning("暂无通道查询权限, 请联系管理员");this.$http.get("/list/getChlList.do",{params:t}).then((function(t){var a=t.data;return 0!=a.code?e.$message.error(a.data||a.msg):a.data.length>0?void a.data.forEach((function(t){if(1==t.chlType&&t.chlID==e.dataForm.chlId&&t.hasOwnProperty("dev2PojoList")){if(!(t.dev2PojoList.length>1))return e.$message.warning(e.$t("attribute.currentlyNoTargetDevicesToMove"));if(e.mergeTargetDeviceList=t.dev2PojoList,e.mergeTagIdList.length>0){if(!e.$hasPermission("list:getTagList:select:permission.do"))return void e.$message.warning("暂无采集测点查询权限, 请联系管理员");e.$http.post("/list/getTagList.do",l.a.stringify({gwsn:sessionStorage.getItem("gwsn"),type:1})).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);if(e.mergeTagsList=a.data.filter((function(e){return 1!=e.devID})),e.showMergeTagsList=e.mergeTagsList,e.mergeTagIdList.length>0)if(e.mergeTagsToDeviceForm.tagIds=e.mergeTagIdList,e.mergeTagIdList.length>e.total)e.mergeTagsToDeviceForm.tagIds.shift(),e.mergeTagsToDeviceForm.tagIds=e.mergeTagsToDeviceForm.tagIds.map(Number),e.mergeTagsToDeviceForm.tagIds.length==e.mergeTagsList.length&&e.mergeTagsToDeviceForm.tagIds.unshift("all");else if(e.mergeTagIdList.length==e.total)e.mergeTagsToDeviceForm.tagIds=e.mergeTagsToDeviceForm.tagIds.map(Number),e.mergeTagsToDeviceForm.tagIds.length==e.mergeTagsList.length&&e.mergeTagsToDeviceForm.tagIds.unshift("all");else{var i=e.showMergeTagsList.filter((function(t){return e.mergeTagsToDeviceForm.tagIds.some((function(e){return e==t.transID}))})),r=e.showMergeTagsList.filter((function(t){return!e.mergeTagsToDeviceForm.tagIds.includes(String(t.transID))}));e.mergeTagsList=r,e.showMergeTagsList=r,e.mergeTagsToDeviceForm.tagIds=e.mergeTagsToDeviceForm.tagIds.map(Number),e.showMergeTagsList=[].concat(Object(s["a"])(i),Object(s["a"])(e.showMergeTagsList))}else e.mergeTagsToDeviceForm.tagIds=[];e.mergeTagsToDeviceVisible=!0}))}else e.mergeTagsToDeviceForm.tagIds=[],e.mergeTagsToDeviceVisible=!0}})):e.$message.warning(e.$t("attribute.currentlyNoTargetDevicesToMove"))}))}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},selectAllPrepareTag:function(){var e=this;this.mergeTagsToDeviceForm.tagIds.length<this.mergeTagsList.length?(this.mergeTagsToDeviceForm.tagIds=[],this.mergeTagsList.forEach((function(t){e.mergeTagsToDeviceForm.tagIds.push(t.transID)})),this.mergeTagsToDeviceForm.tagIds.unshift("all")):this.mergeTagsToDeviceForm.tagIds=[]},handleMergeTagNameOrDescChange:function(e){e.includes("all")||e.length!==this.mergeTagsList.length?e.includes("all")&&e.length-1<this.mergeTagsList.length&&(this.mergeTagsToDeviceForm.tagIds=this.mergeTagsToDeviceForm.tagIds.filter((function(e){return"all"!==e}))):this.mergeTagsToDeviceForm.tagIds.unshift("all")},handleMergeTagsToDeviceSubmit:p()((function(){var e=this,t={sn:sessionStorage.getItem("gwsn"),devId:e.mergeTagsToDeviceForm.devId,type:1,tagIds:"",chlId:e.dataForm.chlname};if(e.$hasSessionStorageGwsn()){if(!e.$hasPermission("channelinfo:updateTagDevId:permission.do"))return void e.$message.warning("暂无测点移动至设备权限, 请联系管理员");e.$refs["mergeTagsToDeviceForm"].validate((function(a){if(!a)return!1;if(e.mergeTagsToDeviceForm.tagIds.includes("all")){var i=JSON.parse(JSON.stringify(e.mergeTagsToDeviceForm.tagIds));i.splice(i.findIndex((function(e){return"all"===e})),1),t["tagIds"]=i.join(",")}else t["tagIds"]=e.mergeTagsToDeviceForm.tagIds.join(",");e.$confirm(e.$t("attribute.moveTheseMeasuringPointsToThisDevice"),e.$t("deleteInfo.noticePrompt"),{confirmButtonText:e.$t("deleteInfo.confirm"),cancelButtonText:e.$t("deleteInfo.cancel"),type:"warning"}).then((function(){e.mergeTagsToDeviceFormloading=!0,e.$http.get("/info/channelinfo/updateTagDevId.do",{params:t}).then((function(t){var a=t.data;if(0!=a.code)return e.mergeTagsToDeviceFormloading=!1,e.$message.error(a.data||a.msg);e.$message.success(e.$t("prompt.success")),e.mergeTagsToDeviceFormloading=!1,e.handleMergeTagsToDeviceClose(),e.getDataList()})).catch((function(t){return e.mergeTagsToDeviceFormloading=!1,!1}))})).catch((function(e){}))}))}else e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1})},created:function(){this.page=Number(sessionStorage.getItem("page5"))||1,this.limit=Number(sessionStorage.getItem("limit5"))||1e3},mounted:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this,t.isShowSetting=0!=sessionStorage.getItem("per"),t.$erd.listenTo(document.getElementById("transTagQueryContainer"),(function(e){var a=document.getElementById("transTagQueryContainer").offsetHeight;t.scrollTableHeight=window.innerHeight-130-a})),1==localStorage.getItem("superAdmin")?t.editTypeLists=[{label:t.$t("attribute.tagname"),value:"tagname"},{label:t.$t("attribute.modelattribute"),value:"tagcomment"},{label:t.$t("attribute.address"),value:"objaddr"},{label:t.$t("attribute.tagk"),value:"k"},{label:t.$t("attribute.datatype"),value:"datatype"},{label:t.$t("attribute.dataformat"),value:"dataformat"},{label:t.$t("attribute.collecttypec"),value:"collecttypec"}]:t.editTypeLists=[{label:t.$t("attribute.modelattribute"),value:"tagcomment"},{label:t.$t("attribute.address"),value:"objaddr"},{label:t.$t("attribute.tagk"),value:"k"},{label:t.$t("attribute.datatype"),value:"datatype"},{label:t.$t("attribute.dataformat"),value:"dataformat"},{label:t.$t("attribute.collecttypec"),value:"collecttypec"}],t.queryParams=t.$route.query,e.next=1,t.getprotocolinfoList();case 1:return e.next=2,t.getTagList();case 2:window.onresize=function(){return function(){var e=document.getElementById("transTagQueryContainer").offsetHeight;t.scrollTableHeight=window.innerHeight-130-e}()};case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),watch:{total:function(){this.total==(this.page-1)*this.limit&&0!=this.total&&(this.page-=1,sessionStorage.setItem("page5",this.page),this.getDataList())},page:function(){this.currentPageCheccked=!1},multipleSelectionAll:function(){0!=this.multipleSelectionAll.length&&this.multipleSelectionAll.length==this.dataList.length||(this.currentPageCheccked=!1)},dataList:{handler:function(e){this.allCheck&&(this.$set(this.checkboxConfig,"checkStrictly",!1),this.$refs.recordTable&&this.$refs.recordTable.setAllCheckboxRow(!0),this.$set(this.checkboxConfig,"checkStrictly",!0))},deep:!0},$route:function(e,t){"/transtaginfo"===e.path&&(this.queryParams={})},tagNameOrDescSearch:function(e,t){e?(this.showMergeTagsList=this.mergeTagsList,this.showMergeTagsList=this.showMergeTagsList.filter((function(t){if(t.tagName.toLowerCase().includes(e.toLowerCase())||t.tagComment.toLowerCase().includes(e.toLowerCase()))return t})),0==this.showMergeTagsList.length&&this.showMergeTagsList.push({transID:"",tagName:this.$t("noMatchingDataYet"),tagComment:"",disabled:!0})):this.showMergeTagsList=this.mergeTagsList}}},T=w,L=a("2877"),I=Object(L["a"])(T,i,r,!1,null,null,null);t["default"]=I.exports}}]);
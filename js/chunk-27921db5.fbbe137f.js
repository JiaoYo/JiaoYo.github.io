(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-27921db5","chunk-2d22d015"],{"1dd0":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("el-card",{attrs:{shadow:"never"}},[t("el-form",{attrs:{inline:!0,model:e.dataForm},nativeOn:{submit:function(e){e.preventDefault()},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.querySearch.apply(null,arguments)}}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{xs:24,sm:24,md:24,lg:24,xl:24}},[t("el-form-item",{attrs:{label:e.$t("pluginInManage.platform")}},[t("el-select",{attrs:{size:"small",placeholder:e.$t("pluginInManage.pleaseSelectPlatform"),clearable:""},on:{clear:e.querySearch,change:e.querySearch},model:{value:e.dataForm.platform,callback:function(t){e.$set(e.dataForm,"platform",t)},expression:"dataForm.platform"}},e._l(e.platformList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",[t("el-input",{attrs:{size:"small",placeholder:e.$t("pluginInManage.pleaseEnterSearchContent"),clearable:""},on:{clear:e.querySearch},model:{value:e.dataForm.fuzzy,callback:function(t){e.$set(e.dataForm,"fuzzy",t)},expression:"dataForm.fuzzy"}})],1),e.$hasPermission("extp:select:permission.do")?t("el-form-item",[t("el-button",{attrs:{size:"small",icon:"el-icon-search"},on:{click:e.querySearch}},[e._v(e._s(e.$t("query")))])],1):e._e(),1==e.currentUserSuperAdmin&&e.$hasPermission("extp:insert:permission.do")?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.handleAddOrUpdate()}}},[e._v("\n                        "+e._s(e.$t("add"))+"\n                    ")])],1):e._e(),1==e.currentUserSuperAdmin&&e.$hasPermission("extp:delete:permission.do")?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.handleDeleteDriveChange()}}},[e._v(" "+e._s(e.$t("deleteBatch"))+" ")])],1):e._e(),e.$hasPermission("extp:select:permission.do")?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-download"},on:{click:function(t){return e.handleExportExcel()}}},[e._v(e._s(e.$t("export")))])],1):e._e(),e.$hasPermission("extp:select:permission.do")?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"success"},on:{click:e.getDataList}},[t("i",{staticClass:"el-icon-refresh"})])],1):e._e()],1)],1)],1),t("vxe-table",{ref:"recordTable",staticStyle:{width:"100%"},attrs:{size:"medium",border:"",resizable:"","auto-resize":"","sync-resize":"","show-overflow":"","show-header-overflow":"","highlight-hover-row":"","highlight-current-row":"","max-height":e.scrollTableHeight,loading:e.dataListLoading,"row-config":{keyField:"id"},"checkbox-config":e.checkboxConfig},on:{"checkbox-all":e.selectAll,"checkbox-change":e.dataListSelectionHandle}},[e.$hasPermission("extp:delete:permission.do")?t("vxe-table-column",{key:"1",attrs:{type:"checkbox","header-align":"center",align:"center",width:"60",fixed:"left"}}):e._e(),t("vxe-table-column",{key:"2",attrs:{field:"showName",title:e.$t("pluginInManage.name"),"header-align":"center",align:"center",fixed:"left"}}),t("vxe-table-column",{key:"3",attrs:{field:"platform",title:e.$t("pluginInManage.platform"),"header-align":"center",align:"center",width:"160","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(0==t.row.platform?"A7":1==t.row.platform?"arm9":2==t.row.platform?"x86-linux":3==t.row.platform?"A53":"A9")+"\n            ")]}}])}),t("vxe-table-column",{key:"4",attrs:{field:"ver",title:e.$t("pluginInManage.serverVersion"),"header-align":"center",align:"center",width:"160","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(t.row.ver)+"\n            ")]}}])}),t("vxe-table-column",{key:"5",attrs:{field:"re1",title:e.$t("upgrade.downLoadUrl"),"header-align":"center",align:"center","show-overflow-tooltip":!0,width:"460"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"copy",staticStyle:{cursor:"pointer"},on:{click:function(t){return e.copyFileUrl(a.row)}}},[e._v(e._s(a.row.re1))])]}}])}),t("vxe-table-column",{key:"6",attrs:{field:"md5",title:"MD5","header-align":"center",align:"center",width:"300","show-overflow-tooltip":!0}}),t("vxe-table-column",{key:"7",attrs:{title:e.$t("handle"),"header-align":"center",align:"center",width:"160",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleDownLoadChange(a.row)}}},[e._v(e._s(e.$t("upgrade.downLoadFile")))]),1==e.currentUserSuperAdmin&&e.$hasPermission("extp:update:permission.do")?t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleAddOrUpdate(a.row)}}},[e._v("\n                    "+e._s(e.$t("update"))+"\n                ")]):e._e(),1==e.currentUserSuperAdmin&&e.$hasPermission("extp:delete:permission.do")?t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleDeleteDriveChange(a.row)}}},[e._v(" "+e._s(e.$t("deleteBatch"))+" ")]):e._e()]}}])})],1),t("el-pagination",{staticStyle:{"margin-top":"20px","text-align":"right"},attrs:{"current-page":e.page,"page-sizes":[20,50,100,200],"page-size":e.limit,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"size-change":e.pageSizeChangeHandle,"current-change":e.pageCurrentChangeHandle}}),e.plugindownloadVisible?t("plugindownloadAddOrUpdate",{ref:"plugindownloadAddOrUpdateRef",attrs:{plugindownloadPropId:e.plugindownloadPropId},on:{refreshDataList:e.getDataList}}):e._e()],1)},r=[],o=a("53ca"),i=(a("4917"),a("ac6a"),a("7f7f"),a("c5f6"),a("a481"),a("b047")),l=a.n(i),s=a("b311"),c=a.n(s),d=a("376b"),u=a("f63b"),p={data:function(){return{page:1,limit:20,total:0,plugindownloadPropId:null,plugindownloadVisible:!1,currentUserSuperAdmin:null,dataListLoading:!1,checkedPlugindownloadIds:[],checkedPlugindownloadUrls:[],checkboxConfig:{reserve:!0,highlight:!0},dataList:[],dataForm:{fuzzy:"",platform:""},platformList:[{label:"A7",value:0},{label:"arm9",value:1},{label:"x86-linux",value:2},{label:"A53",value:3},{label:"A9",value:4}],scrollTableHeight:window.innerHeight-220-53,websocket:null,websocketData:[]}},components:{plugindownloadAddOrUpdate:u["default"]},methods:{pageSizeChangeHandle:function(e){this.page=1,this.limit=e,this.getDataList()},pageCurrentChangeHandle:function(e){this.page=e,this.getDataList()},querySearch:function(){this.page=1,this.getDataList()},getDataList:l()((function(){var e=this,t={pageNum:this.page,pageSize:this.limit};this.dataForm.fuzzy&&(t["fuzzy"]=this.dataForm.fuzzy.replace(/_/g,"\\_").replace(/%/g,"\\%")),""!=String(this.dataForm.platform)&&(t["platform"]=this.dataForm.platform),this.total=0,this.dataList=[],this.$hasPermission("extp:select:permission.do")?(this.dataListLoading=!0,this.$http.get("/extp/getPage.do",{params:t}).then((function(a){var n=a.data;if(e.checkedPlugindownloadIds=[],e.checkedPlugindownloadUrls=[],0!=n.code)return e.dataListLoading=!1,e.$message.error(n.data||n.msg);e.page=t.pageNum,e.dataList=n.data.list,e.total=Number(n.data.total),e.$refs.recordTable&&(e.$refs.recordTable.clearCheckboxRow(),e.$refs.recordTable.loadData(e.dataList).then((function(){e.dataListLoading=!1})).finally((function(){})))})).catch((function(t){return e.dataListLoading=!1,!1}))):this.$message.warning("暂无插件查询权限, 请联系管理员")}),100,{leading:!0,trailing:!1}),getRowKey:function(e){return e.id},copyFileUrl:l()((function(e){var t=this,a=e.re1,n=new c.a(".copy",{text:function(){return a}});n.on("success",(function(e){t.$message({message:t.$t("upgrade.copySuccess"),showClose:!0,type:"success"}),n.destroy()})),n.on("error",(function(e){t.$message({message:t.$t("upgrade.copyFail"),showClose:!0,type:"error"}),n.destroy()}))}),1e3,{leading:!0,trailing:!1}),handleDownLoadChange:function(e){var t=new XMLHttpRequest;t.open("GET",e.re1,!0),t.responseType="blob",t.onload=function(){if(200===t.status){var a=t.response,n=document.createElement("a"),r=window.URL.createObjectURL(a);n.href=r,n.download="ioserver_extp_"+e.name+"_"+e.ver+".tar.gz",document.body.appendChild(n),n.click()}},t.send()},handleAddOrUpdate:function(e){var t=this;this.plugindownloadVisible=!0,this.$nextTick((function(){t.plugindownloadPropId=null,e&&(t.plugindownloadPropId=e.id),t.$refs.plugindownloadAddOrUpdateRef.init()}))},selectAll:function(e){var t=this,a=this.$refs.recordTable.getCheckboxRecords(!1);this.checkedPlugindownloadIds=[],this.checkedPlugindownloadUrls=[],a.forEach((function(e){t.checkedPlugindownloadIds.push(e.id),e.re1&&t.checkedPlugindownloadUrls.push(e.re1)}))},dataListSelectionHandle:function(e){var t=this,a=this.$refs.recordTable.getCheckboxRecords(!1);this.checkedPlugindownloadIds=[],this.checkedPlugindownloadUrls=[],a.forEach((function(e){t.checkedPlugindownloadIds.push(e.id),e.re1&&t.checkedPlugindownloadUrls.push(e.re1)}))},browserType:function(){var e=navigator.userAgent.toLowerCase(),t={ie:function(){return!(!window.ActiveXObject&&!("ActiveXObject"in window))},edge:function(){return/dge/.test(e)},chrome:function(){return/chrome/.test(e)},safari:function(){return/safari/.test(e)&&!/chrome/.test(e)},opera:function(){return/opera/.test(e)},msie:function(){return/msie/.test(e)&&!/opera/.test(e)},mozilla:function(){return/mozilla/.test(e)&&!/(compatible|webkit)/.test(e)}},a={};for(var n in t){var r=t[n](),o=(e.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1];if(r)return a.browser=n,a.version=o,a}},handleDownLoadDriveChange:function(e){var t=this,a={},n=[];if(e)a["ids"]=e.id,e.re1&&(n=n.push(e.re1));else{if(0===t.checkedPlugindownloadIds.length)return t.$message.warning(t.$t("driver.pleaseSelectDataSourceToDownload"));a["ids"]=t.checkedPlugindownloadIds.join(",")}t.$hasPermission("drivers:download:permission.do")?t.$http.get("/drivers/download.do",{params:a}).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);var n=a.data,r=new XMLHttpRequest;r.open("get",n),r.responseType="blob",r.send(),r.onreadystatechange=function(){if(4==r.readyState&&200==r.status){var e=t.browserType();if("ie"!==e.browser||"10.0"!=e.version&&"11.0"!=e.version)window.location.href=n;else{var a=document.createElement("iframe");a.src=n,a.style.display="none",document.body.appendChild(a)}}}})).catch((function(e){return t.getDataList(),!1})):t.$message.warning("暂无插件下载权限, 请联系管理员")},handleDeleteDriveChange:l()((function(e){var t=this,a={};if(e)a["ids"]=e.id,e.re1&&[].concat(e.re1);else{if(0===t.checkedPlugindownloadIds.length)return t.$message.error(t.$t("deleteInfo.noData"));a["ids"]=t.checkedPlugindownloadIds.join(","),t.checkedPlugindownloadUrls}t.$hasPermission("extp:delete:permission.do")?t.$confirm(t.$t("deleteInfo.noticeTitle"),t.$t("deleteInfo.noticePrompt"),{confirmButtonText:t.$t("deleteInfo.confirm"),cancelButtonText:t.$t("deleteInfo.cancel"),type:"warning"}).then((function(){t.$http.delete("/extp/delete.do",{params:a}).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.checkedPlugindownloadUrls.length>0?t.checkedPlugindownloadUrls.forEach((function(e){t.$http.delete("/goFastDfs/deleteFile.do?path="+e).then((function(e){e.data})).catch((function(e){return!1}))})):(t.$message.success(t.$t("deleteInfo.deleteSuccess")),t.getDataList())})).catch((function(e){return t.getDataList(),!1}))})).catch((function(e){})):t.$message.warning("暂无插件删除权限, 请联系管理员")}),100,{leading:!0,trailing:!1}),resetExcelData:function(e){var t=[];this.dataList.forEach((function(e){var a={showName:e.showName,platform:0==e.platform?"A7":1==e.platform?"arm9":2==e.platform?"x86-linux":3==e.platform?"A53":4==e.platform?"A9":"--",ver:"V"+e.ver,md5:e.md5};t.push(a)})),e(t)},handleExportExcel:l()((function(){var e=this;if(0==this.dataList.length)return this.$message.warning(this.$t("gwsn.thereIsCurrentlyNoDataAvailableForExport"));Promise.resolve().then(function(){e.resetExcelData((function(t){for(var a=[{label:e.$t("pluginInManage.name"),prop:"showName"},{label:e.$t("pluginInManage.platform"),prop:"platform"},{label:e.$t("pluginInManage.serverVersion"),prop:"ver"},{label:"MD5",prop:"md5"}],n=[],r=[],o=0;o<a.length;o++)n[o]=a[o].label,r[o]=a[o].prop;var i=n,l=r,s=t,c=e.formatJson(l,s);Object(d["a"])(i,c,e.$t("pluginInManage.pluginInDownloadList")+"_"+(new Date).getTime())}))}.bind(null,a)).catch(a.oe)}),1e3,{leading:!0,trailing:!1}),formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))})),t.map((function(t){return e.map((function(e){return t[e]}))}))},createWebSocket:function(){var e=this;if(!("WebSocket"in window))return e.$message.error(e.$t("currentBrowerSupportWebSocket"));try{var t=window.SITE_CONFIG["socketUrl"]+"heart/".concat(e.scriptInfo.gwSn,"/").concat(md5Str)+"?token="+e.$getToken();e.websocket=new WebSocket(t),e.initWebSocket()}catch(a){return e.$message.error(e.$t("websocket.createConnectFail"))}},initOnlineWebSocket:function(){this.websocket.onopen=this.websocketonopen,this.websocket.onerror=this.websocketonerror,this.websocket.onmessage=this.websocketonmessage,this.websocket.onclose=this.websocketonclose},websocketonopen:function(){var e=this;setTimeout((function(){if(e.websocket)return e.websocket.close(),e.websocket=null,e.$message.error(e.$t("issue.timeout"))}),"30000")},websocketonerror:function(e){return this.$message.error(this.$t("websocket.createConnectFail"))},isJsonString:function(e){if("string"===typeof e)try{var t=JSON.parse(e);return!("object"!==Object(o["a"])(t)||!t)}catch(a){return!1}},websocketonmessage:function(e){var t=this;if(!t.isJsonString(e.data))return!1;t.websocket&&(t.websocket.close(),t.websocket=null);var a=JSON.parse(e.data).res_content;"{}"!=JSON.stringify(a)&&a.platform==t.dataForm.platform&&a.extp.forEach((function(e){t.dataList.forEach((function(a){e.name==a.name&&t.$set(a,"mainVer",e.ver)}))}))},websocketonclose:function(e){}},updated:function(){this.$refs.recordTable&&this.$refs.recordTable.doLayout&&this.$refs.recordTable.doLayout()},mounted:function(){var e=this;this.currentUserSuperAdmin=this.$store.state.user.superAdmin,this.getDataList(),window.onresize=function(){return function(){e.scrollTableHeight=window.innerHeight-220-53,e.$refs.recordTable&&e.$refs.recordTable.doLayout&&e.$refs.recordTable.doLayout()}()}},watch:{total:function(){this.total==(this.page-1)*this.limit&&0!=this.total&&(this.page-=1,sessionStorage.setItem("page9",this.page),this.getDataList())}}},f=p,h=a("2877"),g=Object(h["a"])(f,n,r,!1,null,null,null);t["default"]=g.exports},"2a1f":function(e,t,a){"use strict";a.r(t);a("34ef"),a("28a5"),a("6b54"),a("4917");
/*! @source http://purl.eligrey.com/github/Blob.js/blob/master/Blob.js */
(function(e){if(e.URL=e.URL||e.webkitURL,e.Blob&&e.URL)try{return void new Blob}catch(n){}var t=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||function(e){var t=function(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]},a=function(){this.data=[]},n=function(e,t,a){this.data=e,this.size=e.length,this.type=t,this.encoding=a},r=a.prototype,o=n.prototype,i=e.FileReaderSync,l=function(e){this.code=this[this.name=e]},s="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),c=s.length,d=e.URL||e.webkitURL||e,u=d.createObjectURL,p=d.revokeObjectURL,f=d,h=e.btoa,g=e.atob,m=e.ArrayBuffer,b=e.Uint8Array,w=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;n.fake=o.fake=!0;while(c--)l.prototype[s[c]]=c+1;return d.createObjectURL||(f=e.URL=function(e){var t,a=document.createElementNS("http://www.w3.org/1999/xhtml","a");return a.href=e,"origin"in a||("data:"===a.protocol.toLowerCase()?a.origin=null:(t=e.match(w),a.origin=t&&t[1])),a}),f.createObjectURL=function(e){var t,a=e.type;return null===a&&(a="application/octet-stream"),e instanceof n?(t="data:"+a,"base64"===e.encoding?t+";base64,"+e.data:"URI"===e.encoding?t+","+decodeURIComponent(e.data):h?t+";base64,"+h(e.data):t+","+encodeURIComponent(e.data)):u?u.call(d,e):void 0},f.revokeObjectURL=function(e){"data:"!==e.substring(0,5)&&p&&p.call(d,e)},r.append=function(e){var a=this.data;if(b&&(e instanceof m||e instanceof b)){for(var r="",o=new b(e),s=0,c=o.length;s<c;s++)r+=String.fromCharCode(o[s]);a.push(r)}else if("Blob"===t(e)||"File"===t(e)){if(!i)throw new l("NOT_READABLE_ERR");var d=new i;a.push(d.readAsBinaryString(e))}else e instanceof n?"base64"===e.encoding&&g?a.push(g(e.data)):"URI"===e.encoding?a.push(decodeURIComponent(e.data)):"raw"===e.encoding&&a.push(e.data):("string"!==typeof e&&(e+=""),a.push(unescape(encodeURIComponent(e))))},r.getBlob=function(e){return arguments.length||(e=null),new n(this.data.join(""),e,"raw")},r.toString=function(){return"[object BlobBuilder]"},o.slice=function(e,t,a){var r=arguments.length;return r<3&&(a=null),new n(this.data.slice(e,r>1?t:this.data.length),a,this.encoding)},o.toString=function(){return"[object Blob]"},o.close=function(){this.size=0,delete this.data},a}(e);e.Blob=function(e,a){var n=a&&a.type||"",r=new t;if(e)for(var o=0,i=e.length;o<i;o++)Uint8Array&&e[o]instanceof Uint8Array?r.append(e[o].buffer):r.append(e[o]);var l=r.getBlob(n);return!l.slice&&l.webkitSlice&&(l.slice=l.webkitSlice),l};var a=Object.getPrototypeOf||function(e){return e.__proto__};e.Blob.prototype=a(new e.Blob)})("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||void 0)},"376b":function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));a("6b54"),a("34ef"),a("ac6a");function n(e,t){t&&(e+=1462);var a=Date.parse(e);return(a-new Date(Date.UTC(1899,11,30)))/864e5}function r(e,t){for(var a={},r={s:{c:1e7,r:1e7},e:{c:0,r:0}},o=0;o!=e.length;++o)for(var i=0;i!=e[o].length;++i){r.s.r>o&&(r.s.r=o),r.s.c>i&&(r.s.c=i),r.e.r<o&&(r.e.r=o),r.e.c<i&&(r.e.c=i);var l={v:e[o][i]};if(null!=l.v){var s=XLSX.utils.encode_cell({c:i,r:o});"number"===typeof l.v?l.t="n":"boolean"===typeof l.v?l.t="b":l.v instanceof Date?(l.t="n",l.z=XLSX.SSF._table[14],l.v=n(l.v)):l.t="s",a[s]=l}}return r.s.c<1e7&&(a["!ref"]=XLSX.utils.encode_range(r)),a}function o(){if(!(this instanceof o))return new o;this.SheetNames=[],this.Sheets={}}function i(e){for(var t=new ArrayBuffer(e.length),a=new Uint8Array(t),n=0;n!=e.length;++n)a[n]=255&e.charCodeAt(n);return t}function l(e,t,a){var n=t;n.unshift(e);for(var l="SheetJS",s=new o,c=r(n),d=n.map((function(e){return e.map((function(e){return null==e?{wch:10}:e.toString().charCodeAt(0)>255?{wch:2*e.toString().length+5}:{wch:e.toString().length+5}}))})),u=d[0],p=1;p<d.length;p++)for(var f=0;f<d[p].length;f++)u[f]["wch"]<d[p][f]["wch"]&&(u[f]["wch"]=d[p][f]["wch"]);c["!cols"]=u,s.SheetNames.push(l),s.Sheets[l]=c;var h=XLSX.write(s,{bookType:"xlsx",bookSST:!1,type:"binary"}),g=a||"列表";saveAs(new Blob([i(h)],{type:"application/octet-stream"}),g+".xlsx")}a("2a1f"),a("0fd4"),a("1447")},f63b:function(e,t,a){"use strict";a.r(t);a("7f7f");var n=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.visible,title:e.dataForm.id?e.$t("update"):e.$t("add"),"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t},opened:e.handleDialogOpenChange}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataForm",attrs:{model:e.dataForm,rules:e.rules,"label-width":"120px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dataFormSubmitHandle()}}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{staticClass:"menu-list",attrs:{prop:"platform",label:e.$t("pluginInManage.platform")}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:!1,placeholder:e.$t("pluginInManage.pleaseSelectPlatform")},model:{value:e.dataForm.platform,callback:function(t){e.$set(e.dataForm,"platform",t)},expression:"dataForm.platform"}},e._l(e.platformList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"name",label:e.$t("pluginInManage.name")}},[t("el-input",{attrs:{placeholder:e.$t("pluginInManage.pleaseEnterName"),clearable:""},model:{value:e.dataForm.name,callback:function(t){e.$set(e.dataForm,"name",t)},expression:"dataForm.name"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"showName",label:e.$t("pluginInManage.showName")}},[t("el-input",{attrs:{placeholder:e.$t("pluginInManage.pleaseEnterShowname"),clearable:""},model:{value:e.dataForm.showName,callback:function(t){e.$set(e.dataForm,"showName",t)},expression:"dataForm.showName"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"ver",label:e.$t("pluginInManage.versionNumber")}},[t("el-input",{attrs:{placeholder:e.$t("pluginInManage.pleaseEnterNameServerVersion"),clearable:""},model:{value:e.dataForm.ver,callback:function(t){e.$set(e.dataForm,"ver",t)},expression:"dataForm.ver"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"md5",label:"MD5"}},[t("el-input",{attrs:{placeholder:e.$t("pluginInManage.pleaseEnterMd5"),clearable:""},model:{value:e.dataForm.md5,callback:function(t){e.$set(e.dataForm,"md5",t)},expression:"dataForm.md5"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{xs:24,sm:24,md:12,lg:12,xl:12}},[t("el-form-item",{attrs:{label:e.$t("pluginInManage.uploadFile")}},[t("el-upload",{staticClass:"upload-demo",attrs:{action:"",drag:"","http-request":e.uploadSectionFile,"on-remove":e.handleRemove,"file-list":e.fileList,"before-upload":e.beforeUpload}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text",domProps:{innerHTML:e._s(e.$t("pluginInManage.dragFileHere"))}})])],1)],1)],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:e.handleClose}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmitHandle()}}},[e._v(e._s(e.$t("confirm")))])],1)],2)},r=[],o=(a("8e6e"),a("ac6a"),a("456d"),a("ade3")),i=a("b047"),l=a.n(i);function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){Object(o["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var d={props:["plugindownloadPropId"],data:function(){return{visible:!1,loading:!1,fileList:[],dataForm:{id:"",md5:"",name:"",showName:"",ver:"",platform:"",re1:"",re2:"",re3:""},rules:{name:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],showName:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],platform:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],ver:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],md5:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]},platformList:[{label:"A7",value:0},{label:"arm9",value:1},{label:"x86-linux",value:2},{label:"A53",value:3},{label:"A9",value:4}]}},methods:{init:function(){this.visible=!0},handleDialogOpenChange:function(){this.$refs["dataForm"].resetFields(),this.fileList=[],this.dataForm.id=this.plugindownloadPropId,this.dataForm.id&&this.getInfo()},beforeUpload:function(e){},handleRemove:function(e,t){this.fileList=t},uploadSectionFile:function(e){var t=this,a=this,n=new FormData;a.$hasPermission("goFastDfs:uploadFile:permission.do")?(n.append("multipartFile",e.file),a.fileList=[].concat(e.file),a.loading=!0,a.$http.post("/goFastDfs/uploadFile.do",n).then((function(e){var n=e.data;0==n.code?(a.dataForm.re1=n.data,a.$message.success(t.$t("template.uploadSuccess")),a.loading=!1):(a.$message.error(n.data||t.$t("template.uploadError")),a.loading=!1)})).catch((function(e){return t.loading=!1,!1}))):a.$message.warning("暂无上传文件权限, 请联系管理员")},getInfo:function(){var e=this;this.$hasPermission("extp:select:permission.do")?(this.loading=!0,this.$http.get("/extp/select.do",{params:{id:this.dataForm.id}}).then((function(t){var a=t.data;if(a.hasOwnProperty("code")&&0!=a.code)return e.loading=!1,e.$message.error(a.data||a.msg);e.dataForm=c(c({},e.dataForm),a.data),e.loading=!1})).catch((function(t){return e.loading=!1,!1}))):this.$message.warning("暂无插件查询权限, 请联系管理员")},handleClose:l()((function(){this.visible=!1}),1e3,{leading:!0,trailing:!1}),dataFormSubmitHandle:l()((function(){var e=this;this.$refs["dataForm"].validate((function(t){if(!t)return!1;var a="/extp/insert.do";if(e.dataForm.id){if(a="/extp/update.do",!e.$hasPermission("extp:update:permission.do"))return void e.$message.warning("暂无插件修改权限, 请联系管理员")}else{if(0==e.fileList.length)return e.$message.warning(e.$t("pluginInManage.fileEmptyPleaseUploadFile"));if(!e.$hasPermission("extp:insert:permission.do"))return void e.$message.warning("暂无插件新增权限, 请联系管理员")}e.loading=!0,e.$http[e.dataForm.id?"put":"post"](a,[e.dataForm]).then((function(t){var a=t.data;if(0!=a.code)return e.loading=!1,e.$message.error(a.data||a.msg);e.loading=!1,e.$message.success(a.msg),e.visible=!1,e.$emit("refreshDataList")})).catch((function(t){return e.loading=!1,e.visible=!1,e.$emit("refreshDataList"),!1}))}))}),1e3,{leading:!0,trailing:!1})}},u=d,p=a("2877"),f=Object(p["a"])(u,n,r,!1,null,null,null);t["default"]=f.exports}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3450dc30"],{7536:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("section",[e("div",{attrs:{id:"tagTemplateServicesQueryContainer"}},[e("el-form",{attrs:{inline:!0,id:"tagForm",model:t.dataForm},nativeOn:{submit:function(t){t.preventDefault()},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.querySearch()}}},[e("el-row",[e("el-form-item",{attrs:{label:t.$t("tagTemplate.belongAgreement")}},[e("el-select",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.handleProtocolScroll,expression:"handleProtocolScroll"}],attrs:{size:"small",filterable:"",placeholder:t.$t("attribute.placeholderSelect")},on:{change:t.handleProtocol,"visible-change":t.handleProtocolVisibleChange},model:{value:t.dataForm.protocolname,callback:function(e){t.$set(t.dataForm,"protocolname",e)},expression:"dataForm.protocolname"}},[[e("div",{staticStyle:{width:"100%",position:"absolute",left:"0",top:"0","z-index":"99","background-color":"#fff"}},[e("el-input",{ref:"protocolInput",staticStyle:{width:"98%","margin-left":"1%","margin-top":"5px","margin-bottom":"5px"},attrs:{size:"small",clearable:"",placeholder:t.$t("gwsn.pleaseEnterSearchContent")},model:{value:t.protocolSearch,callback:function(e){t.protocolSearch=e},expression:"protocolSearch"}})],1),e("div",{staticStyle:{width:"100%",height:"42px"}}),t._l(t.protocolList,(function(t){return e("el-option",{key:t.id,attrs:{label:t.proName,value:t.id}})}))]],2)],1),e("el-form-item",{attrs:{label:t.$t("attribute.alarmtype")}},[e("div",{staticStyle:{width:"150px"}},[e("el-select",{attrs:{size:"small",clearable:"",placeholder:t.$t("attribute.placeholderSelect")},on:{change:t.querySearch},model:{value:t.dataForm.alarmtype,callback:function(e){t.$set(t.dataForm,"alarmtype",e)},expression:"dataForm.alarmtype"}},t._l(t.alarmtypeList,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)]),e("el-form-item",{attrs:{label:t.$t("attribute.collectType")}},[e("el-select",{attrs:{size:"small",filterable:"",multiple:"","collapse-tags":"",clearable:"",placeholder:t.$t("attribute.placeholderSelect")},on:{change:t.handleFuncode},model:{value:t.dataForm.collecttypec,callback:function(e){t.$set(t.dataForm,"collecttypec",e)},expression:"dataForm.collecttypec"}},t._l(t.funcodeList,(function(t){return e("el-option",{key:t.FuncCode,attrs:{label:t.description,value:t.FuncCode}})})),1)],1),e("el-form-item",[e("el-input",{attrs:{size:"small",placeholder:t.$t("configuration.pleaseEnterTheNameOrDescriptionOfTheMeasuringPoint"),clearable:""},on:{clear:t.querySearch},model:{value:t.dataForm.tagname,callback:function(e){t.$set(t.dataForm,"tagname",e)},expression:"dataForm.tagname"}})],1),t.$hasPermission("tagTemplate:select:permission.do")?e("el-form-item",[e("el-button",{attrs:{size:"small",icon:"el-icon-search"},on:{click:function(e){return t.querySearch()}}},[t._v(t._s(t.$t("query")))])],1):t._e(),t.$hasPermission("tagTemplate:insert:permission.do")&&t.isShowSetting?e("el-form-item",[e("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(e){return t.handleAddOrUpdate()}}},[t._v(t._s(t.$t("add"))+" ")])],1):t._e(),t.$hasPermission("tagTemplate:delete:permission.do")&&t.isShowSetting?e("el-form-item",[e("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete",disabled:0===t.tagIds.length||0===t.dataList.length},on:{click:function(e){return t.deleteHandle()}}},[t._v(t._s(t.$t("deleteBatch"))+" ")])],1):t._e(),t.$hasPermission("tagTemplate:import:permission.do")&&t.isShowSetting?e("el-form-item",[e("el-upload",{staticClass:"upload-demo",attrs:{size:"small",disabled:t.addDisabled,action:"","on-change":t.handleChange,"http-request":t.uploadSectionFile,"on-remove":t.handleRemove,"file-list":t.fileList,limit:1,"before-upload":t.beforeUploadHandle,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel","show-file-list":!1}},[e("el-tooltip",{attrs:{content:t.$t("onlyXlsxFilesUploaded"),placement:"top"}},[e("el-button",{attrs:{size:"small",disabled:t.addDisabled,type:"primary",icon:"el-icon-upload"}},[t._v(t._s(t.$t("import"))+" ")])],1)],1)],1):t._e(),t.$hasPermission("tagTemplate:exports:permission.do")&&t.isShowSetting?e("el-form-item",[e("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-download",disabled:0===t.tagIds.length||0===t.dataList.length},on:{click:t.handleExportTagChange}},[t._v(t._s(t.$t("export"))+" ")])],1):t._e(),t.$hasPermission("tagTemplate:select:permission.do")?e("el-form-item",[e("el-button",{attrs:{size:"small",type:"success"},on:{click:t.getDataList}},[e("i",{staticClass:"el-icon-refresh"})])],1):t._e()],1)],1)],1),t.scrollTableHeight?e("div",[e("vxe-table",{ref:"recordTable",staticStyle:{width:"100%"},attrs:{size:"mini",border:"",resizable:"","auto-resize":"","sync-resize":"","show-overflow":"","show-header-overflow":"","highlight-hover-row":"","highlight-current-row":"","max-height":t.scrollTableHeight,loading:t.dataListLoading,"row-config":{keyField:"id"},"checkbox-config":t.checkboxConfig,"scroll-y":{enabled:!0},"scroll-x":{enable:!0,scrollToLeftOnChange:!0}},on:{"checkbox-all":t.selectAll,"checkbox-change":t.dataListSelectionHandleChange,scroll:t.handleScrollChange}},[e("vxe-table-column",{attrs:{type:"checkbox","header-align":"center",align:"center",width:"60",fixed:"left",checked:!1}}),e("vxe-table-column",{attrs:{field:"id",title:t.$t("attribute.number"),"header-align":"center",align:"center",width:"90",fixed:"left"}}),e("vxe-table-column",{attrs:{field:"tagName",title:t.$t("attribute.tagname"),"header-align":"center",align:"center",width:"210",fixed:"left","show-overflow-tooltip":!0}}),e("vxe-table-column",{attrs:{field:"tagCommentStr",title:t.$t("parameterTemplate.measuringPointDescription"),"header-align":"center",align:"center",width:"180","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.tagCommentStr||t.$t("attribute.noContent")))])]}}],null,!1,767020953)}),e("vxe-table-column",{attrs:{field:"alarmType",title:t.$t("attribute.alarmtype"),"header-align":"center",align:"center",width:"100",formatter:t.formatterAlarmtype}}),e("vxe-table-column",{attrs:{field:"tagK",title:t.$t("attribute.tagkk"),"header-align":"center",align:"center",width:"100"}}),e("vxe-table-column",{attrs:{field:"collectTypeCstr",title:t.$t("attribute.collectCollecttypec"),"header-align":"center",align:"center",width:"140",formatter:t.formatterCollecttypec,"show-overflow-tooltip":!0}}),e("vxe-table-column",{attrs:{field:"objAddr",title:t.$t("attribute.registerAddress"),"header-align":"center",align:"center",width:"120",sortable:"","show-overflow-tooltip":!0}}),e("vxe-table-column",{attrs:{field:"isUpload",title:t.$t("attribute.upload"),"header-align":"center",align:"center",width:"60",formatter:t.formatterIsupload}}),e("vxe-table-column",{attrs:{field:"tagGroup",title:t.$t("attribute.group"),"header-align":"center",align:"center",width:"60"}}),e("vxe-table-column",{attrs:{field:"dataType",title:t.$t("attribute.datatype"),"header-align":"center",align:"center",width:"130",formatter:t.formatterDatatype}}),e("vxe-table-column",{attrs:{field:"dataFormat",title:t.$t("attribute.dataformat"),"header-align":"center",align:"center",width:"80",formatter:t.formatterDataformat}}),e("vxe-table-column",{attrs:{field:"enableBit",title:t.$t("attribute.isbit"),"header-align":"center",align:"center",width:"80",formatter:t.formatterbit}}),e("vxe-table-column",{attrs:{field:"enableAlarm",title:t.$t("attribute.enablealarm"),"header-align":"center",align:"center",width:"80",formatter:t.formatterAlarm}}),e("vxe-table-column",{attrs:{field:"enableHisSave",title:t.$t("attribute.enablehissave"),"header-align":"center",align:"center",width:"110",formatter:t.formatterHistory}}),e("vxe-table-column",{attrs:{field:"tagRWProp",title:t.$t("attribute.tagrwprop"),"header-align":"center",align:"center",width:"80",formatter:t.formatterRwtype}}),e("vxe-table-column",{attrs:{field:"tagB",title:t.$t("attribute.tagbb"),"header-align":"center",align:"center",width:"80"}}),(t.$hasPermission("tagTemplate:update:permission.do")||t.$hasPermission("tagTemplate:delete:permission.do"))&&t.isShowSetting?e("vxe-table-column",{attrs:{title:t.$t("handle"),"header-align":"center",align:"center",width:"120",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[t.$hasPermission("tagTemplate:update:permission.do")?e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.handleAddOrUpdate(a.row.id)}}},[t._v(t._s(t.$t("update"))+" ")]):t._e(),t.$hasPermission("tagTemplate:delete:permission.do")?e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.deleteHandle(a.row)}}},[t._v(t._s(t.$t("delete")))]):t._e()]}}],null,!1,1343035400)}):t._e()],1),e("vxe-pager",{attrs:{perfect:"",size:"mini",loading:t.pagerLoading,"current-page":t.page,"page-size":t.limit,"page-sizes":[100,200,500,1e3],total:t.total,layouts:["PrevPage","JumpNumber","NextPage","FullJump","Sizes","Total"]},on:{"page-change":t.handlePageChange}})],1):t._e(),t.addOrUpdateVisible?e("add-or-update",{ref:"addOrUpdate",attrs:{protocolname:t.dataForm.protocolname},on:{refreshDataList:t.getDataList}}):t._e(),e("el-dialog",{attrs:{title:t.$t("attribute.editMultiple"),"close-on-click-modal":!1,"close-on-press-escape":!1,visible:t.editAllVisible},on:{"update:visible":function(e){t.editAllVisible=e}}},[e("el-form",{ref:"editForm",attrs:{model:t.editForm,rules:t.rules,"label-width":(t.$i18n.locale,"120px")},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.dataFormSubmitHandle()}}},[e("el-row",[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.editType"),prop:"type"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:t.$t("attribute.placeholderSelect")},on:{change:t.selectChanged},model:{value:t.editForm.type,callback:function(e){t.$set(t.editForm,"type",e)},expression:"editForm.type"}},t._l(t.editTypeLists,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),"limitValueEnable"==t.editForm.type?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("configuration.limitEnable"),prop:"limitValueEnable"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:t.$t("select")},model:{value:t.editForm.limitValueEnable,callback:function(e){t.$set(t.editForm,"limitValueEnable",e)},expression:"editForm.limitValueEnable"}},t._l(t.limitValueEnableList,(function(t,a){return e("el-option",{key:a,attrs:{label:t.label,value:t.value}})})),1)],1)],1):t._e(),"limitValueEnable"==t.editForm.type?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{prop:"minValue",label:t.$t("tagTemplate.limitMinimumValue")}},[e("el-input",{attrs:{disabled:0==t.editForm.limitValueEnable||2==t.editForm.limitValueEnable,maxLength:-1!=String(t.editForm.minValue).indexOf(".")?String(t.editForm.minValue).substring(0,String(t.editForm.minValue).indexOf(".")).length+3:1e8,onkeyup:"value=value.replace(/[^\\-\\d.]/g,'').replace(/^\\./g,'').replace('.','$#$').replace(/\\./g,'').replace('$#$','.').replace('-','$#$').replace(/\\-/g,'').replace('$#$','-')",placeholder:t.$t("tagTemplate.pleaseEnterLimitMinimumValue")},model:{value:t.editForm.minValue,callback:function(e){t.$set(t.editForm,"minValue",e)},expression:"editForm.minValue"}})],1)],1):t._e(),"limitValueEnable"==t.editForm.type?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{prop:"maxValue",label:t.$t("tagTemplate.limitMaximumValue")}},[e("el-input",{attrs:{disabled:0==t.editForm.limitValueEnable||1==t.editForm.limitValueEnable,maxLength:-1!=String(t.editForm.maxValue).indexOf(".")?String(t.editForm.maxValue).substring(0,String(t.editForm.maxValue).indexOf(".")).length+3:1e8,onkeyup:"value=value.replace(/[^\\-\\d.]/g,'').replace(/^\\./g,'').replace('.','$#$').replace(/\\./g,'').replace('$#$','.').replace('-','$#$').replace(/\\-/g,'').replace('$#$','-')",placeholder:t.$t("tagTemplate.pleaseEnterLimitMaximumValue")},model:{value:t.editForm.maxValue,callback:function(e){t.$set(t.editForm,"maxValue",e)},expression:"editForm.maxValue"}})],1)],1):t._e(),"limitValueEnable"==t.editForm.type?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{prop:"limitdataFormat",label:t.$t("configuration.formulaCalculation")}},[e("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:t.$t("select")},model:{value:t.editForm.limitdataFormat,callback:function(e){t.$set(t.editForm,"limitdataFormat",e)},expression:"editForm.limitdataFormat"}},t._l(t.limitdataFormatLists,(function(t,a){return e("el-option",{key:a,attrs:{label:t.label,value:t.value}})})),1)],1)],1):t._e(),"tagk"==t.editForm.type?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("configuration.intelligentConversion")}},[e("el-switch",{model:{value:t.editForm.smartTransform,callback:function(e){t.$set(t.editForm,"smartTransform",e)},expression:"editForm.smartTransform"}}),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("configuration.enableIntelligentConversion"),placement:"top-start"}},[e("i",{staticClass:"el-icon-question",staticStyle:{"margin-left":"5px"}})])],1)],1):t._e(),"tagk"==t.editForm.type&&t.editForm.smartTransform?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("configuration.dataSourceConversionList")}},[e("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:t.handleAddSmartTransDataChange}},[t._v(t._s(t.$t("attribute.addTo")))]),e("el-button",{attrs:{size:"small",icon:"el-icon-refresh-left"},on:{click:t.handleResetSmartTransDataChange}},[t._v(t._s(t.$t("attribute.restoreDefaultSettings")))])],1)],1):t._e(),"tagk"==t.editForm.type&&t.editForm.smartTransform?e("el-col",{attrs:{span:24}},[e("el-table",{staticStyle:{width:"100%"},attrs:{border:"",size:"small",data:t.editForm.smartTransformTableData,"max-height":300}},[e("el-table-column",{attrs:{type:"index",fixed:"left",width:"60",label:t.$t("attribute.number"),align:"center"}}),e("el-table-column",{attrs:{prop:"sourceK",label:t.$t("attribute.sourceCoefficient"),align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-input",{attrs:{size:"small",clearable:"",placeholder:t.$t("attribute.pleaseEnterTheSourceCoefficient")},model:{value:a.row.sourceK,callback:function(e){t.$set(a.row,"sourceK",e)},expression:"scope.row.sourceK"}})]}}],null,!1,2012649611)}),e("el-table-column",{attrs:{prop:"targetK",label:t.$t("attribute.targetCoefficient"),align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-input",{attrs:{size:"small",clearable:"",placeholder:t.$t("attribute.pleaseEnterTheTargetCoefficient")},model:{value:a.row.targetK,callback:function(e){t.$set(a.row,"targetK",e)},expression:"scope.row.targetK"}})]}}],null,!1,1408891147)}),e("el-table-column",{attrs:{fixed:"right",label:t.$t("handle"),width:"60",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.handleDeleteSmartTransDataChange(a.$index)}}},[t._v(t._s(t.$t("delete")))])]}}],null,!1,3290636014)})],1)],1):t._e(),"tagk"!=t.editForm.type||t.editForm.smartTransform?t._e():e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.editValue"),prop:"value"}},[e("el-input",{attrs:{placeholder:t.$t("attribute.editValue")},model:{value:t.editForm.value,callback:function(e){t.$set(t.editForm,"value",e)},expression:"editForm.value"}})],1)],1),"reserve2"==t.editForm.type?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.editValue"),prop:"reserve2"}},[e("el-input",{attrs:{placeholder:t.$t("attribute.editValue")},model:{value:t.editForm.reserve2,callback:function(e){t.$set(t.editForm,"reserve2",e)},expression:"editForm.reserve2"}})],1)],1):t._e(),"tagname"==t.editForm.type?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.editWay"),prop:"way"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:t.$t("attribute.placeholderSelect"),filterable:""},model:{value:t.editForm.way,callback:function(e){t.$set(t.editForm,"way",e)},expression:"editForm.way"}},t._l(t.wayLists,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1):t._e(),"tagcomment"==t.editForm.type?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.editWay"),prop:"tagcommentWay"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:t.$t("attribute.placeholderSelect"),filterable:""},on:{change:t.handleTagCommentWayChange},model:{value:t.editForm.tagcommentWay,callback:function(e){t.$set(t.editForm,"tagcommentWay",e)},expression:"editForm.tagcommentWay"}},t._l(t.tagcommentWayLists,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1):t._e(),"transvalue"==t.editForm.type?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.editValue"),prop:"transValue",rules:"transvalue"===this.editForm.type?t.rules.transValue:[{required:!1,message:t.$t("attribute.requireNotNull"),trigger:"change"}]}},[e("el-input",{attrs:{placeholder:t.$t("attribute.pleaceEnterContent")},model:{value:t.editForm.transValue,callback:function(e){t.$set(t.editForm,"transValue",e)},expression:"editForm.transValue"}})],1)],1):t._e(),"taggroup"==t.editForm.type?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.editValue"),prop:"changeValue",rules:"taggroup"===this.editForm.type?t.rules.changeValue:[{required:!1,message:t.$t("attribute.requireNotNull"),trigger:"change"}]}},[e("el-autocomplete",{staticStyle:{width:"100%"},attrs:{"fetch-suggestions":t.querySearchAsync,placeholder:t.$t("attribute.pleaceEnterContent")},on:{select:t.handleSelectTaggroup},model:{value:t.editForm.changeValue,callback:function(e){t.$set(t.editForm,"changeValue",e)},expression:"editForm.changeValue"}})],1)],1):t._e(),"dataformat"==t.editForm.type||"datatype"==t.editForm.type||"tagrwprop"==t.editForm.type||"alarmtype"==t.editForm.type||"collecttypec"===t.editForm.type||"enablealarm"===t.editForm.type||"enablehissave"===t.editForm.type||"isupload"===t.editForm.type||"enablebit"===this.editForm.type||"enabletransvalue"===t.editForm.type||"startbit"===t.editForm.type||"pvflag"===t.editForm.type||"reserve3"===t.editForm.type?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"startbit"===t.editForm.type?t.$t("attribute.editValue")+"("+t.$t("attribute.increasing")+")":t.$t("attribute.editValue"),prop:"changeValue",rules:"dataformat"===this.editForm.type||"datatype"===this.editForm.type||"alarmtype"===this.editForm.type||"tagrwprop"===this.editForm.type||"collecttypec"===this.editForm.type||"enablealarm"===this.editForm.type||"enablehissave"===this.editForm.type||"isupload"===this.editForm.type||"enablebit"===this.editForm.type||"enabletransvalue"===this.editForm.type||"startbit"===this.editForm.type||"pvflag"===this.editForm.type||"reserve3"===t.editForm.type?t.rules.changeValue:[{required:!1,message:t.$t("attribute.requireNotNull"),trigger:"change"}]}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:t.$t("attribute.placeholderSelect"),filterable:""},model:{value:t.editForm.changeValue,callback:function(e){t.$set(t.editForm,"changeValue",e)},expression:"editForm.changeValue"}},t._l(t.changeList,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1):t._e(),"objaddr"==t.editForm.type?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.editWay"),prop:"objaddrWay",rules:"objaddr"===this.editForm.type?t.rules.objaddrWay:[{required:!1,message:t.$t("attribute.requireNotNull"),trigger:"change"}]}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:t.$t("attribute.placeholderSelect"),filterable:""},model:{value:t.editForm.objaddrWay,callback:function(e){t.$set(t.editForm,"objaddrWay",e)},expression:"editForm.objaddrWay"}},t._l(t.objaddrTypeList,(function(t,a){return e("el-option",{key:a,attrs:{label:t.label,value:t.value}})})),1)],1)],1):t._e(),"taginitvalue"==t.editForm.type?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.editValue"),prop:"taginitvalue",rules:"taginitvalue"===this.editForm.type?t.rules.taginitvalue:[{required:!1,message:t.$t("attribute.requireNotNull"),trigger:"change"}]}},[e("el-input",{attrs:{placeholder:t.$t("configuration.pleaseEnterTheInitialValue"),clearable:""},model:{value:t.editForm.taginitvalue,callback:function(e){t.$set(t.editForm,"taginitvalue",e)},expression:"editForm.taginitvalue"}})],1)],1):t._e(),"assistpararm"==t.editForm.type?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.editValue"),prop:"assistpararm",rules:"assistpararm"===this.editForm.type?t.rules.assistpararm:[{required:!1,message:t.$t("attribute.requireNotNull"),trigger:"change"}]}},[e("el-input",{attrs:{placeholder:t.$t("configuration.pleaseEnterAuxiliaryParameters"),clearable:""},model:{value:t.editForm.assistpararm,callback:function(e){t.$set(t.editForm,"assistpararm",e)},expression:"editForm.assistpararm"}})],1)],1):t._e()],1),e("el-row",["objaddr"==t.editForm.type&&"step"==t.editForm.objaddrWay?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.startValue"),prop:"startValue",rules:"objaddr"===this.editForm.type&&"step"==t.editForm.objaddrWay?t.rules.startValue:[{required:!1,message:t.$t("attribute.requireNotNull"),trigger:"change"}]}},[e("el-input",{attrs:{placeholder:t.$t("attribute.startValue")},model:{value:t.editForm.startValue,callback:function(e){t.$set(t.editForm,"startValue",e)},expression:"editForm.startValue"}})],1)],1):t._e(),"objaddr"==t.editForm.type&&"step"==t.editForm.objaddrWay?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.step"),prop:"step",rules:"objaddr"===this.editForm.type&&"step"==t.editForm.objaddrWay?t.rules.step:[{required:!1,message:t.$t("attribute.requireNotNull"),trigger:"change"}]}},[e("el-input",{attrs:{placeholder:t.$t("attribute.step")},model:{value:t.editForm.step,callback:function(e){t.$set(t.editForm,"step",e)},expression:"editForm.step"}})],1)],1):t._e(),"objaddr"==t.editForm.type&&"fixed"==t.editForm.objaddrWay?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.fixedValue"),prop:"fixedValue",rules:"objaddr"===this.editForm.type&&"fixed"==t.editForm.objaddrWay?t.rules.fixedValue:[{required:!1,message:t.$t("attribute.requireNotNull"),trigger:"change"}]}},[e("el-input",{attrs:{placeholder:t.$t("attribute.fixedValuePlaceholder")},model:{value:t.editForm.fixedValue,callback:function(e){t.$set(t.editForm,"fixedValue",e)},expression:"editForm.fixedValue"}})],1)],1):t._e(),"tagname"==t.editForm.type&&"replace"==t.editForm.way?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.replaceSource"),prop:"replaceStr",rules:"tagname"===this.editForm.type&&"replace"==t.editForm.way?t.rules.replaceStr:[{required:!1,message:t.$t("attribute.requireNotNull"),trigger:"change"}]}},[e("el-input",{attrs:{placeholder:t.$t("attribute.enterReplaceSource")},model:{value:t.editForm.replaceStr,callback:function(e){t.$set(t.editForm,"replaceStr",e)},expression:"editForm.replaceStr"}})],1)],1):t._e(),"tagname"==t.editForm.type?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.editValue")}},[e("el-input",{attrs:{placeholder:"replace"==t.editForm.way?t.$t("attribute.replaceName"):"prepend"==t.editForm.way?t.$t("attribute.replacePrependName"):t.$t("attribute.replaceAppendName")},model:{value:t.editForm.tagnameStr,callback:function(e){t.$set(t.editForm,"tagnameStr",e)},expression:"editForm.tagnameStr"}})],1)],1):t._e(),"tagcomment"==t.editForm.type&&"replace"==t.editForm.tagcommentWay?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.replaceSource"),prop:"replaceTagCommentStr",rules:"tagcomment"===this.editForm.type&&"replace"==t.editForm.tagcommentWay?t.rules.replaceTagCommentStr:[{required:!1,message:t.$t("attribute.requireNotNull"),trigger:"change"}]}},[e("el-input",{attrs:{placeholder:t.$t("attribute.enterReplaceSource")},model:{value:t.editForm.replaceTagCommentStr,callback:function(e){t.$set(t.editForm,"replaceTagCommentStr",e)},expression:"editForm.replaceTagCommentStr"}})],1)],1):t._e(),"tagcomment"==t.editForm.type&&"clipboardSource"!=t.editForm.tagcommentWay?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.editValue"),prop:"tagcomment"}},[e("el-input",{attrs:{placeholder:t.$t("attribute.editValue")},model:{value:t.editForm.tagcomment,callback:function(e){t.$set(t.editForm,"tagcomment",e)},expression:"editForm.tagcomment"}})],1)],1):t._e(),"tagcomment"==t.editForm.type&&"increasing"==t.editForm.tagcommentWay?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.step"),prop:"tagcommentStep"}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{"step-strictly":"","controls-position":"right",placeholder:t.$t("attribute.pleaseEnterTheStepSize")},model:{value:t.editForm.tagcommentStep,callback:function(e){t.$set(t.editForm,"tagcommentStep",e)},expression:"editForm.tagcommentStep"}})],1)],1):t._e()],1)],1),e("template",{slot:"footer"},[e("el-button",{on:{click:function(e){t.editAllVisible=!1}}},[t._v(t._s(t.$t("cancel")))]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.dataFormSubmitHandle()}}},[t._v(t._s(t.$t("confirm")))])],1)],2)],1)},r=[],l=(a("8e6e"),a("456d"),a("ade3")),s=(a("4917"),a("28a5"),a("3b2b"),a("7f7f"),a("6762"),a("2fdb"),a("ac6a"),a("55dd"),a("c5f6"),a("a481"),a("4328")),o=a.n(s),n=a("bc3a"),d=a.n(n),c=a("a78e"),u=a.n(c),m=a("b047"),g=a.n(m),h=a("e1a5"),p=a("795d"),f=a("1e5f");a("2ef0"),a("ed08");function b(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function v(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?b(Object(a),!0).forEach((function(e){Object(l["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var $={name:"taginfotemplate",mixins:[h["a"]],directives:{loadmore:{inserted:function(t,e){var a=t.querySelector(".el-select-dropdown .el-select-dropdown__wrap");a.addEventListener("scroll",(function(){var t=this.scrollHeight-Math.ceil(this.scrollTop)<=this.clientHeight;t&&0!==this.scrollTop&&e.value()}))}}},data:function(){var t=this;return{isShowSetting:!1,page:1,limit:1e3,total:0,content:"",scrollleft:0,scorlltop:0,currentPageCheccked:!1,pagerLoading:!1,checkboxConfig:{checkStrictly:!1,reserve:!0,highlight:!0,checkField:"checked"},multipleSelectionAll:[],fileList:[],dataList:[],isAddOrUpdate:!1,addDisabled:!1,changeList:[],protocolSearch:"",protocolPage:1,protocolTotal:0,protocolList:[],storeDevMap:{},tagIds:[],selectTaProtocolIds:[],tagassistIdList:[],tagIdNameList:[],tagIdKList:[],tagIdCommentList:[],funcodeList:[],selectedTagIdAndObjAddrList:[],selectFuncCode:[],queryParams:{},editAllVisible:!1,alarmtypeList:[{label:this.$t("attribute.all"),value:""},{label:this.$t("attribute.visualValue"),value:0},{label:this.$t("attribute.switchValue"),value:1},{label:this.$t("attribute.ym"),value:2},{label:this.$t("attribute.yk"),value:3},{label:this.$t("attribute.yt"),value:4}],tagrwpropList:[{label:this.$t("attribute.all"),value:""},{label:this.$t("attribute.onlyRead"),value:0},{label:this.$t("attribute.readWrite"),value:1},{label:this.$t("attribute.onlyWrite"),value:2}],mixinViewModuleOptions:{activatedIsNeed:!1},dataForm:{protocolname:"",tagname:"",alarmtype:"",collecttypec:[]},historySave:[{label:this.$t("attribute.all"),value:""},{label:this.$t("attribute.yes"),value:1},{label:this.$t("attribute.no"),value:0}],limitValueEnableList:[{label:this.$t("configuration.shut"),value:0},{label:this.$t("configuration.enableLowerLimit"),value:1},{label:this.$t("configuration.enableUpperLimit"),value:2},{label:this.$t("configuration.enableUpperAndLowerLimits"),value:3}],limitdataFormatLists:[{label:this.$t("configuration.originalValueCoefficientOffset"),value:0},{label:this.$t("configuration.originalValueOffsetCoefficient"),value:1}],editForm:{type:"objaddr",value:"1.0",startValue:0,step:1,objaddrWay:"step",fixedValue:"",way:"replace",replaceStr:"",tagnameStr:"",tagcommentWay:"replace",replaceTagCommentStr:"",tagcomment:"",tagcommentStep:1,changeValue:"",transValue:"",limitValueEnable:0,minValue:0,maxValue:1e3,limitdataFormat:0,reserve2:"1.000",smartTransform:!0,smartTransformTableData:[{sourceK:.1,targetK:10},{sourceK:.01,targetK:100},{sourceK:.001,targetK:1e3}],taginitvalue:"",assistpararm:""},wayLists:[{label:this.$t("attribute.replace"),value:"replace"},{label:this.$t("attribute.prepend"),value:"prepend"},{label:this.$t("attribute.append"),value:"append"}],tagcommentWayLists:[{label:this.$t("attribute.replace"),value:"replace"},{label:this.$t("attribute.prepend"),value:"prepend"},{label:this.$t("attribute.append"),value:"append"},{label:this.$t("attribute.increasing"),value:"increasing"},{label:this.$t("attribute.clipboardSource"),value:"clipboardSource"}],objaddrTypeList:[{label:this.$t("attribute.step"),value:"step"},{label:this.$t("attribute.tagb"),value:"fixed"}],editTypeLists:[{label:this.$t("attribute.tagname"),value:"tagname"},{label:"物模型标识(测点描述)",value:"tagcomment"},{label:this.$t("attribute.address"),value:"objaddr"},{label:this.$t("attribute.tagk"),value:"tagk"},{label:this.$t("attribute.datatype"),value:"datatype"},{label:this.$t("attribute.dataformat"),value:"dataformat"},{label:this.$t("attribute.alarmtype"),value:"alarmtype"},{label:this.$t("attribute.tagrwprop"),value:"tagrwprop"},{label:this.$t("attribute.collecttypec"),value:"collecttypec"},{label:this.$t("attribute.enablealarm"),value:"enablealarm"},{label:this.$t("attribute.enablehissave"),value:"enablehissave"},{label:this.$t("attribute.collectTaggroup"),value:"taggroup"},{label:this.$t("attribute.isUpload"),value:"isupload"},{label:this.$t("attribute.isIsbit"),value:"enablebit"},{label:this.$t("attribute.isbit"),value:"startbit"},{label:"是否数值转换",value:"enabletransvalue"},{label:this.$t("attribute.transvalue"),value:"transvalue"},{label:"初始值",value:"taginitvalue"},{label:"辅助参数",value:"assistpararm"},{label:"是否取反",value:"reserve3"}],pvflagList:[],alarmRecordList:[{label:this.$t("attribute.visualValue"),value:0},{label:this.$t("attribute.switchValue"),value:1},{label:this.$t("attribute.ym"),value:2},{label:this.$t("attribute.yk"),value:3},{label:this.$t("attribute.yt"),value:4}],writeReadType:[{label:this.$t("attribute.onlyRead"),value:0},{label:this.$t("attribute.readWrite"),value:1},{label:this.$t("attribute.onlyWrite"),value:2}],dataType:[{label:this.$t("attribute.bit"),value:0},{label:this.$t("attribute.eightNoSymbol"),value:1},{label:this.$t("attribute.eightSymbol"),value:2},{label:this.$t("attribute.sixteenNoSymbol"),value:3},{label:this.$t("attribute.sixteenSymbol"),value:4},{label:this.$t("attribute.twentyFourNoSymbol"),value:14},{label:this.$t("attribute.twentyFourSymbol"),value:15},{label:this.$t("attribute.thirtySecondNoSymbol"),value:5},{label:this.$t("attribute.thirtySecondSymbol"),value:6},{label:this.$t("attribute.sixteenBCD"),value:7},{label:this.$t("attribute.thirtySecondBCD"),value:8},{label:this.$t("attribute.singleFloat"),value:9},{label:this.$t("attribute.doubleFloat"),value:10},{label:this.$t("attribute.string"),value:11}],hiloType:[{label:"12",value:0},{label:"21",value:1},{label:"1234",value:2},{label:"2143",value:3},{label:"3412",value:4},{label:"4321",value:5}],collecttypecList:[],enablealarmList:[{label:this.$t("attribute.open"),value:1},{label:this.$t("attribute.close"),value:0}],enablehissaveList:[{label:this.$t("attribute.open"),value:1},{label:this.$t("attribute.close"),value:0}],taggroupList:[{label:0,value:"0"},{label:1,value:"1"},{label:2,value:"2"},{label:3,value:"3"},{label:4,value:"4"},{label:5,value:"5"},{label:6,value:"6"},{label:7,value:"7"},{label:8,value:"8"},{label:9,value:"9"}],isuploadList:[{label:this.$t("attribute.yes"),value:1},{label:this.$t("attribute.no"),value:0}],isTransvalueList:[{label:this.$t("attribute.yes"),value:1},{label:this.$t("attribute.no"),value:0}],enablebitList:[{label:this.$t("attribute.yes"),value:1},{label:this.$t("attribute.no"),value:0}],startbitList:[{label:0,value:0},{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6},{label:7,value:7},{label:8,value:8},{label:9,value:9},{label:10,value:10},{label:11,value:11},{label:12,value:12},{label:13,value:13},{label:14,value:14},{label:15,value:15},{label:16,value:16},{label:17,value:17},{label:18,value:18},{label:19,value:19},{label:20,value:20},{label:21,value:21},{label:22,value:22},{label:23,value:23},{label:24,value:24},{label:25,value:25},{label:26,value:26},{label:27,value:27},{label:28,value:28},{label:29,value:29},{label:30,value:30},{label:31,value:31}],rules:{type:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],value:[{required:!0,message:this.$t("validate.required"),trigger:"change"},{validator:function(e,a,i){if(a){var r=/^[-]?[0-9]+(\.[0-9]+)?$/;r.test(a)?i():i(new Error(t.$t("debuggerInfo.enterNumber")))}},trigger:"change"}],reserve2:[{required:!1,message:this.$t("validate.required"),trigger:"change"},{validator:function(e,a,i){if(a){var r=/^[-]?[0-9]+(\.[0-9]+)?$/;r.test(a)?i():i(new Error(t.$t("debuggerInfo.enterNumber")))}},trigger:"change"}],startValue:[{required:!0,message:this.$t("validate.required"),trigger:"change"},{validator:function(e,a,i){if(String(a)){var r=/[-]?[0-9]$/;r.test(a)?i():i(new Error(t.$t("chlwatch.pleaseEnterIntNumber")))}},trigger:"change"}],step:[{required:!0,message:this.$t("validate.required"),trigger:"change"},{validator:function(e,a,i){if(String(a)){var r=/^[-]?[0-9]\d*$/;r.test(a)?i():i(new Error(t.$t("chlwatch.pleaseEnterIntNumber")))}},trigger:"change"}],objaddrWay:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],fixedValue:[{required:!0,message:this.$t("validate.required"),trigger:"change"},{validator:function(e,a,i){if(a){var r=/^[-]?[0-9]+(\.[0-9]+)?$/;r.test(a)?i():i(new Error(t.$t("debuggerInfo.enterNumber")))}},trigger:"change"}],changeValue:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],replaceStr:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],tagnameStr:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],replaceTagCommentStr:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],transValue:[{required:!0,message:this.$t("validate.required"),trigger:"change"},{validator:function(e,a,i){if(a){var r=/^[0-9]+(\.[0-9]+)?$/;r.test(a)?i():i(new Error(t.$t("chlwatch.pleaseEnterIntNumber")))}},trigger:"change"}],taginitvalue:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],assistpararm:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]},scrollTableHeight:0}},components:{AddOrUpdate:f["default"],"dialog-bar":p["a"]},methods:{handlePageChange:function(t){var e=t.currentPage,a=t.pageSize;this.page=e,this.limit=a,this.getDataList()},querySearch:function(){this.page=1,this.getDataList()},getprotocolList:function(){var t=this,e={page:t.protocolPage,limit:100};t.$hasPermission("ProcotolTemplate:select:permission.do")?(t.protocolSearch&&(e["fuzzy"]=t.protocolSearch.replace(/_/g,"\\_").replace(/%/g,"\\%")),t.$http.get("/ProcotolTemplate/selectPage.do",{params:e}).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);if(t.protocolTotal=Number(a.data.total),1==t.protocolPage&&(t.protocolList=[]),t.protocolList=t.protocolList.concat(a.data.list),t.protocolList.length>0)if(t.addDisabled=!1,t.queryParams.protocolId){for(var i=0;i<t.protocolList.length;i++)if(t.queryParams.protocolId==t.protocolList[i].id){t.dataForm.protocolname=t.protocolList[i].id,t.getFuncodeList(t.queryParams.protocolId);break}}else t.protocolList.length>0&&!t.dataForm.protocolname&&(t.dataForm.protocolname=t.protocolList[0].id,t.getFuncodeList(t.dataForm.protocolname));else t.addDisabled=!0})).catch((function(e){return t.addDisabled=!0,!1}))):t.$message.warning("暂无协议模板查询权限, 请联系管理员")},handleProtocolVisibleChange:function(t){var e=this;t&&this.$nextTick((function(){e.$refs.protocolInput.focus()}))},handleProtocolScroll:function(){this.protocolList.length<this.protocolTotal&&(this.protocolPage++,this.getprotocolList())},handleProtocol:function(t){this.dataForm.devname="",this.dataForm.collecttypec=[],this.getFuncodeList(t)},compareBySort:function(t,e){return t.sort((function(t,a){return t[e]-a[e]}))},getFuncodeList:function(t){var e=this;if(e.$hasPermission("protocolinfo:select:permission.do"))for(var a=0;a<e.protocolList.length;a++){e.protocolList[a].id==t&&e.$http.get("/info/protocolinfo/proguid",{params:{guid:e.protocolList[a].protocol}}).then((function(t){var a=t.data;e.funcodeList=JSON.parse(a.data[0].funccode).data})),e.getDataList();break}else e.$message.warning("暂无协议查询权限, 请联系管理员")},handleFuncode:function(t){this.selectFuncCode=t,this.getDataList()},handleScrollChange:function(t){t.type;var e=t.scrollTop,a=t.scrollLeft;this.scrollleft=a,this.scorlltop=e},getDataList:g()((function(){var t=this,e={page:this.page,limit:this.limit};this.dataForm.protocolname&&(e["pro"]=this.dataForm.protocolname),null!=this.dataForm.alarmtype&&(e["alarmtype"]=this.dataForm.alarmtype),this.dataForm.collecttypec.length>0&&(e["collecttypec"]=this.selectFuncCode.join(",")),this.dataForm.tagname&&(e["fuzzy"]=this.dataForm.tagname.replace(/_/g,"\\_").replace(/%/g,"\\%")),this.dataList=[],this.total=0,this.$hasPermission("tagTemplate:select:permission.do")?(this.dataListLoading=!0,this.pagerLoading=!0,this.$http.get("/tagTemplate/selectPage.do",{params:e}).then((function(a){var i=a.data;t.page=e.page,t.$nextTick((function(){0!=i.code&&t.$refs.recordTable&&t.$refs.recordTable.loadData([]).then((function(){t.dataListLoading=!1,t.pagerLoading=!1})).finally((function(){return t.$message.error(i.data||i.msg)})),t.dataList=i.data.list||[],t.$refs.recordTable&&(t.$refs.recordTable.clearCheckboxRow(),t.$refs.recordTable.loadData(t.dataList).then((function(){t.dataListLoading=!1,t.pagerLoading=!1,t.total=Number(i.data.total)||0})).finally((function(){if(t.dataList.length>0&&(t.isAddOrUpdate?t.$refs.recordTable.scrollTo(t.scrollleft,t.scorlltop):t.$refs.recordTable.scrollTo(0,0),t.isAddOrUpdate=!1,t.currentPageCheccked&&(t.$set(t.checkboxConfig,"checkStrictly",!1),t.$refs.recordTable.setAllCheckboxRow(!1),t.tagIds=[],t.selectTaProtocolIds=[],t.tagassistIdList=[],t.tagIdNameList=[],t.tagIdKList=[],t.tagIdCommentList=[],t.multipleSelectionAll=[],t.selectedTagIdAndObjAddrList=[],t.dataList.forEach((function(e){var a={id:e.id,name:e.tagname},i={id:e.id,tagk:e.tagk},r={id:e.id,objaddr:e.objaddr},l={id:e.id,tagcomment:e.tagcomment};t.tagIds.push(e.id),t.tagassistIdList.push({tagid:e.id,tagname:e.tagname}),t.selectTaProtocolIds.includes(e.protocol)||t.selectTaProtocolIds.push(e.protocol),t.selectedTagIdAndObjAddrList.push(r),t.multipleSelectionAll.push(e.id),t.tagIdNameList.push(a),t.tagIdKList.push(i),t.tagIdCommentList.push(l)})),t.$refs.recordTable.setAllCheckboxRow(!0)),!t.currentPageCheccked&&t.multipleSelectionAll.length>0)){t.$set(t.checkboxConfig,"checkStrictly",!1),t.$refs.recordTable.setAllCheckboxRow(!1),t.tagIds=[],t.selectTaProtocolIds=[],t.tagassistIdList=[],t.tagIdNameList=[],t.tagIdKList=[],t.tagIdCommentList=[],t.selectedTagIdAndObjAddrList=[];var e=!1;t.dataList.forEach((function(e){var a=t.multipleSelectionAll.length>0&&-1!==t.multipleSelectionAll.indexOf(e.id);if(a){var i={id:e.id,name:e.tagname},r={id:e.id,tagk:e.tagk},l={id:e.id,objaddr:e.objaddr},s={id:e.id,tagcomment:e.tagcomment};t.tagIds.push(e.id),t.tagassistIdList.push({tagid:e.id,tagname:e.tagname}),t.selectTaProtocolIds.includes(e.protocol)||t.selectTaProtocolIds.push(e.protocol),t.selectedTagIdAndObjAddrList.push(l),t.tagIdNameList.push(i),t.tagIdKList.push(r),t.tagIdCommentList.push(s)}})),t.multipleSelectionAll.forEach((function(a){t.dataList.forEach((function(i){i.id==a&&(e=!0,t.$refs.recordTable.setCheckboxRow(i,!0))}))})),e||(t.tagIds=[],t.selectTaProtocolIds=[],t.tagassistIdList=[],t.tagIdNameList=[],t.tagIdKList=[],t.tagIdCommentList=[],t.multipleSelectionAll=[])}})))}))})).catch((function(e){return t.dataListLoading=!1,t.pagerLoading=!1,!1}))):this.$message.warning("暂无测点模板查询权限, 请联系管理员")}),100,{leading:!0,trailing:!1}),formatterAlarmtype:function(t){var e=t.row;t.column;return 0===e.alarmType?this.$t("attribute.visualValue"):1===e.alarmType?this.$t("attribute.switchValue"):2===e.alarmType?this.$t("attribute.ym"):3===e.alarmType?this.$t("attribute.yk"):4===e.alarmType?this.$t("attribute.yt"):""},formatterRwtype:function(t){var e=t.row;t.column;return 0===e.tagRWProp?this.$t("attribute.onlyRead"):1===e.tagRWProp?this.$t("attribute.readWrite"):this.$t("attribute.onlyWrite")},formatterCollecttypec:function(t){var e=t.row;t.column;if(!e.collectTypeCstr)return"";if(-1==e.collectTypeCstr.indexOf("("))return e.collectTypeCstr;var a=e.collectTypeCstr.indexOf("(");if(a>0){var i=e.collectTypeCstr.substring(0,a);return i}},formatterDatatype:function(t){var e=t.row;t.column;return 0===e.dataType?this.$t("attribute.bit"):1===e.dataType?this.$t("attribute.eightNoSymbol"):2===e.dataType?this.$t("attribute.eightSymbol"):3===e.dataType?this.$t("attribute.sixteenNoSymbol"):4===e.dataType?this.$t("attribute.sixteenSymbol"):14===e.datatype?this.$t("attribute.twentyFourNoSymbol"):15===e.datatype?this.$t("attribute.twentyFourSymbol"):5===e.dataType?this.$t("attribute.thirtySecondNoSymbol"):6===e.dataType?this.$t("attribute.thirtySecondSymbol"):7===e.dataType?this.$t("attribute.sixteenBCD"):8===e.dataType?this.$t("attribute.thirtySecondBCD"):9===e.dataType?this.$t("attribute.singleFloat"):10===e.dataType?this.$t("attribute.doubleFloat"):11===e.dataType?this.$t("attribute.string"):12===e.dataType?this.$t("attribute.sixtyFourUnsigned"):13===e.dataType?this.$t("attribute.sixtyFourSigned"):""},formatterDataformat:function(t){var e=t.row;t.column;return 0===e.dataFormat?"12":1===e.dataFormat?"21":2===e.dataFormat?"1234":3===e.dataFormat?"2143":4===e.dataFormat?"3412":"4321"},formatterbit:function(t){var e=t.row;t.column;return 1===e.enableBit?this.$t("attribute.yes"):this.$t("attribute.no")},formatterAlarm:function(t){var e=t.row;t.column;return 1===e.enableAlarm?this.$t("attribute.yes"):this.$t("attribute.no")},formatterHistory:function(t){var e=t.row;t.column;return 1===e.enableHisSave?this.$t("attribute.yes"):this.$t("attribute.no")},formatterIsupload:function(t){var e=t.row;t.column;return 1===e.isUpload?this.$t("attribute.yes"):this.$t("attribute.no")},selectAll:function(t){var e=this;this.tagIds=[],this.selectTaProtocolIds=[],this.tagassistIdList=[],this.tagIdNameList=[],this.tagIdKList=[],this.tagIdCommentList=[],this.selectedTagIdAndObjAddrList=[],this.multipleSelectionAll=[],t.records.length>0?(this.currentPageCheccked=!0,t.records.forEach((function(t){var a={id:t.id,name:t.tagname},i={id:t.id,tagk:t.tagk},r={id:t.id,objaddr:t.objaddr},l={id:t.id,tagcomment:t.tagcomment};e.tagIds.push(t.id),e.tagassistIdList.push({tagid:t.id,tagname:t.tagname}),e.selectTaProtocolIds.includes(t.protocol)||e.selectTaProtocolIds.push(t.protocol),e.selectedTagIdAndObjAddrList.push(r),e.tagIdNameList.push(a),e.tagIdKList.push(i),e.tagIdCommentList.push(l),e.multipleSelectionAll.push(t.id)}))):this.currentPageCheccked=!1},dataListSelectionHandleChange:function(t){var e=this;this.tagIds=[],this.selectTaProtocolIds=[],this.selectTaProtocolIds=[],this.tagassistIdList=[],this.tagIdNameList=[],this.tagIdKList=[],this.tagIdCommentList=[],this.selectedTagIdAndObjAddrList=[],this.multipleSelectionAll=[],t.records.length>0&&t.records.forEach((function(t){var a={id:t.id,name:t.tagname},i={id:t.id,tagk:t.tagk},r={id:t.id,objaddr:t.objaddr},l={id:t.id,tagcomment:t.tagcomment};e.tagIds.push(t.id),e.tagassistIdList.push({tagid:t.id,tagname:t.tagname}),e.selectTaProtocolIds.includes(t.protocol)||e.selectTaProtocolIds.push(t.protocol),e.selectedTagIdAndObjAddrList.push(r),e.tagIdNameList.push(a),e.tagIdKList.push(i),e.tagIdCommentList.push(l),e.multipleSelectionAll.push(t.id)}))},reduceSame:function(t){var e={};return t.reduce((function(t,a){return!e[a.id]&&(e[a.id]=t.push(a)),t}),[])},handleAddOrUpdate:function(t){var e=this;if(this.addDisabled)return this.$message.warning(this.$t("tagTemplate.currentlyNoProtocol"));this.addOrUpdateVisible=!0,this.$nextTick((function(){var a=e.$refs.recordTable?e.$refs.recordTable.getScroll().scrollLeft:0,i=e.$refs.recordTable?e.$refs.recordTable.getScroll().scrollTop:0;if(e.scrollleft=a,e.scorlltop=i,t){if(e.isAddOrUpdate=!0,!e.$hasPermission("tagTemplate:update:permission.do"))return void e.$message.warning("暂无测点模板修改权限, 请联系管理员")}else if(e.isAddOrUpdate=!1,e.$refs.addOrUpdate.paramdevid=e.dataForm.devname,!e.$hasPermission("tagTemplate:insert:permission.do"))return void e.$message.warning("暂无测点模板新增权限, 请联系管理员");e.$refs.addOrUpdate.dataForm.id=t,e.$refs.addOrUpdate.init()}))},deleteHandle:g()((function(t){var e=this,a={ids:""};if(t&&(e.tagIds=[],e.tagassistIdList=[],e.tagIds.push(t.id),e.tagassistIdList.push({tagid:t.tagid,tagname:t.tagname})),0===e.tagIds.length)return e.$message.error(e.$t("deleteInfo.noData"));a["ids"]=e.tagIds.join(","),e.$hasPermission("tagTemplate:delete:permission.do")?e.$confirm(e.$t("deleteInfo.noticeTitle"),e.$t("deleteInfo.noticePrompt"),{confirmButtonText:e.$t("deleteInfo.confirm"),cancelButtonText:e.$t("deleteInfo.cancel"),type:"warning"}).then((function(){e.dataListLoading=!0,e.$http.delete("/tagTemplate/delete.do",{params:a}).then((function(t){var a=t.data;if(0!=a.code)return e.dataListLoading=!1,e.$message.error(a.data||e.$t("deleteInfo.deleteFail"));e.$message.success(e.$t("deleteInfo.deleteSuccess")),e.dataListLoading=!1,e.currentPageCheccked=!1,e.getDataList()})).catch((function(t){return e.dataListLoading=!1,e.currentPageCheccked=!1,e.getDataList()}))})).catch((function(t){})):e.$message.warning("暂无测点模板删除权限, 请联系管理员")}),1e3,{leading:!0,trailing:!1}),editAll:function(){var t=this;if(!(this.tagIds.length>0))return this.$message.info(this.$t("attribute.selectEditData"));this.editAllVisible=!0,this.getCollectTypeList(),this.$http.get("/info/deviceinfo/DevicesBywsnAndPtype",{params:{gwsn:sessionStorage.getItem("gwsn"),ptype:0,chlid:this.dataForm.protocolname}}).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);if(a.data.length>0){var i=!0;if(t.dataForm.protocolname){for(var r=0;r<a.data.length;r++){var l=a.data[r];if(l,-1==l.devmanu&&0==l.devmodel){i=!1;break}}i?(t.pvflagList=[],t.$http.post("/info/pvparaminfo/listParam",o.a.stringify({devPlatform:selectedDevInfo.devmanu,devIndex:selectedDevInfo.devmodel})).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);a.data.length>0&&a.data.forEach((function(e){t.pvflagList.push({label:e.paramDesc,value:e.paramIndex})}))}))):("pvflag"==t.editForm.type&&(t.changeList=[],t.editForm.changeValue=""),t.pvflagList=[])}else{var s=[];a.data.forEach((function(e){t.selectTaProtocolIds.includes(String(e.protocol))&&s.push(e)})),s.forEach((function(t){t.devmanu==s[0].devmanu&&t.devmodel==s[0].devmodel||(i=!1)})),i?(t.pvflagList=[],s.length>0&&t.$http.post("/info/pvparaminfo/listParam",o.a.stringify({devPlatform:s[0].devmanu,devIndex:s[0].devmodel})).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);a.data.length>0&&a.data.forEach((function(e){t.pvflagList.push({label:e.paramDesc,value:e.paramIndex})}))}))):("pvflag"==t.editForm.type&&(t.changeList=[],t.editForm.changeValue=""),t.pvflagList=[])}}else"pvflag"==t.editForm.type&&(t.changeList=[]),t.pvflagList=[]}))},selectChanged:function(t){if(this.$refs.editForm.clearValidate(),this.editForm.changeValue="","dataformat"===t)this.changeList=this.hiloType,this.editForm.changeValue=this.changeList[0].value;else if("datatype"===t)this.changeList=this.dataType,this.editForm.changeValue=this.changeList[0].value;else if("alarmtype"===t)this.changeList=this.alarmRecordList,this.editForm.changeValue=this.changeList[0].value;else if("tagrwprop"===t)this.changeList=this.writeReadType,this.editForm.changeValue=this.changeList[0].value;else if("collecttypec"===t)this.changeList=this.collecttypecList,this.editForm.changeValue=this.changeList[0].value;else if("enablealarm"===t)this.changeList=this.enablealarmList,this.editForm.changeValue=this.changeList[0].value;else if("enablehissave"===t)this.changeList=this.enablehissaveList,this.editForm.changeValue=this.changeList[0].value;else if("isupload"===t)this.changeList=this.isuploadList,this.editForm.changeValue=this.changeList[0].value;else if("enablebit"==t)this.changeList=this.enablebitList,this.editForm.changeValue=this.changeList[0].value;else if("enabletransvalue"==t)this.changeList=this.isTransvalueList,this.editForm.changeValue=this.changeList[0].value;else if("startbit"===t)this.changeList=this.startbitList,this.editForm.changeValue=this.changeList[0].value;else if("limitValueEnable"===t){var e=this.$refs.recordTable.getCheckboxRecords();if(e.length>0)for(var a=0;a<e.length;a++){var i=e[a];if(null!=i.tagAssistEntity||void 0!=i.tagAssistEntity){this.editForm.limitValueEnable=i.tagAssistEntity.enable,this.editForm.maxValue=i.tagAssistEntity.upperLimit,this.editForm.minValue=i.tagAssistEntity.lowerLimit,this.editForm.limitdataFormat=i.tagAssistEntity.dataFormat;break}}}else"pvflag"===t?(this.changeList=this.pvflagList,this.changeList.length>0?this.editForm.changeValue=this.changeList[0].value:this.$notify({type:"warning",message:"无法批量修改PV上传标识，请查看协议是否配置了兼容平台和协议类型"})):"reserve3"===t&&(this.changeList=this.isuploadList,this.editForm.changeValue=this.changeList[0].value)},handleAddSmartTransDataChange:function(){this.editForm.smartTransformTableData.push({sourceK:1,targetK:1})},handleResetSmartTransDataChange:function(){this.editForm.smartTransformTableData=[{sourceK:.1,targetK:10},{sourceK:.01,targetK:100},{sourceK:.001,targetK:1e3}]},handleDeleteSmartTransDataChange:function(t){this.editForm.smartTransformTableData.splice(t,1)},handleTagCommentWayChange:function(t){this.$refs.editForm.clearValidate()},querySearchAsync:function(t,e){for(var a=this,i=a.taggroupList,r=0,l=i.length;r<l;r++)i[r].value=i[r].value,i[r].label=i[r].label;var s=t?i.filter(a.createStateFilter(t)):i;e(s)},createStateFilter:function(t){return function(e){return-1!=e.value.indexOf(t)}},handleSelectTaggroup:function(t){this.editForm.changeValue=t.value},getCollectTypeList:function(){var t=this;t.collecttypecList=[],t.$http.get("/info/channelinfo/getByChliId",{params:{chlid:t.dataForm.protocolname,gwsn:sessionStorage.getItem("gwsn")}}).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.msg);t.$http.get("/info/protocolinfo/proguid",{params:{guid:a.data[0].chlprotocol}}).then((function(e){var a=e.data;if(a.data.length>0){var i=JSON.parse(a.data[0].funccode).data;i.length>0&&i.forEach((function(e){var a={label:e.description,value:e.FuncCode};t.collecttypecList.push(a)}))}})).catch((function(t){return!1}))})).catch((function(t){return!1}))},getArrDifference:function(t,e){for(var a=[],i=0;i<e.length;i++){for(var r=e[i],l=!1,s=0;s<t.length;s++){var o=t[s];if(r==o){l=!0;break}}l||a.push(r)}return a},isRepeat:function(t){var e={};for(var a in t){if(e[t[a]])return!0;e[t[a]]=!0}return!1},dataFormSubmitHandle:g()((function(){var t=this,e=[];if("tagname"===this.editForm.type){if("replace"==this.editForm.way?this.tagIdNameList.forEach((function(a){if(-1!=a.name.toLowerCase().indexOf(t.editForm.replaceStr.toLowerCase())){var i={};i.id=a.id,i.tagname=a.name.replace(new RegExp(t.editForm.replaceStr,"gi"),t.editForm.tagnameStr),e.push(i)}})):"prepend"==this.editForm.way?this.tagIdNameList.forEach((function(a){var i={};i.id=a.id,i.tagname=t.editForm.tagnameStr+a.name,e.push(i)})):"append"==this.editForm.way&&this.tagIdNameList.forEach((function(a){var i={};i.id=a.id,i.tagname=a.name+t.editForm.tagnameStr,e.push(i)})),0==e.length)return this.editForm.replaceStr="",this.$message.warning("暂未查询到与替换源相匹配的测点名称，请重新输入")}else if("objaddr"===this.editForm.type){var a=/.*\..*/;if("step"==this.editForm.objaddrWay)if(-1!=this.$chineseChar2englishChar(String(this.editForm.startValue)).indexOf(",")){var i=this.$chineseChar2englishChar(String(this.editForm.startValue)).split(",")[0],r=this.$chineseChar2englishChar(String(this.editForm.startValue)).split(",")[1],l=null,s=null,n=this.$chineseChar2englishChar(String(r)),d=n.match(/\d+\.*\d*/g);if(d&&d.length>0){a.test(d[d.length-1])?(l=d[d.length-1].split(".")[1],s=n.substring(0,n.length-String(l).length)):(l=d[d.length-1],s=n.substring(0,n.length-String(l).length));var c=parseInt(l),u=Number(this.editForm.step),m=0,g="",h=parseInt(l);a.test(l)&&(m=l.split(".")[1]),a.test(l)?this.tagIds.forEach((function(a){if(String(l).length>String(h).length){g="";for(var r=0;r<String(l).length-String(h).length;r++)g+="0"}else g="";var o={};o.id=a,o.objaddr=""!=g?i?i+","+s+g+h:s+g+h:i?i+","+s+h:s+h,m=Number(m)+Number(t.editForm.step),h=c+"."+m,e.push(o)})):this.tagIds.forEach((function(t){if(String(l).length>String(h).length){g="";for(var a=0;a<String(l).length-String(h).length;a++)g+="0"}else g="";var r={};r.id=t,r.objaddr=""!=g?i?i+","+s+String(g)+h:s+g+h:i?i+","+s+h:s+h,h+=u,e.push(r)}))}}else{var p=null,f=null,b=this.$chineseChar2englishChar(String(this.editForm.startValue)),$=b.match(/\d+\.*\d*/g);if($&&$.length>0){a.test($[$.length-1])?(p=$[$.length-1].split(".")[1],f=b.substring(0,b.length-String(p).length)):(p=$[$.length-1],f=b.substring(0,b.length-String(p).length));var y=parseInt(p),F=0,L="",S=parseInt(p);a.test(p)&&(F=p.split(".")[1]),a.test(p)?this.tagIds.forEach((function(a){if(String(p).length>String(S).length){L="";for(var i=0;i<String(p).length-String(S).length;i++)L+="0"}else L="";var r={};r.id=a,r.objaddr=""!=L?f?f+L+S:L+S:f?f+S:S,F=Number(F)+Number(t.editForm.step),S=y+"."+F,e.push(r)})):this.tagIds.forEach((function(a){if(String(p).length>String(S).length){L="";for(var i=0;i<String(p).length-String(S).length;i++)L+="0"}else L="";var r={};r.id=a,r.objaddr=""!=L?f?f+String(L)+S:L+S:f?f+S:S,S+=Number(t.editForm.step),e.push(r)}))}}else this.selectedTagIdAndObjAddrList.forEach((function(i){if(-1!=t.$chineseChar2englishChar(String(i.objaddr)).indexOf(",")){var r=t.$chineseChar2englishChar(String(i.objaddr)).split(",")[0],l=t.$chineseChar2englishChar(String(i.objaddr)).split(",")[1],s=null,o=null,n=t.$chineseChar2englishChar(String(l)),d=n.match(/\d+\.*\d*/g);if(d&&d.length>0){a.test(d[d.length-1])?(s=d[d.length-1].split(".")[1],o=n.substring(0,n.length-String(s).length)):(s=d[d.length-1],o=n.substring(0,n.length-String(s).length));var c=parseInt(s),u=Number(t.editForm.fixedValue),m=0,g="",h=parseInt(s);if(a.test(s)&&(m=s.split(".")[1]),a.test(s)){if(String(s).length>String(h).length){g="";for(var p=0;p<String(s).length-String(h).length;p++)g+="0"}else g="";var f={};f.id=i.id,m=Number(m)+Number(t.editForm.fixedValue),h=c+"."+m,f.objaddr=""!=g?r?r+","+o+g+h:o+g+h:r?r+","+o+h:o+h,e.push(f)}else{if(String(s).length>String(h).length){g="";for(var b=0;b<String(s).length-String(h).length;b++)g+="0"}else g="";var v={};v.id=i.id,h+=u,v.objaddr=""!=g?r?r+","+o+String(g)+h:o+g+h:r?r+","+o+h:o+h,e.push(v)}}}else{var $=null,y=null,F=t.$chineseChar2englishChar(String(i.objaddr)),L=F.match(/\d+\.*\d*/g);if(L&&L.length>0){a.test(L[L.length-1])?($=L[L.length-1].split(".")[1],y=F.substring(0,F.length-String($).length)):($=L[L.length-1],y=F.substring(0,F.length-String($).length));var S=parseInt($),w=0,x="",T=parseInt($);if(a.test($)&&(w=$.split(".")[1]),a.test($)){if(String($).length>String(T).length){x="";for(var V=0;V<String($).length-String(T).length;V++)x+="0"}else x="";var I={};I.id=i.id,w=Number(w)+Number(t.editForm.fixedValue),T=S+"."+w,I.objaddr=""!=x?y?y+x+T:x+T:y?y+T:T,e.push(I)}else{if(String($).length>String(T).length){x="";for(var C=0;C<String($).length-String(T).length;C++)x+="0"}else x="";var k={};k.id=i.id,T+=Number(t.editForm.fixedValue),k.objaddr=""!=x?y?y+String(x)+T:x+T:y?y+T:T,e.push(k)}}}}))}else if("tagk"===this.editForm.type)if(this.editForm.smartTransform){if(0==this.editForm.smartTransformTableData.length)return this.$message.warning("请先添加修改规则再进行修改操作");var w=[];if(this.editForm.smartTransformTableData.forEach((function(t){w.push(t.sourceK)})),this.isRepeat(w))return this.$message.warning("规则中有重复数据，请先修改或删除重复规则再进行修改操作");if(this.editForm.smartTransformTableData.forEach((function(a){t.tagIdKList.forEach((function(t){if(a.sourceK==t.tagk){var i={id:t.id,tagk:a.targetK};e.push(i)}}))})),0==e.length)return this.$message.warning("暂未匹配到数据源")}else this.tagIdKList.forEach((function(a){var i={id:a.id,tagk:t.editForm.value};e.push(i)}));else if("reserve2"===this.editForm.type)e={ids:this.tagIds.join(","),param:this.editForm.reserve2};else if("startbit"===this.editForm.type){var x=this.editForm.changeValue,T=this.editForm.type;this.tagIds.forEach((function(t){Number(x)>31&&(x=0);var a={};a.id=t,a[T]=x,e.push(a),x++}))}else if("transvalue"===this.editForm.type){var V=this.editForm.type;this.tagIds.forEach((function(a){var i={};i.id=a,i[V]=t.editForm.transValue,e.push(i)}))}else if("limitValueEnable"===this.editForm.type)this.tagassistIdList.forEach((function(a){var i={tagId:a.tagid,tagName:a.tagname,gwsn:sessionStorage.getItem("gwsn"),dataFormat:t.editForm.limitdataFormat,enable:t.editForm.limitValueEnable,lowerLimit:t.editForm.minValue,upperLimit:t.editForm.maxValue};e.push(i)}));else if("taginitvalue"===this.editForm.type)this.tagIds.forEach((function(a){var i={};i.id=a,i["taginitvalue"]=t.editForm.taginitvalue,e.push(i)}));else if("assistpararm"===this.editForm.type)this.tagIds.forEach((function(a){var i={};i.id=a,i["assistpararm"]=t.editForm.assistpararm,e.push(i)}));else if("reserve3"===this.editForm.type){var I=this.editForm.type;this.tagIds.forEach((function(a){var i={};i.id=a,i[I]=String(t.editForm.changeValue),e.push(i)}))}else{var C=this.editForm.type;this.tagIds.forEach((function(a){var i={};i.id=a,i[C]=t.editForm.changeValue,e.push(i)}))}if("limitValueEnable"!==this.editForm.type)if("reserve2"==this.editForm.type)this.$refs["editForm"].validate((function(a){if(!a)return!1;t.$http.put("/info/taginfo/batchUpdatePv.do",o.a.stringify(e)).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.$message.success("操作成功"),t.editAllVisible=!1,t.getDataList()})).catch((function(e){return t.editAllVisible=!1,t.getDataList()}))}));else if("pvflag"==this.editForm.type){var k=[],O=this.editForm.type;this.tagIds.forEach((function(e){var a={};a.id=e,a[O]=t.editForm.changeValue,k.push(a)})),this.$http.put("/info/taginfo/update.do",k).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.$message.success("操作成功"),t.editAllVisible=!1,t.getDataList()})).catch((function(e){return t.editAllVisible=!1,t.getDataList()}))}else if("tagcomment"==this.editForm.type){var E=[];if("replace"==this.editForm.tagcommentWay){if(this.tagIdCommentList.forEach((function(e){if(-1!=e.tagcomment.toLowerCase().indexOf(t.editForm.replaceTagCommentStr.toLowerCase())){var a={};a.id=e.id,a.tagcomment=e.tagcomment.replace(new RegExp(t.editForm.replaceTagCommentStr,"gi"),t.editForm.tagcomment),E.push(a)}})),0==E.length)return this.editForm.replaceTagCommentStr="",this.$message.warning("暂未查询到与替换源相匹配的物模型标识(测点描述)，请重新输入");this.$http.put("/info/taginfo/update.do",E).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.$message.success("操作成功"),t.editAllVisible=!1,t.getDataList()})).catch((function(e){return t.editAllVisible=!1,t.getDataList()}))}else if("prepend"==this.editForm.tagcommentWay){if(this.tagIdCommentList.forEach((function(e){var a={};a.id=e.id,a.tagcomment=t.editForm.tagcomment+e.tagcomment,E.push(a)})),0==E.length)return this.editForm.replaceTagCommentStr="",this.$message.warning("暂无可操作的数据源");this.$http.put("/info/taginfo/update.do",E).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.$message.success("操作成功"),t.editAllVisible=!1,t.getDataList()})).catch((function(e){return t.editAllVisible=!1,t.getDataList()}))}else if("append"==this.editForm.tagcommentWay){if(this.tagIdCommentList.forEach((function(e){var a={};a.id=e.id,a.tagcomment=e.tagcomment+t.editForm.tagcomment,E.push(a)})),0==E.length)return this.editForm.replaceTagCommentStr="",this.$message.warning("暂无可操作的数据源");this.$http.put("/info/taginfo/update.do",E).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.$message.success("操作成功"),t.editAllVisible=!1,t.getDataList()})).catch((function(e){return t.editAllVisible=!1,t.getDataList()}))}else if("increasing"==this.editForm.tagcommentWay){var A=this.editForm.tagcomment.match(/[0-9]+\.*\d*/g),D=null,N="",P=null;if(A?(A=A[A.length-1],A.includes(".")?(N=this.editForm.tagcomment.substring(0,this.editForm.tagcomment.indexOf(A))+A.split(".")[0],D=A.split(".")[1],P=D):(N=this.editForm.tagcomment.substring(0,this.editForm.tagcomment.indexOf(A)),P=this.editForm.tagcomment.substring(this.editForm.tagcomment.indexOf(A),this.editForm.tagcomment.length))):N=this.editForm.tagcomment,this.editForm.tagcommentStep)if(1==this.editForm.tagcommentStep)this.tagIdCommentList.forEach((function(t,e){var a={};a.id=t.id,a.tagcomment=A?A.includes(".")?P?N+"."+P.substring(0,P.length-String(Number(A.split(".")[1])+Number(e)).length)+(Number(A.split(".")[1])+Number(e)):N+"."+(Number(A.split(".")[1])+Number(e)):N+(P?P.substring(0,P.length-String(Number(A)+Number(e)).length)+(Number(A)+Number(e)):Number(A)+Number(e)):N+e,E.push(a)}));else{var _=null;_=A?A.includes(".")?Number(A.split(".")[1]):Number(A):0,this.tagIdCommentList.forEach((function(e,a){var i={};i.id=e.id,i.tagcomment=A?A.includes(".")?P?N+"."+P.substring(0,P.length-String(_).length)+_:N+"."+(Number(D)+Number(t.editForm.tagcommentStep)):N+(P?P.substring(0,P.length-String(_).length)+_:_):N+_,E.push(i),_+=t.editForm.tagcommentStep}))}else this.tagIdCommentList.forEach((function(t,e){var a={};a.id=t.id,a.tagcomment=A?A.includes(".")?P?N+"."+P.substring(0,P.length-String(Number(A.split(".")[1])+Number(e)).length)+(Number(A.split(".")[1])+Number(e)):N+"."+(Number(A.split(".")[1])+Number(e)):N+(P?P.substring(0,P.length-String(Number(A)+Number(e)).length)+(Number(A)+Number(e)):Number(A)+Number(e)):N+e,E.push(a)}));if(0==E.length)return this.editForm.replaceTagCommentStr="",this.$message.warning("暂无可操作的数据源");this.$http.put("/info/taginfo/update.do",E).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.$message.success("操作成功"),t.editAllVisible=!1,t.getDataList()})).catch((function(e){return t.editAllVisible=!1,t.getDataList()}))}else if("clipboardSource"==this.editForm.tagcommentWay){var j=navigator.clipboard.readText();j.then((function(e){if(e=e.split("\r\n"),0==e.length)return t.$message.warning("剪切板无内容，请复制内容之后再进行操作"),!1;if(1==e.length&&""==e[e.length-1])return t.$message.warning("剪切板无内容，请复制内容之后再进行操作"),!1;if(e=""==e[e.length-1]?e.slice(0,e.length-1):e,e.length<t.tagIdCommentList.length)t.$confirm("剪切板内容长度小于所选测点长度不一致, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){if(e.forEach((function(e,a){var i={};i.id=t.tagIdCommentList[a].id,i.tagcomment=e,E.push(i)})),0==E.length)return t.$message.warning("暂无可操作的数据源");t.$http.put("/info/taginfo/update.do",E).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.$message.success("操作成功"),t.editAllVisible=!1,t.getDataList()})).catch((function(e){return t.editAllVisible=!1,t.getDataList()}))})).catch((function(){}));else{if(t.tagIdCommentList.forEach((function(t,a){var i={};i.id=t.id,i.tagcomment=e[a],E.push(i)})),0==E.length)return t.$message.warning("暂无可操作的数据源");t.$http.put("/info/taginfo/update.do",E).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.$message.success("操作成功"),t.editAllVisible=!1,t.getDataList()})).catch((function(e){return t.editAllVisible=!1,t.getDataList()}))}})).catch((function(e){return t.$message.error("获取剪切板内容失败,请重试")}))}else{if(0==e.length)return this.editForm.replaceTagCommentStr="",this.$message.warning("暂无可操作的数据源");this.$http.put("/info/taginfo/update.do",e).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.$message.success("操作成功"),t.editAllVisible=!1,t.getDataList()})).catch((function(e){return t.editAllVisible=!1,t.getDataList()}))}}else"assistpararm"==this.editForm.type||"taginitvalue"==this.editForm.type?this.$refs["editForm"].validate((function(a){if(!a)return!1;t.$http.put("/info/taginfo/update.do",e).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.$message.success(a.msg),t.editAllVisible=!1,t.getDataList()})).catch((function(e){return t.editAllVisible=!1,t.getDataList()}))})):"tagname"===this.editForm.type?this.$refs["editForm"].validate((function(a){if(!a)return!1;t.$http.post("/info/taginfo/BatchUpdate",e).then((function(e){var a=e.data;if("OK"!==a.msg)return t.$message.error(a.data||a.msg);t.$message.success(a.data||a.msg),t.editAllVisible=!1,t.getDataList()})).catch((function(e){return t.editAllVisible=!1,t.getDataList()}))})):this.$refs["editForm"].validate((function(a){if(!a)return!1;t.$http.put("/info/taginfo/update.do",e).then((function(e){var a=e.data;if(0!==a.code)return t.$message.error(a.data||a.msg);t.$message.success(a.msg),t.editAllVisible=!1,t.getDataList()})).catch((function(e){return t.editAllVisible=!1,t.getDataList()}))}));else{var q=[];e.forEach((function(t){q.push(t.tagId)}));var U={gwsn:sessionStorage.getItem("gwsn"),ids:q.join(",")};this.$http.post("/tagassist/select.do",o.a.stringify(U)).then((function(a){var i=a.data;if(0!=i.code)return t.$message.error(i.data||i.msg);var r=[],l=[],s=[];if(i.data.length>0){i.data.forEach((function(t){r.push(t.tagId),s.push(t.id)})),l=t.getArrDifference(r,q);var o=[],n=[];e.forEach((function(t){r.forEach((function(e,a){t.tagId==e&&n.push(v(v({},t),{id:s[a]}))}))})),e.forEach((function(t){l.forEach((function(e){t.tagId==e&&o.push(t)}))})),t.$http.post("/tagassist/update.do",n).then((function(e){var a=e.data;return 0!=a.code?t.$message.error(a.data||a.msg):o.length>0?void t.$http.post("/tagassist/insert.do",o).then((function(e){var a=e.data;return 0!=a.code?t.$message.error(a.data||a.msg):(t.$message.success("操作成功"),t.editAllVisible=!1,t.getDataList(),!1)})).catch((function(e){return t.editAllVisible=!1,t.getDataList()})):(t.$message.success(a.data),t.editAllVisible=!1,t.getDataList(),!1)})).catch((function(e){return t.editAllVisible=!1,t.getDataList()}))}else t.$http.post("/tagassist/insert.do",e).then((function(e){var a=e.data;return 0!=a.code?t.$message.error(a.data||a.msg):(t.$message.success(a.data),t.editAllVisible=!1,t.getDataList(),!1)})).catch((function(e){return t.editAllVisible=!1,t.getDataList()}))})).catch((function(e){return t.editAllVisible=!1,t.getDataList()}))}}),1e3,{leading:!0,trailing:!1}),beforeUploadHandle:function(t){var e=t.size/1024/1024<65;return e||this.$message.error(this.$t("attribute.uploadFileLimitExceeded")),e},handleChange:function(t,e){},handleRemove:function(t,e){this.fileList=[]},uploadSectionFile:function(t){var e=this,a=new FormData;e.$hasPermission("tagTemplate:import:permission.do")?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==t.file.type||"application/vnd.ms-excel"==t.file.type||-1!=t.file.name.indexOf(".xlsx")||-1!=t.file.name.indexOf(".xls")?(e.dataListLoading=!0,a.append("file",t.file),a.append("protocol",e.dataForm.protocolname),e.$http.post("/tagTemplate/import.do",a).then((function(t){var a=t.data;return e.handleRemove(),0==a.code?(e.dataListLoading=!1,e.getDataList(),e.$message.success(a.data||a.msg)):(e.dataListLoading=!1,e.$message.error(a.data||a.msg))})).catch((function(t){return e.handleRemove(),e.dataListLoading=!1,e.getDataList()}))):(e.$message.warning(e.$t("attribute.errorType")),e.handleRemove()):e.$message.warning("暂无测点模板导入权限, 请联系管理员")},handleExportTagChange:function(){var t=this,e={tagIds:t.tagIds.join(",")};t.dataForm.protocolname&&(e["protocol"]=t.dataForm.protocolname),t.$hasPermission("tagTemplate:exports:permission.do")?(t.dataListLoading=!0,d()({url:"".concat(window.SITE_CONFIG["apiURL"],"/tagTemplate/exports.do"),method:"post",data:o.a.stringify(e),responseType:"blob",headers:{token:u.a.get("token")}}).then((function(e){if(e.hasOwnProperty("code"))return t.dataListLoading=!1,t.$message.error(e.data||e.msg);if(e.data){var a=window.URL.createObjectURL(new Blob([e.data])),i=document.createElement("a");return i.href=a,i.setAttribute("download",(new Date).getTime()+".xls"),document.body.appendChild(i),i.click(),t.dataListLoading=!1,t.$message.success("导出成功")}})).catch((function(e){return t.dataListLoading=!1,t.$message.error("导出失败")}))):t.$message.warning("暂无测点模板导出权限, 请联系管理员")},watchProtocolSearch:g()((function(){var t=document.getElementsByClassName("el-scrollbar__wrap").length;document.getElementsByClassName("el-scrollbar__wrap")[t-1].scrollTo(0,0),this.protocolPage=1,this.getprotocolList(),this.$refs.protocolInput.focus()}),500)},mounted:function(){var t=this;t.isShowSetting=0!=sessionStorage.getItem("per"),t.$erd.listenTo(document.getElementById("tagTemplateServicesQueryContainer"),(function(e){var a=document.getElementById("tagTemplateServicesQueryContainer").offsetHeight;t.scrollTableHeight=window.innerHeight-130-a})),t.queryParams=t.$route.query,t.getprotocolList(),window.onresize=function(){return function(){var e=document.getElementById("tagTemplateServicesQueryContainer").offsetHeight;t.scrollTableHeight=window.innerHeight-130-e}()}},watch:{total:function(){this.total==(this.page-1)*this.limit&&0!=this.total&&(this.page-=1,this.getDataList())},page:function(){this.currentPageCheccked=!1},multipleSelectionAll:function(){0!=this.multipleSelectionAll.length&&this.multipleSelectionAll.length==this.dataList.length||(this.currentPageCheccked=!1)},protocolSearch:function(t,e){this.watchProtocolSearch()}}},y=$,F=a("2877"),L=Object(F["a"])(y,i,r,!1,null,null,null);e["default"]=L.exports},e1a5:function(t,e,a){"use strict";a("ac4d"),a("8a81"),a("5df3"),a("1c4c"),a("7f7f"),a("6b54"),a("8e6e"),a("ac6a"),a("456d"),a("4917"),a("6762"),a("2fdb"),a("a481");var i=a("ade3"),r=a("a78e"),l=a.n(r),s=a("4328"),o=a.n(s),n=a("b047"),d=a.n(n);function c(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=u(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,s=!0,o=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return s=t.done,t},e:function(t){o=!0,l=t},f:function(){try{s||null==a.return||a.return()}finally{if(o)throw l}}}}function u(t,e){if(t){if("string"==typeof t)return m(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?m(t,e):void 0}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,i=Array(e);a<e;a++)i[a]=t[a];return i}function g(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function h(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?g(Object(a),!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var p=["/channelinfo","/deviceinfo","/taginfo","/transchannelinfo","/transdeviceinfo","/transtaginfo","/centervar","/scriptinfo","/integralmodule"];e["a"]={data:function(){return{ids:"",exportIds:null,mixinViewModuleOptions:{activatedIsNeed:!0,getDataListURL:"",getDataListIsPage:!1,deleteURL:"",deleteIsBatch:!1,deleteIsBatchKey:"id",exportURL:""},dataForm:{},dataList:[],order:"",orderField:"",page:1,limit:20,total:0,dataListLoading:!1,dataListSelections:[],addOrUpdateVisible:!1,storeselection:[]}},activated:function(){this.mixinViewModuleOptions.activatedIsNeed&&this.getDataList()},methods:{getDataList:function(){var t=this;this.dataListLoading=!0,this.$http.get(this.mixinViewModuleOptions.getDataListURL,{params:h({order:this.order,orderField:this.orderField,page:this.mixinViewModuleOptions.getDataListIsPage?this.page:null,limit:this.mixinViewModuleOptions.getDataListIsPage?this.limit:null},this.dataForm)}).then((function(e){var a=e.data;if(t.dataListLoading=!1,0!==a.code)return t.dataList=[],t.total=0,t.$message.error(a.msg);t.dataList=(t.mixinViewModuleOptions.getDataListIsPage,Array.isArray(a.data)?a.data:a.data.list),t.total=t.mixinViewModuleOptions.getDataListIsPage?a.data.total:0})).catch((function(e){return t.dataListLoading=!1,!1}))},dataListSelectionChangeHandle:function(t){this.storeselection=[],this.dataListSelections=t;var e,a=c(this.dataListSelections);try{for(a.s();!(e=a.n()).done;){var i=e.value;this.storeselection.push(i.id)}}catch(r){a.e(r)}finally{a.f()}this.ids=this.storeselection.join(","),this.$store.dispatch("changeIds",this.ids)},dataListSortChangeHandle:function(t){if(!t.order||!t.prop)return this.order="",this.orderField="",!1;this.order=t.order.replace(/ending$/,""),this.orderField=t.prop.replace(/([A-Z])/g,"_$1").toLowerCase(),this.getDataList()},pageSizeChangeHandle:function(t){this.page=1,this.limit=t,this.getDataList()},pageCurrentChangeHandle:function(t){this.page=t,this.getDataList()},addOrUpdateHandle:function(t){var e=this,a=!1;p.forEach((function(t){window.location.href.includes(t)&&(a=!0)})),a?this.$hasSessionStorageGwsn()?(this.addOrUpdateVisible=!0,this.$nextTick((function(){e.$refs.addOrUpdate.dataForm.id=t,e.$refs.addOrUpdate.init()}))):this.$message({showClose:!1,message:"未获取到网关编号",type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}}):(this.addOrUpdateVisible=!0,this.$nextTick((function(){e.$refs.addOrUpdate.dataForm.id=t,e.$refs.addOrUpdate.init()})))},deleteHandle:d()((function(t){var e=this;if(this.mixinViewModuleOptions.deleteIsBatch&&!t&&this.dataListSelections.length<=0)return this.$message.warning(this.$t("prompt.deleteBatch"));this.$confirm(this.$t("prompt.info",{handle:this.$t("delete")}),this.$t("prompt.title"),{confirmButtonText:this.$t("confirm"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((function(){e.dataListLoading=!0,e.$http.delete("".concat(e.mixinViewModuleOptions.deleteURL).concat(e.mixinViewModuleOptions.deleteIsBatch?"":"/"+t),e.mixinViewModuleOptions.deleteIsBatch?{data:t?[t]:e.dataListSelections.map((function(t){return t[e.mixinViewModuleOptions.deleteIsBatchKey]}))}:{}).then((function(t){var a=t.data;if(0!==a.code)return e.dataListLoading=!1,e.$message.error(a.msg);e.$message({message:e.$t("prompt.success"),type:"success",duration:500,onClose:function(){e.getDataList()}})})).catch((function(t){return e.dataListLoading=!1,!1}))})).catch((function(t){}))}),1e3,{leading:!0,trailing:!1}),postExcelFile:function(t,e){var a=document.createElement("form");for(var i in a.style.display="none",a.action=e,a.method="post",document.body.appendChild(a),t){var r=document.createElement("input");r.type="hidden",r.name=i,r.value=t[i],a.appendChild(r)}a.submit(),a.remove()},exportHandle:d()((function(){var t=!1,e={token:l.a.get("token"),ids:null};if(this.exportIds&&(e.ids=this.exportIds,t=!0),this.ids&&(e.ids=this.ids,t=!0),"/info/taginfo/exports"==this.mixinViewModuleOptions.exportURL||"/info/transtaginfo/exportss"==this.mixinViewModuleOptions.exportURL)return e.ids=this.exportIds,"/info/taginfo/exports"==this.mixinViewModuleOptions.exportURL&&-1!=window.location.href.indexOf("/taginfo")&&(e.devtype=window.devTagType),this.$message.success(this.$t("exportData.exportSuccess")),this.postExcelFile(e,"".concat(window.SITE_CONFIG["apiURL"]).concat(this.mixinViewModuleOptions.exportURL));"/sys/log/login/export"!=this.mixinViewModuleOptions.exportURL&&"/sys/log/operation/export"!=this.mixinViewModuleOptions.exportURL&&"/sys/log/error/export"!=this.mixinViewModuleOptions.exportURL||(t=!0);var a=o.a.stringify(e);if(!t)return this.$message.info(this.$t("exportData.noExportData"));var i=this,r="".concat(window.SITE_CONFIG["apiURL"]).concat(this.mixinViewModuleOptions.exportURL,"?").concat(a),s=new XMLHttpRequest;s.open("get",r),s.responseType="blob",s.send(),s.onreadystatechange=function(){if(4==s.readyState&&200==s.status){var t=i.browserType();if("ie"!==t.browser||"10.0"!=t.version&&"11.0"!=t.version)if("chrome"===t.browser){window.URL.createObjectURL(this.response),e=document.createElement("iframe");e.src="".concat(window.SITE_CONFIG["apiURL"]).concat(i.mixinViewModuleOptions.exportURL,"?").concat(a),e.style.display="none",document.body.appendChild(e)}else window.location.href="".concat(window.SITE_CONFIG["apiURL"]).concat(i.mixinViewModuleOptions.exportURL,"?").concat(a);else{window.URL.createObjectURL(this.response);var e=document.createElement("iframe");e.src="".concat(window.SITE_CONFIG["apiURL"]).concat(i.mixinViewModuleOptions.exportURL,"?").concat(a),e.style.display="none",document.body.appendChild(e)}return i.$message.success(i.$t("exportData.exportSuccess"))}}}),1e3,{leading:!0,trailing:!1}),browserType:function(){var t=navigator.userAgent.toLowerCase(),e={ie:function(){return!(!window.ActiveXObject&&!("ActiveXObject"in window))},edge:function(){return/dge/.test(t)},chrome:function(){return/chrome/.test(t)},safari:function(){return/safari/.test(t)&&!/chrome/.test(t)},opera:function(){return/opera/.test(t)},msie:function(){return/msie/.test(t)&&!/opera/.test(t)},mozilla:function(){return/mozilla/.test(t)&&!/(compatible|webkit)/.test(t)}},a={};for(var i in e){var r=e[i](),l=(t.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1];if(r)return a.browser=i,a.version=l,a}}}}}}]);
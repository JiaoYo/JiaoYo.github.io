(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8bc1e202"],{"043a":function(e,t,n){},8520:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e._self._c;return t("section",[t("div",{staticClass:"total"},[t("div",{staticClass:"systemOverview"},[t("div",[t("div",[t("div",{staticClass:"systemOverviewLeft"},[e._v(e._s(e.$t("indexPage.connectedDeviceTotal")))]),t("div",{staticClass:"systemOverviewRight"},[e._v(e._s(e.deviceForm.baseCount))])]),t("div",{staticClass:"systemOverviewMargin"},[t("div",{staticClass:"systemOverviewLeft"},[e._v(e._s(e.$t("indexPage.deviceInOffLine")))]),t("div",{staticClass:"systemOverviewRight"},[t("span",{staticClass:"systemOverviewOnline"},[e._v(e._s(e.deviceForm.onlineCount))]),e._v(" / "),t("span",{staticClass:"systemOverviewOffline"},[e._v(e._s(e.deviceForm.offlineCount))])])])]),t("div",[t("div",[t("div",{staticClass:"systemOverviewLeft"},[e._v(e._s(e.$t("indexPage.projectTotal")))]),t("div",{staticClass:"systemOverviewRight"},[e._v(e._s(e.deviceForm.priinfo))])]),t("div",{staticClass:"systemOverviewMargin"},[t("div",{staticClass:"systemOverviewLeft"},[e._v(e._s(e.$t("indexPage.deviceInLineRate")))]),t("div",{staticClass:"systemOverviewRight"},[t("span",{staticClass:"systemOverviewOnline"},[e._v(e._s(e.deviceForm.onlineRate))]),e._v(" %\n                    ")])])])])]),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%",height:"660px","margin-top":"20px"},attrs:{id:"container"}})])},a=[],s=(n("7f7f"),n("024c")),o=n.n(s),r={name:"home",data:function(){return{timer:null,loading:!1,deviceForm:{baseCount:0,onlineCount:0,offlineCount:0,priinfo:0,onlineRate:0},mapStyle:"amap://styles/normal"}},methods:{getCurrentTime:function(){var e=new Date,t=e.getHours();this.mapStyle=t>=19||t<=6?"amap://styles/darkblue":"amap://styles/normal"},init:function(){var e=this,t=[],n={};e.loading=!0,e.$http.get("/list/getProList.do",{params:n}).then((function(n){var i=n.data;if(0!=i.code)return e.loading=!1,e.$message.error(i.data||i.msg);for(var a=0;a<i.data.length;a++){var s=i.data[a];if(s.latitude&&s.longitude){var r={lnglat:[s.longitude,s.latitude],name:s.prjName,style:0,prjNameI18n:e.$t("indexPage.projectName")};t.push(r)}}var l=e.mapStyle,d=new o.a.Map("container",{resizeEnable:!0,zoom:3,mapStyle:l});o.a.plugin(["AMap.ToolBar","AMap.OverView","AMap.MapType","AMap.Scale","AMap.Geolocation"],(function(){var n;if(d.clearMap(),d.addControl(new o.a.ToolBar),d.addControl(new o.a.OverView),d.addControl(new o.a.MapType),d.addControl(new o.a.Scale),e.loading=!1,t.length>0){var i=[{url:"https://a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-default.png",anchor:new o.a.Pixel(6,6),size:new o.a.Size(25,34),zIndex:3}],a=new o.a.MassMarks(t,{opacity:.8,zIndex:111,cursor:"pointer",style:i});a.setMap(d),a.on("mouseover",(function(e){n.setContent("<ul style='list-style-type: none; padding: 10px; background: #000000; border: 1px solid #ccc; border-radius: 5px; font-size: 14px;'><li style='color: #ffffff;'>"+e.data.prjNameI18n+"<span>"+e.data.name+"</span></li></ul>"),n.open(d,e.data.lnglat)})),a.on("mouseout",(function(e){d.clearInfoWindow()})),a.on("click",(function(t){d.clearInfoWindow(),e.$router.push({path:"/tprj-tprjinfo",query:{prjName:t.data.name}})})),n=new o.a.InfoWindow({isCustom:!0,draggable:!0,offset:new o.a.Pixel(0,0),content:""})}}))})).catch((function(e){return!1}))},getOnlineStatus:function(){var e=this,t={};e.$http.get("/info/ding/count/gwbaseInfoCount",{params:t}).then((function(t){var n=t.data;if(0!=n.code)return e.$message.error(n.msg);e.deviceForm.baseCount=n.data.baseCount,e.deviceForm.onlineCount=n.data.onlineCount,e.deviceForm.offlineCount=n.data.offlineCount,e.deviceForm.priinfo=n.data.priinfo,0===e.deviceForm.baseCount?e.deviceForm.onlineRate=0:e.deviceForm.onlineRate=Math.ceil(e.deviceForm.onlineCount/e.deviceForm.baseCount*1e4/100)})).catch((function(e){return!1}))},getOnlineCount:function(){var e=this;this.timer=setInterval((function(){e.getOnlineStatus()}),1e4)}},mounted:function(){window.onbeforeunload=function(e){this.timer&&(clearInterval(this.timer),this.timer=null)}},beforeDestroy:function(){this.timer&&(clearInterval(this.timer),this.timer=null)},activated:function(){this.getOnlineStatus(),this.getOnlineCount(),this.getCurrentTime(),this.init()},deactivated:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}},l=r,d=(n("9ed9"),n("2877")),c=Object(d["a"])(l,i,a,!1,null,"3fa1be2b",null);t["default"]=c.exports},"9ed9":function(e,t,n){"use strict";n("043a")}}]);
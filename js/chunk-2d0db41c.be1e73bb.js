(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0db41c"],{"6ea8":function(t,e,o){"use strict";o.r(e);o("7f7f");var a=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{visible:t.visible,title:t.dataForm.id?t.$t("update"):t.$t("add"),"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":t.handleClose},on:{"update:visible":function(e){t.visible=e}}},[e("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"dataForm",attrs:{model:t.dataForm,rules:t.rules,"label-width":"140px"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.dataFormSubmitHandle()}}},[e("el-row",[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{prop:"protocol",label:t.$t("protocolManage.protocolName")}},[e("el-select",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.handleProtocolScroll,expression:"handleProtocolScroll"}],staticStyle:{width:"100%"},attrs:{clearable:!1,disabled:"",placeholder:t.$t("select")},on:{"visible-change":t.handleProtocolVisibleChange,change:t.handleSelectProtocolChange,clear:t.handleProtocolClearChange},model:{value:t.dataForm.fpno,callback:function(e){t.$set(t.dataForm,"fpno",e)},expression:"dataForm.fpno"}},[[e("div",{staticStyle:{width:"100%",position:"absolute",left:"0",top:"0","z-index":"99","background-color":"#fff"}},[e("el-input",{ref:"protocolInput",staticStyle:{width:"98%","margin-left":"1%","margin-top":"5px","margin-bottom":"5px"},attrs:{size:"small",clearable:"",placeholder:t.$t("integralmodule.pleaseEnterSearchContent")},model:{value:t.protocolSearch,callback:function(e){t.protocolSearch=e},expression:"protocolSearch"}})],1),e("div",{staticStyle:{width:"100%",height:"42px"}}),t._l(t.protocolList,(function(t){return e("el-option",{key:t.guid,attrs:{label:t.name,value:t.guid,disabled:!!t.hasOwnProperty("disabled")&&t.disabled}})}))]],2)],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{prop:"fno",label:t.$t("protocolManage.dataNumber")}},[e("el-input",{attrs:{placeholder:t.$t("protocolManage.pleaseEnterDataNumber"),clearable:""},model:{value:t.dataForm.fno,callback:function(e){t.$set(t.dataForm,"fno",e)},expression:"dataForm.fno"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{prop:"fdesc",label:t.$t("protocolManage.dataDesc")}},[e("el-input",{attrs:{placeholder:t.$t("protocolManage.pleaseEnterDataDesc"),clearable:""},model:{value:t.dataForm.fdesc,callback:function(e){t.$set(t.dataForm,"fdesc",e)},expression:"dataForm.fdesc"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{prop:"fdataflag",label:t.$t("protocolManage.dataSystem")}},[e("el-select",{staticStyle:{width:"100%"},attrs:{clearable:!1,placeholder:t.$t("select")},model:{value:t.dataForm.fdataflag,callback:function(e){t.$set(t.dataForm,"fdataflag",e)},expression:"dataForm.fdataflag"}},t._l(t.dataFlagList,(function(t){return e("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})})),1)],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{prop:"fvalue",label:t.$t("protocolManage.dataValue")}},[e("el-input",{attrs:{placeholder:t.$t("protocolManage.pleaseEnterDataValue"),clearable:""},model:{value:t.dataForm.fvalue,callback:function(e){t.$set(t.dataForm,"fvalue",e)},expression:"dataForm.fvalue"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{prop:"fdescEng",label:t.$t("protocolManage.dataDescEn")}},[e("el-input",{attrs:{placeholder:t.$t("protocolManage.pleaseEnterDataDescEn"),clearable:""},model:{value:t.dataForm.fdescEng,callback:function(e){t.$set(t.dataForm,"fdescEng",e)},expression:"dataForm.fdescEng"}})],1)],1),e("el-col",{attrs:{span:24}},[e("el-form-item",{attrs:{prop:"foptions",label:t.$t("protocolManage.option")}},[e("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:6},placeholder:t.$t("protocolManage.pleaseEnterOption")},model:{value:t.dataForm.foptions,callback:function(e){t.$set(t.dataForm,"foptions",e)},expression:"dataForm.foptions"}})],1)],1)],1)],1),e("template",{slot:"footer"},[e("el-button",{on:{click:t.handleClose}},[t._v(t._s(t.$t("cancel")))]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.dataFormSubmitHandle()}}},[t._v(t._s(t.$t("confirm")))]),t.dataForm.id?t._e():e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.dataFormSubmitHandle(1)}}},[t._v(t._s(t.$t("protocolManage.okAndContinueAdd")))])],1)],2)},r=[],l=(o("8e6e"),o("ac6a"),o("456d"),o("ade3")),n=(o("c5f6"),o("b047")),s=o.n(n);function i(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,a)}return o}function c(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?i(Object(o),!0).forEach((function(e){Object(l["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var d={directives:{loadmore:{inserted:function(t,e){var o=t.querySelector(".el-select-dropdown .el-select-dropdown__wrap");o.addEventListener("scroll",(function(){var t=this.scrollHeight-Math.ceil(this.scrollTop)<=this.clientHeight;t&&0!==this.scrollTop&&e.value()}))}}},props:["protocol","protocolName","propId"],data:function(){return{visible:!1,loading:!1,protocolSearch:"",protocolInfo:{page:1,total:0},isClosePage:!1,protocolList:[],protocolParamsDefault:[],dataForm:{id:"",fname:"",fpno:"",fno:"",fdesc:"",fdataflag:"",fvalue:"",foptions:"",fdescEng:""},rules:{fpno:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],fno:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],fdesc:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],fdataflag:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]},dataFlagList:[{name:this.$t("channelInfo.hexadecimal"),value:16},{name:this.$t("channelInfo.decimalsystem"),value:10},{name:this.$t("channelInfo.string"),value:0}]}},methods:{handleProtocolClearChange:function(){this.dataForm.fpno="",this.dataForm.fname=""},handleSelectProtocolChange:function(t){},handleProtocolVisibleChange:function(t){var e=this;t&&this.$nextTick((function(){e.$refs.protocolInput.focus()}))},handleProtocolScroll:function(){this.protocolList.length<this.protocolInfo.total&&(this.protocolInfo.page++,this.getProtocalList())},watchProtocolSearch:s()((function(){var t=document.getElementsByClassName("el-scrollbar__wrap").length;document.getElementsByClassName("el-scrollbar__wrap")[t-1].scrollTo(0,0),this.protocolInfo.page=1,this.getProtocalList(),this.$refs.protocolInput.focus()}),500),getProtocalList:function(){var t=this,e={page:t.protocolInfo.page,limit:500,fuzzy:t.protocolSearch,_t:(new Date).getTime()};t.$hasPermission("protocol:select:permission.do")?t.$http.get("/protocol/getPage.do",{params:e}).then((function(e){var o=e.data;if(0!=o.code)return t.$message.error(o.data||o.msg);1==t.protocolInfo.page?t.protocolList=o.data.list:t.protocolList=t.protocolList.concat(o.data.list),t.protocolInfo.total=Number(o.data.total)||0,0==t.protocolList.length?(t.dataForm.fpno="",t.prjList.push({guid:t.$t("noMatchingDataYet"),name:t.$t("noMatchingDataYet"),disabled:!0})):(t.dataForm.fpno=t.protocol,t.dataForm.fname=t.protocolName),t.dataForm.id?t.getInfo():t.getProtocolFpnoMax()})).catch((function(t){return!1})):t.$message.warning("暂无协议查询权限, 请联系管理员")},getProtocolFpnoMax:function(){var t=this,e={page:1,limit:20,f_pno:t.dataForm.fpno,sort:"id desc"};t.$hasPermission("protocolDft:select:permission.do")?t.$http.get("/protocolDft/getPage.do",{params:e}).then((function(e){var o=e.data;if(0!=o.code)return t.$message.error(o.data||o.msg);o.data.list.length>0?t.dataForm.fno=o.data.list[0].fno+1:t.dataForm.fno=0})).catch((function(t){return!1})):t.$message.warning("暂无协议查询权限, 请联系管理员")},init:function(){var t=this;this.visible=!0,this.$nextTick((function(){t.isClosePage=!1,t.$refs["dataForm"].resetFields(),t.dataForm.id=t.propId,t.protocolSearch=t.protocolName}))},getDataListByFpno:function(){var t=this,e={fpno:t.dataForm.fpno,_t:(new Date).getTime()};t.$hasPermission("protocolDefattr:select:permission.do")?t.$http.get("/info/protocolDefattr/selectByfpno",{params:e}).then((function(e){var o=e.data;if(0!=o.code)return t.$message.error(o.data||o.msg);t.protocolParamsDefault=o.data||[]})):t.$message.warning("暂无规约信息查询权限, 请联系管理员")},getInfo:function(){var t=this;if(!this.$hasPermission("protocolDft:select:permission.do"))return this.loading=!1,void this.$message.warning("暂无规约参数信息查询权限, 请联系管理员");this.loading=!0,this.$http.get("/protocolDft/selectById.do",{params:{id:this.dataForm.id}}).then((function(e){var o=e.data;if(o.hasOwnProperty("code")&&0!=o.code)return t.loading=!1,t.$message.error(o.data||o.msg),!1;t.dataForm=c(c({},t.dataForm),o.data),t.loading=!1})).catch((function(e){return t.loading=!1,!1}))},handleClose:s()((function(){this.isClosePage=!0,this.protocolSearch="",this.visible=!1}),1e3,{leading:!0,trailing:!1}),dataFormSubmitHandle:s()((function(t){var e=this;this.$refs["dataForm"].validate((function(o){if(!o)return!1;var a="/protocolDft/insert.do";if(e.dataForm.id){if(a="/protocolDft/update.do",!e.$hasPermission("protocolDft:update:permission.do"))return void e.$message.warning("暂无规约参数修改权限, 请联系管理员")}else if(!e.$hasPermission("protocolDft:insert:permission.do"))return void e.$message.warning("暂无规约参数新增权限, 请联系管理员");e.loading=!0,e.$http[e.dataForm.id?"put":"post"](a,[e.dataForm]).then((function(o){var a=o.data;if(0!=a.code)return e.loading=!1,e.$message.error(a.data||a.msg);e.loading=!1,e.$message.success(a.msg),1==t?e.dataForm.fno=e.dataForm.fno+1:(e.isClosePage=!0,e.protocolSearch="",e.visible=!1,e.$emit("refreshDataList"))})).catch((function(t){return e.loading=!1,e.isClosePage=!0,e.protocolSearch="",e.visible=!1,e.$emit("refreshDataList"),!1}))}))}),1e3,{leading:!0,trailing:!1})},watch:{protocolSearch:function(t,e){this.isClosePage||this.watchProtocolSearch()}}},p=d,f=o("2877"),m=Object(f["a"])(p,a,r,!1,null,null,null);e["default"]=m.exports}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3bf316a4","chunk-2d0b95b6"],{"2a1f":function(e,t,n){"use strict";n.r(t);n("34ef"),n("28a5"),n("6b54"),n("4917");
/*! @source http://purl.eligrey.com/github/Blob.js/blob/master/Blob.js */
(function(e){if(e.URL=e.URL||e.webkitURL,e.Blob&&e.URL)try{return void new Blob}catch(a){}var t=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||function(e){var t=function(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]},n=function(){this.data=[]},a=function(e,t,n){this.data=e,this.size=e.length,this.type=t,this.encoding=n},r=n.prototype,i=a.prototype,o=e.FileReaderSync,s=function(e){this.code=this[this.name=e]},l="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),c=l.length,d=e.URL||e.webkitURL||e,u=d.createObjectURL,f=d.revokeObjectURL,h=d,m=e.btoa,g=e.atob,p=e.ArrayBuffer,b=e.Uint8Array,v=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;a.fake=i.fake=!0;while(c--)s.prototype[l[c]]=c+1;return d.createObjectURL||(h=e.URL=function(e){var t,n=document.createElementNS("http://www.w3.org/1999/xhtml","a");return n.href=e,"origin"in n||("data:"===n.protocol.toLowerCase()?n.origin=null:(t=e.match(v),n.origin=t&&t[1])),n}),h.createObjectURL=function(e){var t,n=e.type;return null===n&&(n="application/octet-stream"),e instanceof a?(t="data:"+n,"base64"===e.encoding?t+";base64,"+e.data:"URI"===e.encoding?t+","+decodeURIComponent(e.data):m?t+";base64,"+m(e.data):t+","+encodeURIComponent(e.data)):u?u.call(d,e):void 0},h.revokeObjectURL=function(e){"data:"!==e.substring(0,5)&&f&&f.call(d,e)},r.append=function(e){var n=this.data;if(b&&(e instanceof p||e instanceof b)){for(var r="",i=new b(e),l=0,c=i.length;l<c;l++)r+=String.fromCharCode(i[l]);n.push(r)}else if("Blob"===t(e)||"File"===t(e)){if(!o)throw new s("NOT_READABLE_ERR");var d=new o;n.push(d.readAsBinaryString(e))}else e instanceof a?"base64"===e.encoding&&g?n.push(g(e.data)):"URI"===e.encoding?n.push(decodeURIComponent(e.data)):"raw"===e.encoding&&n.push(e.data):("string"!==typeof e&&(e+=""),n.push(unescape(encodeURIComponent(e))))},r.getBlob=function(e){return arguments.length||(e=null),new a(this.data.join(""),e,"raw")},r.toString=function(){return"[object BlobBuilder]"},i.slice=function(e,t,n){var r=arguments.length;return r<3&&(n=null),new a(this.data.slice(e,r>1?t:this.data.length),n,this.encoding)},i.toString=function(){return"[object Blob]"},i.close=function(){this.size=0,delete this.data},n}(e);e.Blob=function(e,n){var a=n&&n.type||"",r=new t;if(e)for(var i=0,o=e.length;i<o;i++)Uint8Array&&e[i]instanceof Uint8Array?r.append(e[i].buffer):r.append(e[i]);var s=r.getBlob(a);return!s.slice&&s.webkitSlice&&(s.slice=s.webkitSlice),s};var n=Object.getPrototypeOf||function(e){return e.__proto__};e.Blob.prototype=n(new e.Blob)})("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||void 0)},3333:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.visible,title:e.dataForm.id?e.$t("update"):e.$t("add"),"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t},opened:e.handleDialogOpenChange}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataForm",attrs:{model:e.dataForm,rules:e.rules,"label-width":"en-US"===e.$i18n.locale?"150px":"120px"},nativeOn:{submit:function(t){return t.preventDefault(),e.dataFormSubmitHandle()}}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:e.$t("product.customerName"),prop:"uname"}},[t("el-input",{ref:"unameInput",attrs:{placeholder:e.$t("product.pleaseEnterCustomerName"),clearable:""},model:{value:e.dataForm.uname,callback:function(t){e.$set(e.dataForm,"uname",t)},expression:"dataForm.uname"}})],1)],1)],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:function(t){return e.handleClose()}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmitHandle()}}},[e._v(e._s(e.$t("confirm")))])],1)],2)},r=[],i=(n("8e6e"),n("ac6a"),n("456d"),n("ade3")),o=n("b047"),s=n.n(o);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){Object(i["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={data:function(){return{visible:!1,loading:!1,dataForm:{id:"",uname:""},rules:{uname:[{required:!0,message:this.$t("validate.required"),trigger:["change","blur"]}]}}},methods:{init:function(){this.loading=!0,this.visible=!0},handleDialogOpenChange:function(){this.$refs["dataForm"].resetFields(),this.dataForm.id?this.getInfo():(this.$refs.unameInput.focus(),this.loading=!1)},getInfo:function(){var e=this,t={id:e.dataForm.id,_t:(new Date).getTime()};e.$hasPermission("userCus:select:permission.do")?e.$http.get("/userCus/select.do",{params:t}).then((function(t){var n=t.data;if(0!==n.code)return e.loading=!1,e.$message.error(n.data||n.msg);e.dataForm=c(c({},e.dataForm),n.data),e.$refs.unameInput.focus(),e.loading=!1})).catch((function(t){return e.loading=!1,!1})):e.$message.warning("暂无客户信息查询权限, 请联系管理员")},handleClose:function(){this.dataForm.id="",this.dataForm.uname="",this.$refs["dataForm"].resetFields(),this.visible=!1},dataFormSubmitHandle:s()((function(){var e=this,t="/userCus/insert.do",n=[{uname:e.dataForm.uname}];e.$refs["dataForm"].validate((function(a){if(!a)return!1;if(e.dataForm.id){if(!e.$hasPermission("userCus:update:permission.do"))return void e.$message.warning("暂无客户信息查询权限, 请联系管理员");t="/userCus/update.do",n[0]["id"]=e.dataForm.id}else if(!e.$hasPermission("userCus:insert:permission.do"))return void e.$message.warning("暂无客户信息查询权限, 请联系管理员");e.loading=!0,e.$http[e.dataForm.id?"put":"post"](t,n).then((function(t){var n=t.data;if(0!==n.code)return e.loading=!1,e.$message.error(n.data||n.msg),!1;e.loading=!1,e.dataForm.id,e.$message({message:e.$t("prompt.success"),type:"success",duration:500,onClose:function(){e.visible=!1,e.$emit("refreshDataList")}})})).catch((function(t){return e.loading=!1,e.visible=!1,e.$emit("refreshDataList")}))}))}),1e3,{leading:!0,trailing:!1})}},u=d,f=n("2877"),h=Object(f["a"])(u,a,r,!1,null,null,null);t["default"]=h.exports},"376b":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));n("6b54"),n("34ef"),n("ac6a");function a(e,t){t&&(e+=1462);var n=Date.parse(e);return(n-new Date(Date.UTC(1899,11,30)))/864e5}function r(e,t){for(var n={},r={s:{c:1e7,r:1e7},e:{c:0,r:0}},i=0;i!=e.length;++i)for(var o=0;o!=e[i].length;++o){r.s.r>i&&(r.s.r=i),r.s.c>o&&(r.s.c=o),r.e.r<i&&(r.e.r=i),r.e.c<o&&(r.e.c=o);var s={v:e[i][o]};if(null!=s.v){var l=XLSX.utils.encode_cell({c:o,r:i});"number"===typeof s.v?s.t="n":"boolean"===typeof s.v?s.t="b":s.v instanceof Date?(s.t="n",s.z=XLSX.SSF._table[14],s.v=a(s.v)):s.t="s",n[l]=s}}return r.s.c<1e7&&(n["!ref"]=XLSX.utils.encode_range(r)),n}function i(){if(!(this instanceof i))return new i;this.SheetNames=[],this.Sheets={}}function o(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),a=0;a!=e.length;++a)n[a]=255&e.charCodeAt(a);return t}function s(e,t,n){var a=t;a.unshift(e);for(var s="SheetJS",l=new i,c=r(a),d=a.map((function(e){return e.map((function(e){return null==e?{wch:10}:e.toString().charCodeAt(0)>255?{wch:2*e.toString().length+5}:{wch:e.toString().length+5}}))})),u=d[0],f=1;f<d.length;f++)for(var h=0;h<d[f].length;h++)u[h]["wch"]<d[f][h]["wch"]&&(u[h]["wch"]=d[f][h]["wch"]);c["!cols"]=u,l.SheetNames.push(s),l.Sheets[s]=c;var m=XLSX.write(l,{bookType:"xlsx",bookSST:!1,type:"binary"}),g=n||"列表";saveAs(new Blob([o(m)],{type:"application/octet-stream"}),g+".xlsx")}n("2a1f"),n("0fd4"),n("1447")},"3ffb":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e._self._c;return t("el-card",{attrs:{shadow:"never"}},[t("div",{attrs:{id:"customerUserContainer"}},[t("el-form",{attrs:{inline:!0,model:e.dataForm},nativeOn:{submit:function(e){e.preventDefault()},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.querySearch()}}},[t("el-form-item",[t("el-input",{staticStyle:{width:"300px"},attrs:{size:"small",placeholder:e.$t("product.pleaseEnterCustomerName"),clearable:""},on:{clear:e.querySearch},model:{value:e.dataForm.fuzzy,callback:function(t){e.$set(e.dataForm,"fuzzy",t)},expression:"dataForm.fuzzy"}})],1),e.$hasPermission("userCus:select:permission.do")?t("el-form-item",[t("el-button",{attrs:{size:"small",icon:"el-icon-search"},on:{click:function(t){return e.querySearch()}}},[e._v(e._s(e.$t("query")))])],1):e._e(),e.$hasPermission("userCus:insert:permission.do")?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.handleAddOrUpdate()}}},[e._v("\n                    "+e._s(e.$t("add"))+"\n                ")])],1):e._e(),e.$hasPermission("userCus:delete:permission.do")?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete",disabled:0===e.customerUserIds.length||0===e.dataList.length},on:{click:function(t){return e.deleteHandle()}}},[e._v(e._s(e.$t("deleteBatch"))+" ")])],1):e._e(),e.$hasPermission("userCus:select:permission.do")?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-download",disabled:0===e.customerUserIds.length||0===e.dataList.length},on:{click:function(t){return e.handleExportCustomerProductData()}}},[e._v("\n                    "+e._s(e.$t("export"))+"\n                ")])],1):e._e(),e.$hasPermission("userCus:select:permission.do")?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"success"},on:{click:e.getDataList}},[t("i",{staticClass:"el-icon-refresh"})])],1):e._e()],1)],1),e.scrollTableHeight?t("div",[t("vxe-table",{ref:"recordTable",staticStyle:{width:"100%"},attrs:{size:"mini",border:"",resizable:"","auto-resize":"","sync-resize":"","show-overflow":"","show-header-overflow":"","highlight-hover-row":"","highlight-current-row":"","max-height":e.scrollTableHeight,loading:e.dataListLoading,"row-config":{keyField:"id"},"checkbox-config":e.checkboxConfig,"scroll-y":{enabled:!0}},on:{"checkbox-all":e.selectAll,"checkbox-change":e.dataListSelectionHandleChange}},[e.$hasPermission("userCus:delete:permission.do")?t("vxe-table-column",{attrs:{type:"checkbox","header-align":"center",align:"center",width:"60",fixed:"left",checked:!1}}):e._e(),t("vxe-table-column",{attrs:{field:"id",title:e.$t("attribute.number"),"header-align":"center",align:"center",width:"100",fixed:"left"}}),t("vxe-table-column",{attrs:{field:"uname",title:e.$t("product.customerName"),"header-align":"center",align:"center","show-overflow-tooltip":!0}}),e.$hasPermission("userCus:update:permission.do")||e.$hasPermission("userCus:delete:permission.do")?t("vxe-table-column",{attrs:{title:e.$t("handle"),fixed:"right","header-align":"center",align:"center",width:"160"},scopedSlots:e._u([{key:"default",fn:function(n){return[e.$hasPermission("userCus:update:permission.do")?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleAddOrUpdate(n.row.id)}}},[e._v("\n                        "+e._s(e.$t("update"))+"\n                    ")]):e._e(),1==e.superAdmin&&e.$hasPermission("userCus:delete:permission.do")?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.deleteHandle(n.row.id)}}},[e._v(e._s(e.$t("delete"))+" ")]):e._e()]}}],null,!1,93616948)}):e._e()],1),t("vxe-pager",{attrs:{perfect:"",size:"mini",loading:e.pagerLoading,"current-page":e.page,"page-size":e.limit,"page-sizes":[100,200,500,1e3],total:e.total,layouts:["PrevPage","JumpNumber","NextPage","FullJump","Sizes","Total"]},on:{"page-change":e.handlePageChange}})],1):e._e(),e.addOrUpdateVisible?t("add-or-update",{ref:"addOrUpdate",on:{refreshDataList:e.getDataList}}):e._e()],1)},r=[],i=(n("ac6a"),n("c5f6"),n("b047")),o=n.n(i),s=n("3333"),l=n("376b"),c={data:function(){return{page:1,limit:1e3,total:0,superAdmin:0,customerUserIds:[],dataForm:{fuzzy:""},pageSizes:[100,200,500,1e3],scrollTableHeight:0,dataListLoading:!1,pagerLoading:!1,addOrUpdateVisible:!1,checkboxConfig:{checkStrictly:!1,reserve:!0,highlight:!0,checkField:"checked"}}},components:{AddOrUpdate:s["default"]},methods:{handlePageChange:function(e){var t=e.currentPage,n=e.pageSize;this.page=t,this.limit=n,this.getDataList()},querySearch:function(){this.page=1,this.getDataList()},getDataList:o()((function(){var e=this,t=this,n={pageNum:t.page,pageSize:t.limit,_t:(new Date).getTime()};t.dataForm.fuzzy&&(n["fuzzy"]=t.dataForm.fuzzy),t.dataList=[],t.total=0,t.$hasPermission("userCus:select:permission.do")?(t.dataListLoading=!0,t.pagerLoading=!0,t.$http.get("/userCus/getPage.do",{params:n}).then((function(e){var a=e.data;t.customerUserIds=[],t.page=n.pageNum,0!=a.code&&t.$refs.recordTable&&t.$refs.recordTable.loadData([]).then((function(){t.dataListLoading=!1,t.pagerLoading=!1})).finally((function(){return t.$message.error(a.data||a.msg)})),t.dataList=a.data.list||[],t.$refs.recordTable&&(t.$refs.recordTable.clearCheckboxRow(),t.$refs.recordTable.loadData(t.dataList).then((function(){t.dataListLoading=!1,t.pagerLoading=!1,t.total=Number(a.data.total)||0})).finally((function(){if(document.getElementsByClassName("vxe-pager--goto-text").length>0){var e=document.createEvent("HTMLEvents"),n=document.getElementsByClassName("vxe-input--inner")[0];document.getElementsByClassName("vxe-pager--goto-text")[0].innerHTML=t.$t("goto"),document.getElementsByClassName("vxe-pager--classifier-text")[0].innerHTML=t.$t("page"),n.value=parseInt(n.value),e.initEvent("input",!0,!0),n.dispatchEvent(e),document.getElementsByClassName("vxe-pager--total")[0].innerHTML=t.$t("total")+" "+t.total+" "+t.$t("records"),document.querySelector(".vxe-input--inner").addEventListener("click",(function(){for(var e=document.querySelectorAll(".vxe-select-option"),n=0;n<e.length;n++){var a=e[n];a.innerHTML=t.pageSizes[n]+" "+t.$t("articlePage")}}))}})))})).catch((function(t){return e.dataListLoading=!1,!1}))):t.$message.warning("暂无客户查询权限, 请联系管理员")}),100,{leading:!0,trailing:!1}),selectAll:function(e){var t=this;this.customerUserIds=[],e.records.length>0&&e.records.forEach((function(e){t.customerUserIds.push(e.id)}))},dataListSelectionHandleChange:function(e){var t=this;this.customerUserIds=[],e.records.length>0&&e.records.forEach((function(e){t.customerUserIds.push(e.id)}))},handleAddOrUpdate:function(e){var t=this;this.addOrUpdateVisible=!0,this.$nextTick((function(){t.$refs.addOrUpdate.dataForm.id=e,t.$refs.addOrUpdate.init()}))},deleteHandle:o()((function(e){var t=this,n={ids:""};if(e)n["ids"]=e;else{if(0===t.customerUserIds.length)return t.$message.error(t.$t("deleteInfo.noData"));n["ids"]=t.customerUserIds.join(",")}t.$hasPermission("userCus:delete:permission.do")?t.$confirm(t.$t("deleteInfo.noticeTitle"),t.$t("deleteInfo.noticePrompt"),{confirmButtonText:t.$t("deleteInfo.confirm"),cancelButtonText:t.$t("deleteInfo.cancel"),type:"warning"}).then((function(){t.dataListLoading=!0,t.$http.delete("/userCus/delete.do",{params:n}).then((function(e){var n=e.data;if(0!=n.code)return t.dataListLoading=!1,t.$message.error(n.data||n.msg);t.$message.success(t.$t("deleteInfo.deleteSuccess")),t.dataListLoading=!1,t.getDataList()})).catch((function(e){return t.dataListLoading=!1,t.getDataList(),!1}))})).catch((function(e){})):t.$message.warning("暂无客户删除权限, 请联系管理员")}),1e3,{leading:!0,trailing:!1}),formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))})),t.map((function(t){return e.map((function(e){return t[e]}))}))},resetExcelData:function(e){var t=[];this.dataList.forEach((function(e){var n={id:e.id||"",uname:e.uname||""};t.push(n)})),e(t)},handleExportCustomerProductData:o()((function(){var e=this;if(0==this.dataList.length)return this.$message.warning(this.$t("gwsn.thereIsCurrentlyNoDataAvailableForExport"));this.resetExcelData((function(t){for(var n=[{label:e.$t("attribute.number"),prop:"id"},{label:e.$t("product.customerName"),prop:"username"}],a=[],r=[],i=0;i<n.length;i++)a[i]=n[i].label,r[i]=n[i].prop;var o=a,s=r,c=t,d=e.formatJson(s,c);Object(l["a"])(o,d,e.$t("product.customerManagement")+"_"+(new Date).getTime())}))}),1e3,{leading:!0,trailing:!1})},mounted:function(){var e=this;e.scrollTableHeight=window.innerHeight-220-53,e.superAdmin=e.$store.state.user.superAdmin,e.getDataList(),window.onresize=function(){return function(){e.scrollTableHeight=window.innerHeight-220-53}()}},watch:{total:function(){this.total==(this.page-1)*this.limit&&0!=this.total&&(this.page-=1,this.getDataList())}}},d=c,u=n("2877"),f=Object(u["a"])(d,a,r,!1,null,null,null);t["default"]=f.exports}}]);
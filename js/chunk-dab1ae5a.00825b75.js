(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dab1ae5a"],{4898:function(e,t,a){"use strict";a("9689")},8439:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("section",[t("div",{ref:"tagQueryContainer",attrs:{id:"tagQueryContainer"}},[t("el-form",{attrs:{inline:!0,id:"tagForm",model:e.dataForm},nativeOn:{submit:function(e){e.preventDefault()},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.querySearch()}}},[t("el-form-item",{attrs:{label:e.$t("attribute.belongChannel")}},[t("el-select",{attrs:{size:"small",filterable:"",placeholder:e.$t("attribute.placeholderSelect")},on:{change:e.handleChannel},model:{value:e.dataForm.chlname,callback:function(t){e.$set(e.dataForm,"chlname",t)},expression:"dataForm.chlname"}},e._l(e.chlList,(function(a){return t("el-option",{key:a.value,attrs:{label:a.label,value:a.chlId}},[t("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center","max-width":"577px"}},[t("span",{style:{display:"inline-block",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis",minWidth:"160px"},attrs:{title:a.label}},[e._v(e._s(a.label))]),t("span",{staticStyle:{color:"#8492a6","font-size":"13px",display:"inline-block","margin-left":"20px","text-align":"right",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis","max-width":"200px"},attrs:{title:a.chlcomment}},[e._v("\n                                "+e._s(a.chlcomment)+"\n                            ")])])])})),1)],1),t("el-form-item",{attrs:{label:e.$t("attribute.devive")}},[t("el-select",{attrs:{size:"small",filterable:"",clearable:"",placeholder:e.$t("attribute.placeholderSelect")},on:{change:e.querySearch},model:{value:e.dataForm.devname,callback:function(t){e.$set(e.dataForm,"devname",t)},expression:"dataForm.devname"}},e._l(e.devList,(function(a,i){return t("el-option",{key:i,attrs:{label:a.label,value:a.devId}},[t("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center","max-width":"577px"}},[t("span",{style:{display:"inline-block",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis",minWidth:"160px"},attrs:{title:a.label}},[e._v(e._s(a.label))]),t("span",{staticStyle:{color:"#8492a6","font-size":"13px",display:"inline-block","margin-left":"20px","text-align":"right",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis","max-width":"200px"},attrs:{title:a.devcomment}},[e._v("\n                                "+e._s(a.devcomment)+"\n                            ")])])])})),1)],1),t("el-form-item",{attrs:{label:e.$t("attribute.alarmtype")}},[t("div",{staticStyle:{width:"150px"}},[t("el-select",{attrs:{size:"small",clearable:"",placeholder:e.$t("attribute.placeholderSelect")},on:{change:e.querySearch},model:{value:e.dataForm.alarmtype,callback:function(t){e.$set(e.dataForm,"alarmtype",t)},expression:"dataForm.alarmtype"}},e._l(e.alarmtypeList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),t("el-form-item",{attrs:{label:e.$t("attribute.collectType")}},[t("el-select",{attrs:{size:"small",filterable:"",multiple:"","collapse-tags":"",clearable:"",placeholder:e.$t("attribute.placeholderSelect")},on:{change:e.handleFuncode},model:{value:e.dataForm.collecttypec,callback:function(t){e.$set(e.dataForm,"collecttypec",t)},expression:"dataForm.collecttypec"}},e._l(e.funcodeList,(function(e){return t("el-option",{key:e.FuncCode,attrs:{label:e.description,value:e.FuncCode}})})),1)],1),t("el-form-item",[t("el-input",{attrs:{size:"small",placeholder:e.$t("formulacalculation.pleaseEnterTagnameOrDescription"),clearable:""},on:{clear:e.querySearch},model:{value:e.dataForm.tagname,callback:function(t){e.$set(e.dataForm,"tagname",t)},expression:"dataForm.tagname"}})],1),e.$hasPermission("taginfo:select:permission.do")?t("el-form-item",[t("el-button",{attrs:{size:"small",icon:"el-icon-search"},on:{click:function(t){return e.querySearch()}}},[e._v(e._s(e.$t("query")))])],1):e._e(),e.$hasPermission("taginfo:insert:permission.do")&&e.isShowSetting?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.handleAddOrUpdate()}}},[e._v(e._s(e.$t("add")))])],1):e._e(),e.$hasPermission("taginfo:update:permission.do")&&e.isShowSetting?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-edit",disabled:0===e.tagIds.length||0===e.dataList.length},on:{click:function(t){return e.editAll()}}},[e._v("\n                    "+e._s(e.$t("attribute.editMultiple"))+"\n                ")])],1):e._e(),e.$hasPermission("tag:delete:permission.do")&&e.isShowSetting?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete",disabled:0===e.tagIds.length||0===e.dataList.length},on:{click:function(t){return e.deleteHandle()}}},[e._v(e._s(e.$t("deleteBatch"))+" ")])],1):e._e(),e.$hasPermission("taginfo:import:permission.do")&&e.isShowSetting?t("el-form-item",[t("el-upload",{staticClass:"upload-demo",attrs:{size:"small",disabled:e.addDisabled,action:"","on-change":e.handleChange,"http-request":e.uploadSectionFile,"on-remove":e.handleRemove,"file-list":e.fileList,limit:1,"before-upload":e.beforeUploadHandle,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel","show-file-list":!1}},[t("el-tooltip",{attrs:{content:e.$t("onlyXlsxFilesUploaded"),placement:"top"}},[t("el-button",{attrs:{size:"small",disabled:e.addDisabled,type:"primary",icon:"el-icon-upload"}},[e._v(e._s(e.$t("import"))+" ")])],1)],1)],1):e._e(),e.$hasPermission("taginfo:exports:permission.do")&&e.isShowSetting?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-download",disabled:0===e.tagIds.length||0===e.dataList.length},on:{click:e.handleExportTagChange}},[e._v(e._s(e.$t("export"))+" ")])],1):e._e(),e.$hasPermission("channelinfo:updateTagDevId:permission.do")&&e.isShowSetting?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-bangzhu"},on:{click:e.handleTagsToDeviceChange}},[e._v(e._s(e.$t("attribute.moveTheMeasuringPointToTheDevice")))])],1):e._e(),e.$hasPermission("taginfo:select:permission.do")?t("el-form-item",[t("el-button",{attrs:{size:"small",type:"success"},on:{click:e.getDataList}},[t("i",{staticClass:"el-icon-refresh"})])],1):e._e()],1)],1),e.scrollTableHeight?t("div",[t("vxe-table",{ref:"recordTable",staticStyle:{width:"100%"},attrs:{size:"mini",border:"",resizable:"","auto-resize":"","sync-resize":"","show-overflow":"","show-header-overflow":"","highlight-hover-row":"","highlight-current-row":"","max-height":e.scrollTableHeight,loading:e.dataListLoading,"row-config":{keyField:"id"},"sort-config":e.sortConfig,"checkbox-config":e.checkboxConfig,"scroll-y":{enabled:!0}},on:{"checkbox-all":e.selectAll,"checkbox-change":e.dataListSelectionHandleChange,"sort-change":e.sortChange}},[t("vxe-table-column",{attrs:{type:"checkbox","header-align":"center",align:"center",width:"60",fixed:"left",checked:!1}}),t("vxe-table-column",{attrs:{field:"id",title:e.$t("measuringPointID"),"header-align":"center",align:"center",sortable:"",width:"90",fixed:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(t.row.tagid)+"\n                ")]}}],null,!1,4014290946)}),t("vxe-table-column",{attrs:{field:"tagname",title:e.$t("attribute.tagname"),"header-align":"center",align:"center",width:"210",fixed:"left","show-overflow-tooltip":!0}}),t("vxe-table-column",{attrs:{field:"tagcomment",title:e.$t("attribute.modelattribute"),"header-align":"center",align:"center",width:"180","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.tagcomment||e.$t("attribute.noContent")))])]}}],null,!1,385731756)}),t("vxe-table-column",{attrs:{field:"alarmtype",title:e.$t("attribute.alarmtype"),"header-align":"center",align:"center",width:"100",formatter:e.formatterAlarmtype}}),t("vxe-table-column",{attrs:{field:"tagk",title:e.$t("attribute.tagkk"),"header-align":"center",align:"center",width:"100"}}),t("vxe-table-column",{attrs:{field:"devname",title:e.$t("attribute.devive"),"header-align":"center",align:"center",width:"160","show-overflow-tooltip":!0}}),t("vxe-table-column",{attrs:{field:"collDescript",title:e.$t("attribute.collectCollecttypec"),"header-align":"center",align:"center",width:"140",formatter:e.formatterCollecttypec,"show-overflow-tooltip":!0}}),t("vxe-table-column",{attrs:{field:"objaddr",title:e.$t("attribute.registerAddress"),"header-align":"center",align:"center",width:"120",sortable:"","show-overflow-tooltip":!0}}),t("vxe-table-column",{attrs:{field:"isupload",title:e.$t("attribute.upload"),"header-align":"center",align:"center",width:"60",formatter:e.formatterIsupload}}),t("vxe-table-column",{attrs:{field:"pvDesc",title:e.$t("attribute.uploadFlag"),"header-align":"center",align:"center",width:"120","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.pvDesc||a.row.pvflag))])]}}],null,!1,527256475)}),t("vxe-table-column",{attrs:{field:"enable",title:e.$t("configuration.limitEnable"),"header-align":"center",align:"center",width:"120","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(null!=a.row.tagAssistEntity&&void 0!=a.row.tagAssistEntity?0==a.row.tagAssistEntity.enable?e.$t("configuration.shut"):1==a.row.tagAssistEntity.enable?e.$t("configuration.enableLowerLimit"):2==a.row.tagAssistEntity.enable?e.$t("configuration.enableUpperLimit"):3==a.row.tagAssistEntity.enable?e.$t("configuration.enableUpperAndLowerLimits"):"--":"--"))])]}}],null,!1,1901131861)}),t("vxe-table-column",{attrs:{field:"lowerLimit",title:e.$t("configuration.minimumValue"),"header-align":"center",align:"center",width:"120","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(null!=a.row.tagAssistEntity&&void 0!=a.row.tagAssistEntity?a.row.tagAssistEntity.lowerLimit:"--"))])]}}],null,!1,3227489308)}),t("vxe-table-column",{attrs:{field:"upperLimit",title:e.$t("configuration.maximumValue"),"header-align":"center",align:"center",width:"120","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(null!=a.row.tagAssistEntity&&void 0!=a.row.tagAssistEntity?a.row.tagAssistEntity.upperLimit:"--"))])]}}],null,!1,3087751517)}),t("vxe-table-column",{attrs:{field:"taggroup",title:e.$t("attribute.group"),"header-align":"center",align:"center",width:"60"}}),t("vxe-table-column",{attrs:{field:"datatype",title:e.$t("attribute.datatype"),"header-align":"center",align:"center",width:"130",formatter:e.formatterDatatype}}),t("vxe-table-column",{attrs:{field:"dataformat",title:e.$t("attribute.dataformat"),"header-align":"center",align:"center",width:"80",formatter:e.formatterDataformat}}),t("vxe-table-column",{attrs:{field:"enablebit",title:e.$t("attribute.isbit"),"header-align":"center",align:"center",width:"80",formatter:e.formatterbit}}),t("vxe-table-column",{attrs:{field:"enablealarm",title:e.$t("attribute.enablealarm"),"header-align":"center",align:"center",width:"80",formatter:e.formatterAlarm}}),t("vxe-table-column",{attrs:{field:"enablehissave",title:e.$t("attribute.enablehissave"),"header-align":"center",align:"center",width:"110",formatter:e.formatterHistory}}),t("vxe-table-column",{attrs:{field:"tagrwprop",title:e.$t("attribute.tagrwprop"),"header-align":"center",align:"center",width:"80",formatter:e.formatterRwtype}}),t("vxe-table-column",{attrs:{field:"tagb",title:e.$t("attribute.tagbb"),"header-align":"center",align:"center",width:"80"}}),(e.$hasPermission("taginfo:update:permission.do")||e.$hasPermission("tag:delete:permission.do"))&&e.isShowSetting?t("vxe-table-column",{attrs:{title:e.$t("handle"),"header-align":"center",align:"center",width:"120",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[e.$hasPermission("taginfo:update:permission.do")?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleAddOrUpdate(a.row.id)}}},[e._v(e._s(e.$t("update"))+" ")]):e._e(),e.$hasPermission("tag:delete:permission.do")?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.deleteHandle(a.row)}}},[e._v(e._s(e.$t("delete")))]):e._e()]}}],null,!1,4121025702)}):e._e()],1),t("vxe-pager",{attrs:{perfect:"",size:"mini",loading:e.pagerLoading,"current-page":e.page,"page-size":e.limit,"page-sizes":[100,200,500,1e3,2e3,5e3,1e4],total:e.total,layouts:["PrevPage","JumpNumber","NextPage","FullJump","Sizes","Total"]},on:{"page-change":e.handlePageChange}})],1):e._e(),e.addOrUpdateVisible?t("add-or-update",{ref:"addOrUpdate",attrs:{queryParams:e.queryParams},on:{refreshDataList:e.getDataList}}):e._e(),t("el-dialog",{attrs:{title:e.$t("attribute.editMultiple"),"close-on-click-modal":!1,"close-on-press-escape":!1,visible:e.editAllVisible},on:{"update:visible":function(t){e.editAllVisible=t}}},[t("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.rules,"label-width":(e.$i18n.locale,"120px")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dataFormSubmitHandle()}}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.editType"),prop:"type"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("attribute.placeholderSelect")},on:{change:e.selectChanged},model:{value:e.editForm.type,callback:function(t){e.$set(e.editForm,"type",t)},expression:"editForm.type"}},e._l(e.editTypeLists,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),"tagb"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.editValue"),prop:"tagb"}},[t("el-input",{attrs:{placeholder:e.$t("attribute.tagb"),clearable:""},model:{value:e.editForm.tagb,callback:function(t){e.$set(e.editForm,"tagb",t)},expression:"editForm.tagb"}})],1)],1):e._e(),"endbit"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.editValue"),prop:"endbit"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("attribute.placeholderSelect")},model:{value:e.editForm.endbit,callback:function(t){e.$set(e.editForm,"endbit",t)},expression:"editForm.endbit"}},e._l(e.startbitList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1):e._e(),"limitValueEnable"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("configuration.limitEnable"),prop:"limitValueEnable"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("select")},model:{value:e.editForm.limitValueEnable,callback:function(t){e.$set(e.editForm,"limitValueEnable",t)},expression:"editForm.limitValueEnable"}},e._l(e.limitValueEnableList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1)],1):e._e(),"limitValueEnable"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"minValue",label:e.$t("configuration.minimumLimitValue")}},[t("el-input",{attrs:{disabled:0==e.editForm.limitValueEnable||2==e.editForm.limitValueEnable,oninput:"this.value=this.value.replace(/[^\\-\\d.]/g,'').replace(/^\\./g,'').replace('.','$#$').replace(/\\./g,'').replace('$#$','.').replace('-','$#$').replace(/\\-/g,'').replace('$#$','-').replace(/^(-?\\d+(\\.\\d{0,6})?).*$/,'$1')",placeholder:e.$t("configuration.pleaseEnterTheMinimumLimitValue")},model:{value:e.editForm.minValue,callback:function(t){e.$set(e.editForm,"minValue",t)},expression:"editForm.minValue"}})],1)],1):e._e(),"limitValueEnable"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"maxValue",label:e.$t("configuration.maximumLimitValue")}},[t("el-input",{attrs:{disabled:0==e.editForm.limitValueEnable||1==e.editForm.limitValueEnable,oninput:"this.value=this.value.replace(/[^\\-\\d.]/g,'').replace(/^\\./g,'').replace('.','$#$').replace(/\\./g,'').replace('$#$','.').replace('-','$#$').replace(/\\-/g,'').replace('$#$','-').replace(/^(-?\\d+(\\.\\d{0,6})?).*$/,'$1')",placeholder:e.$t("configuration.pleaseEnterTheMaximumLimitValue")},model:{value:e.editForm.maxValue,callback:function(t){e.$set(e.editForm,"maxValue",t)},expression:"editForm.maxValue"}})],1)],1):e._e(),"limitValueEnable"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"limitdataFormat",label:e.$t("configuration.formulaCalculation")}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("select")},model:{value:e.editForm.limitdataFormat,callback:function(t){e.$set(e.editForm,"limitdataFormat",t)},expression:"editForm.limitdataFormat"}},e._l(e.limitdataFormatLists,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1)],1):e._e(),"tagk"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("configuration.intelligentConversion")}},[t("el-switch",{model:{value:e.editForm.smartTransform,callback:function(t){e.$set(e.editForm,"smartTransform",t)},expression:"editForm.smartTransform"}}),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("configuration.enableIntelligentConversion"),placement:"top-start"}},[t("i",{staticClass:"el-icon-question",staticStyle:{"margin-left":"5px"}})])],1)],1):e._e(),"tagk"==e.editForm.type&&e.editForm.smartTransform?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("configuration.dataSourceConversionList")}},[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:e.handleAddSmartTransDataChange}},[e._v(e._s(e.$t("attribute.addTo")))]),t("el-button",{attrs:{size:"small",icon:"el-icon-refresh-left"},on:{click:e.handleResetSmartTransDataChange}},[e._v(e._s(e.$t("attribute.restoreDefaultSettings")))])],1)],1):e._e(),"tagk"==e.editForm.type&&e.editForm.smartTransform?t("el-col",{attrs:{span:24}},[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",size:"small",data:e.editForm.smartTransformTableData,"max-height":300}},[t("el-table-column",{attrs:{type:"index",fixed:"left",width:"60",label:e.$t("attribute.number"),align:"center"}}),t("el-table-column",{attrs:{prop:"sourceK",label:e.$t("attribute.sourceCoefficient"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{size:"small",clearable:"",placeholder:e.$t("attribute.pleaseEnterTheSourceCoefficient")},model:{value:a.row.sourceK,callback:function(t){e.$set(a.row,"sourceK",t)},expression:"scope.row.sourceK"}})]}}],null,!1,2012649611)}),t("el-table-column",{attrs:{prop:"targetK",label:e.$t("attribute.targetCoefficient"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{size:"small",clearable:"",placeholder:e.$t("attribute.pleaseEnterTheTargetCoefficient")},model:{value:a.row.targetK,callback:function(t){e.$set(a.row,"targetK",t)},expression:"scope.row.targetK"}})]}}],null,!1,1408891147)}),t("el-table-column",{attrs:{fixed:"right",label:e.$t("handle"),width:"60",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleDeleteSmartTransDataChange(a.$index)}}},[e._v(e._s(e.$t("delete")))])]}}],null,!1,3290636014)})],1)],1):e._e(),"tagk"!=e.editForm.type||e.editForm.smartTransform?e._e():t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.editValue"),prop:"value"}},[t("el-input",{attrs:{placeholder:e.$t("attribute.editValue")},model:{value:e.editForm.value,callback:function(t){e.$set(e.editForm,"value",t)},expression:"editForm.value"}})],1)],1),"reserve2"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.editValue"),prop:"reserve2"}},[t("el-input",{attrs:{placeholder:e.$t("attribute.editValue")},model:{value:e.editForm.reserve2,callback:function(t){e.$set(e.editForm,"reserve2",t)},expression:"editForm.reserve2"}})],1)],1):e._e(),"tagname"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.editWay"),prop:"way"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("attribute.placeholderSelect"),filterable:""},model:{value:e.editForm.way,callback:function(t){e.$set(e.editForm,"way",t)},expression:"editForm.way"}},e._l(e.wayLists,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1):e._e(),"tagcomment"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.editWay"),prop:"tagcommentWay"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("attribute.placeholderSelect"),filterable:""},on:{change:e.handleTagCommentWayChange},model:{value:e.editForm.tagcommentWay,callback:function(t){e.$set(e.editForm,"tagcommentWay",t)},expression:"editForm.tagcommentWay"}},e._l(e.tagcommentWayLists,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1):e._e(),"transvalue"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.editValue"),prop:"transValue",rules:"transvalue"===this.editForm.type?e.rules.transValue:[{required:!1,message:e.$t("attribute.requireNotNull"),trigger:"change"}]}},[t("el-input",{attrs:{placeholder:e.$t("attribute.pleaceEnterContent")},model:{value:e.editForm.transValue,callback:function(t){e.$set(e.editForm,"transValue",t)},expression:"editForm.transValue"}})],1)],1):e._e(),"taggroup"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.editValue"),prop:"changeValue",rules:"taggroup"===this.editForm.type?e.rules.changeValue:[{required:!1,message:e.$t("attribute.requireNotNull"),trigger:"change"}]}},[t("el-autocomplete",{staticStyle:{width:"100%"},attrs:{"fetch-suggestions":e.querySearchAsync,placeholder:e.$t("attribute.pleaceEnterContent")},on:{select:e.handleSelectTaggroup},model:{value:e.editForm.changeValue,callback:function(t){e.$set(e.editForm,"changeValue",t)},expression:"editForm.changeValue"}})],1)],1):e._e(),"dataformat"==e.editForm.type||"datatype"==e.editForm.type||"tagrwprop"==e.editForm.type||"alarmtype"==e.editForm.type||"collecttypec"===e.editForm.type||"enablealarm"===e.editForm.type||"enablehissave"===e.editForm.type||"isupload"===e.editForm.type||"enablebit"===this.editForm.type||"enabletransvalue"===e.editForm.type||"startbit"===e.editForm.type||"reserve3"===e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"startbit"===e.editForm.type?e.$t("attribute.editValue")+"("+e.$t("attribute.increasing")+")":e.$t("attribute.editValue"),prop:"changeValue",rules:"dataformat"===this.editForm.type||"datatype"===this.editForm.type||"alarmtype"===this.editForm.type||"tagrwprop"===this.editForm.type||"collecttypec"===this.editForm.type||"enablealarm"===this.editForm.type||"enablehissave"===this.editForm.type||"isupload"===this.editForm.type||"enablebit"===this.editForm.type||"enabletransvalue"===this.editForm.type||"startbit"===this.editForm.type||"reserve3"===this.editForm.type?e.rules.changeValue:[{required:!1,message:e.$t("attribute.requireNotNull"),trigger:"change"}]}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("attribute.placeholderSelect"),filterable:""},model:{value:e.editForm.changeValue,callback:function(t){e.$set(e.editForm,"changeValue",t)},expression:"editForm.changeValue"}},e._l(e.changeList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1):e._e(),"pvflag"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.editValue"),prop:"changeValue"}},[t("el-autocomplete",{ref:"pvFlagRef",staticStyle:{width:"100%"},attrs:{debounce:0,"value-key":"label",clearable:"","fetch-suggestions":e.querySearchPvFlagAsync,placeholder:e.$t("attribute.pleaceEnterContent")},on:{input:function(t){e.firstInputPvFlag=!1},select:e.handlePvflag,clear:function(t){return e.setPvflagBlur()}},scopedSlots:e._u([{key:"default",fn:function(a){var i=a.item;return[t("div",{style:{color:i.label==e.editForm.pvflag?"#E6A23C":"#000",fontWeight:i.label==e.editForm.pvflag?"bolder":"normal"}},[e._v(e._s(i.label))])]}}],null,!1,2306975190),model:{value:e.editForm.pvflag,callback:function(t){e.$set(e.editForm,"pvflag","string"===typeof t?t.trim():t)},expression:"editForm.pvflag"}})],1)],1):e._e(),"objaddr"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.editWay"),prop:"objaddrWay",rules:"objaddr"===this.editForm.type?e.rules.objaddrWay:[{required:!1,message:e.$t("attribute.requireNotNull"),trigger:"change"}]}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("attribute.placeholderSelect"),filterable:""},model:{value:e.editForm.objaddrWay,callback:function(t){e.$set(e.editForm,"objaddrWay",t)},expression:"editForm.objaddrWay"}},e._l(e.objaddrTypeList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1)],1):e._e(),"taginitvalue"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.editValue"),prop:"taginitvalue",rules:"taginitvalue"===this.editForm.type?e.rules.taginitvalue:[{required:!1,message:e.$t("attribute.requireNotNull"),trigger:"change"}]}},[t("el-input",{attrs:{placeholder:e.$t("configuration.pleaseEnterTheInitialValue"),clearable:""},model:{value:e.editForm.taginitvalue,callback:function(t){e.$set(e.editForm,"taginitvalue",t)},expression:"editForm.taginitvalue"}})],1)],1):e._e(),"assistpararm"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.editValue"),prop:"assistpararm",rules:"assistpararm"===this.editForm.type?e.rules.assistpararm:[{required:!1,message:e.$t("attribute.requireNotNull"),trigger:"change"}]}},[t("el-input",{attrs:{placeholder:e.$t("configuration.pleaseEnterAuxiliaryParameters"),clearable:""},model:{value:e.editForm.assistpararm,callback:function(t){e.$set(e.editForm,"assistpararm",t)},expression:"editForm.assistpararm"}})],1)],1):e._e()],1),t("el-row",["objaddr"==e.editForm.type&&"step"==e.editForm.objaddrWay?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.startValue"),prop:"startValue",rules:"objaddr"===this.editForm.type&&"step"==e.editForm.objaddrWay?e.rules.startValue:[{required:!1,message:e.$t("attribute.requireNotNull"),trigger:"change"}]}},[t("el-input",{attrs:{placeholder:e.$t("attribute.startValue")},model:{value:e.editForm.startValue,callback:function(t){e.$set(e.editForm,"startValue",t)},expression:"editForm.startValue"}})],1)],1):e._e(),"objaddr"==e.editForm.type&&"step"==e.editForm.objaddrWay?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.step"),prop:"step",rules:"objaddr"===this.editForm.type&&"step"==e.editForm.objaddrWay?e.rules.step:[{required:!1,message:e.$t("attribute.requireNotNull"),trigger:"change"}]}},[t("el-input",{attrs:{placeholder:e.$t("attribute.step")},model:{value:e.editForm.step,callback:function(t){e.$set(e.editForm,"step",t)},expression:"editForm.step"}})],1)],1):e._e(),"objaddr"==e.editForm.type&&"fixed"==e.editForm.objaddrWay?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.fixedValue"),prop:"fixedValue",rules:"objaddr"===this.editForm.type&&"fixed"==e.editForm.objaddrWay?e.rules.fixedValue:[{required:!1,message:e.$t("attribute.requireNotNull"),trigger:"change"}]}},[t("el-input",{attrs:{placeholder:e.$t("attribute.fixedValuePlaceholder")},model:{value:e.editForm.fixedValue,callback:function(t){e.$set(e.editForm,"fixedValue",t)},expression:"editForm.fixedValue"}})],1)],1):e._e(),"tagname"==e.editForm.type&&"replace"==e.editForm.way?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.replaceSource"),prop:"replaceStr",rules:"tagname"===this.editForm.type&&"replace"==e.editForm.way?e.rules.replaceStr:[{required:!1,message:e.$t("attribute.requireNotNull"),trigger:"change"}]}},[t("el-input",{attrs:{placeholder:e.$t("attribute.enterReplaceSource")},model:{value:e.editForm.replaceStr,callback:function(t){e.$set(e.editForm,"replaceStr",t)},expression:"editForm.replaceStr"}})],1)],1):e._e(),"tagname"==e.editForm.type?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.editValue")}},[t("el-input",{attrs:{placeholder:"replace"==e.editForm.way?e.$t("attribute.replaceName"):"prepend"==e.editForm.way?e.$t("attribute.replacePrependName"):"append"==e.editForm.way?e.$t("attribute.replaceAppendName"):"请输入您要递增的起始测点名称"},model:{value:e.editForm.tagnameStr,callback:function(t){e.$set(e.editForm,"tagnameStr",t)},expression:"editForm.tagnameStr"}})],1)],1):e._e(),"tagcomment"==e.editForm.type&&"replace"==e.editForm.tagcommentWay?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.replaceSource"),prop:"replaceTagCommentStr",rules:"tagcomment"===this.editForm.type&&"replace"==e.editForm.tagcommentWay?e.rules.replaceTagCommentStr:[{required:!1,message:e.$t("attribute.requireNotNull"),trigger:"change"}]}},[t("el-input",{attrs:{placeholder:e.$t("attribute.enterReplaceSource")},model:{value:e.editForm.replaceTagCommentStr,callback:function(t){e.$set(e.editForm,"replaceTagCommentStr",t)},expression:"editForm.replaceTagCommentStr"}})],1)],1):e._e(),"tagcomment"==e.editForm.type&&"clipboardSource"!=e.editForm.tagcommentWay?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.editValue"),prop:"tagcomment"}},[t("el-input",{attrs:{placeholder:e.$t("attribute.editValue")},model:{value:e.editForm.tagcomment,callback:function(t){e.$set(e.editForm,"tagcomment",t)},expression:"editForm.tagcomment"}})],1)],1):e._e(),"tagcomment"==e.editForm.type&&"increasing"==e.editForm.tagcommentWay?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.step"),prop:"tagcommentStep"}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{"step-strictly":"","controls-position":"right",placeholder:e.$t("attribute.pleaseEnterTheStepSize")},model:{value:e.editForm.tagcommentStep,callback:function(t){e.$set(e.editForm,"tagcommentStep",t)},expression:"editForm.tagcommentStep"}})],1)],1):e._e()],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:function(t){e.editAllVisible=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmitHandle()}}},[e._v(e._s(e.$t("confirm")))])],1)],2),t("el-dialog",{attrs:{title:e.$t("attribute.devive"),"close-on-click-modal":!1,"close-on-press-escape":!1,visible:e.tagVisible,"before-close":e.handleCancel},on:{"update:visible":function(t){e.tagVisible=t}}},[t("el-form",{ref:"importForm",attrs:{model:e.importForm,rules:e.rules,"label-width":(e.$i18n.locale,"120px")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.tagListConfirm()}}},[t("el-row",[t("el-col",{attrs:{sm:24,xs:24,md:12,xl:12,lg:12}},[t("el-tree",{ref:"tree",attrs:{data:e.dataTree,"show-checkbox":"","node-key":"id","default-expand-all":""},on:{check:e.handleCheckChange}})],1),t("el-col",{attrs:{sm:24,xs:24,md:12,xl:12,lg:12}},[t("el-form-item",{attrs:{label:e.$t("configuration.intelligentMatchingDevice")}},[t("el-radio-group",{model:{value:e.importForm.devType,callback:function(t){e.$set(e.importForm,"devType",t)},expression:"importForm.devType"}},[t("el-radio",{attrs:{label:!0}},[e._v(e._s(e.$t("yes")))]),t("el-radio",{attrs:{label:!1}},[e._v(e._s(e.$t("no")))])],1),t("span",{staticStyle:{"font-weight":"bolder","margin-left":"10px"}},[e._v(e._s(e.$t("configuration.noteOnlyNewTemplatesAreSupported")))])],1)],1)],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:e.handleCancel}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.tagListConfirm()}}},[e._v(e._s(e.$t("confirm")))])],1)],2),t("dialog-bar",{directives:[{name:"show",rawName:"v-show",value:e.confirmVisible,expression:"confirmVisible"}],attrs:{title:e.$t("attribute.tagImport"),content:e.content,cancelText:e.$t("cancel"),confirmAndRebootText:e.$t("attribute.no"),confirmText:e.$t("attribute.yes")},on:{cancel:function(t){return e.clickCancel()},confirmAndReboot:function(t){return e.clickConfirmnodAdd()},confirm:function(t){return e.clickConfirm()}}}),t("el-dialog",{attrs:{visible:e.mergeTagsToDeviceVisible,title:e.$t("attribute.moveTheMeasuringPointToTheDevice"),"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":e.handleMergeTagsToDeviceClose},on:{"update:visible":function(t){e.mergeTagsToDeviceVisible=t}}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.mergeTagsToDeviceFormloading,expression:"mergeTagsToDeviceFormloading"}],ref:"mergeTagsToDeviceForm",attrs:{model:e.mergeTagsToDeviceForm,rules:e.mergeTagsToDeviceRules,"label-width":(e.$i18n.locale,"120px")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleMergeTagsToDeviceSubmit()}}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("configuration.targetDevice"),prop:"devId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("select")},on:{change:e.handleMergeDevIdChanage},model:{value:e.mergeTagsToDeviceForm.devId,callback:function(t){e.$set(e.mergeTagsToDeviceForm,"devId",t)},expression:"mergeTagsToDeviceForm.devId"}},e._l(e.mergeTargetDeviceList,(function(a){return t("el-option",{key:a.devID,attrs:{label:a.devName,value:a.devID}},[t("span",{staticStyle:{width:"50%",display:"inline-block","text-align":"left",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:a.devName}},[e._v(e._s(a.devName))]),t("span",{staticStyle:{color:"#8492a6","font-size":"13px",display:"inline-block","margin-left":"2%",width:"48%","text-align":"right",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:a.devComment}},[e._v(e._s(a.devComment))])])})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("attribute.measurementPointToBeMoved"),prop:"tagIds"}},[t("el-select",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.handleTagScroll,expression:"handleTagScroll"}],staticStyle:{width:"100%"},attrs:{multiple:"","collapse-tags":"",placeholder:"请选择"},on:{"visible-change":e.handleTagNameOrVisibleChange,change:e.handleMergeTagNameOrDescChange},model:{value:e.mergeTagsToDeviceForm.tagIds,callback:function(t){e.$set(e.mergeTagsToDeviceForm,"tagIds",t)},expression:"mergeTagsToDeviceForm.tagIds"}},[[t("div",{staticStyle:{width:"100%",position:"absolute",left:"0",top:"0","z-index":"99","background-color":"#fff"}},[t("el-input",{ref:"tagNameOrDescInput",staticStyle:{width:"98%","margin-left":"1%","margin-top":"5px","margin-bottom":"5px"},attrs:{size:"small",clearable:"",placeholder:e.$t("gwsn.pleaseEnterSearchContent")},model:{value:e.tagNameOrDescSearch,callback:function(t){e.tagNameOrDescSearch=t},expression:"tagNameOrDescSearch"}})],1),t("div",{staticStyle:{width:"100%",height:"35px"}}),e._l(e.mergeTagsList,(function(a){return t("el-option",{key:a.tagid,attrs:{label:a.tagname,value:a.tagid,disabled:!!a.disabled&&a.disabled}},[a.tagcomment?t("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[t("span",{staticStyle:{width:"200px",display:"inline-block","text-align":"left",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:a.tagname}},[e._v(e._s(a.tagname))]),t("span",{staticStyle:{color:"#8492a6","font-size":"13px",display:"inline-block","margin-left":"10px",width:"calc(100%- 210px)","text-align":"right",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:a.tagComment}},[e._v(e._s(a.tagcomment))])]):t("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[t("span",{staticStyle:{width:"200px",display:"inline-block","text-align":"left",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:a.tagname}},[e._v(e._s(a.tagname))]),t("span",{staticStyle:{color:"#8492a6","font-size":"13px",display:"inline-block","margin-left":"10px","text-align":"right",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis",width:"80px"}},[e._v(e._s(e.$t("none")))])])])}))]],2)],1)],1)],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:e.handleMergeTagsToDeviceClose}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleMergeTagsToDeviceSubmit()}}},[e._v(e._s(e.$t("confirm")))])],1)],2)],1)},r=[],s=(a("8e6e"),a("456d"),a("ac4d"),a("8a81"),a("5df3"),a("1c4c"),a("20d6"),a("ade3")),n=(a("7514"),a("6b54"),a("3b2b"),a("f576"),a("f559"),a("4917"),a("7f7f"),a("96cf"),a("1da1")),l=(a("28a5"),a("6762"),a("2fdb"),a("c5f6"),a("55dd"),a("ac6a"),a("a481"),a("4328")),o=a.n(l),d=a("bc3a"),c=a.n(d),g=a("a78e"),m=a.n(g),u=a("b047"),h=a.n(u),p=a("e1a5"),f=a("795d"),b=a("c09d"),v=a("ed08");function $(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?$(Object(a),!0).forEach((function(t){Object(s["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):$(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function L(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=w(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,n=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return n=e.done,e},e:function(e){l=!0,s=e},f:function(){try{n||null==a.return||a.return()}finally{if(l)throw s}}}}function w(e,t){if(e){if("string"==typeof e)return I(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?I(e,t):void 0}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,i=Array(t);a<t;a++)i[a]=e[a];return i}var F={name:"taginfo",mixins:[p["a"]],directives:{loadmore:{inserted:function(e,t){var a=e.querySelector(".el-select-dropdown .el-select-dropdown__wrap");a.addEventListener("scroll",(function(){var e=this.scrollHeight-Math.ceil(this.scrollTop)<=this.clientHeight;e&&0!==this.scrollTop&&t.value()}))}}},data:function(){var e=this;return{isShowSetting:!1,page:1,limit:1e3,total:0,content:"",sname:"id",sort:"asc",scrollleft:0,scorlltop:0,allCheck:!1,currentPageCheccked:!1,pagerLoading:!1,sortConfig:{defaultSort:{field:"id",order:"asc"},remote:!0},checkboxConfig:{checkStrictly:!1,reserve:!0,highlight:!0,checkField:"checked"},multipleSelectionAll:[],fileList:[],dataList:[],isAddOrUpdate:!0,tagVisible:!1,confirmVisible:!1,addDisabled:!1,changeList:[],chlList:[],storeDevMap:{},devList:[],tagIds:[],selectTagDevIds:[],tagassistIdList:[],tagIdNameList:[],tagIdKList:[],tagIdCommentList:[],funcodeList:[],selectedTagIdAndObjAddrList:[],selectFuncCode:[],guidList:[],file:null,fileParams:null,dataTree:[],queryParams:{},importForm:{deviceId:null,typeid:null,devType:!1},editAllVisible:!1,alarmtypeList:[{label:this.$t("attribute.all"),value:""},{label:this.$t("attribute.visualValue"),value:0},{label:this.$t("attribute.switchValue"),value:1},{label:this.$t("attribute.ym"),value:2},{label:this.$t("attribute.yk"),value:3},{label:this.$t("attribute.yt"),value:4}],tagrwpropList:[{label:this.$t("attribute.all"),value:""},{label:this.$t("attribute.onlyRead"),value:0},{label:this.$t("attribute.readWrite"),value:1},{label:this.$t("attribute.onlyWrite"),value:2}],mixinViewModuleOptions:{activatedIsNeed:!1},dataForm:{chlname:"",devname:"",tagname:"",alarmtype:"",collecttypec:[]},historySave:[{label:this.$t("attribute.all"),value:""},{label:this.$t("attribute.yes"),value:1},{label:this.$t("attribute.no"),value:0}],limitValueEnableList:[{label:this.$t("configuration.shut"),value:0},{label:this.$t("configuration.enableLowerLimit"),value:1},{label:this.$t("configuration.enableUpperLimit"),value:2},{label:this.$t("configuration.enableUpperAndLowerLimits"),value:3}],limitdataFormatLists:[{label:this.$t("configuration.originalValueCoefficientOffset"),value:0},{label:this.$t("configuration.originalValueOffsetCoefficient"),value:1}],editForm:{type:"objaddr",value:"1.0",startValue:0,step:1,objaddrWay:"step",fixedValue:"",way:"replace",replaceStr:"",tagnameStr:"",tagcommentWay:"replace",replaceTagCommentStr:"",tagcomment:"",tagcommentStep:1,changeValue:"",pvflag:"",transValue:"",limitValueEnable:0,minValue:0,maxValue:1e3,limitdataFormat:0,reserve2:"1.000",smartTransform:!1,smartTransformTableData:[{sourceK:.1,targetK:10},{sourceK:.01,targetK:100},{sourceK:.001,targetK:1e3}],taginitvalue:"",assistpararm:"",tagb:"",endbit:""},wayLists:[{label:this.$t("attribute.replace"),value:"replace"},{label:this.$t("attribute.prepend"),value:"prepend"},{label:this.$t("attribute.append"),value:"append"},{label:"递增",value:"increment"}],tagcommentWayLists:[{label:this.$t("attribute.replace"),value:"replace"},{label:this.$t("attribute.prepend"),value:"prepend"},{label:this.$t("attribute.append"),value:"append"},{label:this.$t("attribute.increasing"),value:"increasing"},{label:this.$t("attribute.clipboardSource"),value:"clipboardSource"}],objaddrTypeList:[{label:this.$t("attribute.step"),value:"step"},{label:this.$t("attribute.tagb"),value:"fixed"}],editTypeLists:[{label:this.$t("attribute.tagname"),value:"tagname"},{label:this.$t("attribute.modelattribute"),value:"tagcomment"},{label:this.$t("attribute.address"),value:"objaddr"},{label:this.$t("attribute.tagk"),value:"tagk"},{label:this.$t("attribute.datatype"),value:"datatype"},{label:this.$t("attribute.dataformat"),value:"dataformat"},{label:this.$t("attribute.alarmtype"),value:"alarmtype"},{label:this.$t("attribute.tagrwprop"),value:"tagrwprop"},{label:this.$t("attribute.collecttypec"),value:"collecttypec"},{label:this.$t("configuration.pvUploadIdentifier"),value:"pvflag"},{label:this.$t("attribute.enablealarm"),value:"enablealarm"},{label:this.$t("attribute.enablehissave"),value:"enablehissave"},{label:this.$t("attribute.collectTaggroup"),value:"taggroup"},{label:this.$t("attribute.isUpload"),value:"isupload"},{label:this.$t("attribute.isIsbit"),value:"enablebit"},{label:this.$t("attribute.isbit"),value:"startbit"},{label:this.$t("attribute.endbit"),value:"endbit"},{label:this.$t("configuration.isItANumericalConversion"),value:"enabletransvalue"},{label:this.$t("attribute.transvalue"),value:"transvalue"},{label:this.$t("configuration.limitEnable"),value:"limitValueEnable"},{label:this.$t("attribute.taginitvalue"),value:"taginitvalue"},{label:this.$t("attribute.assistpararm"),value:"assistpararm"},{label:this.$t("configuration.reverseOrNot"),value:"reserve3"},{label:this.$t("configuration.offset"),value:"tagb"}],pvflagList:[],alarmRecordList:[{label:this.$t("attribute.visualValue"),value:0},{label:this.$t("attribute.switchValue"),value:1},{label:this.$t("attribute.ym"),value:2},{label:this.$t("attribute.yk"),value:3},{label:this.$t("attribute.yt"),value:4}],writeReadType:[{label:this.$t("attribute.onlyRead"),value:0},{label:this.$t("attribute.readWrite"),value:1},{label:this.$t("attribute.onlyWrite"),value:2}],dataType:[{label:this.$t("attribute.bit"),value:0},{label:this.$t("attribute.eightNoSymbol"),value:1},{label:this.$t("attribute.eightSymbol"),value:2},{label:this.$t("attribute.sixteenNoSymbol"),value:3},{label:this.$t("attribute.sixteenSymbol"),value:4},{label:this.$t("attribute.twentyFourNoSymbol"),value:14},{label:this.$t("attribute.twentyFourSymbol"),value:15},{label:this.$t("attribute.thirtySecondNoSymbol"),value:5},{label:this.$t("attribute.thirtySecondSymbol"),value:6},{label:this.$t("attribute.sixteenBCD"),value:7},{label:this.$t("attribute.thirtySecondBCD"),value:8},{label:this.$t("attribute.singleFloat"),value:9},{label:this.$t("attribute.doubleFloat"),value:10},{label:this.$t("attribute.string"),value:11},{label:this.$t("attribute.sixtyFourUnsigned"),value:12},{label:this.$t("attribute.sixtyFourSigned"),value:13}],hiloType:[{label:"12",value:0},{label:"21",value:1},{label:"1234",value:2},{label:"2143",value:3},{label:"3412",value:4},{label:"4321",value:5}],collecttypecList:[],enablealarmList:[{label:this.$t("attribute.open"),value:1},{label:this.$t("attribute.close"),value:0}],enablehissaveList:[{label:this.$t("attribute.open"),value:1},{label:this.$t("attribute.close"),value:0}],taggroupList:[{label:0,value:"0"},{label:1,value:"1"},{label:2,value:"2"},{label:3,value:"3"},{label:4,value:"4"},{label:5,value:"5"},{label:6,value:"6"},{label:7,value:"7"},{label:8,value:"8"},{label:9,value:"9"}],isuploadList:[{label:this.$t("attribute.yes"),value:1},{label:this.$t("attribute.no"),value:0}],isTransvalueList:[{label:this.$t("attribute.yes"),value:1},{label:this.$t("attribute.no"),value:0}],enablebitList:[{label:this.$t("attribute.yes"),value:1},{label:this.$t("attribute.no"),value:0}],startbitList:[{label:0,value:0},{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6},{label:7,value:7},{label:8,value:8},{label:9,value:9},{label:10,value:10},{label:11,value:11},{label:12,value:12},{label:13,value:13},{label:14,value:14},{label:15,value:15},{label:16,value:16},{label:17,value:17},{label:18,value:18},{label:19,value:19},{label:20,value:20},{label:21,value:21},{label:22,value:22},{label:23,value:23},{label:24,value:24},{label:25,value:25},{label:26,value:26},{label:27,value:27},{label:28,value:28},{label:29,value:29},{label:30,value:30},{label:31,value:31}],rules:{type:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],value:[{required:!0,message:this.$t("validate.required"),trigger:"change"},{validator:function(t,a,i){if(a){var r=/^[-]?[0-9]+(\.[0-9]+)?$/;r.test(a)?i():i(new Error(e.$t("debuggerInfo.enterNumber")))}},trigger:"change"}],reserve2:[{required:!1,message:this.$t("validate.required"),trigger:"change"},{validator:function(t,a,i){if(a){var r=/^[-]?[0-9]+(\.[0-9]+)?$/;r.test(a)?i():i(new Error(e.$t("debuggerInfo.enterNumber")))}},trigger:"change"}],startValue:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],step:[{required:!0,message:this.$t("validate.required"),trigger:"change"},{validator:function(t,a,i){if(String(a)){var r=/^[-]?[0-9]\d*$/;r.test(a)?i():i(new Error(e.$t("chlwatch.pleaseEnterIntNumber")))}},trigger:"change"}],objaddrWay:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],fixedValue:[{required:!0,message:this.$t("validate.required"),trigger:"change"},{validator:function(t,a,i){if(a){var r=/^[-]?[0-9]+(\.[0-9]+)?$/;r.test(a)?i():i(new Error(e.$t("debuggerInfo.enterNumber")))}},trigger:"change"}],changeValue:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],replaceStr:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],tagnameStr:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],replaceTagCommentStr:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],transValue:[{required:!0,message:this.$t("validate.required"),trigger:"change"},{validator:function(t,a,i){if(a){var r=/^[0-9]+(\.[0-9]+)?$/;r.test(a)?i():i(new Error(e.$t("chlwatch.pleaseEnterIntNumber")))}},trigger:"change"}],taginitvalue:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],assistpararm:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],tagb:[{required:!0,message:this.$t("validate.required"),trigger:"change"},{pattern:/^[\-\+]?\d+(\.\d+)?$/,message:this.$t("attribute.onlyIntAndFloat")}]},scrollTableHeight:0,tagNameOrDescSearch:"",mergeTagPage:1,mergeTagTotal:0,mergeTagsList:[],mergeTargetDeviceList:[],mergeTagIdList:[],mergeTagsToDeviceVisible:!1,mergeTagsToDeviceFormloading:!1,mergeTagsToDeviceForm:{devId:"",tagIds:[]},mergeTagsToDeviceRules:{devId:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],tagIds:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]},firstInputPvFlag:!0}},components:{AddOrUpdate:b["default"],"dialog-bar":f["a"]},methods:{handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.page=t,this.limit=a,sessionStorage.setItem("limit2",this.limit),sessionStorage.setItem("page2",this.page),this.getDataList()},querySearch:function(){var e=this;this.$hasSessionStorageGwsn()?(this.page=1,this.getDataList()):this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},sortChange:function(e){e.column;var t=e.property,a=e.order;a&&(this.sname=t,this.sort=a,this.getDataList())},getChlList:function(){var e=this,t={gwsn:sessionStorage.getItem("gwsn")};if(e.$hasSessionStorageGwsn()){if(e.chlList=[],e.storeDevMap={},!e.$hasPermission("list:getChlList:select:permission.do"))return void e.$message.warning("暂无全部采集通道查询权限, 请联系管理员");e.$http.get("/list/getChlList.do",{params:t}).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);if(a.data.length>0)if(e.addDisabled=!1,a.data.forEach((function(t){if(0==t.chlType){var a=t.chlID,i={label:t.chlName,chlId:t.chlID,chlcomment:t.chlComment||e.$t("none")};e.chlList.push(i),e.storeDevMap[a]=t.dev2PojoList&&t.dev2PojoList.length>0?t.dev2PojoList:[]}})),e.queryParams.chlId){if(e.chlList.length>0)for(var i=0;i<e.chlList.length;i++){var r=e.chlList[i];if(e.queryParams.chlId==r.chlId){e.dataForm.chlname=r.chlId,e.getFuncodeList(e.queryParams.chlId);break}}}else e.chlList.length>0&&(e.dataForm.chlname=e.chlList[0].chlId,e.getFuncodeList(e.dataForm.chlname));else e.addDisabled=!0})).catch((function(t){return e.addDisabled=!0,!1}))}else e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},handleChannel:function(e){this.dataForm.devname="",this.dataForm.collecttypec=[],this.getFuncodeList(e)},compareBySort:function(e,t){return e.sort((function(e,a){return e[t]-a[t]}))},getDevlist:function(){var e=this;e.devList=[{label:e.$t("attribute.all"),devId:"",chlId:"",devcomment:""}],e.total=0,e.dataList=[];var t=e.storeDevMap[e.dataForm.chlname];if(t.length>0)if(e.addDisabled=!1,t.forEach((function(t){var a={label:t.devName,chlId:e.dataForm.chlname,devId:t.devID,devcomment:t.devComment||e.$t("none")};e.devList.push(a)})),e.devList.length>0)if(e.devList=e.compareBySort(e.devList,"devId"),e.queryParams.devId){for(var a=!1,i=0;i<e.devList.length;i++){var r=e.devList[i];if(e.queryParams.devId==r.devId){a=!0,e.dataForm.devname=r.devId,e.getDataList();break}}a||(e.dataForm.devname=e.devList[1].devId,e.getDataList())}else e.dataForm.devname=e.devList[1].devId,e.getDataList();else e.dataForm.devname="";else e.addDisabled=!0,e.$refs.recordTable&&e.$refs.recordTable.loadData([]).then((function(){e.tagIds=[],e.selectTagDevIds=[],e.tagassistIdList=[],e.tagIdNameList=[],e.tagIdKList=[],e.tagIdCommentList=[],e.mergeTagIdList=[],e.multipleSelectionAll=[],e.selectedTagIdAndObjAddrList=[]})).finally((function(){}))},getFuncodeList:function(e){var t=this;if(t.$hasSessionStorageGwsn()){if(!t.$hasPermission("channelinfo:info:select:permission.do"))return void t.$message.warning("暂无通道查询权限, 请联系管理员");t.$http.get("/info/channelinfo/getByChliId",{params:{chlid:e,gwsn:sessionStorage.getItem("gwsn")}}).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.$hasPermission("protocolinfo:select:permission.do")?t.$http.get("/info/protocolinfo/proguid",{params:{guid:a.data[0].chlprotocol}}).then((function(e){var a=e.data;t.funcodeList=JSON.parse(a.data[0].funccode).data,t.getDevlist()})):t.$message.warning("暂无协议查询权限, 请联系管理员")})).catch((function(e){return!1}))}else t.$message({showClose:!1,message:t.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}})},handleFuncode:function(e){this.selectFuncCode=e,this.getDataList()},getDataList:h()((function(){var e=this;if(this.$hasSessionStorageGwsn()){var t={page:this.page,limit:this.limit,sort:"objaddr"==this.sname?this.sname+"+0 "+this.sort:this.sname+" "+this.sort,tagchlid:this.dataForm.chlname,gwsn:sessionStorage.getItem("gwsn")};if(this.dataForm.devname&&(t["deviceid"]=this.dataForm.devname),null!=this.dataForm.alarmtype&&(t["alarmtype"]=this.dataForm.alarmtype),this.dataForm.collecttypec.length>0&&(t["collecttypec"]=this.selectFuncCode.join(",")),this.dataForm.tagname&&(t["sname"]=this.dataForm.tagname.replace(/_/g,"\\_").replace(/%/g,"\\%")),this.dataList=[],this.total=0,!this.$hasPermission("taginfo:select:permission.do"))return void this.$message.warning("暂无测点查询权限, 请联系管理员");this.dataListLoading=!0,this.pagerLoading=!0,this.$http.get("/info/taginfo/selectTags.do",{params:t}).then((function(a){var i=a.data;e.page=t.page,e.$nextTick((function(){0!=i.code&&e.$refs.recordTable&&e.$refs.recordTable.loadData([]).then((function(){e.dataListLoading=!1,e.pagerLoading=!1})).finally((function(){return e.$message.error(i.data||i.msg)})),e.dataList=i.data.rows||[],e.$refs.recordTable&&(e.$refs.recordTable.clearCheckboxRow(),e.$refs.recordTable.loadData(e.dataList).then((function(){e.dataListLoading=!1,e.pagerLoading=!1,e.total=Number(i.data.total)||0})).finally((function(){if(e.dataList.length>0){if(e.isAddOrUpdate?e.$refs.recordTable.scrollTo(e.scrollleft,e.scorlltop):e.$refs.recordTable.scrollTo(0,0),e.currentPageCheccked&&!e.allCheck&&(e.$set(e.checkboxConfig,"checkStrictly",!1),e.$refs.recordTable.setAllCheckboxRow(!1),e.tagIds=[],e.selectTagDevIds=[],e.tagassistIdList=[],e.tagIdNameList=[],e.tagIdKList=[],e.tagIdCommentList=[],e.mergeTagIdList=[],e.multipleSelectionAll=[],e.selectedTagIdAndObjAddrList=[],e.dataList.forEach((function(t){var a={id:t.id,name:t.tagname},i={id:t.id,tagk:t.tagk},r={id:t.id,objaddr:t.objaddr},s={id:t.id,tagcomment:t.tagcomment};e.tagIds.push(t.id),e.mergeTagIdList.push(t.tagid),e.tagassistIdList.push({tagid:t.tagid,tagname:t.tagname}),e.selectTagDevIds.includes(t.devid)||e.selectTagDevIds.push(t.devid),e.selectedTagIdAndObjAddrList.push(r),e.multipleSelectionAll.push(t.id),e.tagIdNameList.push(a),e.tagIdKList.push(i),e.tagIdCommentList.push(s)})),e.$refs.recordTable.setAllCheckboxRow(!0)),!e.currentPageCheccked&&!e.allCheck)if(e.multipleSelectionAll.length>0){e.$set(e.checkboxConfig,"checkStrictly",!1),e.$refs.recordTable.setAllCheckboxRow(!1),e.tagIds=[],e.selectTagDevIds=[],e.mergeTagIdList=[],e.tagassistIdList=[],e.tagIdNameList=[],e.tagIdKList=[],e.tagIdCommentList=[],e.selectedTagIdAndObjAddrList=[];var t=!1;e.dataList.forEach((function(t){var a=e.multipleSelectionAll.length>0&&-1!==e.multipleSelectionAll.indexOf(t.id);if(a){var i={id:t.id,name:t.tagname},r={id:t.id,tagk:t.tagk},s={id:t.id,objaddr:t.objaddr},n={id:t.id,tagcomment:t.tagcomment};e.tagIds.push(t.id),e.mergeTagIdList.push(t.tagid),e.tagassistIdList.push({tagid:t.tagid,tagname:t.tagname}),e.selectTagDevIds.includes(t.devid)||e.selectTagDevIds.push(t.devid),e.selectedTagIdAndObjAddrList.push(s),e.tagIdNameList.push(i),e.tagIdKList.push(r),e.tagIdCommentList.push(n)}})),e.multipleSelectionAll.forEach((function(a){e.dataList.forEach((function(i){i.id==a&&(t=!0,e.$refs.recordTable.setCheckboxRow(i,!0))}))})),t||(e.tagIds=[],e.selectTagDevIds=[],e.mergeTagIdList=[],e.tagassistIdList=[],e.tagIdNameList=[],e.tagIdKList=[],e.tagIdCommentList=[],e.multipleSelectionAll=[])}else e.$set(e.checkboxConfig,"checkStrictly",!1),e.$refs.recordTable.setAllCheckboxRow(!1);e.allCheck&&(e.$set(e.checkboxConfig,"checkStrictly",!1),e.$refs.recordTable.setAllCheckboxRow(!0),e.$set(e.checkboxConfig,"checkStrictly",!0),e.getAllChecked())}})))}))})).catch((function(t){return e.dataListLoading=!1,!1}))}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),100,{leading:!0,trailing:!1}),formatterAlarmtype:function(e){var t=e.row;e.column;return 0===t.alarmtype?this.$t("attribute.visualValue"):1===t.alarmtype?this.$t("attribute.switchValue"):2===t.alarmtype?this.$t("attribute.ym"):3===t.alarmtype?this.$t("attribute.yk"):4===t.alarmtype?this.$t("attribute.yt"):""},formatterRwtype:function(e){var t=e.row;e.column;return 0===t.tagrwprop?this.$t("attribute.onlyRead"):1===t.tagrwprop?this.$t("attribute.readWrite"):this.$t("attribute.onlyWrite")},formatterCollecttypec:function(e){var t=e.row;e.column;if(!t.collDescript)return"";if(-1==t.collDescript.indexOf("("))return t.collDescript;var a=t.collDescript.indexOf("(");if(a>0){var i=t.collDescript.substring(0,a);return i}},getDescription:function(e,t){for(var a=0;a<this.guidList.length;a++){var i=this.guidList[a];if(i.guid==e){var r=JSON.parse(i.funccode).data;r.forEach((function(e){if(e.FuncCode===t)return-1!=e.description.indexOf("(")?e.description.split("(")[0]:e.description}));break}}},formatterDatatype:function(e){var t=e.row;e.column;return 0===t.datatype?this.$t("attribute.bit"):1===t.datatype?this.$t("attribute.eightNoSymbol"):2===t.datatype?this.$t("attribute.eightSymbol"):3===t.datatype?this.$t("attribute.sixteenNoSymbol"):4===t.datatype?this.$t("attribute.sixteenSymbol"):14===t.datatype?this.$t("attribute.twentyFourNoSymbol"):15===t.datatype?this.$t("attribute.twentyFourSymbol"):5===t.datatype?this.$t("attribute.thirtySecondNoSymbol"):6===t.datatype?this.$t("attribute.thirtySecondSymbol"):7===t.datatype?this.$t("attribute.sixteenBCD"):8===t.datatype?this.$t("attribute.thirtySecondBCD"):9===t.datatype?this.$t("attribute.singleFloat"):10===t.datatype?this.$t("attribute.doubleFloat"):11===t.datatype?this.$t("attribute.string"):12===t.datatype?this.$t("attribute.sixtyFourUnsigned"):13===t.datatype?this.$t("attribute.sixtyFourSigned"):""},formatterDataformat:function(e){var t=e.row;e.column;return 0===t.dataformat?"12":1===t.dataformat?"21":2===t.dataformat?"1234":3===t.dataformat?"2143":4===t.dataformat?"3412":"4321"},formatterbit:function(e){var t=e.row;e.column;return 1===t.enablebit?this.$t("attribute.yes"):this.$t("attribute.no")},formatterAlarm:function(e){var t=e.row;e.column;return 1===t.enablealarm?this.$t("attribute.yes"):this.$t("attribute.no")},formatterHistory:function(e){var t=e.row;e.column;return 1===t.enablehissave?this.$t("attribute.yes"):this.$t("attribute.no")},formatterIsupload:function(e){var t=e.row;e.column;return 1===t.isupload?this.$t("attribute.yes"):this.$t("attribute.no")},selectAll:function(e){var t=this;this.tagIds=[],this.selectTagDevIds=[],this.tagassistIdList=[],this.tagIdNameList=[],this.tagIdKList=[],this.tagIdCommentList=[],this.mergeTagIdList=[],this.selectedTagIdAndObjAddrList=[],this.multipleSelectionAll=[],e.records.length>0?(this.currentPageCheccked=!0,e.records.forEach((function(e){var a={id:e.id,name:e.tagname},i={id:e.id,tagk:e.tagk},r={id:e.id,objaddr:e.objaddr},s={id:e.id,tagcomment:e.tagcomment};t.tagIds.push(e.id),t.mergeTagIdList.push(e.tagid),t.tagassistIdList.push({tagid:e.tagid,tagname:e.tagname}),t.selectTagDevIds.includes(e.devid)||t.selectTagDevIds.push(e.devid),t.selectedTagIdAndObjAddrList.push(r),t.tagIdNameList.push(a),t.tagIdKList.push(i),t.tagIdCommentList.push(s),t.multipleSelectionAll.push(e.id)}))):this.currentPageCheccked=!1,this.allCheck&&!e.checked&&this.$refs.recordTable&&this.$refs.recordTable.setCheckboxRow(this.$refs.recordTable.getRowById(e.row.id),!0)},dataListSelectionHandleChange:function(e){var t=this;this.tagIds=[],this.selectTagDevIds=[],this.selectTagDevIds=[],this.tagassistIdList=[],this.tagIdNameList=[],this.tagIdKList=[],this.tagIdCommentList=[],this.mergeTagIdList=[],this.selectedTagIdAndObjAddrList=[],this.multipleSelectionAll=[],e.records.length>0&&e.records.forEach((function(e){var a={id:e.id,name:e.tagname},i={id:e.id,tagk:e.tagk},r={id:e.id,objaddr:e.objaddr},s={id:e.id,tagcomment:e.tagcomment};t.tagIds.push(e.id),t.mergeTagIdList.push(e.tagid),t.tagassistIdList.push({tagid:e.tagid,tagname:e.tagname}),t.selectTagDevIds.includes(e.devid)||t.selectTagDevIds.push(e.devid),t.selectedTagIdAndObjAddrList.push(r),t.tagIdNameList.push(a),t.tagIdKList.push(i),t.tagIdCommentList.push(s),t.multipleSelectionAll.push(e.id)})),this.allCheck&&!e.checked&&this.$refs.recordTable&&this.$refs.recordTable.setCheckboxRow(this.$refs.recordTable.getRowById(e.row.id),!0)},reduceSame:function(e){var t={};return e.reduce((function(e,a){return!t[a.id]&&(t[a.id]=e.push(a)),e}),[])},allCheckEvent:function(){var e=this;e.allCheck?(e.$refs.recordTable&&e.$refs.recordTable.setAllCheckboxRow(!0),e.$set(this.checkboxConfig,"checkStrictly",!0),e.getAllChecked()):(e.tagIds=[],e.selectTagDevIds=[],e.tagassistIdList=[],e.tagIdNameList=[],e.tagIdKList=[],e.tagIdCommentList=[],e.mergeTagIdList=[],e.selectedTagIdAndObjAddrList=[],e.multipleSelectionAll=[],e.$set(e.checkboxConfig,"checkStrictly",!1),e.$refs.recordTable&&e.$refs.recordTable.setAllCheckboxRow(!1),e.currentPageCheccked=!1)},getAllChecked:function(){var e=this;if(this.$hasSessionStorageGwsn()){var t=[],a={type:0,sort:"objaddr"==this.sname?this.sname+"+0 "+this.sort:this.sname+" "+this.sort,gwsn:sessionStorage.getItem("gwsn")};if(this.dataForm.devname?a["devIds"]=this.dataForm.devname:this.devList.forEach((function(e){e.devId&&t.push(e.devId)})),!this.$hasPermission("list:getTagList:select:permission.do"))return void this.$message.warning("暂无全部采集测点查询权限, 请联系管理员");this.$http.post("",o.a.stringify(a)).then((function(a){var i=a.data;if(0!=i.code)return e.$message.error(i.data||i.msg);e.tagIds=[],e.selectTagDevIds=[],e.tagassistIdList=[],e.tagIdNameList=[],e.tagIdKList=[],e.tagIdCommentList=[],e.mergeTagIdList=[],e.selectedTagIdAndObjAddrList=[];for(var r=0;r<i.data.length;r++){var s=i.data[r];if(String(e.dataForm.alarmtype)){if(e.dataForm.alarmtype==s.alarmType)if(e.dataForm.collecttypec.length>0){if(e.dataForm.tagname){if(e.dataForm.devname){if(-1!=e.dataForm.collecttypec.indexOf(s.collectTypeC)&&(-1!=s.tagName.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase())||s.tagComment&&-1!=s.tagComment.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase()))){var n={id:s.id,name:s.tagName},l={id:s.id,tagk:s.tagK},o={id:s.id,objaddr:s.objAddr},d={id:s.id,tagcomment:s.tagComment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.tagID),e.tagassistIdList.push({tagid:s.tagID,tagname:s.tagName}),e.selectTagDevIds.includes(s.devID)||e.selectTagDevIds.push(s.devID),e.selectedTagIdAndObjAddrList.push(o),e.tagIdNameList.push(n),e.tagIdKList.push(l),e.tagIdCommentList.push(d)}}else if(-1!=t.indexOf(s.devID)&&-1!=e.dataForm.collecttypec.indexOf(s.collectTypeC)&&(-1!=s.tagName.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase())||s.tagComment&&-1!=s.tagComment.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase()))){var c={id:s.id,name:s.tagName},g={id:s.id,tagk:s.tagK},m={id:s.id,objaddr:s.objAddr},u={id:s.id,tagcomment:s.tagComment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.tagID),e.tagassistIdList.push({tagid:s.tagID,tagname:s.tagName}),e.selectTagDevIds.includes(s.devID)||e.selectTagDevIds.push(s.devID),e.selectedTagIdAndObjAddrList.push(m),e.tagIdNameList.push(c),e.tagIdKList.push(g),e.tagIdCommentList.push(u)}}else if(e.dataForm.devname){if(-1!=e.dataForm.collecttypec.indexOf(s.collectTypeC)){var h={id:s.id,name:s.tagName},p={id:s.id,tagk:s.tagK},f={id:s.id,objaddr:s.objAddr},b={id:s.id,tagcomment:s.tagComment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.tagID),e.tagassistIdList.push({tagid:s.tagID,tagname:s.tagName}),e.selectTagDevIds.includes(s.devID)||e.selectTagDevIds.push(s.devID),e.selectedTagIdAndObjAddrList.push(f),e.tagIdNameList.push(h),e.tagIdKList.push(p),e.tagIdCommentList.push(b)}}else if(-1!=t.indexOf(s.devID)&&-1!=e.dataForm.collecttypec.indexOf(s.collectTypeC)){var v={id:s.id,name:s.tagName},$={id:s.id,tagk:s.tagK},y={id:s.id,objaddr:s.objAddr},L={id:s.id,tagcomment:s.tagComment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.tagID),e.tagassistIdList.push({tagid:s.tagID,tagname:s.tagName}),e.selectTagDevIds.includes(s.devID)||e.selectTagDevIds.push(s.devID),e.selectedTagIdAndObjAddrList.push(y),e.tagIdNameList.push(v),e.tagIdKList.push($),e.tagIdCommentList.push(L)}}else if(e.dataForm.tagname){if(e.dataForm.devname){if(-1!=s.tagName.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase())||s.tagComment&&-1!=s.tagComment.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase())){var w={id:s.id,name:s.tagName},I={id:s.id,tagk:s.tagK},F={id:s.id,objaddr:s.objAddr},T={id:s.id,tagcomment:s.tagComment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.tagID),e.tagassistIdList.push({tagid:s.tagID,tagname:s.tagName}),e.selectTagDevIds.includes(s.devID)||e.selectTagDevIds.push(s.devID),e.selectedTagIdAndObjAddrList.push(F),e.tagIdNameList.push(w),e.tagIdKList.push(I),e.tagIdCommentList.push(T)}}else if(-1!=t.indexOf(s.devID)&&(-1!=s.tagName.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase())||s.tagComment&&-1!=s.tagComment.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase()))){var S={id:s.id,name:s.tagName},C={id:s.id,tagk:s.tagK},D={id:s.id,objaddr:s.objAddr},x={id:s.id,tagcomment:s.tagComment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.tagID),e.tagassistIdList.push({tagid:s.tagID,tagname:s.tagName}),e.selectTagDevIds.includes(s.devID)||e.selectTagDevIds.push(s.devID),e.selectedTagIdAndObjAddrList.push(D),e.tagIdNameList.push(S),e.tagIdKList.push(C),e.tagIdCommentList.push(x)}}else if(e.dataForm.devname){var k={id:s.id,name:s.tagName},V={id:s.id,tagk:s.tagK},O={id:s.id,objaddr:s.objAddr},N={id:s.id,tagcomment:s.tagComment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.tagID),e.tagassistIdList.push({tagid:s.tagID,tagname:s.tagName}),e.selectTagDevIds.includes(s.devID)||e.selectTagDevIds.push(s.devID),e.selectedTagIdAndObjAddrList.push(O),e.tagIdNameList.push(k),e.tagIdKList.push(V),e.tagIdCommentList.push(N)}else if(-1!=t.indexOf(s.devID)){var A={id:s.id,name:s.tagName},_={id:s.id,tagk:s.tagK},j={id:s.id,objaddr:s.objAddr},E={id:s.id,tagcomment:s.tagComment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.tagID),e.tagassistIdList.push({tagid:s.tagID,tagname:s.tagName}),e.selectTagDevIds.includes(s.devID)||e.selectTagDevIds.push(s.devID),e.selectedTagIdAndObjAddrList.push(j),e.tagIdNameList.push(A),e.tagIdKList.push(_),e.tagIdCommentList.push(E)}}else if(e.dataForm.collecttypec.length>0){if(e.dataForm.tagname){if(e.dataForm.devname){if(-1!=e.dataForm.collecttypec.indexOf(s.collectTypeC)&&(-1!=s.tagName.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase())||s.tagComment&&-1!=s.tagComment.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase()))){var P={id:s.id,name:s.tagName},q={id:s.id,tagk:s.tagK},R={id:s.id,objaddr:s.objAddr},K={id:s.id,tagcomment:s.tagComment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.tagID),e.tagassistIdList.push({tagid:s.tagID,tagname:s.tagName}),e.selectTagDevIds.includes(s.devID)||e.selectTagDevIds.push(s.devID),e.selectedTagIdAndObjAddrList.push(R),e.tagIdNameList.push(P),e.tagIdKList.push(q),e.tagIdCommentList.push(K)}}else if(-1!=t.indexOf(s.devID)&&-1!=e.dataForm.collecttypec.indexOf(s.collectTypeC)&&(-1!=s.tagName.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase())||s.tagComment&&-1!=s.tagComment.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase()))){var M={id:s.id,name:s.tagName},U={id:s.id,tagk:s.tagK},W={id:s.id,objaddr:s.objAddr},z={id:s.id,tagcomment:s.tagComment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.tagID),e.tagassistIdList.push({tagid:s.tagID,tagname:s.tagName}),e.selectTagDevIds.includes(s.devID)||e.selectTagDevIds.push(s.devID),e.selectedTagIdAndObjAddrList.push(W),e.tagIdNameList.push(M),e.tagIdKList.push(U),e.tagIdCommentList.push(z)}}else if(e.dataForm.devname){if(-1!=e.dataForm.collecttypec.indexOf(s.collectTypeC)){var B={id:s.id,name:s.tagName},H={id:s.id,tagk:s.tagK},G={id:s.id,objaddr:s.objAddr},J={id:s.id,tagcomment:s.tagComment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.tagID),e.tagassistIdList.push({tagid:s.tagID,tagname:s.tagName}),e.selectTagDevIds.includes(s.devID)||e.selectTagDevIds.push(s.devID),e.selectedTagIdAndObjAddrList.push(G),e.tagIdNameList.push(B),e.tagIdKList.push(H),e.tagIdCommentList.push(J)}}else if(-1!=e.dataForm.collecttypec.indexOf(s.collectTypeC)&&-1!=t.indexOf(s.devID)){var Q={id:s.id,name:s.tagName},X={id:s.id,tagk:s.tagK},Y={id:s.id,objaddr:s.objAddr},Z={id:s.id,tagcomment:s.tagComment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.tagID),e.tagassistIdList.push({tagid:s.tagID,tagname:s.tagName}),e.selectTagDevIds.includes(s.devID)||e.selectTagDevIds.push(s.devID),e.selectedTagIdAndObjAddrList.push(Y),e.tagIdNameList.push(Q),e.tagIdKList.push(X),e.tagIdCommentList.push(Z)}}else if(e.dataForm.tagname){if(e.dataForm.devname){if(-1!=s.tagName.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase())||s.tagComment&&-1!=s.tagComment.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase())){var ee={id:s.id,name:s.tagName},te={id:s.id,tagk:s.tagK},ae={id:s.id,objaddr:s.objAddr},ie={id:s.id,tagcomment:s.tagComment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.tagID),e.tagassistIdList.push({tagid:s.tagID,tagname:s.tagName}),e.selectTagDevIds.includes(s.devID)||e.selectTagDevIds.push(s.devID),e.selectedTagIdAndObjAddrList.push(ae),e.tagIdNameList.push(ee),e.tagIdKList.push(te),e.tagIdCommentList.push(ie)}}else if(-1!=t.index(s.devID)&&(-1!=s.tagName.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase())||s.tagComment&&-1!=s.tagComment.toLocaleLowerCase().indexOf(e.dataForm.tagname.toLocaleLowerCase()))){var re={id:s.id,name:s.tagName},se={id:s.id,tagk:s.tagK},ne={id:s.id,objaddr:s.objAddr},le={id:s.id,tagcomment:s.tagComment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.tagID),e.tagassistIdList.push({tagid:s.tagID,tagname:s.tagName}),e.selectTagDevIds.includes(s.devID)||e.selectTagDevIds.push(s.devID),e.selectedTagIdAndObjAddrList.push(ne),e.tagIdNameList.push(re),e.tagIdKList.push(se),e.tagIdCommentList.push(le)}}else if(e.dataForm.devname){var oe={id:s.id,name:s.tagName},de={id:s.id,tagk:s.tagK},ce={id:s.id,objaddr:s.objAddr},ge={id:s.id,tagcomment:s.tagComment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.tagID),e.tagassistIdList.push({tagid:s.tagID,tagname:s.tagName}),e.selectTagDevIds.includes(s.devID)||e.selectTagDevIds.push(s.devID),e.selectedTagIdAndObjAddrList.push(ce),e.tagIdNameList.push(oe),e.tagIdKList.push(de),e.tagIdCommentList.push(ge)}else if(-1!=t.indexOf(s.devID)){var me={id:s.id,name:s.tagName},ue={id:s.id,tagk:s.tagK},he={id:s.id,objaddr:s.objAddr},pe={id:s.id,tagcomment:s.tagComment};e.tagIds.push(s.id),e.mergeTagIdList.push(s.tagID),e.tagassistIdList.push({tagid:s.tagID,tagname:s.tagName}),e.selectTagDevIds.includes(s.devID)||e.selectTagDevIds.push(s.devID),e.selectedTagIdAndObjAddrList.push(he),e.tagIdNameList.push(me),e.tagIdKList.push(ue),e.tagIdCommentList.push(pe)}}})).catch((function(e){return!1}))}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},getTreeList:function(){var e=this,t={chltype:0,gwsn:sessionStorage.getItem("gwsn")};if(e.$hasSessionStorageGwsn()){if(e.dataTree=[{id:0,label:e.$t("attribute.own"),children:[]}],!e.$hasPermission("channelinfo:selectChlAndDev:permission.do"))return void e.$message.warning("暂无通道设备查询权限, 请联系管理员");e.$http.post("/info/channelinfo/selectChlAndDev",o.a.stringify(t)).then((function(t){var a=t.data;if(a.length>0){var i,r=L(a);try{for(r.s();!(i=r.n()).done;){var s=i.value,n={id:s.chlid,label:s.chlname,p_id:0};if(s.children.length>0){n.children=[];var l,o=L(s.children);try{for(o.s();!(l=o.n()).done;){var d=l.value,c={id:d.devid,label:d.devname,p_id:d.chlid,children:[]};n.children.push(c)}}catch(g){o.e(g)}finally{o.f()}}e.dataTree[0].children.push(n)}}catch(g){r.e(g)}finally{r.f()}}})).catch((function(e){return!1}))}else e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},handleCheckChange:function(){var e=[],t=[];e=this.$refs.tree.getCheckedNodes();var a,i=L(e);try{for(i.s();!(a=i.n()).done;){var r=a.value;0!=r.id&&0!=r.p_id&&t.push(r.id)}}catch(s){i.e(s)}finally{i.f()}this.importForm.deviceId=t.join(",")},handleAddOrUpdate:function(e){var t=this;if(this.$hasSessionStorageGwsn()){if(this.addDisabled)return this.$message.warning(this.$t("attribute.noCollectDevice"));this.addOrUpdateVisible=!0,this.$nextTick((function(){var a=t.$refs.recordTable?t.$refs.recordTable.getScroll().scrollLeft:0,i=t.$refs.recordTable?t.$refs.recordTable.getScroll().scrollTop:0;if(t.scrollleft=a,t.scorlltop=i,e){if(!t.$hasPermission("taginfo:update:permission.do"))return void t.$message.warning("暂无测点修改权限, 请联系管理员");t.isAddOrUpdate=!0}else{if(!t.$hasPermission("taginfo:insert:permission.do"))return void t.$message.warning("暂无测点新增权限, 请联系管理员");t.isAddOrUpdate=!1,t.$refs.addOrUpdate.paramdevid=t.dataForm.devname}t.$refs.addOrUpdate.dataForm.id=e,t.$refs.addOrUpdate.init()}))}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}})},deleteHandle:h()((function(e){var t=this;if(t.$hasSessionStorageGwsn()){if(e&&(t.tagIds=[],t.tagassistIdList=[],t.tagIds.push(e.id),t.tagassistIdList.push({tagid:e.tagid,tagname:e.tagname})),0===t.tagIds.length)return t.$message.error(t.$t("deleteInfo.noData"));if(!t.$hasPermission("tag:delete:permission.do"))return void t.$message.warning("暂无测点删除权限, 请联系管理员");if(!t.$hasPermission("tagassist:delete:permission.do"))return void t.$message.warning("暂无测点辅助参数删除权限, 请联系管理员");t.$confirm(t.$t("deleteInfo.noticeTitle"),t.$t("deleteInfo.noticePrompt"),{confirmButtonText:t.$t("deleteInfo.confirm"),cancelButtonText:t.$t("deleteInfo.cancel"),type:"warning"}).then((function(){t.dataListLoading=!0;var e=[];t.$http.post("/delcmd/tag/delete.do",t.tagIds).then((function(a){var i=a.data;if(0!=i.code)return t.dataListLoading=!1,t.$message.error(i.data||t.$t("deleteInfo.deleteFail"));var r,s=L(t.tagassistIdList);try{for(s.s();!(r=s.n()).done;){var n=r.value;e.push(n.tagid)}}catch(l){s.e(l)}finally{s.f()}t.$nextTick((function(){var a={ids:e.join(","),gwsn:sessionStorage.getItem("gwsn")};t.$http.post("/tagassist/delete.do",o.a.stringify(a)).then((function(e){var a=e.data;if(0!=a.code)return t.dataListLoading=!1,t.$message.error(a.data||t.$t("deleteInfo.deleteFail"));t.$message.success(t.$t("deleteInfo.deleteSuccess")),t.dataListLoading=!1,t.allCheck=!1,t.currentPageCheccked=!1,t.getDataList()})).catch((function(e){return t.dataListLoading=!1,t.allCheck=!1,t.currentPageCheccked=!1,t.getDataList()}))}))})).catch((function(e){return t.dataListLoading=!1,t.allCheck=!1,t.currentPageCheccked=!1,t.getDataList()}))})).catch((function(e){}))}else t.$message({showClose:!1,message:t.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),editAll:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.$hasSessionStorageGwsn()){e.next=7;break}if(!(this.tagIds.length>0)){e.next=5;break}if(this.$hasPermission("taginfo:update:permission.do")){e.next=1;break}return this.$message.warning("暂无设备批量修改权限, 请联系管理员"),e.abrupt("return");case 1:return this.firstInputPvFlag=!0,this.editAllVisible=!0,e.next=2,this.getCollectTypeList();case 2:if(this.$hasPermission("deviceinfo:DevicesBywsnAndPtypeSelect:permission.do")){e.next=4;break}return e.next=3,this.$message.warning("暂无设备查询权限, 请联系管理员");case 3:return e.abrupt("return");case 4:this.$http.get("/info/deviceinfo/DevicesBywsnAndPtype",{params:{gwsn:sessionStorage.getItem("gwsn"),ptype:0,chlid:this.dataForm.chlname}}).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);if(a.data.length>0){var i=!0;if(t.dataForm.devname){for(var r={},s=0;s<a.data.length;s++){var n=a.data[s];if(n.devid==t.dataForm.devname&&(r=n,-1==n.devmanu&&0==n.devmodel)){i=!1;break}}if(i){if(t.pvflagList=[],!t.$hasPermission("pvparaminfo:select:permission.do"))return void t.$message.warning("暂无pv上传标识查询权限, 请联系管理员");t.$http.post("/info/pvparaminfo/listParam",o.a.stringify({devPlatform:r.devmanu,devIndex:r.devmodel})).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);a.data.length>0&&(a.data.forEach((function(e){t.pvflagList.push({label:e.paramDesc,value:e.paramIndex,name:e.paramDesc})})),t.$nextTick((function(){t.selectChanged(t.editForm.type)})))}))}else"pvflag"==t.editForm.type&&(t.changeList=[],t.editForm.changeValue=""),t.pvflagList=[]}else{var l=[];a.data.forEach((function(e){t.selectTagDevIds.includes(String(e.devid))&&l.push(e)}));for(var d=0;d<l.length;d++){var c=l[d];if(c.devmanu!=l[0].devmanu||c.devmodel!=l[0].devmodel){i=!1;break}}if(i){if(t.pvflagList=[],l.length>0){if(!t.$hasPermission("pvparaminfo:select:permission.do"))return void t.$message.warning("暂无pv上传标识查询权限, 请联系管理员");t.$http.post("/info/pvparaminfo/listParam",o.a.stringify({devPlatform:l[0].devmanu,devIndex:l[0].devmodel})).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);a.data.length>0&&(a.data.forEach((function(e){t.pvflagList.push({label:e.paramDesc,value:e.paramIndex,name:e.paramDesc})})),t.$nextTick((function(){t.selectChanged(t.editForm.type)})))}))}}else"pvflag"==t.editForm.type&&(t.changeList=[],t.editForm.changeValue=""),t.pvflagList=[]}}else"pvflag"==t.editForm.type&&(t.changeList=[],t.editForm.changeValue=""),t.pvflagList=[]})),e.next=6;break;case 5:return e.abrupt("return",this.$message.info(this.$t("attribute.selectEditData")));case 6:e.next=8;break;case 7:this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}});case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),selectChanged:function(e){if(this.$refs.editForm.clearValidate(),this.editForm.changeValue="","dataformat"===e)this.changeList=this.hiloType,this.editForm.changeValue=this.changeList[0].value;else if("datatype"===e)this.changeList=this.dataType,this.editForm.changeValue=this.changeList[0].value;else if("alarmtype"===e)this.changeList=this.alarmRecordList,this.editForm.changeValue=this.changeList[0].value;else if("tagrwprop"===e)this.changeList=this.writeReadType,this.editForm.changeValue=this.changeList[0].value;else if("collecttypec"===e)this.changeList=this.collecttypecList,this.editForm.changeValue=this.changeList[0].value;else if("enablealarm"===e)this.changeList=this.enablealarmList,this.editForm.changeValue=this.changeList[0].value;else if("enablehissave"===e)this.changeList=this.enablehissaveList,this.editForm.changeValue=this.changeList[0].value;else if("isupload"===e)this.changeList=this.isuploadList,this.editForm.changeValue=this.changeList[0].value;else if("enablebit"==e)this.changeList=this.enablebitList,this.editForm.changeValue=this.changeList[0].value;else if("enabletransvalue"==e)this.changeList=this.isTransvalueList,this.editForm.changeValue=this.changeList[0].value;else if("startbit"===e)this.changeList=this.startbitList,this.editForm.changeValue=this.changeList[0].value;else if("endbit"===e)this.editForm.endbit=this.startbitList[0].value;else if("limitValueEnable"===e){var t=this.$refs.recordTable.getCheckboxRecords();if(t.length>0)for(var a=0;a<t.length;a++){var i=t[a];if(null!=i.tagAssistEntity||void 0!=i.tagAssistEntity){this.editForm.limitValueEnable=i.tagAssistEntity.enable,this.editForm.maxValue=i.tagAssistEntity.upperLimit,this.editForm.minValue=i.tagAssistEntity.lowerLimit,this.editForm.limitdataFormat=i.tagAssistEntity.dataFormat;break}}}else"pvflag"===e?(this.changeList=this.pvflagList,this.changeList.length>0?(this.editForm.pvflag=this.changeList[0].name,this.editForm.changeValue=this.changeList[0].value):this.$notify({type:"warning",message:this.$t("configuration.unableToBatchModifyPVUploadIdentifier")})):"reserve3"===e&&(this.changeList=this.isuploadList,this.editForm.changeValue=this.changeList[0].value)},handleAddSmartTransDataChange:function(){this.editForm.smartTransformTableData.push({sourceK:1,targetK:1})},handleResetSmartTransDataChange:function(){this.editForm.smartTransformTableData=[{sourceK:.1,targetK:10},{sourceK:.01,targetK:100},{sourceK:.001,targetK:1e3}]},handleDeleteSmartTransDataChange:function(e){this.editForm.smartTransformTableData.splice(e,1)},handleTagCommentWayChange:function(e){this.$refs.editForm.clearValidate()},querySearchAsync:function(e,t){for(var a=this,i=a.taggroupList,r=0,s=i.length;r<s;r++)i[r].value=i[r].value,i[r].label=i[r].label;var n=e?i.filter(a.createStateFilter(e)):i;t(n)},createStateFilter:function(e){return function(t){return-1!=t.value.indexOf(e)}},handleSelectTaggroup:function(e){this.editForm.changeValue=e.value},querySearchPvFlagAsync:function(e,t){var a=this,i=a.pvflagList;if(a.firstInputPvFlag){var r=i;t(r)}else{var s=e?i.filter(a.createPvflagFilter(e)):i;t(s)}},createPvflagFilter:function(e){return function(t){return-1!=t.label.indexOf(e)}},handlePvflag:function(e){this.editForm.changeValue=String(e.value)},setPvflagBlur:function(){this.$refs.pvFlagRef.activated=!0},getCollectTypeList:function(){var e=this;if(e.$hasSessionStorageGwsn()){if(e.collecttypecList=[],!e.$hasPermission("channelinfo:info:select:permission.do"))return void e.$message.warning("暂无通道信息查询权限, 请联系管理员");if(!e.$hasPermission("protocolinfo:select:permission.do"))return void e.$message.warning("暂无协议查询权限, 请联系管理员");e.$http.get("/info/channelinfo/getByChliId",{params:{chlid:e.dataForm.chlname,gwsn:sessionStorage.getItem("gwsn")}}).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);e.$http.get("/info/protocolinfo/proguid",{params:{guid:a.data[0].chlprotocol}}).then((function(t){var a=t.data;if(a.data.length>0){var i=JSON.parse(a.data[0].funccode).data;i.length>0&&i.forEach((function(t){var a={label:t.description,value:t.FuncCode};e.collecttypecList.push(a)}))}})).catch((function(e){return!1}))})).catch((function(e){return!1}))}else e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},getArrDifference:function(e,t){for(var a=[],i=0;i<t.length;i++){for(var r=t[i],s=!1,n=0;n<e.length;n++){var l=e[n];if(r==l){s=!0;break}}s||a.push(r)}return a},isRepeat:function(e){var t={};for(var a in e){if(t[e[a]])return!0;t[e[a]]=!0}return!1},generateAddresses:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,i=[];if("number"===typeof e){for(var r=0;r<a;r++)i.push(String(e+r*t));return i}var s=e.match(/\d+/g);if(!s){for(var n=0;n<a;n++)i.push(0==t?"".concat(e):"".concat(e).concat(n*t));return i}for(var l=s[s.length-1],o=e.lastIndexOf(l),d=e.substring(0,o),c=e.substring(o+l.length),g=parseInt(l,10),m=0;m<a;m++){var u=g+m*t,h=l.startsWith("0")?String(u).padStart(l.length,"0"):String(u);i.push("".concat(d).concat(h).concat(c))}return i},dataFormSubmitHandle:h()((function(){var e=this;if(this.$hasSessionStorageGwsn()){var t=[];if("tagname"===this.editForm.type){if("replace"==this.editForm.way)this.tagIdNameList.forEach((function(a){if(-1!=a.name.toLowerCase().indexOf(e.editForm.replaceStr.toLowerCase())){var i={id:a.id,tagname:a.name.replace(new RegExp(e.editForm.replaceStr,"gi"),e.editForm.tagnameStr)};t.push(i)}}));else if("prepend"==this.editForm.way)this.tagIdNameList.forEach((function(a){var i={id:a.id,tagname:e.editForm.tagnameStr+a.name};t.push(i)}));else if("append"==this.editForm.way)this.tagIdNameList.forEach((function(a){var i={id:a.id,tagname:a.name+e.editForm.tagnameStr};t.push(i)}));else if("increment"==this.editForm.way){var a=this.editForm.tagnameStr;this.tagIdNameList.forEach((function(e,i){i>0&&(a=Object(v["m"])(a));var r={id:e.id,tagname:a};t.push(r)}))}if(0==t.length)return this.editForm.replaceStr="",this.$message.warning(this.$t("configuration.noMeasurementPointNamesMatchingTheReplacementSourceHaveBeenFoundYet"))}else if("objaddr"===this.editForm.type){var i=/.*\..*/;if("step"==this.editForm.objaddrWay)if(-1!=this.$chineseChar2englishChar(String(this.editForm.startValue)).indexOf(",")){var r=this.$chineseChar2englishChar(String(this.editForm.startValue)).split(",")[0],s=this.$chineseChar2englishChar(String(this.editForm.startValue)).split(",")[1],n=null,l=null,d=this.$chineseChar2englishChar(String(s)),c=d.match(/\d+\.*\d*/g);if(c&&c.length>0){i.test(c[c.length-1])?(n=c[c.length-1].split(".")[1],l=d.substring(0,d.length-String(n).length)):(n=c[c.length-1],l=d.substring(0,d.length-String(n).length));var g=parseInt(n),m=Number(this.editForm.step),u=0,h="",p=parseInt(n);i.test(n)&&(u=n.split(".")[1]),i.test(n)?this.tagIds.forEach((function(a){if(String(n).length>String(p).length){h="";for(var i=0;i<String(n).length-String(p).length;i++)h+="0"}else h="";var s={};s.id=a,s.objaddr=""!=h?r?r+","+l+h+p:l+h+p:r?r+","+l+p:l+p,u=Number(u)+Number(e.editForm.step),p=g+"."+u,t.push(s)})):this.tagIds.forEach((function(e){if(String(n).length>String(p).length){h="";for(var a=0;a<String(n).length-String(p).length;a++)h+="0"}else h="";var i={};i.id=e,i.objaddr=""!=h?r?r+","+l+String(h)+p:l+h+p:r?r+","+l+p:l+p,p+=m,t.push(i)}))}}else{var f=this.generateAddresses(String(this.editForm.startValue),Number(this.editForm.step),this.tagIds.length);this.tagIds.forEach((function(e,a){var i={id:e,objaddr:f[a]};t.push(i)}))}else this.selectedTagIdAndObjAddrList.forEach((function(a){if(-1!=e.$chineseChar2englishChar(String(a.objaddr)).indexOf(",")){var r=e.$chineseChar2englishChar(String(a.objaddr)).split(",")[0],s=e.$chineseChar2englishChar(String(a.objaddr)).split(",")[1],n=null,l=null,o=e.$chineseChar2englishChar(String(s)),d=o.match(/\d+\.*\d*/g);if(d&&d.length>0){i.test(d[d.length-1])?(n=d[d.length-1].split(".")[1],l=o.substring(0,o.length-String(n).length)):(n=d[d.length-1],l=o.substring(0,o.length-String(n).length));var c=parseInt(n),g=Number(e.editForm.fixedValue),m=0,u="",h=parseInt(n);if(i.test(n)&&(m=n.split(".")[1]),i.test(n)){if(String(n).length>String(h).length){u="";for(var p=0;p<String(n).length-String(h).length;p++)u+="0"}else u="";var f={};f.id=a.id,m=Number(m)+Number(e.editForm.fixedValue),h=c+"."+m,f.objaddr=""!=u?r?r+","+l+u+h:l+u+h:r?r+","+l+h:l+h,t.push(f)}else{if(String(n).length>String(h).length){u="";for(var b=0;b<String(n).length-String(h).length;b++)u+="0"}else u="";var v={};v.id=a.id,h+=g,v.objaddr=""!=u?r?r+","+l+String(u)+h:l+u+h:r?r+","+l+h:l+h,t.push(v)}}}else{var $=null,y=null,L=e.$chineseChar2englishChar(String(a.objaddr)),w=L.match(/\d+\.*\d*/g);if(w&&w.length>0){i.test(w[w.length-1])?($=w[w.length-1].split(".")[1],y=L.substring(0,L.length-String($).length)):($=w[w.length-1],y=L.substring(0,L.length-String($).length));var I=parseInt($),F=0,T="",S=parseInt($);if(i.test($)&&(F=$.split(".")[1]),i.test($)){if(String($).length>String(S).length){T="";for(var C=0;C<String($).length-String(S).length;C++)T+="0"}else T="";var D={};D.id=a.id,F=Number(F)+Number(e.editForm.fixedValue),S=I+"."+F,D.objaddr=""!=T?y?y+T+S:T+S:y?y+S:S,t.push(D)}else{if(String($).length>String(S).length){T="";for(var x=0;x<String($).length-String(S).length;x++)T+="0"}else T="";var k={};k.id=a.id,S+=Number(e.editForm.fixedValue),k.objaddr=""!=T?y?y+String(T)+S:T+S:y?y+S:S,t.push(k)}}}}))}else if("tagk"===this.editForm.type)if(this.editForm.smartTransform){if(0==this.editForm.smartTransformTableData.length)return this.$message.warning(this.$t("attribute.addModificationRules"));var b=[];if(this.editForm.smartTransformTableData.forEach((function(e){b.push(e.sourceK)})),this.isRepeat(b))return this.$message.warning(this.$t("attribute.duplicateDataInRules"));if(this.editForm.smartTransformTableData.forEach((function(a){e.tagIdKList.forEach((function(e){if(a.sourceK==e.tagk){var i={id:e.id,tagk:a.targetK};t.push(i)}}))})),0==t.length)return this.$message.warning(this.$t("attribute.noDataSourceMatchedYet"))}else this.tagIdKList.forEach((function(a){var i={id:a.id,tagk:e.editForm.value};t.push(i)}));else if("reserve2"===this.editForm.type)t={ids:this.tagIds.join(","),param:this.editForm.reserve2};else if("startbit"===this.editForm.type){var $=this.editForm.changeValue,w=this.editForm.type;this.tagIds.forEach((function(e){Number($)>31&&($=0);var a={};a.id=e,a[w]=$,t.push(a),$++}))}else if("endbit"===this.editForm.type){var I=this.editForm.endbit,F=this.editForm.type;this.tagIds.forEach((function(e){var a={};a.id=e,a[F]=I,t.push(a)}))}else if("tagb"===this.editForm.type){var T=this.editForm.tagb,S=this.editForm.type;this.tagIds.forEach((function(e){var a={};a.id=e,a[S]=T,t.push(a)}))}else if("transvalue"===this.editForm.type){var C=this.editForm.type;this.tagIds.forEach((function(a){var i={};i.id=a,i[C]=e.editForm.transValue,t.push(i)}))}else if("limitValueEnable"===this.editForm.type){if(3==this.editForm.limitValueEnable){if(this.editForm.maxValue-this.editForm.minValue<0)return this.$message.error(this.$t("attribute.minimumValueGreaterthanMaximumValue"));if(this.editForm.maxValue==this.editForm.minValue)return this.$message.error(this.$t("attribute.maximumValueEqualthanMinimumValue"))}this.tagassistIdList.forEach((function(a){var i={tagId:a.tagid,tagName:a.tagname,gwsn:sessionStorage.getItem("gwsn"),dataFormat:e.editForm.limitdataFormat,enable:e.editForm.limitValueEnable,lowerLimit:e.editForm.minValue,upperLimit:e.editForm.maxValue};t.push(i)}))}else if("taginitvalue"===this.editForm.type)this.tagIds.forEach((function(a){var i={};i.id=a,i["taginitvalue"]=e.editForm.taginitvalue,t.push(i)}));else if("assistpararm"===this.editForm.type)this.tagIds.forEach((function(a){var i={};i.id=a,i["assistpararm"]=e.editForm.assistpararm,t.push(i)}));else if("reserve3"===this.editForm.type){var D=this.editForm.type;this.tagIds.forEach((function(a){var i={};i.id=a,i[D]=String(e.editForm.changeValue),t.push(i)}))}else{var x=this.editForm.type;this.tagIds.forEach((function(a){var i={};i.id=a,i[x]=e.editForm.changeValue,t.push(i)}))}if("limitValueEnable"!==this.editForm.type)if("reserve2"==this.editForm.type){if(!this.$hasPermission("taginfo:update:permission.do"))return void this.$message.warning("暂无设备批量修改权限, 请联系管理员");this.$refs["editForm"].validate((function(a){if(!a)return!1;e.$http.put("/info/taginfo/batchUpdatePvParam.do",o.a.stringify(t)).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);e.$message.success(e.$t("prompt.success")),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList()}))}))}else if("pvflag"==this.editForm.type){if(!this.$hasPermission("taginfo:update:permission.do"))return void this.$message.warning("暂无设备批量修改权限, 请联系管理员");var k=[],V=null,O=this.editForm.type;if("NaN"===parseFloat(this.editForm.pvflag).toString()){var N=this.pvflagList.find((function(t){return t.label==e.editForm.pvflag}));if(!N)return this.$message.error(this.$t("debuggerInfo.enterNumber"));V=Number(N.value)}else if("NaN"===Number(this.editForm.pvflag).toString()){var A=this.pvflagList.find((function(t){return t.label==e.editForm.pvflag}));if(!A)return this.$message.error(this.$t("debuggerInfo.enterNumber"));V=Number(A.value)}else V=Number(this.editForm.pvflag);this.tagIds.forEach((function(e){var t={};t.id=e,t[O]=V,k.push(t)})),this.$http.put("/info/taginfo/update.do",k).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);e.$message.success(e.$t("prompt.success")),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList()}))}else if("tagcomment"==this.editForm.type){if(!this.$hasPermission("taginfo:update:permission.do"))return void this.$message.warning("暂无设备批量修改权限, 请联系管理员");var _=[];if("replace"==this.editForm.tagcommentWay){if(this.tagIdCommentList.forEach((function(t){if(-1!=t.tagcomment.toLowerCase().indexOf(e.editForm.replaceTagCommentStr.toLowerCase())){var a={};a.id=t.id,a.tagcomment=t.tagcomment.replace(new RegExp(e.editForm.replaceTagCommentStr,"gi"),e.editForm.tagcomment),_.push(a)}})),0==_.length)return this.editForm.replaceTagCommentStr="",this.$message.warning(this.$t("attribute.modelIdentificationSource"));this.$http.put("/info/taginfo/update.do",_).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);e.$message.success(e.$t("prompt.success")),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList()}))}else if("prepend"==this.editForm.tagcommentWay){if(this.tagIdCommentList.forEach((function(t){var a={};a.id=t.id,a.tagcomment=e.editForm.tagcomment+t.tagcomment,_.push(a)})),0==_.length)return this.editForm.replaceTagCommentStr="",this.$message.warning(this.$t("attribute.currentlyOperationalDataSource"));this.$http.put("/info/taginfo/update.do",_).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);e.$message.success(e.$t("prompt.success")),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList()}))}else if("append"==this.editForm.tagcommentWay){if(this.tagIdCommentList.forEach((function(t){var a={};a.id=t.id,a.tagcomment=t.tagcomment+e.editForm.tagcomment,_.push(a)})),0==_.length)return this.editForm.replaceTagCommentStr="",this.$message.warning(this.$t("attribute.currentlyOperationalDataSource"));this.$http.put("/info/taginfo/update.do",_).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);e.$message.success(e.$t("prompt.success")),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList()}))}else if("increasing"==this.editForm.tagcommentWay){var j=this.editForm.tagcomment.match(/[0-9]+\.*\d*/g),E=null,P="",q=null;if(j?(j=j[j.length-1],j.includes(".")?(P=this.editForm.tagcomment.substring(0,this.editForm.tagcomment.indexOf(j))+j.split(".")[0],E=j.split(".")[1],q=E):(P=this.editForm.tagcomment.substring(0,this.editForm.tagcomment.indexOf(j)),q=this.editForm.tagcomment.substring(this.editForm.tagcomment.indexOf(j),this.editForm.tagcomment.length))):P=this.editForm.tagcomment,this.editForm.tagcommentStep)if(1==this.editForm.tagcommentStep)this.tagIdCommentList.forEach((function(e,t){var a={};a.id=e.id,a.tagcomment=j?j.includes(".")?q?P+"."+q.substring(0,q.length-String(Number(j.split(".")[1])+Number(t)).length)+(Number(j.split(".")[1])+Number(t)):P+"."+(Number(j.split(".")[1])+Number(t)):P+(q?q.substring(0,q.length-String(Number(j)+Number(t)).length)+(Number(j)+Number(t)):Number(j)+Number(t)):P+t,_.push(a)}));else{var R=null;R=j?j.includes(".")?Number(j.split(".")[1]):Number(j):0,this.tagIdCommentList.forEach((function(t,a){var i={};i.id=t.id,i.tagcomment=j?j.includes(".")?q?P+"."+q.substring(0,q.length-String(R).length)+R:P+"."+(Number(E)+Number(e.editForm.tagcommentStep)):P+(q?q.substring(0,q.length-String(R).length)+R:R):P+R,_.push(i),R+=e.editForm.tagcommentStep}))}else this.tagIdCommentList.forEach((function(e,t){var a={};a.id=e.id,a.tagcomment=j?j.includes(".")?q?P+"."+q.substring(0,q.length-String(Number(j.split(".")[1])+Number(t)).length)+(Number(j.split(".")[1])+Number(t)):P+"."+(Number(j.split(".")[1])+Number(t)):P+(q?q.substring(0,q.length-String(Number(j)+Number(t)).length)+(Number(j)+Number(t)):Number(j)+Number(t)):P+t,_.push(a)}));if(0==_.length)return this.editForm.replaceTagCommentStr="",this.$message.warning(this.$t("attribute.currentlyOperationalDataSource"));this.$http.put("/info/taginfo/update.do",_).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);e.$message.success(e.$t("prompt.success")),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList()}))}else if("clipboardSource"==this.editForm.tagcommentWay){var K=navigator.clipboard.readText();K.then((function(t){if(t=t.split("\r\n"),0==t.length)return e.$message.warning(e.$t("clipboardNoContent")),!1;if(1==t.length&&""==t[t.length-1])return e.$message.warning(e.$t("clipboardNoContent")),!1;if(t=""==t[t.length-1]?t.slice(0,t.length-1):t,t.length<e.tagIdCommentList.length)e.$confirm(e.$t("clipboardContentLengthInconsistentWithSelectedMeasuringPoint"),e.$t("prompt.title"),{confirmButtonText:e.$t("confirm"),cancelButtonText:e.$t("cancel"),type:"warning"}).then((function(){if(t.forEach((function(t,a){var i={};i.id=e.tagIdCommentList[a].id,i.tagcomment=t,_.push(i)})),0==_.length)return e.$message.warning(e.$t("attribute.currentlyOperationalDataSource"));e.$http.put("/info/taginfo/update.do",_).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);e.$message.success(e.$t("prompt.success")),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList()}))})).catch((function(){}));else{if(e.tagIdCommentList.forEach((function(e,a){var i={};i.id=e.id,i.tagcomment=t[a],_.push(i)})),0==_.length)return e.$message.warning(e.$t("attribute.currentlyOperationalDataSource"));e.$http.put("/info/taginfo/update.do",_).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);e.$message.success(e.$t("prompt.success")),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList()}))}})).catch((function(t){return e.$message.error(e.$t("failedToObtainClipboardContent"))}))}else{if(0==t.length)return this.editForm.replaceTagCommentStr="",this.$message.warning(this.$t("attribute.currentlyOperationalDataSource"));this.$http.put("/info/taginfo/update.do",t).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);e.$message.success(e.$t("prompt.success")),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList()}))}}else if("assistpararm"==this.editForm.type||"taginitvalue"==this.editForm.type){if(!this.$hasPermission("taginfo:update:permission.do"))return void this.$message.warning("暂无设备批量修改权限, 请联系管理员");this.$refs["editForm"].validate((function(a){if(!a)return!1;e.$http.put("/info/taginfo/update.do",t).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);e.$message.success(a.msg),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList()}))}))}else if("tagname"===this.editForm.type){if(!this.$hasPermission("taginfo:update:permission.do"))return void this.$message.warning("暂无设备批量修改权限, 请联系管理员");this.$refs["editForm"].validate((function(a){if(!a)return!1;e.$http.post("/info/taginfo/BatchUpdate",t).then((function(t){var a=t.data;if("OK"!==a.msg)return e.$message.error(a.data||a.msg);e.$message.success(a.data||a.msg),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList()}))}))}else{if(!this.$hasPermission("taginfo:update:permission.do"))return void this.$message.warning("暂无设备批量修改权限, 请联系管理员");this.$refs["editForm"].validate((function(a){if(!a)return!1;e.$http.put("/info/taginfo/update.do",t).then((function(t){var a=t.data;if(0!==a.code)return e.$message.error(a.data||a.msg);e.$message.success(a.msg),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList()}))}))}else{var M,U=[],W=L(t);try{for(W.s();!(M=W.n()).done;){var z=M.value;U.push(z.tagId)}}catch(H){W.e(H)}finally{W.f()}var B={gwsn:sessionStorage.getItem("gwsn"),ids:U.join(",")};if(!this.$hasPermission("tagassist:select:permission.do"))return void this.$message.warning("暂无测点辅助参数查询权限, 请联系管理员");this.$http.post("/tagassist/select.do",o.a.stringify(B)).then((function(a){var i=a.data;if(0!=i.code)return e.$message.error(i.data||i.msg);var r=[],s=[],n=[];if(i.data.length>0){i.data.forEach((function(e){r.push(e.tagId),n.push(e.id)})),s=e.getArrDifference(r,U);var l=[],o=[];if(t.forEach((function(e){r.forEach((function(t,a){e.tagId==t&&o.push(y(y({},e),{id:n[a]}))}))})),t.forEach((function(e){s.forEach((function(t){e.tagId==t&&l.push(e)}))})),!e.$hasPermission("tagassist:update:permission.do"))return void e.$message.warning("暂无测点辅助参数修改权限, 请联系管理员");e.$http.post("/tagassist/update.do",o).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);if(l.length>0){if(!e.$hasPermission("tagassist:insert:permission.do"))return void e.$message.warning("暂无测点辅助参数新增权限, 请联系管理员");e.$http.post("/tagassist/insert.do",l).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);e.$message.success(e.$t("prompt.success")),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList()}))}else e.$message.success(a.data),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList()}))}else{if(!e.$hasPermission("tagassist:insert:permission.do"))return void e.$message.warning("暂无测点辅助参数新增权限, 请联系管理员");e.$http.post("/tagassist/insert.do",t).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);e.$message.success(a.data),e.editAllVisible=!1,e.getDataList()})).catch((function(t){return e.editAllVisible=!1,e.getDataList()}))}})).catch((function(t){return e.editAllVisible=!1,e.getDataList()}))}}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),beforeUploadHandle:function(e){var t=e.size/1024/1024<65;return t||this.$message.error(this.$t("attribute.uploadFileLimitExceeded")),t},handleChange:function(e,t){},handleRemove:function(e,t){this.fileList=[]},uploadSectionFile:function(e,t){this.getTreeList(),this.fileParams=null,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==e.file.type||"application/vnd.ms-excel"==e.file.type||-1!=e.file.name.indexOf(".xlsx")||-1!=e.file.name.indexOf(".xls")?(this.fileParams=e.file,this.tagVisible=!0):(this.$message.warning(this.$t("attribute.errorType")),this.handleRemove())},handleCancel:function(){this.importForm.deviceId="",this.fileList=[],this.tagVisible=!1},tagListConfirm:function(){var e=this;if(this.$hasSessionStorageGwsn()){if(!this.importForm.deviceId)return this.$message.info(this.$t("attribute.selectImportevice"));-1!=this.importForm.deviceId.indexOf(",")?(this.importForm.typeid=1,this.file=new FormData,this.file.append("file",this.fileParams),this.file.append("tagsource",0),this.file.append("gwsn",sessionStorage.getItem("gwsn")),this.file.append("typeid",this.importForm.typeid),this.file.append("devid",this.importForm.deviceId),this.file.append("devType",this.importForm.devType),this.tagVisible=!1,this.importfile(this.file)):(this.confirmVisible=!0,this.content=this.$t("attribute.importContent"))}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},clickCancel:function(){this.importForm.deviceId="",this.fileList=[],this.tagVisible=!1,this.confirmVisible=!1},clickConfirm:function(){var e=this;this.$hasSessionStorageGwsn()?(this.tagVisible=!1,this.confirmVisible=!1,this.importForm.typeid=1,this.file=new FormData,this.file.append("file",this.fileParams),this.file.append("tagsource",0),this.file.append("gwsn",sessionStorage.getItem("gwsn")),this.file.append("typeid",this.importForm.typeid),this.file.append("devid",this.importForm.deviceId),this.file.append("devType",this.importForm.devType),this.importfile(this.file)):this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},clickConfirmnodAdd:function(){var e=this;this.$hasSessionStorageGwsn()?(this.tagVisible=!1,this.confirmVisible=!1,this.importForm.typeid=0,this.file=new FormData,this.file.append("file",this.fileParams),this.file.append("tagsource",0),this.file.append("gwsn",sessionStorage.getItem("gwsn")),this.file.append("typeid",this.importForm.typeid),this.file.append("devid",this.importForm.deviceId),this.file.append("devType",this.importForm.devType),this.importfile(this.file)):this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},importfile:h()((function(e){var t=this;this.$hasPermission("taginfo:import:permission.do")?this.$http.post("/info/taginfo/import.do",e).then((function(e){var a=e.data;if(0!=a.code)return t.importForm.deviceId="",t.$message.error(a.data||a.msg),t.confirmVisible=!1,t.$message.error(a.data||a.msg),!1;t.importForm.deviceId="",t.$message.success(a.data||a.msg),t.confirmVisible=!1,t.getDataList(),t.handleRemove()})).catch((function(e){return t.confirmVisible=!1,t.importForm.deviceId="",t.getDataList()})):this.$message.warning("暂无测点导入权限, 请联系管理员")}),1e3,{leading:!0,trailing:!1}),getprotocolinfoList:function(){var e=this;e.$hasPermission("protocolinfo:select:permission.do")?e.$http.get("/info/protocolinfo/proGuidAll",{params:{attribute:0}}).then((function(t){var a=t.data;if(0!==a.code)return e.$message.error(a.data||a.msg);e.guidList=a.data,e.getChlList()})).catch((function(e){return!1})):e.$message.warning("暂无协议查询权限, 请联系管理员")},handleTagsToDeviceChange:function(){this.$hasPermission("channelinfo:updateTagDevId:permission.do")?(this.mergeTagsToDeviceForm.devId="",this.mergeTagsToDeviceForm.tagIds=[],this.mergeTagsList=[],this.mergeTargetDeviceList=[],this.getMergeDeviceList()):this.$message.warning("暂无测点移动权限, 请联系管理员")},handleTagNameOrVisibleChange:function(e){var t=this;e&&this.$nextTick((function(){t.$refs.tagNameOrDescInput.focus()}))},handleTagScroll:function(){this.mergeTagsList.length<this.mergeTagTotal&&(this.mergeTagPage++,this.handleMergeDevIdChanage(this.mergeTagsToDeviceForm.devId))},handleMergeTagsToDeviceClose:function(){this.tagNameOrDescSearch="",this.mergeTagsList=[],this.$refs.mergeTagsToDeviceForm.resetFields(),this.mergeTagsToDeviceVisible=!1},handleMergeDevIdChanage:function(e){var t=this;if(this.$hasSessionStorageGwsn()){if(e){if(!this.$hasPermission("taginfo:select:permission.do"))return void this.$message.warning("暂无测点查询权限, 请联系管理员");var a={page:this.mergeTagPage,limit:100,sort:"id asc",gwsn:sessionStorage.getItem("gwsn")};this.tagNameOrDescSearch&&(a["sname"]=this.tagNameOrDescSearch.replace(/_/g,"\\_").replace(/%/g,"\\%")),this.$http.get("/info/taginfo/selectTags.do",{params:a}).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);if(1==t.mergeTagPage&&(t.mergeTagsList=[]),t.mergeTagsList=t.mergeTagsList.concat(a.data.rows),t.mergeTagTotal=Number(a.data.total),0==t.mergeTagsList.length)t.mergeTagsToDeviceForm.tagIds=[];else if(t.mergeTagsToDeviceForm.tagIds.length>0){var i=[];t.mergeTagsToDeviceForm.tagIds=t.mergeTagsToDeviceForm.tagIds.filter((function(e){return"all"!=e}));for(var r=t.mergeTagsList.length-1;r>=0;r--)t.mergeTagsToDeviceForm.tagIds.includes(t.mergeTagsList[r].tagID)&&i.push(t.mergeTagsList[r].tagID);t.mergeTagsToDeviceForm.tagIds=i,t.mergeTagsToDeviceForm.tagIds.length==t.mergeTagsList.length&&t.mergeTagsToDeviceForm.tagIds.unshift("all")}else t.mergeTagsToDeviceForm.tagIds=[]}))}}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}})},getMergeDeviceList:function(){var e=this;if(this.$hasSessionStorageGwsn()){var t={gwsn:sessionStorage.getItem("gwsn")};if(this.mergeTagsToDeviceVisible=!1,!this.$hasPermission("list:getChlList:select:permission.do"))return void this.$message.warning("暂无通道查询权限, 请联系管理员");if(!this.$hasPermission("list:getTagList:select:permission.do"))return void this.$message.warning("暂无测点查询权限, 请联系管理员");this.$http.get("/list/getChlList.do",{params:t}).then((function(t){var a=t.data;return 0!=a.code?e.$message.error(a.data||a.msg):a.data.length>0?void a.data.forEach((function(t){if(0==t.chlType&&t.chlID==e.dataForm.chlname&&t.hasOwnProperty("dev2PojoList")){if(!(t.dev2PojoList.length>1))return e.$message.warning(e.$t("attribute.currentlyNoTargetDevicesToMove"));e.mergeTargetDeviceList=t.dev2PojoList,e.mergeTagIdList.length>0||(e.mergeTagsToDeviceForm.tagIds=[],e.mergeTagsToDeviceVisible=!0)}})):e.$message.warning(e.$t("attribute.currentlyNoTargetDevicesToMove"))}))}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},selectAllPrepareTag:function(){var e=this;this.mergeTagsToDeviceForm.tagIds.length<this.mergeTagsList.length?(this.mergeTagsToDeviceForm.tagIds=[],this.mergeTagsList.forEach((function(t){e.mergeTagsToDeviceForm.tagIds.push(t.tagID)})),this.mergeTagsToDeviceForm.tagIds.unshift("all")):this.mergeTagsToDeviceForm.tagIds=[]},handleMergeTagNameOrDescChange:function(e){},handleMergeTagsToDeviceSubmit:h()((function(){var e=this,t={sn:sessionStorage.getItem("gwsn"),devId:e.mergeTagsToDeviceForm.devId,type:0,tagIds:"",chlId:e.dataForm.chlname};e.$hasSessionStorageGwsn()?e.$refs["mergeTagsToDeviceForm"].validate((function(a){if(!a)return!1;if(e.mergeTagsToDeviceForm.tagIds.includes("all")){var i=JSON.parse(JSON.stringify(e.mergeTagsToDeviceForm.tagIds));i.splice(i.findIndex((function(e){return"all"===e})),1),t["tagIds"]=i.join(",")}else t["tagIds"]=e.mergeTagsToDeviceForm.tagIds.join(",");if(!t["tagIds"])return e.$message.warning(e.$t("configuration.thereAreCurrentlyNoMergingMeasurementPointsAvailable"));e.$hasPermission("channelinfo:updateTagDevId:permission.do")?e.$confirm(e.$t("configuration.areYouSureYouWantToMoveTheseMeasurementPointsToThisDevice"),e.$t("deleteInfo.noticePrompt"),{confirmButtonText:e.$t("deleteInfo.confirm"),cancelButtonText:e.$t("deleteInfo.cancel"),type:"warning"}).then((function(){e.mergeTagsToDeviceFormloading=!0,e.$http.get("/info/channelinfo/updateTagDevId.do",{params:t}).then((function(t){var a=t.data;if(0!=a.code)return e.mergeTagsToDeviceFormloading=!1,e.$message.error(a.data||a.msg);e.$message.success(e.$t("prompt.success")),e.mergeTagsToDeviceFormloading=!1,e.handleMergeTagsToDeviceClose(),e.getDataList()})).catch((function(t){return e.mergeTagsToDeviceFormloading=!1,!1}))})).catch((function(e){})):e.$message.warning("暂无测点移动权限, 请联系管理员")})):e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),handleExportTagChange:function(){var e=this,t={gwsn:sessionStorage.getItem("gwsn"),chlId:e.dataForm.chlname,tagIds:e.mergeTagIdList.join(","),sort:"objaddr"==e.sname?"a."+e.sname+"+0 "+e.sort:"a."+e.sname+" "+this.sort};if(e.$hasSessionStorageGwsn()){if(!e.$hasPermission("taginfo:exports:permission.do"))return void e.$message.warning("暂无测点导出权限, 请联系管理员");e.dataListLoading=!0,e.dataForm.devname&&(t["devIds"]=e.dataForm.devname),c()({url:"".concat(window.SITE_CONFIG["apiURL"],"/info/taginfo/exports.do"),method:"post",data:o.a.stringify(t),responseType:"blob",headers:{token:m.a.get("token")}}).then((function(t){if(e.dataListLoading=!1,t.data){var a=window.URL.createObjectURL(new Blob([t.data])),i=document.createElement("a");return i.href=a,i.setAttribute("download",(new Date).getTime()+".xls"),document.body.appendChild(i),i.click(),e.$message.success(e.$t("exportData.exportSuccess"))}})).catch((function(t){return e.dataListLoading=!1,e.$message.error(e.$t("exportData.exportError"))}))}else e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},watchTagSearch:h()((function(){var e=document.getElementsByClassName("el-scrollbar__wrap").length;document.getElementsByClassName("el-scrollbar__wrap")[e-1].scrollTo(0,0),this.mergeTagPage=1,this.handleMergeDevIdChanage(this.mergeTagsToDeviceForm.devId),this.$refs.tagNameOrDescInput.focus()}),500)},created:function(){this.page=Number(sessionStorage.getItem("page2"))||1,this.limit=Number(sessionStorage.getItem("limit2"))||1e3},mounted:function(){var e=this;e.isShowSetting=0!=sessionStorage.getItem("per"),e.$erd.listenTo(document.getElementById("tagQueryContainer"),(function(t){var a=document.getElementById("tagQueryContainer").offsetHeight;e.scrollTableHeight=window.innerHeight-130-a})),e.queryParams=e.$route.query,e.getprotocolinfoList(),window.onresize=function(){return function(){var t=document.getElementById("tagQueryContainer").offsetHeight;e.scrollTableHeight=window.innerHeight-130-t}()}},watch:{total:function(){this.total==(this.page-1)*this.limit&&0!=this.total&&(this.page-=1,sessionStorage.setItem("page2",this.page),this.getDataList())},page:function(){this.currentPageCheccked=!1},multipleSelectionAll:function(){0!=this.multipleSelectionAll.length&&this.multipleSelectionAll.length==this.dataList.length||(this.currentPageCheccked=!1)},dataList:{handler:function(e){this.allCheck&&(this.$set(this.checkboxConfig,"checkStrictly",!1),this.$refs.recordTable&&this.$refs.recordTable.setAllCheckboxRow(!0),this.$set(this.checkboxConfig,"checkStrictly",!0))},deep:!0},$route:function(e,t){"/taginfo"===e.path&&(this.queryParams={})},tagNameOrDescSearch:function(e,t){this.watchTagSearch()}}},T=F,S=(a("4898"),a("2877")),C=Object(S["a"])(T,i,r,!1,null,"3d0c19ee",null);t["default"]=C.exports},9689:function(e,t,a){},e1a5:function(e,t,a){"use strict";a("ac4d"),a("8a81"),a("5df3"),a("1c4c"),a("7f7f"),a("6b54"),a("8e6e"),a("ac6a"),a("456d"),a("4917"),a("6762"),a("2fdb"),a("a481");var i=a("ade3"),r=a("a78e"),s=a.n(r),n=a("4328"),l=a.n(n),o=a("b047"),d=a.n(o);function c(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=g(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,n=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return n=e.done,e},e:function(e){l=!0,s=e},f:function(){try{n||null==a.return||a.return()}finally{if(l)throw s}}}}function g(e,t){if(e){if("string"==typeof e)return m(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,i=Array(t);a<t;a++)i[a]=e[a];return i}function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function h(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var p=["/channelinfo","/deviceinfo","/taginfo","/transchannelinfo","/transdeviceinfo","/transtaginfo","/centervar","/scriptinfo","/integralmodule"];t["a"]={data:function(){return{ids:"",exportIds:null,mixinViewModuleOptions:{activatedIsNeed:!0,getDataListURL:"",getDataListIsPage:!1,deleteURL:"",deleteIsBatch:!1,deleteIsBatchKey:"id",exportURL:""},dataForm:{},dataList:[],order:"",orderField:"",page:1,limit:20,total:0,dataListLoading:!1,dataListSelections:[],addOrUpdateVisible:!1,storeselection:[]}},activated:function(){this.mixinViewModuleOptions.activatedIsNeed&&this.getDataList()},methods:{getDataList:function(){var e=this;this.dataListLoading=!0,this.$http.get(this.mixinViewModuleOptions.getDataListURL,{params:h({order:this.order,orderField:this.orderField,page:this.mixinViewModuleOptions.getDataListIsPage?this.page:null,limit:this.mixinViewModuleOptions.getDataListIsPage?this.limit:null},this.dataForm)}).then((function(t){var a=t.data;if(e.dataListLoading=!1,0!==a.code)return e.dataList=[],e.total=0,e.$message.error(a.msg);e.dataList=(e.mixinViewModuleOptions.getDataListIsPage,Array.isArray(a.data)?a.data:a.data.list),e.total=e.mixinViewModuleOptions.getDataListIsPage?a.data.total:0})).catch((function(t){return e.dataListLoading=!1,!1}))},dataListSelectionChangeHandle:function(e){this.storeselection=[],this.dataListSelections=e;var t,a=c(this.dataListSelections);try{for(a.s();!(t=a.n()).done;){var i=t.value;this.storeselection.push(i.id)}}catch(r){a.e(r)}finally{a.f()}this.ids=this.storeselection.join(","),this.$store.dispatch("changeIds",this.ids)},dataListSortChangeHandle:function(e){if(!e.order||!e.prop)return this.order="",this.orderField="",!1;this.order=e.order.replace(/ending$/,""),this.orderField=e.prop.replace(/([A-Z])/g,"_$1").toLowerCase(),this.getDataList()},pageSizeChangeHandle:function(e){this.page=1,this.limit=e,this.getDataList()},pageCurrentChangeHandle:function(e){this.page=e,this.getDataList()},addOrUpdateHandle:function(e){var t=this,a=!1;p.forEach((function(e){window.location.href.includes(e)&&(a=!0)})),a?this.$hasSessionStorageGwsn()?(this.addOrUpdateVisible=!0,this.$nextTick((function(){t.$refs.addOrUpdate.dataForm.id=e,t.$refs.addOrUpdate.init()}))):this.$message({showClose:!1,message:"未获取到网关编号",type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}}):(this.addOrUpdateVisible=!0,this.$nextTick((function(){t.$refs.addOrUpdate.dataForm.id=e,t.$refs.addOrUpdate.init()})))},deleteHandle:d()((function(e){var t=this;if(this.mixinViewModuleOptions.deleteIsBatch&&!e&&this.dataListSelections.length<=0)return this.$message.warning(this.$t("prompt.deleteBatch"));this.$confirm(this.$t("prompt.info",{handle:this.$t("delete")}),this.$t("prompt.title"),{confirmButtonText:this.$t("confirm"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((function(){t.dataListLoading=!0,t.$http.delete("".concat(t.mixinViewModuleOptions.deleteURL).concat(t.mixinViewModuleOptions.deleteIsBatch?"":"/"+e),t.mixinViewModuleOptions.deleteIsBatch?{data:e?[e]:t.dataListSelections.map((function(e){return e[t.mixinViewModuleOptions.deleteIsBatchKey]}))}:{}).then((function(e){var a=e.data;if(0!==a.code)return t.dataListLoading=!1,t.$message.error(a.msg);t.$message({message:t.$t("prompt.success"),type:"success",duration:500,onClose:function(){t.getDataList()}})})).catch((function(e){return t.dataListLoading=!1,!1}))})).catch((function(e){}))}),1e3,{leading:!0,trailing:!1}),postExcelFile:function(e,t){var a=document.createElement("form");for(var i in a.style.display="none",a.action=t,a.method="post",document.body.appendChild(a),e){var r=document.createElement("input");r.type="hidden",r.name=i,r.value=e[i],a.appendChild(r)}a.submit(),a.remove()},exportHandle:d()((function(){var e=!1,t={token:s.a.get("token"),ids:null};if(this.exportIds&&(t.ids=this.exportIds,e=!0),this.ids&&(t.ids=this.ids,e=!0),"/info/taginfo/exports"==this.mixinViewModuleOptions.exportURL||"/info/transtaginfo/exportss"==this.mixinViewModuleOptions.exportURL)return t.ids=this.exportIds,"/info/taginfo/exports"==this.mixinViewModuleOptions.exportURL&&-1!=window.location.href.indexOf("/taginfo")&&(t.devtype=window.devTagType),this.$message.success(this.$t("exportData.exportSuccess")),this.postExcelFile(t,"".concat(window.SITE_CONFIG["apiURL"]).concat(this.mixinViewModuleOptions.exportURL));"/sys/log/login/export"!=this.mixinViewModuleOptions.exportURL&&"/sys/log/operation/export"!=this.mixinViewModuleOptions.exportURL&&"/sys/log/error/export"!=this.mixinViewModuleOptions.exportURL||(e=!0);var a=l.a.stringify(t);if(!e)return this.$message.info(this.$t("exportData.noExportData"));var i=this,r="".concat(window.SITE_CONFIG["apiURL"]).concat(this.mixinViewModuleOptions.exportURL,"?").concat(a),n=new XMLHttpRequest;n.open("get",r),n.responseType="blob",n.send(),n.onreadystatechange=function(){if(4==n.readyState&&200==n.status){var e=i.browserType();if("ie"!==e.browser||"10.0"!=e.version&&"11.0"!=e.version)if("chrome"===e.browser){window.URL.createObjectURL(this.response),t=document.createElement("iframe");t.src="".concat(window.SITE_CONFIG["apiURL"]).concat(i.mixinViewModuleOptions.exportURL,"?").concat(a),t.style.display="none",document.body.appendChild(t)}else window.location.href="".concat(window.SITE_CONFIG["apiURL"]).concat(i.mixinViewModuleOptions.exportURL,"?").concat(a);else{window.URL.createObjectURL(this.response);var t=document.createElement("iframe");t.src="".concat(window.SITE_CONFIG["apiURL"]).concat(i.mixinViewModuleOptions.exportURL,"?").concat(a),t.style.display="none",document.body.appendChild(t)}return i.$message.success(i.$t("exportData.exportSuccess"))}}}),1e3,{leading:!0,trailing:!1}),browserType:function(){var e=navigator.userAgent.toLowerCase(),t={ie:function(){return!(!window.ActiveXObject&&!("ActiveXObject"in window))},edge:function(){return/dge/.test(e)},chrome:function(){return/chrome/.test(e)},safari:function(){return/safari/.test(e)&&!/chrome/.test(e)},opera:function(){return/opera/.test(e)},msie:function(){return/msie/.test(e)&&!/opera/.test(e)},mozilla:function(){return/mozilla/.test(e)&&!/(compatible|webkit)/.test(e)}},a={};for(var i in t){var r=t[i](),s=(e.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1];if(r)return a.browser=i,a.version=s,a}}}}}}]);
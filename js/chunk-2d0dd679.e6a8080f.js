(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0dd679"],{"80f1":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.visible,title:e.dataForm.id?e.$t("update"):e.$t("add"),"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t}}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataForm",attrs:{model:e.dataForm,rules:e.rules,"label-width":"150px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dataFormSubmitHandle()}}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"fileName",label:e.$t("template.filename")}},[t("el-input",{attrs:{placeholder:e.$t("template.filename"),maxlength:255,clearable:""},model:{value:e.dataForm.fileName,callback:function(t){e.$set(e.dataForm,"fileName","string"===typeof t?t.trim():t)},expression:"dataForm.fileName"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"fileType",label:e.$t("template.fileType")}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("template.pleaseSelect")},model:{value:e.dataForm.fileType,callback:function(t){e.$set(e.dataForm,"fileType",t)},expression:"dataForm.fileType"}},e._l(e.fileTypeList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"fileDesc",label:e.$t("template.fileDesc")}},[t("el-input",{attrs:{placeholder:e.$t("template.fileDesc"),maxlength:255,clearable:""},model:{value:e.dataForm.fileDesc,callback:function(t){e.$set(e.dataForm,"fileDesc",t)},expression:"dataForm.fileDesc"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"available",label:e.$t("template.available")}},[t("el-radio-group",{model:{value:e.dataForm.available,callback:function(t){e.$set(e.dataForm,"available",t)},expression:"dataForm.available"}},e._l(e.availableList,(function(a){return t("el-radio",{key:a.label,attrs:{label:a.value}},[e._v("\n                            "+e._s(a.label)+"\n                        ")])})),1)],1)],1)],1),e.dataForm.id?e._e():t("el-row",[t("el-form-item",[t("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:"","on-change":e.handleChange,"http-request":e.uploadSectionFile,"on-remove":e.handleRemove,"file-list":e.fileList,"before-upload":e.beforeUpload,multiple:""}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text",domProps:{innerHTML:e._s(e.$t("upload.text"))}})])],1)],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:e.handleClose}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmitHandle()}}},[e._v(e._s(e.$t("confirm")))])],1)],2)},i=[],r=(a("8e6e"),a("ac6a"),a("456d"),a("7f7f"),a("ade3")),o=a("b047"),s=a.n(o);function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,l)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){Object(r["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var f={data:function(){return{num:0,url:"",visible:!1,loading:!1,deptListVisible:!1,modelList:[],fileList:[],patchTargetList:[],file:{fileName:"",fileUrl:""},dataForm:{id:"",fileName:"",fileType:0,available:1,fileDesc:"",deptid:""},fileTypeList:[{label:this.$t("template.collectTemplate"),value:0},{label:this.$t("template.transTemplate"),value:1}],availableList:[{label:this.$t("template.yes"),value:1},{label:this.$t("template.no"),value:0}],rules:{fileName:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],fileVersion:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],patchTarget:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]}}},methods:{init:function(){var e=this;this.visible=!0,this.$nextTick((function(){e.$refs["dataForm"].resetFields(),e.dataForm.deptid=e.$store.state.user.deptId,e.fileList=[],e.dataForm.id&&e.getInfo()}))},getInfo:function(){var e=this;this.$hasPermission("gwtemplateinfo:select:permission.do")?(this.loading=!0,this.$http.get("/info/gwtemplateinfo/".concat(this.dataForm.id)).then((function(t){var a=t.data;if(a.hasOwnProperty("code")&&0!=a.code)return e.loading=!1,e.$message.error(a.data||a.msg);e.dataForm=d(d({},e.dataForm),a.data),e.loading=!1})).catch((function(t){return e.loading=!1,!1}))):this.$message.warning("暂无模板信息查询权限, 请联系管理员")},beforeUpload:function(e){if("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=e.type&&"application/vnd.ms-excel"!=e.type&&-1==e.name.indexOf(".xlsx")&&-1==e.name.indexOf(".xls"))return this.$message.error(this.$t("upload.tip",{format:"xlsx、xls"})),!1},handleChange:function(e,t){},handleRemove:function(e,t){this.fileList=[]},uploadSectionFile:function(e,t){this.loading=!0,this.fileList.push(e.file);var a=new FormData;multipartFile.append("multipartFile",e.file),this.importfile(a)},importfile:function(e){var t=this;this.$http.post("/goFastDfs/uploadFile.do",e).then((function(e){var a=e.data;0==a.code?(t.file.fileUrl=a.data,t.$message.success(t.$t("template.uploadSuccess")),t.loading=!1):(t.$message.error(a.data||t.$t("template.uploadError")),t.loading=!1,t.handleRemove())})).catch((function(e){return!1}))},handleClose:s()((function(){this.file.fileUrl="",this.fileList=[],this.visible=!1}),1e3,{leading:!0,trailing:!1}),dataFormSubmitHandle:s()((function(){var e=this,t={};this.$refs["dataForm"].validate((function(a){if(!a)return!1;if(e.dataForm.id){if(!e.$hasPermission("info:gwtemplateinfo:update"))return void e.$message.warning("暂无模板修改权限, 请联系管理员");t=e.dataForm}else{if(!e.file.fileUrl||0===e.fileList.length)return e.$message.info(e.$t("template.pleaseUploadFile"));if(!e.$hasPermission("info:gwtemplateinfo:save"))return void e.$message.warning("暂无模板新增权限, 请联系管理员");t={fileName:e.dataForm.fileName,fileType:e.dataForm.fileType,available:e.dataForm.available,fileDesc:e.dataForm.fileDesc,creator:e.$store.state.user.id,fileUrl:e.file.fileUrl,deptid:e.dataForm.deptid}}e.$http[e.dataForm.id?"put":"post"]("/info/gwtemplateinfo",t).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);e.$message.success(a.msg),e.visible=!1,e.$emit("refreshDataList")})).catch((function(t){return e.visible=!1,e.$emit("refreshDataList"),!1}))}))}),1e3,{leading:!0,trailing:!1})}},c=f,m=a("2877"),p=Object(m["a"])(c,l,i,!1,null,null,null);t["default"]=p.exports}}]);
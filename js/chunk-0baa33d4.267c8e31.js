(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0baa33d4"],{"2a1f":function(e,t,a){"use strict";a.r(t);a("34ef"),a("28a5"),a("6b54"),a("4917");
/*! @source http://purl.eligrey.com/github/Blob.js/blob/master/Blob.js */
(function(e){if(e.URL=e.URL||e.webkitURL,e.Blob&&e.URL)try{return void new Blob}catch(n){}var t=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||function(e){var t=function(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]},a=function(){this.data=[]},n=function(e,t,a){this.data=e,this.size=e.length,this.type=t,this.encoding=a},i=a.prototype,r=n.prototype,s=e.FileReaderSync,o=function(e){this.code=this[this.name=e]},l="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),c=l.length,h=e.URL||e.webkitURL||e,g=h.createObjectURL,d=h.revokeObjectURL,u=h,p=e.btoa,m=e.atob,f=e.ArrayBuffer,w=e.Uint8Array,b=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;n.fake=r.fake=!0;while(c--)o.prototype[l[c]]=c+1;return h.createObjectURL||(u=e.URL=function(e){var t,a=document.createElementNS("http://www.w3.org/1999/xhtml","a");return a.href=e,"origin"in a||("data:"===a.protocol.toLowerCase()?a.origin=null:(t=e.match(b),a.origin=t&&t[1])),a}),u.createObjectURL=function(e){var t,a=e.type;return null===a&&(a="application/octet-stream"),e instanceof n?(t="data:"+a,"base64"===e.encoding?t+";base64,"+e.data:"URI"===e.encoding?t+","+decodeURIComponent(e.data):p?t+";base64,"+p(e.data):t+","+encodeURIComponent(e.data)):g?g.call(h,e):void 0},u.revokeObjectURL=function(e){"data:"!==e.substring(0,5)&&d&&d.call(h,e)},i.append=function(e){var a=this.data;if(w&&(e instanceof f||e instanceof w)){for(var i="",r=new w(e),l=0,c=r.length;l<c;l++)i+=String.fromCharCode(r[l]);a.push(i)}else if("Blob"===t(e)||"File"===t(e)){if(!s)throw new o("NOT_READABLE_ERR");var h=new s;a.push(h.readAsBinaryString(e))}else e instanceof n?"base64"===e.encoding&&m?a.push(m(e.data)):"URI"===e.encoding?a.push(decodeURIComponent(e.data)):"raw"===e.encoding&&a.push(e.data):("string"!==typeof e&&(e+=""),a.push(unescape(encodeURIComponent(e))))},i.getBlob=function(e){return arguments.length||(e=null),new n(this.data.join(""),e,"raw")},i.toString=function(){return"[object BlobBuilder]"},r.slice=function(e,t,a){var i=arguments.length;return i<3&&(a=null),new n(this.data.slice(e,i>1?t:this.data.length),a,this.encoding)},r.toString=function(){return"[object Blob]"},r.close=function(){this.size=0,delete this.data},a}(e);e.Blob=function(e,a){var n=a&&a.type||"",i=new t;if(e)for(var r=0,s=e.length;r<s;r++)Uint8Array&&e[r]instanceof Uint8Array?i.append(e[r].buffer):i.append(e[r]);var o=i.getBlob(n);return!o.slice&&o.webkitSlice&&(o.slice=o.webkitSlice),o};var a=Object.getPrototypeOf||function(e){return e.__proto__};e.Blob.prototype=a(new e.Blob)})("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||void 0)},"2c9f":function(e,t,a){e.exports=a.p+"img/twosignal.b47d518f.png"},"376b":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));a("6b54"),a("34ef"),a("ac6a");function n(e,t){t&&(e+=1462);var a=Date.parse(e);return(a-new Date(Date.UTC(1899,11,30)))/864e5}function i(e,t){for(var a={},i={s:{c:1e7,r:1e7},e:{c:0,r:0}},r=0;r!=e.length;++r)for(var s=0;s!=e[r].length;++s){i.s.r>r&&(i.s.r=r),i.s.c>s&&(i.s.c=s),i.e.r<r&&(i.e.r=r),i.e.c<s&&(i.e.c=s);var o={v:e[r][s]};if(null!=o.v){var l=XLSX.utils.encode_cell({c:s,r:r});"number"===typeof o.v?o.t="n":"boolean"===typeof o.v?o.t="b":o.v instanceof Date?(o.t="n",o.z=XLSX.SSF._table[14],o.v=n(o.v)):o.t="s",a[l]=o}}return i.s.c<1e7&&(a["!ref"]=XLSX.utils.encode_range(i)),a}function r(){if(!(this instanceof r))return new r;this.SheetNames=[],this.Sheets={}}function s(e){for(var t=new ArrayBuffer(e.length),a=new Uint8Array(t),n=0;n!=e.length;++n)a[n]=255&e.charCodeAt(n);return t}function o(e,t,a){var n=t;n.unshift(e);for(var o="SheetJS",l=new r,c=i(n),h=n.map((function(e){return e.map((function(e){return null==e?{wch:10}:e.toString().charCodeAt(0)>255?{wch:2*e.toString().length+5}:{wch:e.toString().length+5}}))})),g=h[0],d=1;d<h.length;d++)for(var u=0;u<h[d].length;u++)g[u]["wch"]<h[d][u]["wch"]&&(g[u]["wch"]=h[d][u]["wch"]);c["!cols"]=g,l.SheetNames.push(o),l.Sheets[o]=c;var p=XLSX.write(l,{bookType:"xlsx",bookSST:!1,type:"binary"}),m=a||"列表";saveAs(new Blob([s(p)],{type:"application/octet-stream"}),m+".xlsx")}a("2a1f"),a("0fd4"),a("1447")},"3df3":function(e,t,a){"use strict";a.r(t);a("7f7f");var n=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"aui-card--fill",attrs:{shadow:"never"}},[t("el-form",{attrs:{inline:!0},nativeOn:{submit:function(e){e.preventDefault()},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.querySearch()}}},[t("el-form-item",{attrs:{label:e.$t("project.projectName")}},[t("el-select",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.handlePrjScroll,expression:"handlePrjScroll"}],attrs:{clearable:"",size:"small"},on:{"visible-change":e.handlePrjVisibleChange,change:e.handlePrjChange},model:{value:e.dataForm.name,callback:function(t){e.$set(e.dataForm,"name",t)},expression:"dataForm.name"}},[[t("div",{staticStyle:{width:"100%",position:"absolute",left:"0",top:"0","z-index":"99","background-color":"#fff"}},[t("el-input",{ref:"prjInput",staticStyle:{width:"98%","margin-left":"1%","margin-top":"5px","margin-bottom":"5px"},attrs:{size:"small",clearable:"",placeholder:e.$t("gwsn.pleaseEnterSearchContent")},model:{value:e.prjSearch,callback:function(t){e.prjSearch=t},expression:"prjSearch"}})],1),t("div",{staticStyle:{width:"100%",height:"42px"}}),e._l(e.projectName,(function(e){return t("el-option",{key:e.id,attrs:{label:e.prjName,value:e.id,disabled:!!e.hasOwnProperty("disabled")&&e.disabled}})}))]],2)],1),t("el-form-item",{attrs:{label:e.$t("historyQuery.gwsn")}},[t("el-select",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.handleGwsnScroll,expression:"handleGwsnScroll"}],attrs:{clearable:"",size:"small"},on:{"visible-change":e.handleGwsnVisibleChange,change:e.querySearch},model:{value:e.dataForm.gwsn,callback:function(t){e.$set(e.dataForm,"gwsn",t)},expression:"dataForm.gwsn"}},[[t("div",{staticStyle:{width:"100%",position:"absolute",left:"0",top:"0","z-index":"99","background-color":"#fff"}},[t("el-input",{ref:"gwsnInput",staticStyle:{width:"98%","margin-left":"1%","margin-top":"5px","margin-bottom":"5px"},attrs:{size:"small",clearable:"",placeholder:e.$t("gwsn.pleaseEnterSearchContent")},model:{value:e.gwsnSearch,callback:function(t){e.gwsnSearch=t},expression:"gwsnSearch"}})],1),t("div",{staticStyle:{width:"100%",height:"42px"}}),e._l(e.gwsnList,(function(a){return t("el-option",{key:a.sn,attrs:{label:a.sn,value:a.sn,disabled:!!a.hasOwnProperty("disabled")&&a.disabled}},[t("span",{staticStyle:{width:"calc(100%- 210px)",display:"inline-block","text-align":"left",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:a.sn}},[e._v("\n                            "+e._s(a.sn)+"\n                        ")]),t("span",{staticStyle:{color:"#8492a6","font-size":"13px",display:"inline-block","margin-left":"10px",width:"200px","text-align":"right",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:a.gwDesc}},[e._v("\n                            "+e._s(a.gwDesc||e.$t("historyQuery.no"))+"\n                        ")])])}))]],2)],1),t("el-form-item",[t("el-date-picker",{staticStyle:{width:"350px"},attrs:{size:"small",clearable:!1,type:"datetimerange","picker-options":e.pickerOptions,"range-separator":e.$t("historyQuery.to"),"start-placeholder":e.$t("historyQuery.startTime"),"end-placeholder":e.$t("historyQuery.endTime"),align:"right",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss"},on:{change:e.changeTime},model:{value:e.dataForm.createdate,callback:function(t){e.$set(e.dataForm,"createdate",t)},expression:"dataForm.createdate"}})],1),t("el-form-item",[t("el-button",{attrs:{size:"small",icon:"el-icon-search"},on:{click:e.querySearch}},[e._v(e._s(e.$t("query")))])],1),e.isChart?e._e():t("el-form-item",[t("el-button",{attrs:{type:"success",size:"small",icon:"el-icon-download",disabled:0==e.dataList.length},on:{click:e.exportExcel}},[e._v(e._s(e.$t("export"))+" ")])],1),t("el-form-item",[t("el-checkbox",{attrs:{size:"small"},on:{change:e.handleonLineChart},model:{value:e.isChart,callback:function(t){e.isChart=t},expression:"isChart"}},[e._v("\n                "+e._s(e.$t("historyQuery.chart"))+"\n            ")])],1)],1),e.isChart?t("div",[t("div",{ref:"onLineChart",style:{width:"100%",height:"700px"},attrs:{id:"onLineChart"}})]):t("div",[t("vxe-table",{ref:"recordTable",staticStyle:{width:"100%"},attrs:{size:"mini",border:"",resizable:"","auto-resize":"","show-overflow":"","show-header-overflow":"","highlight-hover-row":"","highlight-current-row":"","max-height":e.scrollTableHeight,loading:e.dataListLoading,"row-config":{keyField:"id"},"scroll-y":{enabled:!0}}},[t("vxe-table-column",{attrs:{field:"localTime",title:e.$t("gwsn.heartbeatTime"),"header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(-1!=String(a.row.localTime).indexOf("-")?a.row.localTime||"":e.timestampToTime(a.row.localTime)||""))])]}}],null,!1,1359042779)}),t("vxe-table-column",{attrs:{field:"sn",title:e.$t("gwsn.number"),"header-align":"center",align:"center","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.sn||e.$t("no")))])]}}],null,!1,136727595)}),t("vxe-table-column",{attrs:{field:"name",title:e.$t("gwsn.gwsnNote"),"header-align":"center",align:"center","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.name||e.$t("no")))])]}}],null,!1,305599601)}),t("vxe-table-column",{attrs:{field:"csq",title:e.$t("gwsn.signalValue"),"header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[n.row.csq?t("div",{staticStyle:{display:"flex","justify-content":"center","align-items":"center",height:"20px","line-height":"20px"}},[0==n.row.csq?t("img",{staticStyle:{width:"20px",height:"20px"},attrs:{src:a("a90d"),alt:""}}):e._e(),n.row.csq>0&&n.row.csq<10?t("img",{staticStyle:{width:"20px",height:"20px"},attrs:{src:a("cdf7"),alt:""}}):e._e(),n.row.csq>=10&&n.row.csq<15?t("img",{staticStyle:{width:"20px",height:"20px"},attrs:{src:a("2c9f"),alt:""}}):e._e(),n.row.csq>=15&&n.row.csq<20?t("img",{staticStyle:{width:"20px",height:"20px"},attrs:{src:a("f27f"),alt:""}}):e._e(),n.row.csq>=20&&n.row.csq<25?t("img",{staticStyle:{width:"20px",height:"20px"},attrs:{src:a("6a9e"),alt:""}}):e._e(),n.row.csq>=25&&n.row.csq<=40?t("img",{staticStyle:{width:"20px",height:"20px"},attrs:{src:a("ee58"),alt:""}}):e._e(),255==n.row.csq?t("img",{attrs:{src:a("e310"),alt:""}}):e._e(),t("span",{staticStyle:{"margin-left":"5px",display:"inline-block"}},[e._v(e._s(255==n.row.csq?e.$t("gwsn.internet"):n.row.csq))])]):t("div")]}}],null,!1,972304817)}),t("vxe-table-column",{attrs:{field:"softVer",title:e.$t("gwsn.gwsnsoftV"),"header-align":"center",align:"center","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.softVer&&a.row.softVer||"--"))])]}}],null,!1,1320736707)})],1),t("vxe-pager",{attrs:{perfect:"",size:"mini","current-page":e.page,"page-size":e.limit,"page-sizes":[100,200,500,1e3],total:e.total,layouts:["PrevPage","JumpNumber","NextPage","FullJump","Sizes","Total"]},on:{"page-change":e.handlePageChange}})],1)],1)},i=[],r=(a("96cf"),a("1da1")),s=a("53ca"),o=(a("ac6a"),a("c5f6"),a("a481"),a("4328")),l=a.n(o),c=a("a78e"),h=a.n(c),g=a("b047"),d=a.n(g),u=a("376b"),p={name:"tgwonline",directives:{loadmore:{inserted:function(e,t){var a=e.querySelector(".el-select-dropdown .el-select-dropdown__wrap");a.addEventListener("scroll",(function(){var e=this.scrollHeight-Math.ceil(this.scrollTop)<=this.clientHeight;e&&0!==this.scrollTop&&t.value()}))}}},data:function(){var e=this;return{prjPage:1,prjTotal:0,gwsnPage:1,gwsnTotal:0,page:1,limit:1e3,total:0,bar_dv:null,scrollTop:0,scrollLeft:0,isChart:!0,startTime:"",endTime:"",dataListLoading:!1,pickerMinDate:"",dataForm:{name:"",gwsn:"",createdate:[]},scrollTableHeight:window.innerHeight-220-53,prjSearch:"",gwsnSearch:"",projectName:[],gwsnList:[],dataList:[],allDataList:[],date:[],chartData:[],pickerOptions:{onPick:function(t){var a=t.maxDate,n=t.minDate;e.pickerMinDate=n.getTime(),a&&(e.pickerMinDate="")},disabledDate:function(t){if(""!=e.pickerMinDate){var a=2592e6,n=e.pickerMinDate-a,i=e.pickerMinDate+a;return t.getTime()<n||t.getTime()>i}return t.getTime()>Date.now()},shortcuts:[{text:this.$t("lastDay"),onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-864e5),e.$emit("pick",[a,t])}},{text:this.$t("lastWeek"),onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:this.$t("lastMonth"),onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}}]}}},methods:{pageSizeChangeHandle:function(e){this.page=1,this.limit=e,this.scrollTableHeight=window.innerHeight-220-53,this.historyList()},pageCurrentChangeHandle:function(e){this.page=e,this.historyList()},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.page=t,this.limit=a,this.historyList()},getPrjNameList:function(){var e=this,t={page:e.prjPage,limit:50,priName:e.prjSearch.replace(/\s+/g,""),_t:(new Date).getTime()};e.$hasPermission("tprjinfo:list:select")?e.$http.get("/info/tprjinfo/tprjinfoList",{params:t}).then((function(t){var a=t.data;if(a.hasOwnProperty("code")&&0!=a.code)return e.$message.error(a.data||a.msg);1==e.prjPage?e.projectName=a.list:e.projectName=e.projectName.concat(a.list),0==e.projectName.length&&e.projectName.push({id:e.$t("noMatchingDataYet"),prjName:e.$t("noMatchingDataYet"),disabled:!0}),e.prjTotal=Number(a.total)})).catch((function(e){return!1})):e.$message.warning("暂无项目查询权限, 请联系管理员")},handlePrjChange:function(){this.gwsnPage=1,this.dataForm.name&&(this.dataForm.gwsn="",this.total=0,this.dataList=[],this.date=[],this.chartData=[],this.querySearch()),this.getAllGwsnDataList()},getAllGwsnDataList:function(){var e=this,t={pageNum:e.gwsnPage,pageSize:200,prjId:e.dataForm.name,fuzzy:e.gwsnSearch,_t:(new Date).getTime()};e.$hasPermission("gwbaseinfo:select:permission.do")?e.$http.post("/info/gwbaseinfo/selectByPage.do",l.a.stringify(t)).then((function(t){var a=t.data;if(a.hasOwnProperty("code")&&0!=a.code)return e.$message.error(a.data||a.msg);1==e.gwsnPage?e.gwsnList=a.data.list:e.gwsnList=e.gwsnList.concat(a.data.list),0==e.gwsnList.length&&e.gwsnList.push({sn:e.$t("noMatchingDataYet"),gwDesc:e.$t("noMatchingDataYet"),disabled:!0}),e.gwsnTotal=Number(a.data.total)})).catch((function(e){return!1})):e.$message.warning("暂无网关查询权限, 请联系管理员")},handlePrjVisibleChange:function(e){var t=this;e&&this.$nextTick((function(){t.$refs.prjInput.focus()}))},handleGwsnVisibleChange:function(e){var t=this;e&&this.$nextTick((function(){t.$refs.gwsnInput.focus()}))},selectGwsn:function(e){this.date=[],this.chartData=[],this.querySearch()},resetExcelData:function(e,t){var a=this,n=[];e.forEach((function(e){var t={localTime:a.timestampToTime(e.localTime)||"",gwsn:a.dataForm.gwsn||"--",name:e.name||a.$t("none"),csq:e.csq||"--",model:e.model||a.$t("none"),softVer:e.softVer||a.$t("none"),iccid:e.iccid||"--",mac:e.mac||"--",oper:e.oper||"--",imei:e.imei||"--",odel:e.odel||"--"};n.push(t)})),t(n)},exportExcel:d()((function(){var e=this,t=[];if(!e.dataForm.gwsn)return e.$message.error(e.$t("historyQuery.pleaseSelectGwsn"));if(new Date(e.endTime).getTime()-new Date(e.startTime).getTime()>2592e6)return e.$message.warning(e.$t("pleaseSelectMonthDate")+"!!!");if(e.$hasPermission("heartMongod:select:permission.do")){var n=new XMLHttpRequest;n.open("POST",window.SITE_CONFIG["apiURL"]+"/heartMongod/getheartdata3"),n.setRequestHeader("Content-type","application/json; charset=utf-8"),n.setRequestHeader("token",h.a.get("token"));var i={gwsn:e.dataForm.gwsn,startTime:e.startTime,endTime:e.endTime};n.send(JSON.stringify(i)),n.onreadystatechange=function(){if(4==n.readyState&&200==n.status){var i=JSON.parse(n.responseText);if(i.hasOwnProperty("code")&&0!=i.code)return e.dataListLoading=!1,e.$message.error(i.data||i.msg);t=i.reverse(),Promise.resolve().then(function(){e.resetExcelData(t,(function(t){for(var a=[{label:e.$t("gwsn.heartbeatTime"),prop:"localTime"},{label:e.$t("gwsn.number"),prop:"gwsn"},{label:e.$t("gwsn.gwsnNote"),prop:"name"},{label:e.$t("gwsn.signalValue"),prop:"csq"},{label:e.$t("gwsn.gwsnModel"),prop:"model"},{label:e.$t("gwsn.gwsnsoftV"),prop:"softVer"},{label:"ICCID",prop:"iccid"},{label:"MAC",prop:"mac"},{label:e.$t("gwsnSetting.operators"),prop:"oper"},{label:"IMEI",prop:"imei"},{label:e.$t("gwsn.moduleType"),prop:"odel"}],n=[],i=[],r=0;r<a.length;r++)n[r]=a[r].label,i[r]=a[r].prop;var s=n,o=i,l=t,c=e.formatJson(o,l);Object(u["a"])(s,c,e.$t("gatewayOnlineLog")+e.dataForm.gwsn+"_"+(new Date).getTime())}))}.bind(null,a)).catch(a.oe)}}}else e.$message.warning("暂无网关上线日志查询权限, 请联系管理员")}),1e3,{leading:!0,trailing:!1}),formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))})),t.map((function(t){return e.map((function(e){return t[e]}))}))},querySearch:function(){this.isChart?this.getAllHeartData():this.historyList()},historyList:d()((function(){var e=this;if(e.dataList=[],!e.dataForm.gwsn)return e.$message.warning(e.$t("historyQuery.pleaseSelectGwsn"));if(new Date(e.endTime).getTime()-new Date(e.startTime).getTime()>2592e6)return e.$message.warning(e.$t("pleaseSelectMonthDate")+"!!!");if(e.$hasPermission("heartMongod:select:permission.do")){var t=new XMLHttpRequest;t.open("POST",window.SITE_CONFIG["apiURL"]+"/heartMongod/getheartdata2"),t.setRequestHeader("Content-type","application/json; charset=utf-8"),t.setRequestHeader("token",h.a.get("token"));var a={pageSize:e.limit,pageNumber:e.page,gwsn:e.dataForm.gwsn,startTime:e.startTime,endTime:e.endTime};t.send(JSON.stringify(a)),e.dataListLoading=!0,t.onreadystatechange=function(){if(4==t.readyState&&200==t.status){var n=JSON.parse(t.responseText);if(n.hasOwnProperty("code")&&0!=n.code)return e.dataListLoading=!1,e.$message.error(n.data||n.msg);e.getTotalCount(),e.dataListLoading=!1,e.dataList=JSON.parse(t.responseText),e.page=a.pageNumber,e.$refs.recordTable.loadData(e.dataList).then((function(){e.dataListLoading=!1})).finally((function(){return!1}))}else e.dataListLoading=!1}}else e.$message.warning("暂无网关上线日志查询权限, 请联系管理员")}),1e3,{leading:!0,trailing:!1}),getTotalCount:function(){var e=this,t=new XMLHttpRequest;if(e.$hasPermission("heartMongod:select:permission.do")){t.open("POST",window.SITE_CONFIG["apiURL"]+"/heartMongod/getheartcount"),t.setRequestHeader("Content-type","application/json; charset=utf-8"),t.setRequestHeader("token",h.a.get("token"));var a={gwsn:e.dataForm.gwsn,startTime:e.startTime,endTime:e.endTime};t.send(JSON.stringify(a)),t.onreadystatechange=function(){4==t.readyState&&200==t.status&&(e.total="object"===Object(s["a"])(JSON.parse(t.responseText))?0:Number(JSON.parse(t.responseText)))}}else e.$message.warning("暂无网关上线日志查询权限, 请联系管理员")},getAllHeartData:function(){var e=this;if(e.dataList=[],!e.dataForm.gwsn)return e.clearHistoryMonitor(),e.$message.warning(e.$t("historyQuery.pleaseSelectGwsn"));if(new Date(e.endTime).getTime()-new Date(e.startTime).getTime()>2592e6)return e.$message.warning(e.$t("pleaseSelectMonthDate")+"!!!");if(e.$hasPermission("heartMongod:select:permission.do")){var t=new XMLHttpRequest;t.open("POST",window.SITE_CONFIG["apiURL"]+"/heartMongod/getheartdata3"),t.setRequestHeader("Content-type","application/json; charset=utf-8"),t.setRequestHeader("token",h.a.get("token"));var a={gwsn:e.dataForm.gwsn,startTime:e.startTime,endTime:e.endTime};t.send(JSON.stringify(a)),e.dataListLoading=!0,t.onreadystatechange=function(){if(4==t.readyState&&200==t.status){var a=JSON.parse(t.responseText);if(a.hasOwnProperty("code")&&0!=a.code)return e.$message.error(a.data||a.msg);e.allDataList=a,e.isChart&&e.getChartDataSource()}}}else e.$message.warning("暂无网关上线日志查询权限, 请联系管理员")},getChartDataSource:function(){var e=this;if(e.date=[],e.chartData=[],e.allDataList.length>0)for(var t=0;t<e.allDataList.length;t++){var a=e.allDataList[t];e.date.push(e.timestampToTime(a.localTime)),e.chartData.push(a.csq)}e.$nextTick((function(){e.historyMonitor()}))},changeTime:function(e){e?(this.startTime=e[0],this.endTime=e[1]):(this.startTime="",this.endTime="")},timestampToTime:function(e){var t=new Date(1e3*e),a=1900+t.getYear(),n="0"+(t.getMonth()+1),i="0"+t.getDate(),r="0"+t.getHours(),s="0"+t.getMinutes(),o="0"+t.getSeconds();return a+"-"+n.substring(n.length-2,n.length)+"-"+i.substring(i.length-2,i.length)+" "+r.substring(r.length-2,r.length)+":"+s.substring(s.length-2,s.length)+":"+o.substring(o.length-2,o.length)},timeFormat:function(e){var t=new Date(e),a=t.getFullYear(),n=t.getMonth()+1,i=t.getDate(),r=t.getHours(),s=t.getMinutes(),o=t.getSeconds();return a+"-"+this.add0(n)+"-"+this.add0(i)+" "+this.add0(r)+":"+this.add0(s)+":"+this.add0(o)},add0:function(e){return e<10?"0"+e:e},getDefaultDate:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.startTime=this.timeFormat((new Date).getTime()-864e5),this.endTime=this.timeFormat(new Date),this.dataForm.createdate=[this.startTime,this.endTime],e.next=1,this.getPrjNameList();case 1:return e.next=2,this.getAllGwsnDataList();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleonLineChart:function(e){e?(this.dataListLoading=!1,this.isChart=!0,this.getAllHeartData()):(this.dataListLoading=!1,this.isChart=!1,this.historyList())},historyMonitor:function(){var e=this;if(e.bar_dv=e.$refs.onLineChart,e.bar_dv){for(var t=e.$echarts.init(e.bar_dv,"light"),a={tooltip:{trigger:"axis"},legend:{data:[e.$t("gwsn.signalValue")]},toolbox:{feature:{saveAsImage:{}}},grid:{left:"3%",right:"3%",bottom:"1%",containLabel:!0},xAxis:[{name:e.$t("date"),type:"category",boundaryGap:!1,axisTick:{show:!0,length:5},data:e.date}],yAxis:[{type:"value"}],series:[{name:e.$t("gwsn.signalValue"),type:"line",data:e.chartData,large:!0,progressive:200,progressiveThreshold:3e3}]},n=a.xAxis[0].data,i=a.series[0].data,r=0;r<n.length;r++)(new Date(n[r+1]).getTime()-new Date(n[r]).getTime())/1e3/60>9&&(i[r]="");a.series[0].data=i,e.$nextTick((function(){t.setOption(a,!0)}))}},clearHistoryMonitor:function(){var e=this;if(e.bar_dv=e.$refs.onLineChart,e.bar_dv){var t=e.$echarts.init(e.bar_dv,"light"),a={tooltip:{trigger:"axis"},legend:{data:[e.$t("gwsn.signalValue")]},toolbox:{feature:{saveAsImage:{}}},grid:{left:"5%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{name:e.$t("date"),type:"category",boundaryGap:!1,axisTick:{show:!1},data:[]}],yAxis:[{type:"value"}],series:[{name:e.$t("gwsn.signalValue"),type:"line",data:[]}]};t.setOption(a,!0)}},handlePrjScroll:function(){this.projectName.length<this.prjTotal&&(this.prjPage++,this.getPrjNameList())},handleGwsnScroll:function(){this.gwsnList.length<this.gwsnTotal&&(this.gwsnPage++,this.getAllGwsnDataList())},watchPrjSearch:d()((function(){var e=document.getElementsByClassName("el-scrollbar__wrap").length;document.getElementsByClassName("el-scrollbar__wrap")[e-1].scrollTo(0,0),this.prjPage=1,this.getPrjNameList(),this.$refs.prjInput.focus()}),500),watchGwsnSearch:d()((function(){this.gwsnSearch&&(this.total=0,this.dataList=[],this.date=[],this.chartData=[]);var e=document.getElementsByClassName("el-scrollbar__wrap").length;document.getElementsByClassName("el-scrollbar__wrap")[e-1].scrollTo(0,0),this.gwsnPage=1,this.getAllGwsnDataList(),this.$refs.gwsnInput.focus()}),500)},mounted:function(){var e=this;this.getDefaultDate(),window.onresize=function(){return function(){e.scrollTableHeight=window.innerHeight-220-53}()}},watch:{prjSearch:function(e,t){this.watchPrjSearch()},gwsnSearch:function(e,t){this.watchGwsnSearch()}}},m=p,f=(a("aec7"),a("2877")),w=Object(f["a"])(m,n,i,!1,null,"098b93c1",null);t["default"]=w.exports},"6a9e":function(e,t,a){e.exports=a.p+"img/foursignal.e4db31dc.png"},"9e59":function(e,t,a){},a90d:function(e,t,a){e.exports=a.p+"img/nosignal.269dcdc3.png"},aec7:function(e,t,a){"use strict";a("9e59")},cdf7:function(e,t,a){e.exports=a.p+"img/onesignal.882b8943.png"},e310:function(e,t,a){e.exports=a.p+"img/internet.a7e2d66c.png"},ee58:function(e,t,a){e.exports=a.p+"img/fullsignal.38355690.png"},f27f:function(e,t,a){e.exports=a.p+"img/threesignal.77a331f7.png"}}]);
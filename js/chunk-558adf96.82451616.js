(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-558adf96"],{"88d8":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("section",[e("div",{attrs:{id:"centervarQueryContainer"}},[e("el-form",{attrs:{inline:!0,model:t.dataForm},nativeOn:{submit:function(t){t.preventDefault()},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.querySearch()}}},[e("el-form-item",{attrs:{label:t.$t("attribute.alarmtype")}},[e("el-select",{attrs:{size:"small",filterable:"",clearable:"",placeholder:t.$t("attribute.placeholderSelect")},on:{change:t.querySearch},model:{value:t.dataForm.alarmtype,callback:function(e){t.$set(t.dataForm,"alarmtype",e)},expression:"dataForm.alarmtype"}},t._l(t.alarmtypeList,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("el-form-item",[e("el-input",{attrs:{size:"small",placeholder:t.$t("formulacalculation.pleaseEnterTagnameOrDescription"),clearable:""},on:{clear:t.querySearch},model:{value:t.dataForm.tagname,callback:function(e){t.$set(t.dataForm,"tagname",e)},expression:"dataForm.tagname"}})],1),t.$hasPermission("taginfo:select:permission.do")?e("el-form-item",[e("el-button",{attrs:{size:"small",icon:"el-icon-search"},on:{click:function(e){return t.querySearch()}}},[t._v(t._s(t.$t("query")))])],1):t._e(),t.$hasPermission("taginfo:insert:permission.do")&&t.isShowSetting?e("el-form-item",[e("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(e){return t.addOrUpdateHandle()}}},[t._v(" "+t._s(t.$t("add")))])],1):t._e(),t.$hasPermission("taginfo:update:permission.do")&&t.isShowSetting?e("el-form-item",[e("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-edit",disabled:0===t.tagIds.length||0===t.dataList.length},on:{click:function(e){return t.editAll()}}},[t._v(t._s(t.$t("attribute.editMultiple")))])],1):t._e(),t.$hasPermission("tag:delete:permission.do")&&t.isShowSetting?e("el-form-item",[e("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete",disabled:0===t.tagIds.length||0===t.dataList.length},on:{click:function(e){return t.deleteHandle()}}},[t._v(t._s(t.$t("deleteBatch")))])],1):t._e(),t.$hasPermission("taginfo:import:permission.do")&&t.isShowSetting?e("el-form-item",[e("el-upload",{staticClass:"upload-demo",attrs:{size:"small",action:"","on-change":t.handleChange,"before-upload":t.beforeUploadHandle,"http-request":t.uploadSectionFile,"on-remove":t.handleRemove,"file-list":t.fileList,limit:1,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel","show-file-list":!1}},[e("el-tooltip",{attrs:{content:t.$t("onlyXlsxFilesUploaded"),placement:"top"}},[e("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-upload"}},[t._v(t._s(t.$t("import")))])],1)],1)],1):t._e(),t.$hasPermission("taginfo:exports:permission.do")&&t.isShowSetting?e("el-form-item",[e("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-download",disabled:0===t.tagIds.length||0===t.dataList.length},on:{click:function(e){return t.exportHandle()}}},[t._v(t._s(t.$t("export"))+" ")])],1):t._e(),t.$hasPermission("taginfo:select:permission.do")?e("el-form-item",[e("el-button",{attrs:{size:"small",type:"success"},on:{click:t.getDataList}},[e("i",{staticClass:"el-icon-refresh"})])],1):t._e()],1)],1),t.scrollTableHeight?e("div",[e("vxe-table",{ref:"recordTable",staticStyle:{width:"100%"},attrs:{size:"mini",border:"",resizable:"","show-overflow":"","show-header-overflow":"","highlight-hover-row":"","highlight-current-row":"","max-height":t.scrollTableHeight,loading:t.dataListLoading,"row-config":{keyField:"id"},"sort-config":t.sortConfig,"checkbox-config":t.checkboxConfig,"empty-text":t.$t("noData"),"scroll-y":{enabled:!0},"scroll-x":{enable:!0,scrollToLeftOnChange:!0}},on:{"checkbox-all":t.selectAll,"checkbox-change":t.dataListSelectionHandleChange,"sort-change":t.sortChange,scroll:t.handleScrollChange}},[e("vxe-table-column",{attrs:{type:"checkbox","header-align":"center",align:"center",width:"60",fixed:"left",checked:!1}}),e("vxe-table-column",{attrs:{field:"id",title:t.$t("measuringPointID"),"header-align":"center",align:"center",sortable:"",width:"140",fixed:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(e.row.tagid)+"\n                ")]}}],null,!1,4014290946)}),e("vxe-table-column",{attrs:{field:"tagname",title:t.$t("attribute.tagname"),"header-align":"center",align:"center",width:"210",fixed:"left","show-overflow-tooltip":!0}}),e("vxe-table-column",{attrs:{field:"tagcomment",title:t.$t("attribute.modelattribute"),"header-align":"center",align:"center",width:"180","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.tagcomment||t.$t("attribute.noContent")))])]}}],null,!1,385731756)}),e("vxe-table-column",{attrs:{field:"alarmtype",title:t.$t("attribute.alarmtype"),"header-align":"center",align:"center",formatter:t.formatterAlarmtype}}),e("vxe-table-column",{attrs:{field:"tagrwprop",title:t.$t("attribute.tagrwprop"),"header-align":"center",align:"center",formatter:t.formatterRwtype}}),e("vxe-table-column",{attrs:{field:"objaddr",title:t.$t("attribute.registerAddress"),"header-align":"center",align:"center",sortable:""}}),e("vxe-table-column",{attrs:{field:"taginitvalue",title:t.$t("attribute.taginitvalue"),"header-align":"center",align:"center"}}),e("vxe-table-column",{attrs:{field:"enablealarm",title:t.$t("attribute.enablealarm"),"header-align":"center",align:"center",formatter:t.formatterAlarm}}),e("vxe-table-column",{attrs:{field:"enablehissave",title:t.$t("attribute.enablehissave"),"header-align":"center",align:"center",formatter:t.formatterHistory}}),(t.$hasPermission("taginfo:update:permission.do")||t.$hasPermission("tag:delete:permission.do"))&&t.isShowSetting?e("vxe-table-column",{attrs:{title:t.$t("handle"),"header-align":"center",align:"center",width:"130",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[t.$hasPermission("taginfo:update:permission.do")?e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.addOrUpdateHandle(a.row.id)}}},[t._v(t._s(t.$t("update"))+" ")]):t._e(),t.$hasPermission("tag:delete:permission.do")?e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.deleteHandle(a.row.id)}}},[t._v(t._s(t.$t("delete"))+" ")]):t._e()]}}],null,!1,1230232526)}):t._e()],1),e("vxe-pager",{attrs:{perfect:"",size:"mini",loading:t.pagerLoading,"current-page":t.page,"page-size":t.limit,"page-sizes":[100,200,500,1e3,2e3,5e3,1e4],total:t.total,layouts:["PrevPage","JumpNumber","NextPage","FullJump","Sizes","Total"]},on:{"page-change":t.handlePageChange}})],1):t._e(),t.addOrUpdateVisible?e("add-or-update",{ref:"addOrUpdate",on:{refreshDataList:t.getDataList}}):t._e(),e("el-dialog",{attrs:{width:"40%",title:t.$t("attribute.editMultiple"),"close-on-click-modal":!1,"close-on-press-escape":!1,visible:t.editAllVisible},on:{"update:visible":function(e){t.editAllVisible=e}}},[e("el-form",{ref:"editForm",attrs:{model:t.editForm,rules:t.rules,"label-width":(t.$i18n.locale,"120px")},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.dataFormSubmitHandle()}}},[e("el-row",[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.editType"),prop:"type"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:t.$t("attribute.placeholderSelect"),filterable:""},on:{change:t.selectChanged},model:{value:t.editForm.type,callback:function(e){t.$set(t.editForm,"type",e)},expression:"editForm.type"}},t._l(t.editTypeLists,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),"objaddr"!=t.editForm.type&&"taginitvalue"!=t.editForm.type&&"tagname"!=t.editForm.type&&"tagcomment"!=t.editForm.type?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.editValue"),prop:"changeValue"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:t.$t("attribute.placeholderSelect"),filterable:""},model:{value:t.editForm.changeValue,callback:function(e){t.$set(t.editForm,"changeValue",e)},expression:"editForm.changeValue"}},t._l(t.changeList,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1):t._e(),"taginitvalue"==t.editForm.type?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.editValue"),prop:"changeValue"}},[e("el-input",{attrs:{placeholder:t.$t("attribute.pleaseEnterModifiedValue")},model:{value:t.editForm.changeValue,callback:function(e){t.$set(t.editForm,"changeValue",e)},expression:"editForm.changeValue"}})],1)],1):t._e(),"objaddr"==t.editForm.type?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.editWay"),prop:"objaddrWay",rules:"objaddr"===this.editForm.type?t.rules.objaddrWay:[{required:!1,message:t.$t("attribute.requireNotNull"),trigger:"change"}]}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:t.$t("attribute.placeholderSelect"),filterable:""},model:{value:t.editForm.objaddrWay,callback:function(e){t.$set(t.editForm,"objaddrWay",e)},expression:"editForm.objaddrWay"}},t._l(t.objaddrTypeList,(function(t,a){return e("el-option",{key:a,attrs:{label:t.label,value:t.value}})})),1)],1)],1):t._e(),"tagname"==t.editForm.type?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.editWay"),prop:"way"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:t.$t("attribute.placeholderSelect"),filterable:""},model:{value:t.editForm.way,callback:function(e){t.$set(t.editForm,"way",e)},expression:"editForm.way"}},t._l(t.wayLists,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1):t._e(),"tagcomment"==t.editForm.type?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.editWay"),prop:"tagcommentWay"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:t.$t("attribute.placeholderSelect"),filterable:""},on:{change:t.handleTagCommentWayChange},model:{value:t.editForm.tagcommentWay,callback:function(e){t.$set(t.editForm,"tagcommentWay",e)},expression:"editForm.tagcommentWay"}},t._l(t.tagcommentWayLists,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1):t._e()],1),e("el-row",["objaddr"==t.editForm.type&&"step"==t.editForm.objaddrWay?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.startValue"),prop:"startValue",rules:"objaddr"===this.editForm.type&&"step"==t.editForm.objaddrWay?t.rules.startValue:[{required:!1,message:t.$t("attribute.requireNotNull"),trigger:"change"}]}},[e("el-input",{attrs:{placeholder:t.$t("attribute.startValue")},model:{value:t.editForm.startValue,callback:function(e){t.$set(t.editForm,"startValue",e)},expression:"editForm.startValue"}})],1)],1):t._e(),"objaddr"==t.editForm.type&&"step"==t.editForm.objaddrWay?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.step"),prop:"step",rules:"objaddr"===this.editForm.type&&"step"==t.editForm.objaddrWay?t.rules.step:[{required:!1,message:t.$t("attribute.requireNotNull"),trigger:"change"}]}},[e("el-input",{attrs:{placeholder:t.$t("attribute.step")},model:{value:t.editForm.step,callback:function(e){t.$set(t.editForm,"step",e)},expression:"editForm.step"}})],1)],1):t._e(),"objaddr"==t.editForm.type&&"fixed"==t.editForm.objaddrWay?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.fixedValue"),prop:"fixedValue",rules:"objaddr"===this.editForm.type&&"fixed"==t.editForm.objaddrWay?t.rules.fixedValue:[{required:!1,message:t.$t("attribute.requireNotNull"),trigger:"change"}]}},[e("el-input",{attrs:{placeholder:t.$t("attribute.fixedValuePlaceholder")},model:{value:t.editForm.fixedValue,callback:function(e){t.$set(t.editForm,"fixedValue",e)},expression:"editForm.fixedValue"}})],1)],1):t._e(),"tagname"==t.editForm.type&&"replace"==t.editForm.way?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.replaceSource"),prop:"replaceStr",rules:"tagname"===this.editForm.type&&"replace"==t.editForm.way?t.rules.replaceStr:[{required:!1,message:t.$t("attribute.requireNotNull"),trigger:"change"}]}},[e("el-input",{attrs:{placeholder:t.$t("attribute.enterReplaceSource")},model:{value:t.editForm.replaceStr,callback:function(e){t.$set(t.editForm,"replaceStr",e)},expression:"editForm.replaceStr"}})],1)],1):t._e(),"tagname"==t.editForm.type?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.editValue")}},[e("el-input",{attrs:{placeholder:"replace"==t.editForm.way?t.$t("attribute.replaceName"):"prepend"==t.editForm.way?t.$t("attribute.replacePrependName"):"append"==t.editForm.way?t.$t("attribute.replaceAppendName"):"请输入您要递增的起始测点名称"},model:{value:t.editForm.tagnameStr,callback:function(e){t.$set(t.editForm,"tagnameStr",e)},expression:"editForm.tagnameStr"}})],1)],1):t._e(),"tagcomment"==t.editForm.type&&"replace"==t.editForm.tagcommentWay?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.replaceSource"),prop:"replaceTagCommentStr",rules:"tagcomment"===this.editForm.type&&"replace"==t.editForm.tagcommentWay?t.rules.replaceTagCommentStr:[{required:!1,message:t.$t("attribute.requireNotNull"),trigger:"change"}]}},[e("el-input",{attrs:{placeholder:t.$t("attribute.enterReplaceSource")},model:{value:t.editForm.replaceTagCommentStr,callback:function(e){t.$set(t.editForm,"replaceTagCommentStr",e)},expression:"editForm.replaceTagCommentStr"}})],1)],1):t._e(),"tagcomment"==t.editForm.type&&"clipboardSource"!=t.editForm.tagcommentWay?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.editValue"),prop:"tagcomment"}},[e("el-input",{attrs:{placeholder:t.$t("attribute.editValue")},model:{value:t.editForm.tagcomment,callback:function(e){t.$set(t.editForm,"tagcomment",e)},expression:"editForm.tagcomment"}})],1)],1):t._e(),"tagcomment"==t.editForm.type&&"increasing"==t.editForm.tagcommentWay?e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("attribute.step"),prop:"tagcommentStep"}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{"step-strictly":"","controls-position":"right",placeholder:t.$t("attribute.pleaseEnterTheStepSize")},model:{value:t.editForm.tagcommentStep,callback:function(e){t.$set(t.editForm,"tagcommentStep",e)},expression:"editForm.tagcommentStep"}})],1)],1):t._e()],1)],1),e("template",{slot:"footer"},[e("el-button",{on:{click:function(e){t.editAllVisible=!1}}},[t._v(t._s(t.$t("cancel")))]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.dataFormSubmitHandle()}}},[t._v(t._s(t.$t("confirm")))])],1)],2)],1)},r=[],s=(a("7f7f"),a("28a5"),a("6762"),a("2fdb"),a("3b2b"),a("f576"),a("f559"),a("4917"),a("ac6a"),a("c5f6"),a("55dd"),a("a481"),a("4328")),n=a.n(s),o=a("b047"),l=a.n(o),d=a("e1a5"),g=a("e91e"),c=a("ed08"),m={mixins:[d["a"]],data:function(){var t=this;return{isShowSetting:!1,pagerLoading:!1,sortConfig:{defaultSort:{field:"id",order:"asc"},remote:!0},checkboxConfig:{checkStrictly:!1,reserve:!0,highlight:!0,checkField:"checked"},currentPageCheccked:!1,selectedTagIdAndObjAddrList:[],multipleSelectionAll:[],exportIds:null,page:1,limit:1e3,total:0,sname:"id",sort:"asc",scrollleft:0,scorlltop:0,fileList:[],dataList:[],allCheck:!1,changeList:[],tagIds:[],tagIdNameList:[],tagIdCommentList:[],editAllVisible:!1,alarmtypeList:[{label:this.$t("attribute.all"),value:""},{label:this.$t("attribute.visualValue"),value:0},{label:this.$t("attribute.switchValue"),value:1},{label:this.$t("attribute.ym"),value:2},{label:this.$t("attribute.yk"),value:3},{label:this.$t("attribute.yt"),value:4}],tagrwList:[{label:this.$t("attribute.all"),value:""},{label:this.$t("attribute.onlyRead"),value:0},{label:this.$t("attribute.readWrite"),value:1},{label:this.$t("attribute.onlyWrite"),value:2}],dataListLoading:!1,scrollTableHeight:0,mixinViewModuleOptions:{exportURL:"/info/taginfo/exports"},dataForm:{tagname:"",alarmtype:""},historySave:[{label:this.$t("attribute.all"),value:""},{label:this.$t("attribute.yes"),value:1},{label:this.$t("attribute.no"),value:0}],editForm:{type:"alarmtype",way:"replace",replaceStr:"",tagnameStr:"",tagcommentWay:"replace",replaceTagCommentStr:"",tagcomment:"",tagcommentStep:1,changeValue:0,objaddrWay:"step",startValue:0,step:1,fixedValue:""},wayLists:[{label:this.$t("attribute.replace"),value:"replace"},{label:this.$t("attribute.prepend"),value:"prepend"},{label:this.$t("attribute.append"),value:"append"},{label:"递增",value:"increment"}],tagcommentWayLists:[{label:this.$t("attribute.replace"),value:"replace"},{label:this.$t("attribute.prepend"),value:"prepend"},{label:this.$t("attribute.append"),value:"append"},{label:this.$t("attribute.increasing"),value:"increasing"},{label:this.$t("attribute.clipboardSource"),value:"clipboardSource"}],editTypeLists:[{label:this.$t("attribute.tagname"),value:"tagname"},{label:this.$t("attribute.modelattribute"),value:"tagcomment"},{label:this.$t("attribute.alarmtype"),value:"alarmtype"},{label:this.$t("attribute.tagrwprop"),value:"tagrwprop"},{label:this.$t("attribute.objaddr"),value:"objaddr"},{label:this.$t("attribute.enablealarm"),value:"enablealarm"},{label:this.$t("attribute.enablehissave"),value:"enablehissave"},{label:this.$t("attribute.taginitvalue"),value:"taginitvalue"}],alarmRecordList:[{label:this.$t("attribute.visualValue"),value:0},{label:this.$t("attribute.switchValue"),value:1},{label:this.$t("attribute.ym"),value:2},{label:this.$t("attribute.yk"),value:3},{label:this.$t("attribute.yt"),value:4}],writeReadType:[{label:this.$t("attribute.onlyRead"),value:0},{label:this.$t("attribute.readWrite"),value:1},{label:this.$t("attribute.onlyWrite"),value:2}],objaddrTypeList:[{label:this.$t("attribute.step"),value:"step"},{label:this.$t("attribute.tagb"),value:"fixed"}],enablealarmList:[{label:this.$t("attribute.open"),value:1},{label:this.$t("attribute.close"),value:0}],enablehissaveList:[{label:this.$t("attribute.open"),value:1},{label:this.$t("attribute.close"),value:0}],rules:{type:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],value:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],changeValue:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],replaceStr:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],tagnameStr:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],replaceTagCommentStr:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],startValue:[{required:!0,message:this.$t("validate.required"),trigger:"blur"},{validator:function(e,a,i){if(String(a)){var r=/[-]?[0-9]$/;r.test(a)?i():i(new Error(t.$t("chlwatch.pleaseEnterIntNumber")))}},trigger:"change"}],step:[{required:!0,message:this.$t("validate.required"),trigger:"blur"},{validator:function(e,a,i){if(a){var r=/^[-]?[0-9]\d*$/;r.test(a)?i():i(new Error(t.$t("chlwatch.pleaseEnterIntNumber")))}},trigger:"change"}],objaddrWay:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],fixedValue:[{required:!0,message:this.$t("validate.required"),trigger:"blur"},{validator:function(e,a,i){if(a){var r=/^[-]?[0-9]+(\.[0-9]+)?$/;r.test(a)?i():i(new Error(t.$t("debuggerInfo.enterNumber")))}},trigger:"change"}]}}},components:{AddOrUpdate:g["default"]},methods:{pageSizeChangeHandle:function(t){this.page=1,this.limit=t,this.getDataList(),sessionStorage.setItem("limit6",this.limit),sessionStorage.setItem("page6",this.page)},pageCurrentChangeHandle:function(t){this.page=t,this.getDataList(),sessionStorage.setItem("page6",this.page)},querySearch:function(){var t=this;this.$hasSessionStorageGwsn()?(this.page=1,this.getDataList()):this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}})},sortChange:function(t){t.column;var e=t.property,a=t.order;a&&(this.sname="tagid"==e?"id":e,this.sort=a,this.getDataList())},handleScrollChange:function(t){t.type;var e=t.scrollTop,a=t.scrollLeft;this.scrollleft=a,this.scorlltop=e},getDataList:l()((function(){var t=this;if(this.$hasSessionStorageGwsn()){var e={deviceid:1,page:this.page,limit:this.limit,sort:"objaddr"==this.sname?this.sname+"+0 "+this.sort:this.sname+" "+this.sort,alarmtype:this.dataForm.alarmtype,gwsn:sessionStorage.getItem("gwsn")};if(this.dataForm.tagname&&(e["sname"]=this.dataForm.tagname.replace(/_/g,"\\_").replace(/%/g,"\\%")),this.total=0,this.dataList=[],!this.$hasPermission("taginfo:select:permission.do"))return void this.$message.warning("暂无测点查询权限, 请联系管理员");this.dataListLoading=!0,this.pagerLoading=!0,this.$http.get("/info/taginfo/selectTags.do",{params:e}).then((function(a){var i=a.data;t.page=e.page,t.$nextTick((function(){t.dataList=i.data.rows||[],t.$refs.recordTable&&(t.$refs.recordTable.clearCheckboxRow(),t.$refs.recordTable.loadData(t.dataList).then((function(){t.dataListLoading=!1,t.pagerLoading=!1,t.total=Number(i.data.total)||0})).finally((function(){if(t.dataList.length>0){if(t.$refs.recordTable.scrollTo(0,0),t.currentPageCheccked&&!t.allCheck&&(t.$set(t.checkboxConfig,"checkStrictly",!1),t.$refs.recordTable.setAllCheckboxRow(!1),t.tagIds=[],t.tagIdNameList=[],t.tagIdCommentList=[],t.exportIds=null,t.multipleSelectionAll=[],t.selectedTagIdAndObjAddrList=[],t.dataList.forEach((function(e){var a={id:e.id,tagid:e.tagid,objaddr:e.objaddr},i={id:e.id,tagid:e.tagid,name:e.tagname},r={id:e.id,tagid:e.tagid,tagcomment:e.tagcomment};t.tagIds.push(e.id),t.tagIdNameList.push(i),t.tagIdCommentList.push(r),t.multipleSelectionAll.push(e.id),t.selectedTagIdAndObjAddrList.push(a)})),t.exportIds=t.tagIds.join(","),t.$store.dispatch("changeExportIds",t.exportIds),t.$refs.recordTable.setAllCheckboxRow(!0)),!t.currentPageCheccked&&!t.allCheck)if(t.multipleSelectionAll.length>0){t.$set(t.checkboxConfig,"checkStrictly",!1),t.$refs.recordTable.setAllCheckboxRow(!1),t.tagIds=[],t.tagIdNameList=[],t.tagIdCommentList=[],t.exportIds=null,t.selectedTagIdAndObjAddrList=[];var e=!1;t.dataList.forEach((function(e){var a=t.multipleSelectionAll.length>0&&-1!==t.multipleSelectionAll.indexOf(e.id);if(a){var i={id:e.id,tagid:e.tagid,objaddr:e.objaddr},r={id:e.id,tagid:e.tagid,name:e.tagname},s={id:e.id,tagid:e.tagid,tagcomment:e.tagcomment};t.tagIds.push(e.id),t.tagIdNameList.push(r),t.tagIdCommentList.push(s),t.selectedTagIdAndObjAddrList.push(i)}})),t.exportIds=t.tagIds.join(","),t.$store.dispatch("changeExportIds",t.exportIds),t.multipleSelectionAll.forEach((function(a){t.dataList.forEach((function(i){i.id==a&&(e=!0,t.$refs.recordTable.setCheckboxRow(i,!0))}))})),e||(t.tagIds=[],t.tagIdNameList=[],t.tagIdCommentList=[],t.exportIds=null,t.multipleSelectionAll=[])}else t.$set(t.checkboxConfig,"checkStrictly",!1),t.$refs.recordTable.setAllCheckboxRow(!1);t.allCheck&&(t.$set(t.checkboxConfig,"checkStrictly",!1),t.$refs.recordTable.setAllCheckboxRow(!0),t.$set(t.checkboxConfig,"checkStrictly",!0),t.getAllChecked())}})))}))})).catch((function(e){return t.dataListLoading=!1,!1}))}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),formatterAlarmtype:function(t){var e=t.row;t.column;return 0===e.alarmtype?this.$t("attribute.visualValue"):1===e.alarmtype?this.$t("attribute.switchValue"):2===e.alarmtype?this.$t("attribute.ym"):3===e.alarmtype?this.$t("attribute.yk"):4===e.alarmtype?this.$t("attribute.yt"):""},formatterRwtype:function(t){var e=t.row;t.column;return 0===e.tagrwprop?this.$t("attribute.onlyRead"):1===e.tagrwprop?this.$t("attribute.readWrite"):this.$t("attribute.onlyWrite")},formatterAlarm:function(t){var e=t.row;t.column;return 1===e.enablealarm?this.$t("attribute.yes"):this.$t("attribute.no")},formatterHistory:function(t){var e=t.row;t.column;return 1===e.enablehissave?this.$t("attribute.yes"):this.$t("attribute.no")},handlePageChange:function(t){var e=t.currentPage,a=t.pageSize;this.page=e,this.limit=a,sessionStorage.setItem("page6",this.page),sessionStorage.setItem("limit6",this.limit),this.getDataList()},selectAll:function(t){var e=this;this.tagIds=[],this.tagIdNameList=[],this.tagIdCommentList=[],this.exportIds=null,this.multipleSelectionAll=[],this.selectedTagIdAndObjAddrList=[];var a=t.records;a.length>0?(this.currentPageCheccked=!0,a.forEach((function(t){var a={id:t.id,tagid:t.tagid,objaddr:t.objaddr},i={id:t.id,tagid:t.tagid,name:t.tagname},r={id:t.id,tagid:t.tagid,tagcomment:t.tagcomment};e.tagIds.push(t.id),e.tagIdNameList.push(i),e.tagIdCommentList.push(r),e.multipleSelectionAll.push(t.id),e.selectedTagIdAndObjAddrList.push(a)})),this.exportIds=this.tagIds.join(","),this.$store.dispatch("changeExportIds",this.exportIds)):this.currentPageCheccked=!1,this.allCheck&&!t.checked&&this.$refs.recordTable&&this.$refs.recordTable.setCheckboxRow(this.$refs.recordTable.getRowById(t.row.id),!0)},dataListSelectionHandleChange:function(t){var e=this;this.tagIds=[],this.tagIdNameList=[],this.tagIdCommentList=[],this.exportIds=null,this.multipleSelectionAll=[],this.selectedTagIdAndObjAddrList=[];var a=t.records;a.length>0&&(a.forEach((function(t){var a={id:t.id,tagid:t.tagid,objaddr:t.objaddr},i={id:t.id,tagid:t.tagid,name:t.tagname},r={id:t.id,tagid:t.tagid,tagcomment:t.tagcomment};e.tagIds.push(t.id),e.tagIdNameList.push(i),e.tagIdCommentList.push(r),e.multipleSelectionAll.push(t.id),e.selectedTagIdAndObjAddrList.push(a)})),this.exportIds=this.tagIds.join(","),this.$store.dispatch("changeExportIds",this.exportIds)),this.allCheck&&!t.checked&&this.$refs.recordTable&&this.$refs.recordTable.setCheckboxRow(this.$refs.recordTable.getRowById(t.row.id),!0)},reduceSame:function(t){var e={};return t.reduce((function(t,a){return!e[a.id]&&(e[a.id]=t.push(a)),t}),[])},allCheckEvent:function(){var t=this;t.allCheck?(t.$refs.recordTable&&t.$refs.recordTable.setAllCheckboxRow(!0),t.$set(this.checkboxConfig,"checkStrictly",!0),t.getAllChecked()):(t.tagIds=[],t.tagIdNameList=[],t.tagIdCommentList=[],t.exportIds=null,t.multipleSelectionAll=[],t.selectedTagIdAndObjAddrList=[],t.$set(t.checkboxConfig,"checkStrictly",!1),t.$refs.recordTable&&t.$refs.recordTable.setAllCheckboxRow(!1),t.currentPageCheccked=!1)},getAllChecked:function(){var t=this;if(this.$hasSessionStorageGwsn()){var e={devIds:1,type:0,sort:"objaddr"==this.sname?this.sname+"+0 "+this.sort:this.sname+" "+this.sort,gwsn:sessionStorage.getItem("gwsn")};if(!this.$hasPermission("list:getTagList:select:permission.do"))return void this.$message.warning("暂无测点连续全选查询权限, 请联系管理员");this.$http.post("",n.a.stringify(e)).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.tagIds=[],t.tagIdNameList=[],t.tagIdCommentList=[],t.selectedTagIdAndObjAddrList=[],t.exportIds=null;for(var i=0;i<a.data.length;i++){var r=a.data[i];if(t.dataForm.tagname){if(String(t.dataForm.alarmtype)){if((-1!=r.tagName.toLocaleLowerCase().indexOf(t.dataForm.tagname.toLocaleLowerCase())||r.tagComment&&-1!=r.tagComment.toLocaleLowerCase().indexOf(t.dataForm.tagname.toLocaleLowerCase()))&&r.alarmType==t.dataForm.alarmtype){var s={id:r.id,tagid:r.tagid,objaddr:r.objAddr},n={id:r.id,tagid:r.tagid,name:r.tagName},o={id:r.id,tagid:r.tagid,tagcomment:r.tagComment};t.tagIds.push(r.id),t.tagIdNameList.push(n),t.tagIdCommentList.push(o),t.selectedTagIdAndObjAddrList.push(s)}}else if(-1!=r.tagName.toLocaleLowerCase().indexOf(t.dataForm.tagname.toLocaleLowerCase())||r.tagComment&&-1!=r.tagComment.toLocaleLowerCase().indexOf(t.dataForm.tagname.toLocaleLowerCase())){var l={id:r.id,tagid:r.tagid,objaddr:r.objAddr},d={id:r.id,tagid:r.tagid,name:r.tagName},g={id:r.id,tagid:r.tagid,tagcomment:r.tagComment};t.tagIds.push(r.id),t.tagIdNameList.push(d),t.tagIdCommentList.push(g),t.selectedTagIdAndObjAddrList.push(l)}}else if(String(t.dataForm.alarmtype)){if(r.alarmType==t.dataForm.alarmtype){var c={id:r.id,tagid:r.tagid,objaddr:r.objAddr},m={id:r.id,tagid:r.tagid,name:r.tagName},u={id:r.id,tagid:r.tagid,tagcomment:r.tagComment};t.tagIds.push(r.id),t.tagIdNameList.push(m),t.tagIdCommentList.push(u),t.selectedTagIdAndObjAddrList.push(c)}}else{var h={id:r.id,tagid:r.tagid,objaddr:r.objAddr},p={id:r.id,tagid:r.tagid,name:r.tagName},f={id:r.id,tagid:r.tagid,tagcomment:r.tagComment};t.tagIds.push(r.id),t.tagIdNameList.push(p),t.tagIdCommentList.push(f),t.selectedTagIdAndObjAddrList.push(h)}}t.exportIds=t.tagIds.join(","),t.$store.dispatch("changeExportIds",t.exportIds)})).catch((function(t){return!1}))}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}})},deleteHandle:l()((function(t){var e=this;if(e.$hasSessionStorageGwsn()){if(t&&(e.tagIds=[],e.tagIds.push(t)),0===e.tagIds.length)return e.$message.error(e.$t("deleteInfo.noData"));if(!e.$hasPermission("tag:delete:permission.do"))return void e.$message.warning("暂无中间测点删除权限, 请联系管理员");e.$confirm(e.$t("deleteInfo.noticeTitle"),e.$t("deleteInfo.noticePrompt"),{confirmButtonText:e.$t("deleteInfo.confirm"),cancelButtonText:e.$t("deleteInfo.cancel"),type:"warning"}).then((function(){e.dataListLoading=!0,e.$http.post("/delcmd/tag/delete.do",e.tagIds).then((function(t){var a=t.data;if(0!=a.code)return e.dataListLoading=!1,e.$message.error(a.data||e.$t("deleteInfo.deleteFail"));e.$message.success(e.$t("deleteInfo.deleteSuccess")),e.dataListLoading=!1,e.allCheck=!1,e.currentPageCheccked=!1,e.getDataList()})).catch((function(t){return e.dataListLoading=!1,e.allCheck=!1,e.currentPageCheccked=!1,e.getDataList(),!1}))})).catch((function(t){}))}else e.$message({showClose:!1,message:e.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),editAll:function(){var t=this;if(this.$hasSessionStorageGwsn()){if(!(this.tagIds.length>0))return this.$message.info(this.$t("attribute.selectEditData"));if(!this.$hasPermission("taginfo:update:permission.do"))return void this.$message.warning("暂无测点批量修改权限, 请联系管理员");this.editAllVisible=!0,this.editForm.changeValue="","alarmtype"===this.editForm.type?this.changeList=this.alarmRecordList:"tagrwprop"===this.editForm.type?this.changeList=this.writeReadType:"enablealarm"===this.editForm.type?this.changeList=this.enablealarmList:"enablehissave"===this.editForm.type&&(this.changeList=this.enablehissaveList),this.editForm.changeValue=this.changeList[0].value}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}})},selectChanged:function(t){this.$refs.editForm.clearValidate(),this.editForm.changeValue="","alarmtype"===t?this.changeList=this.alarmRecordList:"tagrwprop"===t?this.changeList=this.writeReadType:"enablealarm"===t?this.changeList=this.enablealarmList:"enablehissave"===t&&(this.changeList=this.enablehissaveList),this.editForm.changeValue=this.changeList[0].value},handleTagCommentWayChange:function(t){this.$refs.editForm.clearValidate()},generateAddresses:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,i=[];if("number"===typeof t){for(var r=0;r<a;r++)i.push(String(t+r*e));return i}var s=t.match(/\d+/g);if(!s){for(var n=0;n<a;n++)i.push(0==e?"".concat(t):"".concat(t).concat(n*e));return i}for(var o=s[s.length-1],l=t.lastIndexOf(o),d=t.substring(0,l),g=t.substring(l+o.length),c=parseInt(o,10),m=0;m<a;m++){var u=c+m*e,h=o.startsWith("0")?String(u).padStart(o.length,"0"):String(u);i.push("".concat(d).concat(h).concat(g))}return i},dataFormSubmitHandle:l()((function(){var t=this;if(this.$hasSessionStorageGwsn()){var e=[],a=this.editForm.type;if(!this.$hasPermission("taginfo:update:permission.do"))return void this.$message.warning("暂无测点批量修改权限, 请联系管理员");if("tagcomment"===this.editForm.type)if("replace"==this.editForm.tagcommentWay){if(this.tagIdCommentList.forEach((function(a){if(-1!=a.tagcomment.toLowerCase().indexOf(t.editForm.replaceTagCommentStr.toLowerCase())){var i={};i.tagid=a.tagid,i.gwsn=sessionStorage.getItem("gwsn"),i.tagcomment=a.tagcomment.replace(new RegExp(t.editForm.replaceTagCommentStr,"gi"),t.editForm.tagcomment),e.push(i)}})),0==e.length)return this.editForm.replaceTagCommentStr="",this.$message.warning(this.$t("attribute.modelIdentificationSource"));this.$http.post("/info/taginfo/updateListBySnAndTagId.do",e).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.$message.success(t.$t("prompt.success")),t.editAllVisible=!1,t.getDataList()})).catch((function(e){return t.editAllVisible=!1,t.getDataList()}))}else if("prepend"==this.editForm.tagcommentWay){if(this.tagIdCommentList.forEach((function(a){var i={};i.tagid=a.tagid,i.gwsn=sessionStorage.getItem("gwsn"),i.tagcomment=t.editForm.tagcomment+a.tagcomment,e.push(i)})),0==e.length)return this.editForm.replaceTagCommentStr="",this.$message.warning(this.$t("attribute.currentlyOperationalDataSource"));this.$http.post("/info/taginfo/updateListBySnAndTagId.do",e).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.$message.success(t.$t("prompt.success")),t.editAllVisible=!1,t.getDataList()})).catch((function(e){return t.editAllVisible=!1,t.getDataList()}))}else if("append"==this.editForm.tagcommentWay){if(this.tagIdCommentList.forEach((function(a){var i={};i.tagid=a.tagid,i.gwsn=sessionStorage.getItem("gwsn"),i.tagcomment=a.tagcomment+t.editForm.tagcomment,e.push(i)})),0==e.length)return this.editForm.replaceTagCommentStr="",this.$message.warning(this.$t("attribute.currentlyOperationalDataSource"));this.$http.post("/info/taginfo/updateListBySnAndTagId.do",e).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.$message.success(t.$t("prompt.success")),t.editAllVisible=!1,t.getDataList()})).catch((function(e){return t.editAllVisible=!1,t.getDataList()}))}else if("increasing"==this.editForm.tagcommentWay){var i=this.editForm.tagcomment.match(/[0-9]+\.*\d*/g),r=null,s="",n=null;if(i?(i=i[i.length-1],i.includes(".")?(s=this.editForm.tagcomment.substring(0,this.editForm.tagcomment.indexOf(i))+i.split(".")[0],r=i.split(".")[1],n=r):(s=this.editForm.tagcomment.substring(0,this.editForm.tagcomment.indexOf(i)),n=this.editForm.tagcomment.substring(this.editForm.tagcomment.indexOf(i),this.editForm.tagcomment.length))):s=this.editForm.tagcomment,this.editForm.tagcommentStep)if(1==this.editForm.tagcommentStep)this.tagIdCommentList.forEach((function(t,a){var r={};r.tagid=t.tagid,r.gwsn=sessionStorage.getItem("gwsn"),r.tagcomment=i?i.includes(".")?n?s+"."+n.substring(0,n.length-String(Number(i.split(".")[1])+Number(a)).length)+(Number(i.split(".")[1])+Number(a)):s+"."+(Number(i.split(".")[1])+Number(a)):s+(n?n.substring(0,n.length-String(Number(i)+Number(a)).length)+(Number(i)+Number(a)):Number(i)+Number(a)):s+a,e.push(r)}));else{var o=null;o=i?i.includes(".")?Number(i.split(".")[1]):Number(i):0,this.tagIdCommentList.forEach((function(a,l){var d={};d.tagid=a.tagid,d.gwsn=sessionStorage.getItem("gwsn"),d.tagcomment=i?i.includes(".")?n?s+"."+n.substring(0,n.length-String(o).length)+o:s+"."+(Number(r)+Number(t.editForm.tagcommentStep)):s+(n?n.substring(0,n.length-String(o).length)+o:o):s+o,e.push(d),o+=t.editForm.tagcommentStep}))}else this.tagIdCommentList.forEach((function(t,a){var r={};r.tagid=t.tagid,r.gwsn=sessionStorage.getItem("gwsn"),r.tagcomment=i?i.includes(".")?n?s+"."+n.substring(0,n.length-String(Number(i.split(".")[1])+Number(a)).length)+(Number(i.split(".")[1])+Number(a)):s+"."+(Number(i.split(".")[1])+Number(a)):s+(n?n.substring(0,n.length-String(Number(i)+Number(a)).length)+(Number(i)+Number(a)):Number(i)+Number(a)):s+a,e.push(r)}));if(0==e.length)return this.editForm.replaceTagCommentStr="",this.$message.warning(this.$t("attribute.currentlyOperationalDataSource"));this.$http.post("/info/taginfo/updateListBySnAndTagId.do",e).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.$message.success(t.$t("prompt.success")),t.editAllVisible=!1,t.getDataList()})).catch((function(e){return t.editAllVisible=!1,t.getDataList()}))}else if("clipboardSource"==this.editForm.tagcommentWay){var l=navigator.clipboard.readText();l.then((function(a){if(a=a.split("\r\n"),0==a.length)return t.$message.warning(t.$t("clipboardNoContent")),!1;if(1==a.length&&""==a[a.length-1])return t.$message.warning(t.$t("clipboardNoContent")),!1;if(a=""==a[a.length-1]?a.slice(0,a.length-1):a,a.length<t.tagIdCommentList.length)t.$confirm(t.$t("clipboardContentLengthInconsistentWithSelectedMeasuringPoint"),t.$t("prompt.title"),{confirmButtonText:t.$t("confirm"),cancelButtonText:t.$t("cancel"),type:"warning"}).then((function(){if(a.forEach((function(a,i){var r={};r.tagid=t.tagIdCommentList[i].tagid,r.gwsn=sessionStorage.getItem("gwsn"),r.tagcomment=a,e.push(r)})),0==e.length)return t.$message.warning(t.$t("attribute.currentlyOperationalDataSource"));t.$http.post("/info/taginfo/updateListBySnAndTagId.do",e).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.$message.success(t.$t("prompt.success")),t.editAllVisible=!1,t.getDataList()})).catch((function(e){return t.editAllVisible=!1,t.getDataList()}))})).catch((function(){}));else{if(t.tagIdCommentList.forEach((function(t,i){var r={};r.tagid=t.tagid,r.gwsn=sessionStorage.getItem("gwsn"),r.tagcomment=a[i],e.push(r)})),0==e.length)return t.$message.warning(t.$t("attribute.currentlyOperationalDataSource"));t.$http.post("/info/taginfo/updateListBySnAndTagId.do",e).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.$message.success(t.$t("prompt.success")),t.editAllVisible=!1,t.getDataList()})).catch((function(e){return t.editAllVisible=!1,t.getDataList()}))}})).catch((function(e){return t.$message.error(t.$t("failedToObtainClipboardContent"))}))}else{if(0==e.length)return this.editForm.replaceTagCommentStr="",this.$message.warning(this.$t("attribute.currentlyOperationalDataSource"));this.$http.post("/info/taginfo/updateListBySnAndTagId.do",e).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.$message.success(t.$t("prompt.success")),t.editAllVisible=!1,t.getDataList()})).catch((function(e){return t.editAllVisible=!1,t.getDataList()}))}else if("taginitvalue"===this.editForm.type)this.tagIdNameList.forEach((function(i){var r={};r.tagid=i.tagid,r.gwsn=sessionStorage.getItem("gwsn"),r[a]=t.editForm.changeValue,e.push(r)})),this.$refs["editForm"].validate((function(a){if(!a)return!1;t.$http.post("/info/taginfo/updateListBySnAndTagId.do",e).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.$message.success(a.msg),t.editAllVisible=!1,t.getDataList()})).catch((function(e){return t.editAllVisible=!1,t.getDataList()}))}));else{if("tagname"===this.editForm.type){if("replace"==this.editForm.way)this.tagIdNameList.forEach((function(a){if(-1!=a.name.toLowerCase().indexOf(t.editForm.replaceStr.toLowerCase())){var i={};i.tagid=a.tagid,i.gwsn=sessionStorage.getItem("gwsn"),i.tagname=a.name.replace(new RegExp(t.editForm.replaceStr,"gi"),t.editForm.tagnameStr),e.push(i)}}));else if("prepend"==this.editForm.way)this.tagIdNameList.forEach((function(a){var i={};i.tagid=a.tagid,i.gwsn=sessionStorage.getItem("gwsn"),i.tagname=t.editForm.tagnameStr+a.name,e.push(i)}));else if("append"==this.editForm.way)this.tagIdNameList.forEach((function(a){var i={};i.tagid=a.tagid,i.gwsn=sessionStorage.getItem("gwsn"),i.tagname=a.name+t.editForm.tagnameStr,e.push(i)}));else if("increment"==this.editForm.way){var d=this.editForm.tagnameStr;this.tagIdNameList.forEach((function(t,a){a>0&&(d=Object(c["n"])(d));var i={tagid:t.tagid,gwsn:sessionStorage.getItem("gwsn"),tagname:d};e.push(i)}))}if(0==e.length)return this.editForm.replaceStr="",this.$message.warning(this.$t("attribute.measuringPointNameReenterIt"))}else if("objaddr"==this.editForm.type){var g=/.*\..*/;if("step"==this.editForm.objaddrWay)if(-1!=this.$chineseChar2englishChar(String(this.editForm.startValue)).indexOf(",")){var m=this.$chineseChar2englishChar(String(this.editForm.startValue)).split(",")[0],u=this.$chineseChar2englishChar(String(this.editForm.startValue)).split(",")[1],h=null,p=null,f=this.$chineseChar2englishChar(String(u)),b=f.match(/\d+\.*\d*/g);if(b&&b.length>0){g.test(b[b.length-1])?(h=b[b.length-1].split(".")[1],p=f.substring(0,f.length-String(h).length)):(h=b[b.length-1],p=f.substring(0,f.length-String(h).length));var $=parseInt(h),v=Number(this.editForm.step),y=0,w="",S=parseInt(h);g.test(h)&&(y=h.split(".")[1]),g.test(h)?this.tagIdNameList.forEach((function(a){if(String(h).length>String(S).length){w="";for(var i=0;i<String(h).length-String(S).length;i++)w+="0"}else w="";var r={};r.tagid=a.tagid,r.gwsn=sessionStorage.getItem("gwsn"),r.objaddr=""!=w?m?m+","+p+w+S:p+w+S:m?m+","+p+S:p+S,y=Number(y)+Number(t.editForm.step),S=$+"."+y,e.push(r)})):this.tagIdNameList.forEach((function(t){if(String(h).length>String(S).length){w="";for(var a=0;a<String(h).length-String(S).length;a++)w+="0"}else w="";var i={};i.tagid=t.tagid,i.gwsn=sessionStorage.getItem("gwsn"),i.objaddr=""!=w?m?m+","+p+String(w)+S:p+w+S:m?m+","+p+S:p+S,S+=v,e.push(i)}))}}else{var L=this.generateAddresses(String(this.editForm.startValue),Number(this.editForm.step),this.tagIdNameList.length);this.tagIdNameList.forEach((function(t,a){var i={tagid:t.tagid,gwsn:sessionStorage.getItem("gwsn"),objaddr:L[a]};e.push(i)}))}else this.selectedTagIdAndObjAddrList.forEach((function(a){if(-1!=t.$chineseChar2englishChar(String(a.objaddr)).indexOf(",")){var i=t.$chineseChar2englishChar(String(a.objaddr)).split(",")[0],r=t.$chineseChar2englishChar(String(a.objaddr)).split(",")[1],s=null,n=null,o=t.$chineseChar2englishChar(String(r)),l=o.match(/\d+\.*\d*/g);if(l&&l.length>0){g.test(l[l.length-1])?(s=l[l.length-1].split(".")[1],n=o.substring(0,o.length-String(s).length)):(s=l[l.length-1],n=o.substring(0,o.length-String(s).length));var d=parseInt(s),c=Number(t.editForm.fixedValue),m=0,u="",h=parseInt(s);if(g.test(s)&&(m=s.split(".")[1]),g.test(s)){if(String(s).length>String(h).length){u="";for(var p=0;p<String(s).length-String(h).length;p++)u+="0"}else u="";var f={};f.tagid=a.tagid,f.gwsn=sessionStorage.getItem("gwsn"),m=Number(m)+Number(t.editForm.fixedValue),h=d+"."+m,f.objaddr=""!=u?i?i+","+n+u+h:n+u+h:i?i+","+n+h:n+h,e.push(f)}else{if(String(s).length>String(h).length){u="";for(var b=0;b<String(s).length-String(h).length;b++)u+="0"}else u="";var $={};$.tagid=a.tagid,$.gwsn=sessionStorage.getItem("gwsn"),h+=c,$.objaddr=""!=u?i?i+","+n+String(u)+h:n+u+h:i?i+","+n+h:n+h,e.push($)}}}else{var v=null,y=null,w=t.$chineseChar2englishChar(String(a.objaddr)),S=w.match(/\d+\.*\d*/g);if(S&&S.length>0){g.test(S[S.length-1])?(v=S[S.length-1].split(".")[1],y=w.substring(0,w.length-String(v).length)):(v=S[S.length-1],y=w.substring(0,w.length-String(v).length));var L=parseInt(v),I=0,x="",F=parseInt(v);if(g.test(v)&&(I=v.split(".")[1]),g.test(v)){if(String(v).length>String(F).length){x="";for(var C=0;C<String(v).length-String(F).length;C++)x+="0"}else x="";var k={};k.tagid=a.tagid,k.gwsn=sessionStorage.getItem("gwsn"),I=Number(I)+Number(t.editForm.fixedValue),F=L+"."+I,k.objaddr=""!=x?y?y+x+F:x+F:y?y+F:F,e.push(k)}else{if(String(v).length>String(F).length){x="";for(var A=0;A<String(v).length-String(F).length;A++)x+="0"}else x="";var O={};O.tagid=a.tagid,O.gwsn=sessionStorage.getItem("gwsn"),F+=Number(t.editForm.fixedValue),O.objaddr=""!=x?y?y+String(x)+F:x+F:y?y+F:F,e.push(O)}}}}))}else this.tagIdNameList.forEach((function(i){var r={};r.tagid=i.tagid,r.gwsn=sessionStorage.getItem("gwsn"),r[a]=t.editForm.changeValue,e.push(r)}));if("tagname"===this.editForm.type){var I=Object(c["s"])(e);if(!I)return void this.$message.warning("测点名称不符合命名规则");this.$refs["editForm"].validate((function(a){if(!a)return!1;t.$http.post("/info/taginfo/updateListBySnAndTagId.do",e).then((function(e){var a=e.data;if("OK"!==a.msg)return t.$message.error(a.data||a.msg);t.$message.success(a.data||a.msg),t.getDataList(),t.editAllVisible=!1})).catch((function(e){return t.getDataList(),t.editAllVisible=!1,!1}))}))}else this.$refs["editForm"].validate((function(a){if(!a)return!1;t.$http.post("/info/taginfo/updateListBySnAndTagId.do",e).then((function(e){var a=e.data;if(0!==a.code)return t.$message.error(a.data||a.msg);t.$message.success(a.msg),t.getDataList(),t.editAllVisible=!1})).catch((function(e){return t.getDataList(),t.editAllVisible=!1,!1}))}))}}else this.$message({showClose:!1,message:this.$t("gatewayNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),beforeUploadHandle:function(t){var e=t.size/1024/1024<65;return e||this.$message.error(this.$t("attribute.uploadFileLimitExceeded")),e},handleChange:function(t,e){},handleRemove:function(t,e){this.fileList=[]},uploadSectionFile:function(t){if("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==t.file.type||"application/vnd.ms-excel"==t.file.type||-1!=t.file.name.indexOf(".xlsx")||-1!=t.file.name.indexOf(".xls")){var e=new FormData;e.append("file",t.file),e.append("tagsource",1),e.append("devid",1),e.append("gwsn",sessionStorage.getItem("gwsn")),this.importfile(e)}else this.$message.warning(this.$t("attribute.errorType")),this.handleRemove()},importfile:l()((function(t){var e=this;this.$hasPermission("taginfo:import:permission.do")?this.$http.post("/info/taginfo/importZJExcle",t).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg),!1;e.$message.success(a.msg),e.getDataList(),e.handleRemove()})).catch((function(t){return e.getDataList(),!1})):this.$message.warning("暂无测点导入权限, 请联系管理员")}),1e3,{leading:!0,trailing:!1})},created:function(){this.page=Number(sessionStorage.getItem("page6"))||1,this.limit=Number(sessionStorage.getItem("limit6"))||1e3},mounted:function(){var t=this;t.isShowSetting=0!=sessionStorage.getItem("per"),t.$erd.listenTo(document.getElementById("centervarQueryContainer"),(function(e){var a=document.getElementById("centervarQueryContainer").offsetHeight;t.scrollTableHeight=window.innerHeight-130-a})),t.getDataList(),window.onresize=function(){return function(){var e=document.getElementById("centervarQueryContainer").offsetHeight;t.scrollTableHeight=window.innerHeight-130-e}()}},watch:{total:function(){this.total==(this.page-1)*this.limit&&0!=this.total&&(this.page-=1,sessionStorage.setItem("page6",this.page),this.getDataList())},page:function(){this.currentPageCheccked=!1},multipleSelectionAll:function(){0!=this.multipleSelectionAll.length&&this.multipleSelectionAll.length==this.dataList.length||(this.currentPageCheccked=!1)},dataList:{handler:function(t){this.allCheck&&(this.$set(this.checkboxConfig,"checkStrictly",!1),this.$refs.recordTable&&this.$refs.recordTable.setAllCheckboxRow(!0),this.$set(this.checkboxConfig,"checkStrictly",!0))},deep:!0}}},u=m,h=a("2877"),p=Object(h["a"])(u,i,r,!1,null,null,null);e["default"]=p.exports},e1a5:function(t,e,a){"use strict";a("ac4d"),a("8a81"),a("5df3"),a("1c4c"),a("7f7f"),a("6b54"),a("8e6e"),a("ac6a"),a("456d"),a("4917"),a("6762"),a("2fdb"),a("a481");var i=a("ade3"),r=a("a78e"),s=a.n(r),n=a("4328"),o=a.n(n),l=a("b047"),d=a.n(l);function g(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=c(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,n=!0,o=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return n=t.done,t},e:function(t){o=!0,s=t},f:function(){try{n||null==a.return||a.return()}finally{if(o)throw s}}}}function c(t,e){if(t){if("string"==typeof t)return m(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?m(t,e):void 0}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,i=Array(e);a<e;a++)i[a]=t[a];return i}function u(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function h(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?u(Object(a),!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var p=["/channelinfo","/deviceinfo","/taginfo","/transchannelinfo","/transdeviceinfo","/transtaginfo","/centervar","/scriptinfo","/integralmodule"];e["a"]={data:function(){return{ids:"",exportIds:null,mixinViewModuleOptions:{activatedIsNeed:!0,getDataListURL:"",getDataListIsPage:!1,deleteURL:"",deleteIsBatch:!1,deleteIsBatchKey:"id",exportURL:""},dataForm:{},dataList:[],order:"",orderField:"",page:1,limit:20,total:0,dataListLoading:!1,dataListSelections:[],addOrUpdateVisible:!1,storeselection:[]}},activated:function(){this.mixinViewModuleOptions.activatedIsNeed&&this.getDataList()},methods:{getDataList:function(){var t=this;this.dataListLoading=!0,this.$http.get(this.mixinViewModuleOptions.getDataListURL,{params:h({order:this.order,orderField:this.orderField,page:this.mixinViewModuleOptions.getDataListIsPage?this.page:null,limit:this.mixinViewModuleOptions.getDataListIsPage?this.limit:null},this.dataForm)}).then((function(e){var a=e.data;if(t.dataListLoading=!1,0!==a.code)return t.dataList=[],t.total=0,t.$message.error(a.msg);t.dataList=(t.mixinViewModuleOptions.getDataListIsPage,Array.isArray(a.data)?a.data:a.data.list),t.total=t.mixinViewModuleOptions.getDataListIsPage?a.data.total:0})).catch((function(e){return t.dataListLoading=!1,!1}))},dataListSelectionChangeHandle:function(t){this.storeselection=[],this.dataListSelections=t;var e,a=g(this.dataListSelections);try{for(a.s();!(e=a.n()).done;){var i=e.value;this.storeselection.push(i.id)}}catch(r){a.e(r)}finally{a.f()}this.ids=this.storeselection.join(","),this.$store.dispatch("changeIds",this.ids)},dataListSortChangeHandle:function(t){if(!t.order||!t.prop)return this.order="",this.orderField="",!1;this.order=t.order.replace(/ending$/,""),this.orderField=t.prop.replace(/([A-Z])/g,"_$1").toLowerCase(),this.getDataList()},pageSizeChangeHandle:function(t){this.page=1,this.limit=t,this.getDataList()},pageCurrentChangeHandle:function(t){this.page=t,this.getDataList()},addOrUpdateHandle:function(t){var e=this,a=!1;p.forEach((function(t){window.location.href.includes(t)&&(a=!0)})),a?this.$hasSessionStorageGwsn()?(this.addOrUpdateVisible=!0,this.$nextTick((function(){e.$refs.addOrUpdate.dataForm.id=t,e.$refs.addOrUpdate.init()}))):this.$message({showClose:!1,message:"未获取到网关编号",type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}}):(this.addOrUpdateVisible=!0,this.$nextTick((function(){e.$refs.addOrUpdate.dataForm.id=t,e.$refs.addOrUpdate.init()})))},deleteHandle:d()((function(t){var e=this;if(this.mixinViewModuleOptions.deleteIsBatch&&!t&&this.dataListSelections.length<=0)return this.$message.warning(this.$t("prompt.deleteBatch"));this.$confirm(this.$t("prompt.info",{handle:this.$t("delete")}),this.$t("prompt.title"),{confirmButtonText:this.$t("confirm"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((function(){e.dataListLoading=!0,e.$http.delete("".concat(e.mixinViewModuleOptions.deleteURL).concat(e.mixinViewModuleOptions.deleteIsBatch?"":"/"+t),e.mixinViewModuleOptions.deleteIsBatch?{data:t?[t]:e.dataListSelections.map((function(t){return t[e.mixinViewModuleOptions.deleteIsBatchKey]}))}:{}).then((function(t){var a=t.data;if(0!==a.code)return e.dataListLoading=!1,e.$message.error(a.msg);e.$message({message:e.$t("prompt.success"),type:"success",duration:500,onClose:function(){e.getDataList()}})})).catch((function(t){return e.dataListLoading=!1,!1}))})).catch((function(t){}))}),1e3,{leading:!0,trailing:!1}),postExcelFile:function(t,e){var a=document.createElement("form");for(var i in a.style.display="none",a.action=e,a.method="post",document.body.appendChild(a),t){var r=document.createElement("input");r.type="hidden",r.name=i,r.value=t[i],a.appendChild(r)}a.submit(),a.remove()},exportHandle:d()((function(){var t=!1,e={token:s.a.get("token"),ids:null};if(this.exportIds&&(e.ids=this.exportIds,t=!0),this.ids&&(e.ids=this.ids,t=!0),"/info/taginfo/exports"==this.mixinViewModuleOptions.exportURL||"/info/transtaginfo/exportss"==this.mixinViewModuleOptions.exportURL)return e.ids=this.exportIds,"/info/taginfo/exports"==this.mixinViewModuleOptions.exportURL&&-1!=window.location.href.indexOf("/taginfo")&&(e.devtype=window.devTagType),this.$message.success(this.$t("exportData.exportSuccess")),this.postExcelFile(e,"".concat(window.SITE_CONFIG["apiURL"]).concat(this.mixinViewModuleOptions.exportURL));"/sys/log/login/export"!=this.mixinViewModuleOptions.exportURL&&"/sys/log/operation/export"!=this.mixinViewModuleOptions.exportURL&&"/sys/log/error/export"!=this.mixinViewModuleOptions.exportURL||(t=!0);var a=o.a.stringify(e);if(!t)return this.$message.info(this.$t("exportData.noExportData"));var i=this,r="".concat(window.SITE_CONFIG["apiURL"]).concat(this.mixinViewModuleOptions.exportURL,"?").concat(a),n=new XMLHttpRequest;n.open("get",r),n.responseType="blob",n.send(),n.onreadystatechange=function(){if(4==n.readyState&&200==n.status){var t=i.browserType();if("ie"!==t.browser||"10.0"!=t.version&&"11.0"!=t.version)if("chrome"===t.browser){window.URL.createObjectURL(this.response),e=document.createElement("iframe");e.src="".concat(window.SITE_CONFIG["apiURL"]).concat(i.mixinViewModuleOptions.exportURL,"?").concat(a),e.style.display="none",document.body.appendChild(e)}else window.location.href="".concat(window.SITE_CONFIG["apiURL"]).concat(i.mixinViewModuleOptions.exportURL,"?").concat(a);else{window.URL.createObjectURL(this.response);var e=document.createElement("iframe");e.src="".concat(window.SITE_CONFIG["apiURL"]).concat(i.mixinViewModuleOptions.exportURL,"?").concat(a),e.style.display="none",document.body.appendChild(e)}return i.$message.success(i.$t("exportData.exportSuccess"))}}}),1e3,{leading:!0,trailing:!1}),browserType:function(){var t=navigator.userAgent.toLowerCase(),e={ie:function(){return!(!window.ActiveXObject&&!("ActiveXObject"in window))},edge:function(){return/dge/.test(t)},chrome:function(){return/chrome/.test(t)},safari:function(){return/safari/.test(t)&&!/chrome/.test(t)},opera:function(){return/opera/.test(t)},msie:function(){return/msie/.test(t)&&!/opera/.test(t)},mozilla:function(){return/mozilla/.test(t)&&!/(compatible|webkit)/.test(t)}},a={};for(var i in e){var r=e[i](),s=(t.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1];if(r)return a.browser=i,a.version=s,a}}}}}}]);
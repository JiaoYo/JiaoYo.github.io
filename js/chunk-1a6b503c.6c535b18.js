(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1a6b503c"],{"0e40":function(e,t,n){"use strict";n("4e8d")},2387:function(e,t,n){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"dialog"},[t("div",{staticClass:"dialog-container"},[t("div",{staticClass:"dialog-title"},[e._v(e._s(e.title))]),t("div",{staticClass:"content",domProps:{innerHTML:e._s(e.content)}}),t("div",{staticClass:"btns"},[t("div",{staticClass:"default-btn",on:{click:e.closeBtn}},[e._v(e._s(e.cancelText))]),t("div",{staticClass:"rerun-btn",on:{click:e.rerunBtn}},[e._v(e._s(e.rerunText))]),t("div",{staticClass:"danger-btn",on:{click:e.confirmAndRebootBtn}},[e._v(e._s(e.confirmAndRebootText))])]),t("div",{staticClass:"close-btn",on:{click:e.closeBtn}},[t("i",{staticClass:"el-icon-close"})])])])},o=[],s={name:"offlineissued",props:{type:{type:String,default:"default"},content:{type:String,default:""},title:{type:String,default:""},cancelText:{type:String,default:"取消"},rerunText:{type:String,default:"重启应用"},confirmAndRebootText:{type:String,default:"确定"}},methods:{closeBtn:function(){this.$emit("cancel")},confirmAndRebootBtn:function(){this.$emit("confirmAndReboot")},confirmBtn:function(){this.$emit("confirm")},rerunBtn:function(){this.$emit("rerun")}}},r=s,a=(n("0e40"),n("2877")),l=Object(a["a"])(r,i,o,!1,null,"2172313b",null);t["a"]=l.exports},"3b33":function(e,t,n){},"4e8d":function(e,t,n){},"52a9":function(e,t,n){"use strict";n("f229")},a7a1:function(e,t,n){"use strict";n("3b33")},bd6e:function(e,t,n){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"dialog"},[t("div",{staticClass:"dialog-container"},[t("div",{staticClass:"dialog-title"},[e._v(e._s(e.title))]),t("div",{staticClass:"content",domProps:{innerHTML:e._s(e.content)}}),e.isShowCheckbox?t("div",{staticClass:"content",staticStyle:{"margin-top":"10px"}},[t("el-checkbox",{model:{value:e.checkboxValue,callback:function(t){e.checkboxValue=t},expression:"checkboxValue"}},[e._v("是否更新驱动")])],1):e._e(),t("div",{staticClass:"btns"},[t("div",{staticClass:"default-btn",on:{click:e.closeBtn}},[e._v(e._s(e.cancelText))]),e.returnVisible?t("div",{staticClass:"rerun-btn",on:{click:e.rerunBtn}},[e._v(e._s(e.rerunText))]):e._e(),e.confirmAndRebootVisible?t("div",{staticClass:"danger-btn",on:{click:e.confirmAndRebootBtn}},[e._v(e._s(e.confirmAndRebootText))]):e._e(),e.confirmVisible?t("div",{staticClass:"confirm-btn",on:{click:e.confirmBtn}},[e._v(e._s(e.confirmText))]):e._e()]),t("div",{staticClass:"close-btn",on:{click:e.closeBtn}},[t("i",{staticClass:"el-icon-close"})])])])},o=[],s={name:"rebootrun",props:{type:{type:String,default:"default"},content:{type:String,default:""},title:{type:String,default:""},isShowCheckbox:{type:Boolean,default:!1},isUpdateDriver:{type:Boolean,default:!1},cancelText:{type:String,default:"取消"},returnVisible:{type:Boolean,default:!0},rerunText:{type:String,default:"重启应用"},confirmAndRebootVisible:{type:Boolean,default:!0},confirmAndRebootText:{type:String,default:"确定"},confirmVisible:{type:Boolean,default:!0},confirmText:{type:String,default:"稍后自行重启"}},data:function(){return{checkboxValue:this.isUpdateDriver}},methods:{closeBtn:function(){this.$emit("cancel")},confirmAndRebootBtn:function(){this.$emit("confirmAndReboot")},confirmBtn:function(){this.$emit("confirm")},rerunBtn:function(){this.$emit("rerun")}},watch:{checkboxValue:function(e){this.$emit("update:isUpdateDriver",e)},isUpdateDriver:function(e){this.checkboxValue=e}}},r=s,a=(n("e8b6"),n("2877")),l=Object(a["a"])(r,i,o,!1,null,"ebbafae2",null);t["a"]=l.exports},be83:function(e,t,n){"use strict";n.r(t);n("7f7f");var i=function(){var e=this,t=e._self._c;return t("el-container",[t("el-aside",{staticClass:"aui-sidebar aui-sidebar--dark",staticStyle:{top:"0"},attrs:{width:"210px"}},[t("el-menu",{staticClass:"aui-sidebar__menu",staticStyle:{width:"210px"},attrs:{router:"","unique-opened":"","default-active":e.$route.path}},[e._l(e.menuList,(function(n){return[n.children&&n.children.length>0?t("el-submenu",{key:"submenu-"+n.id,attrs:{index:String(n.id)},scopedSlots:e._u([{key:"title",fn:function(){return[t("i",{class:"el-"+n.icon}),t("span",[e._v(e._s(n.name))])]},proxy:!0}],null,!0)},[e._l(n.children,(function(n){return[n.url?t("el-menu-item",{key:"menuitem-"+n.id,attrs:{index:"/"+n.url}},[t("i",{class:"el-"+n.icon}),t("span",[e._v(e._s(n.name))])]):t("el-submenu",{key:"submenu-"+n.id,attrs:{index:String(n.id)},scopedSlots:e._u([{key:"title",fn:function(){return[t("i",{class:"el-"+n.icon}),t("span",[e._v(e._s(n.name))])]},proxy:!0}],null,!0)})]}))],2):n.url?t("el-menu-item",{key:"menuitem-"+n.id,attrs:{index:"/"+n.url}},[t("i",{class:"el-"+n.icon}),t("span",[e._v(e._s(n.name))])]):e._e()]}))],2)],1),t("el-container",{directives:[{name:"loading",rawName:"v-loading",value:e.downloadLoading,expression:"downloadLoading"}],staticStyle:{"margin-left":"210px",width:"100%"}},[t("el-header",{staticStyle:{height:"auto",padding:"10px 20px"}},[t("div",[e.isShowSetting?t("span",[e._v(e._s(e.$t("configuration.project")))]):e._e(),e.isShowSetting?t("span",{staticClass:"colorConfig"},[e._v(e._s(e.projectName))]):e._e(),e.isShowSetting?t("span",[e._v("    ")]):e._e(),t("span",[e._v(e._s(e.$t("configuration.gateway")))]),t("span",{staticClass:"colorConfig"},[e._v("\n                    "+e._s(e.gwsn)+"\n                    "),e.gwDesc&&"null"!=e.gwDesc?t("span",[e._v(e._s("("+e.gwDesc+")"))]):e._e()]),t("span",[e._v("    ")]),t("span",[e._v(e._s(e.$t("configuration.eventTime")))]),t("span",{class:"离线"===e.lineStatus?"colorConfig redConfig":"colorConfig"},[e._v("\n                    "+e._s(e.activityTime)+"\n                ")]),t("span",[e._v("    ")]),t("span",[e._v(e._s(e.$t("configuration.status")))]),t("span",{class:"离线"===e.lineStatus?"colorConfig redConfig":"colorConfig"},[e._v("\n                    "+e._s("离线"==e.lineStatus?e.$t("chlwatch.offLine"):"在线"==e.lineStatus?e.$t("chlwatch.inLine"):e.lineStatus)+"\n                ")]),t("span",[e._v("    ")]),t("el-button",{attrs:{size:"small"},on:{click:e.refresh}},[t("i",{staticClass:"el-icon-refresh"})])],1),e.isShowSetting&&(e.$hasPermission("socketsOne:distribution:websocket")||e.$hasPermission("socketNine:getDownfile:websocket")||e.$hasPermission("socketTwo:uploadfile:websocket")||e.$hasPermission("channel:detection:select:websocket")&&e.$hasPermission("socketFour:chlwatch:websocket")||e.$hasPermission("socketTwo:reRun:websocket")||e.$hasPermission("socketsOne:reboot:websocket")||e.$hasPermission("offlineIssue:insert:permission.do"))?t("div",[t("el-dropdown",{attrs:{trigger:"click"}},[t("el-button",{staticClass:"search-btn",attrs:{size:"mini"}},[e._v("\n                        "+e._s(e.$t("handle"))+"\n                        "),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e.$hasPermission("socketsOne:distribution:websocket")?t("el-dropdown-item",{nativeOn:{click:function(t){return e.configissued.apply(null,arguments)}}},[e._v("\n                            "+e._s(e.$t("configuration.engineeringIssuance"))+"\n                        ")]):e._e(),e.$hasPermission("gwsn:uploadCer:insert:permission.do")&&e.$hasPermission("socketNine:getDownfile:websocket")?t("el-dropdown-item",{nativeOn:{click:function(t){return e.uploadCertificate.apply(null,arguments)}}},[e._v("\n                            "+e._s(e.$t("configuration.uploadCertificate"))+"\n                        ")]):e._e(),e.$hasPermission("gwsn:readProject:insert:permission.do")&&e.$hasPermission("socketTwo:uploadfile:websocket")?t("el-dropdown-item",{nativeOn:{click:function(t){return e.readconfigura.apply(null,arguments)}}},[e._v("\n                            "+e._s(e.$t("configuration.readEngineering"))+"\n                        ")]):e._e(),e.$hasPermission("gwsn:synchronization:insert:permission.do")&&e.$hasPermission("socketTwo:uploadfile:websocket")?t("el-dropdown-item",{nativeOn:{click:function(t){return e.recoverColund.apply(null,arguments)}}},[e._v("\n                            "+e._s(e.$t("configuration.gatewaySynchronizationToCloud"))+"\n                        ")]):e._e(),e.$hasPermission("gwsn:readlog:insert:permission.do")&&e.$hasPermission("socketTwo:uploadfile:websocket")?t("el-dropdown-item",{nativeOn:{click:function(t){return e.readlog.apply(null,arguments)}}},[e._v("\n                            "+e._s(e.$t("configuration.readLogs"))+"\n                        ")]):e._e(),e.$hasPermission("channel:detection:select:websocket")&&e.$hasPermission("socketFour:chlwatch:websocket")?t("el-dropdown-item",{attrs:{disabled:e.channelDisabled},nativeOn:{click:function(t){return e.channelmonitoring.apply(null,arguments)}}},[e._v("\n                            "+e._s(e.$t("configuration.channelMonitoring"))+"\n                        ")]):e._e(),e.$hasPermission("socketTwo:reRun:websocket")?t("el-dropdown-item",{nativeOn:{click:function(t){return e.restartApplication.apply(null,arguments)}}},[e._v("\n                            "+e._s(e.$t("gwsnSetting.restartApp"))+"\n                        ")]):e._e(),e.$hasPermission("gwbaseinfo:configuration:permission.do")&&e.$hasPermission("socketsOne:reboot:websocket")?t("el-dropdown-item",{nativeOn:{click:function(t){return e.restart.apply(null,arguments)}}},[e._v("\n                            "+e._s(e.$t("configuration.restartGateway"))+"\n                        ")]):e._e(),e.$hasPermission("offlineIssue:insert:permission.do")?t("el-dropdown-item",{nativeOn:{click:function(t){return e.handleOfflineIssuedChange.apply(null,arguments)}}},[e._v("\n                            "+e._s(e.$t("configuration.offlineEngineeringDistribution"))+"\n                        ")]):e._e()],1)],1)],1):e._e()]),t("el-main",[t("el-dialog",{attrs:{visible:e.dialogVisible,width:"20%",id:"el-dialog","close-on-click-modal":!1,"before-close":e.handleCloseDownload},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-progress",{attrs:{type:"circle",percentage:e.percentage}})],1),t("el-dialog",{attrs:{visible:e.offlineDialogVisible,width:"20%",id:"el-dialog-offline","close-on-click-modal":!1,"show-close":!1},on:{"update:visible":function(t){e.offlineDialogVisible=t}}},[t("el-progress",{attrs:{type:"circle",percentage:e.offLinePercentage}})],1),t("rebootrun",{directives:[{name:"show",rawName:"v-show",value:e.confirmVisible,expression:"confirmVisible"}],attrs:{title:e.$t("prompt.title"),content:e.content,isShowCheckbox:!1,isUpdateDriver:e.isUpdateDriver,dangerText:e.$t("confirm"),rerunText:e.$t("gwsnSetting.restartApp"),confirmText:e.$t("gwsnSetting.restartOnYourOwnLater"),cancelText:e.$t("cancel")},on:{"update:isUpdateDriver":function(t){return e.isUpdateDriver=t},cancel:function(t){return e.clickCancel()},rerun:function(t){return e.restartRerun()},confirmAndReboot:function(t){return e.clickConfirmAndReboot()},confirm:function(t){return e.clickConfirm()}}}),t("offlineissued",{directives:[{name:"show",rawName:"v-show",value:e.offlineissuedVisible,expression:"offlineissuedVisible"}],attrs:{title:e.$t("prompt.title"),content:e.offlineissuedContent,dangerText:e.$t("confirm"),rerunText:e.$t("gwsnSetting.restartApp"),cancelText:e.$t("cancel")},on:{cancel:function(t){return e.handleOfflineCancel()},rerun:function(t){return e.handleOfflineRestartRerun()},confirmAndReboot:function(t){return e.handleOfflineConfirmAndReboot()}}}),t("el-dialog",{attrs:{visible:e.uploadCertificateVisible,title:e.$t("configuration.uploadCertificate"),"close-on-click-modal":!1,"before-close":e.handleCloseuploadCertificate},on:{"update:visible":function(t){e.uploadCertificateVisible=t}}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.uploadCertificateLoading,expression:"uploadCertificateLoading"}],ref:"uploadCertificateForm",attrs:{model:e.uploadCertificateForm,rules:e.uploadCertificateRules,"label-width":(e.$i18n.locale,"150px")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleuploadCertificate()}}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:e.$t("configuration.bindTargetChannel"),prop:"chlname"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("configuration.pleaseSelectTheTargetChannel")},on:{change:e.handleChannelSelect},model:{value:e.uploadCertificateForm.chlname,callback:function(t){e.$set(e.uploadCertificateForm,"chlname",t)},expression:"uploadCertificateForm.chlname"}},e._l(e.channelList,(function(n,i){return t("el-option",{key:i,attrs:{label:n.chlName,value:n.id}},[t("span",{staticStyle:{width:"calc(100% - 100px)",display:"inline-block","text-align":"left",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:n.chlName}},[e._v("\n                                            "+e._s(n.chlName)+"\n                                        ")]),t("span",{staticStyle:{color:"#8492a6","font-size":"13px",display:"inline-block",width:"100px","text-align":"right",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:n.chlComment}},[e._v("\n                                            "+e._s(n.chlComment||e.$t("historyQuery.no"))+"\n                                        ")])])})),1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:e.$t("configuration.caFile")}},[t("el-input",{attrs:{type:"text",placeholder:e.$t("configuration.pleaseUploadTheCaFile"),readonly:""},model:{value:e.uploadCertificateForm.cafilename,callback:function(t){e.$set(e.uploadCertificateForm,"cafilename",t)},expression:"uploadCertificateForm.cafilename"}},[t("template",{slot:"append"},[t("el-upload",{attrs:{action:"","file-list":e.fileList,"http-request":e.uploadSectionFile,"on-remove":e.handleRemove,"show-file-list":!1},on:{"on-change":e.handleChange}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-upload"}},[e._v(e._s(e.$t("attribute.upload")))])],1)],1)],2)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:e.$t("configuration.clientCertificateFile")}},[t("el-input",{attrs:{type:"text",placeholder:e.$t("configuration.pleaseUploadTheClientCertificateFile"),readonly:""},model:{value:e.uploadCertificateForm.clientfilename,callback:function(t){e.$set(e.uploadCertificateForm,"clientfilename",t)},expression:"uploadCertificateForm.clientfilename"}},[t("template",{slot:"append"},[t("el-upload",{attrs:{action:"","file-list":e.clientfileList,"http-request":e.uploadSectionClientFile,"on-remove":e.handleClientRemove,"show-file-list":!1},on:{"on-change":e.handleClientChange}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-upload"}},[e._v(e._s(e.$t("attribute.upload")))])],1)],1)],2)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:e.$t("configuration.clientKeyFile")}},[t("el-input",{attrs:{type:"text",placeholder:e.$t("configuration.pleaseUploadTheClientKeyFile"),readonly:""},model:{value:e.uploadCertificateForm.clientkeyfilename,callback:function(t){e.$set(e.uploadCertificateForm,"clientkeyfilename",t)},expression:"uploadCertificateForm.clientkeyfilename"}},[t("template",{slot:"append"},[t("el-upload",{attrs:{action:"","file-list":e.clientKeyfileList,"http-request":e.uploadSectionClientKeyFile,"on-remove":e.handleClientKeyRemove,"show-file-list":!1},on:{"on-change":e.handleClientKeyChange}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-upload"}},[e._v(e._s(e.$t("attribute.upload")))])],1)],1)],2)],1)],1)],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:e.handleCloseuploadCertificate}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleuploadCertificate()}}},[e._v(e._s(e.$t("confirm")))])],1)],2),t("el-dialog",{attrs:{visible:e.readPrjVisible,title:"读取工程类型选择","close-on-click-modal":!1,"before-close":e.handleCloseReadprjChange},on:{"update:visible":function(t){e.readPrjVisible=t}}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.readPrjLoading,expression:"readPrjLoading"}],ref:"readPrjForm",attrs:{model:e.readPrjForm,"label-width":(e.$i18n.locale,"150px")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleConfirmReadprjChange()}}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"类型",prop:"type"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("select")},on:{change:e.handleReadPrjSelectChange},model:{value:e.readPrjForm.type,callback:function(t){e.$set(e.readPrjForm,"type",t)},expression:"readPrjForm.type"}},e._l(e.readPrjTypeList,(function(e,n){return t("el-option",{key:n,attrs:{label:e.label,value:e.value}})})),1)],1)],1),2==e.readPrjForm.type?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"工程文件",prop:"fileIndex"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("select")},model:{value:e.readPrjForm.fileIndex,callback:function(t){e.$set(e.readPrjForm,"fileIndex",t)},expression:"readPrjForm.fileIndex"}},e._l(e.readPrjForm.projectList,(function(e,n){return t("el-option",{key:n,attrs:{label:e.file_name,value:e.ordinal}})})),1)],1)],1):e._e()],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:e.handleCloseReadprjChange}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleConfirmReadprjChange()}}},[e._v(e._s(e.$t("confirm")))])],1)],2),t("el-dialog",{attrs:{visible:e.readconfigVisible,width:"20%",title:e.$t("configuration.readEngineeringFileDownload"),id:"el-dialog-config","close-on-click-modal":!1,"before-close":e.handleCloseDownload},on:{"update:visible":function(t){e.readconfigVisible=t}}},[e.projectUrl?t("div",[t("i",[e._v(e._s(e.$t("configuration.ifUnableToDownloadNormallyPleaseClickHere"))+" "),t("a",{ref:"projectRef",attrs:{href:"javascript:void(0)",target:"_blank"},on:{click:e.handleProjectDownLoad}},[e._v(e._s(e.$t("configuration.link")))]),e._v("\n                    "+e._s(e.$t("configuration.download")))]),t("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"primary"},on:{click:e.downLoad}},[e._v(e._s(e.$t("oss.download")))])],1):t("div",{staticStyle:{height:"150px",display:"flex","justify-content":"center","align-items":"center",width:"100%"}},[t("div",{staticClass:"dot-spinner"},[t("div",{staticClass:"dot-spinner__dot"}),t("div",{staticClass:"dot-spinner__dot"}),t("div",{staticClass:"dot-spinner__dot"}),t("div",{staticClass:"dot-spinner__dot"}),t("div",{staticClass:"dot-spinner__dot"}),t("div",{staticClass:"dot-spinner__dot"}),t("div",{staticClass:"dot-spinner__dot"}),t("div",{staticClass:"dot-spinner__dot"})])])]),e.cmdlineVisible?t("Commandline",{ref:"commandline"}):e._e(),e.isRouterAlive?t("router-view"):e._e(),e.readlogVisible?t("div",{directives:[{name:"dialogDragMove",rawName:"v-dialogDragMove"}],ref:"readlogBox",staticStyle:{cursor:"move",position:"fixed",right:"10px",bottom:"10px","z-index":"2002",width:"360px",height:"200px",background:"#fff","box-shadow":"0 1px 3px rgba(0,0,0,.3)",padding:"20px 30px"},attrs:{id:"readlogBox"}},[t("div",{staticStyle:{"margin-bottom":"40px",position:"relative"}},[t("div",{staticStyle:{"line-height":"24px","font-size":"18px",color:"#303133","text-align":"center"}},[e._v(e._s(e.$t("configuration.readLogFileDownload")))]),t("div",{staticStyle:{position:"absolute",right:"-10px",top:"0",cursor:"pointer"},on:{click:e.handleCloseReadlogChange}},[t("i",{staticClass:"el-icon-close"})])]),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.readlogLoading,expression:"readlogLoading"}]},[t("div",[t("i",[e._v(e._s(e.$t("configuration.ifUnableToDownloadNormallyPleaseClickHere"))),t("a",{ref:"logRef",attrs:{href:"javascript:void(0)",target:"_blank"},on:{click:e.handleLogDownLoad}},[e._v(e._s(e.$t("configuration.link")))]),e._v("\n                        "+e._s(e.$t("configuration.download")))])]),t("div",{staticStyle:{"text-align":"center"}},[t("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"primary"},on:{click:e.downLoadlog}},[e._v(e._s(e.$t("oss.download")))])],1)])]):e._e(),t("el-dialog",{attrs:{id:"reRunApplicationDialog",center:"",visible:e.reRunApplicationVisible,width:"20%","close-on-click-modal":!1,"before-close":e.handleCloseDownload},on:{"update:visible":function(t){e.reRunApplicationVisible=t}}},[t("div",{staticStyle:{height:"150px",display:"flex","justify-content":"center","align-items":"center",width:"100%"}},[t("div",{staticClass:"dot-spinner"},[t("div",{staticClass:"dot-spinner__dot"}),t("div",{staticClass:"dot-spinner__dot"}),t("div",{staticClass:"dot-spinner__dot"}),t("div",{staticClass:"dot-spinner__dot"}),t("div",{staticClass:"dot-spinner__dot"}),t("div",{staticClass:"dot-spinner__dot"}),t("div",{staticClass:"dot-spinner__dot"}),t("div",{staticClass:"dot-spinner__dot"})])])])],1)],1)],1)},o=[],s=(n("28a5"),n("4917"),n("6b54"),n("7514"),n("53ca")),r=(n("96cf"),n("1da1")),a=(n("a481"),n("4328")),l=n.n(a),c=n("9dce"),u=n("b047"),d=n.n(u),f=n("a78e"),g=n.n(f),h=n("795d"),m=n("bd6e"),p=n("2387"),w=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.cmdlineVisible,title:"命令行","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!0},on:{"update:visible":function(t){e.cmdlineVisible=t},close:e.handleCmd}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataForm",attrs:{model:e.dataForm,rules:e.rules,"label-width":"50px"},nativeOn:{submit:function(e){e.preventDefault()}}},[1==e.superAdmin?t("el-row",[t("el-col",{attrs:{span:20}},[t("el-form-item",{attrs:{label:"命令",prop:"inputValue"}},[t("el-input",{ref:"siteInput",attrs:{placeholder:"请输入命令","auto-complete":"off"},on:{focus:function(t){return e.focus(t)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.send()}},model:{value:e.dataForm.inputValue,callback:function(t){e.$set(e.dataForm,"inputValue",t)},expression:"dataForm.inputValue"}})],1)],1),t("el-col",{attrs:{span:4}},[t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.send}},[e._v("发送")])],1)],1)],1):e._e(),0==e.superAdmin?t("el-row",[t("el-col",{attrs:{span:9}},[t("el-form-item",{attrs:{label:"命令",prop:"inputValue"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.selectCommand},model:{value:e.dataForm.inputValue,callback:function(t){e.$set(e.dataForm,"inputValue",t)},expression:"dataForm.inputValue"}},e._l(e.commandList,(function(e,n){return t("el-option",{key:n,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:9}},[t("el-form-item",{attrs:{label:"——",prop:"addContent"}},[t("el-input",{attrs:{type:"text",placeholder:"请输入内容"},model:{value:e.dataForm.addContent,callback:function(t){e.$set(e.dataForm,"addContent",t)},expression:"dataForm.addContent"}})],1)],1),t("el-col",{attrs:{span:4,offset:2}},[t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.send}},[e._v("发送")])],1)],1)],1):e._e(),t("el-row",[t("el-form-item",{attrs:{label:"",prop:"content"}},[t("el-input",{attrs:{type:"textarea",autosize:{minRows:2},placeholder:"",readonly:""},model:{value:e.dataForm.content,callback:function(t){e.$set(e.dataForm,"content",t)},expression:"dataForm.content"}})],1)],1)],1)],1)},b=[],k={data:function(){return{wsUrl:"",textarea:"",loading:!1,websocket:null,isClose:!1,lockReconnect:!1,timeoutObj:null,recconectTimer:null,cmdlineVisible:!1,superAdmin:0,dataForm:{content:"",inputValue:"route",addContent:""},rules:{inputValue:[{required:!0,message:"必填项不能为空",trigger:"change"}]},commandList:[{label:"route",value:"route"},{label:"pwd",value:"pwd"},{label:"ifconfig",value:"ifconfig"},{label:"ping",value:"ping"},{label:"ls",value:"ls"},{label:"ps",value:"ps"},{label:"cat",value:"cat"},{label:"echo",value:"echo"}]}},methods:{init:function(){var e=this;this.wsUrl="",this.cmdlineVisible=!0,this.getSuperAdmin(),this.loading=!1,this.$nextTick((function(){e.dataForm.content="",1==e.superAdmin&&(e.$refs["dataForm"].resetFields(),e.$refs["siteInput"].focus()),e.isClose=!1}))},focus:function(){this.$refs["siteInput"].select()},getSuperAdmin:function(){this.superAdmin=localStorage.getItem("superAdmin"),1==this.superAdmin&&(this.dataForm.inputValue="")},createWebSocket:function(){var e=this;if(!("WebSocket"in window))return e.$message.error("当前浏览器不支持WebSocket");try{var t=window.SITE_CONFIG["socketUrl"]+e.wsUrl;e.websocket=new WebSocket(t),e.initWebSocket()}catch(n){e.reConnect()}},initWebSocket:function(){this.websocket.onopen=this.websocketonopen,this.websocket.onerror=this.websocketonerror,this.websocket.onmessage=this.websocketonmessage,this.websocket.onclose=this.websocketonclose},heartCheck:function(){var e=this,t={timeout:2e4,timeoutObj:null,start:function(){e.timeoutObj=setTimeout((function(){e.lockReconnect&&e.websocket.send("connect success")}),2e4)},reset:function(){clearTimeout(e.timeoutObj),t.start()}};return t},reConnect:function(){var e=this;e.lockReconnect||(e.recconectTimer&&clearTimeout(e.recconectTimer),e.recconectTimer=setTimeout((function(){e.createWebSocket()}),3e3))},websocketonopen:function(){this.lockReconnect=!0,this.heartCheck().start()},websocketonerror:function(e){this.lockReconnect=!1,this.reConnect()},isJsonString:function(e){if("string"===typeof e)try{var t=JSON.parse(e);return!("object"!==Object(s["a"])(t)||!t)}catch(n){return!1}},websocketonmessage:function(e){if(!this.isJsonString(e.data))return!1;this.loading=!1,this.isClose=!0,this.websocket&&this.websocket.close(),this.dataForm.content=JSON.parse(e.data).res_content.reslut,1==this.superAdmin&&this.focus(),this.heartCheck().reset()},websocketonclose:function(e){this.lockReconnect=!1,this.isClose||this.reConnect()},handleCmd:function(){this.recconectTimer&&clearTimeout(this.recconectTimer),this.websocket&&this.websocket.close(),this.isClose=!0,this.cmdlineVisible=!1},selectCommand:function(e){this.dataForm.content="",this.dataForm.addContent=""},send:d()((function(){var e=this,t="";e.$hasPermission("socketTwo:cmd:websocket")?e.$refs["dataForm"].validate((function(n){n&&(e.loading=!0,t=e.dataForm.addContent?e.dataForm.inputValue+" "+e.dataForm.addContent:e.dataForm.inputValue,e.wsUrl="socketTwo/cmd.do/"+sessionStorage.getItem("gwsn")+"/"+t,e.createWebSocket(),setTimeout((function(){if(!e.dataForm.content)return e.focus(),e.loading=!1,e.$message.error("下发命令超时，请确定网关是否在线后重试")}),"30000"))})):e.$message.warning("暂无命令行调试权限")}),1e3,{leading:!0,trailing:!1})}},v=k,$=n("2877"),S=Object($["a"])(v,w,b,!1,null,null,null),C=S.exports,y=n("ed08"),_=n("a18c"),L={provide:function(){return{reload:this.reload}},data:function(){return{isShowSetting:!1,superAdmin:0,menuList:[],offlineissuedVisible:!1,offlineissuedContent:"",offLinePercentage:0,offlineDialogVisible:!1,projectUrl:"",logUrl:"",isRouterAlive:!0,count:0,resname:"",wsUrl:"",variable_point:0,recoverFileList:[],lockStatus:null,judgeLength:[],channelList:[],fileList:[],clientfileList:[],clientKeyfileList:[],downloadLoading:!1,isReboot:!1,isRerun:!1,timer:null,uploadCount:0,websocket:null,lockReconnect:!1,timeoutObj:null,recoverShow:!0,recoverCount:0,onOrofflineTimer:null,confirmVisible:!1,channelDisabled:!1,content:"",percentage:0,configIssue:{},gwsn:"",gwDesc:"",prjId:"",model:"",gwSoftVer:"",activityTime:"",lineStatus:0,defaultActive:"",projectName:"",uploadCertificateVisible:!1,uploadCertificateLoading:!1,uploadCertificateForm:{chlname:"",selectChlname:"",clientPassword:"",cafilename:"",clientfilename:"",clientkeyfilename:"",cafileUrl:"",clientfileUrl:"",clientkeyfileUrl:"",cafileContent:"",clientfileContent:"",clientkeyContent:""},dialogVisible:!1,channelVisible:!1,fileUrl:"",readconfigVisible:!1,url:"",readlogVisible:!1,readPrjVisible:!1,readPrjLoading:!1,readPrjTypeList:[{label:"当前工程",value:1},{label:"历史工程",value:2}],readPrjForm:{type:1,fileIndex:null,projectList:[]},cmdlineVisible:!1,uploadCertificateTimer:null,uploadCertificateRules:{chlname:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]},onlineWebsocket:null,onLineLockReconnect:!1,recconectOnLineTimer:null,isOnlineClose:!1,wsDriveurl:"",driveCode:null,websocketDrive:null,lockDriveReconnect:!1,recconectDriveTimer:null,readlogLoading:!1,logWsurl:"",logWebsocket:null,lockLogReconnect:!1,recconectLogTimer:null,reRunApplicationVisible:!1,isUpdateDriver:!1}},components:{Commandline:C,"dialog-bar":h["a"],rebootrun:m["a"],offlineissued:p["a"]},methods:{getPrjInfo:function(){var e=this;if("null"===this.prjId)this.projectName="无";else if(this.prjId){if(!this.$hasPermission("tprjinfo:select:permission.do"))return void this.$message.warning("暂无项目信息查询权限, 请联系管理员");this.$http.get("/info/tprjinfo/".concat(this.prjId)).then((function(t){var n=t.data;n.data?e.projectName=n.data.prjName:e.projectName="无"})).catch((function(e){return!1}))}},createOnLineWebSocket:function(){var e=this;if(!("WebSocket"in window))return e.$message.error(this.$t("websocket.notSupportWebsocket"));try{var t=e.encryMD5(sessionStorage.getItem("gwsn")),n=window.SITE_CONFIG["socketUrl"]+"heart/".concat(sessionStorage.getItem("gwsn"),"/").concat(t)+"?token="+e.$getToken();e.onlineWebsocket=new WebSocket(n),e.initOnlineWebSocket()}catch(i){e.onLineReConnect()}},initOnlineWebSocket:function(){this.onlineWebsocket.onopen=this.onLineWebsocketonopen,this.onlineWebsocket.onerror=this.onLineWebsocketonerror,this.onlineWebsocket.onmessage=this.onLineWebsocketonmessage,this.onlineWebsocket.onclose=this.onLineWebsocketonclose},onLineReConnect:function(){var e=this;e.onLineLockReconnect||(e.recconectOnLineTimer&&clearTimeout(e.recconectOnLineTimer),e.recconectOnLineTimer=setTimeout((function(){e.createOnLineWebSocket()}),5e3))},onLineWebsocketonopen:function(){this.isOnlineClose=!0,this.onLineLockReconnect=!0,this.heartCheck().start()},onLineWebsocketonerror:function(e){this.onLineLockReconnect=!1,this.onLineReConnect()},onLineWebsocketonmessage:function(e){return this.heartCheck().reset(),"连接成功"!=e.data&&"connect success"!=e.data&&(1==e.data?(localStorage.setItem("offLineStatus"+sessionStorage.getItem("gwsn"),""),this.refresh(),this.$message.success(this.$t("configuration.theGatewayHasBeenLaunchedOnline"))):0==e.data?(localStorage.setItem("offLineStatus"+sessionStorage.getItem("gwsn"),""),this.refresh()):void 0)},onLineWebsocketonclose:function(e){this.isOnlineClose?this.onLineLockReconnect=!1:(this.onLineLockReconnect=!1,this.onLineReConnect())},getOnlineInfo:function(){var e=this,t=this;if(sessionStorage.getItem("gwsn")){var n={gwsn:sessionStorage.getItem("gwsn")};if(!t.$hasPermission("tgwinfo:select:permission.do"))return void t.$message.warning("暂无查询网关在线状态权限, 请联系管理员");t.$http.post("/info/tgwinfo/selectStatus",l.a.stringify(n)).then((function(n){var i=n.data;if("OK"!==i.msg)return t.activityTime=i.data.lastTime,t.lineStatus=1===i.data.status?"在线":"离线",localStorage.setItem("offLineStatus"+sessionStorage.getItem("gwsn"),1!==i.data.status||""),t.$message.error(e.$t("configuration.theGatewayIsOffline"));t.activityTime=i.data.lastTime,t.lineStatus=1===i.data.status?"在线":"离线",localStorage.setItem("offLineStatus"+sessionStorage.getItem("gwsn"),1!==i.data.status||"")})).catch((function(e){return!1}))}else t.timer&&(clearInterval(t.timer),t.timer=null),t.websocket&&(t.websocket.close(),t.websocket=null),t.onlineWebsocket&&(t.isOnlineClose=!0,t.onlineWebsocket.close(),t.onlineWebsocket=null),t.$message({showClose:!1,message:this.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}})},getStatus:function(){var e=this;this.timer=setInterval(Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=1,e.getOnlineInfo();case 1:case"end":return t.stop()}}),t)}))),6e4)},getLockStatus:function(){var e=this,t={gwsn:sessionStorage.getItem("gwsn")};e.$hasPermission("gwbaseinfo:selectLock:permission.do")?e.$http.get("/info/gwbaseinfo/getLock",{params:t}).then((function(t){var n=t.data;if(0!=n.code)return e.$message.error(n.data||n.msg);e.lockStatus=n.data.isLock})).catch((function(e){return!1})):e.$message.warning("暂无网关锁状态查询权限, 请联系管理员")},getGwsnInfo:function(){var e=this,t={sn:e.gwsn};if(sessionStorage.getItem("gwsn")){if(!e.$hasPermission("gwbaseinfo:select:permission.do"))return void e.$message.warning("暂无网关信息查询权限, 请联系管理员");e.$http.get("/info/gwbaseinfo",{params:t}).then((function(t){var n=t.data;if(0!=n.code)return!1;var i=n.data;e.gwDesc=i.gwDesc||"",sessionStorage.setItem("dingiiotGwsnPwd",i.pwd||""),e.prjId=i.prjId,e.model=i.model||"",e.gwSoftVer=i.softV||"",e.variable_point=i.variablePoint||0})).catch((function(e){return!1}))}else e.timer&&(clearInterval(e.timer),e.timer=null),e.websocket&&(e.websocket.close(),e.websocket=null),e.onlineWebsocket&&(e.isOnlineClose=!0,e.onlineWebsocket.close(),e.onlineWebsocket=null),e.$message({showClose:!1,message:this.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})},refresh:d()(Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.timer&&(clearInterval(this.timer),this.timer=null),e.next=1,this.getOnlineInfo();case 1:return e.next=2,this.getStatus();case 2:case"end":return e.stop()}}),e,this)}))),1e3,{leading:!0,trailing:!1}),createWebSocket:function(){var e=this;if(!("WebSocket"in window))return e.$message.error(this.$t("websocket.notSupportWebsocket"));try{var t=window.SITE_CONFIG["socketUrl"]+e.wsUrl+"?token="+e.$getToken();e.websocket=new WebSocket(t),e.initWebSocket()}catch(n){e.reConnect()}},initWebSocket:function(){this.websocket.onopen=this.websocketonopen,this.websocket.onerror=this.websocketonerror,this.websocket.onmessage=this.websocketonmessage,this.websocket.onclose=this.websocketonclose},heartCheck:function(){var e=this,t={timeout:2e4,timeoutObj:null,start:function(){e.timeoutObj=setTimeout((function(){e.onlineWebsocket&&e.onlineWebsocket.send("connect success")}),2e4)},reset:function(){clearTimeout(e.timeoutObj),t.start()}};return t},websocketonopen:function(){this.lockReconnect=!0},websocketonerror:function(e){this.lockReconnect=!1},isJsonString:function(e){if("string"===typeof e)try{var t=JSON.parse(e);return!("object"!==Object(s["a"])(t)||!t)}catch(n){return!1}},websocketonmessage:function(e){var t=this;if(!this.isJsonString(e.data))return!1;if("downfile"===this.resname&&"downfile"==JSON.parse(e.data).res_name)this.configIssue=JSON.parse(e.data).res_content,this.percentage=Math.floor(this.configIssue.downloaded_size/this.configIssue.total_size*10)/10*100,100==this.percentage&&(this.dialogVisible=!1,this.$message.success(this.$t("gwsnSetting.downloadSuccess")),setTimeout((function(){if(t.percentage,t.isRerun){t.resname="reRun";var e=null;if(null!=t.driveCode)return t.restartApplicationRerun();e=setInterval((function(){if(null!=t.driveCode)return clearInterval(e),e=null,t.restartApplicationRerun()}),1e3),setTimeout((function(){return t.restartApplicationRerun()}),3e3)}if(t.websocket&&(t.websocket.close(),t.websocket=null),t.isReboot)if(t.configIssue.hasOwnProperty("reboot")){if(!t.$hasPermission("tgwinfo:update:permission.do"))return void t.$message.warning("暂无网关状态修改权限, 请联系管理员");t.$http.post("/info/tgwinfo/updateStatus",{gwSn:t.gwsn,lineStatus:2}).then(function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(n){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i=n.data,0==i.code){e.next=1;break}return e.abrupt("return",t.$message.error(i.data||i.msg));case 1:return t.$message.error(t.$t("configuration.theGatewayIsOffline")),t.timer&&(clearInterval(t.timer),t.timer=null),e.next=2,t.getOnlineInfo();case 2:return e.next=3,t.getStatus();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return!1}))}else{var n=null;null!=t.driveCode?(t.resname="reboot",t.driveCode=null,t.downReboot()):(n=setInterval((function(){null!=t.driveCode&&(clearInterval(n),n=null,t.resname="reboot",t.driveCode=null,t.downReboot())}),1e3),setTimeout((function(){t.resname="reboot",t.driveCode=null,t.downReboot()}),3e3))}}),1e3));else if("offlineDownfile"===this.resname&&"downfile"==JSON.parse(e.data).res_name){var n=JSON.parse(e.data).res_content;this.offLinePercentage=Math.floor(n.downloaded_size/n.total_size*10)/10*100,100==this.offLinePercentage&&(this.offlineDialogVisible=!1,this.$message.success(this.$t("gwsnSetting.downloadSuccess")),setTimeout((function(){if(t.offLinePercentage,t.isRerun)return t.resname="offLineReRun",t.restartApplicationRerun();if(t.websocket&&(t.websocket.close(),t.websocket=null),t.isReboot)if(n.hasOwnProperty("reboot")){if(!t.$hasPermission("tgwinfo:update:permission.do"))return void t.$message.warning("暂无网关状态修改权限, 请联系管理员");t.$http.post("/info/tgwinfo/updateStatus",{gwSn:t.gwsn,lineStatus:2}).then(function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(n){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i=n.data,0==i.code){e.next=1;break}return e.abrupt("return",t.$message.error(i.data||i.msg));case 1:return t.$message.error(t.$t("configuration.theGatewayIsOffline")),t.timer&&(clearInterval(t.timer),t.timer=null),e.next=2,t.getOnlineInfo();case 2:return e.next=3,t.getStatus();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return!1}))}else t.resname="reboot",t.downReboot()}),1e3))}else{if("reRun"===this.resname&&"reRun"==JSON.parse(e.data).res_name){var i=JSON.parse(e.data).res_content.received;return this.downloadLoading=!1,1===i?(this.reRunApplicationVisible=!1,this.websocket&&(this.websocket.close(),this.websocket=null),this.$message.success(this.$t("configuration.successfullyRestartedTheApplication"))):(this.reRunApplicationVisible=!1,this.websocket&&(this.websocket.close(),this.websocket=null),this.$message.error(this.$t("configuration.restartApplicationFailed")))}if("offLineReRun"===this.resname&&"reRun"==JSON.parse(e.data).res_name){var o=JSON.parse(e.data).res_content.received;return 1===o?(this.downloadLoading=!1,this.websocket&&(this.websocket.close(),this.websocket=null),this.$message.success(this.$t("configuration.successfullyRestartedTheApplication"))):(this.downloadLoading=!1,this.websocket&&(this.websocket.close(),this.websocket=null),this.$message.error(this.$t("configuration.restartApplicationFailed")))}if("reboot"===this.resname&&"reboot"==JSON.parse(e.data).res_name){this.reRunApplicationVisible=!1;var s=JSON.parse(e.data).res_content.received;if(this.isReboot=!1,1!==s)return this.websocket&&(this.websocket.close(),this.websocket=null),this.$message.error(this.$t("gwsnSetting.restartFail"));this.websocket&&(this.websocket.close(),this.websocket=null),localStorage.setItem("offLineStatus"+this.gwsn,!0),this.$message.success(this.$t("gwsnSetting.restartSuccess")),setTimeout((function(){t.$hasPermission("tgwinfo:update:permission.do")?t.$http.post("/info/tgwinfo/updateStatus",{gwSn:t.gwsn,lineStatus:2}).then((function(e){var n=e.data;if(0!=n.code)return t.$message.error(n.data||n.msg);t.$message.error(t.$t("configuration.theGatewayIsOffline")),t.$nextTick(Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.timer&&(clearInterval(t.timer),t.timer=null),e.next=1,t.getOnlineInfo();case 1:return e.next=2,t.getStatus();case 2:return e.abrupt("return");case 3:case"end":return e.stop()}}),e)}))))})).catch((function(e){return!1})):t.$message.warning("暂无网关状态修改权限, 请联系管理员")}),1e3)}else if("uploadCertificate"===this.resname&&"downfile"==JSON.parse(e.data).res_name){var a=JSON.parse(e.data).res_content,l=Math.floor(a.downloaded_size/a.total_size*10)/10*100;100==l&&this.uploadCount++,clearTimeout(this.uploadCertificateTimer),this.uploadCertificateTimer=setTimeout((function(){t.uploadCount>=t.judgeLength.length?(t.websocket&&(t.websocket.close(),t.websocket=null),t.$message.success("上传成功"),t.uploadCertificateLoading=!1,t.uploadCertificateVisible=!1):(t.websocket&&(t.websocket.close(),t.websocket=null),t.$message.error(t.$t("template.uploadError")),t.uploadCertificateLoading=!1)}),6e3)}else if("getFileLink"===this.resname&&"getFileLink"==JSON.parse(e.data).res_name){var c=JSON.parse(e.data).res_content;c.hasOwnProperty("err_code")?(this.websocket.close(),this.websocket=null):(this.readPrjForm.projectList=c.file_info,this.readPrjForm.projectList.length>0&&(this.readPrjForm.fileIndex=this.readPrjForm.projectList[0].ordinal))}else if("uploadfile1"===this.resname&&"uploadfile"==JSON.parse(e.data).res_name){var u=JSON.parse(e.data).res_content;if(1==u.result)this.fileUrl=u.file_url,this.websocket&&(this.websocket.close(),this.websocket=null),this.projectUrl=this.fileUrl;else if(this.websocket&&(this.websocket.close(),this.websocket=null),u.hasOwnProperty("curl_err_code"))return this.$message.error("读取工程失败，curl错误码: "+u.curl_err_code+"！")}else if("synchronous"===this.resname&&"uploadfile"==JSON.parse(e.data).res_name){var d=JSON.parse(e.data).res_content;if(1==d.result)this.websocket&&(this.websocket.close(),this.websocket=null),this.$http.get("/conf/readzip/downURL",{params:{readURL:d.file_url,gwsn:this.gwsn}}).then((function(e){var n=e.data;if(0!=n.code)return t.downloadLoading=!1,t.$message.error(n.data||n.msg);t.downloadLoading=!1,t.$message.success(n.msg),t.reload()})).catch((function(e){return t.downloadLoading=!1,!1}));else if(this.websocket&&(this.websocket.close(),this.websocket=null),this.downloadLoading=!1,d.hasOwnProperty("curl_err_code"))return this.$message.error(this.$t("configuration.syncFailedCurlErrorCode")+d.curl_err_code+"！")}}},downReboot:function(){var e=this;e.websocket&&(e.websocket.close(),e.websocket=null),e.$nextTick((function(){e.$hasSessionStorageGwsn()?(e.wsUrl="socketsOne/reboot/"+e.gwsn+"/"+e.encryMD5(e.gwsn),e.createWebSocket()):e.$message({showClose:!1,message:e.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}))},websocketonclose:function(e){this.lockReconnect=!1},handleOfflineIssuedChange:d()((function(){var e=this;if(this.$hasSessionStorageGwsn()){if(!this.$hasPermission("offlineIssue:insert:permission.do"))return void this.$message.warning("暂无离线工程下发权限，请联系管理员");this.offlineissuedVisible=!0,this.offLinePercentage=0,this.resname="offlineDownfile",this.offlineissuedContent='确定对网关<span style="font-weight: bolder; color: red">'+this.gwsn+"</span>工程下发吗？工程下发完成后需要重启后生效,点击[确定]设置并重启，点击[稍后自行重启]仅设置不重启。"}else this.$message({showClose:!1,message:this.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),handleOfflineCancel:function(){this.websocket&&(this.websocket.close(),this.websocket=null),this.offlineissuedVisible=!1},handleOfflineConfirmAndReboot:d()((function(){var e=this;if(e.$hasSessionStorageGwsn()){if(!e.$hasPermission("offlineIssue:insert:permission.do"))return void e.$message.warning("暂无离线下发新增权限, 请联系管理员");e.$http.post("/offlineIssue/insert.do",[{action:1,sn:e.gwsn}]).then((function(t){var n=t.data;if(0!=n.code)return e.$message.error(n.data||n.msg);e.offlineissuedVisible=!1,e.offlineDialogVisible=!1,e.$message.success(e.$t("gwsn.savedToScheduledTask"))})).catch((function(e){return!1}))}else e.$message({showClose:!1,message:e.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),handleOfflineRestartRerun:d()((function(){var e=this;if(e.$hasSessionStorageGwsn()){if(!e.$hasPermission("offlineIssue:insert:permission.do"))return void e.$message.warning("暂无离线下发新增权限, 请联系管理员");e.$http.post("/offlineIssue/insert.do",[{action:0,sn:e.gwsn}]).then((function(t){var n=t.data;if(0!=n.code)return e.$message.error(n.data||n.msg);e.offlineissuedVisible=!1,e.offlineDialogVisible=!1,e.$message.success(e.$t("gwsn.savedToScheduledTask"))})).catch((function(e){return!1}))}else e.$message({showClose:!1,message:e.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),handleDeleteErrorProChange:d()((function(){var e=this;this.$confirm(this.$t("configuration.thisOperationWillPermanentlyDeleteTheAbnormalProject"),this.$t("prompt.title"),{confirmButtonText:this.$t("confirm"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((function(){e.$message({type:"success",message:e.$t("gwsnSetting.deleteSuccess")+"!"})})).catch((function(e){}))}),1e3,{leading:!0,trailing:!1}),configissued:d()((function(){var e=this;if(this.$hasSessionStorageGwsn()){if(!this.$hasPermission("socketsOne:distribution:websocket"))return void this.$message.warning("暂无工程下发权限，请联系管理员");this.driveCode=null,this.confirmVisible=!0,this.percentage=0,this.resname="downfile",this.content='确定对网关<span style="font-weight: bolder; color: red">'+this.gwsn+"</span>工程下发吗？工程下发完成后需要重启后生效,点击[确定]设置并重启，点击[稍后自行重启]仅设置不重启。"}else this.$message({showClose:!1,message:this.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),createDriveWebSocket:function(){var e=this;if(!("WebSocket"in window))return e.$message.error(this.$t("websocket.notSupportWebsocket"));try{var t=window.SITE_CONFIG["socketUrl"]+e.wsDriveurl+"?token="+e.$getToken();e.websocketDrive=new WebSocket(t),e.initWebDriveSocket()}catch(n){return e.$message.warning(this.$t("gwsnSetting.notConnectedToWebsocket"))}},reDriveConnect:function(){var e=this;e.lockDriveReconnect||(e.recconectDriveTimer&&clearTimeout(e.recconectDriveTimer),e.recconectDriveTimer=setTimeout((function(){e.createDriveWebSocket()}),5e3))},initWebDriveSocket:function(){this.websocketDrive.onopen=this.websocketDriveonopen,this.websocketDrive.onerror=this.websocketDriveonerror,this.websocketDrive.onmessage=this.websocketDriveonmessage,this.websocketDrive.onclose=this.websocketDriveonclose},websocketDriveonopen:function(){var e=this;e.lockDriveReconnect=!0,setTimeout((function(){e.websocketDrive&&(e.websocketDrive.close(),e.websocketDrive=null)}),"30000")},websocketDriveonerror:function(e){this.lockDriveReconnect=!1},websocketDriveonmessage:function(e){var t=this;if(!t.isJsonString(e.data))return!1;JSON.parse(e.data).hasOwnProperty("code")?(t.websocketDrive&&(t.websocketDrive.close(),t.websocketDrive=null),t.driveCode=JSON.parse(e.data).code,setTimeout((function(){t.createWebSocket()}),1e3)):JSON.parse(e.data).res_content.hasOwnProperty("err_code")&&(t.$message.error(JSON.parse(e.data).res_content.err_msg),t.websocketDrive&&(t.websocketDrive.close(),t.websocketDrive=null),setTimeout((function(){t.dialogVisible=!1}),1e3))},websocketDriveonclose:function(e){this.lockDriveReconnect=!1},handleCloseDownload:function(){this.dialogVisible=!1,this.offlineDialogVisible=!1,this.offlineissuedVisible=!1,this.readconfigVisible=!1,this.readlogVisible=!1,this.reRunApplicationVisible=!1,this.websocket&&(this.websocket.close(),this.websocket=null)},clickCancel:function(){this.websocket&&(this.websocket.close(),this.websocket=null),this.confirmVisible=!1},clickConfirmAndReboot:d()((function(){var e=this;e.isUpdateDriver?e.wsDriveurl="driversWebsocket/"+sessionStorage.getItem("gwsn")+"/"+sessionStorage.getItem("dingiiotGwsnPwd")+"/"+e.encryMD5(sessionStorage.getItem("gwsn")):e.wsDriveurl="driversUploadWebsocket/"+sessionStorage.getItem("gwsn")+"/"+sessionStorage.getItem("dingiiotGwsnPwd")+"/"+e.encryMD5(sessionStorage.getItem("gwsn")),e.$hasSessionStorageGwsn()?(e.confirmVisible=!1,e.dialogVisible=!0,e.isReboot=!0,e.isRerun=!1,e.wsUrl="socketsOne/distribution-1/"+e.gwsn+"/"+e.encryMD5(e.gwsn),e.createWebSocket()):e.$message({showClose:!1,message:this.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),restartRerun:d()((function(){var e=this;e.isUpdateDriver?e.wsDriveurl="driversWebsocket/"+sessionStorage.getItem("gwsn")+"/"+sessionStorage.getItem("dingiiotGwsnPwd")+"/"+e.encryMD5(sessionStorage.getItem("gwsn")):e.wsDriveurl="driversUploadWebsocket/"+sessionStorage.getItem("gwsn")+"/"+sessionStorage.getItem("dingiiotGwsnPwd")+"/"+e.encryMD5(sessionStorage.getItem("gwsn")),e.$hasSessionStorageGwsn()?(e.confirmVisible=!1,e.dialogVisible=!0,e.isRerun=!0,e.isReboot=!1,e.wsUrl="socketsOne/distribution/"+e.gwsn+"/"+e.encryMD5(e.gwsn),e.createWebSocket()):e.$message({showClose:!1,message:this.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),clickConfirm:d()((function(){var e=this;e.isUpdateDriver?e.wsDriveurl="driversWebsocket/"+sessionStorage.getItem("gwsn")+"/"+sessionStorage.getItem("dingiiotGwsnPwd")+"/"+e.encryMD5(sessionStorage.getItem("gwsn")):e.wsDriveurl="driversUploadWebsocket/"+sessionStorage.getItem("gwsn")+"/"+sessionStorage.getItem("dingiiotGwsnPwd")+"/"+e.encryMD5(sessionStorage.getItem("gwsn")),e.$hasSessionStorageGwsn()?(e.confirmVisible=!1,e.dialogVisible=!0,e.isReboot=!1,e.isRerun=!1,e.wsUrl="socketsOne/distribution/"+e.gwsn+"/"+e.encryMD5(e.gwsn),e.createWebSocket()):e.$message({showClose:!1,message:e.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),uploadCertificate:d()((function(){var e=this;if(this.$hasSessionStorageGwsn()){if(!this.$hasPermission("socketNine:getDownfile:websocket"))return void this.$message.warning("暂无上传证书权限，请联系管理员");this.uploadCertificateVisible=!0,this.$nextTick((function(){e.fileList=[],e.uploadCount=0,e.judgeLength=[],e.clientfileList=[],e.clientKeyfileList=[],e.uploadCertificateForm={chlname:"",selectChlname:"",clientPassword:"",cafilename:"",clientfilename:"",clientkeyfilename:"",cafileUrl:"",clientfileUrl:"",clientkeyfileUrl:"",cafileContent:"",clientfileContent:"",clientkeyContent:""},e.getChannelList()}))}else this.$message({showClose:!1,message:this.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),getChannelList:function(){var e=this,t=this,n={gwsn:t.gwsn};if(t.$hasSessionStorageGwsn()){if(!t.$hasPermission("list:getChlList:select:permission.do"))return void t.$message.warning("暂无网关查询权限, 请联系管理员");t.$http.get("/list/getChlList.do",{params:n}).then((function(n){var i=n.data;return 0!=i.code?t.$message.error(i.data||i.msg):(t.channelList=i.data,t.channelList.length>0?void 0:(t.uploadCertificateVisible=!1,t.$message.error(e.$t("configuration.thisGatewayCurrentlyHasNoChannels"))))})).catch((function(e){return!1}))}else t.$message({showClose:!1,message:this.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}})},handleChannelSelect:function(e){this.uploadCertificateForm.selectChlname=this.channelList.find((function(t){return t.id==e})).chlID},handleChange:function(e,t){this.fileList=t},handleRemove:function(e,t){this.fileList=t},uploadSectionFile:function(e,t){if(-1==e.file.name.indexOf("pem"))return this.$message.error(this.$t("upload.tip",{format:"pem"})),new Promise((function(t,n){n(e.file)}));this.fileList=[],this.uploadCertificateLoading=!0,this.uploadCertificateForm.cafilename=e.file.name,this.fileList.push(e.file);var n=new FormData;n.append("multipartFile",e.file),this.importfile(n,0)},handleClientChange:function(e,t){this.clientfileList=t},handleClientRemove:function(e,t){this.clientfileList=t},uploadSectionClientFile:function(e,t){if(-1==e.file.name.indexOf("pem"))return this.$message.error(this.$t("upload.tip",{format:"pem"})),new Promise((function(t,n){n(e.file)}));this.clientfileList=[],this.uploadCertificateLoading=!0,this.uploadCertificateForm.clientfilename=e.file.name,this.clientfileList.push(e.file);var n=new FormData;n.append("multipartFile",e.file),this.importfile(n,1)},handleClientKeyChange:function(e,t){this.clientKeyfileList=t},handleClientKeyRemove:function(e,t){this.clientKeyfileList=t},uploadSectionClientKeyFile:function(e,t){if(-1==e.file.name.indexOf("key"))return this.$message.error(this.$t("upload.tip",{format:"key"})),new Promise((function(t,n){n(e.file)}));this.clientKeyfileList=[],this.uploadCertificateLoading=!0,this.uploadCertificateForm.clientkeyfilename=e.file.name,this.clientKeyfileList.push(e.file);var n=new FormData;n.append("multipartFile",e.file),this.importfile(n,2)},importfile:function(e,t){var n=this;if(this.$hasSessionStorageGwsn()){var i=e.get("file"),o=new FileReader;o.onload=function(e){var t=e.target.result;t},o.onerror=function(e){},o.readAsText(i),this.$http.post("/goFastDfs/uploadFile.do",e).then((function(e){var i=e.data;0==i.code?(0==t?n.uploadCertificateForm.cafileUrl=i.data:1==t?n.uploadCertificateForm.clientfileUrl=i.data:2==t&&(n.uploadCertificateForm.clientkeyfileUrl=i.data),n.$message.success(n.$t("template.uploadSuccess")),n.uploadCertificateLoading=!1):(n.$message.error(i.data||n.$t("template.uploadError")),n.uploadCertificateLoading=!1)})).catch((function(e){return!1}))}else this.$message({showClose:!1,message:this.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return n.uploadCertificateLoading=!1,sessionStorage.clear(),n.$router.replace({path:"/tgw-tgwinfo"})}})},handleuploadCertificate:d()((function(){var e=this,t=this;t.$hasSessionStorageGwsn()?(t.uploadCertificateForm.cafileUrl&&t.judgeLength.push("1"),t.uploadCertificateForm.clientfileUrl&&t.judgeLength.push("1"),t.uploadCertificateForm.clientkeyfileUrl&&t.judgeLength.push("1"),t.$nextTick((function(){if(0==t.judgeLength.length)return t.$message.info(e.$t("configuration.pleaseUploadAtLeastOneFile"));t.resname="uploadCertificate",t.uploadCertificateLoading=!0,t.uploadCertificateForm.cafileUrl&&t.handleUploadCmd(3),t.uploadCertificateForm.clientfileUrl&&t.handleUploadCmd(4),t.uploadCertificateForm.clientkeyfileUrl&&t.handleUploadCmd(5)}))):t.$message({showClose:!1,message:this.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),encryMD5:function(e){var t=this.$randomStrFun();return this.$md5(t+e)+"/"+String(parseInt((new Date).getTime().toString().substring(0,10)))},encryMD5List:function(){var e=this.$randomStrFun();return this.$md5(e)+"/"+String(parseInt((new Date).getTime().toString().substring(0,10)))},handleUploadCmd:function(e){var t=this,n=3==e?t.uploadCertificateForm.cafileUrl:4==e?t.uploadCertificateForm.clientfileUrl:t.uploadCertificateForm.clientkeyfileUrl,i=3==e?"/data/project/"+t.uploadCertificateForm.selectChlname+"-ca.pem":4==e?"/data/project/"+t.uploadCertificateForm.selectChlname+".pem":"/data/project/"+t.uploadCertificateForm.selectChlname+".key",o={gwsn:t.gwsn,fileUrl:n,fileType:String(e),savePath:i};if(t.$hasSessionStorageGwsn()){var s=Object(y["o"])(JSON.stringify(o));t.wsUrl="socketNine/getDownfile/"+Object(y["p"])(s)+"/"+t.encryMD5List(),t.createWebSocket(),setTimeout((function(){if(t.uploadCertificateLoading)return t.uploadCertificateLoading=!1,t.websocket&&(t.websocket.close(),t.websocket=null),t.$message.error(t.$t("configuration.certificateUploadTimeoutPleaseUploadAgain"))}),"30000")}else t.$message({showClose:!1,message:this.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}})},handleCloseuploadCertificate:function(){this.websocket&&(this.websocket.close(),this.websocket=null),this.uploadCertificateForm.cafileContent="",this.uploadCertificateForm.clientfileContent="",this.uploadCertificateForm.clientkeyContent="",this.uploadCertificateVisible=!1},readconfigura:d()((function(){var e=this;if(e.$hasSessionStorageGwsn()){if(e.fileUrl="",e.projectUrl="",!e.$hasPermission("socketTwo:uploadfile:websocket"))return void e.$message.warning("暂无读取工程权限, 请联系管理员");e.readPrjForm.type=1,e.readPrjForm.fileIndex=null,e.readPrjVisible=!0}else e.$message({showClose:!1,message:e.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),handleReadPrjSelectChange:function(){var e=this;2==e.readPrjForm.type&&(e.resname="getFileLink",e.wsUrl="socketTwo/getFileLink/"+e.gwsn+"/0/"+e.encryMD5(e.gwsn),e.createWebSocket(),setTimeout((function(){return e.websocket&&(e.websocket.close(),e.websocket=null),e.$message.error(e.$t("configuration.commandIssuanceTimeout"))}),"30000"))},handleCloseReadprjChange:function(){this.readPrjVisible=!1,this.readPrjLoading=!1},handleConfirmReadprjChange:d()((function(){var e=this;if(e.$hasSessionStorageGwsn()){if(e.fileUrl="",e.projectUrl="",e.resname="uploadfile1",!e.$hasPermission("socketTwo:uploadfile:websocket"))return void e.$message.warning("暂无读取工程权限, 请联系管理员");if(1==e.readPrjForm.type)e.wsUrl="socketTwo/uploadfile/"+e.gwsn+"/0/"+e.encryMD5(e.gwsn);else{if(null===e.readPrjForm.fileIndex)return void e.$message.warning("请选择历史工程文件");e.wsUrl="socketTwo/uploadfile/"+e.gwsn+"/14_"+e.readPrjForm.fileIndex+"/"+e.encryMD5(e.gwsn)}e.readPrjLoading=!1,e.readPrjVisible=!1,e.readconfigVisible=!0,e.createWebSocket(),setTimeout((function(){if(e.downloadLoading)return e.downloadLoading=!1,e.websocket&&(e.websocket.close(),e.websocket=null),e.$message.error(e.$t("configuration.commandIssuanceTimeout"))}),"30000")}else e.$message({showClose:!1,message:e.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),handleCloseReadlogChange:function(){this.logWebsocket&&(this.logWebsocket.close(),this.logWebsocket=null),this.readlogVisible=!1,this.readlogLoading=!1},readlog:d()((function(){var e=this;if(e.$hasSessionStorageGwsn()){if(e.url="",e.logUrl="",e.resname="uploadfile2",!e.$hasPermission("socketTwo:uploadfile:websocket"))return void e.$message.warning("暂无读取日志权限, 请联系管理员");e.logWsurl="socketTwo/uploadfile/"+e.gwsn+"/2/"+e.encryMD5(e.gwsn),e.readlogVisible=!0,e.readlogLoading=!0,e.createReadlogWebSocket()}else e.$message({showClose:!1,message:e.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),browserType:function(){var e=navigator.userAgent.toLowerCase(),t={ie:function(){return!(!window.ActiveXObject&&!("ActiveXObject"in window))},edge:function(){return/dge/.test(e)},chrome:function(){return/chrome/.test(e)},safari:function(){return/safari/.test(e)&&!/chrome/.test(e)},opera:function(){return/opera/.test(e)},msie:function(){return/msie/.test(e)&&!/opera/.test(e)},mozilla:function(){return/mozilla/.test(e)&&!/(compatible|webkit)/.test(e)}},n={};for(var i in t){var o=t[i](),s=(e.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1];if(o)return n.browser=i,n.version=s,n}},downLoad:d()((function(){var e=this,t=new XMLHttpRequest;t.open("get",e.projectUrl),t.responseType="blob",t.send(),t.onreadystatechange=function(){if(4==t.readyState&&200==t.status){var n=e.browserType();if("ie"!==n.browser||"10.0"!=n.version&&"11.0"!=n.version){var i=t.response,o=window.URL.createObjectURL(i),s=document.createElement("a");s.href=o,s.download="ioserver_prj_"+e.gwsn+"_"+(new Date).getTime()+".tar.gz",document.body.appendChild(s),s.click(),document.body.removeChild(s),setTimeout((function(){window.URL.revokeObjectURL(o)}),100)}else{var r=window.URL.createObjectURL(e.response),a=document.createElement("a");a.href=r,a.download="ioserver_prj_"+e.gwsn+"_"+(new Date).getTime()+".tar.gz",document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.removeObjectURL(r)}}},e.readconfigVisible=!1}),1e3,{leading:!0,trailing:!1}),generateDownloadUrl:function(e,t){var n=new URL(e);return n.searchParams.set("name",t),n.toString()},handleProjectDownLoad:function(){this.readconfigVisible=!1,this.$refs.projectRef.href=this.projectUrl?this.generateDownloadUrl(this.projectUrl,"ioserver_prj_"+this.gwsn+"_"+(new Date).getTime()+".tar.gz"):"javascript:void(0)"},recoverColund:d()((function(){var e=this;if(e.$hasSessionStorageGwsn()){if(!e.$hasPermission("socketTwo:uploadfile:websocket"))return void e.$message.warning("暂无网关同步至云端权限，请联系管理员");e.$confirm(e.$t("configuration.areYouSureYouWantToSynchronizeTheGatewayProjectToTheCloud"),e.$t("gwsnSetting.prompt"),{confirmButtonText:e.$t("confirm"),cancelButtonText:e.$t("cancel"),type:"warning"}).then((function(){e.resname="synchronous",e.wsUrl="socketTwo/uploadfile/"+e.gwsn+"/0/"+e.encryMD5(e.gwsn),e.downloadLoading=!0,e.createWebSocket(),setTimeout((function(){if(e.downloadLoading)return e.downloadLoading=!1,e.websocket&&(e.websocket.close(),e.websocket=null),e.$message.error(e.$t("configuration.commandIssuanceTimeout"))}),"30000")})).catch((function(e){}))}else e.$message({showClose:!1,message:e.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),removeNameParam:function(e){var t=new URL(e);return t.searchParams.delete("name"),t.toString()},downLoadlog:d()((function(){window.location.href=this.removeNameParam(this.logUrl),this.readlogVisible=!1}),1e3,{leading:!0,trailing:!1}),handleLogDownLoad:function(){this.readlogVisible=!1,this.$refs.logRef.href=this.logUrl?this.removeNameParam(this.logUrl):"javascript:void(0)"},channelmonitoring:d()((function(){var e=this;if(e.$hasSessionStorageGwsn()){if(!e.ids)return e.$message.info(e.$t("configuration.pleaseSelectAMonitoringChannel"));if(e.ids.split(",").length>1)return e.$message.info(e.$t("configuration.pleaseSelectAChannelForDetection"));if(!e.$hasPermission("channel:detection:select:websocket"))return void e.$message.warning("暂无通道监测权限，请联系管理员");var t=e.$router.resolve({path:"/chlwatch"});window.open(t.href+"?sn="+e.gwsn+"&chlId="+e.ids+"&isShowSetting="+(e.isShowSetting?1:0),"_blank")}else e.$message({showClose:!1,message:e.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),handlecommandLine:d()((function(){var e=this;e.cmdlineVisible=!0,e.$nextTick((function(){e.$refs.commandline.init()}))}),1e3,{leading:!0,trailing:!1}),recover:d()((function(){var e=this;this.$hasSessionStorageGwsn()?0==this.recoverCount&&this.$confirm(this.$t("gwsnSetting.clearColundConfig"),this.$t("gwsnSetting.prompt"),{confirmButtonText:this.$t("confirm"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((function(){return e.recoverCount=1,e.recoverShow=!1})).catch((function(t){return e.recoverCount=0,e.recoverShow=!0})):this.$message({showClose:!1,message:this.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),handleRecoverChange:function(e,t){},handleRecoverRemove:function(e,t){this.recoverFileList=[]},beforeRecoverFileUpload:function(e){var t=null;if(this.variable_point<=3e3?t=e.size/1024<=200:this.variable_point<=8e3?t=e.size/1024<=600:this.variable_point<=3e4&&(t=e.size/1024<=1200),!t)return this.variable_point<=3e3?this.$message.error(this.$t("gwsnSetting.uploadminiLimit")):this.variable_point<=8e3?this.$message.error(this.$t("gwsnSetting.uploadmediumLimit")):this.variable_point<=3e4&&this.$message.error(this.$t("gwsnSetting.uploadmaxLimit")),t},uploadRecoverSectionFile:function(e,t){if("application/x-gzip"==e.file.type||"application/x-zip-compressed"==e.file.type||-1!=e.file.name.indexOf(".rar")){var n=new FormData;n.append("file",e.file),n.append("gwsn",this.gwsn),this.importRecoverfile(n)}else this.$message.warning(this.$t("gwsnSetting.uploadError")),this.handleRecoverRemove()},reload:function(){var e=this;this.isRouterAlive=!1,this.$nextTick((function(){e.isRouterAlive=!0}))},importRecoverfile:function(e){var t=this;if(this.$hasSessionStorageGwsn()){if(!this.$hasPermission("ObtainFile:select:permission.do"))return void this.$message.warning("暂无从本地恢复工程至云端权限, 请联系管理员");this.$http.post("/conf/ation/ObtainFile",e).then((function(e){var n=e.data;0==n.code?(t.reload(),t.recoverCount=0,t.recoverShow=!0,t.$message.success(n.msg),t.handleRecoverRemove(),t.confirmVisible=!0,t.percentage=0,t.resname="downfile",t.createWebSocket(),t.content=t.$t("gwsnSetting.uploadDownload")):(t.recoverCount=0,t.recoverShow=!0,t.$message.error(n.data||n.msg)),t.handleRecoverRemove()})).catch((function(e){return!1}))}else this.$message({showClose:!1,message:this.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),t.$router.replace({path:"/tgw-tgwinfo"})}})},toNum:function(e){e=e.toString();for(var t=e.split("."),n=["","0","00","000","0000"],i=n.reverse(),o=0;o<t.length;o++){var s=t[o].length;t[o]=i[s]+t[o]}var r=t.join("");return r},checkPlugin:function(e,t){e=this.toNum(e),t=this.toNum(t);return e==t||e>t},restartApplicationRerun:d()((function(){var e=this;e.websocket&&(e.websocket.close(),e.websocket=null),e.$hasSessionStorageGwsn()?e.$nextTick((function(){if(!e.checkPlugin(e.gwSoftVer.substring(1,e.gwSoftVer.length),"1.3.00"))return e.isRerun=!1,e.$message.info(e.$t("configuration.theCurrentGatewayVersionIsLowerThan"));e.wsUrl="socketTwo/reRun/"+e.gwsn+(1==e.driveCode?"/1/":"/0/")+e.encryMD5(e.gwsn),e.isRerun=!1,e.downloadLoading=!0,e.createWebSocket(),e.driveCode=null,setTimeout((function(){if(e.downloadLoading)return e.downloadLoading=!1,e.websocket&&(e.websocket.close(),e.websocket=null),e.$message.error(e.$t("configuration.commandIssuanceTimeout"))}),"30000")})):e.$message({showClose:!1,message:e.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),restartApplication:d()((function(){var e=this;if(e.$hasSessionStorageGwsn()){if(!e.$hasPermission("socketTwo:reRun:websocket"))return void e.$message.warning("暂无重启应用权限，请联系管理员");if(!e.checkPlugin(e.gwSoftVer.substring(1,e.gwSoftVer.length),"1.3.00"))return e.$message.info(e.$t("configuration.theCurrentGatewayVersionIsLowerThan"));e.wsUrl="socketTwo/reRun/"+e.gwsn+"/1/"+e.encryMD5(e.gwsn),e.resname="reRun",e.$confirm(e.$t("configuration.areYouSureToRestartTheApplication"),e.$t("prompt.title"),{confirmButtonText:e.$t("confirm"),cancelButtonText:e.$t("cancel"),type:"warning"}).then((function(){e.reRunApplicationVisible=!0,e.createWebSocket(),setTimeout((function(){if(e.reRunApplicationVisible)return e.reRunApplicationVisible=!1,e.websocket&&(e.websocket.close(),e.websocket=null),e.$message.error(e.$t("configuration.commandIssuanceTimeout"))}),"30000")})).catch((function(){e.reRunApplicationVisible=!1,e.websocket&&(e.websocket.close(),e.websocket=null)}))}else e.$message({showClose:!1,message:e.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),restart:d()((function(){var e=this;if(e.$hasSessionStorageGwsn()){if(!e.$hasPermission("socketsOne:reboot:websocket"))return void e.$message.warning("暂无重启网关权限, 请联系管理员");e.wsUrl="socketsOne/reboot/"+e.gwsn+"/"+e.encryMD5(e.gwsn),e.resname="reboot",e.$confirm(e.$t("gwsnSetting.restartContent"),e.$t("prompt.title"),{confirmButtonText:e.$t("confirm"),cancelButtonText:e.$t("cancel"),type:"warning"}).then((function(){e.reRunApplicationVisible=!0,e.createWebSocket(),setTimeout((function(){if(e.reRunApplicationVisible)return e.reRunApplicationVisible=!1,e.websocket&&(e.websocket.close(),e.websocket=null),e.$message.error(e.$t("configuration.commandIssuanceTimeout"))}),"30000")})).catch((function(){e.reRunApplicationVisible=!1,e.websocket&&(e.websocket.close(),e.websocket=null)}))}else e.$message({showClose:!1,message:e.$t("configuration.gatewayNumberNotObtained"),type:"warning",duration:1500,onClose:function(){return sessionStorage.clear(),e.$router.replace({path:"/tgw-tgwinfo"})}})}),1e3,{leading:!0,trailing:!1}),createReadlogWebSocket:function(){var e=this;if(!("WebSocket"in window))return e.$message.error(this.$t("websocket.notSupportWebsocket"));try{var t=window.SITE_CONFIG["socketUrl"]+e.logWsurl+"?token="+e.$getToken();e.logWebsocket=new WebSocket(t),e.initLogWebSocket()}catch(n){e.logReConnect()}},initLogWebSocket:function(){this.logWebsocket.onopen=this.onLogWebsocketonopen,this.logWebsocket.onerror=this.onLogWebsocketonerror,this.logWebsocket.onmessage=this.onLogWebsocketonmessage,this.logWebsocket.onclose=this.onLogWebsocketonclose},logReConnect:function(){var e=this;e.lockLogReconnect||(e.recconectLogTimer&&clearTimeout(e.recconectLogTimer),e.recconectLogTimer=setTimeout((function(){e.createReadlogWebSocket()}),5e3))},onLogWebsocketonopen:function(e){this.lockLogReconnect=!0,this.heartCheck().start()},onLogWebsocketonerror:function(e){this.lockLogReconnect=!1,this.logReconnect()},onLogWebsocketonmessage:function(e){if(!this.isJsonString(e.data))return!1;if("uploadfile2"===this.resname&&"uploadfile"==JSON.parse(e.data).res_name){this.readlogLoading=!1;var t=JSON.parse(e.data).res_content;if(1!=t.result)return this.logWebsocket&&(this.logWebsocket.close(),this.logWebsocket=null),this.readlogVisible=!1,this.readlogLoading=!1,this.$message.error(t.msg?"读取日志失败; 错误码: "+t.curl_err_code+"; 错误信息为: "+t.msg:"读取日志失败; 错误码: "+t.curl_err_code+"; 错误信息: 读取超时");this.logWebsocket&&(this.logWebsocket.close(),this.logWebsocket=null),this.url=t.file_url,this.logUrl=this.url}},onLogWebsocketonclose:function(e){this.lockReconnect=!1}},created:function(){this.menuList=_["a"].options.routes[3].children,window.SITE_CONFIG["permissions"]=localStorage.getItem("permissionsDingiiotCom")?JSON.parse(localStorage.getItem("permissionsDingiiotCom")):[]},mounted:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(localStorage.setItem("offLineStatus"+sessionStorage.getItem("gwsn"),""),!g.a.get("token")){e.next=5;break}return t=this,n="",c["a"].$on("activeIndex2",(function(e){t.defaultActive=e})),n=window.location.href.split("/#")[1],-1!=n.indexOf("?label")?t.defaultActive=n.split("?label")[0]:t.defaultActive=n,t.isShowSetting=0!=sessionStorage.getItem("per"),t.superAdmin=localStorage.getItem("superAdmin"),t.gwsn=sessionStorage.getItem("gwsn"),t.gwDesc=sessionStorage.getItem("gwDesc"),t.prjId=sessionStorage.getItem("prjId"),t.model=sessionStorage.getItem("model"),t.gwSoftVer=sessionStorage.getItem("gwSoftV"),e.next=1,t.getGwsnInfo();case 1:return e.next=2,t.getOnlineInfo();case 2:return e.next=3,t.getStatus();case 3:if(!t.isShowSetting){e.next=4;break}return e.next=4,t.getPrjInfo();case 4:t.createOnLineWebSocket(),window.onbeforeunload=function(e){t.timer&&(clearInterval(t.timer),t.timer=null),t.websocket&&(t.websocket.close(),t.websocket=null),t.logWebsocket&&(t.logWebsocket.close(),t.logWebsocket=null),t.onlineWebsocket&&(t.onlineWebsocket.close(),t.onlineWebsocket=null),t.onOrofflineTimer&&(clearInterval(t.onOrofflineTimer),t.onOrofflineTimer=null)},e.next=6;break;case 5:this.timer&&(clearInterval(this.timer),this.timer=null),this.websocket&&this.websocket.readyState===WebSocket.OPEN&&(this.websocket.close(),this.websocket=null),this.logWebsocket&&this.logWebsocket.readyState===WebSocket.OPEN&&(this.logWebsocket.close(),this.logWebsocket=null),this.onlineWebsocket&&this.onlineWebsocket.readyState===WebSocket.OPEN&&(this.isOnlineClose=!0,this.onlineWebsocket.close(),this.onlineWebsocket=null),this.onOrofflineTimer&&(clearInterval(this.onOrofflineTimer),this.onOrofflineTimer=null),this.$router.replace({name:"login"}).catch((function(e){return!1}));case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),beforeDestroy:function(){this.timer&&(clearInterval(this.timer),this.timer=null),this.websocket&&this.websocket.readyState===WebSocket.OPEN&&(this.websocket.close(),this.websocket=null),this.logWebsocket&&this.logWebsocket.readyState===WebSocket.OPEN&&(this.logWebsocket.close(),this.logWebsocket=null),this.onlineWebsocket&&this.onlineWebsocket.readyState===WebSocket.OPEN&&(this.isOnlineClose=!0,this.onlineWebsocket.close(),this.onlineWebsocket=null),this.onOrofflineTimer&&(clearInterval(this.onOrofflineTimer),this.onOrofflineTimer=null)},deactivated:function(){this.timer&&(clearInterval(this.timer),this.timer=null),this.websocket&&this.websocket.readyState===WebSocket.OPEN&&(this.websocket.close(),this.websocket=null),this.logWebsocket&&this.logWebsocket.readyState===WebSocket.OPEN&&(this.logWebsocket.close(),this.logWebsocket=null),this.onlineWebsocket&&this.onlineWebsocket.readyState===WebSocket.OPEN&&(this.isOnlineClose=!0,this.onlineWebsocket.close(),this.onlineWebsocket=null),this.onOrofflineTimer&&(clearInterval(this.onOrofflineTimer),this.onOrofflineTimer=null)},computed:{ids:function(){return this.$store.state.ids}},watch:{$route:function(e,t){this.defaultActive=e.path,this.channelDisabled="/channelinfo"!=e.path&&"/transchannelinfo"!=e.path}}},O=L,T=(n("52a9"),n("a7a1"),Object($["a"])(O,i,o,!1,null,"11ba3355",null));t["default"]=T.exports},e8b6:function(e,t,n){"use strict";n("fefb")},f229:function(e,t,n){},fefb:function(e,t,n){}}]);
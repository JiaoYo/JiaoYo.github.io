(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ac619f4"],{"1d5c":function(e,t,a){},"2a1f":function(e,t,a){"use strict";a.r(t);a("34ef"),a("28a5"),a("6b54"),a("4917");
/*! @source http://purl.eligrey.com/github/Blob.js/blob/master/Blob.js */
(function(e){if(e.URL=e.URL||e.webkitURL,e.Blob&&e.URL)try{return void new Blob}catch(n){}var t=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||function(e){var t=function(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]},a=function(){this.data=[]},n=function(e,t,a){this.data=e,this.size=e.length,this.type=t,this.encoding=a},i=a.prototype,r=n.prototype,s=e.FileReaderSync,o=function(e){this.code=this[this.name=e]},l="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),c=l.length,h=e.URL||e.webkitURL||e,d=h.createObjectURL,g=h.revokeObjectURL,u=h,p=e.btoa,f=e.atob,m=e.ArrayBuffer,w=e.Uint8Array,b=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;n.fake=r.fake=!0;while(c--)o.prototype[l[c]]=c+1;return h.createObjectURL||(u=e.URL=function(e){var t,a=document.createElementNS("http://www.w3.org/1999/xhtml","a");return a.href=e,"origin"in a||("data:"===a.protocol.toLowerCase()?a.origin=null:(t=e.match(b),a.origin=t&&t[1])),a}),u.createObjectURL=function(e){var t,a=e.type;return null===a&&(a="application/octet-stream"),e instanceof n?(t="data:"+a,"base64"===e.encoding?t+";base64,"+e.data:"URI"===e.encoding?t+","+decodeURIComponent(e.data):p?t+";base64,"+p(e.data):t+","+encodeURIComponent(e.data)):d?d.call(h,e):void 0},u.revokeObjectURL=function(e){"data:"!==e.substring(0,5)&&g&&g.call(h,e)},i.append=function(e){var a=this.data;if(w&&(e instanceof m||e instanceof w)){for(var i="",r=new w(e),l=0,c=r.length;l<c;l++)i+=String.fromCharCode(r[l]);a.push(i)}else if("Blob"===t(e)||"File"===t(e)){if(!s)throw new o("NOT_READABLE_ERR");var h=new s;a.push(h.readAsBinaryString(e))}else e instanceof n?"base64"===e.encoding&&f?a.push(f(e.data)):"URI"===e.encoding?a.push(decodeURIComponent(e.data)):"raw"===e.encoding&&a.push(e.data):("string"!==typeof e&&(e+=""),a.push(unescape(encodeURIComponent(e))))},i.getBlob=function(e){return arguments.length||(e=null),new n(this.data.join(""),e,"raw")},i.toString=function(){return"[object BlobBuilder]"},r.slice=function(e,t,a){var i=arguments.length;return i<3&&(a=null),new n(this.data.slice(e,i>1?t:this.data.length),a,this.encoding)},r.toString=function(){return"[object Blob]"},r.close=function(){this.size=0,delete this.data},a}(e);e.Blob=function(e,a){var n=a&&a.type||"",i=new t;if(e)for(var r=0,s=e.length;r<s;r++)Uint8Array&&e[r]instanceof Uint8Array?i.append(e[r].buffer):i.append(e[r]);var o=i.getBlob(n);return!o.slice&&o.webkitSlice&&(o.slice=o.webkitSlice),o};var a=Object.getPrototypeOf||function(e){return e.__proto__};e.Blob.prototype=a(new e.Blob)})("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||void 0)},"2c9f":function(e,t,a){e.exports=a.p+"img/twosignal.f6f59bac.png"},"376b":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));a("6b54"),a("34ef"),a("ac6a");function n(e,t){t&&(e+=1462);var a=Date.parse(e);return(a-new Date(Date.UTC(1899,11,30)))/864e5}function i(e,t){for(var a={},i={s:{c:1e7,r:1e7},e:{c:0,r:0}},r=0;r!=e.length;++r)for(var s=0;s!=e[r].length;++s){i.s.r>r&&(i.s.r=r),i.s.c>s&&(i.s.c=s),i.e.r<r&&(i.e.r=r),i.e.c<s&&(i.e.c=s);var o={v:e[r][s]};if(null!=o.v){var l=XLSX.utils.encode_cell({c:s,r:r});"number"===typeof o.v?o.t="n":"boolean"===typeof o.v?o.t="b":o.v instanceof Date?(o.t="n",o.z=XLSX.SSF._table[14],o.v=n(o.v)):o.t="s",a[l]=o}}return i.s.c<1e7&&(a["!ref"]=XLSX.utils.encode_range(i)),a}function r(){if(!(this instanceof r))return new r;this.SheetNames=[],this.Sheets={}}function s(e){for(var t=new ArrayBuffer(e.length),a=new Uint8Array(t),n=0;n!=e.length;++n)a[n]=255&e.charCodeAt(n);return t}function o(e,t,a){var n=t;n.unshift(e);for(var o="SheetJS",l=new r,c=i(n),h=n.map((function(e){return e.map((function(e){return null==e?{wch:10}:e.toString().charCodeAt(0)>255?{wch:2*e.toString().length+5}:{wch:e.toString().length+5}}))})),d=h[0],g=1;g<h.length;g++)for(var u=0;u<h[g].length;u++)d[u]["wch"]<h[g][u]["wch"]&&(d[u]["wch"]=h[g][u]["wch"]);c["!cols"]=d,l.SheetNames.push(o),l.Sheets[o]=c;var p=XLSX.write(l,{bookType:"xlsx",bookSST:!1,type:"binary"}),f=a||"列表";saveAs(new Blob([s(p)],{type:"application/octet-stream"}),f+".xlsx")}a("2a1f"),a("0fd4"),a("1447")},"3df3":function(e,t,a){"use strict";a.r(t);a("7f7f");var n=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"aui-card--fill",attrs:{shadow:"never"}},[t("el-form",{attrs:{inline:!0},nativeOn:{submit:function(e){e.preventDefault()},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.querySearch()}}},[t("el-form-item",{attrs:{label:e.$t("project.projectName")}},[t("el-select",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.handlePrjScroll,expression:"handlePrjScroll"}],attrs:{clearable:"",size:"small"},on:{"visible-change":e.handlePrjVisibleChange,change:e.handlePrjChange},model:{value:e.dataForm.name,callback:function(t){e.$set(e.dataForm,"name",t)},expression:"dataForm.name"}},[[t("div",{staticStyle:{width:"100%",position:"absolute",left:"0",top:"0","z-index":"99","background-color":"#fff"}},[t("el-input",{ref:"prjInput",staticStyle:{width:"98%","margin-left":"1%","margin-top":"5px","margin-bottom":"5px"},attrs:{size:"small",clearable:"",placeholder:e.$t("gwsn.pleaseEnterSearchContent")},model:{value:e.prjSearch,callback:function(t){e.prjSearch=t},expression:"prjSearch"}})],1),t("div",{staticStyle:{width:"100%",height:"42px"}}),e._l(e.projectName,(function(e){return t("el-option",{key:e.id,attrs:{label:e.prjName,value:e.id,disabled:!!e.hasOwnProperty("disabled")&&e.disabled}})}))]],2)],1),t("el-form-item",{attrs:{label:e.$t("historyQuery.gwsn")}},[t("el-select",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.handleGwsnScroll,expression:"handleGwsnScroll"}],attrs:{clearable:"",size:"small"},on:{"visible-change":e.handleGwsnVisibleChange,change:e.querySearch},model:{value:e.dataForm.gwsn,callback:function(t){e.$set(e.dataForm,"gwsn",t)},expression:"dataForm.gwsn"}},[[t("div",{staticStyle:{width:"100%",position:"absolute",left:"0",top:"0","z-index":"99","background-color":"#fff"}},[t("el-input",{ref:"gwsnInput",staticStyle:{width:"98%","margin-left":"1%","margin-top":"5px","margin-bottom":"5px"},attrs:{size:"small",clearable:"",placeholder:e.$t("gwsn.pleaseEnterSearchContent")},model:{value:e.gwsnSearch,callback:function(t){e.gwsnSearch=t},expression:"gwsnSearch"}})],1),t("div",{staticStyle:{width:"100%",height:"42px"}}),e._l(e.gwsnList,(function(a){return t("el-option",{key:a.sn,attrs:{label:a.sn,value:a.sn,disabled:!!a.hasOwnProperty("disabled")&&a.disabled}},[t("span",{staticStyle:{width:"calc(100%- 210px)",display:"inline-block","text-align":"left",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:a.sn}},[e._v("\n                            "+e._s(a.sn)+"\n                        ")]),t("span",{staticStyle:{color:"#8492a6","font-size":"13px",display:"inline-block","margin-left":"10px",width:"200px","text-align":"right",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:a.gwDesc}},[e._v("\n                            "+e._s(a.gwDesc||e.$t("historyQuery.no"))+"\n                        ")])])}))]],2)],1),t("el-form-item",[t("el-date-picker",{staticStyle:{width:"350px"},attrs:{size:"small",clearable:!1,type:"datetimerange","picker-options":e.pickerOptions,"range-separator":e.$t("historyQuery.to"),"start-placeholder":e.$t("historyQuery.startTime"),"end-placeholder":e.$t("historyQuery.endTime"),align:"right",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss"},on:{change:e.changeTime},model:{value:e.dataForm.createdate,callback:function(t){e.$set(e.dataForm,"createdate",t)},expression:"dataForm.createdate"}})],1),t("el-form-item",[t("el-button",{attrs:{size:"small",icon:"el-icon-search"},on:{click:e.querySearch}},[e._v(e._s(e.$t("query")))])],1),t("el-form-item",[t("el-button",{attrs:{type:"success",size:"small",icon:"el-icon-download",disabled:0==e.dataList.length},on:{click:e.exportExcel}},[e._v(e._s(e.$t("export"))+" ")])],1)],1),t("vxe-table",{ref:"recordTable",staticStyle:{width:"100%"},attrs:{size:"mini",border:"",resizable:"","auto-resize":"","show-overflow":"","show-header-overflow":"","highlight-hover-row":"","highlight-current-row":"","max-height":e.scrollTableHeight,loading:e.dataListLoading,"row-config":{keyField:"id"},"scroll-y":{enabled:!0}}},[t("vxe-table-column",{attrs:{field:"dbtime",title:e.$t("gwsn.heartbeatTime"),"header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.dbtime||""))])]}}])}),t("vxe-table-column",{attrs:{field:"sn",title:e.$t("gwsn.number"),"header-align":"center",align:"center","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.sn||e.$t("no")))])]}}])}),t("vxe-table-column",{attrs:{field:"csq",title:e.$t("gwsn.signalValue"),"header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[n.row.csq?t("div",{staticStyle:{display:"flex","justify-content":"center","align-items":"center",height:"20px","line-height":"20px"}},[0==n.row.csq?t("img",{staticStyle:{width:"20px",height:"20px"},attrs:{src:a("a90d"),alt:""}}):e._e(),n.row.csq>0&&n.row.csq<10?t("img",{staticStyle:{width:"20px",height:"20px"},attrs:{src:a("cdf7"),alt:""}}):e._e(),n.row.csq>=10&&n.row.csq<15?t("img",{staticStyle:{width:"20px",height:"20px"},attrs:{src:a("2c9f"),alt:""}}):e._e(),n.row.csq>=15&&n.row.csq<20?t("img",{staticStyle:{width:"20px",height:"20px"},attrs:{src:a("f27f"),alt:""}}):e._e(),n.row.csq>=20&&n.row.csq<25?t("img",{staticStyle:{width:"20px",height:"20px"},attrs:{src:a("6a9e"),alt:""}}):e._e(),n.row.csq>=25&&n.row.csq<=40?t("img",{staticStyle:{width:"20px",height:"20px"},attrs:{src:a("ee58"),alt:""}}):e._e(),255==n.row.csq?t("img",{attrs:{src:a("e310"),alt:""}}):e._e(),t("span",{staticStyle:{"margin-left":"5px",display:"inline-block"}},[e._v(e._s(255==n.row.csq?e.$t("gwsn.internet"):n.row.csq))])]):t("div")]}}])})],1),t("vxe-pager",{attrs:{perfect:"",size:"mini","current-page":e.page,"page-size":e.limit,"page-sizes":[100,200,500,1e3],total:e.total,layouts:["PrevPage","JumpNumber","NextPage","FullJump","Sizes","Total"]},on:{"page-change":e.handlePageChange}})],1)},i=[],r=(a("96cf"),a("1da1")),s=(a("ac6a"),a("c5f6"),a("a481"),a("4328")),o=a.n(s),l=(a("a78e"),a("b047")),c=a.n(l),h=a("376b"),d={name:"tgwonline",directives:{loadmore:{inserted:function(e,t){var a=e.querySelector(".el-select-dropdown .el-select-dropdown__wrap");a.addEventListener("scroll",(function(){var e=this.scrollHeight-Math.ceil(this.scrollTop)<=this.clientHeight;e&&0!==this.scrollTop&&t.value()}))}}},data:function(){var e=this;return{prjPage:1,prjTotal:0,gwsnPage:1,gwsnTotal:0,page:1,limit:1e3,total:0,scrollTop:0,scrollLeft:0,startTime:"",endTime:"",dataListLoading:!1,pickerMinDate:"",dataForm:{name:"",gwsn:"",createdate:[]},scrollTableHeight:window.innerHeight-220-53,prjSearch:"",gwsnSearch:"",projectName:[],gwsnList:[],dataList:[],pickerOptions:{onPick:function(t){var a=t.maxDate,n=t.minDate;e.pickerMinDate=n.getTime(),a&&(e.pickerMinDate="")},disabledDate:function(t){if(""!=e.pickerMinDate){var a=2592e6,n=e.pickerMinDate-a,i=e.pickerMinDate+a;return t.getTime()<n||t.getTime()>i}return t.getTime()>Date.now()},shortcuts:[{text:this.$t("lastDay"),onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-864e5),e.$emit("pick",[a,t])}},{text:this.$t("lastWeek"),onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:this.$t("lastMonth"),onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}}]}}},methods:{pageSizeChangeHandle:function(e){this.page=1,this.limit=e,this.scrollTableHeight=window.innerHeight-220-53,this.historyList()},pageCurrentChangeHandle:function(e){this.page=e,this.historyList()},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.page=t,this.limit=a,this.historyList()},getPrjNameList:function(){var e=this,t={page:e.prjPage,limit:50,priName:e.prjSearch.replace(/\s+/g,""),_t:(new Date).getTime()};e.$hasPermission("tprjinfo:list:select")?e.$http.get("/info/tprjinfo/tprjinfoList",{params:t}).then((function(t){var a=t.data;if(a.hasOwnProperty("code")&&0!=a.code)return e.$message.error(a.data||a.msg);1==e.prjPage?e.projectName=a.list:e.projectName=e.projectName.concat(a.list),0==e.projectName.length&&e.projectName.push({id:e.$t("noMatchingDataYet"),prjName:e.$t("noMatchingDataYet"),disabled:!0}),e.prjTotal=Number(a.total)})).catch((function(e){return!1})):e.$message.warning("暂无项目查询权限, 请联系管理员")},handlePrjChange:function(){this.gwsnPage=1,this.dataForm.name&&(this.dataForm.gwsn="",this.total=0,this.dataList=[],this.querySearch()),this.getAllGwsnDataList()},getAllGwsnDataList:function(){var e=this,t={pageNum:e.gwsnPage,pageSize:200,prjId:e.dataForm.name,fuzzy:e.gwsnSearch,_t:(new Date).getTime()};e.$hasPermission("gwbaseinfo:select:permission.do")?e.$http.post("/info/gwbaseinfo/selectByPage.do",o.a.stringify(t)).then((function(t){var a=t.data;if(a.hasOwnProperty("code")&&0!=a.code)return e.$message.error(a.data||a.msg);1==e.gwsnPage?e.gwsnList=a.data.list:e.gwsnList=e.gwsnList.concat(a.data.list),0==e.gwsnList.length&&e.gwsnList.push({sn:e.$t("noMatchingDataYet"),gwDesc:e.$t("noMatchingDataYet"),disabled:!0}),e.gwsnTotal=Number(a.data.total)})).catch((function(e){return!1})):e.$message.warning("暂无网关查询权限, 请联系管理员")},handlePrjVisibleChange:function(e){var t=this;e&&this.$nextTick((function(){t.$refs.prjInput.focus()}))},handleGwsnVisibleChange:function(e){var t=this;e&&this.$nextTick((function(){t.$refs.gwsnInput.focus()}))},selectGwsn:function(e){this.querySearch()},resetExcelData:function(e,t){var a=this,n=[];e.forEach((function(e){var t={dbtime:e.dbtime||"",gwsn:a.dataForm.gwsn||"--",csq:e.csq||"--"};n.push(t)})),t(n)},exportExcel:c()((function(){var e=this;return e.dataForm.gwsn?new Date(e.endTime).getTime()-new Date(e.startTime).getTime()>2592e6?e.$message.warning(e.$t("pleaseSelectMonthDate")+"!!!"):void(e.$hasPermission("heartMongod:select:permission.do")?Promise.resolve().then(function(){e.resetExcelData(e.dataList,(function(t){for(var a=[{label:e.$t("gwsn.heartbeatTime"),prop:"dbtime"},{label:e.$t("gwsn.number"),prop:"gwsn"},{label:e.$t("gwsn.signalValue"),prop:"csq"}],n=[],i=[],r=0;r<a.length;r++)n[r]=a[r].label,i[r]=a[r].prop;var s=n,o=i,l=t,c=e.formatJson(o,l);Object(h["a"])(s,c,e.$t("gatewayOnlineLog")+e.dataForm.gwsn+"_"+(new Date).getTime())}))}.bind(null,a)).catch(a.oe):e.$message.warning("暂无网关上线日志查询权限, 请联系管理员")):e.$message.error(e.$t("historyQuery.pleaseSelectGwsn"))}),1e3,{leading:!0,trailing:!1}),formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))})),t.map((function(t){return e.map((function(e){return t[e]}))}))},querySearch:function(){this.page=1,this.historyList()},historyList:c()((function(){var e=this;if(e.dataList=[],!e.dataForm.gwsn)return e.$message.warning(e.$t("historyQuery.pleaseSelectGwsn"));if(new Date(e.endTime).getTime()-new Date(e.startTime).getTime()>2592e6)return e.$message.warning(e.$t("pleaseSelectMonthDate")+"!!!");if(e.$hasPermission("heartMongod:select:permission.do")){var t={page:e.page,limit:e.limit,sn:e.dataForm.gwsn,startTime:e.startTime,endTime:e.endTime};e.$http.get("/historyHeart/getPage.do",{params:t}).then((function(a){var n=a.data;if(n.hasOwnProperty("code")&&0!=n.code)return e.$message.error(n.data||n.msg);e.dataListLoading=!1,e.dataList=n.data.list,e.total=Number(n.data.total),e.page=t.page,e.$refs.recordTable.loadData(e.dataList).then((function(){e.dataListLoading=!1})).finally((function(){return!1}))})).catch((function(t){return e.dataListLoading=!1,!1}))}else e.$message.warning("暂无网关上线日志查询权限, 请联系管理员")}),1e3,{leading:!0,trailing:!1}),changeTime:function(e){e?(this.startTime=e[0],this.endTime=e[1]):(this.startTime="",this.endTime="")},timeFormat:function(e){var t=new Date(e),a=t.getFullYear(),n=t.getMonth()+1,i=t.getDate(),r=t.getHours(),s=t.getMinutes(),o=t.getSeconds();return a+"-"+this.add0(n)+"-"+this.add0(i)+" "+this.add0(r)+":"+this.add0(s)+":"+this.add0(o)},add0:function(e){return e<10?"0"+e:e},getDefaultDate:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.startTime=this.timeFormat((new Date).getTime()-864e5),this.endTime=this.timeFormat(new Date),this.dataForm.createdate=[this.startTime,this.endTime],e.next=1,this.getPrjNameList();case 1:return e.next=2,this.getAllGwsnDataList();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handlePrjScroll:function(){this.projectName.length<this.prjTotal&&(this.prjPage++,this.getPrjNameList())},handleGwsnScroll:function(){this.gwsnList.length<this.gwsnTotal&&(this.gwsnPage++,this.getAllGwsnDataList())},watchPrjSearch:c()((function(){var e=document.getElementsByClassName("el-scrollbar__wrap").length;document.getElementsByClassName("el-scrollbar__wrap")[e-1].scrollTo(0,0),this.prjPage=1,this.getPrjNameList(),this.$refs.prjInput.focus()}),500),watchGwsnSearch:c()((function(){this.gwsnSearch&&(this.total=0,this.dataList=[]);var e=document.getElementsByClassName("el-scrollbar__wrap").length;document.getElementsByClassName("el-scrollbar__wrap")[e-1].scrollTo(0,0),this.gwsnPage=1,this.getAllGwsnDataList(),this.$refs.gwsnInput.focus()}),500)},mounted:function(){var e=this;this.getDefaultDate(),window.onresize=function(){return function(){e.scrollTableHeight=window.innerHeight-220-53}()}},watch:{prjSearch:function(e,t){this.watchPrjSearch()},gwsnSearch:function(e,t){this.watchGwsnSearch()}}},g=d,u=(a("6dd3"),a("2877")),p=Object(u["a"])(g,n,i,!1,null,"007fa8b6",null);t["default"]=p.exports},"6a9e":function(e,t,a){e.exports=a.p+"img/foursignal.64aaba66.png"},"6dd3":function(e,t,a){"use strict";a("1d5c")},a90d:function(e,t,a){e.exports=a.p+"img/nosignal.2a07e3d4.png"},cdf7:function(e,t,a){e.exports=a.p+"img/onesignal.d46cc0d2.png"},e310:function(e,t,a){e.exports=a.p+"img/internet.ebcc304b.png"},ee58:function(e,t,a){e.exports=a.p+"img/fullsignal.78fda6ac.png"},f27f:function(e,t,a){e.exports=a.p+"img/threesignal.43f66fe1.png"}}]);
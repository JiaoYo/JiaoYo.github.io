(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-435cc4a8"],{"4ed1":function(e,t,a){},"6dcd":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.visible,title:e.$t("add"),"close-on-click-modal":!1,"close-on-press-escape":!1,width:"40%","before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t},opened:e.onDialogOpened}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataForm",attrs:{model:e.dataForm,rules:e.rules,"label-width":"en-US"===e.$i18n.locale?"150px":"100px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dataFormSubmitHandle()}}},[t("el-form-item",{attrs:{label:e.$t("gwsn.belongProject"),prop:"prjId"}},[t("el-select",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.handlePrjScroll,expression:"handlePrjScroll"}],staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:e.$t("select")},on:{"visible-change":e.handlePrjVisibleChange,change:e.handleSelectPrjChange},model:{value:e.dataForm.prjId,callback:function(t){e.$set(e.dataForm,"prjId",t)},expression:"dataForm.prjId"}},[[t("div",{staticStyle:{width:"100%",position:"absolute",left:"0",top:"0","z-index":"99","background-color":"#fff"}},[t("el-input",{ref:"prjInput",staticStyle:{width:"98%","margin-left":"1%","margin-top":"5px","margin-bottom":"5px"},attrs:{size:"small",clearable:"",placeholder:e.$t("gwsn.pleaseEnterSearchContent")},model:{value:e.prjSearch,callback:function(t){e.prjSearch=t},expression:"prjSearch"}})],1),t("div",{staticStyle:{width:"100%",height:"42px"}}),e._l(e.prjList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.prjName,value:e.id,disabled:!!e.hasOwnProperty("disabled")&&e.disabled}})}))]],2)],1),t("el-form-item",{attrs:{label:e.$t("gwsn.isCopy"),prop:"isCopy"}},[t("el-radio-group",{model:{value:e.dataForm.isCopy,callback:function(t){e.$set(e.dataForm,"isCopy",t)},expression:"dataForm.isCopy"}},e._l(e.copyList,(function(a){return t("el-radio",{key:a.value,attrs:{label:a.value}},[e._v(e._s(a.label))])})),1)],1),1==e.dataForm.isCopy?t("el-form-item",{attrs:{label:e.$t("gwsn.copyDataSource"),prop:"gwsn",rules:1==this.dataForm.isCopy?e.rules.gwsn:[{required:!1,message:this.$t("validate.required"),trigger:"change"}]}},[t("el-select",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.handleGwsnScroll,expression:"handleGwsnScroll"}],staticStyle:{width:"100%"},attrs:{clearable:""},on:{"visible-change":e.handleGwsnVisibleChange},model:{value:e.dataForm.gwsn,callback:function(t){e.$set(e.dataForm,"gwsn",t)},expression:"dataForm.gwsn"}},[[t("div",{staticStyle:{width:"100%",position:"absolute",left:"0",top:"0","z-index":"99","background-color":"#fff"}},[t("el-input",{ref:"gwsnInput",staticStyle:{width:"98%","margin-left":"1%","margin-top":"5px","margin-bottom":"5px"},attrs:{size:"small",clearable:"",placeholder:e.$t("gwsn.pleaseEnterSearchContent")},model:{value:e.gwsnSearch,callback:function(t){e.gwsnSearch=t},expression:"gwsnSearch"}})],1),t("div",{staticStyle:{width:"100%",height:"42px"}}),e._l(e.tgwList,(function(a){return t("el-option",{key:a.sn,attrs:{label:a.sn,value:a.sn,disabled:!!a.hasOwnProperty("disabled")&&a.disabled}},[t("span",{staticStyle:{width:"200px",display:"inline-block","text-align":"left",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:a.sn}},[e._v("\n                            "+e._s(a.sn)+"\n                        ")]),t("span",{staticStyle:{color:"#8492a6","font-size":"13px",display:"inline-block","margin-left":"10px",width:"calc(100%- 210px)","text-align":"right",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},attrs:{title:a.gwDesc}},[e._v("\n                            "+e._s(a.gwDesc||e.$t("historyQuery.no"))+"\n                        ")])])}))]],2)],1):e._e(),t("el-form-item",{attrs:{label:e.$t("gwsn.number"),prop:"gwSn"}},[t("el-input",{attrs:{placeholder:e.$t("gwsn.enterGwsn"),readonly:!!e.dataForm.id,maxlength:20,clearable:""},model:{value:e.dataForm.gwSn,callback:function(t){e.$set(e.dataForm,"gwSn","string"===typeof t?t.trim():t)},expression:"dataForm.gwSn"}})],1),t("el-form-item",{attrs:{label:e.$t("gwsn.gwsnPassword"),prop:"gwPwd"}},[t("el-input",{attrs:{type:"password",placeholder:e.$t("gwsn.enterPassword"),"show-password":"",clearable:""},model:{value:e.dataForm.gwPwd,callback:function(t){e.$set(e.dataForm,"gwPwd","string"===typeof t?t.trim():t)},expression:"dataForm.gwPwd"}})],1),t("el-form-item",[t("el-checkbox",{model:{value:e.isContinueAdd,callback:function(t){e.isContinueAdd=t},expression:"isContinueAdd"}},[e._v(e._s(e.$t("gwsn.doYouWantToContinueAdding")))])],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:e.handleClose}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmitHandle()}}},[e._v(e._s(e.$t("confirm")))])],1)],2)},n=[],r=(a("c5f6"),a("a481"),a("96cf"),a("1da1")),i=a("4328"),o=a.n(i),l=a("b047"),d=a.n(l),c={props:["prjId"],directives:{loadmore:{inserted:function(e,t){var a=e.querySelector(".el-select-dropdown .el-select-dropdown__wrap");a.addEventListener("scroll",(function(){var e=this.scrollHeight-Math.ceil(this.scrollTop)<=this.clientHeight;e&&0!==this.scrollTop&&t.value()}))}}},data:function(){return{isCloseDialog:!1,visible:!1,loading:!1,prjPage:1,prjTotal:0,prjSearch:"",prjList:[],gwsnPage:1,gwsnTotal:0,gwsnSearch:"",tgwList:[],queryParamas:{},oldGwsnDesc:"",dataForm:{id:"",gwSn:"",gwPwd:"",prjId:"",gwDesc:"",isCopy:0,gwsn:"",deptId:""},isContinueAdd:!1,copyList:[{label:this.$t("gwsn.yes"),value:1},{label:this.$t("gwsn.no"),value:0}],rules:{prjId:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],gwSn:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],gwPwd:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]}}},methods:{init:function(){this.visible=!0},onDialogOpened:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this,a={},t.isCloseDialog=!1,t.$refs["dataForm"].resetFields(),t.prjPage=1,t.prjTotal=0,t.prjList=[],t.gwsnPage=1,t.gwsnTotal=0,t.tgwList=[],t.dataForm.deptId=t.$store.state.user.deptId,!t.prjId){e.next=2;break}if(a["id"]=t.prjId,t.$hasPermission("tprjinfo:select:permission.do")){e.next=1;break}return t.loading=!1,t.$message.warning("暂无项目查询权限, 请联系管理员"),e.abrupt("return");case 1:t.$http.get("/info/tprjinfo/".concat(t.prjId),{params:a}).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(a.data||a.msg);t.prjSearch=a.data.prjName})).catch((function(e){return!1})),e.next=4;break;case 2:return e.next=3,t.getList();case 3:return e.next=4,t.getAllGwsnDataList();case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getList:function(){var e=this,t={page:e.prjPage,limit:50,priName:e.prjSearch.replace(/\s+/g,""),_t:(new Date).getTime()};e.$hasPermission("tprjinfo:list:select")?(e.loading=!0,e.$http.get("/info/tprjinfo/tprjinfoList",{params:t}).then((function(t){var a=t.data;if(a.hasOwnProperty("code")&&0!=a.code)return e.$message.error(a.data||a.msg);1==e.prjPage?e.prjList=a.list:e.prjList=e.prjList.concat(a.list),e.prjTotal=Number(a.total),0==e.prjList.length?(e.loading=!1,e.prjList.push({id:e.$t("noMatchingDataYet"),prjName:e.$t("noMatchingDataYet"),disabled:!0})):(e.prjId&&(e.dataForm.prjId=e.prjId,e.getAllGwsnDataList()),e.loading=!1)})).catch((function(t){return e.loading=!1,!1}))):e.$message.warning("暂无项目查询权限, 请联系管理员")},getAllGwsnDataList:function(){var e=this,t={pageNum:e.gwsnPage,pageSize:200,prjId:e.dataForm.prjId,fuzzy:e.gwsnSearch,_t:(new Date).getTime()};e.$hasPermission("gwbaseinfo:select:permission.do")?e.$http.post("/info/gwbaseinfo/selectByPage.do",o.a.stringify(t)).then((function(t){var a=t.data;if(a.hasOwnProperty("code")&&0!=a.code)return e.$message.error(a.data||a.msg);1==e.gwsnPage?e.tgwList=a.data.list:e.tgwList=e.tgwList.concat(a.data.list),0==e.tgwList.length&&e.tgwList.push({sn:e.$t("noMatchingDataYet"),gwDesc:e.$t("noMatchingDataYet"),disabled:!0}),e.gwsnTotal=Number(a.data.total)})).catch((function(e){return!1})):e.$message.warning("暂无网关查询权限, 请联系管理员")},handlePrjVisibleChange:function(e){var t=this;e&&this.$nextTick((function(){t.$refs.prjInput.focus()}))},handleSelectPrjChange:function(){this.gwsnPage=1,this.dataForm.gwsn="",this.getAllGwsnDataList()},handlePrjScroll:function(){this.prjList.length<this.prjTotal&&(this.prjPage++,this.getList())},handleGwsnVisibleChange:function(e){var t=this;e&&this.$nextTick((function(){t.$refs.gwsnInput.focus()}))},handleGwsnScroll:function(){this.tgwList.length<this.gwsnTotal&&(this.gwsnPage++,this.getAllGwsnDataList())},handleClose:function(){this.isCloseDialog=!0,this.prjSearch="",this.gwsnSearch="",this.visible=!1},dataFormSubmitHandle:d()((function(){var e=this,t=this,a=t.dataForm.isCopy,s=null;t.$refs["dataForm"].validate((function(n){return!!n&&(t.dataForm.prjId?1!=a||t.dataForm.gwsn?void(t.$hasPermission("tgwinfo:select:permission.do")?t.$http.get("/info/tgwinfo/tgwinfoNameAndPwd",{params:{gwsn:t.dataForm.gwSn,pwd:t.dataForm.gwPwd}}).then((function(e){var n=e.data;if("fail"==n.msg)t.$message.error(n.data||n.msg),t.dataForm.gwPwd="";else{if(s={gwSn:t.dataForm.gwSn,gwPwd:t.dataForm.gwPwd,prjId:t.dataForm.prjId,gwDesc:t.dataForm.gwDesc,deptId:t.dataForm.deptId},1===a&&(t.queryParamas={gwsn:t.dataForm.gwsn,ClientGwsn:t.dataForm.gwSn}),!t.$hasPermission("info:gwbaseinfo:save"))return void t.$message.warning("暂无网关新增权限, 请联系管理员");t.$http.post("/info/gwbaseinfo",s).then((function(e){var s=e.data;if(0!=s.code)return t.$message.error(s.data||s.msg);t.$message({message:t.$t("prompt.success"),type:"success",duration:500,onClose:function(){if(1===a){if(!t.$hasPermission("gwbaseinfo:GwsnCopy:permission.do"))return void t.$message.warning("暂无网关复制权限, 请联系管理员");t.$http.post("/info/gwbaseinfo/selectAllGwsnCopy",o.a.stringify(t.queryParamas)).then((function(e){if(e.hasOwnProperty("code")&&0!==e.code)return t.$message.error(e.data||e.msg);t.isContinueAdd?(t.dataForm.gwPwd="",t.$emit("refreshDataList")):(t.isCloseDialog=!0,t.prjSearch="",t.gwsnSearch="",t.visible=!1,t.$emit("refreshDataList"))})).catch((function(e){return!1}))}else t.isContinueAdd?(t.dataForm.gwPwd="",t.$emit("refreshDataList")):(t.isCloseDialog=!0,t.prjSearch="",t.gwsnSearch="",t.visible=!1,t.$emit("refreshDataList"))}})})).catch((function(e){return!1}))}})).catch((function(e){return!1})):t.$message.warning("暂无网关信息查询权限, 请联系管理员")):t.$message.warning(e.$t("gwsn.copyDataSourceCannotBeEmpty")):t.$message.warning(e.$t("gwsn.theProjectCannotBeEmpty")))}))}),1e3,{leading:!0,trailing:!1}),watchPrjSearch:d()((function(){var e=document.getElementsByClassName("el-scrollbar__wrap").length;document.getElementsByClassName("el-scrollbar__wrap")[e-1].scrollTo(0,0),this.prjPage=1,this.getList(),this.$refs.prjInput.focus()}),500),watchGwsnSearch:d()((function(){var e=document.getElementsByClassName("el-scrollbar__wrap").length;document.getElementsByClassName("el-scrollbar__wrap")[e-1].scrollTo(0,0),this.gwsnPage=1,this.getAllGwsnDataList(),this.$refs.gwsnInput.focus()}),500)},watch:{prjSearch:function(e,t){this.isCloseDialog||this.watchPrjSearch()},gwsnSearch:function(e,t){this.isCloseDialog||this.watchGwsnSearch()}}},g=c,p=(a("824f"),a("2877")),h=Object(p["a"])(g,s,n,!1,null,"e0ee3528",null);t["default"]=h.exports},"824f":function(e,t,a){"use strict";a("4ed1")}}]);
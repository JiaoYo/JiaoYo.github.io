(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e54f65b0","chunk-f65859e0","chunk-2d0bdf0b"],{"0224":function(e,t,a){},"10dc":function(e,t,a){"use strict";a("0224")},"2dad":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e._self._c;return t("section",[t("el-dialog",{attrs:{visible:e.visible,title:"pass"===e.type?"授权通过":"授权拒绝","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.visible=t},close:e.handleClose}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataForm",attrs:{model:e.dataForm,rules:e.rules,"label-position":"left","label-width":"100px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dataFormSubmitHandle()}}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{prop:"sn",label:"网关编号"}},[t("el-input",{attrs:{disabled:"",size:"small",placeholder:"请输入网关编号"},model:{value:e.dataForm.sn,callback:function(t){e.$set(e.dataForm,"sn",t)},expression:"dataForm.sn"}})],1),t("el-form-item",{staticStyle:{"margin-top":"20px"},attrs:{prop:"proname",label:10==e.soft?"客户名称":"项目名称"}},[t("el-input",{attrs:{disabled:"",size:"small",placeholder:10==e.soft?"请输入客户名称":"请输入项目名称"},model:{value:e.dataForm.proname,callback:function(t){e.$set(e.dataForm,"proname",t)},expression:"dataForm.proname"}})],1),t("el-form-item",{staticStyle:{"margin-top":"20px"},attrs:{label:"授权软件"}},[t("el-autocomplete",{staticStyle:{width:"100%"},attrs:{disabled:"",size:"small",clearable:"","fetch-suggestions":e.querySearchAsync,placeholder:"请输入授权软件"},on:{select:e.handleSelect},model:{value:e.dataForm.softName,callback:function(t){e.$set(e.dataForm,"softName",t)},expression:"dataForm.softName"}})],1),t("el-form-item",{attrs:{prop:"expiretime",label:"过期时间"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{clearable:!1,size:"small",type:"datetime",placeholder:"请选择过期时间",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","picker-options":e.pickerOptions},model:{value:e.dataForm.expiretime,callback:function(t){e.$set(e.dataForm,"expiretime",t)},expression:"dataForm.expiretime"}})],1),t("el-form-item",{staticStyle:{"margin-top":"20px"},attrs:{prop:"desc",label:"备注"}},[t("el-input",{attrs:{size:"small",type:"textarea",autosize:{minRows:4,maxRows:8},placeholder:"请输入备注"},model:{value:e.dataForm.desc,callback:function(t){e.$set(e.dataForm,"desc",t)},expression:"dataForm.desc"}})],1)],1)],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:e.handleClose}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmitHandle()}}},[e._v(e._s(e.$t("confirm")))])],1)],2)],1)},r=[],n=(a("28a5"),a("3835")),i=(a("f559"),a("7f7f"),a("4328")),s=a.n(i),l=a("b047"),c=a.n(l),m={props:["id","sn","soft","protocol","proname","type","expiretime"],data:function(){return{visible:!1,loading:!1,dataForm:{sn:"",softName:"",proname:"",desc:"",expiretime:"2099-12-31 23:59:59"},rules:{sn:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],softName:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]},softNameOptions:[{value:"PBOX"},{value:"LOGGER"},{value:"ASDU"},{value:"ASDU-LE"},{value:"ASDU-LX"},{value:"hkw-agent(探针)"},{value:"HKW-NF500(防火墙)"},{value:"HKW-IDS2000(入侵检测)"},{value:"HKW-LAS1000(日志审计系统)"},{value:"HKW-DAS1000(数据库审计系统)"},{value:"LProxyCtrl(领祺代理工具控制端)"},{value:"lqx-daemon(文件传输软件)"},{value:"HKW-OSAS200(安全运维管理系统)"},{value:"HKW-INS8000(网络安全监测装置)"}],pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5},shortcuts:[{text:"一个月有效期",onClick:function(e){var t=new Date;t.setTime(t.getTime()+2592e6),e.$emit("pick",t)}},{text:"一年有效期",onClick:function(e){var t=new Date;t.setTime(t.getTime()+31536e6),e.$emit("pick",t)}},{text:"三年有效期",onClick:function(e){var t=new Date;t.setTime(t.getTime()+94608e6),e.$emit("pick",t)}}]}}},methods:{init:function(){this.dataForm.sn=this.sn,this.dataForm.softName=this.protocol,this.dataForm.proname=this.proname,this.dataForm.expiretime=this.expiretime,"pass"===this.type?this.dataForm.desc=this.$store.state.user.name+"操作通过":this.dataForm.desc=this.$store.state.user.name+"操作拒绝",this.visible=!0},querySearchAsync:function(e,t){var a=this,o=a.softNameOptions,r=e?o.filter(a.createStateFilter(e)):o;t(r)},createStateFilter:function(e){return function(t){return-1!=t.value.toLocaleLowerCase().indexOf(e.toLocaleLowerCase())}},handleSelect:function(e){this.dataForm.softName=e.value},handleClose:c()((function(){this.visible=!1}),1e3,{leading:!0,trailing:!1}),dataFormSubmitHandle:c()((function(){var e=this,t="/AuthorizeApplication/updateStatus.do",a={id:this.id,status:"pass"===e.type?1:2,ovDate:e.dataForm.expiretime,notes:e.dataForm.desc};e.$hasPermission("AuthorizeApplication:updateStatus:permission.do")?e.$refs["dataForm"].validate((function(o){if(!o)return!1;if(10==e.soft&&"pass"===e.type&&e.dataForm.expiretime.startsWith("2099")){var r=e.dataForm.expiretime.split(" "),i=Object(n["a"])(r,2),l=i[0],c=i[1],m=l.split("-"),p=Object(n["a"])(m,3),d=p[0],u=p[1],h=p[2],f=c.split(":"),g=Object(n["a"])(f,3),y=g[0],v=g[1],b=g[2],F="".concat(d,"年").concat(u,"月").concat(h,"日").concat(y,"时").concat(v,"分").concat(b,"秒");e.$confirm("当前过期时间为[".concat(F,"]，是否继续？"),e.$t("deleteInfo.noticePrompt"),{confirmButtonText:e.$t("confirm"),cancelButtonText:e.$t("cancel"),type:"warning"}).then((function(){e.loading=!0,e.$http.put(t,s.a.stringify(a)).then((function(t){var a=t.data;if(0!=a.code)return e.loading=!1,e.$message.error(a.msg);e.loading=!1,e.$message.success(a.msg),e.visible=!1,e.$emit("refreshSnDataList",{sn:e.dataForm.sn})})).catch((function(e){return!1}))})).catch((function(e){}))}else e.loading=!0,e.$http.put(t,s.a.stringify(a)).then((function(t){var a=t.data;if(0!=a.code)return e.loading=!1,e.$message.error(a.msg);e.loading=!1,e.$message.success(a.msg),e.visible=!1,e.$emit("refreshSnDataList",{sn:e.dataForm.sn})})).catch((function(e){return!1}))})):e.$message.warning("暂无授权"+("pass"===e.type?"通过":"拒绝")+"权限, 请联系管理员")}),1e3,{leading:!0,trailing:!1})}},p=m,d=a("2877"),u=Object(d["a"])(p,o,r,!1,null,"6a7d10cb",null);t["default"]=u.exports},"5fc4":function(e,t,a){},a0e6:function(e,t,a){"use strict";a("5fc4")},e33a:function(e,t,a){"use strict";a.r(t);a("7f7f");var o=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"aui-card--fill",attrs:{shadow:"never"}},[t("el-form",{attrs:{model:e.applyForm,"label-width":"100px"},nativeOn:{submit:function(e){e.preventDefault()},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.querySearch.apply(null,arguments)}}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{xs:24,sm:24,md:24,lg:24,xl:24}},[t("el-form-item",{attrs:{label:"机器码"}},[t("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:8},placeholder:"请输入机器码"},on:{blur:e.handleMachineCodeChange},model:{value:e.applyForm.machineCode,callback:function(t){e.$set(e.applyForm,"machineCode",t)},expression:"applyForm.machineCode"}})],1),t("el-form-item",{attrs:{label:10==e.applyForm.soft?"客户名称":"项目名称"}},[t("el-input",{attrs:{size:"small",placeholder:10==e.applyForm.soft?"请输入客户名称":"请输入项目名称",clearable:""},model:{value:e.applyForm.prjName,callback:function(t){e.$set(e.applyForm,"prjName",t)},expression:"applyForm.prjName"}})],1),t("el-form-item",{attrs:{label:"授权软件"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",size:"small",clearable:"",placeholder:"请选择授权软件"},on:{change:e.handleSoftChange},model:{value:e.applyForm.soft,callback:function(t){e.$set(e.applyForm,"soft",t)},expression:"applyForm.soft"}},e._l(e.softNameOptions,(function(a){return t("el-option",{key:a.value,attrs:{label:a.name,value:a.value,disabled:e.applyForm.machineCode.length<500?a.value<5:a.value>4}})})),1)],1),e.applyForm.machineCode.length>500?t("el-form-item",{attrs:{label:"驱动授权"}},[t("el-input",{attrs:{disabled:"",size:"small",placeholder:"请选择驱动授权",clearable:""},model:{value:e.applyForm.protocolNames,callback:function(t){e.$set(e.applyForm,"protocolNames",t)},expression:"applyForm.protocolNames"}}),t("div",{staticStyle:{"margin-top":"10px"}},[t("el-checkbox-group",{attrs:{size:"small"},on:{change:e.handleProtocolsCheckChange},model:{value:e.applyForm.protocols,callback:function(t){e.$set(e.applyForm,"protocols",t)},expression:"applyForm.protocols"}},e._l(e.protocolInfoList,(function(a,o){return t("el-checkbox",{key:o,attrs:{label:a.id,border:""}},[e._v("\n                                "+e._s(a.pname)+"\n                            ")])})),1)],1)],1):e._e(),t("el-form-item",{attrs:{prop:"expiretime",label:"过期时间"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{clearable:!1,size:"small",type:"datetime",placeholder:"请选择过期时间",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","picker-options":e.ovDatePickerOptions},model:{value:e.applyForm.ovdate,callback:function(t){e.$set(e.applyForm,"ovdate",t)},expression:"applyForm.ovdate"}})],1),e.$hasPermission("AuthorizeApplication:machineCodePars:permission.do")?t("el-form-item",{staticStyle:{"text-align":"right"},attrs:{"wrapper-col":{span:24}}},[t("el-button",{attrs:{size:"small",icon:"el-icon-search"},on:{click:e.handleApplyOrQueryChange}},[e._v(e._s("申请 / "+e.$t("query"))+" ")])],1):e._e()],1)],1)],1),t("div",[t("el-form",{attrs:{inline:!0,model:e.dataForm,"label-width":"100px"},nativeOn:{submit:function(e){e.preventDefault()},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.querySearch.apply(null,arguments)}}},[t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{xs:24,sm:24,md:24,lg:24,xl:24}},[t("el-form-item",{attrs:{label:"产品编号"}},[t("el-input",{attrs:{size:"small",placeholder:"请输入产品编号",clearable:""},on:{clear:e.querySearch},model:{value:e.dataForm.gwsn,callback:function(t){e.$set(e.dataForm,"gwsn",t)},expression:"dataForm.gwsn"}})],1),t("el-form-item",{attrs:{label:"产品型号"}},[t("el-input",{attrs:{size:"small",placeholder:"请输入产品型号",clearable:""},on:{clear:e.querySearch},model:{value:e.dataForm.model,callback:function(t){e.$set(e.dataForm,"model",t)},expression:"dataForm.model"}})],1),t("el-form-item",{attrs:{label:"授权时间"}},[t("el-date-picker",{staticStyle:{width:"380px"},attrs:{size:"small",type:"datetimerange","picker-options":e.pickerOptions,"range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss"},on:{change:e.querySearch},model:{value:e.dataForm.authTime,callback:function(t){e.$set(e.dataForm,"authTime",t)},expression:"dataForm.authTime"}})],1),t("el-form-item",{attrs:{label:"申请时间"}},[t("el-date-picker",{staticStyle:{width:"380px"},attrs:{size:"small",type:"datetimerange","picker-options":e.pickerOptions,"range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss"},on:{change:e.querySearch},model:{value:e.dataForm.applyTime,callback:function(t){e.$set(e.dataForm,"applyTime",t)},expression:"dataForm.applyTime"}})],1),t("el-form-item",{attrs:{label:"项目名称"}},[t("el-input",{attrs:{size:"small",placeholder:"请输入项目名称",clearable:""},on:{clear:e.querySearch},model:{value:e.dataForm.prjName,callback:function(t){e.$set(e.dataForm,"prjName",t)},expression:"dataForm.prjName"}})],1),t("el-form-item",{attrs:{label:"客户名称"}},[t("el-select",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.handleUsernameScroll,expression:"handleUsernameScroll"}],attrs:{clearable:"",size:"small",placeholder:e.$t("attribute.placeholderSelect")},on:{"visible-change":e.handleUsernameVisibleChange,change:e.querySearch,clear:e.handleUsernameClearChange},model:{value:e.dataForm.userName,callback:function(t){e.$set(e.dataForm,"userName",t)},expression:"dataForm.userName"}},[[t("div",{staticStyle:{width:"100%",position:"absolute",left:"0",top:"0","z-index":"99","background-color":"#fff"}},[t("el-input",{ref:"usernameInput",staticStyle:{width:"98%","margin-left":"1%","margin-top":"5px","margin-bottom":"5px"},attrs:{size:"small",clearable:"",placeholder:e.$t("gwsn.pleaseEnterSearchContent")},model:{value:e.usernameSearch,callback:function(t){e.usernameSearch=t},expression:"usernameSearch"}})],1),t("div",{staticStyle:{width:"100%",height:"42px"}}),e._l(e.usernameList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.uname,value:e.id,disabled:!!e.hasOwnProperty("disabled")&&e.disabled}})}))]],2)],1),t("el-form-item",{attrs:{label:"当前状态"}},[t("el-select",{staticStyle:{width:"200px"},attrs:{size:"small",clearable:"",placeholder:e.$t("attribute.placeholderSelect")},on:{change:e.querySearch},model:{value:e.dataForm.status,callback:function(t){e.$set(e.dataForm,"status",t)},expression:"dataForm.status"}},e._l(e.statusList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e.$hasPermission("AuthorizeApplication:selectPage:permission.do")?t("el-form-item",[t("el-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"small",icon:"el-icon-search"},on:{click:e.querySearch}},[e._v(e._s(e.$t("query"))+" ")])],1):e._e()],1)],1)],1),t("vxe-table",{ref:"recordTable",staticStyle:{width:"100%"},attrs:{size:"medium",border:"",resizable:"","auto-resize":"","sync-resize":"","show-overflow":"","show-header-overflow":"","highlight-hover-row":"","highlight-current-row":"",data:e.dataList,"max-height":e.scrollTableHeight,loading:e.dataListLoading,"row-config":{keyField:"id"}}},[t("vxe-table-column",{key:"1",attrs:{field:"sn",title:"产品编号","header-align":"center",align:"center",width:"170",fixed:"left","show-overflow-tooltip":!0}}),t("vxe-table-column",{key:"2",attrs:{field:"model",title:"产品型号","header-align":"center",align:"center",width:"160"}}),t("vxe-table-column",{key:"3",attrs:{field:"adbtime",title:"授权时间","header-align":"center",align:"center",width:"160"}}),t("vxe-table-column",{key:"4",attrs:{field:"softName",title:"授权软件","header-align":"center",align:"center",width:"180","show-overflow-tooltip":!0}}),t("vxe-table-column",{key:"5",attrs:{field:"proList",title:"授权驱动","header-align":"center",align:"center",width:"260","show-overflow-tooltip":!0}}),t("vxe-table-column",{key:"6",attrs:{field:"status",title:"当前状态","header-align":"center",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{size:"small",type:0==a.row.status?"info":1==a.row.status?"success":"danger"}},[e._v("\n                        "+e._s(0==a.row.status?"申请中":1==a.row.status?"已通过":"已拒绝")+"\n                    ")])]}}])}),t("vxe-table-column",{key:"7",attrs:{field:"aplusername",title:"申请人","header-align":"center",align:"center",width:"160","show-overflow-tooltip":!0}}),t("vxe-table-column",{key:"8",attrs:{field:"apltime",title:"申请时间","header-align":"center",align:"center",width:"160"}}),t("vxe-table-column",{key:"9",attrs:{field:"ovdate",title:"过期时间","header-align":"center",align:"center",width:"160"}}),t("vxe-table-column",{key:"10",attrs:{field:"proname",title:"项目名称","header-align":"center",align:"center",width:"160","show-overflow-tooltip":!0}}),t("vxe-table-column",{key:"11",attrs:{field:"uname",title:"客户名称","header-align":"center",align:"center",width:"160","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticStyle:{cursor:"pointer"},on:{click:function(t){return e.handleJumpPageChange(a.row)}}},[e._v("\n                        "+e._s(a.row.uname)+"\n                    ")])]}}])}),t("vxe-table-column",{key:"12",attrs:{field:"oprusername",title:"操作人","header-align":"center",align:"center","min-width":"180","show-overflow-tooltip":!0}}),t("vxe-table-column",{key:"13",attrs:{field:"notes",title:"备注","header-align":"center",align:"center","min-width":"180","show-overflow-tooltip":!0}}),e.$hasPermission("AuthorizeApplication:reapply:permission.do")||e.$hasPermission("AuthorizeApplication:updateStatus:permission.do")||e.$hasPermission("AuthorizeApplication:download:permission.do")?t("vxe-table-column",{key:"14",attrs:{title:e.$t("handle"),"header-align":"center",align:"center",width:"260",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[1!=a.row.status&&e.$hasPermission("AuthorizeApplication:reapply:permission.do")?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleReApplyChange(a.row)}}},[e._v(e._s("重新申请"))]):e._e(),e.$hasPermission("AuthorizeApplication:updateStatus:permission.do")?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handlePassOrRejectChange(a.row,1)}}},[e._v(e._s("通过"))]):e._e(),e.optionFlag&&0==a.row.status&&e.$hasPermission("AuthorizeApplication:updateStatus:permission.do")?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handlePassOrRejectChange(a.row,0)}}},[e._v(e._s("拒绝"))]):e._e(),1==a.row.status&&e.$hasPermission("AuthorizeApplication:download:permission.do")?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleDownloadChange(a.row)}}},[e._v(e._s("下载"))]):e._e()]}}],null,!1,4159615775)}):e._e()],1),t("el-pagination",{attrs:{"current-page":e.page,"page-sizes":[20,50,100,200],"page-size":e.limit,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"size-change":e.pageSizeChangeHandle,"current-change":e.pageCurrentChangeHandle}})],1),e.licenseReplyVisible?t("LicenseupgradeReply",{ref:"licenseReplyRef",attrs:{id:e.licenseReplyForm.id,sn:e.licenseReplyForm.gwsn,protocol:e.licenseReplyForm.protocol,proname:e.licenseReplyForm.proname,soft:e.licenseReplyForm.soft,pids:e.licenseReplyForm.pids,expiretime:e.licenseReplyForm.ovdate},on:{refreshDataList:e.getDataList}}):e._e(),e.licenseVisible?t("licenseupgradeConfig",{ref:"licenseRef",attrs:{id:e.passOrRejectForm.id,sn:e.passOrRejectForm.gwsn,soft:e.passOrRejectForm.soft,protocol:e.passOrRejectForm.protocol,proname:e.passOrRejectForm.proname,type:e.passOrRejectForm.type,expiretime:e.passOrRejectForm.ovdate},on:{refreshSnDataList:e.refreshDataListBysn}}):e._e(),t("el-dialog",{attrs:{visible:e.authCodeSecretVisible,title:"查看授权码","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.authCodeSecretVisible=t},close:function(t){e.authCodeSecretVisible=!1}}},[t("el-form",{attrs:{model:e.dataForm,"label-position":"left","label-width":"100px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dataFormSubmitHandle()}}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{prop:"sn",label:"网关编号"}},[t("el-input",{attrs:{readonly:"",size:"small",placeholder:"请输入网关编号"},model:{value:e.dataForm.gwsn,callback:function(t){e.$set(e.dataForm,"gwsn",t)},expression:"dataForm.gwsn"}})],1),t("el-form-item",{staticStyle:{"margin-top":"20px"},attrs:{prop:"desc",label:"授权码密文"}},[t("el-input",{attrs:{readonly:"",size:"small",type:"textarea",autosize:{minRows:4,maxRows:8},placeholder:"请输入授权码密文"},model:{value:e.dataForm.authCodeSecret,callback:function(t){e.$set(e.dataForm,"authCodeSecret",t)},expression:"dataForm.authCodeSecret"}})],1)],1)],1)],1)],1),t("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{visible:e.downloadHkwagentVisible,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.downloadHkwagentVisible=t},close:function(t){e.downloadHkwagentVisible=!1}}},[t("div",{staticStyle:{display:"flex","justify-content":"space-around","align-items":"center"}},[t("div",{staticStyle:{width:"100%","font-weight":"bolder","margin-right":"40px"}},[e._v(e._s(e.downloadHkwagentContent))]),t("el-button",{staticClass:"downloadHkwagentContentCopy",attrs:{type:"primary"},on:{click:e.handleCopyDownloadHkwagentContentChange}},[e._v("复制")])],1)])],1)},r=[],n=(a("96cf"),a("1da1")),i=(a("f559"),a("28a5"),a("6762"),a("2fdb"),a("f576"),a("ac6a"),a("c5f6"),a("a481"),a("4328")),s=a.n(i),l=a("b311"),c=a.n(l),m=a("b047"),p=a.n(m),d=a("2dad"),u=a("eb13"),h={directives:{loadmore:{inserted:function(e,t){var a=e.querySelector(".el-select-dropdown .el-select-dropdown__wrap");a.addEventListener("scroll",(function(){var e=this.scrollHeight-Math.ceil(this.scrollTop)<=this.clientHeight;e&&0!==this.scrollTop&&t.value()}))}}},data:function(){return{page:1,limit:50,total:0,applyForm:{machineCode:"",prjName:"",soft:0,ovdate:"2099-12-31 23:59:59",protocols:[],protocolNames:""},softNameMap:{0:"PBOX",1:"LOGGER",2:"ASDU",3:"ASDU-LE",4:"ASDU-LX",5:"hkw-agent(探针)",6:"HKW-NF500(防火墙)",7:"HKW-IDS2000(入侵检测)",8:"HKW-LAS1000(日志审计系统)",9:"HKW-DAS1000(数据库审计系统)",10:"LProxyCtrl(领祺代理工具控制端)",11:"lqx-daemon(文件传输软件)",12:"HKW-OSAS200(安全运维管理系统)",13:"HKW-INS8000(网络安全监测装置)"},softNameOptions:[{name:"PBOX",value:0},{name:"LOGGER",value:1},{name:"ASDU",value:2},{name:"ASDU-LE",value:3},{name:"ASDU-LX",value:4},{name:"hkw-agent(探针)",value:5},{name:"HKW-NF500(防火墙)",value:6},{name:"HKW-IDS2000(入侵检测)",value:7},{name:"HKW-LAS1000(日志审计系统)",value:8},{name:"HKW-DAS1000(数据库审计系统)",value:9},{name:"LProxyCtrl(领祺代理工具控制端)",value:10},{name:"lqx-daemon(文件传输软件)",value:11},{name:"HKW-OSAS200(安全运维管理系统)",value:12},{name:"HKW-INS8000(网络安全监测装置)",value:13}],dataListLoading:!1,protocolInfoMap:{},protocolInfoList:[],dataList:[],scrollTableHeight:window.innerHeight-220-53,licenseVisible:!0,dataForm:{gwsn:"",model:"",authTime:"",applyTime:"",prjName:"",userName:"",status:0,optionFlag:!1,authCodeSecret:""},passOrRejectForm:{id:null,gwsn:"",proname:"",soft:0,protocol:"",type:"pass",ovdate:""},statusList:[{label:"申请中",value:0},{label:"已通过",value:1},{label:"已拒绝",value:2}],licenseReplyVisible:!1,licenseReplyForm:{id:null,gwsn:"",protocol:"",proname:"",soft:null,pids:"",ovdate:""},pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},ovDatePickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5},shortcuts:[{text:"一个月有效期",onClick:function(e){var t=new Date;t.setTime(t.getTime()+2592e6),e.$emit("pick",t)}},{text:"一年有效期",onClick:function(e){var t=new Date;t.setTime(t.getTime()+31536e6),e.$emit("pick",t)}},{text:"三年有效期",onClick:function(e){var t=new Date;t.setTime(t.getTime()+94608e6),e.$emit("pick",t)}}]},usernameInfo:{page:1,total:0},usernameSearch:"",usernameList:[],authCodeSecretVisible:!1,downloadHkwagentVisible:!1,downloadHkwagentContent:""}},components:{LicenseupgradeReply:u["default"],licenseupgradeConfig:d["default"]},methods:{getUserNameList:function(){var e=this,t={pageNum:e.usernameInfo.page,pageSize:50,fuzzy:e.usernameSearch.replace(/\s+/g,""),_t:(new Date).getTime()};e.$hasPermission("userCus:select:permission.do")?e.$http.get("/userCus/getPage.do",{params:t}).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);1==e.usernameInfo.page?e.usernameList=a.data.list:e.usernameList=e.usernameList.concat(a.data.list),e.usernameInfo.total=Number(a.data.total),0==e.usernameList.length&&e.usernameList.push({id:e.$t("noMatchingDataYet"),uname:e.$t("noMatchingDataYet"),disabled:!0})})).catch((function(e){return!1})):e.$message.warning("暂无客户查询权限, 请联系管理员")},handleUsernameClearChange:function(){this.dataForm.userName="",this.querySearch()},handleUsernameVisibleChange:function(e){var t=this;e&&this.$nextTick((function(){t.$refs.usernameInput.focus()}))},handleUsernameScroll:function(){this.usernameList.length<this.usernameInfo.total&&(this.usernameInfo.page++,this.getUserNameList())},watchUsernameSearch:p()((function(){var e=document.getElementsByClassName("el-scrollbar__wrap").length;document.getElementsByClassName("el-scrollbar__wrap")[e-1].scrollTo(0,0),this.usernameInfo.page=1,this.getUserNameList(),this.$refs.usernameInput.focus()}),500),getDefaultProtocolInfoList:function(){var e=this;e.protocolInfoList=[],e.protocolInfoMap={},e.$hasPermission("AuthorizeApplication:selectProtocol:select:permission.do")?e.$http.get("/AuthorizeApplication/selectProtocol.do").then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);a.data.forEach((function(t){e.protocolInfoMap[t.id]=t.pname})),e.protocolInfoList=a.data})):e.$message.warning("暂无协议查询权限, 请联系管理员")},handleMachineCodeChange:function(){this.applyForm.machineCode.length>0?this.applyForm.machineCode.length<500?this.applyForm.soft<5&&(this.applyForm.soft=5):this.applyForm.soft>4&&(this.applyForm.soft=0):this.applyForm.soft=0},handleSoftChange:function(){if(10==this.applyForm.soft){var e=new Date;e.setDate(e.getDate()+30),e.setHours(23,59,59,999);var t="".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0")," 23:59:59");this.applyForm.ovdate=t}else this.applyForm.ovdate="2099-12-31 23:59:59"},getCurrentUserAuthorityInfo:function(){var e=this;e.$http.get("/AuthorizeApplication/selectAuth.do").then((function(t){var a=t.data;e.optionFlag=0==a.code}))},handleProtocolsCheckChange:function(e){var t=this.protocolInfoList.filter((function(t){return e.includes(t.id)})).map((function(e){return e.pname})).join(", ");this.applyForm.protocolNames=t},handleApplyOrQueryChange:function(){var e=this,t={code:e.applyForm.machineCode,proname:e.applyForm.prjName,pids:"",soft:e.applyForm.soft,ovDate:e.applyForm.ovdate};if(!e.applyForm.machineCode)return e.$message.warning("请输入机器码"),!1;if(!e.applyForm.prjName)return e.$message.warning("请输入项目名称"),!1;if(e.applyForm.machineCode.length<500)t["pids"]=0;else{if(!(e.applyForm.protocols&&e.applyForm.protocols.length>0))return e.$message.warning("请选择驱动授权"),!1;t["pids"]=e.applyForm.protocols.join(",")}if(null==e.applyForm.soft||void 0==e.applyForm.soft)return e.$message.warning("请选择授权软件"),!1;e.$hasPermission("AuthorizeApplication:machineCodePars:permission.do")?e.$http.post("/AuthorizeApplication/machineCodePars.do",s.a.stringify(t)).then((function(t){var a=t.data;if(0!=a.code){if(!a.data||!a.data.includes("当前状态为申请中,请勿重复提交"))return e.$message.error(a.data||a.msg);e.dataForm.model=a.data.split(" ")[0],e.$message.info(a.data.split(" ")[1]),e.querySearch()}else e.dataForm.model=a.data,e.querySearch()})).catch((function(e){return!1})):e.$message.warning("暂无申请/查询权限, 请联系管理员")},pageSizeChangeHandle:function(e){this.page=1,this.limit=e,this.getDataList()},pageCurrentChangeHandle:function(e){this.page=e,this.getDataList()},querySearch:function(){var e=this;this.page=1,this.$nextTick((function(){e.getDataList()}))},refreshDataListBysn:function(e){this.dataForm.gwsn=e.sn,this.dataForm.status=null,this.querySearch()},getDataList:p()((function(){var e=this,t={page:e.page,limit:e.limit};e.dataForm.gwsn&&(t["sn"]=e.dataForm.gwsn.replace(/_/g,"\\_").replace(/%/g,"\\%")),e.dataForm.model&&(t["model"]=e.dataForm.model.replace(/_/g,"\\_").replace(/%/g,"\\%")),e.dataForm.authTime&&(t["auStartTime"]=e.dataForm.authTime[0],t["auEndtime"]=e.dataForm.authTime[1]),e.dataForm.applyTime&&(t["apStartTime"]=e.dataForm.applyTime[0],t["apEndTime"]=e.dataForm.applyTime[0]),e.dataForm.prjName&&(t["proname"]=e.dataForm.prjName.replace(/_/g,"\\_").replace(/%/g,"\\%")),e.dataForm.userName&&(t["cusid"]=e.dataForm.userName),""!==e.dataForm.status&&null!==e.dataForm.status&&void 0!==e.dataForm.status&&(t["status"]=e.dataForm.status),e.dataList=[],e.$hasPermission("AuthorizeApplication:selectPage:permission.do")?(e.dataListLoading=!0,e.$http.get("/AuthorizeApplication/selectPage.do",{params:t}).then((function(t){var a=t.data;if(0!=a.code)return e.dataList=[],e.dataListLoading=!1,e.$message.error(a.data||a.msg);a.data.list.length>0?(a.data.list.forEach((function(t){t.softName=e.softNameMap[t.soft],e.dataList.push(t)})),e.total=Number(a.data.total),e.$refs.recordTable.loadData(e.dataList),e.dataListLoading=!1):(e.dataList=[],e.dataListLoading=!1)})).catch((function(t){return e.dataListLoading=!1,!1}))):e.$message.warning("暂无授权查询权限, 请联系管理员")}),100,{leading:!0,trailing:!1}),getRowKey:function(e){return e.id},handleJumpPageChange:function(e){this.$router.push("/custommanage-customerproduct-customerproduct?uname="+e.uname+"&uid="+e.cusid+"&sn="+e.sn)},handleReApplyChange:function(e){var t=this;t.$hasPermission("AuthorizeApplication:reapply:permission.do")?(t.licenseReplyForm.id=e.id,t.licenseReplyForm.gwsn=e.sn,t.licenseReplyForm.protocol=e.pids,t.licenseReplyForm.proname=e.proname,t.licenseReplyForm.soft=e.soft,t.licenseReplyForm.pids=e.pids,t.licenseReplyForm.ovdate=e.ovdate,t.licenseReplyVisible=!0,t.$nextTick((function(){t.$refs.licenseReplyRef.init()}))):t.$message.warning("暂无重新申请权限, 请联系管理员")},handlePassOrRejectChange:function(e,t){var a=this;a.$hasPermission("AuthorizeApplication:updateStatus:permission.do")?(a.passOrRejectForm.id=e.id,a.passOrRejectForm.gwsn=e.sn,a.passOrRejectForm.soft=e.soft,a.passOrRejectForm.proname=e.proname,a.passOrRejectForm.protocol=e.proList,a.passOrRejectForm.type=1===t?"pass":"reject",a.passOrRejectForm.ovdate=e.ovdate,a.licenseVisible=!0,a.$nextTick((function(){a.$refs.licenseRef.init()}))):a.$message.warning("暂无授权"+(1===t?"通过":"拒绝")+"权限, 请联系管理员")},handleDownloadChange:function(e){var t=this;this.$hasPermission("AuthorizeApplication:download:permission.do")?this.$http.get("/AuthorizeApplication/download.do",{params:{id:e.id}}).then((function(a){var o=a.data;if(0!=o.code)return t.dataListLoading=!1,t.$message.error(t.$t("deleteInfo.downloadFail"));o.data.startsWith("http")?(t.$message.success("下载成功"),t.handleDownloadAuthFileChange(o.data,"ioserver_bin_"+e.sn+"_auth.tar.gz")):(t.downloadHkwagentContent=o.data,t.downloadHkwagentVisible=!0)})).catch((function(e){})):this.$message.warning("暂无授权下载权限, 请联系管理员")},handleCopyDownloadHkwagentContentChange:function(){var e=this,t=this.downloadHkwagentContent,a=new c.a(".downloadHkwagentContentCopy",{text:function(){return t}});a.on("success",(function(t){e.$message({message:e.$t("upgrade.copySuccess"),showClose:!0,type:"success"}),a.destroy()})),a.on("error",(function(t){e.$message({message:e.$t("upgrade.copyFail"),showClose:!0,type:"error"}),a.destroy()}))},handleDownloadAuthFileChange:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t,a){var o,r,n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=1,fetch(t);case 1:return o=e.sent,e.next=2,o.blob();case 2:r=e.sent,n=window.URL.createObjectURL(r),i=document.createElement("a"),i.href=n,i.download=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(n);case 3:case"end":return e.stop()}}),e)})));function t(t,a){return e.apply(this,arguments)}return t}(),handleViewChange:function(e){var t=this;this.$http.get("",{params:{id:e.id}}).then((function(e){var a=e.data;if(0!=a.code)return t.$message.error(t.$t("deleteInfo.downloadFail"));t.dataForm.authCodeSecret=a.data,t.authCodeSecretVisible=!0})).catch((function(e){return!1}))}},mounted:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=1,this.getDefaultProtocolInfoList();case 1:return e.next=2,this.getCurrentUserAuthorityInfo();case 2:return e.next=3,this.getUserNameList();case 3:return e.next=4,this.getDataList();case 4:window.onresize=function(){return function(){t.scrollTableHeight=window.innerHeight-220-53}()};case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),watch:{total:function(){this.total==(this.page-1)*this.limit&&0!=this.total&&(this.page-=1,sessionStorage.setItem("page9",this.page),this.getDataList())},usernameSearch:function(e,t){this.watchUsernameSearch()}}},f=h,g=(a("a0e6"),a("2877")),y=Object(g["a"])(f,o,r,!1,null,"a2409752",null);t["default"]=y.exports},eb13:function(e,t,a){"use strict";a.r(t);a("7f7f");var o=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.visible,title:"重新申请","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.visible=t},close:e.handleClose}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"licenseReplyRef",attrs:{model:e.dataForm,rules:e.rules,"label-position":"left","label-width":"100px"},nativeOn:{submit:function(e){e.preventDefault()},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleReplyApplyChange.apply(null,arguments)}}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{xs:24,sm:24,md:24,lg:24,xl:24}},[t("el-form-item",{attrs:{prop:"sns",label:"产品编号"}},[t("el-input",{attrs:{disabled:"",size:"small",placeholder:"请输入产品编号"},model:{value:e.dataForm.sn,callback:function(t){e.$set(e.dataForm,"sn",t)},expression:"dataForm.sn"}})],1),t("el-form-item",{staticStyle:{"margin-top":"20px"},attrs:{label:10==e.dataForm.soft?"客户名称":"项目名称",prop:"proname"}},[t("el-input",{attrs:{size:"small",placeholder:10==e.dataForm.soft?"请输入客户名称":"请输入项目名称",clearable:""},model:{value:e.dataForm.proname,callback:function(t){e.$set(e.dataForm,"proname",t)},expression:"dataForm.proname"}})],1),t("el-form-item",{staticStyle:{"margin-top":"20px"},attrs:{label:"授权软件",prop:"soft"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",size:"small",clearable:"",placeholder:"请选择授权软件"},model:{value:e.dataForm.soft,callback:function(t){e.$set(e.dataForm,"soft",t)},expression:"dataForm.soft"}},e._l(e.softNameOptions,(function(a){return t("el-option",{key:a.value,attrs:{label:a.name,value:a.value,disabled:0==e.pids?a.value<5:a.value>4}})})),1)],1),0!=e.pids?t("el-form-item",{staticStyle:{"margin-top":"20px"},attrs:{label:"驱动授权",prop:"protocols"}},[t("el-input",{attrs:{disabled:"",size:"small",placeholder:"请选择驱动授权",clearable:""},model:{value:e.dataForm.protocolNames,callback:function(t){e.$set(e.dataForm,"protocolNames",t)},expression:"dataForm.protocolNames"}}),t("div",{staticClass:"protocol-list-style",staticStyle:{"margin-top":"10px"}},[t("el-checkbox-group",{attrs:{size:"small"},on:{change:e.handleProtocolsCheckChange},model:{value:e.dataForm.protocols,callback:function(t){e.$set(e.dataForm,"protocols",t)},expression:"dataForm.protocols"}},e._l(e.protocolInfoList,(function(a,o){return t("el-checkbox",{key:o,attrs:{label:a.id,border:""}},[e._v("\n                                "+e._s(a.pname)+"\n                            ")])})),1)],1)],1):e._e(),t("el-form-item",{attrs:{prop:"expiretime",label:"过期时间"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{clearable:!1,size:"small",type:"datetime",placeholder:"请选择过期时间",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","picker-options":e.pickerOptions},model:{value:e.dataForm.expiretime,callback:function(t){e.$set(e.dataForm,"expiretime",t)},expression:"dataForm.expiretime"}})],1)],1)],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:e.handleClose}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleReplyApplyChange}},[e._v(e._s(e.$t("confirm")))])],1)],2)},r=[],n=(a("6762"),a("2fdb"),a("c5f6"),a("28a5"),a("4328")),i=a.n(n),s=a("b047"),l=a.n(s),c={props:["id","sn","protocol","proname","soft","pids","expiretime"],data:function(){return{loading:!1,visible:!1,dataForm:{id:null,sn:"",proname:"",protocols:[],protocolNames:"",soft:0,expiretime:"2099-12-31 23:59:59"},protocolInfoList:[],softNameOptions:[{name:"PBOX",value:0},{name:"LOGGER",value:1},{name:"ASDU",value:2},{name:"ASDU-LE",value:3},{name:"ASDU-LX",value:4},{name:"hkw-agent(探针)",value:5},{name:"HKW-NF500(防火墙)",value:6},{name:"HKW-IDS2000(入侵检测)",value:7},{name:"HKW-LAS1000(日志审计系统)",value:8},{name:"HKW-DAS1000(数据库审计系统)",value:9},{name:"LProxyCtrl(领祺代理工具控制端)",value:10},{name:"lqx-daemon(文件传输软件)",value:11},{name:"HKW-OSAS200(安全运维管理系统)",value:12},{name:"HKW-INS8000(网络安全监测装置)",value:13}],rules:{proname:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],soft:[{required:!0,message:this.$t("validate.required"),trigger:"change"}],protocols:[{required:!0,message:this.$t("validate.required"),trigger:"change"}]},pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5},shortcuts:[{text:"一个月有效期",onClick:function(e){var t=new Date;t.setTime(t.getTime()+2592e6),e.$emit("pick",t)}},{text:"一年有效期",onClick:function(e){var t=new Date;t.setTime(t.getTime()+31536e6),e.$emit("pick",t)}},{text:"三年有效期",onClick:function(e){var t=new Date;t.setTime(t.getTime()+94608e6),e.$emit("pick",t)}}]}}},methods:{init:function(){this.getDefaultProtocolInfoList()},getDefaultProtocolInfoList:function(){var e=this;e.protocolInfoList=[],e.$hasPermission("AuthorizeApplication:selectProtocol:select:permission.do")?(e.loading=!0,e.$http.get("/AuthorizeApplication/selectProtocol.do").then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);if(e.protocolInfoList=a.data,e.dataForm.id=e.id,e.dataForm.sn=e.sn,e.dataForm.proname=e.proname,e.dataForm.protocols=e.protocol?e.protocol.split(",").map(Number):[],e.dataForm.soft=e.soft,e.dataForm.expiretime=e.expiretime,e.dataForm.protocols.length>0){var o=e.protocolInfoList.filter((function(t){return e.dataForm.protocols.includes(t.id)})).map((function(e){return e.pname})).join(", ");e.dataForm.protocolNames=o}e.loading=!1,e.visible=!0}))):e.$message.warning("暂无协议查询权限, 请联系管理员")},handleProtocolsCheckChange:function(e){var t=this.protocolInfoList.filter((function(t){return e.includes(t.id)})).map((function(e){return e.pname})).join(", ");this.dataForm.protocolNames=t},handleClose:l()((function(){this.visible=!1}),1e3,{leading:!0,trailing:!1}),handleReplyApplyChange:function(){var e=this,t={id:e.id,proname:e.dataForm.proname,pids:e.dataForm.soft>4?"0":e.dataForm.protocols.join(","),soft:e.dataForm.soft,ovDate:e.dataForm.expiretime};e.$hasPermission("AuthorizeApplication:reapply:permission.do")?e.$refs["licenseReplyRef"].validate((function(a){if(!a)return!1;e.$http.put("/AuthorizeApplication/reapply.do",i.a.stringify(t)).then((function(t){var a=t.data;if(0!=a.code)return e.$message.error(a.data||a.msg);e.loading=!1,e.$message.success(a.msg),e.visible=!1,e.$emit("refreshDataList")})).catch((function(e){return!1}))})):e.$message.warning("暂无重新申请权限, 请联系管理员")}}},m=c,p=(a("10dc"),a("2877")),d=Object(p["a"])(m,o,r,!1,null,"2945f1f5",null);t["default"]=d.exports}}]);
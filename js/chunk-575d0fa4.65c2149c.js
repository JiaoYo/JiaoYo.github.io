(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-575d0fa4"],{"8ba2":function(e,t,n){"use strict";n("d793")},d793:function(e,t,n){},ec3b:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e._self._c;return t("section",[t("div",{staticClass:"total"},[t("div",{staticClass:"systemOverview"},[t("div",[t("div",[t("div",{staticClass:"systemOverviewLeft"},[e._v(e._s(e.$t("indexPage.connectedDeviceTotal")))]),t("div",{staticClass:"systemOverviewRight"},[e._v(e._s(e.deviceForm.baseCount))])]),t("div",{staticClass:"systemOverviewMargin"},[t("div",{staticClass:"systemOverviewLeft"},[e._v(e._s(e.$t("indexPage.deviceInOffLine")))]),t("div",{staticClass:"systemOverviewRight"},[t("span",{staticClass:"systemOverviewOnline"},[e._v(e._s(e.deviceForm.onlineCount))]),e._v(" / "),t("span",{staticClass:"systemOverviewOffline"},[e._v(e._s(e.deviceForm.offlineCount))])])])]),t("div",[t("div",[t("div",{staticClass:"systemOverviewLeft"},[e._v(e._s(e.$t("indexPage.projectTotal")))]),t("div",{staticClass:"systemOverviewRight"},[e._v(e._s(e.deviceForm.priinfo))])]),t("div",{staticClass:"systemOverviewMargin"},[t("div",{staticClass:"systemOverviewLeft"},[e._v(e._s(e.$t("indexPage.deviceInLineRate")))]),t("div",{staticClass:"systemOverviewRight"},[t("span",{staticClass:"systemOverviewOnline"},[e._v(e._s(e.deviceForm.onlineRate))]),e._v(" %\n                    ")])])])])]),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%",height:"660px","margin-top":"20px"},attrs:{id:"container"}})])},a=[],s=(n("7f7f"),n("96cf"),n("1da1")),o=n("bc3a"),r=n.n(o),l={name:"home",data:function(){return{timer:null,cluster:null,loading:!1,deviceForm:{baseCount:0,onlineCount:0,offlineCount:0,priinfo:0,onlineRate:0},mapStyle:"amap://styles/normal",markerList:[]}},methods:{getCurrentTime:function(){var e=new Date,t=e.getHours();this.mapStyle=t>=19||t<=6?"amap://styles/darkblue":"amap://styles/normal"},init:function(){var e=this,t=[],n={};e.loading=!0,r.a.get("/mapconfig.json?_t="+(new Date).getTime()).then(function(){var i=Object(s["a"])(regeneratorRuntime.mark((function i(a){var s;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:s=a.data,s&&s.gaodeKey&&(window._AMapSecurityConfig={securityJsCode:s.securityJsCode},AMapLoader.load({key:s.gaodeKey,version:"2.0",plugins:["AMap.ToolBar","AMap.MapType","AMap.Scale","AMap.Geolocation","AMap.MarkerCluster"]}).then((function(i){var a=e.mapStyle,s=new i.Map("container",{resizeEnable:!0,zoom:3,mapStyle:a});e.$http.get("/list/getProList.do",{params:n}).then((function(n){var a,o=n.data;if(0!=o.code)return e.loading=!1,e.$message.error(o.data||o.msg);for(var r=0;r<o.data.length;r++){var l=o.data[r];if(l.latitude&&l.longitude){var c={lnglat:[l.longitude,l.latitude],name:l.prjName,style:0,prjNameI18n:e.$t("indexPage.projectName")};t.push(c)}}if(s.clearMap(),s.addControl(new i.ToolBar),s.addControl(new i.MapType),s.addControl(new i.Scale),e.loading=!1,t.length>0){var d=[{url:"https://a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-default.png",anchor:new i.Pixel(6,6),size:new i.Size(25,34),zIndex:3}],u=new i.MassMarks(t,{opacity:.8,zIndex:111,cursor:"pointer",style:d});u.setMap(s),u.on("mouseover",(function(e){a.setContent("<ul style='list-style-type: none; padding: 10px; background: #000000; border: 1px solid #ccc; border-radius: 5px; font-size: 14px;'><li style='color: #ffffff;'>"+e.data.prjNameI18n+"<span>"+e.data.name+"</span></li></ul>"),a.open(s,e.data.lnglat)})),u.on("mouseout",(function(e){s.clearInfoWindow()})),u.on("click",(function(t){s.clearInfoWindow(),e.$router.push({path:"/tprj-tprjinfo",query:{prjName:t.data.name}})})),a=new i.InfoWindow({isCustom:!0,draggable:!0,offset:new i.Pixel(0,0),content:""})}})).catch((function(e){return!1}))})).catch((function(e){})));case 1:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}())},getOnlineStatus:function(){var e=this,t={};e.$http.get("/info/ding/count/gwbaseInfoCount",{params:t}).then((function(t){var n=t.data;if(0!=n.code)return e.$message.error(n.msg);e.deviceForm.baseCount=n.data.baseCount,e.deviceForm.onlineCount=n.data.onlineCount,e.deviceForm.offlineCount=n.data.offlineCount,e.deviceForm.priinfo=n.data.priinfo,0===e.deviceForm.baseCount?e.deviceForm.onlineRate=0:e.deviceForm.onlineRate=Math.ceil(e.deviceForm.onlineCount/e.deviceForm.baseCount*1e4/100)})).catch((function(e){return!1}))},getOnlineCount:function(){var e=this;this.timer=setInterval((function(){e.getOnlineStatus()}),1e4)}},mounted:function(){window.onbeforeunload=function(e){this.timer&&(clearInterval(this.timer),this.timer=null)}},beforeDestroy:function(){this.timer&&(clearInterval(this.timer),this.timer=null)},activated:function(){this.getOnlineStatus(),this.getOnlineCount(),this.getCurrentTime(),this.init()},deactivated:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}},c=l,d=(n("8ba2"),n("2877")),u=Object(d["a"])(c,i,a,!1,null,"867b37a8",null);t["default"]=u.exports}}]);
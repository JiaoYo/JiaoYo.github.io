import{_ as G}from"./table-column-setting.vue_vue_type_script_setup_true_lang-viHAmCxt.js";import{_ as K}from"./export-B398XHpy.js";import{_ as O}from"./round-search-B-4rQdSi.js";import{d as R,a8 as q,cz as A,ba as _,a9 as L,i as v,s as M,o as W,b as j,f as t,w as o,h as a,B as x,aa as J,g as b,t as k,$ as D,e as H,ab as T,cA as X,a4 as Q,F as Y,X as Z,E as ee,I as te}from"./index-DLNUCcPL.js";import{e as ae}from"./exportExcel-Bv4G4H50.js";import{_ as ne}from"./DatePicker-lNHPIgCH.js";import{_ as oe}from"./FormItemGridItem-lpVvZ2tW.js";import{_ as se}from"./Grid-DOXFwCbr.js";import{_ as le}from"./DataTable-CN6TpDw8.js";import"./Forward-D55si25S.js";import"./RadioGroup-RlP9nCM5.js";const ie={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},re={class:"h-100% flex",style:{"flex-direction":"column"}},ce=R({name:"realtimequery_inverterquery",__name:"index",setup(de){const{columns:g,columnChecks:u,data:m,getData:f,loading:h,mobilePagination:N,searchParams:r,resetSearchParams:me}=q({apiFn:A,apiParams:{page:1,pageSize:20,limit:20,id:null,startTime:_(1,Date.now()-2592e5),endTime:_(1,Date.now()),_t:new Date().getTime()},immediate:!1,showTotal:!0,columns:()=>[{type:"selection",width:40,fixed:"left"},{key:"dbtime",title:"时间",align:"center",width:180},{key:"p",title:"有功功率（KW）",align:"center",width:140},{key:"q",title:"无功功率（KW）",align:"center",width:140},{key:"pf",title:"功率因数",align:"center",width:140},{key:"dayE",title:"日发电量(kW·h)",align:"center",width:140},{key:"usum",title:"总电压(V)",align:"center",width:140},{key:"isum",title:"总电流(A)",align:"center",width:140}]}),{drawerVisible:pe,operateType:_e,editingData:ue,handleAdd:fe,handleEdit:ge,checkedRowKeys:d,onBatchDeleted:he,onDeleted:ye}=L(m,f),y=v([Date.now()-864e5*3,Date.now()]);async function C(l,e){r.startTime=_(1,e[0]),r.endTime=_(1,e[1])}const S=()=>{var l;if(!r.id)return(l=window.$message)==null?void 0:l.warning("请选择逆变器");f()},p=v(),z=async()=>{var n,s;const{data:l,error:e}=await X();if(!e){if(p.value=l,p.value.length==0)return(n=window.$message)==null?void 0:n.warning("暂无逆变器数据，请添加逆变器后在进行查询");r.id=(s=p.value[0])==null?void 0:s.id,f()}};M(()=>{z()});const E=()=>{const l={};g.value.forEach(n=>{n.key!="index"&&n.key!="operation"&&n.type!=="selection"&&(l[n.key]=n.title)});const e=[];m.value.forEach(n=>{if(d.value.includes(n.dbtime)){const s=JSON.parse(JSON.stringify(l));for(const c in s)n.hasOwnProperty(c)?s[c]=n[c]:s[c]="";e.push(s)}}),ae(e,l,"逆变器数据")};return(l,e)=>{const n=ne,s=oe,c=Q,$=O,B=se,I=Y,w=Z,P=K,U=G,V=ee,F=le;return W(),j("div",ie,[t(w,{bordered:!1,size:"small"},{default:o(()=>[t(I,{ref:"formRef",model:a(r),"label-placement":"left","show-feedback":!1},{default:o(()=>[t(B,{"y-gap":16,responsive:"screen","item-responsive":""},{default:o(()=>[t(s,{span:"24 s:12 m:8",label:"起止时间",path:"time",class:"pr-24px"},{default:o(()=>[t(n,{value:y.value,"onUpdate:value":e[0]||(e[0]=i=>y.value=i),type:"datetimerange","value-format":"yyyy-MM-dd hh:mm:ss",style:{width:"100%"},"onUpdate:formattedValue":C,"default-time":["00:00:00","23:59:59"]},null,8,["value"])]),_:1}),t(s,{span:"24 s:12 m:5",label:"逆变器",path:"endTime",class:"pr-24px"},{default:o(()=>[t(c,{value:a(r).id,"onUpdate:value":e[1]||(e[1]=i=>a(r).id=i),options:p.value,filterable:"",placeholder:"请选择逆变器",style:{width:"100%"},"label-field":"iname","value-field":"id"},null,8,["value","options"])]),_:1}),t(s,{span:"24 s:12 m:5",label:"",path:"endTime",class:"pr-24px"},{default:o(()=>[t(a(x),{type:"primary",ghost:"",onClick:S,class:"mr-10px"},{icon:o(()=>[t($,{class:J(["text-icon",{"animate-spin":a(h)}])},null,8,["class"])]),default:o(()=>[b(" "+k(a(D)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(w,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{default:o(()=>[H("div",re,[t(V,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px mb-10px"},{default:o(()=>[t(a(x),{onClick:E,size:"small",disabled:a(d).length==0},{icon:o(()=>[t(P,{class:"text-icon"})]),default:o(()=>[b(" "+k(a(D)("common.export")),1)]),_:1},8,["disabled"]),t(U,{columns:a(u),"onUpdate:columns":e[2]||(e[2]=i=>T(u)?u.value=i:null)},null,8,["columns"])]),_:1}),t(F,{"checked-row-keys":a(d),"onUpdate:checkedRowKeys":e[3]||(e[3]=i=>T(d)?d.value=i:null),columns:a(g),data:a(m),size:"small",loading:a(h),remote:"","row-key":i=>i.dbtime,pagination:a(m).length?a(N):void 0,class:"sm:h-full","flex-height":!0,"scroll-x":""},null,8,["checked-row-keys","columns","data","loading","row-key","pagination"])])]),_:1})])}}}),Ee=te(ce,[["__scopeId","data-v-53a7ab46"]]);export{Ee as default};

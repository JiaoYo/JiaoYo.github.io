import{_ as T}from"./save-outline-D5BlEwIc.js";import{_ as P}from"./round-search-CxXrOyeP.js";import{d as $,r as B,b8 as y,i as g,o as N,b as E,f as l,w as u,g as f,h as V,B as v,a8 as x,t as h,b_ as M,dF as S,aA as s,a5 as o,ab as j,E as z,X as A}from"./index-CUNPF4fr.js";import{_ as F}from"./DatePicker-Dnzm2qej.js";import{_ as G}from"./DataTable-DCVZic8E.js";import"./Forward-D2lkVYwM.js";import"./RadioGroup-Dt9BXj20.js";const O={class:"min-h-500px flex-col-stretch gap-16px lt-sm:overflow-auto"},R=$({name:"stationmanagement_reportingdatarestrictions",__name:"index",setup(X){const m=B({dateTime:y(0,Date.now()),type:1}),r=g(!1);let d=g([]);const c=async()=>{r.value=!0,d.value=[];const{data:e,error:t}=await M({date:m.dateTime});if(!t){e.forEach(a=>{a.manuPower=a.manuPower?a.manuPower:null,a.maxValue=a.maxValue?a.maxValue:null,a.minValue=a.minValue?a.minValue:null});for(let a=0;a<e.length;a+=3)d.value.push(e.slice(a,a+3));r.value=!1}};c();const k=e=>{m.dateTime=y(0,e),c()},b=async()=>{var n,_;let e=d.value.flat();if(e=e.filter(i=>i.maxValue!=null||i.minValue!=null),e.length==0)return(n=window.$message)==null?void 0:n.warning("请填写数据");const{data:t,error:a}=await S(e);a||((_=window.$message)==null||_.success("设置成功"),c())},w=[{title:"时间",key:"dbtime",render:e=>{var t;return l("span",null,[(t=e[0])==null?void 0:t.dbtime])}},{title:"上限值",key:"maxValue",render(e){var t,a;return((t=e[0])==null?void 0:t.dbtime)&&s(o,{value:(a=e[0])==null?void 0:a.maxValue,onUpdateValue(n){e[0].maxValue=n}})}},{title:"下限值",key:"minValue",render(e){var t,a;return((t=e[0])==null?void 0:t.dbtime)&&s(o,{value:(a=e[0])==null?void 0:a.minValue,onUpdateValue(n){e[0].minValue=n}})}},{title:"时间",key:"key",render:e=>{var t;return l("span",null,[(t=e[1])==null?void 0:t.dbtime])}},{title:"上限值",key:"value",render(e){var t,a;return((t=e[1])==null?void 0:t.dbtime)&&s(o,{value:(a=e[1])==null?void 0:a.maxValue,onUpdateValue(n){e[1].maxValue=n}})}},{title:"下限值",key:"value",render(e){var t,a;return((t=e[1])==null?void 0:t.dbtime)&&s(o,{value:(a=e[1])==null?void 0:a.minValue,onUpdateValue(n){e[1].minValue=n}})}},{title:"时间",key:"key",render:e=>{var t;return l("span",null,[(t=e[2])==null?void 0:t.dbtime])}},{title:"上限值",key:"maxValue",render(e){var t;return((t=e[2])==null?void 0:t.dbtime)&&s(o,{value:e[2].maxValue,onUpdateValue(a){e[2].maxValue=a}})}},{title:"下限值",key:"minValue",render(e){var t,a;return((t=e[2])==null?void 0:t.dbtime)&&s(o,{value:(a=e[2])==null?void 0:a.minValue,onUpdateValue(n){e[2].minValue=n}})}}];return(e,t)=>{const a=F,n=P,_=j,i=z,U=T,D=G,C=A;return N(),E("div",O,[l(C,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:u(()=>[l(i,{align:"center",wrap:"",justify:"start",class:"lt-sm:w-200px"},{default:u(()=>[f(" 上报数据限制 "),l(_,null,{default:u(()=>[l(a,{"formatted-value":m.dateTime,"onUpdate:formattedValue":t[0]||(t[0]=p=>m.dateTime=p),"value-format":"yyyy-MM-dd",type:"date","onUpdate:value":k,style:{width:"200px"}},null,8,["formatted-value"]),l(V(v),{type:"primary",ghost:"",onClick:c},{icon:u(()=>[l(n,{class:x(["text-icon",{"animate-spin":r.value}])},null,8,["class"])]),default:u(()=>[f(" "+h(e.$t("common.search")),1)]),_:1})]),_:1})]),_:1})]),"header-extra":u(()=>[l(i,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:u(()=>[l(V(v),{onClick:b,ghost:"",type:"primary"},{icon:u(()=>[l(U,{class:x(["text-icon",{"animate-spin":r.value}])},null,8,["class"])]),default:u(()=>[f(" "+h(e.$t("common.save")),1)]),_:1})]),_:1})]),default:u(()=>[l(D,{columns:w,data:V(d),bordered:!1,"flex-height":!0,class:"sm:h-full","row-key":p=>p.id,loading:r.value,"virtual-scroll":""},null,8,["data","row-key","loading"])]),_:1})])}}});export{R as default};

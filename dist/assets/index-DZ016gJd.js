import{_ as P}from"./save-outline-BYUEzP_k.js";import{_ as $}from"./round-search-B1MUoGzQ.js";import{d as N,r as z,bd as g,i as f,o as v,b as E,f as l,w as s,g as V,h as y,B as x,aa as h,t as k,c as M,bW as S,dz as j,aF as u,a5 as o,ad as F,E as G,ae as O,X as W}from"./index-h7EWxaXY.js";import{_ as X}from"./DatePicker-en-8Zh7J.js";const q={class:"min-h-500px flex-col-stretch gap-16px lt-sm:overflow-auto"},L=N({name:"stationmanagement_reportingdatarestrictions",__name:"index",setup(A){const m=z({dateTime:g(0,Date.now()),type:1}),r=f(!1);let d=f([]);const c=async()=>{r.value=!0,d.value=[];const{data:e,error:n}=await S({date:m.dateTime});if(!n){e.forEach(a=>{a.manuPower=a.manuPower?a.manuPower:null,a.maxValue=a.maxValue?a.maxValue:null,a.minValue=a.minValue?a.minValue:null});for(let a=0;a<e.length;a+=3)d.value.push(e.slice(a,a+3));r.value=!1}};c();const b=f(0),w=e=>{m.dateTime=g(0,e),c()},U=async()=>{var t,_;let e=d.value.flat();if(e=e.filter(i=>i.maxValue!=null||i.minValue!=null),e.length==0)return(t=window.$message)==null?void 0:t.warning("请填写数据");const{data:n,error:a}=await j(e);a||((_=window.$message)==null||_.success("设置成功"),c())},D=[{title:"时间",key:"dbtime",render:e=>{var n;return l("span",null,[(n=e[0])==null?void 0:n.dbtime])}},{title:"上限值",key:"maxValue",render(e){var n,a;return((n=e[0])==null?void 0:n.dbtime)&&u(o,{value:(a=e[0])==null?void 0:a.maxValue,onUpdateValue(t){e[0].maxValue=t}})}},{title:"下限值",key:"minValue",render(e){var n,a;return((n=e[0])==null?void 0:n.dbtime)&&u(o,{value:(a=e[0])==null?void 0:a.minValue,onUpdateValue(t){e[0].minValue=t}})}},{title:"时间",key:"key",render:e=>{var n;return l("span",null,[(n=e[1])==null?void 0:n.dbtime])}},{title:"上限值",key:"value",render(e){var n,a;return((n=e[1])==null?void 0:n.dbtime)&&u(o,{value:(a=e[1])==null?void 0:a.maxValue,onUpdateValue(t){e[1].maxValue=t}})}},{title:"下限值",key:"value",render(e){var n,a;return((n=e[1])==null?void 0:n.dbtime)&&u(o,{value:(a=e[1])==null?void 0:a.minValue,onUpdateValue(t){e[1].minValue=t}})}},{title:"时间",key:"key",render:e=>{var n;return l("span",null,[(n=e[2])==null?void 0:n.dbtime])}},{title:"上限值",key:"maxValue",render(e){var n;return((n=e[2])==null?void 0:n.dbtime)&&u(o,{value:e[2].maxValue,onUpdateValue(a){e[2].maxValue=a}})}},{title:"下限值",key:"minValue",render(e){var n,a;return((n=e[2])==null?void 0:n.dbtime)&&u(o,{value:(a=e[2])==null?void 0:a.minValue,onUpdateValue(t){e[2].minValue=t}})}}];return(e,n)=>{const a=X,t=$,_=F,i=G,C=P,T=O,B=W;return v(),E("div",q,[l(B,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:s(()=>[l(i,{align:"center",wrap:"",justify:"start",class:"lt-sm:w-200px"},{default:s(()=>[V(" 上报数据限制 "),l(_,null,{default:s(()=>[l(a,{"formatted-value":m.dateTime,"onUpdate:formattedValue":n[0]||(n[0]=p=>m.dateTime=p),"value-format":"yyyy-MM-dd",type:"date","onUpdate:value":w,style:{width:"200px"}},null,8,["formatted-value"]),l(y(x),{type:"primary",ghost:"",onClick:c},{icon:s(()=>[l(t,{class:h(["text-icon",{"animate-spin":r.value}])},null,8,["class"])]),default:s(()=>[V(" "+k(e.$t("common.search")),1)]),_:1})]),_:1})]),_:1})]),"header-extra":s(()=>[l(i,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:s(()=>[l(y(x),{onClick:U,ghost:"",type:"primary"},{icon:s(()=>[l(C,{class:h(["text-icon",{"animate-spin":r.value}])},null,8,["class"])]),default:s(()=>[V(" "+k(e.$t("common.save")),1)]),_:1})]),_:1})]),default:s(()=>[(v(),M(T,{columns:D,data:y(d),bordered:!1,"flex-height":!0,class:"sm:h-full","row-key":p=>p.id,key:b.value,loading:r.value},null,8,["data","row-key","loading"]))]),_:1})])}}});export{L as default};

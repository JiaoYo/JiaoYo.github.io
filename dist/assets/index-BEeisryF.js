import{d as S,a0 as F,a2 as k,N as C,i as A,s as B,be as P,o as N,b as U,I as q,Z as H,a1 as K,p as Z,bd as h,c as X,w as a,f as t,g as i,t as D,h as d,$ as j,y as J,as as Q,E as R,at as Y,B as ee,F as ae,X as I,a8 as te,l as E,ab as M,e as V}from"./index-C4Xe5hxh.js";import{_ as ne,f as oe}from"./outline-data-exploration-GbG8c6wU.js";import{u as se}from"./echarts-UVKnXDc0.js";import{_ as le}from"./round-search-hnCStK2c.js";import{_ as re}from"./DatePicker-DcWFcsyX.js";import{_ as ie}from"./FormItemGridItem-CQhANOnq.js";import{_ as ce}from"./Grid-Buhl17jd.js";import{_ as ue,a as me}from"./DescriptionsItem-BLfr47Gi.js";const de=S({name:"LineChart",__name:"line-chart",props:{data:{required:!0},dataModifiers:{}},emits:["update:data"],setup(y){const c=F(y,"data");k(()=>c.value,e=>{n()});const v=C(),u=A(null),{domRef:p,updateOptions:x}=se(()=>({tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}},valueFormatter:function(e){return e+"[兆瓦]"}},legend:{data:["预测功率","实际功率"]},grid:{left:"2%",right:"3%",bottom:"10%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value",axisLabel:{formatter:"{value} [兆瓦]"}},series:[{color:"#e90445",name:"预测功率",type:"line",emphasis:{focus:"series"},data:[]},{color:"#addb0b",name:"实际功率",type:"line",emphasis:{focus:"series"},label:{show:!0,position:"top",formatter:function(e){return e.value+"[兆瓦]"}},data:[]}],dataZoom:[{type:"inside",start:0,end:100},{start:0,end:100}]}));async function n(){await new Promise(e=>{setTimeout(e,1e3)}),x(e=>(e.xAxis.data=c.value.map(o=>o.time),e.series[0].data=c.value.map(o=>o.actual),e.series[1].data=c.value.map(o=>o.forecast),e))}function l(){x((e,o)=>{const s=o();return e.legend.data=s.legend.data,e.series[0].name=s.series[0].name,e.series[1].name=s.series[1].name,e})}async function _(){n()}return k(()=>v.locale,()=>{l()}),_(),B(()=>{u.value=window.setInterval(()=>{console.log("mainHomeLineChart timer")},1e3*60*5)}),P(()=>{u.value!==null&&(clearInterval(u.value),u.value=null)}),(e,o)=>(N(),U("div",{ref_key:"domRef",ref:p,class:"h-520px overflow-hidden"},null,512))}}),pe=q(de,[["__scopeId","data-v-5a23f566"]]),_e=S({name:"AlarmSearch",__name:"search",props:{model:{required:!0},modelModifiers:{}},emits:H(["reset","search","exportData"],["update:model"]),setup(y,{emit:c}){K({1:"电场1",2:"电场2",3:"电场3"});const v=c,u=C(),{formRef:p,restoreValidation:x}=Z(),n=F(y,"model");n.value.errorType="1",n.value.time=A([Number(h(5,Date.now()-864e5*6)),Number(h(5,Date.now()+864e5))]),n.value.startTime=h(0,Date.now()-864e5*6),n.value.endTime=h(0,Date.now()+864e5);async function l(o,s){n.value.startTime=o[0],n.value.endTime=o[1]}async function _(){v("search")}const e=()=>{v("exportData")};return(o,s)=>{const f=re,r=ie,m=Q,b=R,w=Y,g=le,L=ee,$=ne,z=R,G=ce,O=ae,W=I;return N(),X(W,{bordered:!1,size:"small",class:"card-wrapper"},{default:a(()=>[t(O,{ref_key:"formRef",ref:p,model:n.value,"label-placement":"left","label-width":d(u).locale=="en-US"?120:80,"show-feedback":!1,onKeyup:J(_,["enter"])},{default:a(()=>[t(G,{"y-gap":16,responsive:"screen","item-responsive":""},{default:a(()=>[t(r,{span:"24 s:12 m:6",label:"时间",path:"startTime",class:"pr-24px"},{default:a(()=>[t(f,{value:n.value.time,"onUpdate:value":s[0]||(s[0]=T=>n.value.time=T),type:"daterange","value-format":"yyyy-MM-dd",style:{width:"100%"},"onUpdate:formattedValue":l},null,8,["value"])]),_:1}),t(r,{span:"24 s:12 m:4",label:"",path:"errorType"},{default:a(()=>[t(w,{value:n.value.errorType,"onUpdate:value":s[1]||(s[1]=T=>n.value.errorType=T),name:"radiogroup"},{default:a(()=>[t(b,null,{default:a(()=>[t(m,{value:"0"},{default:a(()=>[i("短期误差")]),_:1}),t(m,{value:"1"},{default:a(()=>[i("超短期误差")]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),t(r,{span:"24 s:12 m:6",class:"pr-24px"},{default:a(()=>[t(z,{class:"w-full"},{default:a(()=>[t(L,{type:"primary",ghost:"",onClick:_},{icon:a(()=>[t(g,{class:"text-icon"})]),default:a(()=>[i(" "+D(d(j)("common.search")),1)]),_:1}),t(L,{onClick:e},{icon:a(()=>[t($,{class:"text-icon"})]),default:a(()=>[i(" "+D("导出"))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","label-width"])]),_:1})}}}),fe={class:"min-h-500px flex-col-stretch gap-16px lt-sm:overflow-auto"},ge=V("span",{class:"font-size-16px"},"误差统计",-1),De=S({name:"statisticalanalysis_powererrorstatistics",__name:"index",setup(y){C();const{columns:c,columnChecks:v,data:u,getData:p,loading:x,mobilePagination:n,searchParams:l,resetSearchParams:_}=te({apiFn:oe,apiParams:{page:1,pageSize:20,limit:20,startTime:h(0,Date.now()-864e5*6),endTime:h(0,Date.now()+864e5),level:null,devtype:null,electricField:E.get("ip"),status:null,_t:new Date().getTime()},immediate:!1,showTotal:!0,columns:()=>[{key:"devname",title:"名称",align:"center",width:160},{key:"reoetits",title:"最大值",align:"center",width:160},{key:"content",title:"最小值",align:"center",minWidth:200},{key:"describe",title:"平均值",align:"center",minWidth:200}]});let e=[{time:"2024-07-18 06:00",actual:125,forecast:345},{time:"2024-07-18 08:00",actual:305,forecast:445},{time:"2024-07-18 10:00",actual:225,forecast:336},{time:"2024-07-18 12:00",actual:195,forecast:245},{time:"2024-07-18 14:00",actual:265,forecast:305},{time:"2024-07-18 16:00",actual:263,forecast:294},{time:"2024-07-18 18:00",actual:305,forecast:285},{time:"2024-07-18 20:00",actual:235,forecast:305},{time:"2024-07-18 22:00",actual:235,forecast:325}];const o=()=>{};k(()=>l.errorType,f=>{f=="1"?e=[{time:"2024-07-18 06:00",actual:125,forecast:345},{time:"2024-07-18 08:00",actual:305,forecast:445},{time:"2024-07-18 10:00",actual:225,forecast:336},{time:"2024-07-18 12:00",actual:195,forecast:245},{time:"2024-07-18 14:00",actual:265,forecast:305},{time:"2024-07-18 16:00",actual:263,forecast:294},{time:"2024-07-18 18:00",actual:305,forecast:285},{time:"2024-07-18 20:00",actual:235,forecast:305},{time:"2024-07-18 22:00",actual:235,forecast:325}]:e=[]});const s=f=>{f.detail.key==="ip"&&p({electricFieId:E.get("ip")})};return B(()=>{window.addEventListener("localStorageChanged",s)}),P(()=>{window.removeEventListener("localStorageChanged",s)}),(f,r)=>{const m=ue,b=me,w=I;return N(),U("div",fe,[t(_e,{model:d(l),"onUpdate:model":r[0]||(r[0]=g=>M(l)?l.value=g:null),onReset:d(_),onSearch:d(p),onExportData:o},null,8,["model","onReset","onSearch"]),t(w,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:a(()=>[V("span",null,D(d(l).errorType=="1"?"超短期功率误差曲线":"短期功率误差曲线"),1)]),default:a(()=>[t(pe,{data:d(e),"onUpdate:data":r[1]||(r[1]=g=>M(e)?e.value=g:e=g)},null,8,["data"]),t(b,{"label-placement":"left",bordered:"",column:4,"label-style":{width:"200px",fontWeight:"bold",textAlign:"center",background:"#fafafa",borderRadius:"2px 0 0 2px",paddingLeft:"8px"}},{header:a(()=>[ge]),default:a(()=>[t(m,{label:"均方根误差(RMSE)"},{default:a(()=>[i(" 26 ")]),_:1}),t(m,{label:"平均绝对误差(MAE)"},{default:a(()=>[i(" 24 ")]),_:1}),t(m,{label:"相关性系数"},{default:a(()=>[i(" 32 ")]),_:1}),t(m,{label:"开机容量平均误差"},{default:a(()=>[i(" 32 ")]),_:1})]),_:1})]),_:1})])}}});export{De as default};

import{d as $,Z as G,N as F,p as I,a0 as j,i as q,ba as m,o as V,c as L,w as a,f as e,h as o,a3 as X,g as f,t as Z,$ as H,y as J,a4 as Q,B as T,E,F as Y,X as K,a8 as ee,c2 as ae,a9 as te,c3 as D,b as oe,ab as R}from"./index-DLNUCcPL.js";import{_ as ne}from"./round-search-B-4rQdSi.js";import{c as se}from"./common-KHbjJ8CK.js";import{_ as le}from"./FormItemGridItem-lpVvZ2tW.js";import{_ as ie}from"./DatePicker-lNHPIgCH.js";import{_ as re}from"./Grid-DOXFwCbr.js";import{N as ce}from"./Popconfirm-W4X6vaEJ.js";import{_ as de}from"./DataTable-CN6TpDw8.js";import"./Forward-D55si25S.js";import"./RadioGroup-RlP9nCM5.js";const me=$({name:"foreCastSearch",__name:"foreCastSearch",props:{model:{required:!0},modelModifiers:{}},emits:G(["search"],["update:model"]),setup(z,{emit:w}){const y=w,B=F(),{formRef:v,restoreValidation:u}=I(),t=j(z,"model");t.value.time=q([Number(m(5,Date.now()-864e5*3)),Number(m(5,Date.now()))]),t.value.startTime=m(1,Date.now()-864e5*3),t.value.endTime=m(1,Date.now());async function b(_,s){t.value.startTime=m(1,s[0]),t.value.endTime=m(1,s[1])}async function l(){y("search")}const k=_=>{t.value.code=_,_==8&&(t.value.fcode=_,setTimeout(()=>{t.value.code=void 0},200))};return(_,s)=>{const N=Q,g=le,P=ie,r=ne,U=T,M=E,x=re,C=Y,S=K;return V(),L(S,{bordered:!1,size:"small",class:"card-wrapper"},{default:a(()=>[e(C,{ref_key:"formRef",ref:v,model:t.value,"label-placement":"left","label-width":o(B).locale=="en-US"?120:100,"show-feedback":!1,onKeyup:J(l,["enter"])},{default:a(()=>[e(x,{"y-gap":16,responsive:"screen","item-responsive":""},{default:a(()=>[e(g,{span:"24 s:12 m:6",label:"状态码",path:"code",class:"pr-24px"},{default:a(()=>[e(N,{filterable:"",clearable:"",placeholder:"请选择状态码",value:t.value.code,"onUpdate:value":s[0]||(s[0]=p=>t.value.code=p),style:{width:"100%"},options:o(X)(o(se)),onUpdateValue:k},null,8,["value","options"])]),_:1}),e(g,{span:"24 s:12 m:4",label:"状态",path:"code",class:"pr-24px"},{default:a(()=>[e(N,{filterable:"",clearable:"",placeholder:"请选择状态",value:t.value.config,"onUpdate:value":s[1]||(s[1]=p=>t.value.config=p),style:{width:"100%"},options:[{label:"已确认",value:1},{label:"未确认",value:0}]},null,8,["value"])]),_:1}),e(g,{span:"24 s:12 m:8",label:"起止时间",path:"time",class:"pr-24px"},{default:a(()=>[e(P,{value:t.value.time,"onUpdate:value":s[2]||(s[2]=p=>t.value.time=p),type:"datetimerange","value-format":"yyyy-MM-dd hh:mm:ss",style:{width:"100%"},"onUpdate:formattedValue":b},null,8,["value"])]),_:1}),e(g,{span:"24 s:12 m:6",class:"pr-24px"},{default:a(()=>[e(M,{class:"w-full"},{default:a(()=>[e(U,{type:"primary",ghost:"",onClick:l},{icon:a(()=>[e(r,{class:"text-icon"})]),default:a(()=>[f(" "+Z(o(H)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","label-width"])]),_:1})}}}),ue={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},Ne=$({name:"logmanage_forecastlog",__name:"index",setup(z){const w=F(),{columns:y,columnChecks:B,data:v,getData:u,loading:t,pagination:b,searchParams:l,resetSearchParams:k}=ee({apiFn:ae,apiParams:{page:1,pageSize:20,limit:20,startTime:m(1,Date.now()-864e5*3),endTime:m(1,Date.now()),code:void 0,config:void 0,order:null,_t:new Date().getTime()},columns:()=>[{type:"selection",width:50,align:"center",resizable:!0},{key:"code",title:"状态码",minWidth:140,align:"center",resizable:!0},{key:"errormsg",title:"错误信息",minWidth:140,align:"center",resizable:!0},{key:"dbtime",title:"时间",minWidth:140,align:"center",resizable:!0,sorter:!0},{key:"config",title:"操作",minWidth:140,align:"center",render(n){return e(T,{size:"small",type:"info",ghost:!0,disabled:n.config!==0||n.code===0,onClick:()=>x(n)},{default:()=>[f("确认")]})}}]}),{drawerVisible:_,operateType:s,editingData:N,handleAdd:g,handleEdit:P,checkedRowKeys:r,onBatchDeleted:U,onDeleted:M}=te(v,u),x=async n=>{var d;const{data:c,error:i}=await D({ids:n.id});i||((d=window.$message)==null||d.success("确认成功"),u())},C=async()=>{var d;const n=r.value.join(","),{data:c,error:i}=await D({ids:n});i||((d=window.$message)==null||d.success("确认成功"),u(),r.value=[])},S=async()=>{var i;const{data:n,error:c}=await D();c||((i=window.$message)==null||i.success("确认成功"),u())},p=n=>{if(n.order=="descend")l.order="1";else{if(l.order==null)return;l.order=void 0}u()};return(n,c)=>{const i=T,d=ce,O=E,W=de,A=K;return V(),oe("div",ue,[e(me,{model:o(l),"onUpdate:model":c[0]||(c[0]=h=>R(l)?l.value=h:null),onReset:o(k),onSearch:o(u)},null,8,["model","onReset","onSearch"]),e(A,{title:"预测日志",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":a(()=>[e(O,null,{default:a(()=>[e(d,{onPositiveClick:C},{trigger:a(()=>[e(i,{size:"small",ghost:"",type:"info",disabled:o(r).length==0},{default:a(()=>[f(" 批量确认 ")]),_:1},8,["disabled"])]),default:a(()=>[f(" 确认要确认选中的数据吗？ ")]),_:1}),e(d,{onPositiveClick:S},{trigger:a(()=>[e(i,{size:"small",ghost:"",type:"info"},{default:a(()=>[f(" 全部确认 ")]),_:1})]),default:a(()=>[f(" 确认要确认全部的数据吗？ ")]),_:1})]),_:1})]),default:a(()=>[e(W,{"checked-row-keys":o(r),"onUpdate:checkedRowKeys":c[1]||(c[1]=h=>R(r)?r.value=h:null),columns:o(y),data:o(v),size:"small","flex-height":!o(w).isMobile,"scroll-x":"",loading:o(t),remote:"","row-key":h=>h.id,pagination:o(b),class:"sm:h-full","onUpdate:sorter":p},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1})])}}});export{Ne as default};

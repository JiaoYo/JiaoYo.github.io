import{H as v,d as Y,q as ee,s as te,j as L,y as ae,o as Z,c as oe,w as s,f as U,g as n,aT as T,S as ne,F as le,ax as se,ay as ue,au as re,e as ie,i as pe,h as z,aK as I,$ as de,ak as ce,am as me,X as ye,C as ve,B as _e,D as fe,a9 as be}from"./index-W31l-hMM.js";import{j as Ce,k as Pe}from"./reportForm-DSRYXfS2.js";import{f as he}from"./asset-CRxzhYTx.js";import{u as Te}from"./usePageData-DAVGF1ZZ.js";import{_ as ge,a as xe,b as je,c as we}from"./file-pdf-KTMVu07W.js";import{_ as Le}from"./DatePicker-C1EVOkwN.js";import{a as Se,_ as De}from"./Grid-CIumVYLX.js";import"./index-BS8KoN7o.js";import"./installCanvasRenderer-iCPGNWhM.js";import"./TimePicker-DCnBxtff.js";import"./defineProperty-Z6nS0v7G.js";import"./Forward-DyDCrUKk.js";const $e=c=>{const p=JSON.parse(JSON.stringify(c));return[{type:"title",value:"资产信息报表"},{type:"subtitle",value:"一、资产基本信息"},{type:"table",value:{head:["资产名称","资产类型","网段名称","主IP","创建时间"],body:p.baseInfo.map(o=>[o.aname,o.assname,o.nname,o.aip,o.dbtime])}},{type:"subtitle",value:"二、资产类型分布统计"},{type:"chart",value:{chartType:"pie",id:v(),data:Object.entries(p.assetType).map(([o,C],m)=>({value:C,name:o}))}}]},ke=(c,p)=>{var m,u,r,P,h,g,x,j,w,_,i,a,f,b,S,D,$,k,A,N,y,O,R,B,F,E,M,H,J,K,V,G,Q,W,q;const t=JSON.parse(JSON.stringify(c)),o=["一般","低级","中级","高级","严重"],C=["#99CC00","#1e90ff","#FF9900","#FF6666","#CC0033"];return[{type:"title",value:"审计信息"},{type:"title",value:p.startTime+" — "+p.endTime},{type:"subtitle",value:"一、概述"},{type:"text",value:"1.1 产生事件数量如下"},{type:"table",value:{head:["事件类型","事件数量"],body:[["安全事件",t.e1],["关联事件",t.e2],["审计事件",t.e3],["告警事件",t.e4],["威胁情报事件",t.e5]]}},{type:"subtitle",value:"二、安全事件"},{type:"text",value:"2.1 安全事件等级统计"},{type:"chart",value:{chartType:"pie",id:v(),data:o.map((e,d)=>{const l=`e${d+1}`;return{value:t.secureCountPojo[l]==0||t.secureCountPojo[l]==null?null:t.secureCountPojo[l],name:e,itemStyle:{color:C[d]}}})}},{type:"table",value:{head:["安全事件等级","事件数量"],body:o.map((e,d)=>{const l=t.secureCountPojo[`e${d+1}`];return[e,l]})}},{type:"text",value:"2.2 安全事件类型统计（TOP10）"},{type:"chart",value:{chartType:"bar",id:v(),data:{xAxis:(u=(m=t.secureCountPojo)==null?void 0:m.typeCountPojoList)==null?void 0:u.map(e=>e.tname),series:[{name:"",data:(P=(r=t.secureCountPojo)==null?void 0:r.typeCountPojoList)==null?void 0:P.map(e=>e.tcount)}]}}},{type:"table",value:{head:["安全事件类型","事件数量"],body:(g=(h=t.secureCountPojo)==null?void 0:h.typeCountPojoList)==null?void 0:g.map(e=>[e.tname,e.tcount])}},{type:"text",value:"2.3 安全事件数量趋势"},{type:"chart",value:{chartType:"line",id:v(),data:{xAxis:(j=(x=t.secureCountPojo)==null?void 0:x.dayCountPojoList)==null?void 0:j.map(e=>e.date.substring(0,10)),series:[{name:"",data:(_=(w=t.secureCountPojo)==null?void 0:w.dayCountPojoList)==null?void 0:_.map(e=>e.dailycount)}]}}},{type:"table",value:{head:["日期","事件数量"],body:(i=t.secureCountPojo.dayCountPojoList)==null?void 0:i.map(e=>[e.date.substring(0,10),e.dailycount])}},{type:"subtitle",value:"三、审计事件"},{type:"text",value:"3.1 审计事件等级统计"},{type:"chart",value:{chartType:"pie",id:v(),data:o.map((e,d)=>{const l=`e${d+1}`;return{value:t.auditCountPojo[l]==0||t.auditCountPojo[l]==null?null:t.auditCountPojo[l],name:e,itemStyle:{color:C[d]}}})}},{type:"table",value:{head:["审计事件等级","事件数量"],body:o.map((e,d)=>{const l=t.auditCountPojo[`e${d+1}`];return[e,l]})}},{type:"text",value:"3.2 审计事件类型统计（TOP10）"},{type:"chart",value:{chartType:"bar",id:v(),data:{xAxis:(f=(a=t.auditCountPojo)==null?void 0:a.typeCountPojoList)==null?void 0:f.map(e=>e.tname),series:[{name:"",data:(S=(b=t.auditCountPojo)==null?void 0:b.typeCountPojoList)==null?void 0:S.map(e=>e.tcount)}]}}},{type:"table",value:{head:["审计事件类型","事件数量"],body:($=(D=t.auditCountPojo)==null?void 0:D.typeCountPojoList)==null?void 0:$.map(e=>[e.tname,e.tcount])}},{type:"text",value:"3.3 审计事件数量趋势"},{type:"chart",value:{chartType:"line",id:v(),data:{xAxis:(A=(k=t.auditCountPojo)==null?void 0:k.dayCountPojoList)==null?void 0:A.map(e=>e.date.substring(0,10)),series:[{name:"",data:(y=(N=t.auditCountPojo)==null?void 0:N.dayCountPojoList)==null?void 0:y.map(e=>e.dailycount)}]}}},{type:"table",value:{head:["日期","事件数量"],body:(R=(O=t.auditCountPojo)==null?void 0:O.dayCountPojoList)==null?void 0:R.map(e=>[e.date.substring(0,10),e.dailycount])}},{type:"subtitle",value:"四、告警事件"},{type:"text",value:"4.1 告警事件等级统计"},{type:"chart",value:{chartType:"pie",id:v(),data:o.map((e,d)=>{const l=`e${d+1}`;return{value:t.alarmCountPojo[l]==0||t.alarmCountPojo[l]==null?null:t.alarmCountPojo[l],name:e}})}},{type:"table",value:{head:["告警事件等级","事件数量"],body:o.map((e,d)=>{const l=t.alarmCountPojo[`e${d+1}`];return[e,l]})}},{type:"text",value:"4.2 告警事件类型统计（TOP10）"},{type:"chart",value:{chartType:"bar",id:v(),data:{xAxis:(F=(B=t.alarmCountPojo)==null?void 0:B.typeCountPojoList)==null?void 0:F.map(e=>e.tname),series:[{name:"",data:(M=(E=t.alarmCountPojo)==null?void 0:E.typeCountPojoList)==null?void 0:M.map(e=>e.tcount)}]}}},{type:"table",value:{head:["告警事件类型","事件数量"],body:(J=(H=t.alarmCountPojo)==null?void 0:H.typeCountPojoList)==null?void 0:J.map(e=>[e.tname,e.tcount])}},{type:"text",value:"4.3 告警事件数量趋势"},{type:"chart",value:{chartType:"line",id:v(),data:{xAxis:(V=(K=t.alarmCountPojo)==null?void 0:K.dayCountPojoList)==null?void 0:V.map(e=>e.date.substring(0,10)),series:[{name:"",data:(Q=(G=t.alarmCountPojo)==null?void 0:G.dayCountPojoList)==null?void 0:Q.map(e=>e.dailycount)}]}}},{type:"table",value:{head:["日期","事件数量"],body:(q=(W=t.alarmCountPojo)==null?void 0:W.dayCountPojoList)==null?void 0:q.map(e=>[e.date.substring(0,10),e.dailycount])}}]},Ae=c=>(se("data-v-81822e3e"),c=c(),ue(),c),Ie=Ae(()=>U("span",{class:"mr-20px"},"报表预览",-1)),Ne={title:"导出PDF"},Ue={title:"导出Word"},Oe={title:"导出Excel"},Re=Y({name:"reportPreview",__name:"reportPreview",props:ee({data:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:["update:visible"],setup(c){const p=c,t=te(c,"visible"),o=L(""),C=()=>{var u,r;o.value=((r=(u=p.data)==null?void 0:u.find(P=>P.type=="title"))==null?void 0:r.value)+"报表"+T(1,new Date)};ae(t,()=>{t.value&&C()});const m=L();return(u,r)=>{const P=ge,h=xe,g=je,x=we,j=ne,w=le;return Z(),oe(w,{show:t.value,"onUpdate:show":r[3]||(r[3]=_=>t.value=_),preset:"card",class:"w-1000px"},{header:s(()=>[Ie,U("span",Ne,[n(P,{class:"text-32px c-#d63031 cursor-pointer",onClick:r[0]||(r[0]=_=>m.value.toPdf(o.value))})]),U("span",Ue,[n(h,{class:"text-32px c-#1e90ff cursor-pointer",onClick:r[1]||(r[1]=_=>m.value.toWord(o.value))})]),U("span",Oe,[n(g,{class:"text-32px c-#15703d cursor-pointer",onClick:r[2]||(r[2]=_=>m.value.toExcel(o.value))})])]),default:s(()=>[n(j,{class:"max-h-600px"},{default:s(()=>[n(x,{ref_key:"filePreviewExportRef",ref:m,width:800,data:p.data},null,8,["data"])]),_:1})]),_:1},8,["show"])}}}),Be=re(Re,[["__scopeId","data-v-81822e3e"]]),ze=Y({name:"reportmanagement_reporttemplate",__name:"index",setup(c){const p=L(!1),t=L({atypes:[],time:void 0,startTime:void 0,endTime:void 0}),o=L([]),C=async()=>{var f;o.value=[];const{data:i,error:a}=await Ce({startTime:t.value.startTime,endTime:t.value.endTime,atypes:(f=t.value.atypes)==null?void 0:f.join(",")});a||(p.value=!0,o.value=$e(i))};async function m(i,a){t.value.startTime=T(1,a[0]),t.value.endTime=T(1,a[1])}const u=L({time:[new Date().getTime()-864e5*30,new Date().getTime()],startTime:T(0,new Date().getTime()-864e5*30),endTime:T(0,new Date().getTime())}),r=async()=>{o.value=[];const{data:i,error:a}=await Pe({startTime:u.value.startTime,endTime:u.value.endTime});a||(p.value=!0,o.value=ke(i,{startTime:u.value.startTime,endTime:u.value.endTime}))};async function P(i,a){u.value.startTime=T(0,a[0]),u.value.endTime=T(0,a[1])}const{pageData:h,getData:g,nextPage:x}=Te(he),j=async i=>{const a=i.currentTarget;a.scrollTop+a.offsetHeight>=a.scrollHeight&&h.data.length<h.total&&x()};g();const w=i=>{const a=i.pid;return I("div",{style:{width:"100%",display:"flex",justifyContent:"space-between"}},[I("div",null,[i.aname]),I("span",{depth:3,tag:"div",style:{color:"#999"}},{default:()=>de(ce[a])})])},_=({option:i,handleClose:a})=>I(me,{style:{padding:"0 6px 0 4px"},closable:!0,onClose:f=>{f.stopPropagation(),a()}},{default:()=>I("div",{style:{display:"flex",alignItems:"center"}},[i.aname])});return(i,a)=>{const f=ye,b=ve,S=Le,D=_e,$=fe,k=be,A=Se,N=De;return Z(),ie("div",null,[n(N,{"x-gap":"12",cols:2},{default:s(()=>[n(A,null,{default:s(()=>[n(k,{title:"资产信息报表"},{default:s(()=>[n($,{ref:"formRef",class:"h-200px","label-width":80,"label-placement":"left",model:t.value},{default:s(()=>[n(b,{label:"资产类型",path:"atypes"},{default:s(()=>[n(f,{value:t.value.atypes,"onUpdate:value":a[0]||(a[0]=y=>t.value.atypes=y),placeholder:"请选择资产类型",clearable:"",filterable:"","value-field":"id",multiple:"","label-field":"aname",options:pe(h).data,"reset-menu-on-options-change":!1,class:"w-60%","render-label":w,"render-tag":_,onScroll:j},null,8,["value","options"])]),_:1}),n(b,{label:"查询日期",path:"selectTime"},{default:s(()=>[n(S,{value:t.value.time,"onUpdate:value":a[1]||(a[1]=y=>t.value.time=y),type:"daterange",clearable:"",class:"w-60%","onUpdate:formattedValue":m},null,8,["value"])]),_:1}),n(b,{label:" "},{default:s(()=>[n(D,{"attr-type":"button",onClick:C},{default:s(()=>[z(" 查询 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),n(A,null,{default:s(()=>[n(k,{title:"综合报表"},{default:s(()=>[n($,{ref:"formRef",class:"h-200px","label-width":80,"label-placement":"left",model:u.value},{default:s(()=>[n(b,{label:"查询日期",path:"selectTime"},{default:s(()=>[n(S,{value:u.value.time,"onUpdate:value":a[2]||(a[2]=y=>u.value.time=y),type:"daterange",clearable:"",class:"w-60%","onUpdate:formattedValue":P},null,8,["value"])]),_:1}),n(b,{label:""}),n(b,{label:" "},{default:s(()=>[n(D,{"attr-type":"button",onClick:r},{default:s(()=>[z(" 查询 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]),_:1}),n(Be,{data:o.value,visible:p.value,"onUpdate:visible":a[3]||(a[3]=y=>p.value=y)},null,8,["data","visible"])])}}});export{ze as default};

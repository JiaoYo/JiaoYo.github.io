import{_ as W}from"./table-column-setting.vue_vue_type_script_setup_true_lang-LRck0f9n.js";import{_ as X}from"./round-delete-r4sPWrGw.js";import{_ as Y}from"./round-add-DQmNG3rz.js";import{d as L,n as A,p as Z,r as ee,q as te,a5 as G,b as ae,$ as p,o as M,c as R,w as a,g as e,h as g,t as U,i,ah as le,ej as oe,ek as ne,F as ie,ai as se,ae as re,J as de,B as w,I as Q,aj as pe,el as ue,z as N,y as F,em as E,e as ce,a9 as K,ak as I,al as me,a0 as _e}from"./index-F0x4z3rt.js";import{u as fe,a as ve}from"./table-DRNLrwJT.js";import{f as ge,b as he}from"./station-Cnk3wqTS.js";import{_ as we}from"./FormItemGridItem-DvyzlfdR.js";import{_ as ye}from"./Grid-B9eaEnpq.js";import{N as J}from"./Popconfirm-DnHjxSRH.js";import{_ as be}from"./DataTable-B8y0NXpM.js";import"./RadioGroup-CuVFnOLQ.js";import"./Forward-DSwERy6a.js";const ke=L({name:"PhotovoltaicModel",__name:"pvmodule_model",props:A({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:A(["submitted"],["update:visible"]),setup(m,{emit:C}){const c=Z(m,"visible"),y=C,u=m,t=ee(b());function b(){return{model:"",capacity:void 0,maxvol:void 0,maxcru:void 0,openvol:void 0,shortcur:void 0,workeff:void 0,rttmed:0,inclination:void 0,area:void 0,solarpanel:void 0}}function T(){Object.assign(t,b()),u.operateType==="edit"&&u.rowData&&Object.assign(t,u.rowData)}const{formRef:V,validate:h,restoreValidation:z}=te();G(()=>u.rowData,()=>{T()}),G(c,()=>{c.value&&(T(),z())});const k=()=>{c.value=!1},S=async()=>{var v;if(await h(),u.operateType==="add"){const{data:l,error:_}=await oe([t]);if(_)return}else{const{data:l,error:_}=await ne([t]);if(_)return}(v=window.$message)==null||v.success(u.operateType==="add"?"添加成功":"修改成功"),k(),y("submitted")},j={type:"string",required:!0,message:"不能为空",trigger:["input","blur"]},r={type:"number",required:!0,message:"不能为空",trigger:["input","blur"]},q={model:j,capacity:r,maxvol:r,maxcru:r,openvol:r,shortcur:r,workeff:r,rttmed:r,inclination:r,area:r,solarpanel:r},x=ae(()=>({add:p("common.add"),edit:p("common.edit")})[u.operateType]);return(v,l)=>{const _=ie,n=we,s=se,d=re,$=ye,B=de,D=w,P=Q,O=pe;return M(),R(O,{show:c.value,"onUpdate:show":l[11]||(l[11]=o=>c.value=o),title:x.value,preset:"card",class:"w-50%"},{footer:a(()=>[e(P,{size:16,justify:"center"},{default:a(()=>[e(D,{onClick:k,class:"w-100px"},{default:a(()=>[g(U(i(p)("common.cancel")),1)]),_:1}),e(D,{type:"primary",class:"w-100px",onClick:S},{default:a(()=>[g(U(i(p)("common.confirm")),1)]),_:1})]),_:1})]),default:a(()=>[e(B,{ref_key:"formRef",ref:V,model:t,rules:q,"label-placement":"left","label-width":180,"require-mark-placement":"left"},{default:a(()=>[e($,{responsive:"screen","item-responsive":""},{default:a(()=>[e(n,{span:"24 m:12",label:"组件型号",path:"model"},{default:a(()=>[e(_,{clearable:"",value:t.model,"onUpdate:value":l[0]||(l[0]=o=>t.model=o),maxlength:"64",placeholder:"请输入"},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"组件容量",path:"capacity"},{default:a(()=>[e(s,{clearable:"",value:t.capacity,"onUpdate:value":l[1]||(l[1]=o=>t.capacity=o),placeholder:"请输入",precision:0,style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"最大工作电压",path:"maxvol"},{default:a(()=>[e(s,{clearable:"",value:t.maxvol,"onUpdate:value":l[2]||(l[2]=o=>t.maxvol=o),placeholder:"请输入",precision:2,style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"最大工作电流",path:"maxcru"},{default:a(()=>[e(s,{clearable:"",value:t.maxcru,"onUpdate:value":l[3]||(l[3]=o=>t.maxcru=o),placeholder:"请输入",precision:2,style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"开路电压",path:"openvol"},{default:a(()=>[e(s,{clearable:"",value:t.openvol,"onUpdate:value":l[4]||(l[4]=o=>t.openvol=o),placeholder:"请输入",precision:2,style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"短路电流",path:"shortcur"},{default:a(()=>[e(s,{clearable:"",value:t.shortcur,"onUpdate:value":l[5]||(l[5]=o=>t.shortcur=o),placeholder:"请输入",precision:2,style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"工作效率",path:"workeff"},{default:a(()=>[e(s,{clearable:"",value:t.workeff,"onUpdate:value":l[6]||(l[6]=o=>t.workeff=o),precision:0,placeholder:"请输入",style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"固定角度",path:"rttmed"},{default:a(()=>[e(d,{filterable:"",placeholder:"选择",value:t.rttmed,"onUpdate:value":l[7]||(l[7]=o=>t.rttmed=o),options:i(le)(i(ge))},null,8,["value","options"])]),_:1}),e(n,{span:"24 m:12",label:"安装倾斜度",path:"inclination"},{default:a(()=>[e(s,{clearable:"",value:t.inclination,"onUpdate:value":l[8]||(l[8]=o=>t.inclination=o),placeholder:"请输入",style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"组件面积",path:"area"},{default:a(()=>[e(s,{clearable:"",value:t.area,"onUpdate:value":l[9]||(l[9]=o=>t.area=o),precision:2,placeholder:"请输入",style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"电池板个数",path:"solarpanel"},{default:a(()=>[e(s,{clearable:"",value:t.solarpanel,"onUpdate:value":l[10]||(l[10]=o=>t.solarpanel=o),precision:0,placeholder:"请输入",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title"])}}}),xe={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function H(m){return typeof m=="function"||Object.prototype.toString.call(m)==="[object Object]"&&!me(m)}const Oe=L({name:"stationmanagement_pvmodulesetup",__name:"index",setup(m){const{columns:C,columnChecks:c,data:y,getData:u,loading:t,mobilePagination:b,searchParams:T,resetSearchParams:V}=fe({apiFn:ue,apiParams:{page:1,pageSize:20,limit:20,fuzzy:null,_t:new Date().getTime()},immediate:!0,showTotal:!0,columns:()=>[{type:"selection",align:"center",width:48},{key:"model",title:"组件型号",align:"center",width:140},{key:"capacity",title:"组件容量",align:"center",width:100},{key:"maxvol",title:"最大工作电压",align:"center",width:140},{key:"maxcru",title:"最大工作电流",align:"center",width:140},{key:"openvol",title:"开路电压",align:"center",width:100},{key:"shortcur",title:"短路电流",align:"center",width:100},{key:"workeff",title:"工作效率",align:"center",width:100},{key:"rttmed",title:"固定角度",align:"center",width:100,render:n=>e("span",null,[p(he[n.rttmed])])},{key:"inclination",title:"安装倾斜度",align:"center",width:100},{key:"area",title:"组件面积",align:"center",width:100},{key:"solarpanel",title:"电池板数量",align:"center",width:100},{key:"operate",title:p("common.operate"),align:"center",width:200,fixed:"right",render:n=>{let s;return e("div",{class:"flex-center gap-8px"},[N(e(w,{type:"primary",ghost:!0,size:"small",onClick:()=>_(n.id)},H(s=p("common.edit"))?s:{default:()=>[s]}),[[F("no-auth"),"pvModule:update"]]),N(e(J,{onPositiveClick:()=>l(n.id)},{default:()=>p("common.confirmDelete"),trigger:()=>{let d;return e(w,{type:"error",ghost:!0,size:"small"},H(d=p("common.delete"))?d:{default:()=>[d]})}}),[[F("no-auth"),"pvModule:delete"]])])}}]}),{drawerVisible:h,operateType:z,editingData:k,handleAdd:S,handleEdit:j,checkedRowKeys:r,onBatchDeleted:q,onDeleted:x}=ve(y,u),v=async()=>{const n=r.value.join(","),{data:s,error:d}=await E({ids:n});d||(x(),r.value=[])},l=async n=>{const{data:s,error:d}=await E({ids:n});d||x()},_=n=>{j(n)};return(n,s)=>{const d=Q,$=Y,B=X,D=W,P=be,O=_e,o=F("no-auth");return M(),ce("div",xe,[e(O,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:a(()=>[e(d,{align:"center",wrap:"",justify:"start",class:"lt-sm:w-200px"},{default:a(()=>[g(" 光伏组件设置 ")]),_:1})]),"header-extra":a(()=>[e(d,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:a(()=>[N((M(),R(i(w),{onClick:i(S),size:"small",ghost:"",type:"primary"},{icon:a(()=>[e($,{class:K(["text-icon",{"animate-spin":i(t)}])},null,8,["class"])]),default:a(()=>[g(" "+U(i(p)("common.add")),1)]),_:1},8,["onClick"])),[[o,"pvModule:insert"]]),N((M(),R(i(J),{onPositiveClick:v},{trigger:a(()=>[e(i(w),{size:"small",ghost:"",type:"error",disabled:i(r).length==0},{icon:a(()=>[e(B,{class:K(["text-icon",{"animate-spin":i(t)}])},null,8,["class"])]),default:a(()=>[g(" "+U(i(p)("common.batchDelete")),1)]),_:1},8,["disabled"])]),default:a(()=>[g(" 确认删除选中的项吗？ ")]),_:1})),[[o,"pvModule:delete"]]),e(D,{columns:i(c),"onUpdate:columns":s[0]||(s[0]=f=>I(c)?c.value=f:null)},null,8,["columns"])]),_:1})]),default:a(()=>[e(P,{"checked-row-keys":i(r),"onUpdate:checkedRowKeys":s[1]||(s[1]=f=>I(r)?r.value=f:null),columns:i(C),data:i(y),size:"small",loading:i(t),remote:"","row-key":f=>f.id,pagination:i(b),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","loading","row-key","pagination"]),e(ke,{visible:i(h),"onUpdate:visible":s[2]||(s[2]=f=>I(h)?h.value=f:null),onSubmitted:i(u),"operate-type":i(z),"row-data":i(k)},null,8,["visible","onSubmitted","operate-type","row-data"])]),_:1})])}}});export{Oe as default};

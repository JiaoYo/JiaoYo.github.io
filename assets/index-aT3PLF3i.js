import{_ as M}from"./export-By3IY4tw.js";import{d as $,m as K,q as P,o as C,c as E,w as o,g as t,i as a,$ as n,V as j,c0 as S,h as D,t as z,E as A,I as F,Y as G,B as R,M as O,N as V,ac as T,a2 as W,au as L,K as q,j as Y,C as H,e as J,aB as Q,D as X,at as Z}from"./index-DLQv0xE2.js";import{b as ee,c as te}from"./system-log-BK7uC858.js";import{u as ae}from"./table-Dfen2niS.js";import{_ as ne,a as oe,b as se}from"./lodash-DOLyDuOK.js";import{_ as le}from"./round-refresh-Cl_pKSM5.js";import{_ as re}from"./Grid-AjTJLB13.js";const ie=$({name:"LoginlogSearch",__name:"loginlog-search",props:{model:{required:!0},modelModifiers:{}},emits:K(["reset","search"],["update:model"]),setup(B,{expose:h,emit:f}){const b=f,l=P(B,"model");function y(i){l.value.creatorName=i.replace(/\s/g,"")}function x(i){return!i.startsWith(" ")&&!i.endsWith(" ")}function m(){b("reset")}function p(){b("search")}async function N(){const{data:i,error:e}=await ee({creatorName:l.value.creatorName,status:l.value.status});if(!e){let s=i,c=new Blob([s],{type:"application/vnd.ms-excel"}),g=new Date().getTime()+".xls",d=window.webkitURL.createObjectURL(c),r=document.createElement("a");r.href=d,r.download=g,document.body.appendChild(r),r.click(),r.remove()}}const _=ne.debounce(p,1e3,{leading:!0,trailing:!1});return h({handleExportChange:N}),(i,e)=>{const s=F,c=oe,g=G,d=le,r=R,v=se,u=O,k=re,U=V,I=T;return C(),E(I,{bordered:!1,size:"small",class:"card-wrapper"},{default:o(()=>[t(U,{model:l.value,"label-placement":"left","label-width":80,"show-feedback":!1,onKeyup:A(a(_),["enter"])},{default:o(()=>[t(k,{responsive:"screen","item-responsive":"","x-gap":12,"y-gap":12},{default:o(()=>[t(c,{span:"24 s:12 m:8 l:6",label:a(n)("page.systemlog.login.creatorName"),path:"creatorName"},{default:o(()=>[t(s,{clearable:"",value:l.value.creatorName,"onUpdate:value":e[0]||(e[0]=w=>l.value.creatorName=w),placeholder:a(n)("page.systemlog.login.form.creatorName"),onInput:y,"allow-input":x,onClear:m},null,8,["value","placeholder"])]),_:1},8,["label"]),t(c,{span:"24 s:12 m:8 l:6",label:a(n)("page.systemlog.login.statusDesc"),path:"status"},{default:o(()=>[t(g,{filterable:"",clearable:"",value:l.value.status,"onUpdate:value":[e[1]||(e[1]=w=>l.value.status=w),p],placeholder:a(n)("page.systemlog.login.form.status"),options:a(j)(a(S)),onClear:m},null,8,["value","placeholder","options"])]),_:1},8,["label"]),t(c,{span:"24 s:12 m:8 l:6"},{default:o(()=>[t(u,{class:"w-full"},{default:o(()=>[t(r,{onClick:m},{icon:o(()=>[t(d,{class:"text-icon"})]),default:o(()=>[D(" "+z(a(n)("common.reset")),1)]),_:1}),t(r,{type:"primary",ghost:"",onClick:a(_)},{icon:o(()=>[t(v,{class:"text-icon"})]),default:o(()=>[D(" "+z(a(n)("common.search")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","onKeyup"])]),_:1})}}}),ce={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},he=$({name:"logmanage_loginlog",__name:"index",setup(B){const h=W(),{columns:f,columnChecks:b,data:l,getData:y,loading:x,pagination:m,searchParams:p,resetSearchParams:N}=ae({apiFn:te,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,creatorName:null,status:null,_t:new Date().getTime()},columns:()=>[{key:"creatorName",title:n("page.systemlog.login.creatorName"),align:"center",width:160,resizable:!0},{key:"operation",title:n("page.systemlog.login.operation"),width:140,align:"center",render:e=>{const s=e.operation==0?n("page.manage.common.loginStatus.login"):n("page.manage.common.loginStatus.logout");return t("span",null,[s])},resizable:!0},{key:"status",title:n("page.systemlog.login.status"),width:100,align:"center",render:e=>{e.status==null&&(e.status=0);const s=n(S[e.status].label);return e.status==1?t(L,{size:"small",type:e.status==1?"success":"error"},{default:()=>[e.status==1?"成功":"失败"]}):t(q,null,{trigger:()=>t(L,{size:"small",type:e.status==1?"success":"error"},{default:()=>[e.status==1?"成功":"失败"]}),default:()=>t("span",null,[s])})},resizable:!0},{key:"statusDesc",title:n("page.systemlog.login.statusDesc"),width:140,align:"center",render:e=>{e.status==null&&(e.status=0);const s=n(S[e.status].label);return e.status==1?e.operation==0?"登录成功":"退出成功":t("span",null,[s])},resizable:!0},{key:"ip",title:n("page.systemlog.login.ip"),width:160,align:"center",resizable:!0},{key:"userAgent",title:n("page.systemlog.login.userAgent"),minWidth:400,align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"createDate",title:n("page.systemlog.login.createDate"),width:160,align:"center"}]}),_=Y(),i=()=>{_.value.handleExportChange()};return(e,s)=>{const c=M,g=R,d=Z,r=T,v=H("no-auth");return C(),J("div",ce,[t(ie,{model:a(p),"onUpdate:model":s[0]||(s[0]=u=>Q(p)?p.value=u:null),onReset:a(N),onSearch:a(y),ref_key:"searchRef",ref:_},null,8,["model","onReset","onSearch"]),t(r,{title:a(n)("page.systemlog.login.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":o(()=>[X((C(),E(g,{type:"info",size:"small",ghost:"",onClick:i},{icon:o(()=>[t(c,{class:"text-icon"})]),default:o(()=>[D(" "+z(a(n)("common.export")),1)]),_:1})),[[v,"sys:log:login.export"]])]),default:o(()=>[t(d,{columns:a(f),data:a(l),size:"small","flex-height":!a(h).isMobile,"scroll-x":a(f).reduce((u,k)=>u+k.width,0),loading:a(x),remote:"","row-key":u=>u.id,pagination:a(m),class:"sm:h-full"},null,8,["columns","data","flex-height","scroll-x","loading","row-key","pagination"])]),_:1},8,["title"])])}}});export{he as default};

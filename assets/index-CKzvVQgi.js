import{_ as q}from"./table-header-operation.vue_vue_type_script_setup_true_lang-DCcFtEoA.js";import{d as E,q as L,v as O,s as j,K as H,o as F,c as J,w as e,g as t,L as $,h as l,t as r,i as o,$ as C,M as Q,A as X,B as K,E as Y,D as Z,ad as M,a4 as ee,j as te,r as ae,e as le,ag as I,f as oe,ai as ne,S as se,F as ie}from"./index-ByfxsQvj.js";import{u as re,a as ce}from"./table-Ca-5bYro.js";import{d as me,e as pe}from"./vulnerability-BZjU88HZ.js";import{_ as ue}from"./round-search-U_wZ0GRt.js";import{_ as de}from"./round-refresh-BRVSTvae.js";import{_ as _e}from"./lodash-21GmhknM.js";import{_ as fe}from"./FormItemGridItem-Dtr_7n7z.js";import{_ as he}from"./Grid-B9K_tFX2.js";import{_ as ge,a as ye}from"./DescriptionsItem-6Znaao_s.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-frQqLk93.js";import"./setting-outlined-C6sNL0co.js";import"./export-CaaNVRvS.js";import"./refresh-DDT70CE0.js";import"./round-delete-BsuQe4MI.js";import"./round-plus--T3dOesv.js";import"./Upload-BPNrVbAn.js";import"./Progress-B01mUdYA.js";import"./Popconfirm-Bx1fZnQD.js";const ke=E({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:L(["reset","search"],["update:model"]),setup(D,{emit:k}){const c=k,{formRef:n,restoreValidation:v}=O(),s=j(D,"model");function h(){s.value.fuzzy="",c("search")}function _(){s.value.leakTypeId=void 0,c("search")}async function g(){await v(),c("reset")}async function b(){c("search")}const u=_e.throttle(b,1e3,{trailing:!1});return(z,f)=>{const w=X,y=fe,S=de,N=K,d=ue,V=Y,B=he,R=Z,x=M,m=H("no-space");return F(),J(x,{bordered:!1,size:"small",class:"card-wrapper"},{default:e(()=>[t(R,{ref_key:"formRef",ref:n,model:s.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:Q(o(u),["enter"])},{default:e(()=>[t(B,{responsive:"screen","item-responsive":"","x-gap":12,"y-gap":12},{default:e(()=>[t(y,{span:"24 s:12 m:8 l:6",label:"漏洞编号",path:"fuzzy"},{default:e(()=>[$(t(w,{clearable:"",value:s.value.fuzzy,"onUpdate:value":f[0]||(f[0]=a=>s.value.fuzzy=a),placeholder:"请输入漏洞编号",onClear:h},null,8,["value"]),[[m]])]),_:1}),t(y,{span:"24 s:12 m:8 l:6",label:"漏洞类型编号",path:"leakTypeId"},{default:e(()=>[$(t(w,{clearable:"",value:s.value.leakTypeId,"onUpdate:value":f[1]||(f[1]=a=>s.value.leakTypeId=a),placeholder:"请输入漏洞类型编号",onClear:_},null,8,["value"]),[[m]])]),_:1}),t(y,{span:"24 s:12 m:8 l:6"},{default:e(()=>[t(V,{class:"w-full"},{default:e(()=>[t(N,{onClick:g},{icon:e(()=>[t(S,{class:"text-icon"})]),default:e(()=>[l(" "+r(o(C)("common.reset")),1)]),_:1}),t(N,{type:"primary",ghost:"",onClick:o(u)},{icon:e(()=>[t(d,{class:"text-icon"})]),default:e(()=>[l(" "+r(o(C)("common.search")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","onKeyup"])]),_:1})}}}),ve={class:"min-h-500px flex-col-stretch gap-16px overflow-auto lt-sm:overflow-auto"},be=oe("hr",{style:{"border-color":"#ccc","margin-bottom":"20px"}},null,-1),Ge=E({name:"knowledgebase_cvevulnerabilitydatabase",__name:"index",setup(D){const k=ee(),c=te(!1),n=ae({cveId:"",leakName:"",leakTypeId:"",leakTypeName:"",time:"",score:"",comment:""}),{columns:v,columnChecks:s,data:h,getData:_,loading:g,mobilePagination:b,searchParams:u,resetSearchParams:z}=re({apiFn:me,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,leakTypeId:null,fuzzy:null,_t:new Date().getTime()},columns:()=>[{key:"cveId",title:"漏洞编号",align:"center",minWidth:180,fixed:"left",ellipsis:{tooltip:!0}},{key:"leakName",title:"漏洞名称",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"leakTypeId",title:"漏洞类型编号",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"leakTypeName",title:"漏洞类型名称",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"time",title:"披露时间",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"score",title:"评分",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"operate",title:C("common.operate"),align:"center",width:80,fixed:"right",render:m=>t("div",{class:"flex-center gap-8px"},[t(K,{type:"primary",ghost:!0,size:"small",onClick:()=>x(m)},{default:()=>[l("详情")]})])}]}),{drawerVisible:f,operateType:w,editingData:y,handleAdd:S,handleEdit:N,checkedRowKeys:d,onBatchDeleted:V,onDeleted:B,closeDrawer:R}=ce(h,_);async function x(m){const{data:a,error:T}=await pe({id:m.id});T||(n.cveId=a.cveId,n.leakName=a.leakName,n.leakTypeId=a.leakTypeId,n.leakTypeName=a.leakTypeName,n.time=a.time,n.score=a.score,n.comment=a.comment,c.value=!0)}return(m,a)=>{const T=q,U=ne,W=M,p=ge,G=ye,P=se,A=ie;return F(),le("div",ve,[t(ke,{model:o(u),"onUpdate:model":a[0]||(a[0]=i=>I(u)?u.value=i:null),onReset:o(z),onSearch:o(_)},null,8,["model","onReset","onSearch"]),t(W,{title:"CVE漏洞库",bordered:!1,size:"small",class:"sm:flex-1-hidden"},{"header-extra":e(()=>[t(T,{columns:o(s),"onUpdate:columns":a[1]||(a[1]=i=>I(s)?s.value=i:null),"disabled-delete":o(d).length===0,loading:o(g),onRefresh:o(_)},null,8,["columns","disabled-delete","loading","onRefresh"])]),default:e(()=>[t(U,{"checked-row-keys":o(d),"onUpdate:checkedRowKeys":a[2]||(a[2]=i=>I(d)?d.value=i:null),columns:o(v),data:o(h),size:"small","flex-height":!o(k).isMobile,"scroll-x":962,loading:o(g),remote:"","row-key":i=>i.id,pagination:o(b),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1}),t(A,{show:c.value,"onUpdate:show":a[3]||(a[3]=i=>c.value=i),title:"CVE漏洞库详情",preset:"card",class:"w-800px"},{default:e(()=>[be,t(P,{class:"h-480px pr-20px"},{default:e(()=>[t(G,{"label-placement":"left",bordered:"",column:1,"label-style":{width:"120px"}},{default:e(()=>[t(p,null,{label:e(()=>[l(" 漏洞编号 ")]),default:e(()=>[l(" "+r(n.cveId),1)]),_:1}),t(p,null,{label:e(()=>[l(" 漏洞名称 ")]),default:e(()=>[l(" "+r(n.leakName),1)]),_:1}),t(p,null,{label:e(()=>[l(" 漏洞类型编号 ")]),default:e(()=>[l(" "+r(n.leakTypeId),1)]),_:1}),t(p,null,{label:e(()=>[l(" 漏洞类型名称 ")]),default:e(()=>[l(" "+r(n.leakTypeName),1)]),_:1}),t(p,null,{label:e(()=>[l(" 披露时间 ")]),default:e(()=>[l(" "+r(n.time),1)]),_:1}),t(p,null,{label:e(()=>[l(" 评分 ")]),default:e(()=>[l(" "+r(n.score),1)]),_:1}),t(p,null,{label:e(()=>[l(" 描述 ")]),default:e(()=>[l(" "+r(n.comment),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])])}}});export{Ge as default};

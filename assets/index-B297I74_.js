import{d as O,o as k,b as I,e,a4 as ue,_ as M,m as v,al as Se,a as Z,am as xe,f as C,an as _e,p as F,i as E,c as ee,w as x,t as w,F as fe,af as te,ao as ae,ap as me,g,k as ke,z as se,ag as re,ac as De,h as N,v as Le,ab as pe,aq as ce,ar as Ce,u as Ie,r as Te,as as de,at as Ne,au as Me,av as Ae,aw as q,ax as Be,ay as Oe,A as Ve,J as We,az as ie,aA as Re,aB as He,aC as Pe,aD as ze,ak as Fe}from"./index-CPZbeTv0.js";import{u as he,L as z}from"./echarts-C8xW_7du.js";import{G as Ee,h as Ue,a as je,b as Ge}from"./metar-7b2qE_Ft.js";const Je={class:"loader-overlay"},qe=O({__name:"loading",props:{color:{default:"#1890ff"}},setup(l){const t=l;return(r,s)=>(k(),I("div",Je,[e("div",{class:"loader",style:ue({"--c":`no-repeat linear-gradient(${t.color} 0 0)`})},null,4)]))}}),Ye=M(qe,[["__scopeId","data-v-c4fc24aa"]]),Qe=l=>(F("data-v-4ea05f61"),l=l(),E(),l),Ke=["width","height"],Xe=["fill","stroke","d"],Ze=["stroke"],et=Qe(()=>e("path",{fill:"transparent",stroke:"{mergedColor[1]}",d:"M 5 20 L 5 10 L 12 3  L 60 3 L 68 10"},null,-1)),tt=["stroke","d"],at={class:"dv-border-box-content"},st=O({__name:"border-box-13",props:{color:{type:Array,default:()=>[]},backgroundColor:{type:String,default:"transparent"}},setup(l){const t=l,r=["#6586ec","#2cf7fe"],s=v(null),{width:m,height:_}=Se(s,{width:0,height:0},{box:"border-box"}),f=Z(()=>xe(r,t.color));return(y,S)=>(k(),I("div",{class:"dv-border-box-13 dv-border-box",ref_key:"domRef",ref:s},[(k(),I("svg",{width:C(m),height:C(_),class:"dv-border-svg-container"},[e("path",{fill:l.backgroundColor,stroke:f.value[0],d:`
            M 5 20 L 5 10 L 12 3  L 60 3 L 68 10
            L ${C(m)-20} 10 L ${C(m)-5} 25
            L ${C(m)-5} ${C(_)-5} L 20 ${C(_)-5}
            L 5 ${C(_)-20} L 5 20
        `},null,8,Xe),e("path",{fill:"transparent","stroke-width":"3","stroke-linecap":"round","stroke-dasharray":"10, 5",stroke:f.value[0],d:"M 16 9 L 61 9"},null,8,Ze),et,e("path",{fill:"transparent",stroke:f.value[1],d:`M ${C(m)-5} ${C(_)-30} L ${C(m)-5} ${C(_)-5} L ${C(m)-30} ${C(_)-5}`},null,8,tt)],8,Ke)),e("div",at,[_e(y.$slots,"default",{},void 0,!0)])],512))}}),ot=M(st,[["__scopeId","data-v-4ea05f61"]]),ve=l=>(F("data-v-586f7d9f"),l=l(),E(),l),lt={key:0,class:"item_title"},nt=ve(()=>e("div",{class:"zuo"},null,-1)),rt={class:"title-inner"},ct=ve(()=>e("div",{class:"you"},null,-1)),dt=O({__name:"item-wrap",props:{title:{default:""}},setup(l){return(t,r)=>{const s=ot;return k(),ee(s,null,{default:x(()=>[t.title!==""?(k(),I("div",lt,[nt,e("span",rt,"   "+w(t.title)+"   ",1),ct])):fe("",!0),e("div",{class:te(t.title!==""?"item_title_content":"item_title_content_def")},[_e(t.$slots,"default",{},void 0,!0)],2)]),_:3})}}}),it=M(dt,[["__scopeId","data-v-586f7d9f"]]),ut={class:"list"},_t={class:"item_info"},ft={class:"title"},mt={class:"value"},pt=O({__name:"left-bottom",props:{data:{type:Object,default:()=>({})}},setup(l){const t=l,r=Z(()=>{var s,m,_,f,y,S;return[{key:"envT",title:"温度",value:((s=t.data)==null?void 0:s.envT)||0,unit:"℃",icon:"carbon:temperature-celsius"},{key:"envH",title:"湿度",value:((m=t.data)==null?void 0:m.envH)||0,unit:"%",icon:"lets-icons:humidity"},{key:"qy",title:"气压",value:((_=t.data)==null?void 0:_.qy)||0,unit:"hPa",icon:"mdi:car-brake-low-pressure"},{key:"windS",title:"风速",value:((f=t.data)==null?void 0:f.windS)||0,unit:"m/s",icon:"hugeicons:slow-winds"},{key:"windD",title:"风向",value:((y=t.data)==null?void 0:y.windD)||0,unit:"°",icon:"mdi:windsock"},{key:"zfsdCount",title:"总辐射",value:((S=t.data)==null?void 0:S.zfsd)||0,unit:"W/㎡",color:{start:"#ce9ffc",end:"#7367f0"},icon:"material-symbols:clear-day-rounded"}]});return(s,m)=>{const _=ke;return k(),I("div",ut,[(k(!0),I(ae,null,me(r.value,(f,y)=>(k(),I("div",{class:te(["item",{brBom:[0,1,2].includes(y),brLeft:[0,1,3,4].includes(y)}]),key:f.key},[g(_,{icon:f.icon,class:"iconx"},null,8,["icon"]),e("div",_t,[e("div",ft,w(f.title),1),e("div",mt,w(f.value)+w(f.unit),1)])],2))),128))])}}}),ht=M(pt,[["__scopeId","data-v-f0512d22"]]),T=l=>(F("data-v-ee7e91f5"),l=l(),E(),l),vt={class:"dashboard"},wt={class:"stats-table"},bt=T(()=>e("td",{class:"label"},"CPU使用率:",-1)),gt={class:"value",colspan:"2"},yt=T(()=>e("td",{class:"label"},"内存使用率:",-1)),$t={class:"value",colspan:"2"},St=T(()=>e("td",{class:"label"},"运行状态:",-1)),xt={class:"value",colspan:"2"},kt=T(()=>e("td",{class:"label"},"是否限电:",-1)),Dt={class:"value",colspan:"2"},Lt=T(()=>e("td",{class:"label"},"数据接入:",-1)),Ct={class:"value",colspan:"2"},It=T(()=>e("td",{class:"label"},"数据上报:",-1)),Tt={class:"value",colspan:"2"},Nt=T(()=>e("td",{class:"label"},"有功功率(MW):",-1)),Mt={class:"value",colspan:"2"},At=T(()=>e("td",{class:"label"},"无功功率(MVar):",-1)),Bt={class:"value",colspan:"2"},Ot=T(()=>e("td",{class:"label"},"更新时间:",-1)),Vt={class:"value",colspan:"2"},Wt=T(()=>e("td",{class:"label"},"功率因数:",-1)),Rt={class:"value"},Ht=T(()=>e("td",{class:"label"},"日发电量(MWh):",-1)),Pt={class:"value",colspan:"2"},zt=T(()=>e("td",{class:"label"},"总发电量(MWh):",-1)),Ft={class:"value",colspan:"2"},Et=O({__name:"left-top",props:{data:{type:Object,default:()=>({})}},setup(l){const t=l;return(r,s)=>(k(),I("div",vt,[e("table",wt,[e("tbody",null,[e("tr",null,[bt,e("td",gt,w(t.data.cpu?t.data.cpu+"%":""),1),yt,e("td",$t,w(t.data.mem?t.data.mem+"%":""),1)]),e("tr",null,[St,e("td",xt,w(t.data.stationP&&t.data.stationP>0&&t.data.stationControlled==0?"并网运行":t.data.stationP&&t.data.stationP>0&&t.data.stationControlled==1?"降额运行":t.data.stationP==0?"待机":""),1),kt,e("td",Dt,w(t.data.stationControlled==1?"是":"否"),1)]),e("tr",null,[Lt,e("td",Ct,w(t.data.col=="0"?"🟢":t.data.col=="1"?"🔴":"⚪"),1),It,e("td",Tt,w(t.data.trs=="0"?"🟢":t.data.trs=="1"?"🔴":"⚪"),1)]),e("tr",null,[Nt,e("td",Mt,w(t.data.stationP??"-"),1),At,e("td",Bt,w(t.data.stationQ??"-"),1)]),e("tr",null,[Ot,e("td",Vt,w(t.data.dbtime||"-"),1),Wt,e("td",Rt,w(t.data.stationCOS??"-"),1)]),e("tr",null,[Ht,e("td",Pt,w(t.data.stationDayE??"-"),1),zt,e("td",Ft,w(t.data.stationTotalE??"-"),1)])])])]))}}),Ut=M(Et,[["__scopeId","data-v-ee7e91f5"]]),jt=l=>(F("data-v-dc930ac1"),l=l(),E(),l),Gt={class:"inner_right"},Jt=jt(()=>e("div",{class:"dibu"},null,-1)),qt={class:"info"},Yt={class:"alarmName"},Qt={class:"info_bottom"},Kt={class:"alarmLevel"},Xt={class:"time"},Zt=5e3,ea=3,ta={__name:"left-center",props:{data:{type:Array,default:()=>[]}},setup(l){const t=l,r=[{label:"一般",color:"#0091FF",value:0},{label:"低级",color:"#ffd600",value:1},{label:"中级",color:"#ffab00",value:2},{label:"高级",color:"#ff6d00",value:3},{label:"严重",color:"#dd2c00",value:4}],s=u=>r.find(o=>o.value===u)||{},m=v(!0),_=Z(()=>m.value?[...t.data,...t.data]:t.data),f=v(!1),y=v(),S=v();let p=null;const D=()=>{f.value=!0,m.value=!1,clearInterval(p)},i=()=>{f.value=!1,m.value=!0,re(()=>{n()})},n=()=>{clearInterval(p),p=setInterval(()=>{var W;if(f.value||!m.value)return;const u=y.value,o=S.value;if(!u||!o)return;const c=((W=o.children[0])==null?void 0:W.offsetHeight)||0,V=o.scrollHeight/2,A=u.scrollTop+c*ea;A>=V?a(A,()=>{u.scrollTop=A-V}):a(A)},Zt)},a=(u,o)=>{const c=y.value,V=800,A=c.scrollTop,W=u-A,Y=performance.now(),B=L=>L<.5?2*L*L:-1+(4-2*L)*L,j=L=>{const G=L-Y,J=Math.min(G/V,1);c.scrollTop=A+W*B(J),J<1?requestAnimationFrame(j):o&&o()};requestAnimationFrame(j)};return se(()=>{re(()=>{n()})}),De(()=>{clearInterval(p)}),(u,o)=>(k(),I("div",{class:te(["left_boottom scroll-view",{"show-scrollbar":f.value}]),ref_key:"scrollViewRef",ref:y,onMouseenter:D,onMouseleave:i},[e("div",{ref_key:"listRef",ref:S,class:"left_boottom_list"},[(k(!0),I(ae,null,me(_.value,(c,V)=>(k(),I("div",{class:"left_boottom_item",key:V},[e("div",Gt,[Jt,e("div",qt,[e("div",Yt,"告警名称："+w(c.aname),1),e("div",Qt,[e("div",Kt,[N(" 告警等级： "),e("span",{style:ue({color:s(c.alevel).color,border:"1px solid "+s(c.alevel).color,padding:"0 5px",borderRadius:"5px"})},w(s(c.alevel).label),5)]),e("div",Xt,"时间："+w(c.dbtime),1)])])])]))),128))],512)],34))}},aa=M(ta,[["__scopeId","data-v-dc930ac1"]]),sa=O({name:"LineChart",__name:"power",props:{data:{required:!0},dataModifiers:{}},emits:["update:data"],setup(l){const t=(a,u)=>{const o=a.match(/\d+/g);return o?`rgba(${o[0]}, ${o[1]}, ${o[2]}, ${u})`:""};function r(a,u){return a===0||typeof a=="number"&&!isNaN(a)?a+u:""}const s=["rgb(233, 4, 69)","rgb(0, 150, 136)","rgb(59, 66, 146)","rgb(255, 99, 71)"],m=Le(l,"data"),_=v(null),f=Date.now(),y=new Date(f).setHours(23,59,59,999),{domRef:S,updateOptions:p,updateOptionsAsync:D}=he(()=>({tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}},formatter:function(a){return`
      ${a[0].axisValueLabel||""}<br/>
      <span class="round" style="background-color: ${s[0]}"></span> ${a[0].seriesName}: ${r(a[0].value[1]," MW")}<br/>
      <span class="round" style="background-color: ${s[1]}"></span> ${a[1].seriesName}: ${r(a[1].value[1]," MW")}<br/>
      <span class="round" style="background-color: ${s[2]}"></span> ${a[2].seriesName}: ${r(a[2].value[1]," W/m^2")}<br/>
      <span class="round" style="background-color: ${s[3]}"></span> ${a[3].seriesName}: ${r(a[3].value[1]," W/m^2")}<br/>
      `},backgroundColor:"#6a7985",textStyle:{color:"#d3d6dd"}},legend:{data:["实际功率","预测功率","实际辐射","预测辐射"],textStyle:{color:"#d3d6dd"}},grid:{left:"3%",right:"3%",bottom:"0%",containLabel:!0},xAxis:{type:"time",axisLabel:{formatter:"{HH}:{mm}",color:"#d3d6dd"},max:y+60*1e3,data:[]},yAxis:[{name:"功率MW",type:"value",axisLabel:{formatter:"{value} MW",color:"#d3d6dd"},splitLine:{show:!1,lineStyle:{color:"#757575",width:1}},nameTextStyle:{color:"#d3d6dd"}},{name:"辐射W/m²",type:"value",axisLabel:{formatter:"{value} W/m²",color:"#d3d6dd"},nameTextStyle:{color:"#d3d6dd"},splitLine:{show:!0,lineStyle:{color:"#757575",width:1}}}],series:[{color:s[0],name:"实际功率",type:"line",emphasis:{focus:"series"},yAxisIndex:0,lineStyle:{width:1},showSymbol:!1,areaStyle:{color:new z(0,0,0,1,[{offset:0,color:t(s[0],.3)},{offset:1,color:t(s[0],0)}],!1),shadowColor:t(s[0],.9),shadowBlur:20},data:[],connectNulls:!0},{color:s[1],name:"预测功率",type:"line",yAxisIndex:0,emphasis:{focus:"series"},lineStyle:{width:1},showSymbol:!1,areaStyle:{color:new z(0,0,0,1,[{offset:0,color:t(s[1],.3)},{offset:1,color:t(s[1],0)}],!1),shadowColor:t(s[1],.9),shadowBlur:20},data:[],connectNulls:!0},{color:s[2],name:"实际辐射",type:"line",showSymbol:!1,yAxisIndex:1,emphasis:{focus:"series"},lineStyle:{width:1},areaStyle:{color:new z(0,0,0,1,[{offset:0,color:t(s[2],.3)},{offset:1,color:t(s[2],0)}],!1),shadowColor:t(s[2],.7),shadowBlur:20},data:[],connectNulls:!0},{color:s[3],name:"预测辐射",type:"line",yAxisIndex:1,showSymbol:!1,emphasis:{focus:"series"},lineStyle:{width:1},areaStyle:{color:new z(0,0,0,1,[{offset:0,color:t(s[3],.3)},{offset:1,color:t(s[3],0)}],!1),shadowColor:t(s[3],.7),shadowBlur:20},data:[],connectNulls:!0}]}));async function i(){await new Promise(a=>{setTimeout(a,1e3)}),p(a=>{if(m.value){const u=m.value.map(o=>({dbtime:o.dbtime,prePower:o.prePower,power:o.power,zfsd:o.zfsd,ssrd:o.ssrd}));a.xAxis.data=u.map(o=>o.dbtime),a.series[0].data=u.map(o=>[o.dbtime,o.power]),a.series[1].data=u.map(o=>[o.dbtime,o.prePower]),a.series[2].data=u.map(o=>[o.dbtime,o.zfsd]),a.series[3].data=u.map(o=>[o.dbtime,o.ssrd]),console.log(a.series,"seriesseriesseries")}return a})}pe(()=>m.value,a=>{D(u=>{if(m.value){const o=m.value.map(c=>({dbtime:c.dbtime,prePower:c.prePower,power:c.power,zfsd:c.zfsd,ssrd:c.ssrd}));u.xAxis.data=o.map(c=>c.dbtime),u.series[0].data=o.map(c=>[c.dbtime,c.power]),u.series[1].data=o.map(c=>[c.dbtime,c.prePower]),u.series[2].data=o.map(c=>[c.dbtime,c.zfsd]),u.series[3].data=o.map(c=>[c.dbtime,c.ssrd])}return u})});async function n(){await i()}return se(()=>{S.value=_.value}),n(),(a,u)=>(k(),I("div",{ref_key:"chartDom",ref:_,class:"chart"},null,512))}}),oa=M(sa,[["__scopeId","data-v-3741cc7e"]]),la=O({name:"LineChart",__name:"weather-chart",props:{data:{type:Array,default:[]}},setup(l){function t(i,n){return i===0||typeof i=="number"&&!isNaN(i)?i+n:""}const r=l,s=Date.now(),m=new Date(s).setHours(23,59,59,999),{domRef:_,updateOptions:f,showLoading:y,updateOptionsAsync:S}=he(()=>({tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}},valueFormatter:function(i){return t(i,"°C")},backgroundColor:"#6a7985",textStyle:{color:"#d3d6dd"}},legend:{data:["环境温度","预测温度","组件温度"],textStyle:{color:"#d3d6dd"}},grid:{left:"3%",right:"3%",bottom:"0%",containLabel:!0},xAxis:{type:"time",axisLabel:{formatter:"{HH}:{mm}",color:"#d3d6dd"},max:m+60*1e3,data:[]},yAxis:{name:"温度(°C)",type:"value",axisLabel:{formatter:"{value} °C",color:"#d3d6dd"},splitLine:{show:!0,lineStyle:{color:"#757575",width:1}},nameTextStyle:{color:"#d3d6dd"}},series:[{color:"#27ae60",name:"环境温度",type:"line",lineStyle:{width:1},showSymbol:!1,areaStyle:{color:new z(0,0,0,1,[{offset:0,color:"rgba(39, 174, 96,0.4)"},{offset:1,color:"rgba(39, 174, 96,0)"}],!1),shadowColor:"rgba(39, 174, 96,0.9)",shadowBlur:20},emphasis:{focus:"series"},data:[],connectNulls:!0},{color:"#c0392b",name:"预测温度",type:"line",lineStyle:{width:1},showSymbol:!1,areaStyle:{color:new z(0,0,0,1,[{offset:0,color:"rgba(192, 57, 43,0.3)"},{offset:1,color:"rgba(192, 57, 43,0)"}],!1),shadowColor:"rgba(192, 57, 43,0.9)",shadowBlur:20},emphasis:{focus:"series"},data:[],connectNulls:!0},{color:"#ffa000",name:"组件温度",type:"line",lineStyle:{width:1},showSymbol:!1,areaStyle:{color:new z(0,0,0,1,[{offset:0,color:"rgba(255, 160, 0,0.3)"},{offset:1,color:"rgba(255, 160, 0,0)"}],!1),shadowColor:"rgba(255, 160, 0,0.9)",shadowBlur:20},emphasis:{focus:"series"},data:[],connectNulls:!0}]}));async function p(){await new Promise(i=>{setTimeout(i,1e3)}),f(i=>(r.data&&(i.xAxis.data=r.data.map(n=>n.dbtime),i.series[0].data=r.data.map(n=>[n.dbtime,n.envT]),i.series[1].data=r.data.map(n=>[n.dbtime,n.tt2]),i.series[2].data=r.data.map(n=>[n.dbtime,n.moduleT])),i))}async function D(){p()}return pe(()=>r.data,()=>{S(i=>(r.data&&(i.xAxis.data=r.data.map(n=>n.dbtime),i.series[0].data=r.data.map(n=>[n.dbtime,n.envT]),i.series[1].data=r.data.map(n=>[n.dbtime,n.tt2]),i.series[2].data=r.data.map(n=>[n.dbtime,n.moduleT])),i))}),D(),(i,n)=>(k(),I("div",{ref_key:"domRef",ref:_,class:"chart"},null,512))}}),na=M(la,[["__scopeId","data-v-ec72b241"]]),U=l=>(F("data-v-adf7811f"),l=l(),E(),l),ra=U(()=>e("h2",{class:"setting-title"},"设置",-1)),ca=U(()=>e("div",{class:"left_shu"},"全局设置",-1)),da={class:"setting_item"},ia=U(()=>e("span",{class:"setting_label"},[N(" 是否进行自动适配"),e("span",{class:"setting_label_tip"},"(默认分辨率1920*1080)"),N(": ")],-1)),ua={class:"setting_content"},_a=U(()=>e("div",{class:"left_shu"},"实时监测",-1)),fa={class:"setting_item"},ma=U(()=>e("span",{class:"setting_label"},[N(" 设备提醒自动轮询: "),e("span",{class:"setting_label_tip"})],-1)),pa={class:"setting_content"},ha={class:"setting_item"},va=U(()=>e("span",{class:"setting_label"}," 实时预警轮播: ",-1)),wa={class:"setting_content"},ba=O({__name:"setting",setup(l){const t=v(!0),r=v(!0),s=v(!0);(()=>{r.value=!0,s.value=!0})();const _=S=>{settingStore.setIsScale(S)},f=S=>{settingStore.setIndexConfig({leftBottomSwiper:!0,rightBottomSwiper:!0})},y=v(!1);return(S,p)=>{const D=ce("el-radio"),i=ce("el-radio-group"),n=Ce;return k(),ee(n,{show:y.value,"onUpdate:show":p[6]||(p[6]=a=>y.value=a),direction:"rtl",size:"360px"},{header:x(()=>[ra]),default:x(()=>[ca,e("div",da,[ia,e("div",ua,[g(i,{modelValue:t.value,"onUpdate:modelValue":p[0]||(p[0]=a=>t.value=a),onChange:p[1]||(p[1]=a=>_(a))},{default:x(()=>[g(D,{label:!0},{default:x(()=>[N("是")]),_:1}),g(D,{label:!1},{default:x(()=>[N("否")]),_:1})]),_:1},8,["modelValue"])])]),_a,e("div",fa,[ma,e("div",pa,[g(i,{modelValue:r.value,"onUpdate:modelValue":p[2]||(p[2]=a=>r.value=a),onChange:p[3]||(p[3]=a=>f(a))},{default:x(()=>[g(D,{label:!0},{default:x(()=>[N("是")]),_:1}),g(D,{label:!1},{default:x(()=>[N("否")]),_:1})]),_:1},8,["modelValue"])])]),e("div",ha,[va,e("div",wa,[g(i,{modelValue:s.value,"onUpdate:modelValue":p[4]||(p[4]=a=>s.value=a),onChange:p[5]||(p[5]=a=>f(a))},{default:x(()=>[g(D,{label:!0},{default:x(()=>[N("是")]),_:1}),g(D,{label:!1},{default:x(()=>[N("否")]),_:1})]),_:1},8,["modelValue"])])])]),_:1},8,["show"])}}}),ga=M(ba,[["__scopeId","data-v-adf7811f"]]),ya="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='12'%20height='12'%20viewBox='0%200%2012%2012'%3e%3cpath%20fill='%23fff'%20d='M2.5%2012c-.13%200-.25-.05-.35-.14l-2-1.93A.55.55%200%200%201%200%209.57V2.43c0-.13.06-.26.15-.36l2-1.93c.15-.14.36-.18.55-.1c.18.08.3.26.3.46v11c0%20.2-.12.38-.3.46c-.07.03-.13.04-.2.04m7-3.5c-.06%200-.13-.01-.19-.04A.5.5%200%200%201%209%208l-.01-4.06c0-.2.12-.39.31-.46c.19-.08.4-.03.54.11l1.67%201.7c.38.39.38%201.02-.01%201.41L9.85%208.35a.47.47%200%200%201-.35.15'%20/%3e%3cpath%20fill='none'%20stroke='%23fff'%20stroke-linecap='round'%20d='M2.5%202.5H6c.28%200%20.5.22.5.5v1m-4%205.5H6c.28%200%20.5-.22.5-.5V8M11%206H5'%20stroke-width='1'%20/%3e%3c/svg%3e",K=l=>(F("data-v-8efa225c"),l=l(),E(),l),$a={class:"content_wrap"},Sa={class:"d-flex jc-center title_wrap"},xa=K(()=>e("div",{class:"zuojuxing"},null,-1)),ka=K(()=>e("div",{class:"youjuxing"},null,-1)),Da=K(()=>e("div",{class:"guang"},null,-1)),La=["src"],Ca=K(()=>e("div",{class:"d-flex jc-center"},[e("div",{class:"title"},[e("span",{class:"title-text"},"光功率预测系统可视化")])],-1)),Ia={class:"top_Info"},Ta={class:"left"},Na={class:"right"},Ma={class:"index-box"},Aa={class:"content_left"},Ba={class:"content_right"},Oa=O({name:"bigscreen",__name:"index",setup(l){const t=Ie(),r=Te({dateDay:"",dateYear:"",dateWeek:"",timing:null}),s=["周日","周一","周二","周三","周四","周五","周六"];(()=>{r.timing=setInterval(()=>{r.dateDay=de().format("YYYY-MM-DD hh : mm : ss"),r.dateWeek=s[de().day()]},1e3)})();const _=v({}),f=async()=>{const{data:d,error:b}=await Ne();b||Object.assign(_.value,d)},y=async()=>{const{data:d,error:b}=await Me();b||(_.value.cpu=d.cpu,_.value.mem=d.mem)},S=v(),p=async()=>{const{data:d,error:b}=await Ae({_t:new Date().getTime()});S.value=d.pname},D=v(),i=async()=>{var h;const{data:d,error:b}=await Ee();b||(D.value=d,D.value.length!=0&&(n.value=(h=d[0])==null?void 0:h.id,u()))},n=v(),a=v(),u=async()=>{const{data:d,error:b}=await Ue({devId:n.value});b||(a.value=d)},o=d=>{n.value=d,u(),G()},c=Date.now(),V=new Date(c).setHours(0,0,0,0),A=new Date(c).setHours(23,59,59,999),W=v(),Y=async()=>{const{data:d,error:b}=await je({startTime:q(1,V),endTime:q(1,A),page:1,limit:100});b||(W.value=JSON.parse(JSON.stringify(d)).list)},B=v(),j=async()=>{const{data:d,error:b}=await Be({date:q(0,Date.now())});b||(B.value=d,B.value.forEach(h=>(W.value.forEach($=>{h.dbtime==$.dbtime&&(h.ssrd=$.ssrd)}),h)),L.value.forEach(h=>{const $=B.value.find(H=>H.dbtime===h.dbtime);$?Object.assign($,h):B.value.push(h)}),B.value=B.value.sort((h,$)=>new Date(h.dbtime).getTime()-new Date($.dbtime).getTime()))},L=v(),G=async()=>{if(!n.value)return;const{data:d,error:b}=await Ge({id:n.value,startTime:q(0,Date.now())+" 00:00:00",endTime:q(1,Date.now())});console.log("气象实际数据",d),L.value=d,W.value.forEach(h=>{const $=L.value.find(H=>H.dbtime===h.dbtime);$?Object.assign($,h):L.value.push(h)}),L.value=L.value.sort((h,$)=>new Date(h.dbtime).getTime()-new Date($.dbtime).getTime())},J=v([]),oe=async()=>{const{data:d,error:b}=await Oe({page:1,limit:20});b||(J.value=JSON.parse(JSON.stringify(d)).list)},le=v(null),we=()=>{var ne;(ne=le.value)==null||ne.close();const d=new Date().getTime(),b=Ve(),h=We(`${b}${d}getchlstatus`),$=ie(h),H=ie("getchlstatus"),R=new Re(He+`/ChannelStatusWebsocket/${H}/${$}/${d}/${b}?token=${Pe()}`,{maxReconnectAttempts:3,heartbeatInterval:1e3*30});le.value=R,R.connect(),R.onclose(()=>{}),R.onerror(()=>{}),R.onopen(()=>{}),R.onmessage(X=>{if(console.log(X,"通道状态websocket接受数据"),!be(X.data))return;const P=JSON.parse(X.data).dataStatus;P&&(_.value.col=P.col+""=="0"||P.col+""=="1"?P.col+"":"",_.value.trs=P.trs+""=="0"||P.trs+""=="1"?P.trs+"":"")})},be=d=>{try{return JSON.parse(d),!0}catch{return!1}},ge=()=>{var d;(d=window.$dialog)==null||d.info({title:"退出登录",content:"确定要退出登录吗?",positiveText:"确定",negativeText:"取消",onPositiveClick:async()=>{const{data:b,error:h}=await ze();h||(t.clearInfo(),window.location.reload())}})},ye=v(null),$e=v(null),Q=v(!1);return se(async()=>{p(),we();try{Q.value=!0,await i(),await f(),await y(),await Y(),await G(),await j(),await oe(),Q.value=!1}catch{Q.value=!1}ye.value=setInterval(async()=>{await f(),await Y(),await G(),await j(),await oe(),p()},1e3*60*1),$e.value=setInterval(async()=>{await u(),await y()},1e3*3)}),(d,b)=>{const h=Fe,$=it,H=Ye;return k(),I(ae,null,[e("div",$a,[e("div",Sa,[xa,ka,Da,e("img",{src:C(ya),alt:"",class:"logoutIcon",onClick:ge},null,8,La),Ca,e("div",Ia,[e("div",Ta,[N(w(S.value)+" ",1),g(h,{filterable:"",placeholder:"请选择气象站",value:n.value,"onUpdate:value":b[0]||(b[0]=R=>n.value=R),options:D.value,"label-field":"sname",size:"tiny","value-field":"id",style:{width:"140px","margin-left":"10px"},onUpdateValue:o},null,8,["value","options"])]),e("div",Na,w(r.dateYear)+" "+w(r.dateWeek)+" "+w(r.dateDay),1)])]),e("div",Ma,[e("div",Aa,[g($,{class:"content_left-top",title:"运行状态"},{default:x(()=>[g(Ut,{data:_.value},null,8,["data"])]),_:1}),g($,{class:"content_left-center",title:"最近告警"},{default:x(()=>[g(aa,{data:J.value},null,8,["data"])]),_:1}),g($,{class:"content_left-bottom",title:"气象信息"},{default:x(()=>[g(ht,{data:a.value},null,8,["data"])]),_:1})]),e("div",Ba,[g($,{class:"content_right-top",title:"今日功率"},{default:x(()=>[g(oa,{data:B.value},null,8,["data"])]),_:1}),g($,{class:"content_right-bottom",title:"今日气象"},{default:x(()=>[g(na,{data:L.value},null,8,["data"])]),_:1})])])]),g(ga),Q.value?(k(),ee(H,{key:0})):fe("",!0)],64)}}}),Ha=M(Oa,[["__scopeId","data-v-8efa225c"]]);export{Ha as default};

import{_ as I}from"./export-C1eIYiY_.js";import{d as k,av as T,at as U,c as $,o as C,w as o,f as e,M as F,L as R,h as t,$ as a,H as E,aH as O,bn as P,J as A,B as S,g as _,t as x,a2 as z,aI as G,b as W,aJ as j,az as H,aM as J}from"./index-DdfiWQes.js";import{b as K,c as V}from"./system-log-BTrCis-C.js";import{u as q}from"./table-CXVEJiiW.js";import{_ as Q}from"./round-search-Cus0un5g.js";import{_ as X}from"./round-refresh-CRuVV6u5.js";import{s as B}from"./business-CSjuRrZJ.js";import{_ as Y}from"./Grid-CPKP2Pfd.js";import{_ as Z}from"./FormItemGridItem-DIoGuRnG.js";const ee=k({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:T(["reset","search"],["update:model"]),setup(v,{emit:b}){const h=b,r=U(v,"model");function y(c){r.value.creatorName=c.replace(/\s/g,"")}function N(c){return!c.startsWith(" ")&&!c.endsWith(" ")}function d(){h("reset")}function i(){h("search")}return(c,m)=>{const n=E,l=Z,p=O,g=X,u=S,f=Q,s=A,D=Y,L=F,M=z;return C(),$(M,{bordered:!1,size:"small",class:"card-wrapper"},{default:o(()=>[e(L,{model:r.value,"label-placement":"left","label-width":80,"show-feedback":!1,onKeyup:R(i,["enter"])},{default:o(()=>[e(D,{responsive:"screen","item-responsive":""},{default:o(()=>[e(l,{span:"24 s:12 m:6",label:t(a)("page.systemlog.login.creatorName"),path:"creatorName",class:"pr-24px"},{default:o(()=>[e(n,{clearable:"",value:r.value.creatorName,"onUpdate:value":m[0]||(m[0]=w=>r.value.creatorName=w),placeholder:t(a)("page.systemlog.login.form.creatorName"),onInput:y,"allow-input":N,onClear:d},null,8,["value","placeholder"])]),_:1},8,["label"]),e(l,{span:"24 s:12 m:6",label:t(a)("page.systemlog.login.status"),path:"status",class:"pr-24px"},{default:o(()=>[e(p,{filterable:"",clearable:"",value:r.value.status,"onUpdate:value":[m[1]||(m[1]=w=>r.value.status=w),i],placeholder:t(a)("page.systemlog.login.form.status"),options:t(P)(t(B)),onClear:d},null,8,["value","placeholder","options"])]),_:1},8,["label"]),e(l,{span:"24 s:12 m:6"},{default:o(()=>[e(s,{class:"w-full"},{default:o(()=>[e(u,{onClick:d},{icon:o(()=>[e(g,{class:"text-icon"})]),default:o(()=>[_(" "+x(t(a)("common.reset")),1)]),_:1}),e(u,{type:"primary",ghost:"",onClick:i},{icon:o(()=>[e(f,{class:"text-icon"})]),default:o(()=>[_(" "+x(t(a)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),te={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},me=k({name:"syslog_loginlog",__name:"index",setup(v){const b=G(),{columns:h,data:r,getData:y,loading:N,pagination:d,searchParams:i,resetSearchParams:c}=q({apiFn:V,apiParams:{page:1,pageSize:20,limit:20,creatorName:null,status:null,_t:new Date().getTime()},columns:()=>[{key:"creatorName",title:a("page.systemlog.login.creatorName"),align:"center",width:120,resizable:!0},{key:"operation",title:a("page.systemlog.login.operation"),width:140,align:"center",render:n=>{const l=n.operation==0?a("page.manage.common.loginStatus.login"):a("page.manage.common.loginStatus.logout");return e("span",null,[l,_(" ")])},resizable:!0},{key:"status",title:a("page.systemlog.login.status"),width:100,align:"center",render:n=>{n.status==null&&(n.status=0);const l={0:"error",1:"primary",2:"warning",3:"warning",4:"warning",5:"error",6:"error",7:"error"},p=a(B[n.status].label);return e(J,{size:"small",type:l[n.status]},{default:()=>[_(" "),p,_(" ")]})},resizable:!0},{key:"ip",title:a("page.systemlog.login.ip"),width:160,align:"center",resizable:!0},{key:"ltype",title:"登录类型",width:160,align:"center",resizable:!0,render(n){return e("div",null,[n.ltype==2?"微信扫码登录":n.ltype==1?"手机验证码登录":"账号密码登录"])}},{key:"userAgent",title:a("page.systemlog.login.userAgent"),minWidth:240,align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"createDate",title:a("page.systemlog.login.createDate"),width:200,align:"center"}]}),m=async()=>{const{data:n,error:l}=await K(i);if(!l){let p=n,g=new Blob([p],{type:"application/vnd.ms-excel"}),u=new Date().getTime()+".xls",f=window.webkitURL.createObjectURL(g),s=document.createElement("a");s.href=f,s.download=u,document.body.appendChild(s),s.click(),s.remove()}};return(n,l)=>{const p=I,g=S,u=H,f=z;return C(),W("div",te,[e(ee,{model:t(i),"onUpdate:model":l[0]||(l[0]=s=>j(i)?i.value=s:null),onReset:t(c),onSearch:t(y)},null,8,["model","onReset","onSearch"]),e(f,{title:t(a)("page.systemlog.login.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":o(()=>[e(g,{type:"info",size:"small",ghost:"",onClick:m},{icon:o(()=>[e(p,{class:"text-icon"})]),default:o(()=>[_(" "+x(t(a)("common.export")),1)]),_:1})]),default:o(()=>[e(u,{columns:t(h),data:t(r),size:"small","flex-height":!t(b).isMobile,"scroll-x":"",loading:t(N),remote:"","row-key":s=>s.id,pagination:t(d),class:"sm:h-full"},null,8,["columns","data","flex-height","loading","row-key","pagination"])]),_:1},8,["title"])])}}});export{me as default};

import{_ as j}from"./table-header-operation.vue_vue_type_script_setup_true_lang-DOgh_89k.js";import{d as E,q,s as A,x as H,E as L,o as F,c as J,w as e,g as t,F as $,h as l,t as r,i as o,$ as C,G as Q,K as X,B as K,O as Y,P as Z,ad as U,a4 as ee,j as te,r as ae,e as le,ah as I,f as oe,aj as ne,S as se,ar as ie}from"./index-C5IVBnuT.js";import{u as re,a as ce}from"./table-CQwo57Cc.js";import{d as me,e as pe}from"./vulnerability-BdlPmW71.js";import{_ as ue}from"./round-search-BDs78GhZ.js";import{_ as de}from"./round-refresh-DiPTY6w8.js";import{_ as _e}from"./lodash-Bi0mdSrH.js";import{_ as fe}from"./FormItemGridItem-0rbPDrs6.js";import{_ as he}from"./Grid-BAhwGuO1.js";import{_ as ye,a as ge}from"./DescriptionsItem-C57uVyCa.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-q-O0l1pH.js";import"./setting-outlined-DnWUUCAN.js";import"./export-SR1Whgcp.js";import"./refresh-C-J5xeSd.js";import"./round-delete-CgapNMDE.js";import"./round-plus-CEbJe1F4.js";import"./Upload-BuS47aQS.js";import"./Progress-CG76YBZ6.js";import"./Popconfirm-8Mt3zkJO.js";const ke=E({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:q(["reset","search"],["update:model"]),setup(D,{emit:k}){const c=k,{formRef:n,restoreValidation:v}=A(),s=H(D,"model");function h(){s.value.fuzzy="",c("search")}function _(){s.value.leakTypeId=void 0,c("search")}async function y(){await v(),c("reset")}async function b(){c("search")}const u=_e.throttle(b,1e3,{trailing:!1});return(z,f)=>{const w=X,g=fe,S=de,x=K,d=ue,V=Y,B=he,R=Z,N=U,m=L("no-space");return F(),J(N,{bordered:!1,size:"small",class:"card-wrapper"},{default:e(()=>[t(R,{ref_key:"formRef",ref:n,model:s.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:Q(o(u),["enter"])},{default:e(()=>[t(B,{responsive:"screen","item-responsive":"","x-gap":12,"y-gap":12},{default:e(()=>[t(g,{span:"24 s:12 m:8 l:6",label:"漏洞编号",path:"fuzzy"},{default:e(()=>[$(t(w,{clearable:"",value:s.value.fuzzy,"onUpdate:value":f[0]||(f[0]=a=>s.value.fuzzy=a),placeholder:"请输入漏洞编号",onClear:h},null,8,["value"]),[[m]])]),_:1}),t(g,{span:"24 s:12 m:8 l:6",label:"漏洞类型编号",path:"leakTypeId"},{default:e(()=>[$(t(w,{clearable:"",value:s.value.leakTypeId,"onUpdate:value":f[1]||(f[1]=a=>s.value.leakTypeId=a),placeholder:"请输入漏洞类型编号",onClear:_},null,8,["value"]),[[m]])]),_:1}),t(g,{span:"24 s:12 m:8 l:6"},{default:e(()=>[t(V,{class:"w-full"},{default:e(()=>[t(x,{onClick:y},{icon:e(()=>[t(S,{class:"text-icon"})]),default:e(()=>[l(" "+r(o(C)("common.reset")),1)]),_:1}),t(x,{type:"primary",ghost:"",onClick:o(u)},{icon:e(()=>[t(d,{class:"text-icon"})]),default:e(()=>[l(" "+r(o(C)("common.search")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","onKeyup"])]),_:1})}}}),ve={class:"min-h-500px flex-col-stretch gap-16px overflow-auto lt-sm:overflow-auto"},be=oe("hr",{style:{"border-color":"#ccc","margin-bottom":"20px"}},null,-1),Me=E({name:"knowledgebase_cvevulnerabilitydatabase",__name:"index",setup(D){const k=ee(),c=te(!1),n=ae({cveId:"",leakName:"",leakTypeId:"",leakTypeName:"",time:"",score:"",comment:""}),{columns:v,columnChecks:s,data:h,getData:_,loading:y,mobilePagination:b,searchParams:u,resetSearchParams:z}=re({apiFn:me,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,leakTypeId:null,fuzzy:null,_t:new Date().getTime()},columns:()=>[{key:"cveId",title:"漏洞编号",align:"center",minWidth:180,fixed:"left",ellipsis:{tooltip:!0}},{key:"leakName",title:"漏洞名称",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"leakTypeId",title:"漏洞类型编号",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"leakTypeName",title:"漏洞类型名称",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"time",title:"披露时间",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"score",title:"评分",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"operate",title:C("common.operate"),align:"center",width:80,fixed:"right",render:m=>t("div",{class:"flex-center gap-8px"},[t(K,{type:"primary",ghost:!0,size:"small",onClick:()=>N(m)},{default:()=>[l("详情")]})])}]}),{drawerVisible:f,operateType:w,editingData:g,handleAdd:S,handleEdit:x,checkedRowKeys:d,onBatchDeleted:V,onDeleted:B,closeDrawer:R}=ce(h,_);async function N(m){const{data:a,error:T}=await pe({id:m.id});T||(n.cveId=a.cveId,n.leakName=a.leakName,n.leakTypeId=a.leakTypeId,n.leakTypeName=a.leakTypeName,n.time=a.time,n.score=a.score,n.comment=a.comment,c.value=!0)}return(m,a)=>{const T=j,W=ne,G=U,p=ye,M=ge,P=se,O=ie;return F(),le("div",ve,[t(ke,{model:o(u),"onUpdate:model":a[0]||(a[0]=i=>I(u)?u.value=i:null),onReset:o(z),onSearch:o(_)},null,8,["model","onReset","onSearch"]),t(G,{title:"CVE漏洞库",bordered:!1,size:"small",class:"sm:flex-1-hidden"},{"header-extra":e(()=>[t(T,{columns:o(s),"onUpdate:columns":a[1]||(a[1]=i=>I(s)?s.value=i:null),"disabled-delete":o(d).length===0,loading:o(y),onRefresh:o(_)},null,8,["columns","disabled-delete","loading","onRefresh"])]),default:e(()=>[t(W,{"checked-row-keys":o(d),"onUpdate:checkedRowKeys":a[2]||(a[2]=i=>I(d)?d.value=i:null),columns:o(v),data:o(h),size:"small","flex-height":!o(k).isMobile,"scroll-x":962,loading:o(y),remote:"","row-key":i=>i.id,pagination:o(b),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1}),t(O,{show:c.value,"onUpdate:show":a[3]||(a[3]=i=>c.value=i),title:"CVE漏洞库详情",preset:"card",class:"w-800px"},{default:e(()=>[be,t(P,{class:"h-480px pr-20px"},{default:e(()=>[t(M,{"label-placement":"left",bordered:"",column:1,"label-style":{width:"120px"}},{default:e(()=>[t(p,null,{label:e(()=>[l(" 漏洞编号 ")]),default:e(()=>[l(" "+r(n.cveId),1)]),_:1}),t(p,null,{label:e(()=>[l(" 漏洞名称 ")]),default:e(()=>[l(" "+r(n.leakName),1)]),_:1}),t(p,null,{label:e(()=>[l(" 漏洞类型编号 ")]),default:e(()=>[l(" "+r(n.leakTypeId),1)]),_:1}),t(p,null,{label:e(()=>[l(" 漏洞类型名称 ")]),default:e(()=>[l(" "+r(n.leakTypeName),1)]),_:1}),t(p,null,{label:e(()=>[l(" 披露时间 ")]),default:e(()=>[l(" "+r(n.time),1)]),_:1}),t(p,null,{label:e(()=>[l(" 评分 ")]),default:e(()=>[l(" "+r(n.score),1)]),_:1}),t(p,null,{label:e(()=>[l(" 描述 ")]),default:e(()=>[l(" "+r(n.comment),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])])}}});export{Me as default};

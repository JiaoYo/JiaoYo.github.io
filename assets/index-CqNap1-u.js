import{_ as A}from"./table-column-setting.vue_vue_type_script_setup_true_lang-CbrsOdAy.js";import{_ as L}from"./export-C42jDBrb.js";import{_ as Q}from"./round-search-K9I5IwY9.js";import{d as W,aU as m,j as _,o as X,e as Y,g as t,w as a,i as n,B as f,aa as Z,h as g,t as p,$ as S,al as M,f as ee,K as te,J as ae,H as ne,ak as oe,a1 as le,N as se}from"./index-D00OAWQS.js";import{b as ie,c as re}from"./metar-w2-hQmxV.js";import{u as ce,a as me}from"./table-DhrqdgfY.js";import{e as pe}from"./exportExcel-Bv4G4H50.js";import{_ as U}from"./DatePicker-cKje_mav.js";import{_ as de}from"./FormItemGridItem-BBMCgD8b.js";import{_ as ue}from"./Grid-qOXPwT8g.js";import{_ as _e}from"./DataTable-BiUrOUrX.js";import"./TimePicker-DJqwixmj.js";import"./Forward-CJsjMu_1.js";import"./RadioGroup-QwGocfOO.js";const fe={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},ge=W({name:"realtimequery_datastatistics",__name:"index",setup(he){const{columns:v,columnChecks:h,data:d,getData:x,loading:D,mobilePagination:z,searchParams:w,resetSearchParams:we}=ce({apiFn:ie,apiParams:{page:1,pageSize:20,limit:20,startTime:m(0,Date.now()-2592e5),endTime:m(0,Date.now()),_t:new Date().getTime()},immediate:!0,showTotal:!0,columns:()=>[{type:"selection",width:50},{key:"dbtime",title:"更新时间",align:"center",width:160,fixed:"left"},{key:"etime",title:"有效时长(小时)",align:"center",width:120},{key:"powermax",title:"功率最大值",align:"center",width:120},{key:"avgpower",title:"功率平均值",align:"center",width:120},{key:"stdpower",title:"功率标准差",align:"center",width:120},{key:"powertime",title:"功率最大发生时间",align:"center",width:160},{key:"uhours",title:"利用小时数",align:"center",width:120},{key:"avgload",title:"平均负荷率",align:"center",width:120},{key:"avgenvt",title:"环境温度平均值",align:"center",width:120},{key:"avgenvh",title:"环境湿度平均值",align:"center",width:120},{key:"avgldt",title:"露点温度平均值",align:"center",width:120},{key:"avgqy",title:"气压平均值",align:"center",width:120},{key:"prmse",title:"均方根误差",align:"center",width:120},{key:"pmae",title:"平均绝对误差",align:"center",width:120},{key:"pme",title:"平均误差",align:"center",width:120},{key:"pclcf",title:"相关性系数",align:"center",width:120},{key:"pmaxe",title:"最大预测误差",align:"center",width:120},{key:"prate",title:"合格率",align:"center",width:120}]}),{checkedRowKeys:c}=me(d,x),b=()=>{x()},N=_([Date.now()-864e5*3,Date.now()]);async function P(s,e){w.startTime=m(0,e[0]),w.endTime=m(0,e[1]),b()}const B=()=>{const s={};v.value.forEach(o=>{o.key!="index"&&o.key!="operation"&&o.type!=="selection"&&(s[o.key]=typeof o.title=="string"?o.title:o.title().children[0])});const e=[];d.value.forEach(o=>{if(c.value.includes(o.id)){const i=JSON.parse(JSON.stringify(s));for(const r in i)o.hasOwnProperty(r)?i[r]=o[r]:i[r]="";e.push(i)}}),pe(e,s,"数据统计")},V={近七天:[Date.now()-864e5*7,Date.now()],近一月:[Date.now()-864e5*30,Date.now()],近三月:[Date.now()-864e5*90,Date.now()]},u=_(!1),y=_(new Date().getTime()),k=_(0),j=()=>{T(),u.value=!0},E=(s,e)=>{T()},G=()=>{u.value=!1},T=async()=>{const{data:s,error:e}=await re({date:m(3,y.value)});e||(typeof s=="number"?k.value=s:k.value="")};return(s,e)=>{const o=U,i=Q,r=de,O=ue,R=te,$=L,F=A,C=ae,J=_e,K=U,q=ne,H=oe,I=le;return X(),Y("div",fe,[t(I,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:a(()=>[t(R,{ref:"formRef",model:n(w),"label-placement":"left","show-feedback":!1},{default:a(()=>[t(O,{"y-gap":16,responsive:"screen","item-responsive":""},{default:a(()=>[t(r,{span:"24 s:12 m:12",label:"起止时间",path:"startTime"},{default:a(()=>[t(o,{value:N.value,"onUpdate:value":e[0]||(e[0]=l=>N.value=l),type:"daterange","value-format":"yyyy-MM-dd","onUpdate:formattedValue":P,"default-time":["00:00:00","23:59:59"],shortcuts:V},null,8,["value"]),t(n(f),{type:"primary",ghost:"",onClick:b,class:"ml-20px"},{icon:a(()=>[t(i,{class:Z(["text-icon",{"animate-spin":n(D)}])},null,8,["class"])]),default:a(()=>[g(" "+p(n(S)("common.search")),1)]),_:1}),t(n(f),{type:"primary",ghost:"",onClick:j,class:"ml-20px"},{default:a(()=>[g(p("月均方根误差"))]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),"header-extra":a(()=>[t(C,{justify:"end",class:"lt-sm:w-200px"},{default:a(()=>[t(n(f),{onClick:B,size:"small",disabled:n(c).length==0},{icon:a(()=>[t($,{class:"text-icon"})]),default:a(()=>[g(" "+p(n(S)("common.export")),1)]),_:1},8,["disabled"]),t(F,{columns:n(h),"onUpdate:columns":e[1]||(e[1]=l=>M(h)?h.value=l:null)},null,8,["columns"])]),_:1})]),default:a(()=>[t(J,{"checked-row-keys":n(c),"onUpdate:checkedRowKeys":e[2]||(e[2]=l=>M(c)?c.value=l:null),columns:n(v),data:n(d),size:"small",loading:n(D),remote:"","row-key":l=>l.id,pagination:n(d).length?n(z):void 0,class:"sm:h-full","flex-height":!0,"scroll-x":""},null,8,["checked-row-keys","columns","data","loading","row-key","pagination"]),t(H,{show:u.value,"onUpdate:show":e[4]||(e[4]=l=>u.value=l),preset:"card",class:"w-320px"},{footer:a(()=>[t(C,{justify:"end"},{default:a(()=>[t(n(f),{size:"small",class:"mt-16px",onClick:G},{default:a(()=>[g(p("关闭"))]),_:1})]),_:1})]),default:a(()=>[t(q,{label:"日期","label-placement":"left"},{default:a(()=>[t(K,{value:y.value,"onUpdate:value":[e[3]||(e[3]=l=>y.value=l),E],type:"month",clearable:""},null,8,["value"])]),_:1}),ee("h2",null,"月均方根误差："+p(k.value),1)]),_:1},8,["show"])]),_:1})])}}}),Be=se(ge,[["__scopeId","data-v-ed2c03ee"]]);export{Be as default};

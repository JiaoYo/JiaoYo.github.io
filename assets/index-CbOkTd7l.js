import{_ as j}from"./table-header-operation.vue_vue_type_script_setup_true_lang-Bbt3vQ34.js";import{d as E,n as A,p as q,s as H,D as J,o as F,c as L,w as e,g as a,E as $,h as l,t as r,i as o,$ as C,F as Q,J as X,B as U,N as Y,O as Z,ad as W,a3 as ee,j as ae,r as te,e as le,ah as I,f as oe,aj as ne,S as se,ar as ie}from"./index-DCJMGCjU.js";import{u as re,a as ce}from"./table-BbJ_mIRf.js";import{d as me,e as pe}from"./vulnerability-B74AwWNE.js";import{_ as ue}from"./round-search-CQG7dXzF.js";import{_ as de}from"./round-refresh-BxO_w5DR.js";import{_ as _e}from"./lodash-mhSI0N8l.js";import{_ as fe}from"./FormItemGridItem-DFSPZS-5.js";import{_ as he}from"./Grid-D9UUsNcy.js";import{_ as ge,a as ye}from"./DescriptionsItem-BWHRADpQ.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-BAHRKZjE.js";import"./setting-outlined-DW7BnljB.js";import"./export-Ci30NtKq.js";import"./refresh-BmcUVo7m.js";import"./round-delete-BENxW-Td.js";import"./round-plus-Bqusqz5E.js";import"./Progress-CyaFrR92.js";import"./Popconfirm-hoFMQo4c.js";const ke=E({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:A(["reset","search"],["update:model"]),setup(D,{emit:k}){const c=k,{formRef:n,restoreValidation:v}=q(),s=H(D,"model");function h(){s.value.fuzzy="",c("search")}function _(){s.value.leakTypeId=void 0,c("search")}async function g(){await v(),c("reset")}async function b(){c("search")}const u=_e.debounce(b,1e3,{leading:!0,trailing:!1});return(z,f)=>{const w=X,y=fe,S=de,N=U,d=ue,V=Y,B=he,R=Z,x=W,m=J("no-space");return F(),L(x,{bordered:!1,size:"small",class:"card-wrapper"},{default:e(()=>[a(R,{ref_key:"formRef",ref:n,model:s.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:Q(o(u),["enter"])},{default:e(()=>[a(B,{responsive:"screen","item-responsive":"","x-gap":12,"y-gap":12},{default:e(()=>[a(y,{span:"24 s:12 m:8 l:6",label:"漏洞编号",path:"fuzzy"},{default:e(()=>[$(a(w,{clearable:"",value:s.value.fuzzy,"onUpdate:value":f[0]||(f[0]=t=>s.value.fuzzy=t),placeholder:"请输入漏洞编号",onClear:h},null,8,["value"]),[[m]])]),_:1}),a(y,{span:"24 s:12 m:8 l:6",label:"漏洞类型编号",path:"leakTypeId"},{default:e(()=>[$(a(w,{clearable:"",value:s.value.leakTypeId,"onUpdate:value":f[1]||(f[1]=t=>s.value.leakTypeId=t),placeholder:"请输入漏洞类型编号",onClear:_},null,8,["value"]),[[m]])]),_:1}),a(y,{span:"24 s:12 m:8 l:6"},{default:e(()=>[a(V,{class:"w-full"},{default:e(()=>[a(N,{onClick:g},{icon:e(()=>[a(S,{class:"text-icon"})]),default:e(()=>[l(" "+r(o(C)("common.reset")),1)]),_:1}),a(N,{type:"primary",ghost:"",onClick:o(u)},{icon:e(()=>[a(d,{class:"text-icon"})]),default:e(()=>[l(" "+r(o(C)("common.search")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","onKeyup"])]),_:1})}}}),ve={class:"min-h-500px flex-col-stretch gap-16px overflow-auto lt-sm:overflow-auto"},be=oe("hr",{style:{"border-color":"#ccc","margin-bottom":"20px"}},null,-1),Me=E({name:"knowledgebase_cvevulnerabilitydatabase",__name:"index",setup(D){const k=ee(),c=ae(!1),n=te({cveId:"",leakName:"",leakTypeId:"",leakTypeName:"",time:"",score:"",comment:""}),{columns:v,columnChecks:s,data:h,getData:_,loading:g,mobilePagination:b,searchParams:u,resetSearchParams:z}=re({apiFn:me,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,leakTypeId:null,fuzzy:null,_t:new Date().getTime()},columns:()=>[{key:"cveId",title:"漏洞编号",align:"center",minWidth:180,fixed:"left",ellipsis:{tooltip:!0}},{key:"leakName",title:"漏洞名称",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"leakTypeId",title:"漏洞类型编号",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"leakTypeName",title:"漏洞类型名称",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"time",title:"披露时间",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"score",title:"评分",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"operate",title:C("common.operate"),align:"center",width:80,fixed:"right",render:m=>a("div",{class:"flex-center gap-8px"},[a(U,{type:"primary",ghost:!0,size:"small",onClick:()=>x(m)},{default:()=>[l("详情")]})])}]}),{drawerVisible:f,operateType:w,editingData:y,handleAdd:S,handleEdit:N,checkedRowKeys:d,onBatchDeleted:V,onDeleted:B,closeDrawer:R}=ce(h,_);async function x(m){const{data:t,error:T}=await pe({id:m.id});T||(n.cveId=t.cveId,n.leakName=t.leakName,n.leakTypeId=t.leakTypeId,n.leakTypeName=t.leakTypeName,n.time=t.time,n.score=t.score,n.comment=t.comment,c.value=!0)}return(m,t)=>{const T=j,K=ne,M=W,p=ge,G=ye,P=se,O=ie;return F(),le("div",ve,[a(ke,{model:o(u),"onUpdate:model":t[0]||(t[0]=i=>I(u)?u.value=i:null),onReset:o(z),onSearch:o(_)},null,8,["model","onReset","onSearch"]),a(M,{title:"CVE漏洞库",bordered:!1,size:"small",class:"sm:flex-1-hidden"},{"header-extra":e(()=>[a(T,{columns:o(s),"onUpdate:columns":t[1]||(t[1]=i=>I(s)?s.value=i:null),"disabled-delete":o(d).length===0,loading:o(g),onRefresh:o(_)},null,8,["columns","disabled-delete","loading","onRefresh"])]),default:e(()=>[a(K,{"checked-row-keys":o(d),"onUpdate:checkedRowKeys":t[2]||(t[2]=i=>I(d)?d.value=i:null),columns:o(v),data:o(h),size:"small","flex-height":!o(k).isMobile,"scroll-x":962,loading:o(g),remote:"","row-key":i=>i.id,pagination:o(b),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1}),a(O,{show:c.value,"onUpdate:show":t[3]||(t[3]=i=>c.value=i),title:"CVE漏洞库详情",preset:"card",class:"w-800px"},{default:e(()=>[be,a(P,{class:"h-480px pr-20px"},{default:e(()=>[a(G,{"label-placement":"left",bordered:"",column:1,"label-style":{width:"120px"}},{default:e(()=>[a(p,null,{label:e(()=>[l(" 漏洞编号 ")]),default:e(()=>[l(" "+r(n.cveId),1)]),_:1}),a(p,null,{label:e(()=>[l(" 漏洞名称 ")]),default:e(()=>[l(" "+r(n.leakName),1)]),_:1}),a(p,null,{label:e(()=>[l(" 漏洞类型编号 ")]),default:e(()=>[l(" "+r(n.leakTypeId),1)]),_:1}),a(p,null,{label:e(()=>[l(" 漏洞类型名称 ")]),default:e(()=>[l(" "+r(n.leakTypeName),1)]),_:1}),a(p,null,{label:e(()=>[l(" 披露时间 ")]),default:e(()=>[l(" "+r(n.time),1)]),_:1}),a(p,null,{label:e(()=>[l(" 评分 ")]),default:e(()=>[l(" "+r(n.score),1)]),_:1}),a(p,null,{label:e(()=>[l(" 描述 ")]),default:e(()=>[l(" "+r(n.comment),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])])}}});export{Me as default};

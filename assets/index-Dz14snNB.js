import{G as v,d as X,q as Y,s as Z,j as L,y as ee,o as z,c as te,w as s,f as U,g as n,aT as T,S as ae,F as oe,aw as ne,ax as le,ay as se,e as ue,i as re,h as q,aK as I,$ as ie,ak as pe,am as de,X as ce,C as me,B as ye,D as ve,a9 as _e}from"./index-CgBW4LHb.js";import{j as fe,k as be}from"./reportForm-Clg2k1yM.js";import{f as Pe}from"./asset-wFsgO__4.js";import{u as Ce}from"./usePageData-l06JPPMz.js";import{_ as he,a as Te,b as ge,c as xe}from"./file-pdf-DfpZJS-o.js";import{_ as je}from"./DatePicker-agckd_hr.js";import{a as we,_ as Le}from"./Grid-BJTb7xc8.js";import"./index-BS8KoN7o.js";import"./installCanvasRenderer-iCPGNWhM.js";import"./TimePicker-B-nvbUUN.js";import"./defineProperty-t3G45rKk.js";import"./Forward-Dc9d9gZ-.js";const De=d=>{const p=JSON.parse(JSON.stringify(d));return[{type:"title",value:"资产信息报表"},{type:"subtitle",value:"一、资产基本信息"},{type:"table",value:{head:["资产名称","资产类型","网段名称","主IP","创建时间"],body:p.baseInfo.map(o=>[o.aname,o.assname,o.nname,o.aip,o.dbtime])}},{type:"subtitle",value:"二、资产类型分布统计"},{type:"chart",value:{chartType:"pie",id:v(),data:Object.entries(p.assetType).map(([o,P],m)=>({value:P,name:o}))}}]},$e=(d,p)=>{var P,m,u,r,C,h,g,x,j,w,_,i,a,f,b,D,$,k,A,S,N,y,O,R,B,E,M,G,H,J,K,V,F,Q;const t=JSON.parse(JSON.stringify(d)),o=["一般","低级","中级","高级","严重"];return[{type:"title",value:"审计信息"},{type:"title",value:p.startTime+"~"+p.endTime},{type:"subtitle",value:"一、概述"},{type:"text",value:"1.1 产生事件数量如下"},{type:"table",value:{head:["事件类型","事件数量"],body:[["安全事件",t.e1],["关联事件",t.e2],["审计事件",t.e3],["告警事件",t.e4],["威胁情报事件",t.e5]]}},{type:"subtitle",value:"二、安全事件"},{type:"text",value:"2.1 安全事件等级统计"},{type:"chart",value:{chartType:"pie",id:v(),data:o.map((e,c)=>{const l=`e${c+1}`;return{value:t.secureCountPojo[l]==0||t.secureCountPojo[l]==null?null:t.secureCountPojo[l],name:e}})}},{type:"table",value:{head:["安全事件等级","事件数量"],body:o.map((e,c)=>{const l=t.secureCountPojo[`e${c+1}`];return[e,l]})}},{type:"text",value:"2.2 安全事件类型统计（TOP10）"},{type:"chart",value:{chartType:"bar",id:v(),data:{xAxis:(m=(P=t.secureCountPojo)==null?void 0:P.typeCountPojoList)==null?void 0:m.map(e=>e.tname),series:[{name:"",data:(r=(u=t.secureCountPojo)==null?void 0:u.typeCountPojoList)==null?void 0:r.map(e=>e.tcount)}]}}},{type:"table",value:{head:["安全事件类型","事件数量"],body:(h=(C=t.secureCountPojo)==null?void 0:C.typeCountPojoList)==null?void 0:h.map(e=>[e.tname,e.tcount])}},{type:"text",value:"2.3 安全事件数量趋势"},{type:"chart",value:{chartType:"line",id:v(),data:{xAxis:(x=(g=t.secureCountPojo)==null?void 0:g.dayCountPojoList)==null?void 0:x.map(e=>e.date.substring(0,10)),series:[{name:"",data:(w=(j=t.secureCountPojo)==null?void 0:j.dayCountPojoList)==null?void 0:w.map(e=>e.dailycount)}]}}},{type:"table",value:{head:["日期","事件数量"],body:(_=t.secureCountPojo.dayCountPojoList)==null?void 0:_.map(e=>[e.date.substring(0,10),e.dailycount])}},{type:"subtitle",value:"三、审计事件"},{type:"text",value:"3.1 审计事件等级统计"},{type:"chart",value:{chartType:"pie",id:v(),data:o.map((e,c)=>{const l=`e${c+1}`;return{value:t.auditCountPojo[l]==0||t.auditCountPojo[l]==null?null:t.auditCountPojo[l],name:e}})}},{type:"table",value:{head:["审计事件等级","事件数量"],body:o.map((e,c)=>{const l=t.auditCountPojo[`e${c+1}`];return[e,l]})}},{type:"text",value:"3.2 审计事件类型统计（TOP10）"},{type:"chart",value:{chartType:"bar",id:v(),data:{xAxis:(a=(i=t.auditCountPojo)==null?void 0:i.typeCountPojoList)==null?void 0:a.map(e=>e.tname),series:[{name:"",data:(b=(f=t.auditCountPojo)==null?void 0:f.typeCountPojoList)==null?void 0:b.map(e=>e.tcount)}]}}},{type:"table",value:{head:["审计事件类型","事件数量"],body:($=(D=t.auditCountPojo)==null?void 0:D.typeCountPojoList)==null?void 0:$.map(e=>[e.tname,e.tcount])}},{type:"text",value:"3.3 审计事件数量趋势"},{type:"chart",value:{chartType:"line",id:v(),data:{xAxis:(A=(k=t.auditCountPojo)==null?void 0:k.dayCountPojoList)==null?void 0:A.map(e=>e.date.substring(0,10)),series:[{name:"",data:(S=t.auditCountPojo)==null?void 0:S.dayCountPojoList.map(e=>e.dailycount)}]}}},{type:"table",value:{head:["日期","事件数量"],body:(y=(N=t.auditCountPojo)==null?void 0:N.dayCountPojoList)==null?void 0:y.map(e=>[e.date.substring(0,10),e.dailycount])}},{type:"subtitle",value:"四、告警事件"},{type:"text",value:"4.1 告警事件等级统计"},{type:"chart",value:{chartType:"pie",id:v(),data:o.map((e,c)=>{const l=`e${c+1}`;return{value:t.alarmCountPojo[l]==0||t.alarmCountPojo[l]==null?null:t.alarmCountPojo[l],name:e}})}},{type:"table",value:{head:["告警事件等级","事件数量"],body:o.map((e,c)=>{const l=t.alarmCountPojo[`e${c+1}`];return[e,l]})}},{type:"text",value:"4.2 告警事件类型统计（TOP10）"},{type:"chart",value:{chartType:"bar",id:v(),data:{xAxis:(R=(O=t.alarmCountPojo)==null?void 0:O.typeCountPojoList)==null?void 0:R.map(e=>e.tname),series:[{name:"",data:(E=(B=t.alarmCountPojo)==null?void 0:B.typeCountPojoList)==null?void 0:E.map(e=>e.tcount)}]}}},{type:"table",value:{head:["告警事件类型","事件数量"],body:(G=(M=t.alarmCountPojo)==null?void 0:M.typeCountPojoList)==null?void 0:G.map(e=>[e.tname,e.tcount])}},{type:"text",value:"4.3 告警事件数量趋势"},{type:"chart",value:{chartType:"line",id:v(),data:{xAxis:(J=(H=t.alarmCountPojo)==null?void 0:H.dayCountPojoList)==null?void 0:J.map(e=>e.date.substring(0,10)),series:[{name:"",data:(V=(K=t.alarmCountPojo)==null?void 0:K.dayCountPojoList)==null?void 0:V.map(e=>e.dailycount)}]}}},{type:"table",value:{head:["日期","事件数量"],body:(Q=(F=t.alarmCountPojo)==null?void 0:F.dayCountPojoList)==null?void 0:Q.map(e=>[e.date.substring(0,10),e.dailycount])}}]},ke=d=>(ne("data-v-81822e3e"),d=d(),le(),d),Ae=ke(()=>U("span",{class:"mr-20px"},"报表预览",-1)),Se={title:"导出PDF"},Ie={title:"导出Word"},Ne={title:"导出Excel"},Ue=X({name:"reportPreview",__name:"reportPreview",props:Y({data:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:["update:visible"],setup(d){const p=d,t=Z(d,"visible"),o=L(""),P=()=>{var u,r;o.value=((r=(u=p.data)==null?void 0:u.find(C=>C.type=="title"))==null?void 0:r.value)+"报表"+T(1,new Date)};ee(t,()=>{t.value&&P()});const m=L();return(u,r)=>{const C=he,h=Te,g=ge,x=xe,j=ae,w=oe;return z(),te(w,{show:t.value,"onUpdate:show":r[3]||(r[3]=_=>t.value=_),preset:"card",class:"w-1000px"},{header:s(()=>[Ae,U("span",Se,[n(C,{class:"text-32px c-#d63031 cursor-pointer",onClick:r[0]||(r[0]=_=>m.value.toPdf(o.value))})]),U("span",Ie,[n(h,{class:"text-32px c-#1e90ff cursor-pointer",onClick:r[1]||(r[1]=_=>m.value.toWord(o.value))})]),U("span",Ne,[n(g,{class:"text-32px c-#15703d cursor-pointer",onClick:r[2]||(r[2]=_=>m.value.toExcel(o.value))})])]),default:s(()=>[n(j,{class:"max-h-600px"},{default:s(()=>[n(x,{ref_key:"filePreviewExportRef",ref:m,width:800,data:p.data},null,8,["data"])]),_:1})]),_:1},8,["show"])}}}),Oe=se(Ue,[["__scopeId","data-v-81822e3e"]]),qe=X({name:"reportmanagement_reporttemplate",__name:"index",setup(d){const p=L(!1),t=L({atypes:[],time:void 0,startTime:void 0,endTime:void 0}),o=L([]),P=async()=>{var f;o.value=[];const{data:i,error:a}=await fe({startTime:t.value.startTime,endTime:t.value.endTime,atypes:(f=t.value.atypes)==null?void 0:f.join(",")});a||(p.value=!0,o.value=De(i))};async function m(i,a){t.value.startTime=T(1,a[0]),t.value.endTime=T(1,a[1])}const u=L({time:[new Date().getTime()-864e5*30,new Date().getTime()],startTime:T(0,new Date().getTime()-864e5*30),endTime:T(0,new Date().getTime())}),r=async()=>{o.value=[];const{data:i,error:a}=await be({startTime:u.value.startTime,endTime:u.value.endTime});a||(p.value=!0,o.value=$e(i,{startTime:u.value.startTime,endTime:u.value.endTime}))};async function C(i,a){u.value.startTime=T(0,a[0]),u.value.endTime=T(0,a[1])}const{pageData:h,getData:g,nextPage:x}=Ce(Pe),j=async i=>{const a=i.currentTarget;a.scrollTop+a.offsetHeight>=a.scrollHeight&&h.data.length<h.total&&x()};g();const w=i=>{const a=i.pid;return I("div",{style:{width:"100%",display:"flex",justifyContent:"space-between"}},[I("div",null,[i.aname]),I("span",{depth:3,tag:"div",style:{color:"#999"}},{default:()=>ie(pe[a])})])},_=({option:i,handleClose:a})=>I(de,{style:{padding:"0 6px 0 4px"},closable:!0,onClose:f=>{f.stopPropagation(),a()}},{default:()=>I("div",{style:{display:"flex",alignItems:"center"}},[i.aname])});return(i,a)=>{const f=ce,b=me,D=je,$=ye,k=ve,A=_e,S=we,N=Le;return z(),ue("div",null,[n(N,{"x-gap":"12",cols:2},{default:s(()=>[n(S,null,{default:s(()=>[n(A,{title:"资产信息报表"},{default:s(()=>[n(k,{ref:"formRef",class:"h-200px","label-width":80,"label-placement":"left",model:t.value},{default:s(()=>[n(b,{label:"资产类型",path:"atypes"},{default:s(()=>[n(f,{value:t.value.atypes,"onUpdate:value":a[0]||(a[0]=y=>t.value.atypes=y),placeholder:"请选择资产类型",clearable:"",filterable:"","value-field":"id",multiple:"","label-field":"aname",options:re(h).data,"reset-menu-on-options-change":!1,class:"w-60%","render-label":w,"render-tag":_,onScroll:j},null,8,["value","options"])]),_:1}),n(b,{label:"查询日期",path:"selectTime"},{default:s(()=>[n(D,{value:t.value.time,"onUpdate:value":a[1]||(a[1]=y=>t.value.time=y),type:"daterange",clearable:"",class:"w-60%","onUpdate:formattedValue":m},null,8,["value"])]),_:1}),n(b,{label:" "},{default:s(()=>[n($,{"attr-type":"button",onClick:P},{default:s(()=>[q(" 查询 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),n(S,null,{default:s(()=>[n(A,{title:"综合报表"},{default:s(()=>[n(k,{ref:"formRef",class:"h-200px","label-width":80,"label-placement":"left",model:u.value},{default:s(()=>[n(b,{label:"查询日期",path:"selectTime"},{default:s(()=>[n(D,{value:u.value.time,"onUpdate:value":a[2]||(a[2]=y=>u.value.time=y),type:"daterange",clearable:"",class:"w-60%","onUpdate:formattedValue":C},null,8,["value"])]),_:1}),n(b,{label:""}),n(b,{label:" "},{default:s(()=>[n($,{"attr-type":"button",onClick:r},{default:s(()=>[q(" 查询 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]),_:1}),n(Oe,{data:o.value,visible:p.value,"onUpdate:visible":a[3]||(a[3]=y=>p.value=y)},null,8,["data","visible"])])}}});export{qe as default};

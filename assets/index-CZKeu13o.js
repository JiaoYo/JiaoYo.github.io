import{_ as C}from"./export-DuB7D_r2.js";import{_ as Y}from"./round-search-bjmsA6eX.js";import{d as B,k as c,aw as w,o as u,e as Q,g as o,w as n,i as s,B as f,h as y,t as h,$ as D,c as g,D as v,ax as R,aL as G,Q as V,P as Z,a6 as z,_ as $}from"./index-CPNQZdkq.js";import{f as I}from"./metar-BAqHJOap.js";import{e as U}from"./exportExcel-Bv4G4H50.js";import{_ as j}from"./lodash-BFGOycK-.js";import{_ as q}from"./DatePicker-IOuwbJf3.js";import{_ as K}from"./FormItemGridItem-3xFmST56.js";import{_ as A}from"./Grid-DKovo1_C.js";const J={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},O=B({name:"realtimequery_powerweatheroverview",__name:"index",setup(X){const x=[{key:"dbtime",title:"时间",align:"center",width:160,fixed:"left"},{key:"EnvT",title:"环境温度",align:"center",width:140},{key:"LDT",title:"露点温度",align:"center",width:140},{key:"EnvH",title:"环境湿度",align:"center",width:140},{key:"WindD",title:"风向瞬时值",align:"center",width:140},{key:"WindS",title:"风速瞬时值",align:"center",width:140},{key:"YLDayE",title:"雨量日累计",align:"center",width:140},{key:"QY",title:"气压",align:"center",width:80},{key:"RZDayHour",title:"日照日累计时数",align:"center",width:140},{key:"FSD2Day",title:"直接辐射日累计量",align:"center",width:140},{key:"FSD1Day",title:"散射辐射日累计量",align:"center",width:140},{key:"power",title:"实际功率(MW)",align:"center",width:100,fixed:"right"},{key:"prePower",title:"预测功率(MW)",align:"center",width:100,fixed:"right"},{key:"operate",title:"误差(MW)",align:"center",width:100,fixed:"right",render(t){const a=t.prePower-t.power>=0?t.prePower-t.power:t.power-t.prePower;return o("span",null,[a?parseFloat(a.toFixed(6)):""])}}],k=c(!1),r=c({dateTime:w(0,Date.now())}),T=t=>{r.value.dateTime=w(0,t),d()},i=c([]),d=async()=>{const{data:t,error:a}=await I({date:r.value.dateTime});a||(i.value=t,b())};d();const b=async()=>{const{data:t,error:a}=await R({date:r.value.dateTime});a||(console.log(t),i.value.forEach(e=>{const l=t.find(p=>p.dbtime===e.dbtime);l&&(e.power=l.power,e.prePower=l.prePower)}))},m=c("0"),E=async()=>{d()},S=j.debounce(E,1e3,{leading:!0,trailing:!1}),P=()=>{const t={dbtime:"时间",EnvT:"环境温度",LDT:"露点温度",EnvH:"环境湿度",WindD:"风向瞬时值",WindS:"风速瞬时值",YLDayE:"雨量日累计",QY:"气压",RZDayHour:"日照日累计时数",FSD2Day:"直接辐射日累计量",FSD1Day:"散射辐射日累计量",power:"实际功率(MW)",prePower:"预测功率(MW)",error:"误差(MW)"},a=[];i.value.forEach(e=>{a.push({dbtime:e.dbtime,EnvT:e.EnvT,LDT:e.LDT,EnvH:e.EnvH,WindD:e.WindD,WindS:e.WindS,YLDayE:e.YLDayE,QY:e.QY,RZDayHour:e.RZDayHour,FSD2Day:e.FSD2Day,FSD1Day:e.FSD1Day,power:e.power,prePower:e.prePower,error:e.prePower-e.power>=0?e.prePower-e.power:e.power-e.prePower||""})}),U(a,t,r.value.dateTime+"_气象功率概览")};return(t,a)=>{const e=G,l=q,p=Y,W=K,F=A,H=V,L=C,M=Z,N=z;return u(),Q("div",J,[o(N,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:n(()=>[o(H,{ref:"formRef",model:r.value,"label-placement":"left","show-feedback":!1},{default:n(()=>[o(F,{"y-gap":16,responsive:"screen","item-responsive":""},{default:n(()=>[o(W,{span:"24 s:12 m:18",label:"日期",path:"startTime"},{default:n(()=>[o(l,{"formatted-value":r.value.dateTime,"onUpdate:formattedValue":a[0]||(a[0]=_=>r.value.dateTime=_),"value-format":"yyyy-MM-dd",type:"date","onUpdate:value":T,style:{width:"200px"}},null,8,["formatted-value"]),o(s(f),{type:"primary",ghost:"",onClick:s(S),class:"mx-20px"},{icon:n(()=>[o(p,{class:"text-icon"})]),default:n(()=>[y(" "+h(s(D)("common.search")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["model"])]),"header-extra":n(()=>[m.value==="0"?(u(),g(M,{key:0,align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:n(()=>[o(s(f),{onClick:P,size:"small"},{icon:n(()=>[o(L,{class:"text-icon"})]),default:n(()=>[y(" "+h(s(D)("common.export")),1)]),_:1})]),_:1})):v("",!0)]),default:n(()=>[m.value==="0"?(u(),g(e,{key:0,columns:x,data:i.value,size:"small",loading:k.value,remote:"","row-key":_=>_.id,class:"sm:h-full","flex-height":!0,"scroll-x":""},null,8,["data","loading","row-key"])):v("",!0)]),_:1})])}}}),ce=$(O,[["__scopeId","data-v-6e78646a"]]);export{ce as default};

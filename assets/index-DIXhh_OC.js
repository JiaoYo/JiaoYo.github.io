import{_ as Y}from"./table-header-operation.vue_vue_type_script_setup_true_lang-CHHgrkPi.js";import{d as V,q as P,s as E,v as G,x as Z,b as ee,r as te,y as ae,L as F,o as I,c as W,w as t,g as e,h as M,t as O,i as a,$ as v,M as h,A as H,C as oe,D as L,B as j,E as J,ab as ne,ac as le,N as se,aa as Q,a0 as re,e as ie,ad as B,ae as ce}from"./index-CLDogeON.js";import{u as ue,a as de}from"./table-ukJTf4vp.js";import{f as me,a as pe,b as _e,c as fe}from"./basic-config-D8SzClMY.js";import{_ as he}from"./round-search-x1qTHwmk.js";import{_ as ve}from"./round-refresh-Cp7O3fiH.js";import{_ as ge}from"./FormItemGridItem-Goy6otqm.js";import{_ as be}from"./Grid-DwdJa1mK.js";import{h as K}from"./permission-ffzZUtKl.js";import{_ as we}from"./DataTable-DdVIMea-.js";import{_ as ye}from"./Popconfirm-DP16xKek.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-CQbGO1F0.js";import"./setting-outlined-DWQ5oV32.js";import"./round-delete-0fCbRQ5K.js";import"./refresh-Bx470jhd.js";import"./round-plus-DXq692fw.js";import"./Upload-T1yBX5U6.js";import"./Progress-BxxK_V6Q.js";import"./Forward-HRoZVpkx.js";const ke=V({name:"OperateDrawer",__name:"operate-drawer",props:P({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:P(["submitted"],["update:visible"]),setup(g,{emit:z}){const u=g,w=z,f=E(g,"visible"),{formRef:m,validate:N,restoreValidation:S}=G(),{defaultRequiredRule:y,patternRules:R}=Z(),k=ee(()=>({add:"新增区域",edit:"编辑区域"})[u.operateType]),o=te(D());function D(){return{id:void 0,rname:"",refer:"",ophone:"",email:"",func:"",addr:"",rdesc:""}}const U={rname:y,email:R.email,ophone:R.mobile};function C(){Object.assign(o,D()),u.operateType==="edit"&&u.rowData&&Object.assign(o,u.rowData)}function d(){f.value=!1}async function T(){var x,n;if(await N(),u.operateType==="add"){const{data:i,error:r}=await me([o]);r||((x=window.$message)==null||x.success(v("common.addSuccess")),d(),w("submitted"))}else{const{data:i,error:r}=await pe([o]);r||((n=window.$message)==null||n.success(v("common.updateSuccess")),d(),w("submitted"))}}return ae(f,()=>{f.value&&(C(),S())}),(x,n)=>{const i=H,r=oe,$=L,A=j,c=J,l=ne,b=le,p=F("no-space");return I(),W(b,{show:f.value,"onUpdate:show":n[7]||(n[7]=s=>f.value=s),"display-directive":"show",width:360},{default:t(()=>[e(l,{title:k.value,"native-scrollbar":!1,closable:""},{footer:t(()=>[e(c,{size:16},{default:t(()=>[e(A,{onClick:d},{default:t(()=>[M(O(a(v)("common.cancel")),1)]),_:1}),e(A,{type:"primary",onClick:T},{default:t(()=>[M(O(a(v)("common.confirm")),1)]),_:1})]),_:1})]),default:t(()=>[e($,{ref_key:"formRef",ref:m,model:o,rules:U},{default:t(()=>[e(r,{label:"区域名称",path:"rname"},{default:t(()=>[h(e(i,{value:o.rname,"onUpdate:value":n[0]||(n[0]=s=>o.rname=s),placeholder:"请输入区域名称",clearable:""},null,8,["value"]),[[p]])]),_:1}),e(r,{label:"简称",path:"refer"},{default:t(()=>[h(e(i,{value:o.refer,"onUpdate:value":n[1]||(n[1]=s=>o.refer=s),placeholder:"请输入简称",clearable:""},null,8,["value"]),[[p]])]),_:1}),e(r,{label:"办公电话",path:"ophone"},{default:t(()=>[h(e(i,{value:o.ophone,"onUpdate:value":n[2]||(n[2]=s=>o.ophone=s),placeholder:"请输入办公电话",clearable:""},null,8,["value"]),[[p]])]),_:1}),e(r,{label:"电子邮箱",path:"email"},{default:t(()=>[h(e(i,{value:o.email,"onUpdate:value":n[3]||(n[3]=s=>o.email=s),placeholder:"请输入电子邮箱",clearable:""},null,8,["value"]),[[p]])]),_:1}),e(r,{label:"职能",path:"func"},{default:t(()=>[h(e(i,{value:o.func,"onUpdate:value":n[4]||(n[4]=s=>o.func=s),placeholder:"请输入职能",clearable:""},null,8,["value"]),[[p]])]),_:1}),e(r,{label:"地址",path:"addr"},{default:t(()=>[h(e(i,{value:o.addr,"onUpdate:value":n[5]||(n[5]=s=>o.addr=s),placeholder:"请输入地址",clearable:""},null,8,["value"]),[[p]])]),_:1}),e(r,{label:"备注",path:"rdesc"},{default:t(()=>[h(e(i,{type:"textarea",value:o.rdesc,"onUpdate:value":n[6]||(n[6]=s=>o.rdesc=s),placeholder:"请输入备注",clearable:""},null,8,["value"]),[[p]])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),xe=V({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:P(["reset","search"],["update:model"]),setup(g,{emit:z}){const u=z,{formRef:w,restoreValidation:f}=G(),m=E(g,"model");function N(){m.value.fuzzy="",u("search")}async function S(){await f(),u("reset")}async function y(){u("search")}return(R,k)=>{const o=H,D=ge,U=ve,C=j,d=he,T=J,x=be,n=L,i=Q,r=F("no-space");return I(),W(i,{bordered:!1,size:"small",class:"card-wrapper"},{default:t(()=>[e(n,{ref_key:"formRef",ref:w,model:m.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:se(y,["enter"])},{default:t(()=>[e(x,{responsive:"screen","item-responsive":""},{default:t(()=>[e(D,{span:"24 s:12 m:6",label:"区域名称",path:"fuzzy",class:"pr-24px"},{default:t(()=>[h(e(o,{clearable:"",value:m.value.fuzzy,"onUpdate:value":k[0]||(k[0]=$=>m.value.fuzzy=$),placeholder:"请输入区域名称",onClear:N},null,8,["value"]),[[r]])]),_:1}),e(D,{span:"24 m:12",class:"pr-24px"},{default:t(()=>[e(T,{class:"w-full"},{default:t(()=>[e(C,{onClick:S},{icon:t(()=>[e(U,{class:"text-icon"})]),default:t(()=>[M(" "+O(a(v)("common.reset")),1)]),_:1}),e(C,{type:"primary",ghost:"",onClick:y},{icon:t(()=>[e(d,{class:"text-icon"})]),default:t(()=>[M(" "+O(a(v)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),De={class:"min-h-500px flex-col-stretch gap-16px overflow-auto lt-sm:overflow-auto"};function q(g){return typeof g=="function"||Object.prototype.toString.call(g)==="[object Object]"&&!ce(g)}const Ee=V({name:"assetmanagement_area",__name:"index",setup(g){const z=re(),{columns:u,columnChecks:w,data:f,getData:m,loading:N,mobilePagination:S,searchParams:y,resetSearchParams:R}=ue({apiFn:_e,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,fuzzy:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48},{key:"rname",title:"区域名称",align:"center",minWidth:200,ellipsis:!0},{key:"refer",title:"简称",align:"center",width:160,ellipsis:!0},{key:"ophone",title:"办公电话",align:"center",width:160,ellipsis:!0},{key:"email",title:"电子邮箱",align:"center",width:160,ellipsis:!0},{key:"func",title:"职能",align:"center",width:160,ellipsis:!0},{key:"addr",title:"地址",align:"center",width:160,ellipsis:!0},{key:"rdesc",title:"备注",align:"center",minWidth:200,ellipsis:!0},{key:"operate",title:v("common.operate"),align:"center",width:130,fixed:"right",render:c=>{let l;return e("div",{class:"flex-center gap-8px"},[h(e(j,{type:"primary",ghost:!0,size:"small",onClick:()=>$(c.id)},q(l=v("common.edit"))?l:{default:()=>[l]}),[[F("no-auth"),"sys.region.mengement.update"]]),e(ye,{onPositiveClick:()=>r(c.id)},{default:()=>v("common.confirmDelete"),trigger:()=>{let b;return h(e(j,{type:"error",ghost:!0,size:"small"},q(b=v("common.delete"))?b:{default:()=>[b]}),[[F("no-auth"),"sys.region.mengement.delete"]])}})])}}]}),{drawerVisible:k,operateType:o,editingData:D,handleAdd:U,handleEdit:C,checkedRowKeys:d,onBatchDeleted:T,onDeleted:x,closeDrawer:n}=de(f,m);async function i(){console.log(d.value),A(d.value.join(","),c=>{T()})}function r(c){console.log(c),A(c,l=>{x()})}function $(c){C(c)}async function A(c,l){const{data:b,error:p}=await fe(c);if(!p)l&&l(b);else return!1}return(c,l)=>{const b=Y,p=we,s=Q;return I(),ie("div",De,[e(xe,{model:a(y),"onUpdate:model":l[0]||(l[0]=_=>B(y)?y.value=_:null),onReset:a(R),onSearch:a(m)},null,8,["model","onReset","onSearch"]),e(s,{title:"区域列表",bordered:!1,size:"small",class:"sm:flex-1-hidden"},{"header-extra":t(()=>[e(b,{columns:a(w),"onUpdate:columns":l[1]||(l[1]=_=>B(w)?w.value=_:null),"disabled-delete":a(d).length===0,"is-view-add-button":a(K)("sys.region.mengement.insert"),"is-view-delete-button":a(K)("sys.region.mengement.delete"),loading:a(N),onAdd:a(U),onDelete:i,onRefresh:a(m)},null,8,["columns","disabled-delete","is-view-add-button","is-view-delete-button","loading","onAdd","onRefresh"])]),default:t(()=>[e(p,{"checked-row-keys":a(d),"onUpdate:checkedRowKeys":l[2]||(l[2]=_=>B(d)?d.value=_:null),columns:a(u),data:a(f),size:"small","flex-height":!a(z).isMobile,"scroll-x":a(u).reduce((_,X)=>_+X.width,0),loading:a(N),remote:"","row-key":_=>_.id,pagination:a(S),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","scroll-x","loading","row-key","pagination"]),e(ke,{visible:a(k),"onUpdate:visible":l[3]||(l[3]=_=>B(k)?k.value=_:null),"operate-type":a(o),"row-data":a(D),onSubmitted:a(m)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1})])}}});export{Ee as default};

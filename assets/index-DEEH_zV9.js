import{_ as Z}from"./table-header-operation.vue_vue_type_script_setup_true_lang-lWqhDriT.js";import{bz as j,d as P,n as K,s as q,p as E,q as ee,b as te,r as oe,ae as ne,D as B,o as V,c as H,w as a,g as e,h as F,t as I,i as t,$ as p,F as J,E as O,J as L,K as ae,O as W,B as U,N as Q,af as se,ag as le,ad as X,a3 as re,aA as ie,av as ce,e as ue,ah as $,ai as me,aj as pe}from"./index-CHajmsIW.js";import{u as de,a as _e}from"./table-CS3iH1Ze.js";import{_ as fe}from"./round-search-Cun_-o8q.js";import{_ as he}from"./round-refresh-DNDxt4k6.js";import{_ as ye}from"./lodash-BGV4YWIF.js";import{_ as ge}from"./FormItemGridItem-IPcz7YoU.js";import{_ as ve}from"./Grid-B6FU_crI.js";import{h as A}from"./permission-BLNDVmMO.js";import{_ as be}from"./Popconfirm-DqQ5yBH9.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-DmA2DNz2.js";import"./setting-outlined-Bl_HvWfo.js";import"./export-CHMPkwj7.js";import"./refresh-oQRX22mm.js";import"./round-delete-8baCijy4.js";import"./round-plus-DewCJPZ1.js";import"./Upload-BBEkd2cH.js";import"./Progress-DuDPg9T5.js";function we(s){return j({url:"/multiple/selectPage.do",method:"get",params:s})}function De(s){return j({url:"/multiple/insert.do",method:"post",data:s})}function ke(s){return j({url:"/multiple/update.do",method:"post",data:s})}function Ne(s){return j({url:"/multiple/delete.do",method:"get",params:{ids:s.join(",")}})}const ze=P({name:"OperateDrawer",__name:"operate-drawer",props:K({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:K(["submitted"],["update:visible"]),setup(s,{emit:C}){const i=s,h=C,d=q(s,"visible"),{formRef:u,validate:D,restoreValidation:R}=E(),{defaultRequiredRule:g}=ee(),k=te(()=>({add:"添加多元组",edit:"编辑多元组"})[i.operateType]),l=oe(v());function v(){return{tname:"",sysparam:1}}const M={tname:g};function N(){Object.assign(l,v()),i.operateType==="edit"&&i.rowData&&Object.assign(l,i.rowData)}function b(){d.value=!1}async function c(){var y,m;if(await D(),i.operateType==="add"){const{data:z,error:_}=await De([{tname:l.tname,sysparam:l.sysparam}]);_||((y=window.$message)==null||y.success(p("common.addSuccess")),b(),h("submitted"))}else{const{data:z,error:_}=await ke([{id:i.rowData.id,tname:l.tname,sysparam:l.sysparam}]);_||((m=window.$message)==null||m.success(p("common.updateSuccess")),b(),h("submitted"))}}return ne(d,()=>{d.value&&(N(),R())}),(y,m)=>{const z=L,_=ae,T=W,x=U,S=Q,o=se,n=le,r=B("no-space");return V(),H(n,{show:d.value,"onUpdate:show":m[1]||(m[1]=w=>d.value=w),"display-directive":"show",width:360},{default:a(()=>[e(o,{title:k.value,"native-scrollbar":!1,closable:""},{footer:a(()=>[e(S,{size:16},{default:a(()=>[e(x,{onClick:b},{default:a(()=>[F(I(t(p)("common.cancel")),1)]),_:1}),e(x,{type:"primary",onClick:c},{default:a(()=>[F(I(t(p)("common.confirm")),1)]),_:1})]),_:1})]),default:a(()=>[e(T,{ref_key:"formRef",ref:u,model:l,rules:M,onKeyup:J(c,["enter"])},{default:a(()=>[e(_,{label:"名称",path:"tname"},{default:a(()=>[O(e(z,{value:l.tname,"onUpdate:value":m[0]||(m[0]=w=>l.tname=w),placeholder:"请输入名称",clearable:""},null,8,["value"]),[[r]])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),xe=P({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:K(["reset","search"],["update:model"]),setup(s,{emit:C}){const i=C,{formRef:h,restoreValidation:d}=E(),u=q(s,"model");function D(){u.value.fuzzy="",i("search")}async function R(){await d(),i("reset")}async function g(){i("search")}const k=ye.debounce(g,1e3,{leading:!0,trailing:!1});return(l,v)=>{const M=L,N=ge,b=he,c=U,y=fe,m=Q,z=ve,_=W,T=X,x=B("no-space");return V(),H(T,{bordered:!1,size:"small",class:"card-wrapper"},{default:a(()=>[e(_,{ref_key:"formRef",ref:h,model:u.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:J(t(k),["enter"])},{default:a(()=>[e(z,{responsive:"screen","item-responsive":"","x-gap":12,"y-gap":12},{default:a(()=>[e(N,{span:"24 s:12 m:8 l:6",label:"名称",path:"fuzzy"},{default:a(()=>[O(e(M,{clearable:"",value:u.value.fuzzy,"onUpdate:value":v[0]||(v[0]=S=>u.value.fuzzy=S),placeholder:"请输入名称",onClear:D},null,8,["value"]),[[x]])]),_:1}),e(N,{span:"24 s:12 m:8 l:6"},{default:a(()=>[e(m,{class:"w-full"},{default:a(()=>[e(c,{onClick:R},{icon:a(()=>[e(b,{class:"text-icon"})]),default:a(()=>[F(" "+I(t(p)("common.reset")),1)]),_:1}),e(c,{type:"primary",ghost:"",onClick:t(k)},{icon:a(()=>[e(y,{class:"text-icon"})]),default:a(()=>[F(" "+I(t(p)("common.search")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","onKeyup"])]),_:1})}}}),Se={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function G(s){return typeof s=="function"||Object.prototype.toString.call(s)==="[object Object]"&&!me(s)}const He=P({name:"manage_multipegroup",__name:"index",setup(s){const C=re(),{columns:i,columnChecks:h,data:d,getData:u,loading:D,mobilePagination:R,searchParams:g,resetSearchParams:k}=de({apiFn:we,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,fuzzy:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48,disabled:o=>o.sysparam==0},{key:"tname",title:"名称",align:"center",minWidth:160,ellipsis:{tooltip:!0}},{key:"sysparam",title:"系统内置",align:"center",width:140,render:o=>{o.sysparam==null&&(o.sysparam=0);const n={0:"success",1:"info"},r=p(ie[o.sysparam]);return e(ce,{size:"small",type:n[o.sysparam]},G(r)?r:{default:()=>[r]})}},{key:"operate",title:p("common.operate"),align:"center",width:160,render:o=>{let n;return o.sysparam!=0?e("div",{class:"flex-center gap-8px"},[O(e(U,{type:"primary",ghost:!0,size:"small",onClick:()=>x(o.id)},G(n=p("common.edit"))?n:{default:()=>[n]}),[[B("no-auth"),"sys.multiple.update"]]),e(be,{onPositiveClick:()=>T(o.id)},{default:()=>p("common.confirmDelete"),trigger:()=>{let r;return O(e(U,{type:"error",ghost:!0,size:"small"},G(r=p("common.delete"))?r:{default:()=>[r]}),[[B("no-auth"),"sys.multiple.delete"]])}})]):null}}]}),{drawerVisible:l,operateType:v,editingData:M,handleAdd:N,handleEdit:b,checkedRowKeys:c,onBatchDeleted:y,onDeleted:m,closeDrawer:z}=_e(d,u);async function _(){console.log(c.value),S(c.value,o=>{y()})}function T(o){console.log(o),S([o],n=>{m()})}function x(o){b(o)}async function S(o,n){const{data:r,error:w}=await Ne(o);if(!w)n&&n(r);else return!1}return(o,n)=>{const r=Z,w=pe,Y=X;return V(),ue("div",Se,[e(xe,{model:t(g),"onUpdate:model":n[0]||(n[0]=f=>$(g)?g.value=f:null),onReset:t(k),onSearch:t(u)},null,8,["model","onReset","onSearch"]),e(Y,{title:"多元组列表",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":a(()=>[e(r,{columns:t(h),"onUpdate:columns":n[1]||(n[1]=f=>$(h)?h.value=f:null),"disabled-delete":t(c).length===0,loading:t(D),onAdd:t(N),onDelete:_,onRefresh:t(u),"is-view-add-button":t(A)("sys.multiple.insert"),"is-view-delete-button":t(A)("sys.multiple.delete")},null,8,["columns","disabled-delete","loading","onAdd","onRefresh","is-view-add-button","is-view-delete-button"])]),default:a(()=>[e(w,{"checked-row-keys":t(c),"onUpdate:checkedRowKeys":n[2]||(n[2]=f=>$(c)?c.value=f:null),columns:t(i),data:t(d),size:"small","flex-height":!t(C).isMobile,"scroll-x":962,loading:t(D),remote:"","row-key":f=>f.id,pagination:t(R),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(ze,{visible:t(l),"onUpdate:visible":n[3]||(n[3]=f=>$(l)?l.value=f:null),"operate-type":t(v),"row-data":t(M),onSubmitted:t(u)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1})])}}});export{He as default};

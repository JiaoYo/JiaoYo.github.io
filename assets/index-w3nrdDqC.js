import{_ as W}from"./table-header-operation.vue_vue_type_script_setup_true_lang-sZrXAUWR.js";import{d as I,q as A,s as q,v as G,x as X,b as Y,r as ee,y as te,K as F,o as K,c as E,w as t,g as e,h as x,t as P,i as o,$ as m,L as U,A as H,C as oe,E as Z,D as J,B as O,aa as ae,ab as ne,M as se,a9 as Q,Z as le,ar as re,am as ie,e as ce,ac as M,ad as ue}from"./index-BthjjP8Z.js";import{u as me,a as de}from"./table-DgUtF0JO.js";import{o as pe,p as _e,q as fe,r as ge}from"./log-teVTnycY.js";import{b as he,a as ye,_ as ve}from"./DataTable-DVNKf1bg.js";import{_ as be}from"./round-search-D0y4Bi99.js";import{_ as we}from"./round-refresh-7YBMJmxM.js";import{_ as De}from"./FormItemGridItem-Cf_xNcQf.js";import{_ as ke}from"./Grid-CrjQrgB8.js";import{h as L}from"./permission-DgnWzPLf.js";import{_ as Ne}from"./Popconfirm-DUBjdYuJ.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-P1qKwD6q.js";import"./setting-outlined-CB-n0fXZ.js";import"./round-delete-imzaxX0A.js";import"./refresh-516o5uee.js";import"./Upload-CXW3Rb5a.js";import"./Progress-CegqNBwu.js";import"./Forward-B9_DMOnd.js";const Se=I({name:"OperateDrawer",__name:"operate-drawer",props:A({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:A(["submitted"],["update:visible"]),setup(f,{emit:z}){const c=f,g=z,d=q(f,"visible"),{formRef:u,validate:b,restoreValidation:C}=G(),{defaultRequiredRule:h}=X(),T=Y(()=>({add:"新增日志源类别",edit:"编辑日志源类别"})[c.operateType]),s=ee(w());function w(){return{id:void 0,cname:"",sysparam:0}}const D={cname:h};function R(){Object.assign(s,w()),c.operateType==="edit"&&c.rowData&&Object.assign(s,c.rowData)}function y(){d.value=!1}async function p(){var v,r;if(await b(),c.operateType==="add"){const{data:k,error:_}=await pe([s]);_||((v=window.$message)==null||v.success(m("common.addSuccess")),y(),g("submitted"))}else{const{data:k,error:_}=await _e([s]);_||((r=window.$message)==null||r.success(m("common.updateSuccess")),y(),g("submitted"))}}return te(d,()=>{d.value&&(R(),C())}),(v,r)=>{const k=H,_=oe,N=he,S=Z,B=ye,n=J,a=O,i=ae,$=ne,V=F("no-space");return K(),E($,{show:d.value,"onUpdate:show":r[2]||(r[2]=l=>d.value=l),"display-directive":"show",width:360},{default:t(()=>[e(i,{title:T.value,"native-scrollbar":!1,closable:""},{footer:t(()=>[e(S,{size:16},{default:t(()=>[e(a,{onClick:y},{default:t(()=>[x(P(o(m)("common.cancel")),1)]),_:1}),e(a,{type:"primary",onClick:p},{default:t(()=>[x(P(o(m)("common.confirm")),1)]),_:1})]),_:1})]),default:t(()=>[e(n,{ref_key:"formRef",ref:u,model:s,rules:D},{default:t(()=>[e(_,{label:"名称",path:"cname"},{default:t(()=>[U(e(k,{clearable:"",value:s.cname,"onUpdate:value":r[0]||(r[0]=l=>s.cname=l),placeholder:"请输入名称"},null,8,["value"]),[[V]])]),_:1}),e(_,{label:"是否是系统参数"},{default:t(()=>[e(B,{value:s.sysparam,"onUpdate:value":r[1]||(r[1]=l=>s.sysparam=l),name:"radiogroup"},{default:t(()=>[e(S,null,{default:t(()=>[e(N,{value:0},{default:t(()=>[x("是")]),_:1}),e(N,{value:1},{default:t(()=>[x("否")]),_:1})]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),xe=I({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:A(["reset","search"],["update:model"]),setup(f,{emit:z}){const c=z,{formRef:g,restoreValidation:d}=G(),u=q(f,"model");function b(){u.value.fuzzy=void 0,c("search")}async function C(){await d(),c("reset")}async function h(){c("search")}return(T,s)=>{const w=H,D=De,R=we,y=O,p=be,v=Z,r=ke,k=J,_=Q,N=F("no-space");return K(),E(_,{bordered:!1,size:"small",class:"card-wrapper"},{default:t(()=>[e(k,{ref_key:"formRef",ref:g,model:u.value,"label-placement":"left","label-width":80,"show-feedback":!1,onKeyup:se(h,["enter"])},{default:t(()=>[e(r,{responsive:"screen","item-responsive":""},{default:t(()=>[e(D,{span:"24 s:12 m:6",label:"名称",path:"fuzzy",class:"pr-24px"},{default:t(()=>[U(e(w,{clearable:"",value:u.value.fuzzy,"onUpdate:value":s[0]||(s[0]=S=>u.value.fuzzy=S),placeholder:"请输入名称关键字",onClear:b},null,8,["value"]),[[N]])]),_:1}),e(D,{span:"24  s:12 m:6",class:"pr-24px"},{default:t(()=>[e(v,{class:"w-full"},{default:t(()=>[e(y,{onClick:C},{icon:t(()=>[e(R,{class:"text-icon"})]),default:t(()=>[x(" "+P(o(m)("common.reset")),1)]),_:1}),e(y,{type:"primary",ghost:"",onClick:h},{icon:t(()=>[e(p,{class:"text-icon"})]),default:t(()=>[x(" "+P(o(m)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),ze={class:"min-h-500px flex-col-stretch gap-16px overflow-auto lt-sm:overflow-auto"};function j(f){return typeof f=="function"||Object.prototype.toString.call(f)==="[object Object]"&&!ue(f)}const Ee=I({name:"logretrieval_logsourcecategory",__name:"index",setup(f){const z=le(),{columns:c,columnChecks:g,data:d,getData:u,loading:b,mobilePagination:C,searchParams:h,resetSearchParams:T}=me({apiFn:fe,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,fuzzy:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48},{key:"cname",title:"名称",align:"center",width:240},{key:"sysparam",title:"系统参数",align:"center",width:240,render:n=>{n.sysparam==null&&(n.sysparam=0);const a={0:"success",1:"error"},i=m(re[n.sysparam]);return e(ie,{size:"small",type:a[n.sysparam]},j(i)?i:{default:()=>[i]})}},{key:"operate",title:m("common.operate"),align:"center",width:130,render:n=>{let a;return n.sysparam!=0?e("div",{class:"flex-center gap-8px"},[U(e(O,{type:"primary",ghost:!0,size:"small",onClick:()=>S(n.id)},j(a=m("common.edit"))?a:{default:()=>[a]}),[[F("no-auth"),"log.source.category.update"]]),e(Ne,{onPositiveClick:()=>N(n.id)},{default:()=>m("common.confirmDelete"),trigger:()=>{let i;return U(e(O,{type:"error",ghost:!0,size:"small"},j(i=m("common.delete"))?i:{default:()=>[i]}),[[F("no-auth"),"log.source.category.delete"]])}})]):null}}]}),{drawerVisible:s,operateType:w,editingData:D,handleAdd:R,handleEdit:y,checkedRowKeys:p,onBatchDeleted:v,onDeleted:r,closeDrawer:k}=de(d,u);async function _(){console.log(p.value),B(p.value.join(","),n=>{v()})}function N(n){console.log(n),B(n,a=>{r()})}function S(n){y(n)}async function B(n,a){const{data:i,error:$}=await ge(n);if(!$)a&&a(i);else return!1}return(n,a)=>{const i=W,$=ve,V=Q;return K(),ce("div",ze,[e(xe,{model:o(h),"onUpdate:model":a[0]||(a[0]=l=>M(h)?h.value=l:null),onReset:o(T),onSearch:o(u)},null,8,["model","onReset","onSearch"]),e(V,{title:"日志源类别",bordered:!1,size:"small",class:"sm:flex-1-hidden"},{"header-extra":t(()=>[e(i,{columns:o(g),"onUpdate:columns":a[1]||(a[1]=l=>M(g)?g.value=l:null),"disabled-delete":o(p).length===0,"is-view-add-button":o(L)("log.source.category.insert"),"is-view-delete-button":o(L)("log.source.category.delete"),loading:o(b),onAdd:o(R),onDelete:_,onRefresh:o(u)},null,8,["columns","disabled-delete","is-view-add-button","is-view-delete-button","loading","onAdd","onRefresh"])]),default:t(()=>[e($,{"checked-row-keys":o(p),"onUpdate:checkedRowKeys":a[2]||(a[2]=l=>M(p)?p.value=l:null),columns:o(c),data:o(d),size:"small","flex-height":!o(z).isMobile,"scroll-x":962,loading:o(b),remote:"","row-key":l=>l.id,pagination:o(C),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(Se,{visible:o(s),"onUpdate:visible":a[3]||(a[3]=l=>M(s)?s.value=l:null),"operate-type":o(w),"row-data":o(D),onSubmitted:o(u)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1})])}}});export{Ee as default};

import{o as _,e as E,f as R,d as J,n as ae,V as Q,q as se,p as le,j as O,aV as m,aj as ie,c as M,w as o,g as t,h as u,t as U,i as a,$ as re,A as ce,ac as V,ag as de,B as $,L as X,M as ue,a2 as Y,bC as me,aN as j,z as B,y as W,r as pe,v as _e,bD as fe,bE as he,am as H}from"./index-ByQsQpYG.js";import{u as ge,a as ve}from"./table-CQrIFVLV.js";import{_ as be}from"./round-search-Dxiz62Oh.js";import{c as ye}from"./common-CLQgGQcy.js";import{_ as we}from"./FormItemGridItem-DGZImIns.js";import{_ as ke}from"./DatePicker-DP7ZHnBh.js";import{_ as xe}from"./Grid-B95GY2KH.js";import{N as I}from"./Popconfirm-BA4IjE_D.js";import{_ as Te}from"./DataTable-BmHddFa8.js";import"./TimePicker-DZc2cvhP.js";import"./Forward-L7FBmiBZ.js";import"./RadioGroup-DngHp1Rz.js";const Ce={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"},qe=R("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h12.475q.425 0 .713.288t.287.712t-.288.713t-.712.287H5v14h14v-6.5q0-.425.288-.712T20 11.5t.713.288t.287.712V19q0 .825-.587 1.413T19 21zm6.525-6.8l8.5-8.5q.275-.275.675-.275t.7.275t.3.7t-.3.725L12.225 16.3q-.3.3-.7.3t-.7-.3l-4.25-4.25q-.275-.275-.275-.7t.275-.7t.7-.275t.7.275z"},null,-1),Ne=[qe];function De(y,f){return _(),E("svg",Ce,[...Ne])}const Se={name:"material-symbols-select-check-box-rounded",render:De},ze={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"},Pe=R("path",{fill:"currentColor",d:"m12.7 11.2l-1.45-1.425q-.275-.275-.687-.275t-.713.3q-.275.275-.275.7t.275.7L12 13.35q.3.3.7.3t.7-.3l4.25-4.25q.3-.3.288-.7t-.288-.7q-.3-.3-.712-.312t-.713.287zM8 18q-.825 0-1.412-.587T6 16V4q0-.825.588-1.412T8 2h12q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm0-2h12V4H8zm-4 6q-.825 0-1.412-.587T2 20V7q0-.425.288-.712T3 6t.713.288T4 7v13h13q.425 0 .713.288T18 21t-.288.713T17 22zM8 4v12z"},null,-1),Ve=[Pe];function Be(y,f){return _(),E("svg",ze,[...Ve])}const Me={name:"material-symbols-library-add-check-outline-rounded",render:Be},Ue=J({name:"foreCastSearch",__name:"foreCastSearch",props:{model:{required:!0},modelModifiers:{}},emits:ae(["search"],["update:model"]),setup(y,{emit:f}){const h=f,L=Q(),{formRef:w,restoreValidation:g}=se(),n=le(y,"model");n.value.time=O([Number(m(5,Date.now()-864e5*3)),Number(m(5,Date.now()))]),n.value.startTime=m(1,Date.now()-864e5*3),n.value.endTime=m(1,Date.now());async function T(c,l){n.value.startTime=m(1,l[0]),n.value.endTime=m(1,l[1])}async function i(){h("search")}const C=c=>{n.value.code=c,c==8?(n.value.fcode=c,V(()=>{n.value.code=void 0})):n.value.fcode=void 0,V(()=>{h("search")})},q=O(ie(ye));q.value.splice(1,0,{label:"失败",value:8});const A=c=>{n.value.config=c,V(()=>{h("search")})};return(c,l)=>{const N=de,s=we,F=ke,G=be,d=$,k=X,D=xe,S=ue,z=Y;return _(),M(z,{bordered:!1,size:"small",class:"card-wrapper"},{default:o(()=>[t(S,{ref_key:"formRef",ref:w,model:n.value,"label-placement":"left","label-width":a(L).locale=="en-US"?120:100,"show-feedback":!1,onKeyup:ce(i,["enter"])},{default:o(()=>[t(D,{"y-gap":16,responsive:"screen","item-responsive":""},{default:o(()=>[t(s,{span:"24 s:12 m:6",label:"状态码",path:"code",class:"pr-24px"},{default:o(()=>[t(N,{filterable:"",clearable:"",placeholder:"请选择状态码",value:n.value.code,"onUpdate:value":l[0]||(l[0]=r=>n.value.code=r),style:{width:"100%"},options:q.value,onUpdateValue:C},null,8,["value","options"])]),_:1}),t(s,{span:"24 s:12 m:4",label:"状态",path:"config",class:"pr-24px"},{default:o(()=>[t(N,{filterable:"",clearable:"",placeholder:"请选择状态",value:n.value.config,"onUpdate:value":l[1]||(l[1]=r=>n.value.config=r),style:{width:"100%"},options:[{label:"已确认",value:1},{label:"未确认",value:0}],onUpdateValue:A},null,8,["value"])]),_:1}),t(s,{span:"24 s:12 m:8",label:"起止时间",path:"time",class:"pr-24px"},{default:o(()=>[t(F,{value:n.value.time,"onUpdate:value":l[2]||(l[2]=r=>n.value.time=r),type:"datetimerange","value-format":"yyyy-MM-dd hh:mm:ss",style:{width:"100%"},"onUpdate:formattedValue":T},null,8,["value"])]),_:1}),t(s,{span:"24 s:12 m:6",class:"pr-24px"},{default:o(()=>[t(k,{class:"w-full"},{default:o(()=>[t(d,{type:"primary",ghost:"",onClick:i},{icon:o(()=>[t(G,{class:"text-icon"})]),default:o(()=>[u(" "+U(a(re)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","label-width"])]),_:1})}}}),$e={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},Je=J({name:"logmanage_forecastlog",__name:"index",setup(y){const f=Q(),{columns:h,columnChecks:L,data:w,getData:g,loading:n,pagination:T,searchParams:i,resetSearchParams:C}=ge({apiFn:me,apiParams:{page:1,pageSize:20,limit:20,startTime:m(1,Date.now()-864e5*3),endTime:m(1,Date.now()),code:void 0,config:void 0,order:"1",_t:new Date().getTime()},columns:()=>[{type:"selection",width:50,align:"center",resizable:!0,disabled:e=>e.config==1||e.code==0},{key:"errormsg",title:"详细说明",minWidth:140,align:"center",resizable:!0},{key:"dbtime",title:"时间",minWidth:140,align:"center",resizable:!0,sorter:!0},{key:"code",title:"状态码",width:120,align:"center",resizable:!0,render(e){return t(j,{type:e.code===0?"success":"error"},{default:()=>[e.code==0?"成功":"失败"]})}},{key:"config",title:"操作",minWidth:140,align:"center",render(e){return e.code===0?t("span",null,[u(" ")]):e.config!==0?t(j,{type:"success"},{default:()=>[u("已确认")]}):B(t(I,{onPositiveClick:()=>D(e)},{default:()=>"确认要执行该操作吗？",trigger:()=>t($,{type:"info",ghost:!0,size:"small",disabled:e.config!==0||e.code===0},{default:()=>[u("确认")]})}),[[W("no-auth"),"power.updatePowerStatus"]])}}]}),{drawerVisible:q,operateType:A,editingData:c,handleAdd:l,handleEdit:N,checkedRowKeys:s,onBatchDeleted:F,onDeleted:G}=ve(w,g);let d=pe({total:0,uncfm:0});_e(()=>{k()});const k=async()=>{const{data:e,error:p}=await fe();d.total=(e==null?void 0:e.total)||0,d.uncfm=(e==null?void 0:e.uncfm)||0},D=async e=>{r(e.id)},S=async()=>{const e=s.value.join(",");r(e),s.value=[]},z=async()=>{r()},r=async e=>{var v;const{data:p,error:P}=await he(e?{ids:e}:void 0);if(!P){(v=window.$message)==null||v.success("确认成功"),g(),await k();const x=new CustomEvent("ErrorMsg",{detail:{uncfm:d.uncfm}});window.dispatchEvent(x)}},Z=e=>{if(e.order=="ascend"){if(i.order==null)return;i.order=void 0}else i.order="1";g()};return(e,p)=>{const P=Me,v=$,x=I,ee=Se,te=X,oe=Te,ne=Y,K=W("no-auth");return _(),E("div",$e,[t(Ue,{model:a(i),"onUpdate:model":p[0]||(p[0]=b=>H(i)?i.value=b:null),onReset:a(C),onSearch:a(g)},null,8,["model","onReset","onSearch"]),t(ne,{title:"预测日志",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":o(()=>[t(te,null,{default:o(()=>[R("span",null," 未确认/全部： "+U(a(d).uncfm)+"/"+U(a(d).total),1),B((_(),M(x,{onPositiveClick:S},{trigger:o(()=>[t(v,{size:"small",ghost:"",type:"info",disabled:a(s).length==0},{icon:o(()=>[t(P,{class:"text-icon"})]),default:o(()=>[u(" 批量确认 ")]),_:1},8,["disabled"])]),default:o(()=>[u(" 确认要确认选中的数据吗？ ")]),_:1})),[[K,"power.updatePowerStatus"]]),B((_(),M(x,{onPositiveClick:z},{trigger:o(()=>[t(v,{size:"small",ghost:"",type:"info",disabled:a(d).uncfm==0},{icon:o(()=>[t(ee,{class:"text-icon"})]),default:o(()=>[u(" 全部确认 ")]),_:1},8,["disabled"])]),default:o(()=>[u(" 确认要确认全部的数据吗？ ")]),_:1})),[[K,"power.updatePowerStatus"]])]),_:1})]),default:o(()=>[t(oe,{"checked-row-keys":a(s),"onUpdate:checkedRowKeys":p[1]||(p[1]=b=>H(s)?s.value=b:null),columns:a(h),data:a(w),size:"small","flex-height":!a(f).isMobile,"scroll-x":"",loading:a(n),remote:"","row-key":b=>b.id,pagination:a(T),class:"sm:h-full","onUpdate:sorter":Z},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1})])}}});export{Je as default};

import{d as Y,q as te,j as y,a4 as ne,v as fe,s as oe,r as W,K as ve,o as C,c as B,w as n,g as l,N as ae,L as me,i as S,$ as A,Z as _e,e as K,am as ge,h as m,t as h,f as ee,M as he,aA as Ie,ar as U,as as Q,A as ye,a2 as Se,B as J,E as le,D as be,ad as se,y as we,aq as X,ah as ie,at as xe,au as Ae,S as ke,F as Ce,T as Ee,U as De,V as re}from"./index-7Q9xZuwa.js";import{l as ue}from"./lodash-CYudMFH4.js";import{_ as Te,a as $e}from"./arrow-open-up-BX6Tp5j_.js";import{_ as ze}from"./round-search-BQOA9W6m.js";import{_ as Ne}from"./round-refresh-DJiiF7wv.js";import{a as Pe,T as Z}from"./basicconf-C0vqpl2m.js";import{b as Le,a as Ve,f as Me}from"./common-DPaMBBEl.js";import{_ as Ue}from"./Cascader-B05gdiL9.js";import{_ as Oe}from"./FormItemGridItem-DYTXkfwP.js";import{_ as Be}from"./DatePicker-CNtih3Cp.js";import{_ as Re}from"./Grid-CRtcNhSF.js";import{t as Ge,f as He,u as je}from"./events-C20QxbUR.js";import{e as Fe}from"./exportExcel-D6OyA9oJ.js";import{_ as qe}from"./originlogInfo.vue_vue_type_script_setup_true_lang-DxNl3a_S.js";import{_ as We,a as Ke}from"./DescriptionsItem-DfMvCpt5.js";import{_ as de}from"./DataTable-n3fP4Loy.js";import"./TimePicker-BYx0IEL9.js";import"./defineProperty-B4q_dn_D.js";import"./Forward-BzUEeUAa.js";import"./CollapseItem-C4YR5A1V.js";const Je=Y({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:te(["search"],["update:model"]),setup(g,{emit:D}){const T=D,i=y(!1),V=ne(),{formRef:I,restoreValidation:v}=fe(),e=oe(g,"model"),k=y();(async()=>{const{data:o,error:t}=await Le();t||(k.value=o.map(f=>({...f,id:"-"+f.id,type:f.cname})))})();const x=W({eventsTypeDataList:[],eventsCategoryData:[]});async function $(){const{data:o,error:t}=await Ve();t||(x.eventsTypeDataList=o)}$();async function z(){const{data:o,error:t}=await Me();t||(x.eventsCategoryData=o)}z();function b(){e.value.fuzzy=void 0,s()}async function M(o,t){o?(e.value.startTime=o[0],e.value.endTime=o[1]):(e.value.startTime=null,e.value.endTime=null),T("search")}async function u(){await v(),e.value.lsid=null,e.value.etype=null,e.value.elevel=null,e.value.fuzzy=null,e.value.startAndEndSendSourceIp=null,e.value.startAndEndSourceIp=null,e.value.startAndEndAimSourceIp=null,e.value.timeRange=null,e.value.ectgr=null,e.value.startSourceIp=null,e.value.endSourceIp=null,e.value.startAimIp=null,e.value.endAimIp=null,e.value.startSIp=null,e.value.endSIp=null,e.value.startTime=null,e.value.endTime=null,Ie(()=>{T("search")})}const c=()=>{e.value.startAndEndSendSourceIp=null,s()},r=()=>{e.value.startAndEndSourceIp=null,s()},w=()=>{e.value.startAndEndAimSourceIp=null,s()};async function s(){var o,t,f,d,p,a,N,P,E,L;if(e.value.startAndEndSendSourceIp&&e.value.startAndEndSendSourceIp.length>0?(e.value.startSIp=e.value.startAndEndSendSourceIp[0]||null,e.value.endSIp=e.value.startAndEndSendSourceIp[1]||null):(e.value.startSIp=null,e.value.endSIp=null),e.value.startAndEndSourceIp&&e.value.startAndEndSourceIp.length>0?(e.value.startSourceIp=e.value.startAndEndSourceIp[0]||null,e.value.endSourceIp=e.value.startAndEndSourceIp[1]||null):(e.value.startSourceIp=void 0,e.value.endSourceIp=void 0),e.value.startAndEndAimSourceIp&&e.value.startAndEndAimSourceIp.length>0?(e.value.startAimIp=e.value.startAndEndAimSourceIp[0]||null,e.value.endAimIp=e.value.startAndEndAimSourceIp[1]||null):(e.value.startAimIp=void 0,e.value.endAimIp=void 0),e.value.startSIp&&!U(e.value.startSIp)||e.value.startSourceIp&&!U(e.value.startSourceIp)||e.value.startAimIp&&!U(e.value.startAimIp))return(o=window.$message)==null||o.destroyAll(),(t=window.$message)==null||t.error("请输入正确的IP地址"),!1;if(e.value.endSIp&&!U(e.value.endSIp)||e.value.endSourceIp&&!U(e.value.endSourceIp)||e.value.endAimIp&&!U(e.value.endAimIp))return(f=window.$message)==null||f.destroyAll(),(d=window.$message)==null||d.error("请输入正确的IP地址"),!1;if(e.value.startSIp&&e.value.endSIp&&Q(e.value.startSIp,e.value.endSIp)>0)return(p=window.$message)==null||p.destroyAll(),(a=window.$message)==null||a.error("发生源起始IP不能大于发生源终止IP"),!1;if(e.value.startSourceIp&&e.value.endSourceIp&&Q(e.value.startSourceIp,e.value.endSourceIp)>0)return(N=window.$message)==null||N.destroyAll(),(P=window.$message)==null||P.error("源起始IP不能大于源终止IP"),!1;if(e.value.startAimIp&&e.value.endAimIp&&Q(e.value.startAimIp,e.value.endAimIp)>0)return(E=window.$message)==null||E.destroyAll(),(L=window.$message)==null||L.error("目的起始IP不能大于目的终止IP"),!1;T("search")}return(o,t)=>{const f=Ue,d=Oe,p=ye,a=Se,N=Be,P=Ne,E=J,L=ze,R=Te,G=$e,H=le,j=Re,F=be,q=se,ce=ve("no-space");return C(),B(q,{bordered:!1,size:"small",class:"card-wrapper"},{default:n(()=>[l(F,{ref_key:"formRef",ref:I,model:e.value,"label-placement":"left","label-width":S(V).locale=="en-US"?120:100,"show-feedback":!1,onKeyup:he(s,["enter"])},{default:n(()=>[l(j,{responsive:"screen","item-responsive":"","y-gap":12},{default:n(()=>[i.value?(C(),B(d,{key:0,span:"24 s:24 m:6",label:"日志源设备",path:"lsid",class:"pr-24px"},{default:n(()=>[l(f,{value:e.value.lsid,"onUpdate:value":[t[0]||(t[0]=_=>e.value.lsid=_),s],placeholder:"请选择日志源设备",options:k.value,"check-strategy":"child","children-field":"data","value-field":"id","label-field":"type",clearable:"",style:{width:"100%"},"show-path":!1},null,8,["value","options"])]),_:1})):ae("",!0),l(d,{span:"24 s:12 m:6",label:"事件名称",path:"fuzzy",class:"pr-24px"},{default:n(()=>[me(l(p,{value:e.value.fuzzy,"onUpdate:value":t[1]||(t[1]=_=>e.value.fuzzy=_),placeholder:"请输入事件名称",clearable:"",onClear:b},null,8,["value"]),[[ce]])]),_:1}),l(d,{span:"24 s:24 m:6",label:"事件类型",path:"etype",class:"pr-24px"},{default:n(()=>[l(a,{filterable:"",clearable:"",placeholder:"请选择事件类型",value:e.value.etype,"onUpdate:value":[t[2]||(t[2]=_=>e.value.etype=_),s],"value-field":"id","label-field":"pname",options:x.eventsTypeDataList},null,8,["value","options"])]),_:1}),l(d,{span:"24 s:12 m:6",label:S(A)("page.manage.alarm.level"),path:"elevel",class:"pr-24px"},{default:n(()=>[l(a,{filterable:"",clearable:"",placeholder:S(A)("page.manage.alarm.form.level"),value:e.value.elevel,"onUpdate:value":[t[3]||(t[3]=_=>e.value.elevel=_),s],options:S(_e)(S(Pe))},null,8,["placeholder","value","options"])]),_:1},8,["label"]),i.value?(C(),K(ge,{key:1},[l(d,{span:"24 s:24 m:8",label:"发生源IP",path:"startAndEndSendSourceIp",class:"pr-24px"},{default:n(()=>[l(p,{pair:"",separator:"-",placeholder:["发送源起始IP","发生源终止IP"],clearable:"",value:e.value.startAndEndSendSourceIp,"onUpdate:value":t[4]||(t[4]=_=>e.value.startAndEndSendSourceIp=_),onClear:r},null,8,["value"])]),_:1}),l(d,{span:"24 s:24 m:8",label:"源IP",path:"startAndEndSourceIp",class:"pr-24px"},{default:n(()=>[l(p,{pair:"",separator:"-",placeholder:["源起始IP","源终止IP"],clearable:"",value:e.value.startAndEndSourceIp,"onUpdate:value":t[5]||(t[5]=_=>e.value.startAndEndSourceIp=_),onClear:c},null,8,["value"])]),_:1}),l(d,{span:"24 s:24 m:8",label:"目的IP",path:"startAndEndAimSourceIp",class:"pr-24px"},{default:n(()=>[l(p,{pair:"",separator:"-",placeholder:["目的起始IP","目的终止IP"],clearable:"",value:e.value.startAndEndAimSourceIp,"onUpdate:value":t[6]||(t[6]=_=>e.value.startAndEndAimSourceIp=_),onClear:w},null,8,["value"])]),_:1}),l(d,{span:"24 s:12 m:8",label:"产生时间",path:"timeRange",class:"pr-24px"},{default:n(()=>[l(N,{clearable:"",value:e.value.timeRange,"onUpdate:value":t[7]||(t[7]=_=>e.value.timeRange=_),type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss",style:{width:"100%"},"onUpdate:formattedValue":M},null,8,["value"])]),_:1}),l(d,{span:"24 s:12 m:8",label:"事件类别",path:"ectgr",class:"pr-24px"},{default:n(()=>[l(a,{filterable:"",clearable:"",placeholder:"请选择事件类型",value:e.value.ectgr,"onUpdate:value":[t[8]||(t[8]=_=>e.value.ectgr=_),s],"value-field":"id","label-field":"pname",options:x.eventsCategoryData},null,8,["value","options"])]),_:1})],64)):ae("",!0),l(d,{span:"24 s:12 m:6",class:"pr-24px"},{default:n(()=>[l(H,{class:"w-full",align:"center"},{default:n(()=>[l(E,{onClick:u},{icon:n(()=>[l(P,{class:"text-icon"})]),default:n(()=>[m(" "+h(S(A)("common.reset")),1)]),_:1}),l(E,{type:"primary",ghost:"",onClick:s},{icon:n(()=>[l(L,{class:"text-icon"})]),default:n(()=>[m(" "+h(S(A)("common.search")),1)]),_:1}),ee("div",{class:"cursor-pointer",title:"精准查询",onClick:t[9]||(t[9]=_=>i.value=!i.value)},[i.value?(C(),B(R,{key:0,class:"text-icon"})):(C(),B(G,{key:1,class:"text-icon"}))])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","label-width"])]),_:1})}}}),pe=g=>(Ee("data-v-d608e3f2"),g=g(),De(),g),Ze=pe(()=>ee("span",null,"基本信息",-1)),Qe=pe(()=>ee("span",null,"原始日志信息",-1)),Xe={key:0,style:{display:"flex","justify-content":"center","align-items":"center",color:"#606266","font-size":"14px",height:"400px"}},Ye={key:1,class:"max-h-500px min-h-450px"};function el(g){return typeof g=="function"||Object.prototype.toString.call(g)==="[object Object]"&&!ie(g)}const ll=Y({__name:"detailInfo",props:te({detailInfo:{}},{detailVisible:{default:!1},detailVisibleModifiers:{}}),emits:["update:detailVisible"],setup(g){const D=oe(g,"detailVisible"),T=g,i=y();we(()=>D.value,async u=>{u&&(i.value=T.detailInfo,await e(),k())});const V=[{title:"",key:"index",width:50,render:(u,c)=>`${c+1}`},{key:"pname2",title:"事件类别",align:"center",minWidth:160,ellipsis:{tooltip:!0}},{key:"pname1",title:"事件类型",align:"center",width:140},{key:"elevel",title:"事件等级",align:"center",width:120,render:u=>{(u.elevel===void 0||u.elevel===null)&&(u.elevel=1);const c={0:"#8e9dff",1:"#5da8ff",2:"#fedc69",3:"#ff9874",4:"#ff0000"},r=A(Z[u.elevel]);let w={color:c[u.elevel],textColor:"#ffffff",borderColor:c[u.elevel]};return l(X,{size:"small",color:w},el(r)?r:{default:()=>[r]})}},{key:"sourceip",title:"发生源IP",align:"center",width:120},{key:"rtime",title:"接收时间",align:"center",width:160},{key:"operate",title:A("common.operate"),align:"center",width:80,fixed:"right",render:u=>l("div",{class:"flex-center gap-8px"},[l(J,{type:"info",ghost:!0,size:"small",onClick:()=>M(u)},{default:()=>[m("详情")]})])}],I=y(!1);let v=y([]);const e=async u=>{var w;if(!I.value)I.value=!0;else return;const{data:c,error:r}=await Ge({aggid:(w=i.value)==null?void 0:w.aggid,limit:10,pageId:u});r||(I.value=!1,u?v.value=[...v.value,...c]:v.value=c)},k=async()=>{var u,c,r;v.value.length<450/44&&v.value.length<((u=i.value)==null?void 0:u.aggre)&&e(((r=(c=v.value)==null?void 0:c[v.value.length-1])==null?void 0:r.id)??void 0)};function O(u){var r;Math.abs(u.target.scrollTop+u.target.offsetHeight-u.target.scrollHeight)<=20&&((r=i.value)==null?void 0:r.aggre)>v.value.length&&x()}const x=ue.debounce(()=>{e(v.value[v.value.length-1].id)},300),$=W({page:1,pageCount:1,pageSize:20,total:0,prefix({startIndex:u,endIndex:c,page:r,pageSize:w,pageCount:s,itemCount:o}){var t;return`已加载${v.value.length}条 共计${(t=i.value)==null?void 0:t.aggre} 条`}}),z=y(!1),b=y(),M=async u=>{z.value=!0,b.value=u};return(u,c)=>{const r=We,w=Ke,s=le,o=xe,t=de,f=Ae,d=ke,p=Ce;return C(),B(p,{show:D.value,"onUpdate:show":c[1]||(c[1]=a=>D.value=a),title:"事件详情",preset:"card",class:"w-1000px"},{default:n(()=>[l(d,{class:"max-h-600px pr-20px"},{default:n(()=>[l(f,{type:"line",animated:""},{default:n(()=>[l(o,{name:"1"},{tab:n(()=>[Ze]),default:n(()=>[l(s,{vertical:"",size:12},{default:n(()=>[l(w,{"label-placement":"left",bordered:"",column:2,"label-style":{width:"160px"}},{default:n(()=>[l(r,{label:"事件名称"},{default:n(()=>{var a;return[m(h((a=i.value)==null?void 0:a.ename),1)]}),_:1}),l(r,{label:"事件类型"},{default:n(()=>{var a;return[m(h((a=i.value)==null?void 0:a.pname1),1)]}),_:1}),l(r,{label:"事件类别"},{default:n(()=>{var a;return[m(h((a=i.value)==null?void 0:a.pname2),1)]}),_:1}),l(r,{label:"事件等级"},{default:n(()=>{var a,N,P,E,L,R,G,H,j,F;return[l(S(X),{size:"small",color:{textColor:"#ffffff",borderColor:((a=i.value)==null?void 0:a.elevel)===0?"#8e9dff":((N=i.value)==null?void 0:N.elevel)===1?"#5da8ff":((P=i.value)==null?void 0:P.elevel)===2?"#fedc69":((E=i.value)==null?void 0:E.elevel)===3?"#ff9874":((L=i.value)==null?void 0:L.elevel)===4?"#ff0000":"#5da8ff",color:((R=i.value)==null?void 0:R.elevel)===0?"#8e9dff":((G=i.value)==null?void 0:G.elevel)===1?"#5da8ff":((H=i.value)==null?void 0:H.elevel)===2?"#fedc69":((j=i.value)==null?void 0:j.elevel)===3?"#ff9874":((F=i.value)==null?void 0:F.elevel)===4?"#ff0000":"#5da8ff"}},{default:n(()=>{var q;return[m(h(S(A)(S(Z)[(q=i.value)==null?void 0:q.elevel])),1)]}),_:1},8,["color"])]}),_:1}),l(r,{label:"日志源设备"},{default:n(()=>{var a;return[m(h((a=i.value)==null?void 0:a.type),1)]}),_:1}),l(r,{label:"聚合开始时间"},{default:n(()=>{var a;return[m(h((a=i.value)==null?void 0:a.aggrestarttime),1)]}),_:1}),l(r,{label:"聚合结束时间"},{default:n(()=>{var a;return[m(h((a=i.value)==null?void 0:a.aggreendtime),1)]}),_:1}),l(r,{label:"聚合数量"},{default:n(()=>{var a;return[m(h((a=i.value)==null?void 0:a.aggre),1)]}),_:1}),l(r,{label:"发生源IP"},{default:n(()=>{var a;return[m(h((a=i.value)==null?void 0:a.sip),1)]}),_:1}),l(r,{label:"源IP"},{default:n(()=>{var a;return[m(h((a=i.value)==null?void 0:a.sourceip),1)]}),_:1}),l(r,{label:"源端口"},{default:n(()=>{var a;return[m(h((a=i.value)==null?void 0:a.sourceport),1)]}),_:1}),l(r,{label:"目的IP"},{default:n(()=>{var a;return[m(h((a=i.value)==null?void 0:a.aimip),1)]}),_:1}),l(r,{label:"目的端口"},{default:n(()=>{var a;return[m(h((a=i.value)==null?void 0:a.aimport),1)]}),_:1}),l(r,{label:"事件描述",span:3},{default:n(()=>{var a;return[m(h((a=i.value)==null?void 0:a.aimip),1)]}),_:1})]),_:1})]),_:1})]),_:1}),l(o,{name:"2"},{tab:n(()=>[Qe]),default:n(()=>[S(v).length==0?(C(),K("div",Xe," 暂无原始日志信息 ")):(C(),K("div",Ye,[l(t,{columns:V,data:S(v),size:"small","scroll-x":762,"row-key":a=>a.id,"virtual-scroll":"",class:"sm:h-full",pagination:$,onScroll:O,loading:I.value,"max-height":400,remote:""},null,8,["data","row-key","pagination","loading"])])),l(qe,{detailVisible:z.value,"onUpdate:detailVisible":c[0]||(c[0]=a=>z.value=a),detailInfo:b.value},null,8,["detailVisible","detailInfo"])]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])}}}),al=re(ll,[["__scopeId","data-v-d608e3f2"]]),tl={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function nl(g){return typeof g=="function"||Object.prototype.toString.call(g)==="[object Object]"&&!ie(g)}const ol=Y({name:"eventalarm_eventalarm",__name:"index",setup(g){const D=ne(),T=y(window.innerHeight-306),i=y(!1),V=y(),I=W({pageId:void 0,limit:100,lsid:void 0,etype:void 0,ectgr:void 0,elevel:void 0,startSIp:void 0,endSIp:void 0,startSourceIp:void 0,endSourceIp:void 0,startAimIp:void 0,endAimIp:void 0,startTime:void 0,endTime:void 0,fuzzy:void 0,_t:new Date().getTime()}),v=[{title:"",key:"index",width:80,render:(s,o)=>`${o+1}`},{key:"ename",title:"事件名称",align:"center",width:160,ellipsis:{tooltip:!0}},{key:"pname1",title:"事件类型",align:"center",width:160,ellipsis:{tooltip:!0}},{key:"aggrestarttime",title:"聚合开始时间",align:"center",width:160},{key:"pname2",title:"事件类别",align:"center",width:160,ellipsis:{tooltip:!0}},{key:"type",title:"日志源设备",align:"center",width:160,ellipsis:{tooltip:!0}},{key:"elevel",title:"事件等级",align:"center",width:120,render:s=>{(s.elevel===void 0||s.elevel===null)&&(s.elevel=1);const o={0:"#8e9dff",1:"#5da8ff",2:"#fedc69",3:"#ff9874",4:"#ff0000"},t=A(Z[s.elevel]);let f={color:o[s.elevel],textColor:"#ffffff",borderColor:o[s.elevel]};return l(X,{size:"small",color:f},nl(t)?t:{default:()=>[t]})}},{key:"aggre",title:"聚合数量",align:"center",width:120},{key:"sip",title:"发生源IP",align:"center",width:160},{key:"aggreendtime",title:"聚合结束时间",align:"center",width:160},{key:"operate",title:A("common.operate"),align:"center",width:100,fixed:"right",render:s=>l("div",{class:"flex-center gap-8px"},[l(J,{type:"primary",ghost:!0,size:"small",onClick:()=>r(s)},{default:()=>[m("查看")]})])}],e=y([]),k=y(!1),O=y(0),x=async(s=!1)=>{if(!k.value)k.value=!0;else return;const{data:o,error:t}=await He(I);t||(O.value=o.length,s?e.value=[...e.value,...o]:e.value=o,k.value=!1)};x();const $=y(!0),z=()=>{e.value=[],I.pageId=void 0,(o=>Object.keys(o).filter(d=>d!=="limit"&&d!=="_t").some(d=>o[d]!==void 0&&o[d]!==""&&o[d]!==null))(I)?$.value=!1:($.value=!0,M()),x()},b=W({page:1,pageCount:1,pageSize:20,total:0,prefix({startIndex:s,endIndex:o,page:t,pageSize:f,pageCount:d,itemCount:p}){return`已加载${e.value.length}条`+(e.value.length?$.value?` 共计 ${e.value.length>0?p??0:0} 条`:O.value==I.limit?"  预计还有更多":"  没有更多了":"")}});async function M(){const{data:s,error:o}=await je();o||(b.pageCount=20,b.total=Number(s),b.itemCount=Number(s))}M();function u(s){Math.abs(s.target.scrollTop+s.target.offsetHeight-s.target.scrollHeight)<=20&&b.total>e.value.length&&c()}const c=ue.debounce(()=>{var s;((s=e.value)==null?void 0:s.length)<b.total&&(I.pageId=e.value[e.value.length-1].id,x(!0))},300);async function r(s){V.value=s,i.value=!0}async function w(){if(!e.value.length)return;const s=JSON.parse(JSON.stringify(e.value)),o=[];s.forEach(f=>{const d={};v.forEach(p=>{if(f.hasOwnProperty(p.key)){const a=p.key=="elevel"?A(Z[f[p.key]]):f[p.key];d[p.title]=a}}),o.push(d)}),Fe(o,500,[{wpx:100},{wpx:100},{wpx:100},{wpx:100},{wpx:100},{wpx:100},{wpx:50},{wpx:100},{wpx:150}],"安全事件_"+new Date().getTime())}return(s,o)=>{const t=le,f=de,d=se;return C(),K("div",tl,[l(Je,{model:I,"onUpdate:model":o[0]||(o[0]=p=>I=p),onSearch:z},null,8,["model"]),l(d,{title:"安全事件",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":n(()=>[l(t,null,{default:n(()=>[l(S(J),{type:"primary",size:"small",ghost:"",onClick:w,title:"导出已加载"},{default:n(()=>[m("导出已加载")]),_:1})]),_:1})]),default:n(()=>[l(f,{columns:v,data:e.value,size:"small","flex-height":!S(D).isMobile,loading:k.value,remote:"","scroll-x":v.reduce((p,a)=>p+a.width,0),"row-key":p=>p.id,pagination:b,"virtual-scroll":"",onScroll:u,class:"sm:h-full","max-height":T.value},null,8,["data","flex-height","loading","scroll-x","row-key","pagination","max-height"])]),_:1}),l(al,{detailVisible:i.value,"onUpdate:detailVisible":o[1]||(o[1]=p=>i.value=p),detailInfo:V.value},null,8,["detailVisible","detailInfo"])])}}}),kl=re(ol,[["__scopeId","data-v-6c6a327a"]]);export{kl as default};

import{r as X,a as x,i as Y,j as Z,d as z,k as ee,u as M,l as A,m as S,n as j,p as oe,q as ne,c as L,o as R,w as c,f as a,s as E,v as H,x as O,y as q,h as l,$ as r,z as T,e as b,A as ae,g as N,t as P,B as V,C as K,D as se,E as J,F as le,G as te,R as re,H as de,I as ie,J as ce,K as ue,L as F,M as pe,N as me,b as ge,T as fe,O as we,P as _e,Q as ve}from"./index-BAR0HjRB.js";function he(m){const t=X(0),w=x(()=>Math.ceil(t.value)),C=x(()=>t.value>0),{pause:n,resume:g}=Y(({delta:e})=>{if(t.value<=0){t.value=0,n();return}const y=e/1e3;t.value-=y,t.value<=0&&(t.value=0,n())},{immediate:!1});function d(e=m){t.value=e,g()}function f(){t.value=0,n()}return Z(()=>{n()}),{count:w,isCounting:C,start:d,stop:f}}/*! js-cookie v3.0.5 | MIT */function U(m){for(var t=1;t<arguments.length;t++){var w=arguments[t];for(var C in w)m[C]=w[C]}return m}var Ce={read:function(m){return m[0]==='"'&&(m=m.slice(1,-1)),m.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(m){return encodeURIComponent(m).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function D(m,t){function w(n,g,d){if(!(typeof document>"u")){d=U({},t,d),typeof d.expires=="number"&&(d.expires=new Date(Date.now()+d.expires*864e5)),d.expires&&(d.expires=d.expires.toUTCString()),n=encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var f="";for(var e in d)d[e]&&(f+="; "+e,d[e]!==!0&&(f+="="+d[e].split(";")[0]));return document.cookie=n+"="+m.write(g,n)+f}}function C(n){if(!(typeof document>"u"||arguments.length&&!n)){for(var g=document.cookie?document.cookie.split("; "):[],d={},f=0;f<g.length;f++){var e=g[f].split("="),y=e.slice(1).join("=");try{var v=decodeURIComponent(e[0]);if(d[v]=m.read(y,v),n===v)break}catch{}}return n?d[n]:d}}return Object.create({set:w,get:C,remove:function(n,g){w(n,"",U({},g,{expires:-1}))},withAttributes:function(n){return D(this.converter,U({},this.attributes,n))},withConverter:function(n){return D(U({},this.converter,n),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(m)}})}var Q=D(Ce,{path:"/"});const B=(m,t,w)=>{Q.set(m,t)},$=m=>Q.get(m),ye={class:"flex-y-center justify-between"},ke=z({name:"PwdLogin",__name:"pwd-login",setup(m){const t=ee();M();const{formRef:w,validate:C}=A(),n=S({username:"",password:""}),g=S({uuid:"",checked:!1});x(()=>{const{formRules:s}=j();return{username:s.username,password:s.loginPassword}});const d={};async function f(){await C(),g.checked?e(n.username,n.password,g.checked):v(),g.uuid=se(),await t.login(n.username.trim(),n.password.trim(),g.uuid)}function e(s,o,u){B("energy_storage_user",s),B("energy_storage_pwd",o),B("energy_storage_check",String(u))}function y(){n.username=$("energy_storage_user")||"",n.password=$("energy_storage_pwd")||"",g.checked=$("energy_storage_check")?$("energy_storage_check")=="true":!1}function v(){e("","",!1)}return oe(()=>{y()}),(s,o)=>{const u=O,i=E,_=ae,h=V,k=T,p=K,G=ne("no-space");return R(),L(p,{ref_key:"formRef",ref:w,model:n,rules:d,size:"large","show-label":!1},{default:c(()=>[a(i,{path:"username"},{default:c(()=>[H(a(u,{value:n.username,"onUpdate:value":o[0]||(o[0]=I=>n.username=I),placeholder:l(r)("page.login.common.userNamePlaceholder"),onKeyup:q(f,["enter"]),maxlength:16},null,8,["value","placeholder"]),[[G]])]),_:1}),a(i,null,{default:c(()=>[H(a(u,{autocomplete:"off",value:n.password,"onUpdate:value":o[1]||(o[1]=I=>n.password=I),type:"password","show-password-on":"click",minlength:6,maxlength:18,placeholder:l(r)("page.login.common.passwordPlaceholder"),onKeyup:q(f,["enter"])},null,8,["value","placeholder"]),[[G]])]),_:1}),a(k,{vertical:"",size:24},{default:c(()=>[b("div",ye,[a(_,{checked:g.checked,"onUpdate:checked":o[2]||(o[2]=I=>g.checked=I)},{default:c(()=>[N(P(l(r)("page.login.pwdLogin.rememberMe")),1)]),_:1},8,["checked"])]),a(h,{type:"primary",size:"large",ghost:"",round:"",block:"",loading:l(t).loginLoading,onClick:f},{default:c(()=>[N(P(l(r)("common.confirm")),1)]),_:1},8,["loading"]),o[3]||(o[3]=b("div",{style:{display:"flex","justify-content":"right","align-items":"center"}},null,-1))]),_:1,__:[3]})]),_:1},8,["model"])}}}),be=J(ke,[["__scopeId","data-v-1990cbf5"]]);function W(){const{loading:m,startLoading:t,endLoading:w}=le(),{count:C,start:n,stop:g,isCounting:d}=he(60),f=x(()=>{let v=r("page.login.codeLogin.getCode");const s=r("page.login.codeLogin.reGetCode",{time:C.value});return m.value&&(v=""),d.value&&(v=s),v});function e(v){var s,o,u,i,_,h;return v.trim()===""?((s=window.$message)==null||s.destroyAll(),(u=(o=window.$message)==null?void 0:o.error)==null||u.call(o,r("form.mobile.required")),!1):re.test(v)?!0:((i=window.$message)==null||i.destroyAll(),(h=(_=window.$message)==null?void 0:_.error)==null||h.call(_,r("form.mobile.invalid")),!1)}async function y(v,s){!e(v)||m.value||(t(),await new Promise(u=>{te(v,s).then(i=>{var _,h,k;console.log("response",i),i.error||(setTimeout(u,500),(_=window.$message)==null||_.destroyAll(),(k=(h=window.$message)==null?void 0:h.success)==null||k.call(h,r("page.login.codeLogin.sendCodeSuccess")),n(),w())}).catch(i=>{var _,h,k;return console.log("error",i),(_=window.$message)==null||_.destroyAll(),(k=(h=window.$message)==null?void 0:h.error)==null||k.call(h,r("page.login.codeLogin.sendCodeFailed")),!1})}))}return{label:f,start:n,stop:g,isCounting:d,loading:m,getCaptcha:y}}const xe={class:"w-full flex-y-center gap-16px"},Pe=z({name:"CodeLogin",__name:"register",setup(m){const{toggleLoginModule:t}=M(),{formRef:w,validate:C}=A(),{label:n,isCounting:g,loading:d,getCaptcha:f}=W(),e=S({deptName:"",username:"",email:"",mobile:"",code:"",password:"",confirmPassword:"",status:1,deptId:0,pid:0,roleIdList:["1147694289157566466"]}),y=x(()=>{const{formRules:s,createConfirmPwdRule:o}=j();return{deptName:s.deptName,username:s.username,email:s.email,mobile:s.mobile,code:s.code,password:s.password,confirmPassword:o(e.password),status:s.status,deptId:s.deptId,pid:s.pid,roleIdList:s.roleIdList}});async function v(){var u,i;await C();const{data:s,error:o}=await de(e.username,e.username,e.deptName,e.email,e.mobile,e.code,e.password,e.confirmPassword,e.status,e.deptId,e.pid,e.roleIdList);console.log("data",s),o?(i=window.$message)==null||i.error(r("page.login.common.validateFail")):((u=window.$message)==null||u.success(r("page.login.common.validateSuccess")),t("pwd-login"))}return(s,o)=>{const u=O,i=E,_=V,h=T,k=K;return R(),L(k,{ref_key:"formRef",ref:w,model:e,rules:y.value,size:"large","show-label":!1},{default:c(()=>[a(i,{path:"deptName"},{default:c(()=>[a(u,{value:e.deptName,"onUpdate:value":o[0]||(o[0]=p=>e.deptName=p),placeholder:l(r)("page.login.common.deptNamePlaceholder")},null,8,["value","placeholder"])]),_:1}),a(i,{path:"username"},{default:c(()=>[a(u,{value:e.username,"onUpdate:value":o[1]||(o[1]=p=>e.username=p),placeholder:l(r)("page.login.common.userNamePlaceholder")},null,8,["value","placeholder"])]),_:1}),a(i,null,{default:c(()=>[a(u,{value:e.email,"onUpdate:value":o[2]||(o[2]=p=>e.email=p),placeholder:l(r)("page.login.common.emailPlaceholder")},null,8,["value","placeholder"])]),_:1}),a(i,{path:"mobile"},{default:c(()=>[a(u,{value:e.mobile,"onUpdate:value":o[3]||(o[3]=p=>e.mobile=p),placeholder:l(r)("page.login.common.mobilePlaceholder"),maxlength:11},null,8,["value","placeholder"])]),_:1}),a(i,{path:"code"},{default:c(()=>[b("div",xe,[a(u,{value:e.code,"onUpdate:value":o[4]||(o[4]=p=>e.code=p),placeholder:l(r)("page.login.common.codePlaceholder")},null,8,["value","placeholder"]),a(_,{size:"large",disabled:l(g),loading:l(d),onClick:o[5]||(o[5]=p=>l(f)(e.mobile,0))},{default:c(()=>[N(P(l(n)),1)]),_:1},8,["disabled","loading"])])]),_:1}),a(i,{path:"password"},{default:c(()=>[a(u,{value:e.password,"onUpdate:value":o[6]||(o[6]=p=>e.password=p),type:"password","show-password-on":"click",placeholder:l(r)("page.login.common.passwordPlaceholder")},null,8,["value","placeholder"])]),_:1}),a(i,{path:"confirmPassword"},{default:c(()=>[a(u,{value:e.confirmPassword,"onUpdate:value":o[7]||(o[7]=p=>e.confirmPassword=p),type:"password","show-password-on":"click",placeholder:l(r)("page.login.common.confirmPasswordPlaceholder")},null,8,["value","placeholder"])]),_:1}),a(h,{vertical:"",size:18,class:"w-full"},{default:c(()=>[a(_,{type:"primary",size:"large",round:"",block:"",onClick:v},{default:c(()=>[N(P(l(r)("common.confirm")),1)]),_:1}),a(_,{size:"large",round:"",block:"",onClick:o[8]||(o[8]=p=>l(t)("pwd-login"))},{default:c(()=>[N(P(l(r)("page.login.common.back")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])}}}),Ne={class:"w-full flex-y-center gap-16px"},Ie=z({name:"ResetPwd",__name:"reset-pwd",setup(m){const{toggleLoginModule:t}=M(),{formRef:w,validate:C}=A(),{label:n,isCounting:g,loading:d,getCaptcha:f}=W(),e=S({username:"",mobile:"",code:"",password:"",confirmPassword:""}),y=x(()=>{const{formRules:s,createConfirmPwdRule:o}=j();return{username:s.username,mobile:s.mobile,password:s.password,code:s.code,confirmPassword:o(e.password)}});async function v(){var u,i;await C();const{data:s,error:o}=await ie(e.username,e.mobile,e.code,e.password,e.confirmPassword);console.log("data",s),o?(i=window.$message)==null||i.error(r("page.login.common.validateFail")):((u=window.$message)==null||u.success(r("page.login.common.validateSuccess")),t("pwd-login"))}return(s,o)=>{const u=O,i=E,_=V,h=T,k=K;return R(),L(k,{ref_key:"formRef",ref:w,model:e,rules:y.value,size:"large","show-label":!1},{default:c(()=>[a(i,{path:"username"},{default:c(()=>[a(u,{value:e.username,"onUpdate:value":o[0]||(o[0]=p=>e.username=p),placeholder:l(r)("page.login.common.userNamePlaceholder")},null,8,["value","placeholder"])]),_:1}),a(i,{path:"mobile"},{default:c(()=>[a(u,{value:e.mobile,"onUpdate:value":o[1]||(o[1]=p=>e.mobile=p),placeholder:l(r)("page.login.common.mobilePlaceholder")},null,8,["value","placeholder"])]),_:1}),a(i,{path:"code"},{default:c(()=>[b("div",Ne,[a(u,{value:e.code,"onUpdate:value":o[2]||(o[2]=p=>e.code=p),placeholder:l(r)("page.login.common.codePlaceholder")},null,8,["value","placeholder"]),a(_,{size:"large",disabled:l(g),loading:l(d),onClick:o[3]||(o[3]=p=>l(f)(e.mobile,1))},{default:c(()=>[N(P(l(n)),1)]),_:1},8,["disabled","loading"])])]),_:1}),a(i,{path:"password"},{default:c(()=>[a(u,{value:e.password,"onUpdate:value":o[4]||(o[4]=p=>e.password=p),type:"password","show-password-on":"click",placeholder:l(r)("page.login.common.passwordPlaceholder")},null,8,["value","placeholder"])]),_:1}),a(i,{path:"confirmPassword"},{default:c(()=>[a(u,{value:e.confirmPassword,"onUpdate:value":o[5]||(o[5]=p=>e.confirmPassword=p),type:"password","show-password-on":"click",placeholder:l(r)("page.login.common.confirmPasswordPlaceholder")},null,8,["value","placeholder"])]),_:1}),a(h,{vertical:"",size:18,class:"w-full"},{default:c(()=>[a(_,{type:"primary",size:"large",round:"",block:"",onClick:v},{default:c(()=>[N(P(l(r)("common.confirm")),1)]),_:1}),a(_,{size:"large",round:"",block:"",onClick:o[6]||(o[6]=p=>l(t)("pwd-login"))},{default:c(()=>[N(P(l(r)("page.login.common.back")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])}}}),Re={class:"w-400px lt-sm:w-300px"},Ue={class:"flex-y-center justify-center"},$e={class:"text-28px text-primary font-500 lt-sm:text-22px"},Se={class:"pt-24px"},ze={class:"pt-24px"},Le=z({name:"login",__name:"index",props:{module:{}},setup(m){const t=m;ce();const w=ue(),C={"pwd-login":{label:F["pwd-login"],component:be},register:{label:F.register,component:Pe},"reset-pwd":{label:F["reset-pwd"],component:Ie}},n=x(()=>C[t.module||"pwd-login"]);x(()=>w.darkMode?pe(w.themeColor,600):w.themeColor);const g=x(()=>{const d="#ffffff",f=w.darkMode?.5:.2;return me(d,w.themeColor,f)});return(d,f)=>{const e=_e;return R(),ge("div",{class:"relative size-full flex-center overflow-hidden login",style:ve({backgroundColor:g.value})},[a(e,{bordered:!1,class:"relative z-4 w-auto rd-12px loginClass"},{default:c(()=>[b("div",Re,[b("header",Ue,[b("h3",$e,P(l(r)("system.title")),1)]),b("main",Se,[b("div",ze,[a(fe,{name:l(w).page.animateMode,mode:"out-in",appear:""},{default:c(()=>[(R(),L(we(n.value.component)))]),_:1},8,["name"])])])])]),_:1}),f[0]||(f[0]=b("div",{style:{position:"fixed",right:"20px",top:"20px",color:"#fff","font-size":"1.2rem","z-index":"999"}},"V1.0.10 ",-1))],4)}}}),Be=J(Le,[["__scopeId","data-v-2ab6c116"]]);export{Be as default};

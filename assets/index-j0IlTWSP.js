import{_ as E}from"./export-DQRIj4KV.js";import{d as O,n as A,s as M,o as C,c as P,w as n,g as a,i as t,$ as o,W as R,c2 as j,h as S,t as q,Z as U,B as T,N as $,O as W,ad as B,a3 as G,b0 as y,c3 as D,av as L,j as F,D as V,e as I,aC as Z,E as H,aG as J,au as K}from"./index-FKKSWlZs.js";import{d as Q,e as X}from"./system-log-CZa6Sakt.js";import{u as Y}from"./table-CSyR0TzJ.js";import{_ as ee,a as te,b as oe}from"./lodash-YkbCJgJ0.js";import{_ as ae}from"./round-refresh-BFeEk6QU.js";import{_ as ne}from"./Grid-DmN9YdMU.js";const se=O({name:"OptionlogSearch",__name:"optionlog-search",props:{model:{required:!0},modelModifiers:{}},emits:A(["reset","search"],["update:model"]),setup(p,{expose:b,emit:_}){const x=_,u=M(p,"model");function g(){x("reset")}function h(){x("search")}async function w(){const{data:f,error:r}=await Q({status:u.value.status});if(!r){let d=f,e=new Blob([d],{type:"application/vnd.ms-excel"}),i=new Date().getTime()+".xls",s=window.webkitURL.createObjectURL(e),l=document.createElement("a");l.href=s,l.download=i,document.body.appendChild(l),l.click(),l.remove()}}const m=ee.debounce(h,1e3,{leading:!0,trailing:!1});return b({handleExportChange:w}),(f,r)=>{const d=U,e=te,i=ae,s=T,l=oe,k=$,v=ne,N=W,c=B;return C(),P(c,{bordered:!1,size:"small",class:"card-wrapper"},{default:n(()=>[a(N,{model:u.value,"label-placement":"left","label-width":80,"show-feedback":!1},{default:n(()=>[a(v,{responsive:"screen","item-responsive":"","x-gap":12,"y-gap":12},{default:n(()=>[a(e,{span:"24 s:12 m:8 l:6",label:t(o)("page.systemlog.option.status"),path:"status"},{default:n(()=>[a(d,{filterable:"",clearable:"",value:u.value.status,"onUpdate:value":[r[0]||(r[0]=z=>u.value.status=z),h],placeholder:t(o)("page.systemlog.option.form.status"),options:t(R)(t(j)),onClear:g},null,8,["value","placeholder","options"])]),_:1},8,["label"]),a(e,{span:"24 s:12 m:8 l:6"},{default:n(()=>[a(k,{class:"w-full"},{default:n(()=>[a(s,{onClick:g},{icon:n(()=>[a(i,{class:"text-icon"})]),default:n(()=>[S(" "+q(t(o)("common.reset")),1)]),_:1}),a(s,{type:"primary",ghost:"",onClick:t(m)},{icon:n(()=>[a(l,{class:"text-icon"})]),default:n(()=>[S(" "+q(t(o)("common.search")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),le={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function ie(p){return typeof p=="function"||Object.prototype.toString.call(p)==="[object Object]"&&!J(p)}const ge=O({name:"logmanage_optionlog",__name:"index",setup(p){const b=G(),{columns:_,columnChecks:x,data:u,getData:g,loading:h,pagination:w,searchParams:m,resetSearchParams:f}=Y({apiFn:X,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,status:null,_t:new Date().getTime()},columns:()=>[{key:"creatorName",title:o("page.systemlog.option.creatorName"),align:"center",width:160,resizable:!0},{key:"operation",title:o("page.systemlog.option.operation"),width:140,align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"requestUri",title:o("page.systemlog.option.requestUri"),width:160,align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"requestMethod",title:o("page.systemlog.option.requestMethod"),width:100,align:"center"},{key:"requestParams",title:o("page.systemlog.option.requestParams"),width:180,align:"center",resizable:!0,render(e){return y(D,{tooltipPlacement:"center",style:{maxWidth:"180px"}},{default:()=>e.requestParams||"",tooltip:()=>y("div",{style:{textAlign:"center",padding:"8px",maxWidth:"600px"}},e.requestParams||"")})}},{key:"requestTime",title:o("page.systemlog.option.requestTime")+"(ms)",width:120,align:"center",resizable:!0},{key:"status",title:o("page.systemlog.option.status"),width:100,align:"center",render:e=>{e.status==null&&(e.status=0);const i={0:"error",1:"primary"},s=o(j[e.status].label);return a(L,{size:"small",type:i[e.status]},ie(s)?s:{default:()=>[s]})},resizable:!0},{key:"ip",title:o("page.systemlog.option.ip"),width:160,align:"center",resizable:!0},{key:"userAgent",title:o("page.systemlog.option.userAgent"),width:180,align:"center",render(e){return y(D,{tooltipPlacement:"center",style:{maxWidth:"180px"}},{default:()=>e.userAgent||"",tooltip:()=>y("div",{style:{textAlign:"center",padding:"8px",maxWidth:"600px"}},e.userAgent||"")})},resizable:!0},{key:"subject",title:"客体",width:160,align:"center",ellipsis:{tooltip:!0},render(e){return a("span",null,[e.subject=="null"?"":e.subject])},resizable:!0},{key:"createDate",title:o("page.systemlog.option.createDate"),width:160,align:"center"}]}),r=F(),d=()=>{r.value.handleExportChange()};return(e,i)=>{const s=E,l=T,k=K,v=B,N=V("no-auth");return C(),I("div",le,[a(se,{model:t(m),"onUpdate:model":i[0]||(i[0]=c=>Z(m)?m.value=c:null),onReset:t(f),onSearch:t(g),ref_key:"searchRef",ref:r},null,8,["model","onReset","onSearch"]),a(v,{title:t(o)("page.systemlog.option.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":n(()=>[H((C(),P(l,{type:"info",size:"small",ghost:"",onClick:d},{icon:n(()=>[a(s,{class:"text-icon"})]),default:n(()=>[S(" "+q(t(o)("common.export")),1)]),_:1})),[[N,"sys:log:operation.export"]])]),default:n(()=>[a(k,{columns:t(_),data:t(u),size:"small","flex-height":!t(b).isMobile,"scroll-x":t(_).reduce((c,z)=>c+z.width,0),loading:t(h),remote:"","row-key":c=>c.id,pagination:t(w),class:"sm:h-full"},null,8,["columns","data","flex-height","scroll-x","loading","row-key","pagination"])]),_:1},8,["title"])])}}});export{ge as default};

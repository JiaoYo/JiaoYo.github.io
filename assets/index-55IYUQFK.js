import{j as $,b as P,k as fe,l as _e,d as B,m as ae,u as he,a as G,n as W,r as j,p as X,q as re,s as O,v as we,x as ve,y as ye,z as be,A as le,C as Ce,o as L,c as z,w as m,g as n,D as te,i as c,$ as g,E as q,f as i,F as xe,h as E,G as ke,t as R,H as Se,I as H,J,S as Pe,K as Re,L as Ue,B as Q,M as Y,N as Z,O as Ie,P as Ne,Q as ee,R as $e,T as Le,U as Ee,V as ze,W as Fe,X as Me,Y as je,Z as Be,a0 as A,a1 as De,a2 as Te,a3 as Oe,a4 as qe,a5 as Ae,a6 as Ve,e as Ke,a7 as Ge,a8 as We,a9 as Xe,aa as V,ab as He,ac as Je}from"./index-DLQv0xE2.js";import{d as Qe}from"./debounce-Dv9JIJE-.js";function Ye(l){const d=$(0),C=P(()=>Math.ceil(d.value/60)),u=P(()=>d.value>0),{pause:e,resume:a}=fe(()=>{d.value>0?d.value-=1:e()},{immediate:!1});function h(k=l){d.value=60*k,a()}function t(){d.value=0,e()}return _e(()=>{e()}),{count:C,isCounting:u,start:h,stop:t}}/*! js-cookie v3.0.5 | MIT */function M(l){for(var _=1;_<arguments.length;_++){var d=arguments[_];for(var C in d)l[C]=d[C]}return l}var Ze={read:function(l){return l[0]==='"'&&(l=l.slice(1,-1)),l.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(l){return encodeURIComponent(l).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function K(l,_){function d(u,e,a){if(!(typeof document>"u")){a=M({},_,a),typeof a.expires=="number"&&(a.expires=new Date(Date.now()+a.expires*864e5)),a.expires&&(a.expires=a.expires.toUTCString()),u=encodeURIComponent(u).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var h="";for(var t in a)a[t]&&(h+="; "+t,a[t]!==!0&&(h+="="+a[t].split(";")[0]));return document.cookie=u+"="+l.write(e,u)+h}}function C(u){if(!(typeof document>"u"||arguments.length&&!u)){for(var e=document.cookie?document.cookie.split("; "):[],a={},h=0;h<e.length;h++){var t=e[h].split("="),k=t.slice(1).join("=");try{var f=decodeURIComponent(t[0]);if(a[f]=l.read(k,f),u===f)break}catch{}}return u?a[u]:a}}return Object.create({set:d,get:C,remove:function(u,e){d(u,"",M({},e,{expires:-1}))},withAttributes:function(u){return K(this.converter,M({},this.attributes,u))},withConverter:function(u){return K(M({},this.converter,u),this.attributes)}},{attributes:{value:Object.freeze(_)},converter:{value:Object.freeze(l)}})}var ie=K(Ze,{path:"/"});const eo=(l,_,d)=>{ie.set(l,_)},oo=l=>ie.get(l),x=l=>(Ie("data-v-6b3a1c20"),l=l(),Ne(),l),to={class:"w-full flex-y-center gap-16px"},so=["src"],no={class:"flex-y-center justify-between"},ao={class:"agreement-container"},ro=x(()=>i("h2",null,"用户协议",-1)),lo={class:"agreement-content"},io=x(()=>i("h3",null,"1. 协议的接受",-1)),co=x(()=>i("p",null,"在登录之前，您必须阅读并同意本协议的全部内容。点击“同意”按钮，即表示您已详细阅读并理解本协议，并同意受其约束。",-1)),uo=x(()=>i("h3",null,"2. 用户信息的使用",-1)),po=x(()=>i("p",null,"您同意并授权本系统在合法合规的前提下，使用您的用户信息以提供相关服务，包括但不限于：",-1)),mo=x(()=>i("ul",null,[i("li",null,"查询个人账户信息；"),i("li",null,"修改个人资料，如联系方式、密码等；"),i("li",null,"保障账户安全，防止未经授权的访问或篡改。")],-1)),go=x(()=>i("h3",null,"3. 用户责任",-1)),fo=x(()=>i("p",null,"您保证所提供的所有信息真实、准确、完整，并对您的账户安全负全部责任。",-1)),_o=x(()=>i("p",null,"不得冒用他人身份或提供虚假信息，否则系统有权拒绝提供服务，并依法追究责任。",-1)),ho=x(()=>i("h3",null,"4. 隐私保护",-1)),wo=x(()=>i("p",null,"我们承诺严格保护您的个人隐私，不会泄露或滥用您的个人信息，除非法律法规另有规定或获得您的明确授权。",-1)),vo=x(()=>i("h3",null,"5. 协议变更",-1)),yo=x(()=>i("p",null,"本协议可能会不定期更新，更新后的协议一旦发布即自动生效。如果您继续使用本系统的查询和修改功能，即视为接受新的协议内容。",-1)),bo=x(()=>i("h3",null,"6. 其他",-1)),Co=x(()=>i("p",null,"如对本协议有任何疑问，您可联系系统管理员获取进一步解释。",-1)),xo=B({name:"PwdLogin",__name:"pwd-login",props:{status:{type:String,required:!0},statusModifiers:{}},emits:ae(["getUsername"],["update:status"]),setup(l,{emit:_}){const d=he();G();const{formRef:C,validate:u}=W();$(!1);const e=j({username:"",password:"",captcha:""}),a=j({uuid:"",checked:!1,captchaEnable:0,captchaSrc:""}),{formRules:h,patternRules:t,defaultRequiredRule:k}=X(),f={username:h.username,password:{required:!0,trigger:["input","blur"],message:"密码不能为空"},captcha:h.captcha},o=Qe(()=>{s()},1e3);async function s(){var b;if(await u(),!r.value)return(b=window.$message)==null?void 0:b.warning("请阅读并同意用户协议");eo(e.username+"log_isokAgreement","true"),await d.login(e.username,e.password,a.uuid,e.captcha.trim())=="fail"&&a.captchaEnable==1&&(e.captcha="",y())}const r=$(!1),p=U=>{r.value=oo(e.username+"log_isokAgreement")=="true"||!1},w=re(l,"status"),v=_,S=()=>{w.value="resetPwd",v("getUsername",e.username)};async function D(){const{data:U,error:b}=await Se();b||(a.captchaEnable=U,a.captchaEnable==1&&y())}async function y(){a.uuid=O(),a.captchaSrc=we+"/captcha?uuid="+a.uuid;const U=O(),b=Date.now().toString(),F=ve(`${U}${b}uuid=${a.uuid}`);ye.get(a.captchaSrc,{headers:{"X-Nonce":U,"X-Timestamp":b,"X-Signature":F},responseType:"blob"}).then(I=>{const T=URL.createObjectURL(I.data);a.captchaSrc=T}).catch(I=>{console.error("Error:",I)})}return $(!1),be(async()=>{a.uuid=O(),e.username=le("username"),D()}),(U,b)=>{const F=H,I=J,T=Pe,ue=Re,de=Ue,pe=Q,me=Y,ge=Z,oe=Ce("no-space");return L(),z(ge,{ref_key:"formRef",ref:C,model:e,rules:f,size:"large","show-label":!1},{default:m(()=>[n(I,{path:"username"},{default:m(()=>[te(n(F,{autofocus:"",value:e.username,"onUpdate:value":b[0]||(b[0]=N=>e.username=N),placeholder:c(g)("page.login.common.userNamePlaceholder"),onKeyup:q(c(o),["enter"]),onBlur:p},null,8,["value","placeholder","onKeyup"]),[[oe]])]),_:1}),n(I,{path:"password"},{default:m(()=>[te(n(F,{value:e.password,"onUpdate:value":b[1]||(b[1]=N=>e.password=N),type:"password","show-password-on":"click",minlength:6,maxlength:18,placeholder:c(g)("page.login.common.passwordPlaceholder"),onKeyup:q(c(o),["enter"])},null,8,["value","placeholder","onKeyup"]),[[oe]])]),_:1}),a.captchaEnable==1?(L(),z(I,{key:0,path:"captcha"},{default:m(()=>[i("div",to,[n(F,{value:e.captcha,"onUpdate:value":b[2]||(b[2]=N=>e.captcha=N),placeholder:"请输入验证码",onKeyup:q(c(o),["enter"])},null,8,["value","onKeyup"]),i("img",{src:a.captchaSrc,alt:"captcha",style:{height:"40px"},onClick:y},null,8,so)])]),_:1})):xe("",!0),n(me,{vertical:"",size:24},{default:m(()=>[i("div",no,[n(de,{checked:r.value,"onUpdate:checked":b[4]||(b[4]=N=>r.value=N)},{default:m(()=>[E("我已阅读并同意 "),n(ue,{style:{"background-color":"#fff",color:"#1f2225"},trigger:"click","content-style":{padding:0}},{trigger:m(()=>[i("span",{class:"c-#1890ff",onClick:b[3]||(b[3]=ke(()=>{},["stop"]))},"用户协议")]),default:m(()=>[i("div",ao,[ro,i("div",lo,[n(T,{style:{"max-height":"320px",width:"520px"},"content-style":{padding:"0 0 30px 0"}},{default:m(()=>[io,co,uo,po,mo,go,fo,_o,ho,wo,vo,yo,bo,Co]),_:1})])])]),_:1})]),_:1},8,["checked"]),i("div",{onClick:S,style:{color:"rgb(210, 210, 210)",cursor:"pointer"}},R("修改密码"))]),n(pe,{type:"primary",size:"large",ghost:"",round:"",block:"",loading:c(d).loginLoading,onClick:c(o)},{default:m(()=>[E(R(c(g)("common.confirm")),1)]),_:1},8,["loading","onClick"])]),_:1})]),_:1},8,["model"])}}}),se=ee(xo,[["__scopeId","data-v-6b3a1c20"]]);function ce(){const{loading:l,startLoading:_,endLoading:d}=$e(),{count:C,start:u,stop:e,isCounting:a}=Ye(60),h=P(()=>{let f=g("page.login.codeLogin.getCode");const o=g("page.login.codeLogin.reGetCode",{time:C.value});return l.value&&(f=""),a.value&&(f=o),f});function t(f){var o,s,r,p;return f.trim()===""?((s=(o=window.$message)==null?void 0:o.error)==null||s.call(o,g("form.mobile.required")),!1):Ee.test(f)?!0:((p=(r=window.$message)==null?void 0:r.error)==null||p.call(r,g("form.mobile.invalid")),!1)}async function k(f,o){!t(f)||l.value||(_(),await new Promise(r=>{Le(f,o).then(p=>{var w,v;console.log("response",p),p.error||(setTimeout(r,500),(v=(w=window.$message)==null?void 0:w.success)==null||v.call(w,g("page.login.codeLogin.sendCodeSuccess")),u(),d())}).catch(p=>{var w,v;return console.log("error",p),(v=(w=window.$message)==null?void 0:w.error)==null||v.call(w,g("page.login.codeLogin.sendCodeFailed")),!1})}))}return{label:h,start:u,stop:e,isCounting:a,loading:l,getCaptcha:k}}const ko={class:"w-full flex-y-center gap-16px"},So=B({name:"CodeLogin",__name:"register",setup(l){const{toggleLoginModule:_}=G(),{formRef:d,validate:C}=W(),{label:u,isCounting:e,loading:a,getCaptcha:h}=ce(),t=j({username:"",usertype:0,email:"",mobile:"",code:"",password:"",confirmPassword:"",status:1,deptId:0,pid:0,roleIdList:["1147694289157566466"]}),k=P(()=>{const{formRules:o,createConfirmPwdRule:s}=X(),r=[{required:!0,type:"number",message:"This field is required",trigger:["input","change","blur","password-input"]},{type:"number",message:"Must be a number",trigger:["input","change","blur","password-input"]}];return{username:o.username,usertype:r,email:o.email,mobile:o.mobile,code:o.code,password:o.password,confirmPassword:s(t.password),status:r,deptId:r,pid:r,roleIdList:r}});async function f(){var r,p;await C();const{data:o,error:s}=await Me(t.username,t.usertype,t.email,t.mobile,t.code,t.password,t.confirmPassword,t.status,t.pid,t.roleIdList);console.log("data",o),s?(p=window.$message)==null||p.error(g("page.login.common.validateFail")):((r=window.$message)==null||r.success(g("page.login.common.validateSuccess")),_("pwd-login"))}return(o,s)=>{const r=H,p=J,w=je,v=Q,S=Y,D=Z;return L(),z(D,{ref_key:"formRef",ref:d,model:t,rules:k.value,size:"large","show-label":!1},{default:m(()=>[n(p,{path:"username"},{default:m(()=>[n(r,{value:t.username,"onUpdate:value":s[0]||(s[0]=y=>t.username=y),placeholder:c(g)("page.login.common.userNamePlaceholder")},null,8,["value","placeholder"])]),_:1}),n(p,{label:c(g)("page.manage.user.usertype"),path:"usertype"},{default:m(()=>[n(w,{filterable:"",value:t.usertype,"onUpdate:value":s[1]||(s[1]=y=>t.usertype=y),placeholder:c(g)("page.manage.user.form.usertype"),options:c(ze)(c(Fe)),style:{width:"100%"}},null,8,["value","placeholder","options"])]),_:1},8,["label"]),n(p,null,{default:m(()=>[n(r,{value:t.email,"onUpdate:value":s[2]||(s[2]=y=>t.email=y),placeholder:c(g)("page.login.common.emailPlaceholder")},null,8,["value","placeholder"])]),_:1}),n(p,{path:"mobile"},{default:m(()=>[n(r,{value:t.mobile,"onUpdate:value":s[3]||(s[3]=y=>t.mobile=y),placeholder:c(g)("page.login.common.mobilePlaceholder"),maxlength:11},null,8,["value","placeholder"])]),_:1}),n(p,{path:"code"},{default:m(()=>[i("div",ko,[n(r,{value:t.code,"onUpdate:value":s[4]||(s[4]=y=>t.code=y),placeholder:c(g)("page.login.common.codePlaceholder")},null,8,["value","placeholder"]),n(v,{size:"large",disabled:c(e),loading:c(a),onClick:s[5]||(s[5]=y=>c(h)(t.mobile,0))},{default:m(()=>[E(R(c(u)),1)]),_:1},8,["disabled","loading"])])]),_:1}),n(p,{path:"password"},{default:m(()=>[n(r,{value:t.password,"onUpdate:value":s[6]||(s[6]=y=>t.password=y),type:"password","show-password-on":"click",placeholder:c(g)("page.login.common.passwordPlaceholder")},null,8,["value","placeholder"])]),_:1}),n(p,{path:"confirmPassword"},{default:m(()=>[n(r,{value:t.confirmPassword,"onUpdate:value":s[7]||(s[7]=y=>t.confirmPassword=y),type:"password","show-password-on":"click",placeholder:c(g)("page.login.common.confirmPasswordPlaceholder")},null,8,["value","placeholder"])]),_:1}),n(S,{vertical:"",size:18,class:"w-full"},{default:m(()=>[n(v,{type:"primary",size:"large",round:"",block:"",onClick:f},{default:m(()=>[E(R(c(g)("common.confirm")),1)]),_:1}),n(v,{size:"large",round:"",block:"",onClick:s[8]||(s[8]=y=>c(_)("pwd-login"))},{default:m(()=>[E(R(c(g)("page.login.common.back")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])}}}),Po=B({name:"ResetPwd",__name:"reset-pwd",props:ae({username:{type:String,required:!0}},{status:{type:String,required:!0},statusModifiers:{}}),emits:["update:status"],setup(l){const _=re(l,"status"),d=l;G();const{formRef:C,validate:u}=W();ce();const e=j({username:d.username||"",oripwd:"",code:"",password:"",confirmPassword:""}),a=P(()=>{const{formRules:f,createConfirmPwdRule:o,defaultRequiredRule:s}=X();return{username:f.username,oripwd:f.password1,password:[{...s},{asyncValidator:(r,p)=>p==""||p==null?Promise.resolve():Be(p)?e.username&&p.toLocaleLowerCase().includes(e.username.toLocaleLowerCase())?Promise.reject("密码禁止与用户名相同或包含用户名(不区分大小写)"):e.password==e.oripwd?Promise.reject("新密码不能与旧密码相同"):Promise.resolve():Promise.reject("密码应符合：大、小写字母、数字、特殊字符的8-18位组合"),trigger:["blur","input"]}],code:f.code,confirmPassword:o(e.password)}}),h=le("username");async function t(){var w,v;await u();const f=A(e.oripwd),o=A(e.password),s=A(e.username),{data:r,error:p}=await De(s,f,o);console.log("data",r),p?(v=window.$message)==null||v.error("修改失败"):((w=window.$message)==null||w.success("修改成功"),h.value=e.username,_.value="pwd-login1")}const k=()=>{h.value=e.username,_.value="pwd-login"};return(f,o)=>{const s=H,r=J,p=Q,w=Y,v=Z;return L(),z(v,{ref_key:"formRef",ref:C,model:e,rules:a.value,size:"large","show-label":!1},{default:m(()=>[n(r,{path:"username"},{default:m(()=>[n(s,{value:e.username,"onUpdate:value":o[0]||(o[0]=S=>e.username=S),placeholder:c(g)("page.login.common.userNamePlaceholder")},null,8,["value","placeholder"])]),_:1}),n(r,{path:"oripwd"},{default:m(()=>[n(s,{value:e.oripwd,"onUpdate:value":o[1]||(o[1]=S=>e.oripwd=S),type:"password","show-password-on":"click",placeholder:"请输入原密码"},null,8,["value"])]),_:1}),n(r,{path:"password"},{default:m(()=>[n(s,{value:e.password,"onUpdate:value":o[2]||(o[2]=S=>e.password=S),type:"password","show-password-on":"click",placeholder:"请输入新密码"},null,8,["value"])]),_:1}),n(r,{path:"confirmPassword"},{default:m(()=>[n(s,{value:e.confirmPassword,"onUpdate:value":o[3]||(o[3]=S=>e.confirmPassword=S),type:"password","show-password-on":"click",placeholder:c(g)("page.login.common.confirmPasswordPlaceholder")},null,8,["value","placeholder"])]),_:1}),n(w,{vertical:"",size:18,class:"w-full"},{default:m(()=>[n(p,{type:"primary",size:"large",ghost:"",round:"",block:"",onClick:t},{default:m(()=>[E(R(c(g)("common.confirm")),1)]),_:1}),n(p,{size:"large",type:"default",ghost:"",round:"",block:"",onClick:k,style:{color:"rgb(224,224,224)"}},{default:m(()=>[E(R(c(g)("page.login.common.back")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])}}}),ne=ee(Po,[["__scopeId","data-v-d0c47e9f"]]),Ro={class:"w-400px lt-sm:w-300px"},Uo={class:"flex-y-center justify-between"},Io=["src"],No={class:"text-28px text-primary font-500 lt-sm:text-22px"},$o={class:"i-flex-col btn"},Lo={class:"pt-24px"},Eo={class:"pt-24px"},zo={class:"text-primary",style:{position:"fixed",right:"20px",top:"20px","font-size":"1.2rem","z-index":"999"}},Fo=B({name:"login",__name:"index",props:{module:{}},setup(l){const _=l;Te();const d=Oe(),C={"pwd-login":{label:V["pwd-login"],component:se},register:{label:V.register,component:So},"reset-pwd":{label:V["reset-pwd"],component:ne}};P(()=>C[_.module||"pwd-login"]),P(()=>d.darkMode?qe(d.themeColor,600):d.themeColor),P(()=>d.themeScheme);const u=$("pwd-login"),e=$("");Ae("username",e);const a=o=>{e.value=o},h=P(()=>{const o="#ffffff",s=d.darkMode?.5:.2;return Ve(o,d.themeColor,s)});function t(){window.open("https://beian.miit.gov.cn/","_blank")}const k=$();return(async()=>{fetch("/version.json").then(o=>o.json()).then(o=>{k.value=o}).catch(o=>{console.error("Error fetching version.json:",o)})})(),(o,s)=>{var w;const r=He,p=Je;return L(),Ke("div",{class:"relative size-full flex-center overflow-hidden login",style:Xe({backgroundColor:h.value})},[n(p,{bordered:!1,class:"relative z-4 w-auto rd-12px loginClass","content-style":{boxShadow:"0 0 10px rgba(255, 255, 255, 0.2)",borderRadius:"10px"}},{default:m(()=>[i("div",Ro,[i("header",Uo,[i("img",{src:c(Ge),alt:"Hookwe",style:{width:"80px"}},null,8,Io),i("h3",No,R(c(g)("system.title")),1),i("div",$o,[n(r,{"theme-schema":c(d).themeScheme,"show-tooltip":!1,class:"text-20px lt-sm:text-18px",onSwitch:c(d).toggleThemeScheme},null,8,["theme-schema","onSwitch"])])]),i("main",Lo,[i("div",Eo,[n(We,{name:c(d).page.animateMode,mode:"out-in",appear:""},{default:m(()=>[u.value=="pwd-login"||u.value=="pwd-login1"?(L(),z(se,{key:0,status:u.value,"onUpdate:status":s[0]||(s[0]=v=>u.value=v),onGetUsername:a},null,8,["status"])):(L(),z(ne,{key:1,status:u.value,"onUpdate:status":s[1]||(s[1]=v=>u.value=v),username:e.value},null,8,["status","username"]))]),_:1},8,["name"])])])])]),_:1}),i("div",zo,R(((w=k.value)==null?void 0:w.ver)||""),1),i("div",{class:"text-primary",style:{position:"fixed",left:"50%",bottom:"5%",transform:"translateX(-50%)","font-size":"1rem",cursor:"pointer","z-index":"999"},onClick:t},"Copyright (c) 2025 · 杭州奇固科威信息安全技术有限公司")],4)}}}),Bo=ee(Fo,[["__scopeId","data-v-17b74d43"]]);export{Bo as default};

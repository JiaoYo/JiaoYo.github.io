import{_ as Je}from"./table-column-setting.vue_vue_type_script_setup_true_lang-DtGc5Ytf.js";import{_ as We}from"./round-delete-tdauvCgt.js";import{_ as Qe}from"./round-add-CmnuyzV1.js";import{d as _e,aG as me,z as Ne,C as Xe,s as D,bZ as fe,A as ze,a as Ye,aI as Se,aE as et,cS as tt,cT as at,c as v,o as c,w as l,f as a,a8 as lt,L as Ue,F as U,h as o,aF as ve,G as F,b9 as nt,aM as ot,aN as st,g as f,b as le,e as I,t as N,aK as rt,B as P,aL as it,I as he,$ as j,a9 as ut,cu as Te,aP as ge,cI as dt,cU as ct,aR as pt,cV as mt,K as ft,a7 as Pe,aT as vt,i as gt,E as pe,aU as ie,aJ as yt,H as ue,aV as _t,cW as ke,cv as ht,n as xe,aZ as wt}from"./index-CYktWG4g.js";import{u as bt,a as kt}from"./table-5HkGqXjJ.js";import{u as ye}from"./usePageData-B3dmJo7x.js";import{N as xt}from"./Cascader-CiR9C1FW.js";import{_ as Fe}from"./Grid-yccwcNrM.js";import{_ as $e}from"./FormItemGridItem-CEINFz71.js";import{_ as Ct}from"./round-search-DE64LlxI.js";import{_ as Dt}from"./round-refresh-BIWjpXWE.js";import{N as Ce}from"./Popconfirm-CztqIDpP.js";const Nt={key:0,style:{"margin-left":"20px"}},zt={key:0,style:{"margin-left":"20px"}},St={key:0,style:{"margin-left":"20px"}},Ut={key:0,style:{"margin-left":"20px"}},Tt=_e({name:"OperateDrawer",__name:"operate-drawer",props:me({operateType:{},rowData:{},pid:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:me(["submitted"],["update:visible"]),setup($,{emit:X}){const z=X,M=Ne(),h=$,t=Xe(T());function T(){return{pid:void 0,cid:void 0,contractId:void 0,id:"",devname:"",devmodel:"",devunit:"",devnum:0,notes:"",etype:0,devmanu:"",status:0,re1:"",re2:"",re3:"",re4:"",fl1:"",fl2:"",fl3:"",fl4:""}}const g=D([]),{pageData:y,getData:C,nextPage:O}=ye(Te),Y=async n=>{const e=n.currentTarget,r=e.scrollTop;e.scrollTop+e.offsetHeight>=e.scrollHeight&&y.data.length<y.total&&(await O(),g.value=y.data,await ge(),setTimeout(()=>{e.scrollTop=r}))},ee=fe.debounce(async n=>{await C({fuzzy:n,page:1}),g.value=y.data},300),V=D(!1),B=D(!1),S=n=>{if(t.pid=null,V.value=!0,B.value=!1,!n){H();return}ee(n)},te=async()=>{V.value&&!B.value&&(await C({page:1}),g.value=y.data,V.value=!1)},H=async()=>{await C({page:1}),g.value=y.data},K=async()=>{var n,e;await C({fuzzy:M.userInfo.pname,page:1}),t.pid=h.pid?h.pid:(n=y.data[0])==null?void 0:n.id,g.value=y.data,await w(),t.contractId=(e=u.value[0])==null?void 0:e.id,d()},Z=D([]),R=D(),{pageData:E,getData:J,nextPage:m}=ye(dt),d=async(n=t.contractId)=>{await J({pids:n}),R.value=[],Z.value=Array.from(new Set([...Z.value,...E.data])),R.value=E.data.map(e=>({label:e.devname,value:e.id}))},i=async n=>{var e;t.pid=n,await w(),t.contractId=(e=u.value[0])==null?void 0:e.id,await d(),B.value=!0,t.cid=null},u=D([]),w=async()=>{const{data:n,error:e}=await ct({id:t.pid,limit:100,page:1});u.value=n==null?void 0:n.list.map(r=>({value:r.id,label:r.contractname,isLeaf:!1}))},q=D(),W=async n=>{t.cid=n;const e=Z.value.find(r=>r.id==n);t.devname=e==null?void 0:e.devname,t.devnum=e==null?void 0:e.devcount,q.value=e==null?void 0:e.devcount,t.etype=e==null?void 0:e.devtype,t.devmanu=e==null?void 0:e.devmanu,t.notes=e==null?void 0:e.notes,t.devmodel=((e==null?void 0:e.devmodel.length)>64?e==null?void 0:e.devname:e==null?void 0:e.devmodel)||"",t.devunit=e==null?void 0:e.devunit},p=D(0),_=D("");async function A({file:n},e){p.value=0,_.value=e;const r=await pt(n.file,n.name,"",k=>{p.value=k});r&&(t[e]=r,p.value=0)}async function Q(){var n;if(await K(),Object.assign(t,T()),h.operateType==="add"&&(t.pid=h.pid),h.operateType==="edit"&&h.rowData){Object.assign(t,h.rowData),q.value=(n=E.data.find(k=>k.id==t.cid))==null?void 0:n.devcount;const{data:e,error:r}=await mt(t.cid);r||u.value.push({value:e.id,label:e.devname,disabled:!0,isLeaf:!0,hidden:!0})}}const{formRef:b,validate:G,restoreValidation:Be}=ze(),qe={pid:{type:"number",required:!0,trigger:["blur","change"],message:"请选择"},contractId:{type:"number",required:!0,trigger:["blur","change"],message:"请选择"},cid:{type:"number",required:!0,trigger:["blur","change"],message:"请选择"},devname:{type:"string",required:!0,trigger:["blur","change"],message:"请输入"},devmodel:{type:"string",required:!0,trigger:["blur","change"],message:"请输入"},devnum:{type:"number",required:!0,trigger:["blur","change"],message:"请输入"},devunit:{type:"string",required:!0,trigger:["blur","change"],message:"请输入"}},Le=async n=>{var e;await d(n.value),n.children=(e=R.value)==null?void 0:e.map(r=>({label:r.label,value:r.value,isLeaf:!0}))},Ie=Ye(()=>({add:"新增设备",edit:"修改设备"})[h.operateType]),ae=Se($,"visible"),Re=async n=>{if(n){await ge();const e=document.querySelector(".n-cascader-menu");e&&(e.removeEventListener("scroll",we),e.addEventListener("scroll",we))}},de=D(!1),Ee=D(!0),we=async n=>{const e=n.target;e.scrollHeight-e.scrollTop-e.clientHeight<10&&!de.value&&Ee.value&&(de.value=!0,m(),R.value=E.data.map(k=>({label:k.devname,value:k.id})),de.value=!1)};et(ae,()=>{ae.value&&(Q(),setTimeout(()=>{const n=document.querySelector(".n-scrollbar-content");n==null||n.scrollTo(0,0)},300),Be())});async function ne(n){if(n)try{const r=await(await fetch(n==null?void 0:n.split("?")[0],{mode:"cors"})).blob(),k=URL.createObjectURL(r),L=document.createElement("a");L.href=k,L.download=n==null?void 0:n.split("?")[1],L.style.display="none",document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(k)}catch(e){console.error("下载失败:",e)}}function ce(){ae.value=!1}const Ae=fe.debounce(async()=>{await je()},1e3,{leading:!0,trailing:!1});async function je(){var n,e;if(await G(),h.operateType==="edit"){const{data:r,error:k}=await tt([t]);k||(ce(),z("submitted"),(n=window.$message)==null||n.success("修改成功"))}else{const{data:r,error:k}=await at([{...t}]);k||(ce(),z("submitted"),(e=window.$message)==null||e.success("添加成功"))}}async function oe(n){var e;return n.file.file.size>100*1024*1024?((e=window.$message)==null||e.error("文件大小不能超过100M"),!1):!0}const Me=n=>n.hidden?null:n.label,Oe=n=>n.option.hidden?null:n.node;return(n,e)=>{const r=$e,k=xt,L=st,Ve=ot,se=rt,re=it,be=Fe,Ge=Ue,He=lt,Ke=he,Ze=ut;return c(),v(Ze,{show:ae.value,"onUpdate:show":e[22]||(e[22]=s=>ae.value=s),title:Ie.value,preset:"card",class:"w-800px","mask-closable":!1,draggable:!0},{footer:l(()=>[a(Ke,{justify:"end",size:16},{default:l(()=>[a(o(P),{onClick:ce},{default:l(()=>[f(N(o(j)("common.cancel")),1)]),_:1}),a(o(P),{type:"primary",onClick:o(Ae)},{default:l(()=>[f(N(o(j)("common.confirm")),1)]),_:1},8,["onClick"])]),_:1})]),default:l(()=>[a(He,{class:"pr-20px"},{default:l(()=>[a(Ge,{ref_key:"formRef",ref:b,model:t,rules:qe,"label-placement":"left","label-width":120},{default:l(()=>[a(be,{responsive:"screen","item-responsive":""},{default:l(()=>[a(r,{span:"24 m:12",label:"项目列表",path:"pid"},{default:l(()=>[a(o(ve),{clearable:"",filterable:"",value:t.pid,"onUpdate:value":[e[0]||(e[0]=s=>t.pid=s),i],placeholder:"请选择项目","label-field":"proname","value-field":"id",onClear:H,onSearch:S,onBlur:te,options:g.value,onScroll:Y},null,8,["value","options"])]),_:1}),a(r,{span:"24 m:12",label:"绑定合同设备",path:"cid"},{default:l(()=>[a(k,{value:t.cid,"onUpdate:value":[e[1]||(e[1]=s=>t.cid=s),W],placeholder:"请选择合同设备",options:u.value,"render-label":Me,"render-suffix":Oe,"check-strategy":"child","show-path":!1,labelKey:"label",remote:"","on-load":Le,"onUpdate:show":Re},null,8,["value","options"])]),_:1}),t.cid?(c(),v(r,{key:0,span:"24 m:12",label:"设备名称",path:"devname"},{default:l(()=>[a(o(F),{value:t.devname,"onUpdate:value":e[2]||(e[2]=s=>t.devname=s),clearable:"",placeholder:"请输入"},null,8,["value"])]),_:1})):U("",!0),t.cid?(c(),v(r,{key:1,span:"24 m:12",label:"数量",path:"devnum"},{default:l(()=>[a(o(nt),{value:t.devnum,"onUpdate:value":e[3]||(e[3]=s=>t.devnum=s),placeholder:"请输入",max:q.value,style:{width:"100%"}},null,8,["value","max"])]),_:1})):U("",!0),t.cid?(c(),v(r,{key:2,span:"24 m:12",label:"设备单位",path:"devunit"},{default:l(()=>[a(o(F),{value:t.devunit,"onUpdate:value":e[4]||(e[4]=s=>t.devunit=s),placeholder:"请输入",readonly:""},null,8,["value"])]),_:1})):U("",!0),t.cid?(c(),v(r,{key:3,span:"24 m:12",label:"型号",path:"devmodel"},{default:l(()=>[a(o(F),{value:t.devmodel,"onUpdate:value":e[5]||(e[5]=s=>t.devmodel=s),placeholder:"请输入",readonly:""},null,8,["value"])]),_:1})):U("",!0),t.cid?(c(),v(r,{key:4,span:"24 m:12",label:"是否为我司设备",path:"etype"},{default:l(()=>[a(Ve,{value:t.etype,"onUpdate:value":e[6]||(e[6]=s=>t.etype=s),name:"radiogroup",disabled:""},{default:l(()=>[a(L,{value:0},{default:l(()=>e[23]||(e[23]=[f("是")])),_:1,__:[23]}),a(L,{value:1},{default:l(()=>e[24]||(e[24]=[f("否")])),_:1,__:[24]})]),_:1},8,["value"])]),_:1})):U("",!0),t.cid?(c(),v(r,{key:5,span:"24 m:12",label:"设备厂家",path:"devmanu"},{default:l(()=>[a(o(F),{value:t.devmanu,"onUpdate:value":e[7]||(e[7]=s=>t.devmanu=s),placeholder:"请输入",readonly:""},null,8,["value"])]),_:1})):U("",!0),h.operateType=="edit"?(c(),v(r,{key:6,span:"24 m:12",label:"清点状态",path:"status"},{default:l(()=>[a(o(ve),{clearable:"",value:t.status,"onUpdate:value":e[8]||(e[8]=s=>t.status=s),placeholder:"请选择",options:[{label:"未清点",value:0},{label:"正常",value:1},{label:"增补",value:2},{label:"退货",value:3},{label:"换货",value:4}]},null,8,["value"])]),_:1})):U("",!0),t.cid?(c(),v(r,{key:7,span:"24 m:12",label:"备注",path:"notes"},{default:l(()=>[a(o(F),{value:t.notes,"onUpdate:value":e[9]||(e[9]=s=>t.notes=s),placeholder:"请输入"},null,8,["value"])]),_:1})):U("",!0),a(r,{span:"24 m:24",label:"",path:"notes","show-feedback":!1},{default:l(()=>[a(be,{responsive:"screen","item-responsive":""},{default:l(()=>[a(r,{span:"24 m:12",label:"附件1",path:"notes"},{default:l(()=>[a(o(F),{value:t.re1,"onUpdate:value":e[10]||(e[10]=s=>t.re1=s),placeholder:"请输入",style:{width:"250px"}},null,8,["value"])]),_:1}),a(r,{span:"24 m:12",label:"",path:"notes"},{default:l(()=>{var s;return[t.fl1?(c(),le("span",Nt,[f(N((s=t.fl1)==null?void 0:s.split("?")[1])+" ",1),I("span",{class:"cursor-pointer c-#c92a2a",onClick:e[11]||(e[11]=x=>t.fl1="")},"删除"),I("span",{class:"cursor-pointer c-#1890ff ml-5px inline-block",onClick:e[12]||(e[12]=x=>ne(t.fl1))},"下载")])):(c(),v(se,{key:1,style:{width:"auto","margin-left":"20px"},ref:"uploadRef",action:"#","custom-request":x=>A(x,"fl1"),"show-file-list":!1,onBeforeUpload:oe},{default:l(()=>[a(o(P),{loading:p.value>0&&!t.fl1&&_.value=="fl1",size:"small",ghost:"",type:"primary"},{default:l(()=>[f(N(p.value>0&&!t.fl1&&_.value=="fl1"?"上传中":"选择文件"),1)]),_:1},8,["loading"])]),_:1},8,["custom-request"])),p.value&&!t.fl1&&_.value=="fl1"?(c(),v(re,{key:2,type:"line",percentage:p.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):U("",!0)]}),_:1})]),_:1})]),_:1}),a(r,{span:"24 m:12",label:"附件2",path:"notes"},{default:l(()=>[a(o(F),{value:t.re2,"onUpdate:value":e[13]||(e[13]=s=>t.re2=s),placeholder:"请输入",style:{width:"250px"}},null,8,["value"])]),_:1}),a(r,{span:"24 m:12",label:"",path:"notes"},{default:l(()=>{var s;return[t.fl2?(c(),le("span",zt,[f(N((s=t.fl2)==null?void 0:s.split("?")[1])+" ",1),I("span",{class:"cursor-pointer c-#c92a2a",onClick:e[14]||(e[14]=x=>t.fl2="")},"删除"),I("span",{class:"cursor-pointer c-#1890ff ml-5px inline-block",onClick:e[15]||(e[15]=x=>ne(t.fl2))},"下载")])):(c(),v(se,{key:1,style:{width:"auto","margin-left":"20px"},ref:"uploadRef",action:"#","custom-request":x=>A(x,"fl2"),"show-file-list":!1,onBeforeUpload:oe},{default:l(()=>[a(o(P),{loading:p.value>0&&!t.fl2&&_.value=="fl2",size:"small",ghost:"",type:"primary"},{default:l(()=>[f(N(p.value>0&&!t.fl2&&_.value=="fl2"?"上传中":"选择文件"),1)]),_:1},8,["loading"])]),_:1},8,["custom-request"])),p.value&&!t.fl2&&_.value=="fl2"?(c(),v(re,{key:2,type:"line",percentage:p.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):U("",!0)]}),_:1}),a(r,{span:"24 m:12",label:"附件3",path:"notes"},{default:l(()=>[a(o(F),{value:t.re3,"onUpdate:value":e[16]||(e[16]=s=>t.re3=s),placeholder:"请输入",style:{width:"250px"}},null,8,["value"])]),_:1}),a(r,{span:"24 m:12",label:"",path:"notes"},{default:l(()=>{var s;return[t.fl3?(c(),le("span",St,[f(N((s=t.fl3)==null?void 0:s.split("?")[1])+" ",1),I("span",{class:"cursor-pointer c-#c92a2a",onClick:e[17]||(e[17]=x=>t.fl3="")},"删除"),I("span",{class:"cursor-pointer c-#1890ff ml-5px inline-block",onClick:e[18]||(e[18]=x=>ne(t.fl3))},"下载")])):(c(),v(se,{key:1,style:{width:"auto","margin-left":"20px"},ref:"uploadRef",action:"#","custom-request":x=>A(x,"fl3"),"show-file-list":!1,onBeforeUpload:oe},{default:l(()=>[a(o(P),{loading:p.value>0&&!t.fl3&&_.value=="fl3",size:"small",ghost:"",type:"primary"},{default:l(()=>[f(N(p.value>0&&!t.fl3&&_.value=="fl3"?"上传中":"选择文件"),1)]),_:1},8,["loading"])]),_:1},8,["custom-request"])),p.value&&!t.fl3&&_.value=="fl3"?(c(),v(re,{key:2,type:"line",percentage:p.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):U("",!0)]}),_:1}),a(r,{span:"24 m:12",label:"附件4",path:"notes"},{default:l(()=>[a(o(F),{value:t.re4,"onUpdate:value":e[19]||(e[19]=s=>t.re4=s),placeholder:"请输入",style:{width:"250px"}},null,8,["value"])]),_:1}),a(r,{span:"24 m:12",label:"",path:"notes"},{default:l(()=>{var s;return[t.fl4?(c(),le("span",Ut,[f(N((s=t.fl4)==null?void 0:s.split("?")[1])+" ",1),I("span",{class:"cursor-pointer c-#c92a2a",onClick:e[20]||(e[20]=x=>t.fl4="")},"删除"),I("span",{class:"cursor-pointer c-#1890ff ml-5px inline-block",onClick:e[21]||(e[21]=x=>ne(t.fl4))},"下载")])):(c(),v(se,{key:1,style:{width:"auto","margin-left":"20px"},ref:"uploadRef",action:"#","custom-request":x=>A(x,"fl4"),"show-file-list":!1,onBeforeUpload:oe},{default:l(()=>[a(o(P),{loading:p.value>0&&!t.fl4&&_.value=="fl4",size:"small",ghost:"",type:"primary"},{default:l(()=>[f(N(p.value>0&&!t.fl4&&_.value=="fl4"?"上传中":"选择文件"),1)]),_:1},8,["loading"])]),_:1},8,["custom-request"])),p.value&&!t.fl4&&_.value=="fl4"?(c(),v(re,{key:2,type:"line",percentage:p.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):U("",!0)]}),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show","title"])}}}),Pt=_e({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:me(["reset","search","clear"],["update:model"]),setup($,{emit:X}){const z=X,{formRef:M,restoreValidation:h}=ze(),t=Se($,"model"),T=Ne(),g=D([]),{pageData:y,getData:C,nextPage:O}=ye(Te),Y=async m=>{const d=m.currentTarget,i=d.scrollTop;d.scrollTop+d.offsetHeight>=d.scrollHeight&&y.data.length<y.total&&(await O(),g.value=y.data,await ge(),setTimeout(()=>{d.scrollTop=i}))},ee=async m=>{var d;S.value=!0,m?(t.value.pid=m,z("search"),T.setProjectInfo({pname:(d=g.value.find(i=>i.id==m))==null?void 0:d.proname,pid:m})):z("clear")},V=fe.debounce(async m=>{await C({fuzzy:m,page:1}),g.value=y.data},300),B=D(!1),S=D(!1),te=m=>{if(t.value.pid=null,B.value=!0,S.value=!1,!m){K();return}V(m)},H=async()=>{B.value&&!S.value&&(await C({page:1}),g.value=y.data,B.value=!1)},K=async()=>{await C({page:1}),g.value=y.data};(async()=>{var m,d;await C({fuzzy:T.userInfo.pname}),g.value=y.data,t.value.pid=T.userInfo.pid?T.userInfo.pid:(m=g.value[0])==null?void 0:m.id,T.setProjectInfo({pid:t.value.pid,pname:(d=g.value.find(i=>i.id==t.value.pid))==null?void 0:d.proname}),z("search")})();async function R(){await h(),t.value.fuzzy="",z("reset")}const E=()=>{t.value.fuzzy="",z("search")};async function J(){var m,d;t.value.pid?z("search"):((m=window.$message)==null||m.destroyAll(),(d=window.$message)==null||d.warning("请选择项目"))}return(m,d)=>{const i=ve,u=$e,w=F,q=Dt,W=P,p=Ct,_=he,A=Fe,Q=Ue,b=Pe;return c(),v(b,{bordered:!1,size:"small",class:"card-wrapper"},{default:l(()=>[a(Q,{ref_key:"formRef",ref:M,model:t.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:ft(J,["enter"])},{default:l(()=>[a(A,{responsive:"screen","item-responsive":"","x-gap":16,"y-gap":16},{default:l(()=>[a(u,{span:"24 s:12 m:6",label:"项目列表",path:"PrjId"},{default:l(()=>[a(i,{filterable:"",clearable:"",value:t.value.pid,"onUpdate:value":[d[0]||(d[0]=G=>t.value.pid=G),ee],placeholder:"请选择项目","label-field":"proname","value-field":"id",options:g.value,onScroll:Y,onClear:K,onSearch:te,onBlur:H},null,8,["value","options"])]),_:1}),a(u,{span:"24 s:12 m:6",label:"设备名称",path:"fuzzy"},{default:l(()=>[a(w,{value:t.value.fuzzy,"onUpdate:value":d[1]||(d[1]=G=>t.value.fuzzy=G),placeholder:"请输入",clearable:"",onClear:E},null,8,["value"])]),_:1}),a(u,{span:"24  s:12 m:6",class:"pr-24px"},{default:l(()=>[a(_,{class:"w-full"},{default:l(()=>[a(W,{onClick:R},{icon:l(()=>[a(q,{class:"text-icon"})]),default:l(()=>[f(" "+N(o(j)("common.reset")),1)]),_:1}),a(W,{type:"primary",ghost:"",onClick:J},{icon:l(()=>[a(p,{class:"text-icon"})]),default:l(()=>[f(" "+N(o(j)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),Ft={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function De($){return typeof $=="function"||Object.prototype.toString.call($)==="[object Object]"&&!wt($)}const Gt=_e({name:"projectmanagement_device",__name:"index",setup($){const X=vt(),{columns:z,columnChecks:M,data:h,getData:t,loading:T,pagination:g,mobilePagination:y,searchParams:C}=bt({showTotal:!0,immediate:!1,apiFn:ht,apiParams:{page:1,pageSize:20,limit:20,fuzzy:"",_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48},{key:"devname",title:"设备名称",align:"center",width:180},{key:"devmodel",title:"型号",align:"center",width:160},{key:"devnum",title:"数量",align:"center",width:80},{key:"devunit",title:"设备单位",align:"center",width:100},{key:"etype",title:"是否为我司设备",align:"center",width:120,render(i){return xe("div",{},i.etype==0?"是":"否")}},{key:"devmanu",title:"设备厂家",align:"center",width:100},{key:"status",title:"清点状态",align:"center",width:100,render(i){return xe("div",{},i.status==0?"未清点":i.status==1?"正常":i.status==2?"增补":i.status==3?"退货":"换货")}},{key:"notes",title:"备注",align:"center",width:120},{key:"dusername",title:"清点信息",align:"left",width:200,render(i){return a("div",{style:"display:flex; flex-direction:column; gap:3px; line-height:1.4;"},[a("div",null,[a("span",{style:"color:#666"},[f("清点人：")]),a("span",{style:"font-weight:500"},[i.dusername||"-"])]),a("div",null,[a("span",{style:"color:#666"},[f("时间：")]),a("span",{style:" font-weight:500"},[i.ddbtime||"-"])])])}},{key:"username",title:"创建信息",align:"left",width:200,render(i){return a("div",{style:"display:flex; flex-direction:column; gap:3px; line-height:1.4;"},[a("div",null,[a("span",{style:"color:#666"},[f("创建人：")]),a("span",{style:"font-weight:500"},[i.username||"-"])]),a("div",null,[a("span",{style:"color:#666"},[f("时间：")]),a("span",{style:" font-weight:500"},[i.dbtime||"-"])])])}},{key:"operate",title:j("common.operate"),align:"center",width:140,fixed:"right",render:i=>{let u;return a("div",{class:"flex-center gap-8px"},[ue(a(P,{type:"primary",ghost:!0,size:"small",onClick:()=>R(i.id)},De(u=j("common.edit"))?u:{default:()=>[u]}),[[pe("no-auth"),"project:Equipment:update"]]),a(Ce,{onPositiveClick:()=>Z(i.id)},{default:()=>j("common.confirmDelete"),trigger:()=>{let w;return ue(a(P,{type:"error",ghost:!0,size:"small"},De(w=j("common.delete"))?w:{default:()=>[w]}),[[pe("no-auth"),"project:Equipment:delete"]])}})])}}]}),{drawerVisible:O,operateType:Y,editingData:ee,handleAdd:V,handleEdit:B,checkedRowKeys:S,onBatchDeleted:te,onDeleted:H}=kt(h,t);gt(async()=>{});async function K(){console.log(S.value),E(S.value.join(","),i=>{te()})}async function Z(i){const{data:u,error:w}=await ke(i);w||H()}function R(i){B(i)}async function E(i,u){const{data:w,error:q}=await ke(i);if(!q)u&&u(w);else return!1}const J=()=>{h.value=[],g.itemCount=0},m=i=>{t()},d=()=>{t()};return(i,u)=>{const w=he,q=Qe,W=We,p=Je,_=yt,A=Pe,Q=pe("no-auth");return c(),le("div",Ft,[a(Pt,{model:o(C),"onUpdate:model":u[0]||(u[0]=b=>ie(C)?C.value=b:null),onReset:d,onSearch:o(t),onClear:J},null,8,["model","onSearch"]),a(A,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:l(()=>[a(w,{align:"center",wrap:"",class:"lt-sm:w-200px"},{default:l(()=>u[4]||(u[4]=[I("div",null,"待调试设备",-1)])),_:1,__:[4]})]),"header-extra":l(()=>[a(w,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:l(()=>[ue((c(),v(o(P),{onClick:o(V),size:"small",ghost:"",type:"primary"},{icon:l(()=>[a(q,{class:"text-icon"})]),default:l(()=>[u[5]||(u[5]=f(" "+N("新增")))]),_:1,__:[5]},8,["onClick"])),[[Q,"project:Equipment:insert"]]),a(o(Ce),{onPositiveClick:K},{trigger:l(()=>[ue((c(),v(o(P),{size:"small",ghost:"",type:"error",disabled:o(S).length==0},{icon:l(()=>[a(W,{class:_t(["text-icon",{"animate-spin":o(T)}])},null,8,["class"])]),default:l(()=>[u[6]||(u[6]=f(" "+N("批量删除")))]),_:1,__:[6]},8,["disabled"])),[[Q,"project:Equipment:delete"]])]),default:l(()=>[u[7]||(u[7]=f(" 确定要删除选中的设备吗？ "))]),_:1,__:[7]}),a(p,{columns:o(M),"onUpdate:columns":u[1]||(u[1]=b=>ie(M)?M.value=b:null)},null,8,["columns"])]),_:1})]),default:l(()=>[a(_,{"checked-row-keys":o(S),"onUpdate:checkedRowKeys":u[2]||(u[2]=b=>ie(S)?S.value=b:null),columns:o(z),data:o(h),size:"small","flex-height":!o(X).isMobile,loading:o(T),remote:"","row-key":b=>b.id,"scroll-x":o(z).reduce((b,G)=>b+(G.width||100),0),pagination:o(y),class:"sm:h-full","onUpdate:filters":m},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","scroll-x","pagination"]),a(Tt,{visible:o(O),"onUpdate:visible":u[3]||(u[3]=b=>ie(O)?O.value=b:null),onSubmitted:o(t),pid:o(C).pid,"operate-type":o(Y),"row-data":o(ee)},null,8,["visible","onSubmitted","pid","operate-type","row-data"])]),_:1})])}}});export{Gt as default};

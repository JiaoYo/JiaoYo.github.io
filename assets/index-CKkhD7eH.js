import{_ as H}from"./refresh-BeWxBXlv.js";import{d as J,a3 as Q,g as e,$ as c,B as u,j as W,D as X,o as N,e as Y,w as o,i as t,h as d,E as ee,c as te,bo as ae,t as y,ah as S,F as le,ai as oe,N as ne,aj as se,ad as re,Z as ie,K as ce,O as ue,af as de,ag as pe}from"./index-BcwJAI2q.js";import{u as me,a as _e}from"./table-D33xm8uu.js";import{A as fe,b as ge,c as ve,d as he}from"./alarm-CT6uALFz.js";import{i as ye,j as we,k as be,l as ke}from"./common-BQGs6Sbh.js";import{_ as z}from"./Popconfirm-MBwapZUM.js";const Ce={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function T(f){return typeof f=="function"||Object.prototype.toString.call(f)==="[object Object]"&&!oe(f)}const je=J({name:"platformalarm_alarmlevelconfig",__name:"index",setup(f){const O=Q(),{columns:$,columnChecks:De,data:w,getData:g,loading:b,mobilePagination:j,searchParams:xe,resetSearchParams:Ae}=me({apiFn:ye,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48},{key:"atype",title:"告警类型",align:"center",width:240,render:l=>e("span",null,[fe[l.atype]])},{key:"alevel",title:"告警级别",align:"center",width:240,render:l=>e("span",null,[ge[l.alevel]])},{key:"operate",title:c("common.operate"),align:"center",width:130,render:l=>{let a;return e("div",{class:"flex-center gap-8px"},[e(u,{type:"primary",ghost:!0,size:"small",onClick:()=>F(l.id)},T(a=c("common.edit"))?a:{default:()=>[a]}),e(z,{onPositiveClick:()=>U(l.id)},{default:()=>c("common.confirmDelete"),trigger:()=>{let n;return e(u,{type:"error",ghost:!0,size:"small"},T(n=c("common.delete"))?n:{default:()=>[n]})}})])}}]}),{drawerVisible:p,operateType:k,editingData:R,handleAdd:L,handleEdit:B,checkedRowKeys:m,onBatchDeleted:P,onDeleted:K,closeDrawer:v}=_e(w,g);function U(l){console.log(l),C(l,a=>{K()})}function F(l){B(l),Object.assign(r.value,R.value)}async function C(l,a){const{data:n,error:i}=await we({ids:l});if(!i)a&&a(n);else return!1}const V=()=>{C(m.value.join(","),l=>{P()})},r=W({atype:void 0,alevel:void 0}),E=()=>{r.value={atype:null,alevel:null},L()},q={atype:[{type:"number",required:!0,message:"请选择告警类型",trigger:"blur"}],alevel:[{type:"number",required:!0,message:"请选择告警等级",trigger:"blur"}]},D=async()=>{var l,a,n,i;if(k.value==="add"){const{data:h,error:_}=await be([r.value]);_||(v(),g(),p.value=!1,(l=window.$message)==null||l.destroyAll(),(a=window.$message)==null||a.success("添加成功"))}else{const{data:h,error:_}=await ke([r.value]);_||(v(),g(),p.value=!1,(n=window.$message)==null||n.destroyAll(),(i=window.$message)==null||i.success("编辑成功"))}};return(l,a)=>{const n=H,i=ne,h=se,_=re,x=ie,A=ce,M=ue,G=de,I=pe,Z=X("no-auth");return N(),Y("div",Ce,[e(_,{title:"告警级别配置",bordered:!1,size:"small",class:"sm:flex-1-hidden"},{"header-extra":o(()=>[e(i,null,{default:o(()=>[e(t(u),{size:"small",ghost:"",type:"primary",onClick:E},{default:o(()=>[d(" 添加 ")]),_:1}),e(t(z),{onPositiveClick:V},{trigger:o(()=>[ee((N(),te(t(u),{size:"small",ghost:"",type:"error",disabled:t(m).length===0},{default:o(()=>[d(" 批量删除 ")]),_:1},8,["disabled"])),[[Z,"sys.system.alarm.delete"]])]),default:o(()=>[d(" 确定要删除选中的数据吗？ ")]),_:1}),e(t(u),{size:"small",onClick:a[0]||(a[0]=s=>t(g)())},{icon:o(()=>[e(n,{class:ae(["text-icon",{"animate-spin":t(b)}])},null,8,["class"])]),default:o(()=>[d(" "+y(t(c)("common.refresh")),1)]),_:1})]),_:1})]),default:o(()=>[e(h,{"checked-row-keys":t(m),"onUpdate:checkedRowKeys":a[1]||(a[1]=s=>S(m)?m.value=s:null),columns:t($),data:t(w),size:"small","flex-height":!t(O).isMobile,"scroll-x":962,loading:t(b),remote:"","row-key":s=>s.id,pagination:t(j),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1}),e(I,{show:t(p),"onUpdate:show":a[4]||(a[4]=s=>S(p)?p.value=s:null),"display-directive":"show",width:360},{default:o(()=>[e(G,{title:t(k)==="add"?"添加":"编辑","native-scrollbar":!1,closable:""},{footer:o(()=>[e(i,{size:16},{default:o(()=>[e(t(u),{onClick:t(v)},{default:o(()=>[d(y(t(c)("common.cancel")),1)]),_:1},8,["onClick"]),e(t(u),{type:"primary",onClick:D},{default:o(()=>[d(y(t(c)("common.confirm")),1)]),_:1})]),_:1})]),default:o(()=>[e(M,{ref:"formRef",model:r.value,rules:q,onKeyup:le(D,["enter"])},{default:o(()=>[e(A,{label:"告警类型",path:"atype"},{default:o(()=>[e(x,{value:r.value.atype,"onUpdate:value":a[2]||(a[2]=s=>r.value.atype=s),placeholder:"请选择告警类型",clearable:"",filterable:"",options:t(ve),"reset-menu-on-options-change":!1},null,8,["value","options"])]),_:1}),e(A,{label:"告警级别",path:"alevel"},{default:o(()=>[e(x,{value:r.value.alevel,"onUpdate:value":a[3]||(a[3]=s=>r.value.alevel=s),placeholder:"请选择告警级别",clearable:"",filterable:"",options:t(he),"reset-menu-on-options-change":!1},null,8,["value","options"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])])}}});export{je as default};

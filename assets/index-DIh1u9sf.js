import{_ as Ba}from"./table-column-setting.vue_vue_type_script_setup_true_lang-D-WWUWev.js";import{_ as Zt}from"./round-delete-BJCk8P86.js";import{_ as Ra}from"./round-add-CL2Vba1y.js";import{d as ft,av as rt,z as ea,D as Te,s as _,A as ta,$ as P,n as u,H as J,aR as ut,B as h,cG as Ma,cw as Va,cE as qa,cF as Bt,bf as Rt,au as de,a5 as Mt,f as a,g,cY as Ja,cy as Ga,cX as Ka,cU as Ha,a as Xa,ax as wt,at as dt,aJ as aa,b as ot,o as $,aO as Vt,bp as Ya,w as o,bn as Qa,M as la,L as sa,c as E,G as ce,h as r,bo as He,e as j,S as Wa,d4 as qt,a_ as Za,J as ne,ay as ct,t as G,a4 as na,N as el,cW as ia,cL as oa,d$ as tl,az as Jt,aA as pt,dP as ra,e4 as Gt,e5 as al,e6 as Kt,e7 as ll,cv as sl,e8 as nl,e9 as il,cV as ol,dT as Ht,dM as Xt,aE as kt,e0 as rl,d2 as ul,c$ as ua,dQ as da,dS as dl,cH as cl,cO as pl,dR as fl,dN as ml,dO as gl,aG as vl,dL as hl,dU as yl,ea as bl,bk as _l,a2 as Dt,aD as Ke,W as ca,aI as xl,Y as kl,X as Cl,i as Sl,b0 as wl,F as nt,aK as it,cT as Dl,I as Ge,aL as zl,aB as Fl,eb as Pl,aN as $l,cx as Il,aQ as Al}from"./index-BTeMkgsf.js";import{u as St,a as Ll}from"./table-nKGzp9nE.js";import{_ as Nl}from"./round-plus-Bd8_QZLd.js";import{_ as jl,a as Ul,A as Tl}from"./index-fRwxitRw.js";import{g as zt,h as El,i as pa,p as Yt,f as Ol}from"./business-CvQFdQAH.js";import{u as Qt}from"./usePageData-BtaN_wXr.js";import{h as Ct}from"./permission-Dvxa1exs.js";import{N as De}from"./Popconfirm-BVBTnPX5.js";import{N as Bl}from"./Cascader-BYxLSxG1.js";import{_ as fa}from"./Grid-D1GO_CFb.js";import{_ as ma}from"./FormItemGridItem-DlZX07SE.js";import{_ as Rl}from"./round-search-D_VWcob1.js";import{_ as Ml}from"./round-refresh-BDZcKrQw.js";import{_ as Vl}from"./DatePicker-ABP-mfiZ.js";import{_ as ql}from"./RadioButton-DjWiQ3TF.js";const Jl={class:"w-100%"},Gl={class:"flex"},Kl={style:{display:"flex","flex-direction":"column",width:"100%"}},Hl={class:"flex items-center"},Xl={class:"w-100%"},Yl={class:"w-100px"},Ql={style:{display:"flex","flex-direction":"column"}},Wl={style:{display:"flex","flex-direction":"column"}},Zl={style:{display:"flex","flex-direction":"column"}},es={class:"flex-col w-100%"},ts=2,as=ft({name:"OperateDrawer",__name:"operate-drawer",props:rt({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:rt(["submitted"],["update:visible"]),setup(Q,{emit:ie}){const x=ea(),ae=ie,B=Te({contactList:[],debuggedDevieceList:[]}),d=Q,n=Te(pe());function pe(){return{proname:"",dispatchIds:[],contractIds:[],proaddr:"",cpdbtime:null,prosite:"",longitude:120.373885,latitude:30.303899,period:null,dtype:null,dispatch:"",status:1,region:null,provice:null}}const A=_(0),fe=_(void 0);async function ye(){F.value=[{longitude:120.373885,latitude:30.303899,addr:""}],Object.assign(n,pe()),Da(),Na(),d.operateType==="edit"&&d.rowData&&(await Promise.all([Ua(),Ee(),ue(),S(),ke(),lt()]),Object.assign(n,d.rowData),A.value=n.period,fe.value=n.status,Ut(n.provice),xt(n.provice),wa())}const{formRef:O,validate:oe,restoreValidation:ze}=ta(),Fe={proname:{type:"string",required:!0,trigger:["blur","change"],message:"请输入项目名称"},status:{type:"number",required:!0,trigger:["blur","change"],message:"请选择项目状态"},contractIds:{type:"array",required:!0,trigger:["blur","change"],message:"请选择合同"},dtype:{type:"number",required:!0,trigger:["blur","change"],message:"请选择调试类型"},period:{type:"number",required:!0,trigger:["blur","change"],message:"请输入周期"},prosite:{type:"string",required:!0,trigger:["blur","change","focus"],message:"请选择项目地点"},cpdbtime:{type:"string",required:!0,trigger:["blur","change"],message:"请选择时间"},provice:{type:"number",required:!0,trigger:["blur","change"],message:"请选择省份"},region:{type:"number",required:!0,trigger:["blur","change"],message:"请选择城市"}},C=_([]),W=Te({page:1,pageSize:20,showSizePicker:!0,fuzzy:"",pageSizes:[20],prefix:()=>`共 ${C.value.length} 条`,onChange:e=>{W.page=e,S()},onUpdatePageSize:e=>{W.pageSize=e,W.page=1,S()}}),K=[{title:"对接方",key:"docker",align:"center",width:150,render(e,t){return e.setStatus?u(J,{value:e.docker,placeholder:"请输入",onUpdateValue(l){C.value[t].docker=l}}):u("div",{},e.docker)}},{title:"姓名",key:"pname",align:"center",width:100,render(e,t){return e.setStatus?u(J,{value:e.pname,placeholder:"请输入姓名",onUpdateValue(l){C.value[t].pname=l}}):u("div",{},e.pname)}},{title:"联系方式",key:"pcontact",align:"center",width:150,render(e,t){return e.setStatus?u(J,{value:e.pcontact,placeholder:"请输入联系方式",onUpdateValue(l){C.value[t].pcontact=l}}):u("div",{},e.pcontact)}},{title:"备注",key:"proposition",align:"center",width:150,render(e,t){return e.setStatus?u(J,{value:e.proposition,placeholder:"请输入备注",onUpdateValue(l){C.value[t].proposition=l}}):u("div",{},e.proposition)}},{title:"操作人",width:100,key:"username",align:"center"},{title:"操作时间",key:"dbtime",width:180,align:"center",render:e=>e.dbtime?ut(1,e.dbtime):""},{key:"operate",title:P("common.operate"),align:"center",width:160,fixed:"right",render(e,t){return u("div",{class:"flex-center gap-8px"},[e.setStatus?[u(h,{type:"primary",ghost:!0,size:"small",onClick:()=>be(e)},{default:()=>"保存"}),u(h,{type:"default",ghost:!0,size:"small",onClick:()=>b(e,t)},{default:()=>"取消"}),u(De,{onPositiveClick:()=>{d.operateType==="edit"&&e.id?Ma(e.id).then(()=>{var l;C.value.splice(t,1),(l=window.$message)==null||l.success("删除成功")}):C.value.splice(t,1)}},{default:()=>P("common.confirmDelete"),trigger:()=>u(h,{type:"error",ghost:!0,size:"small"},{default:()=>P("common.delete")})})]:u(h,{type:"primary",ghost:!0,size:"small",onClick:()=>v(e)},{default:()=>"编辑"})])}}],S=async()=>{var t;const{data:e}=await Va({page:W.page,limit:W.pageSize,pid:(t=d.rowData)==null?void 0:t.id});C.value=e==null?void 0:e.list,C.value.forEach(l=>{l.setStatus=!1}),B.contactList=JSON.parse(JSON.stringify(C.value))},v=e=>{C.value.forEach(t=>{t.setStatus=!1}),e.setStatus=!e.setStatus},b=(e,t)=>{e.setStatus=!e.setStatus,e.id?C.value=JSON.parse(JSON.stringify(B.contactList)):C.value.splice(t,1)},be=async e=>{var t,l,i,c,p;if(!e.pname){(t=window.$message)==null||t.warning("请输入联系人姓名");return}if(!e.pcontact){(l=window.$message)==null||l.warning("请输入联系方式");return}if(d.operateType==="edit")if(e.id){const{data:D,error:k}=await qa([e]);k||((i=window.$message)==null||i.success("修改成功"),S(),e.setStatus=!e.setStatus)}else{const{data:D,error:k}=await Bt([{...e,pid:(c=d.rowData)==null?void 0:c.id}]);k||((p=window.$message)==null||p.success("添加成功"),S(),e.setStatus=!e.setStatus)}else e.setStatus=!e.setStatus};function U(){var e;((e=C.value[0])!=null&&e.pname||C.value.length==0)&&C.value.unshift({pname:"",pcontact:"",proposition:"",setStatus:!0})}const I=e=>{var t;n.contractIds=e,R.value=at.data.filter(l=>e.includes(l.id)).map(l=>({value:l.id,label:l.contractname,isLeaf:!1})),me((t=R.value[0])==null?void 0:t.id)},R=_([]),Ee=async()=>{var l;const{data:e,error:t}=await ia({page:1,limit:100,id:d.rowData.id});R.value=e==null?void 0:e.list.map(i=>({value:i.id,label:i.contractname,isLeaf:!1})),me((l=e==null?void 0:e.list[0])==null?void 0:l.id)},_e=_([]),xe=_(),{pageData:M,getData:Oe}=Qt(oa),me=async e=>{await Oe({pids:e}),xe.value=[],_e.value=Array.from(new Set([..._e.value,...M.data])),xe.value=M.data.map(t=>({label:t.devname,value:t.id}))},Be=async e=>{var t;await me(e.value),e.children=(t=xe.value)==null?void 0:t.map(l=>({label:l.label,value:l.value,isLeaf:!0}))},y=_([]),V=Te({page:1,pageSize:20,itemCount:0,showSizePicker:!0,fuzzy:"",pageSizes:[10,20],prefix:()=>`共 ${V.itemCount} 条`,onChange:e=>{V.page=e,ue()},onUpdatePageSize:e=>{V.pageSize=e,V.page=1,ue()}}),H=_(),Re=[{title:"绑定合同设备",key:"cid",width:300,align:"center",render(e,t){var l,i;return e.setStatus?u(Bl,{style:"width: 270px",value:e.cid,filterable:!0,placeholder:"请选择合同设备",options:R.value,checkStrategy:"child",showPath:!1,remote:!0,renderSuffix:c=>c.option.hidden?null:c.node,renderLabel:c=>c.hidden?null:c.label,onLoad:Be,onUpdateValue(c){var D;y.value[t].cid=Number(c)||0;const p=(D=_e.value)==null?void 0:D.find(k=>k.id==c);e.devname=(p==null?void 0:p.devname)||"",e.devnum=(p==null?void 0:p.devcount)||"",e.notes=(p==null?void 0:p.notes)||"",H.value=(p==null?void 0:p.devcount)||0,e.etype=(p==null?void 0:p.devtype)||0,e.devmanu=(p==null?void 0:p.devmanu)||"",e.devmodel=(p==null?void 0:p.devmodel)||"",e.devunit=(p==null?void 0:p.devunit)||""}}):u("div",{},e.devname2||((i=(l=xe.value)==null?void 0:l.find(c=>c.value==e.cid))==null?void 0:i.label))}},{title:"设备名称",key:"devname",width:200,align:"center",render(e,t){return e.setStatus?u(J,{value:e.devname,placeholder:"请输入",onUpdateValue(l){y.value[t].devname=l}}):u("div",{},e.devname)}},{title:"型号",key:"devmodel",width:220,align:"center",render(e,t){return u("div",{},e.devmodel)}},{title:"设备单位",key:"devunit",width:120,align:"center",render(e,t){return u("div",{},e.devunit)}},{title:"数量",key:"devnum",width:100,align:"center",render(e,t){return e.setStatus?u(Rt,{value:e.devnum,placeholder:"请输入",max:H.value,onUpdateValue(l){y.value[t].devnum=l}}):u("div",{},e.devnum)}},{title:"是否为我司设备",key:"etype",width:260,align:"center",render(e,t){return u("div",{},e.etype==0?"是":"否")}},{title:"设备厂家",key:"devmanu",width:200,align:"center",render(e,t){return u("div",{},e.devmanu)}},{title:"清点状态",key:"status",width:120,align:"center",render(e,t){return e.setStatus&&e.id?u(de,{value:e.status,filterable:!0,placeholder:"请选择状态",options:[{label:"未清点",value:0},{label:"正常",value:1},{label:"增补",value:2},{label:"退货",value:3},{label:"换货",value:4}],onUpdateValue(l){y.value[t].status=Number(l)||0}}):u("div",{},e.status===0?"未清点":e.status===1?"正常":e.status===2?"增补":e.status===3?"退货":"换货")}},{title:"备注",key:"notes",width:200,align:"center",render(e,t){return u("div",{},e.notes)}},{title:"文件",key:"re1",width:160,align:"center",render(e,t){return e.setStatus?u(h,{type:"primary",ghost:!0,size:"small",onClick:()=>ge(e,"debuggedDevieceList",t)},{default:()=>"上传文件"}):u(Mt,{trigger:"hover"},{trigger:()=>u("div",{style:"color: #1890ff;cursor: pointer;"},"文件列表"),default:()=>{const l=[{alias:e.re1,file:e.fl1},{alias:e.re2,file:e.fl2},{alias:e.re3,file:e.fl3},{alias:e.re4,file:e.fl4}].filter(i=>i.alias||i.file);return l.length===0?u("div",{style:"padding: 10px; color: #999;"},"暂无文件"):u("div",{style:"padding: 10px;"},[u("table",{class:"n-table n-table--bordered n-table--single-line",style:"width: 100%; border-collapse: collapse;"},[u("thead",[u("tr",[u("th",{style:"text-align:center; padding: 4px 8px;"},"文件别名"),u("th",{style:"text-align:center; padding: 4px 8px;"},"文件"),u("th",{style:"text-align:center; padding: 4px 8px;"},"操作")])]),u("tbody",l.map((i,c)=>{var p;return u("tr",[u("td",{style:"text-align:center; padding: 4px 8px;"},i.alias||"-"),u("td",{style:"text-align:center; padding: 4px 8px;"},((p=i.file)==null?void 0:p.split("?")[1])||"-"),u("td",{style:"text-align:center; padding: 4px 8px;"},u(h,{type:"primary",ghost:!0,size:"small",onClick:()=>Ft({url:i.file})},{default:()=>"下载"}))])}))])])}})}},{title:"操作信息",key:"dbtime",width:180,align:"center",render(e,t){return u(Mt,{trigger:"hover"},{trigger:()=>u("div",{style:"color: #1890ff;cursor: pointer;"},e.dbtime?ut(1,e.dbtime):""),default:()=>u("div",{style:"padding: 10px;"},a("div",null,[a("div",null,[g("操作人："),e.username]),a("div",null,[g("操作时间："),e.dbtime]),a("div",null,[g("清点人："),e.dusername]),a("div",null,[g("清点时间："),e.ddbtime])]))})}},{key:"operate",title:P("common.operate"),align:"center",width:180,fixed:"right",render(e,t){return u("div",{class:"flex-center gap-8px"},[e.setStatus?[u(h,{type:"primary",ghost:!0,size:"small",onClick:()=>vt(e)},{default:()=>"保存"}),u(h,{type:"default",ghost:!0,size:"small",onClick:()=>gt(e,t)},{default:()=>"取消"}),Ct("project:Equipment:delete")&&u(De,{onPositiveClick:async()=>{var l;if(e.id){const{data:i,error:c}=await Ja(e.id);i&&(y.value.splice(t,1),(l=window.$message)==null||l.success("删除成功"))}else y.value.splice(t,1)}},{default:()=>P("common.confirmDelete"),trigger:()=>u(h,{type:"error",ghost:!0,size:"small"},{default:()=>P("common.delete")})})]:Ct("project:Equipment:update")&&u(h,{type:"primary",ghost:!0,size:"small",onClick:()=>mt(e)},{default:()=>"编辑"})])}}],T=_([]),s=_(!1),f=_(""),Z=_(),ge=(e,t,l)=>{T.value=[],s.value=!0,f.value=t,Z.value=l,e.re1&&T.value.push({id:"",name:e.re1,url:e.fl1,status:"uploading",setStatus:!1,progress:0}),e.re2&&T.value.push({id:"",name:e.re2,url:e.fl2,status:"uploading",setStatus:!1,progress:0}),e.re3&&T.value.push({id:"",name:e.re3,url:e.fl3,status:"uploading",setStatus:!1,progress:0}),e.re4&&T.value.push({id:"",name:e.re4,url:e.fl4,status:"uploading",setStatus:!1,progress:0})},re=async()=>{var t,l;let e=!0;for(let i=0;i<T.value.length;i++){const c=T.value[i];if(!c.url){(t=window.$message)==null||t.warning(`第${i+1}个文件的文件名称不能为空`),e=!1;break}if(!c.name){(l=window.$message)==null||l.warning(`第${i+1}个文件的文件别名不能为空`),e=!1;break}y.value[Z.value][`re${i+1}`]=c.name,y.value[Z.value][`fl${i+1}`]=c.url}e&&(s.value=!1,f.value="",Z.value=void 0)},ue=async()=>{var t;const{data:e}=await Ga({page:V.page,limit:V.pageSize,fuzzy:V.fuzzy,pid:(t=d.rowData)==null?void 0:t.id});y.value=e.list,B.debuggedDevieceList=JSON.parse(JSON.stringify(y.value))},mt=async e=>{var i;console.log(M.data,e.cid,"ssssssssssssssss"),y.value.forEach(c=>{c.setStatus=!1});const{data:t,error:l}=await Ka(e.cid);l||(((i=R.value[R.value.length-1])==null?void 0:i.value)!=t.id&&R.value.push({value:t.id,label:t.devname,disabled:!0,isLeaf:!0,hidden:!0}),H.value=t.devcount||0),e.setStatus=!e.setStatus},gt=(e,t)=>{e.setStatus=!e.setStatus,e.id?y.value=JSON.parse(JSON.stringify(B.debuggedDevieceList)):y.value.splice(t,1)},vt=async e=>{var t,l,i,c,p;if(!e.cid){(t=window.$message)==null||t.warning("请选择合同设备");return}if(!e.devname){(l=window.$message)==null||l.warning("设备名称不能为空");return}if(!e.devmodel){(i=window.$message)==null||i.warning("设备型号不能为空");return}if(!e.devnum){(c=window.$message)==null||c.warning("设备数量不能为空");return}if(e.id){const{data:D,error:k}=await Ha([e]);k||((p=window.$message)==null||p.success("修改成功"),ue(),e.setStatus=!e.setStatus)}else e.setStatus=!e.setStatus};function ht(){var e;((e=y.value[0])!=null&&e.devname||y.value.length==0)&&y.value.unshift({status:void 0,devmanu:"",etype:0,devname:"",devmodel:"",devnum:0,notes:"",setStatus:!0})}const yt=()=>{s.value=!1},Xe=_({}),w=_([]);async function ke(){var t;w.value=[];const{data:e}=await tl({page:1,limit:100,pid:(t=d.rowData)==null?void 0:t.id});e.list.forEach(l=>{l.sort==1&&w.value.push({id:l.id,name:l.filename,url:l.file,status:"finished",creator:l.username,dbtime:l.dbtime})}),w.value.reverse(),Xe.value=JSON.parse(JSON.stringify(e))}const ga=[{title:"文件别名",key:"name",align:"center",width:200,render(e){return e.setStatus?u(J,{value:e.name,onUpdateValue:t=>{e.name=t}}):u("div",{},e.name)}},{title:"文件名称",key:"filename",align:"center",width:200,render(e){return e.setStatus&&!e.url?u("div",{style:"display: flex; justify-content: center; align-items: center;"},[u(Jt,{action:"#",showFileList:!1,customRequest:async({file:l,onFinish:i,onError:c})=>{var p,D;try{e.status=!0;const{data:k,error:X}=await bl(l.file,le=>{e.progress=le});k&&(e.url=k,e.status=!1)}catch(k){console.error(k),(D=(p=window.$message)==null?void 0:p.error)==null||D.call(p,"文件上传出错"),e.status=!1}}},{default:()=>u(h,{type:"info",size:"small",ghost:!0,loading:e.status},{default:()=>"上传文件"})}),e.progress?u(pt,{type:"line",percentage:e.progress,indicatorPlacement:"inside",processing:!0}):null]):e.setStatus&&e.url&&!e.id?a("span",null,[e.url.split("?")[1],g(" "),a("span",{onClick:()=>{e.url="",e.progress=0},style:"color: red;cursor: pointer;font-size: 12px;"},[g("删除")])]):u("div",{},e.url.split("?")[1])}},{title:"上传人",key:"creator",align:"center",width:100,render(e){return u("div",{},e.creator)}},{title:"上传时间",key:"dbtime",align:"center",width:200,render(e){return u("div",{},e.dbtime?e.dbtime:"")}},{title:"操作",key:"actions",align:"center",width:180,render(e){return u(ne,{justify:"center"},[!e.setStatus&&e.id&&u(h,{type:"info",size:"small",ghost:!0,onClick:()=>{Ft(e)}},{default:()=>"下载"}),e.setStatus&&u(h,{type:"info",size:"small",ghost:!0,onClick:()=>{ba(e)}},{default:()=>"保存"}),e.setStatus&&u(h,{type:"info",size:"small",ghost:!0,onClick:()=>{e.setStatus=!e.setStatus}},{default:()=>"取消"}),!e.setStatus&&u(h,{type:"info",size:"small",ghost:!0,onClick:()=>{e.setStatus=!e.setStatus}},{default:()=>"编辑"}),Ct("project:File:delete")&&(x.userInfo.usertype==0||x.userInfo.usertype==2)&&u(De,{onPositiveClick:async()=>{var t;if(e.id){const{data:l,error:i}=await ml(e.url),{data:c,error:p}=await gl(e.id);p||(t=window.$message)==null||t.success("删除成功")}else w.value=w.value.filter(l=>l!==e)}},{default:()=>P("common.confirmDelete"),trigger:()=>u(h,{type:"error",ghost:!0,size:"small"},{default:()=>P("common.delete")})})])}}],va=[{title:"文件名称",key:"filename",align:"center",render(e){if(!e.url){const t=async({file:i,onFinish:c,onError:p})=>{var D,k;try{e.status=!0;const X=await vl(i.file,i.name,"",le=>{e.progress=le});X&&(e.url=X,e.name=i.name,e.status=!1)}catch(X){console.error(X),(k=(D=window.$message)==null?void 0:D.error)==null||k.call(D,"文件上传出错"),e.status=!1}};async function l(i){var c;return i.file.file.size>100*1024*1024?((c=window.$message)==null||c.error("文件大小不能超过100M"),!1):!0}return u("div",{style:"display: flex; justify-content: center; align-items: center;"},[u(Jt,{action:"#",showFileList:!1,customRequest:t,onBeforeUpload:l},{default:()=>u(h,{type:"info",size:"small",ghost:!0,loading:e.status},{default:()=>"上传文件"})}),e.progress?u(pt,{type:"line",percentage:e.progress,indicatorPlacement:"inside",processing:!0}):null])}return e.url&&!e.id?a("span",null,[e.url.split("?")[1],g(" "),a("span",{onClick:()=>{e.url="",e.progress=0,e.status=!1},style:"color: red;cursor: pointer;font-size: 12px;"},[g("删除")])]):u("div",{},e.url.split("?")[1])}},{title:"文件别名",key:"name",align:"center",render(e){return u(J,{value:e.name,onUpdateValue:t=>{e.name=t}})}},{title:"操作",key:"actions",align:"center",width:100,render(e){return u(ne,{justify:"center"},[u(h,{type:"error",size:"small",ghost:!0,onClick:()=>{T.value=T.value.filter(t=>t!==e)}},{default:()=>"删除"})])}}];async function Ft(e){if(e!=null&&e.url)try{const l=await(await fetch(e.url.split("?")[0],{mode:"cors"})).blob(),i=URL.createObjectURL(l),c=document.createElement("a");c.href=i,c.download=e.url.split("?")[1],c.style.display="none",document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(i)}catch(t){console.error("下载失败:",t)}}const ha=()=>{var e,t;if(T.value.length>=4)return(t=(e=window.$message)==null?void 0:e.warning)==null?void 0:t.call(e,"最多上传4个文件");T.value.push({id:"",name:"",url:"",status:!1,setStatus:!0,progress:0})},ya=()=>{w.value.push({id:"",name:"",url:"",status:!1,setStatus:!0})},ba=async e=>{var t,l,i,c,p,D,k,X,le,Ie,Ae,Se;if(!e.name){(l=(t=window.$message)==null?void 0:t.warning)==null||l.call(t,"请输入文件别名");return}if(!e.url){(c=(i=window.$message)==null?void 0:i.warning)==null||c.call(i,"请上传文件");return}if((p=d.rowData)!=null&&p.id){const{data:q,error:Le}=await Xt([{pid:(D=d.rowData)==null?void 0:D.id,filename:e.name,file:e.url,sort:1}]);if(Le)return(k=window.$message)==null?void 0:k.error("保存文件记录失败");(X=window.$message)==null||X.destroyAll(),e.setStatus=!e.setStatus,ke(),(le=window.$message)==null||le.success("保存成功")}else if(e.id){const{data:q,error:Le}=await hl([{id:e.id,filename:e.name}]);if(Le)return(Ie=window.$message)==null?void 0:Ie.error("保存文件记录失败");(Ae=window.$message)==null||Ae.destroyAll(),e.setStatus=!e.setStatus,(Se=window.$message)==null||Se.success("编辑成功")}else e.setStatus=!e.setStatus},_a=Xa(()=>({add:"新增项目",edit:"修改项目"})[d.operateType]),Ne=wt(Q,"visible");dt(Ne,()=>{Ne.value&&(ye(),setTimeout(()=>{const e=document.querySelector(".n-scrollbar-content");e==null||e.scrollTo(0,0)},300),ze())});function xa(e){e||Pe()}function Pe(){Ne.value=!1}async function Pt(){var e;await oe(),(e=window.$dialog)==null||e.info({title:"提示",content:"确定提交吗？",positiveText:"确定",negativeText:"取消",onPositiveClick:async()=>{await ka()}})}async function ka(){var e,t,l,i,c,p,D,k,X,le,Ie,Ae,Se;if(d.operateType==="edit"){const q=JSON.parse(JSON.stringify(n));A.value==q.period&&delete q.period,fe.value==q.status&&delete q.status;const{data:Le,error:m}=await ra([q]);if(!m){let L=function(Y,se){const te=Y.filter(we=>!se.includes(we)),je=se.filter(we=>!Y.includes(we));return{toDelete:te,toAdd:je}};if((e=n.dispatchIds)!=null&&e.length&&((t=n.dispatchIds)==null?void 0:t.length)>0){const{toDelete:Y,toAdd:se}=L(Nt.value,n.dispatchIds);if(se.length>0){const te=se.map(st=>({pid:n.id,did:st})),{data:je,error:we}=await Gt(te)}if(Y.length>0){const{data:te,error:je}=await al(Y.join(","))}}if((l=n.contractIds)!=null&&l.length&&((i=n.contractIds)==null?void 0:i.length)>0){const{toDelete:Y,toAdd:se}=L(Et.value,n.contractIds);if(se.length>0){const te=se.map(st=>({pid:n.id,did:st})),{data:je,error:we}=await Kt(te)}if(Y.length>0){const{data:te,error:je}=await ll(Y.join(","))}}Pe(),ae("submitted"),(c=window.$message)==null||c.success("修改成功")}}else{const q=sl(),{data:Le,error:m}=await nl([{...n,uuid:q}]);if(!m){const{data:L,error:Y}=await il(q);if(L){let se=function(N,Ue,Ot){return N.map(Je=>({...Je,pid:Ue}))};if(n.dispatchIds&&n.dispatchIds.length>0){const N=[];(p=n.dispatchIds)==null||p.forEach(Je=>{N.push({pid:L,did:Je})});const{data:Ue,error:Ot}=await Gt(N)}if(n.contractIds&&n.contractIds.length>0){const N=[];(D=n.contractIds)==null||D.forEach(async Je=>{N.push({proid:L,conid:Je})});const{data:Ue,error:Ot}=await Kt(N)}const te=[];if(C.value.length>0){const N=se(C.value,L);te.push(Bt(N))}if(y.value.length>0){const N=se(y.value,L);te.push(ol(N))}if(F.value.length>0&&te.push(Ht(F.value)),(await Promise.allSettled(te)).forEach((N,Ue)=>{N.status==="fulfilled"?console.log(`第 ${Ue+1} 个请求成功`,N.value):console.error(`第 ${Ue+1} 个请求失败`,N.reason)}),!w.value.length){(k=window.$message)==null||k.destroyAll(),(X=window.$message)==null||X.success("操作成功"),Pe(),ae("submitted");return}const we=[];w.value.forEach(N=>{we.push({pid:L,filename:N.name,file:N.url,sort:1})});const{data:st,error:Oa}=await Xt(we);Oa&&((le=window.$message)==null||le.error("保存文件记录失败")),(Ie=window.$message)==null||Ie.destroyAll(),(Ae=window.$message)==null||Ae.success("操作成功"),Pe(),ae("submitted")}}Pe(),ae("submitted"),(Se=window.$message)==null||Se.success("添加成功")}}const $e=_(!1),bt=_();let Ce=null,Me=null,Ye=null,Ca=null,$t=null,ve=null;const ee=Te({longitude:0,latitude:0});let Ve;const Qe=_(!1),he=_(""),We=_([]);let Ze=0;async function It(){try{if(window._AMapSecurityConfig={securityJsCode:x.userInfo.sdksecret},!bt.value)return;ve=await Tl.load({key:x.userInfo.sdkkey,version:"2.0",plugins:["AMap.Scale","AMap.PlaceSearch","AMap.AutoComplete","AMap.Geocoder","AMap.Geolocation"]}),Ce=new ve.Map(bt.value,{zoom:18,center:[z.value>0?F.value[z.value-1].longitude:n.longitude,z.value>0?F.value[z.value-1].latitude:n.latitude],viewMode:"3D",resizeEnable:!0}),Me=new ve.Geocoder,Ca=new ve.PlaceSearch({city:"全国",pageSize:50}),$t=new ve.AutoComplete({city:"全国"}),et(ve,{lng:z.value>0?F.value[z.value-1].longitude:n.longitude,lat:z.value>0?F.value[z.value-1].latitude:n.latitude}),Ce.on("click",e=>{const{lng:t,lat:l}=e.lnglat;Ve=2,ee.latitude=l,ee.longitude=t,et(ve,{lng:t,lat:l})}),Ze=0,kt(()=>{window.dispatchEvent(new Event("resize"))})}catch(e){console.error("地图加载失败：",e),Ze<ts?(Ze++,console.warn(`地图加载失败，正在第 ${Ze} 次重试...`),setTimeout(()=>{It()},1500)):console.error("地图加载失败，已达到最大重试次数，停止重试")}}const At=aa.debounce(async e=>{if(!Qe.value||!e.trim()){We.value=[];return}$t.search(e,(t,l)=>{var i;console.log(l,"result"),t=="complete"&&l.info=="OK"&&((i=l==null?void 0:l.tips)!=null&&i.length)?We.value=l.tips.map(c=>({label:`${c.name}（${c.district||c.address||"无详细地址"}）`,value:`${c.location.lng}_${c.location.lat}`,raw:c})):We.value=[]})},300);dt(he,e=>{At(e)});function Sa(e,t){if(console.log(e,t,"option"),!e)return;const[l,i]=e.split("_").map(Number);!l||!i||(Ce.setCenter([l,i]),Ve=1,et(ve,{lng:l,lat:i}),ee.longitude=l,ee.latitude=i)}const z=_(0);function Lt(e){e?z.value=e:z.value=0,$e.value=!0,Qe.value=!1,Ve=void 0,kt(async()=>{await It(),setTimeout(()=>{Qe.value=!0;const t=document.querySelector(".n-auto-complete input");t==null||t.blur(),console.log(n),n.region&&!n.prosite&&!n.prosite&&_t(n.region)},500)})}function et(e,t){Ye&&Ce.remove(Ye),Ye=new e.Marker({position:[t.lng,t.lat],map:Ce}),Ce.add(Ye),Me.getAddress(t,async(l,i)=>{l==="complete"&&i.regeocode&&(console.log("result",i),console.log("formattedAddress",i.regeocode.formattedAddress),t.latitude=t.lat,t.longitude=t.lng,Ve==1?n.proaddr=i.regeocode.formattedAddress:Ve==2?(he.value=i.regeocode.formattedAddress,n.proaddr=i.regeocode.formattedAddress,n.provice=Fa(n.proaddr,tt.value),await xt(n.provice),n.region=Pa(n.proaddr,qe.value)):he.value=z.value>0?F.value[z.value-1].addr||i.regeocode.formattedAddress:n.prosite||i.regeocode.formattedAddress)})}const Nt=_([]),wa=async()=>{const{data:e,error:t}=await rl({page:1,limit:100,pid:d.rowData.id});n.dispatchIds=e==null?void 0:e.list.map(l=>l.did),Nt.value=JSON.parse(JSON.stringify(n.dispatchIds))},jt=_([]),Ut=async e=>{if(!e)return;const{data:t,error:l}=await ul({page:1,limit:100,province:e});jt.value=t.list},tt=_([]),Da=async()=>{const{data:e,error:t}=await ua();e&&(tt.value=e)},Tt=e=>{xt(e),n.region=null,n.prosite="",n.proaddr="",he.value="",Ut(e)},_t=e=>{var l;const t=(l=qe.value.find(i=>i.id===e))==null?void 0:l.name;n.region&&n.prosite&&n.proaddr&&!Me?(n.prosite="",n.proaddr=""):za(t)},qe=_([]),xt=async e=>{var i;if(!e)return(i=window.$message)==null?void 0:i.warning("请先选择省份");const{data:t,error:l}=await da({province:e});t&&(qe.value=t)};function za(e){!e||!Me||!Ce||Me.getLocation(e,(t,l)=>{var i;if(t==="complete"&&((i=l.geocodes)!=null&&i.length)){const{location:c,formattedAddress:p}=l.geocodes[0],D=c.lng,k=c.lat;Ce.setZoomAndCenter(14,[D,k]),ee.longitude=D,ee.latitude=k,n.latitude=ee.latitude,n.longitude=ee.longitude,et(ve,{lng:D,lat:k}),n.proaddr=p,n.prosite=p,he.value=p}})}function Fa(e,t){let l=null;for(const i of t)if(e.includes(i.name)){l=i.id;break}return l}function Pa(e,t){let l=null;for(const i of t)if(e.includes(i.name)){l=i.id;break}return l}const $a=async()=>{var e,t,l;if(z.value==0)n.latitude=ee.latitude,n.longitude=ee.longitude,n.prosite=he.value;else if(F.value[z.value-1].addr=he.value,F.value[z.value-1].latitude=ee.latitude,F.value[z.value-1].longitude=ee.longitude,d.operateType=="edit"){let i=F.value[z.value-1];if(F.value[z.value-1].id){const{data:c,error:p}=await dl([i]);c&&((e=window.$message)==null||e.success("修改位置成功"),$e.value=!1,z.value=0,lt())}else{i.pid=(t=d.rowData)==null?void 0:t.id;const{data:c,error:p}=await Ht([i]);c&&((l=window.$message)==null||l.success("添加位置成功"),$e.value=!1,z.value=0,lt())}}$e.value=!1,z.value=0};function Ia(){$e.value=!1}const{pageData:at,getData:Aa,nextPage:La}=Qt(cl),Na=async()=>{await Aa({limit:100})},ja=async e=>{const t=e.currentTarget,l=t.scrollTop;t.scrollTop+t.offsetHeight>=t.scrollHeight&&at.data.length<at.total&&(await La(),await kt(),setTimeout(()=>{t.scrollTop=l}))},Et=_([]),Ua=async()=>{var l;const{data:e,error:t}=await pl({page:1,limit:100,proid:(l=d.rowData)==null?void 0:l.id});n.contractIds=e==null?void 0:e.list.map(i=>i.conid),Et.value=JSON.parse(JSON.stringify(n.contractIds))},F=_([{longitude:120.373885,latitude:30.303899,addr:""}]),Ta=_([]),lt=async()=>{var l;const{data:e,error:t}=await fl({pid:(l=d.rowData)==null?void 0:l.id,page:1,limit:99});F.value=e.list.length==0?[{longitude:120.373885,latitude:30.303899,addr:""}]:e.list,Ta.value=JSON.parse(JSON.stringify(F.value))},Ea=async e=>{var t;if(e.id){const{data:l,error:i}=await yl(e.id);l&&((t=window.$message)==null||t.success("删除成功"),lt())}else F.value.splice(F.value.indexOf(e),1)};return(e,t)=>{const l=ma,i=jl,c=Wa,p=Nl,D=Zt,k=ct,X=fa,le=la,Ie=Qa,Ae=Ya,Se=na,q=el,Le=Ul;return $(),ot(Vt,null,[a(Ae,{show:Ne.value,"onUpdate:show":[t[15]||(t[15]=m=>Ne.value=m),xa],"display-directive":"show",width:1100,onMaskClick:t[16]||(t[16]=m=>Ne.value=!0),onEsc:Pe},{default:o(()=>[a(Ie,{title:_a.value,"native-scrollbar":!1,closable:""},{footer:o(()=>[a(r(ne),{size:16,justify:"end"},{default:o(()=>[a(r(h),{onClick:Pe},{default:o(()=>[g(G(r(P)("common.cancel")),1)]),_:1}),a(r(h),{type:"primary",onClick:Pt},{default:o(()=>[g(G(r(P)("common.confirm")),1)]),_:1})]),_:1})]),default:o(()=>[a(le,{ref_key:"formRef",ref:O,model:n,rules:Fe,onKeyup:sa(Pt,["enter"])},{default:o(()=>[a(X,{responsive:"screen","item-responsive":"","x-gap":"15"},{default:o(()=>[a(l,{span:"24 s:12 m:12",label:"项目名称",path:"proname"},{default:o(()=>[a(r(J),{clearable:"",value:n.proname,"onUpdate:value":t[0]||(t[0]=m=>n.proname=m),placeholder:"请输入项目名称"},null,8,["value"])]),_:1}),d.operateType==="add"?($(),E(l,{key:0,span:"24 s:12 m:12",label:"绑定合同",path:"contractIds"},{default:o(()=>[a(r(de),{filterable:"",multiple:"",value:n.contractIds,"onUpdate:value":[t[1]||(t[1]=m=>n.contractIds=m),I],placeholder:"请选择合同","label-field":"contractname","value-field":"id",options:r(at).data,onScroll:ja},null,8,["value","options"])]),_:1})):ce("",!0),d.operateType==="edit"?($(),E(l,{key:1,span:"24 s:12 m:12",label:"项目状态",path:"status"},{default:o(()=>[a(r(de),{filterable:"",value:n.status,"onUpdate:value":t[2]||(t[2]=m=>n.status=m),placeholder:"请选择项目状态",options:r(He)(r(x).userInfo.usertype==0||r(x).userInfo.usertype==2?r(zt):r(El))},null,8,["value","options"])]),_:1})):ce("",!0),a(l,{span:"24 s:12 m:12",label:"周期（天）",path:"period"},{default:o(()=>[a(r(Rt),{clearable:"",value:n.period,"onUpdate:value":t[3]||(t[3]=m=>n.period=m),style:{width:"100%"},placeholder:"请输入周期"},null,8,["value"])]),_:1}),a(l,{span:"24 s:12 m:12",label:"调试类型",path:"dtype"},{default:o(()=>[a(r(de),{filterable:"",value:n.dtype,"onUpdate:value":t[4]||(t[4]=m=>n.dtype=m),placeholder:"请选择调试类型",options:r(He)(r(pa))},null,8,["value","options"])]),_:1}),a(l,{span:"24 s:12 m:12",label:"省份",path:"provice"},{default:o(()=>[a(r(de),{filterable:"",value:n.provice,"onUpdate:value":[t[5]||(t[5]=m=>n.provice=m),Tt],placeholder:"请选择省份","label-field":"name","value-field":"id",options:tt.value},null,8,["value","options"])]),_:1}),a(l,{span:"24 s:12 m:12",label:"地区",path:"region"},{default:o(()=>[a(r(de),{filterable:"",value:n.region,"onUpdate:value":[t[6]||(t[6]=m=>n.region=m),_t],placeholder:"请选择地区","label-field":"name","value-field":"id",options:qe.value},null,8,["value","options"])]),_:1}),a(l,{span:"24 s:12 m:12",label:"项目默认地点",path:"prosite"},{default:o(()=>[j("div",Jl,[j("div",Gl,[a(c,{onClick:t[8]||(t[8]=m=>Lt())},{default:o(()=>[a(r(J),{value:n.prosite,"onUpdate:value":t[7]||(t[7]=m=>n.prosite=m),placeholder:"请选择项目地点"},null,8,["value"]),a(r(h),null,{icon:o(()=>[a(i,{class:"text-icon"})]),_:1})]),_:1})])])]),_:1}),a(l,{span:"24 s:12 m:12",label:"项目详细地址",path:"proaddr"},{default:o(()=>[a(r(J),{type:"textarea",rows:1,clearable:"",value:n.proaddr,"onUpdate:value":t[9]||(t[9]=m=>n.proaddr=m),placeholder:"请输入项目详细地址"},null,8,["value"])]),_:1}),F.value.length?($(),E(l,{key:2,span:"24 s:12 m:24",label:"",path:""},{default:o(()=>[j("div",Kl,[j("div",Hl,[j("span",{class:"mr-10px",onClick:t[10]||(t[10]=qt(()=>{},["stop"]))},"其他地址"),a(r(h),{size:"small",ghost:"",type:"primary",onMousedown:t[11]||(t[11]=qt(()=>{},["stop"])),onClick:t[12]||(t[12]=m=>F.value.push({latitude:30.303899,longitude:120.373885,addr:""}))},{icon:o(()=>[a(p,{class:"text-icon"})]),default:o(()=>[t[23]||(t[23]=g(" 添加 "))]),_:1,__:[23]})]),j("div",Xl,[($(!0),ot(Vt,null,Za(F.value,(m,L)=>($(),ot("div",{class:"flex px-50px items-center mt-10px w-100%",key:m.latitude},[j("span",Yl,"项目地址"+G(L+1),1),a(c,{onClick:Y=>Lt(L+1)},{default:o(()=>[a(r(J),{readonly:"",value:m.addr,"onUpdate:value":Y=>m.addr=Y,placeholder:"请选择项目地址"+(L+1)},null,8,["value","onUpdate:value","placeholder"]),a(r(h),null,{icon:o(()=>[a(i,{class:"text-icon"})]),_:1})]),_:2},1032,["onClick"]),F.value.length>1?($(),E(r(De),{key:0,onPositiveClick:Y=>Ea(m)},{trigger:o(()=>[a(r(h),{size:"small",ghost:"",type:"error",class:"ml-10px"},{icon:o(()=>[a(D,{class:"text-icon"})]),default:o(()=>[t[24]||(t[24]=g(" "+G("删除")))]),_:1,__:[24]})]),default:o(()=>[g(" 确定要删除项目地址"+G(L+1)+"吗？ ",1)]),_:2},1032,["onPositiveClick"])):ce("",!0)]))),128))])])]),_:1})):ce("",!0),a(l,{span:"24 s:12 m:12",label:"调度名称",path:"dispatch"},{default:o(()=>[a(r(J),{clearable:"",value:n.dispatch,"onUpdate:value":t[13]||(t[13]=m=>n.dispatch=m),placeholder:"请输入调度名称"},null,8,["value"])]),_:1}),a(l,{span:"24 s:12 m:12",label:"选择调度",path:"dispatchIds"},{default:o(()=>[a(r(de),{filterable:"",multiple:"",value:n.dispatchIds,"onUpdate:value":t[14]||(t[14]=m=>n.dispatchIds=m),placeholder:"请选择调度","label-field":"dname","value-field":"id",options:jt.value},null,8,["value","options"])]),_:1}),a(l,{span:"24 s:12 m:24",path:"contactList"},{default:o(()=>[j("div",Ql,[a(r(ne),{align:"center",style:{"margin-bottom":"10px"}},{default:o(()=>[t[26]||(t[26]=j("span",null,"项目联系人",-1)),a(r(h),{size:"small",ghost:"",type:"primary",onClick:U},{icon:o(()=>[a(p,{class:"text-icon"})]),default:o(()=>[t[25]||(t[25]=g(" 添加项目联系人 "))]),_:1,__:[25]})]),_:1,__:[26]}),C.value.length>0?($(),E(k,{key:0,columns:K,"paginate-single-page":!1,data:C.value,pagination:W,"max-height":350,"scroll-x":K.reduce((m,L)=>m+L.width,0)},null,8,["data","pagination","scroll-x"])):ce("",!0)])]),_:1}),a(l,{span:"24 s:12 m:24",path:"debuggedDevieceList"},{default:o(()=>[j("div",Wl,[a(r(ne),{align:"center",style:{"margin-bottom":"10px"}},{default:o(()=>[t[28]||(t[28]=j("span",null,"待调试设备",-1)),a(r(h),{size:"small",ghost:"",type:"primary",onClick:ht},{icon:o(()=>[a(p,{class:"text-icon"})]),default:o(()=>[t[27]||(t[27]=g(" 添加待调试设备 "))]),_:1,__:[27]})]),_:1,__:[28]}),y.value.length>0?($(),E(k,{key:0,style:{width:"1050px"},columns:Re,data:y.value,size:"small","scroll-x":Re.reduce((m,L)=>m+L.width,0),"row-key":m=>m.id,"max-height":350,pagination:V.pageSize==1?!1:V,remote:"","paginate-single-page":!1},null,8,["data","scroll-x","row-key","pagination"])):ce("",!0)])]),_:1}),a(l,{span:"24 s:12 m:24"},{default:o(()=>[j("div",Zl,[a(r(ne),{align:"center",style:{"margin-bottom":"10px"}},{default:o(()=>[t[30]||(t[30]=j("span",null,"图纸",-1)),a(r(h),{size:"small",ghost:"",type:"primary",onClick:ya},{icon:o(()=>[a(p,{class:"text-icon"})]),default:o(()=>[t[29]||(t[29]=g(" 添加图纸 "))]),_:1,__:[29]})]),_:1,__:[30]}),w.value.length>0?($(),E(k,{key:0,columns:ga,data:w.value,size:"small","scroll-x":702,"row-key":m=>m.id,"max-height":350},null,8,["data","row-key"])):ce("",!0)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"]),a(Se,{show:s.value,"onUpdate:show":t[17]||(t[17]=m=>s.value=m),preset:"card",class:"w-800px","mask-closable":!1,draggable:!0},{header:o(()=>[g(G(f.value=="debuggedDevieceList"?"待调试设备":f.value=="debuggedBusinessList"?"待调试业务":f.value=="needsList"?"客户需求变更":f.value=="developBusinessList"?"需要开发":"")+" 文件列表 ",1)]),footer:o(()=>[a(r(ne),{justify:"end"},{default:o(()=>[a(r(h),{size:"small",class:"mt-16px",onClick:yt},{default:o(()=>[g(G(r(P)("common.cancel")),1)]),_:1}),a(r(h),{type:"primary",size:"small",class:"mt-16px",onClick:re},{default:o(()=>[g(G(r(P)("common.confirm")),1)]),_:1})]),_:1})]),default:o(()=>[a(r(h),{size:"small",ghost:"",type:"primary",onClick:ha},{icon:o(()=>[a(p,{class:"text-icon"})]),default:o(()=>[t[31]||(t[31]=g(" 添加 "))]),_:1,__:[31]}),a(k,{columns:va,"paginate-single-page":!1,data:T.value,"max-height":350},null,8,["data"])]),_:1},8,["show"]),a(Se,{show:$e.value,"onUpdate:show":t[22]||(t[22]=m=>$e.value=m),title:"选择项目位置",preset:"card",class:"w-800px"},{footer:o(()=>[a(r(ne),{justify:"end",size:16},{default:o(()=>[a(r(h),{onClick:Ia},{default:o(()=>[g(G(r(P)("common.cancel")),1)]),_:1}),a(r(h),{type:"primary",onClick:$a},{default:o(()=>[g(G(r(P)("common.confirm")),1)]),_:1})]),_:1})]),default:o(()=>[a(r(ne),null,{default:o(()=>[a(q,{label:"省份",path:"provice","label-placement":"left","label-width":"70"},{default:o(()=>[a(r(de),{filterable:"",value:n.provice,"onUpdate:value":[t[18]||(t[18]=m=>n.provice=m),Tt],placeholder:"请选择省份","label-field":"name","value-field":"id",options:tt.value},null,8,["value","options"])]),_:1}),a(q,{label:"地区",path:"region","label-placement":"left","label-width":"70"},{default:o(()=>[a(r(de),{filterable:"",value:n.region,"onUpdate:value":[t[19]||(t[19]=m=>n.region=m),_t],placeholder:"请选择地区","label-field":"name","value-field":"id",options:qe.value},null,8,["value","options"])]),_:1})]),_:1}),Qe.value?($(),E(q,{key:0,label:z.value==0?"项目地址":"项目地址"+z.value,"label-placement":"left"},{default:o(()=>[j("div",es,[a(Le,{value:he.value,"onUpdate:value":[t[20]||(t[20]=m=>he.value=m),r(At)],options:We.value,style:{"margin-bottom":"7px"},placeholder:"请输入地点关键字",clearable:"",onSelect:Sa},null,8,["value","options","onUpdate:value"]),z.value==0?($(),E(r(J),{key:0,type:"textarea",rows:2,clearable:"",value:n.proaddr,"onUpdate:value":t[21]||(t[21]=m=>n.proaddr=m),placeholder:"请输入详细地址"},null,8,["value"])):ce("",!0)])]),_:1},8,["label"])):ce("",!0),j("div",{ref_key:"domRef",ref:bt,class:"h-full w-full",style:{width:"100%",height:"500px","margin-top":"10px"}},null,512)]),_:1},8,["show"])],64)}}}),ls=ft({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:rt(["reset","search"],["update:model"]),setup(Q,{emit:ie}){_l();const x=ie,{formRef:ae,restoreValidation:B}=ta(),d=wt(Q,"model"),n={当日:()=>{const v=new Date().getTime();return[v,v]},本周:()=>{const v=new Date().getTime();return[v-24*60*60*1e3*7,v]},上月:()=>{const v=new Date().getTime();return[v-24*60*60*1e3*30,v]},近一年:()=>{const v=new Date().getTime();return[v-24*60*60*1e3*365,v]},近三年:()=>{const v=new Date().getTime();return[v-24*60*60*1e3*365*3,v]}};function pe(){d.value.fuzzy="",x("search")}const A=_([]);(async()=>{const{data:v,error:b}=await ua();v&&(A.value=v)})();const ye=v=>{ze(v),d.value.regions=null,d.value.region=null,x("search")},O=v=>{var b;d.value.region=v,d.value.regions=(b=d.value.region)==null?void 0:b.join(","),x("search")},oe=_([]),ze=async v=>{var U;if(!v)return(U=window.$message)==null?void 0:U.warning("请先选择省份");const{data:b,error:be}=await da({province:v});b&&(oe.value=b)};async function Fe(v,b){if(!v){d.value.startTime=void 0,d.value.endTime=void 0,x("search");return}d.value.startTime=String(ut(1,b[0])),d.value.endTime=String(ut(1,b[1])),x("search")}async function C(){d.value.startTime=void 0,d.value.endTime=void 0,d.value.startAndTimeRange=null,d.value.fuzzy="",d.value.status=null,d.value.ptype=null,d.value.dtype=null,d.value.region=null,d.value.regions=null,d.value.provice=null,await B(),x("reset")}const W=aa.debounce(v=>{x("search")},1e3,{leading:!0,trailing:!1}),K=v=>{d.value.fuzzy=v,W(v)};async function S(){x("search")}return(v,b)=>{const be=J,U=ma,I=de,R=Vl,Ee=Ml,_e=h,xe=Rl,M=ne,Oe=fa,me=la,Be=Dt;return $(),E(Be,{bordered:!1,size:"small",class:"card-wrapper"},{default:o(()=>[a(me,{ref_key:"formRef",ref:ae,model:d.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:sa(S,["enter"])},{default:o(()=>[a(Oe,{responsive:"screen","item-responsive":"","x-gap":16,"y-gap":16},{default:o(()=>[a(U,{span:"24 s:12 m:6",label:"项目/客户",path:"fuzzy"},{default:o(()=>[a(be,{clearable:"",value:d.value.fuzzy,"onUpdate:value":b[0]||(b[0]=y=>d.value.fuzzy=y),placeholder:"请输入项目名称或客户名称",onClear:pe,onInput:K},null,8,["value"])]),_:1}),a(U,{span:"24 s:12 m:6",label:"项目状态",path:"status"},{default:o(()=>[a(I,{clearable:"",filterable:"",value:d.value.status,"onUpdate:value":[b[1]||(b[1]=y=>d.value.status=y),S],placeholder:"请选择项目状态",options:r(He)(r(zt)).sort((y,V)=>y.value-V.value)},null,8,["value","options"])]),_:1}),a(U,{span:"24 s:12 m:6",label:"进度状态",path:"ptype"},{default:o(()=>[a(I,{clearable:"",filterable:"",value:d.value.ptype,"onUpdate:value":[b[2]||(b[2]=y=>d.value.ptype=y),S],placeholder:"请选择进度状态",options:[{label:"正常",value:0},{label:"已延期",value:1}]},null,8,["value"])]),_:1}),a(U,{span:"24 s:12 m:6",label:"调试类型",path:"dtype"},{default:o(()=>[a(I,{clearable:"",filterable:"",value:d.value.dtype,"onUpdate:value":[b[3]||(b[3]=y=>d.value.dtype=y),S],placeholder:"请选择调试类型",options:r(He)(r(pa))},null,8,["value","options"])]),_:1}),a(U,{span:"24 s:12 m:6",label:"省份",path:"provice"},{default:o(()=>[a(I,{filterable:"",value:d.value.provice,"onUpdate:value":[b[4]||(b[4]=y=>d.value.provice=y),ye],placeholder:"请选择省份","label-field":"name","value-field":"id",clearable:"",options:A.value},null,8,["value","options"])]),_:1}),a(U,{span:"24 s:12 m:6",label:"地区",path:"region"},{default:o(()=>[a(I,{filterable:"",value:d.value.region,"onUpdate:value":[b[5]||(b[5]=y=>d.value.region=y),O],placeholder:"请选择地区","label-field":"name","value-field":"id",clearable:"",multiple:"",options:oe.value},null,8,["value","options"])]),_:1}),a(U,{span:"24 s:12 m:8",label:"起止时间"},{default:o(()=>[a(R,{value:d.value.startAndTimeRange,"onUpdate:value":b[6]||(b[6]=y=>d.value.startAndTimeRange=y),type:"datetimerange",clearable:"",shortcuts:n,"onUpdate:formattedValue":Fe},null,8,["value"])]),_:1}),a(U,{span:"24  s:12 m:4",class:"pr-24px"},{default:o(()=>[a(M,{class:"w-full"},{default:o(()=>[a(_e,{onClick:C},{icon:o(()=>[a(Ee,{class:"text-icon"})]),default:o(()=>[g(" "+G(r(P)("common.reset")),1)]),_:1}),a(_e,{type:"primary",ghost:"",onClick:S},{icon:o(()=>[a(xe,{class:"text-icon"})]),default:o(()=>[g(" "+G(r(P)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),ss={class:"min-h-500px flex gap-16px"},ns={class:"flex items-center justify-end gap-16px"},is=ft({__name:"relatedContractLook",props:rt({id:{}},{visable:{type:Boolean},visableModifiers:{}}),emits:["update:visable"],setup(Q){const ie=Q,x=wt(Q,"visable"),{columns:ae,data:B,getData:d,loading:n,mobilePagination:pe,searchParams:A}=St({apiFn:ia,immediate:!1,apiParams:{page:1,pageSize:20,limit:20,id:ie.id,_t:new Date().getTime()},columns:()=>[{key:"contractname",title:"合同",width:200,render:S=>a("div",{class:C.pids==S.id?"bg-#f1f1f1 cursor-pointer p-5px":"cursor-pointer p-5px",onClick:()=>W(S.id)},[a("div",{class:"flex"},[a("div",{class:"w-60px inline-block"},[g("名称：")]),S.contractname]),a("div",{class:"font-size-12px c-#7d7575 flex"},[a("div",{class:"w-60px inline-block"},[g("编号：")]),g(" "),S.contractnum]),a("div",{class:"font-size-12px c-#7d7575 flex"},[a("div",{class:"w-60px inline-block"},[g("联系人：")]),S.businesscon]),a("div",{class:"font-size-12px c-#7d7575 flex"},[a("div",{class:"w-60px inline-block"},[g("联系方式：")]),S.businessinfo]),a("div",{class:"font-size-12px c-#7d7575 flex"},[a("div",{class:"w-60px inline-block"},[g("注意事项：")]),S.precautions]),a("div",{class:"font-size-12px c-#7d7575 flex"},[a("div",{class:"w-60px inline-block"},[g("备注：")]),S.notes])])}]}),{columns:fe,data:ye,getData:O,loading:oe,pagination:ze,mobilePagination:Fe,searchParams:C}=St({apiFn:oa,immediate:!1,apiParams:{page:1,pageSize:20,limit:20,pids:ie.id,_t:new Date().getTime()},columns:()=>[{key:"devname",title:"设备名称",align:"center",width:200,ellipsis:{tooltip:!0}},{key:"devcount",title:"数量",align:"center",width:120},{key:"devmodel",title:"规格型号",align:"center",width:120,ellipsis:{tooltip:!0}},{key:"devunit",title:"单位",align:"center",width:120},{key:"devtype",title:"是否为我司设备",align:"center",width:120,render:S=>S.devtype==0?a(Ke,{type:"success"},{default:()=>[g("是")]}):a(Ke,{type:"info"},{default:()=>[g("否")]})},{key:"devmanu",title:"设备厂家",align:"center",width:120},{key:"notes",title:"备注",align:"center",width:120},{key:"username",title:"创建人",align:"center",width:120},{key:"dbtime",title:"创建时间",align:"center",width:180}]}),W=S=>{C.pids=S,O()},K=()=>{x.value=!1};return dt(()=>x.value,async S=>{var v;S&&(A.id=ie.id,ye.value=[],ze.itemCount=0,await d(),C.pids=(v=B.value[0])==null?void 0:v.id,C.pids&&O())}),(S,v)=>{const b=ct,be=Dt,U=na;return $(),E(U,{show:x.value,"onUpdate:show":v[0]||(v[0]=I=>x.value=I),preset:"card",class:"w-1400px",title:"项目关联的合同"},{footer:o(()=>[j("div",ns,[a(r(h),{type:"primary",size:"small",onClick:K},{default:o(()=>v[1]||(v[1]=[g(" 关闭 ")])),_:1,__:[1]})])]),default:o(()=>[j("div",ss,[a(b,{class:"left",columns:r(ae),data:r(B),"paginate-single-page":!1,size:"small",remote:"",loading:r(n),pagination:r(pe),"row-key":I=>I.id,"max-height":600},null,8,["columns","data","loading","pagination","row-key"]),a(be,{bordered:!1,size:"small",title:"设备",class:"w-1100px"},{default:o(()=>[a(b,{style:{width:"100%"},columns:r(fe),data:r(ye),size:"small","max-height":600,loading:r(oe),remote:"","scroll-x":r(fe).reduce((I,R)=>I+(R.width||100),0),"paginate-single-page":!1,pagination:r(Fe),"row-key":I=>I.id},null,8,["columns","data","loading","scroll-x","pagination","row-key"])]),_:1})])]),_:1},8,["show"])}}}),os=ca(is,[["__scopeId","data-v-a53f455a"]]),rs={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function Wt(Q){return typeof Q=="function"||Object.prototype.toString.call(Q)==="[object Object]"&&!Al(Q)}const us=ft({name:"projectmanagement_projectlist",__name:"index",setup(Q){const ie=xl(),x=ea(),ae=kl(),B=Cl(),{columns:d,columnChecks:n,data:pe,getData:A,loading:fe,mobilePagination:ye,searchParams:O}=St({showTotal:!0,apiFn:Il,apiParams:{page:1,pageSize:20,limit:20,status:null,startAndTimeRange:null,startTime:null,endTime:null,creater:void 0,fuzzy:void 0,sort:void 0,_t:new Date().getTime()},immediate:!1,columns:()=>[{type:"selection",align:"center",width:48},{key:"proname",title:"项目名称",align:"center",width:240,render:s=>a("div",{class:"cursor-pointer",onClick:()=>me(s)},[s.proname+(s.dispatch?`(${s.dispatch})`:"")])},{key:"progess",title:"项目进度",align:"center",width:140,sorter:!0,render:s=>a(pt,{type:"line",showIndicator:!0,percentage:s.progess,"indicator-placement":"inside",processing:!0,color:"#1890ff"},null)},{key:"status",title:"项目状态",align:"center",width:120,defaultFilterOptionValue:null,filterOptions:He(zt),filter:!0,filterMultiple:!1,render:s=>{if(s.status===null)return null;const f=P(Yt[s.status]);return a("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",color:s.status==-1?"#a27ff9":s.status===0?"#9ca3af":s.status===1?"#3b82f6":s.status===2?"#facc15":"#22c55e",borderRadius:"50%"}},[a("span",{style:{width:"10px",height:"10px",marginRight:"5px",backgroundColor:s.status==-1?"#a27ff9":s.status===0?"#9ca3af":s.status===1?"#3b82f6":s.status===2?"#facc15":"#22c55e",borderRadius:"50%"}},null),a("span",null,[f])])}},{key:"cpdbtime",title:"预计完成日期",align:"center",width:120,ellipsis:{tooltip:!0}},{key:"period",title:"周期",align:"center",width:100,render:s=>a("div",null,[s.period,g("天")])},{key:"ptype",title:"状态",align:"center",width:80,render:s=>a(Ke,{type:s.ptype===0?"success":"error"},{default:()=>[s.ptype===0?"正常":"已延期"]})},{key:"dtype",title:"调试类型",align:"center",width:100,render:s=>{if(s.dtype===null)return null;const f=P(Ol[s.dtype]);return a(Ke,{type:s.dtype==0?"warning":s.dtype==1?"success":"info"},Wt(f)?f:{default:()=>[f]})}},{key:"debugs",title:"统计数量信息",align:"center",width:160,render(s){const f=(Z,ge,re)=>{const ue=re>0;return u("div",{style:`
                    cursor: ${ue?"pointer":"default"};
                    color: ${ue?"#1890ff":"#999"};
                    font-size:13px;
                  `,onClick:()=>ue&&Be(ge,s)},`${Z}：${re}`)};return u("div",{style:"display:flex; flex-direction:column; gap:1px;"},[f("调试任务","business",s.debugs),f("项目总结","projectsummary",s.summarys),f("日报数量","daylog",s.dailys)])}},{key:"businesscon",title:"商务联系人",align:"center",width:200,render(s){return a("div",null,[s.businesscon||"-"])}},{key:"operate",title:P("common.operate"),align:"center",width:320,fixed:"right",render:s=>{let f;return a("div",{class:"flex justify-end gap-8px"},[s.status==-1&&(x.userInfo.usertype==0||x.userInfo.usertype==4||x.userInfo.id==1021||x.userInfo.id==1023)&&a(De,{onPositiveClick:()=>b(s,0)},{default:()=>"确定核准该项目吗？",trigger:()=>a(h,{color:"#a43cf9",ghost:!0,size:"small"},{default:()=>["核准"]})}),s.status==0&&(x.userInfo.usertype==0||x.userInfo.usertype==2)&&a(De,{onPositiveClick:()=>b(s,1)},{default:()=>"确定启动该项目吗？",trigger:()=>Ge(a(h,{type:"success",ghost:!0,size:"small"},{default:()=>["启动"]}),[[nt("no-auth"),"project:Info:update"]])}),s.status==2&&(x.userInfo.usertype==0||x.userInfo.usertype==2)&&a(De,{onPositiveClick:()=>b(s,3)},{default:()=>"是否确认执行审核操作？",trigger:()=>Ge(a(h,{type:"warning",ghost:!0,size:"small"},{default:()=>["审核"]}),[[nt("no-auth"),"project:Info:update"]])}),a(h,{type:"primary",ghost:!0,size:"small",onClick:()=>me(s)},{default:()=>["详情"]}),a(h,{type:"primary",ghost:!0,size:"small",onClick:()=>Ee(s)},{default:()=>["关联合同"]}),Ge(a(h,{type:"primary",ghost:!0,size:"small",onClick:()=>be(s.id)},Wt(f=P("common.edit"))?f:{default:()=>[f]}),[[nt("no-auth"),"project:Info:update"]])])}}]}),{drawerVisible:oe,operateType:ze,editingData:Fe,handleAdd:C,handleEdit:W,checkedRowKeys:K,onBatchDeleted:S}=Ll(pe,A);async function v(){console.log(K.value),U(K.value.join(","),s=>{S()})}const b=async(s,f)=>{var re;const{data:Z,error:ge}=await ra([{id:s.id,status:f}]);ge||((re=window.$message)==null||re.success("操作成功"),A(),f==3&&window.dispatchEvent(new CustomEvent("clearReview",{detail:{id:s.pid,type:"prj"}})))};function be(s){W(s)}async function U(s,f){const{data:Z,error:ge}=await Pl(s);if(!ge)f&&f(Z);else return!1}const I=_(!1),R=_(0),Ee=s=>{I.value=!0,R.value=s.id},_e=s=>{O.status=s.status,A()},xe=s=>{console.log(s),s.columnKey=="progess"&&(O.sort=s.order=="ascend"?0:s.order=="descend"?1:void 0,A())},M=_(1),Oe=s=>{M.value=s,s==0?A():T()},me=s=>{ae.push("/projectmanagement/orderdetail?prjId="+s.id+"&pname="+s.proname),x.setProjectInfo({pid:s.id,pname:s.proname})},Be=(s,f)=>{ae.push(`/projectmanagement/${s}?prjId=`+f.id+"&pname="+f.proname),x.setProjectInfo({pid:f.id,pname:f.proname})},y=()=>{A()};Sl(()=>{B.query.pname?(M.value=0,O.fuzzy=B.query.pname,O.status=2,y(),A()):T()}),dt(()=>B.query.pname,s=>{s&&!B.query.prjId&&(O.fuzzy=s,M.value=0,A())});const V=[{key:"proname",width:320,title(){return a("div",{class:"font-size-16px font-bold"},[g("近期项目")])},ellipsis:{tooltip:!0},render:s=>{if(s.status===null)return null;const f=P(Yt[s.status]);return a("div",null,[a($l,{placement:"top",trigger:"hover"},{trigger:()=>a("div",{class:"cursor-pointer text-ellipsis overflow-hidden whitespace-nowrap font-bold",onClick:()=>me(s),style:"max-width: 300px;"},[s.proname||"-"]),default:()=>s.proname||"-"}),a("div",{style:"display:flex; gap:3px; line-height:1.4;"},[a("div",{class:" flex"},[a("span",{style:"color:#666"},[g("进度：")]),a(pt,{type:"line",style:"width: 100px;",showIndicator:!0,percentage:s.progess,"indicator-placement":"inside",processing:!0,color:s.progess==100?"#22C55E":"#1890ff"},null)]),a("div",{class:" flex ml-8px"},[a("span",{style:"color:#666 flex"},[g("状态：")]),a("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",color:s.status===0?"#9ca3af":s.status===1?"#3B82F6":s.status===2?"#f1c40f":"#2ecc71",borderRadius:"50%"}},[a("span",{style:{width:"10px",height:"10px",marginRight:"5px",backgroundColor:s.status===0?"#9ca3af":s.status===1?"#3B82F6":s.status===2?"#f1c40f":"#2ecc71",borderRadius:"50%"}},null),a("span",null,[f])])])])])}},{key:"businesscon",title:"商务联系人",align:"center",width:100},{title:"最后打卡人",key:"clockinusername",align:"center",width:100},{title:"最后打卡时间",key:"lastclockintime",align:"center",width:180},{key:"clockincounts",title:"打卡信息",align:"left",width:200,render(s){return a("div",{style:"display:flex; flex-direction:column; gap:3px; line-height:1.4;"},[a("div",null,[a("span",{style:"color:#666"},[g("打卡人数：")]),a("span",{style:"font-weight:500"},[s.clockincounts!=null?s.clockincounts+"人":"-"])]),a("div",null,[a("span",{style:"color:#666"},[g("打卡人：")]),a("span",{style:" font-weight:500"},[s.clockinusers||"-"])])])}},{key:"debugname",title:"调试任务信息",align:"left",width:260,render(s){return a("div",{style:"display:flex; flex-direction:column; gap:3px; line-height:1.4;"},[a("div",null,[a("span",{style:"color:#666"},[g("任务名称：")]),a("span",{style:"font-weight:500"},[s.debugname||"-"])]),a("div",null,[a("span",{style:"color:#666"},[g("状态：")]),a(Ke,{size:"small",color:{color:s.debugstatus==-1?"rgba(251, 146, 60, 0.15)":s.debugstatus==0?"rgba(156, 163, 175, 0.15)":s.debugstatus==1?"rgba(59, 130, 246, 0.15)":s.debugstatus==2?"rgba(250, 204, 21, 0.15)":"rgba(16, 185, 129, 0.15)",textColor:s.debugstatus==-1?"#FB923C":s.debugstatus==0?"#9CA3AF":s.debugstatus==1?"#3B82F6":s.debugstatus==2?"#FACC15":"#10B981",borderColor:s.debugstatus==-1?"#FB923C":s.debugstatus==0?"#9CA3AF":s.debugstatus==1?"#3B82F6":s.debugstatus==2?"#FACC15":"#10B981"}},{default:()=>[s.debugstatus==-1?"申请中":s.debugstatus==0?"待调试":s.debugstatus==1?"开始调试":s.debugstatus==2?"待审核":"审核完成"]})])])}},{key:"username",title:"调试信息",align:"left",width:230,render(s){return a("div",{style:"display:flex; flex-direction:column; gap:3px; line-height:1.4;"},[a("div",null,[a("span",{style:"color:#666"},[g("时间：")]),a("span",{style:" font-weight:500"},[s.dbdbtime||"-"])]),a("div",null,[a("span",{style:"color:#666"},[g("调试人：")]),a("span",{style:"font-weight:500"},[s.username||"-"])])])}},{title:"任务审核时间",key:"ckdbtime",width:180}],H=Te({page:1,pageSize:20,showSizePicker:!0,fuzzy:"",itemCount:0,pageSizes:[10,20],prefix:()=>`共 ${H.itemCount} 条`,onChange:s=>{H.page=s,T()},onUpdatePageSize:s=>{H.pageSize=s,H.page=1,T()}}),Re=_([]),T=async()=>{const{data:s,error:f}=await wl({page:H.page,limit:H.pageSize});f||(Re.value=s.list,H.itemCount=s.total)};return(s,f)=>{const Z=ql,ge=Fl,re=ne,ue=Ra,mt=Zt,gt=Ba,vt=ct,ht=ct,yt=Dt,Xe=nt("no-auth");return $(),ot("div",rs,[M.value==0?($(),E(ls,{key:0,model:r(O),"onUpdate:model":f[0]||(f[0]=w=>it(O)?O.value=w:null),onReset:y,onSearch:r(A)},null,8,["model","onSearch"])):ce("",!0),a(yt,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},Dl({header:o(()=>[a(re,{align:"center",wrap:"",class:"lt-sm:w-200px"},{default:o(()=>[f[6]||(f[6]=j("div",null,"项目列表",-1)),a(ge,{size:"small",value:M.value,"onUpdate:value":[f[1]||(f[1]=w=>M.value=w),Oe],name:"radiobuttongroup1"},{default:o(()=>[a(Z,{value:0,label:"默认"}),a(Z,{value:1,label:"近期项目"})]),_:1},8,["value"])]),_:1,__:[6]})]),default:o(()=>[M.value==0?($(),E(vt,{key:0,"checked-row-keys":r(K),"onUpdate:checkedRowKeys":f[3]||(f[3]=w=>it(K)?K.value=w:null),columns:r(d),data:r(pe),size:"small","flex-height":!r(ie).isMobile,"scroll-x":r(d).reduce((w,ke)=>w+((ke==null?void 0:ke.width)||100),0),loading:r(fe),remote:"","row-key":w=>w.id,"onUpdate:sorter":xe,pagination:r(ye),class:"sm:h-full","onUpdate:filters":_e},null,8,["checked-row-keys","columns","data","flex-height","scroll-x","loading","row-key","pagination"])):($(),E(ht,{key:1,ref:"tableContainer",class:"sm:h-full",remote:"",pagination:H.pageSize==1?!1:H,"scroll-x":V.reduce((w,ke)=>w+(ke.width||100),0),columns:V,data:Re.value,bordered:!1,"flex-height":!r(ie).isMobile},null,8,["pagination","scroll-x","data","flex-height"])),a(as,{visible:r(oe),"onUpdate:visible":f[4]||(f[4]=w=>it(oe)?oe.value=w:null),onSubmitted:r(A),"operate-type":r(ze),"row-data":r(Fe)},null,8,["visible","onSubmitted","operate-type","row-data"]),a(os,{visable:I.value,"onUpdate:visable":f[5]||(f[5]=w=>I.value=w),id:R.value},null,8,["visable","id"])]),_:2},[M.value==0?{name:"header-extra",fn:o(()=>[a(re,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:o(()=>[Ge(($(),E(r(h),{onClick:r(C),size:"small",ghost:"",type:"primary"},{icon:o(()=>[a(ue,{class:"text-icon"})]),default:o(()=>[f[7]||(f[7]=g(" "+G("新增项目")))]),_:1,__:[7]},8,["onClick"])),[[Xe,"project:Info:insert"]]),a(r(De),{onPositiveClick:v},{trigger:o(()=>[Ge(($(),E(r(h),{size:"small",ghost:"",type:"error",disabled:r(K).length==0},{icon:o(()=>[a(mt,{class:zl(["text-icon",{"animate-spin":r(fe)}])},null,8,["class"])]),default:o(()=>[f[8]||(f[8]=g(" "+G("批量删除")))]),_:1,__:[8]},8,["disabled"])),[[Xe,"project:Info:delete"]])]),default:o(()=>[f[9]||(f[9]=g(" 确定要删除选中的合同吗？ "))]),_:1,__:[9]}),a(gt,{columns:r(n),"onUpdate:columns":f[2]||(f[2]=w=>it(n)?n.value=w:null),ctype:2},null,8,["columns"])]),_:1})]),key:"0"}:void 0]),1024)])}}}),Ps=ca(us,[["__scopeId","data-v-f2529ab4"]]);export{Ps as default};

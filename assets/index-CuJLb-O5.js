import{_ as Oe}from"./table-column-setting.vue_vue_type_script_setup_true_lang-rgBDZvjO.js";import{_ as Ge}from"./round-delete-vxljK2J6.js";import{_ as Ae}from"./round-add-XwPZokqe.js";import{d as ve,at as ce,q as xe,v as Ve,r as U,s as Ce,a as He,av as De,aw as Ke,bU as Je,cI as Qe,cJ as We,c as m,o as d,w as l,f as a,ax as Xe,G as Ne,z as N,h as o,az as pe,C as P,b4 as Ye,aC as Ze,aD as et,g as v,b as ee,e as L,t as k,aA as tt,B as T,aB as at,N as ge,$ as j,aE as lt,cn as Se,aH as me,cA as nt,cK as ot,cL as st,F as rt,U as ze,M as it,i as ut,y as de,aM as oe,ay as dt,D as se,aN as ct,cM as he,cN as pt,a5 as be,aS as mt}from"./index-BHFXhhrx.js";import{u as ft,a as vt}from"./table-02_NjBh1.js";import{u as fe}from"./usePageData-CiDKwIfi.js";import{u as gt}from"./upload-C-EyKG-1.js";import{N as _t}from"./Cascader-D7W8y2Tm.js";import{_ as Te}from"./Grid-DeUxXMwD.js";import{_ as Ue}from"./FormItemGridItem-CfqayFMK.js";import{_ as yt}from"./round-search-Dzp6xJh-.js";import{_ as ht}from"./round-refresh-bYfHOtol.js";import{N as we}from"./Popconfirm-BQM7uy2f.js";import"./v4-FuVw324d.js";const bt={key:0,style:{"margin-left":"20px"}},wt={key:0,style:{"margin-left":"20px"}},kt={key:0,style:{"margin-left":"20px"}},xt={key:0,style:{"margin-left":"20px"}},Ct=ve({name:"OperateDrawer",__name:"operate-drawer",props:ce({operateType:{},rowData:{},pid:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:ce(["submitted"],["update:visible"]),setup(q,{emit:H}){const C=H,B=xe(),g=q,t=Ve(S());function S(){return{pid:void 0,cid:void 0,contractId:void 0,id:"",devname:"",devmodel:"",devunit:"",devnum:0,notes:"",etype:0,devmanu:"",status:0,re1:"",re2:"",re3:"",re4:"",fl1:"",fl2:"",fl3:"",fl4:""}}const _=U([]),{pageData:y,getData:z,nextPage:M}=fe(Se),K=async n=>{const e=n.currentTarget,u=e.scrollTop;e.scrollTop+e.offsetHeight>=e.scrollHeight&&y.data.length<y.total&&(await M(),_.value=y.data,await me(),setTimeout(()=>{e.scrollTop=u}))},J=async()=>{await z({page:1}),_.value=y.data},Q=async()=>{var n,e;await z({fuzzy:B.userInfo.pname,page:1}),t.pid=g.pid?g.pid:(n=y.data[0])==null?void 0:n.id,_.value=y.data,await I(),t.contractId=(e=h.value[0])==null?void 0:e.id,p()},E=U([]),D=U(),{pageData:R,getData:W,nextPage:V}=fe(nt),p=async(n=t.contractId)=>{await W({pids:n}),D.value=[],E.value=Array.from(new Set([...E.value,...R.data])),D.value=R.data.map(e=>({label:e.devname,value:e.id}))},c=async n=>{var e;t.pid=n,await I(),t.contractId=(e=h.value[0])==null?void 0:e.id,await p(),t.cid=null},h=U([]),I=async()=>{const{data:n,error:e}=await ot({id:t.pid,limit:100,page:1});h.value=n==null?void 0:n.list.map(u=>({value:u.id,label:u.contractname,isLeaf:!1}))},F=U(),X=async n=>{t.cid=n;const e=E.value.find(u=>u.id==n);t.devname=e==null?void 0:e.devname,t.devnum=e==null?void 0:e.devcount,F.value=e==null?void 0:e.devcount,t.etype=e==null?void 0:e.devtype,t.devmanu=e==null?void 0:e.devmanu,t.notes=e==null?void 0:e.notes,t.devmodel=e==null?void 0:e.devmodel,t.devunit=e==null?void 0:e.devunit},s=U(0),i=U("");async function f({file:n},e){s.value=0,i.value=e;const u=await gt(n.file,n.name,"",b=>{s.value=b});u&&(t[e]=u,s.value=0)}async function O(){var n;if(await Q(),Object.assign(t,S()),g.operateType==="add"&&(t.pid=g.pid),g.operateType==="edit"&&g.rowData){Object.assign(t,g.rowData),F.value=(n=R.data.find(b=>b.id==t.cid))==null?void 0:n.devcount;const{data:e,error:u}=await st(t.cid);u||h.value.push({value:e.id,label:e.devname,disabled:!0,isLeaf:!0,hidden:!0})}}const{formRef:Y,validate:Z,restoreValidation:G}=Ce(),re={pid:{type:"number",required:!0,trigger:["blur","change"],message:"请选择"},contractId:{type:"number",required:!0,trigger:["blur","change"],message:"请选择"},cid:{type:"number",required:!0,trigger:["blur","change"],message:"请选择"},devname:{type:"string",required:!0,trigger:["blur","change"],message:"请输入"},devmodel:{type:"string",required:!0,trigger:["blur","change"],message:"请输入"},devnum:{type:"number",required:!0,trigger:["blur","change"],message:"请输入"},devunit:{type:"string",required:!0,trigger:["blur","change"],message:"请输入"}},te=async n=>{var e;await p(n.value),n.children=(e=D.value)==null?void 0:e.map(u=>({label:u.label,value:u.value,isLeaf:!0}))},x=He(()=>({add:"新增设备",edit:"修改设备"})[g.operateType]),A=De(q,"visible"),Pe=async n=>{if(n){await me();const e=document.querySelector(".n-cascader-menu");e&&(e.removeEventListener("scroll",_e),e.addEventListener("scroll",_e))}},ie=U(!1),qe=U(!0),_e=async n=>{const e=n.target;e.scrollHeight-e.scrollTop-e.clientHeight<10&&!ie.value&&qe.value&&(ie.value=!0,V(),D.value=R.data.map(b=>({label:b.devname,value:b.id})),ie.value=!1)};Ke(A,()=>{A.value&&(O(),setTimeout(()=>{const n=document.querySelector(".n-scrollbar-content");n==null||n.scrollTo(0,0)},300),G())});async function ae(n){if(n)try{const u=await(await fetch(n==null?void 0:n.split("?")[0],{mode:"cors"})).blob(),b=URL.createObjectURL(u),$=document.createElement("a");$.href=b,$.download=n==null?void 0:n.split("?")[1],$.style.display="none",document.body.appendChild($),$.click(),document.body.removeChild($),URL.revokeObjectURL(b)}catch(e){console.error("下载失败:",e)}}function ue(){A.value=!1}const $e=Je.debounce(async()=>{await Le()},1e3,{leading:!0,trailing:!1});async function Le(){var n,e;if(await Z(),g.operateType==="edit"){const{data:u,error:b}=await Qe([t]);b||(ue(),C("submitted"),(n=window.$message)==null||n.success("修改成功"))}else{const{data:u,error:b}=await We([{...t}]);b||(ue(),C("submitted"),(e=window.$message)==null||e.success("添加成功"))}}const Re=n=>n.hidden?null:n.label,Ie=n=>n.option.hidden?null:n.node;return(n,e)=>{const u=Ue,b=_t,$=et,je=Ze,le=tt,ne=at,ye=Te,Be=Ne,Me=Xe,Ee=ge,Fe=lt;return d(),m(Fe,{show:A.value,"onUpdate:show":e[22]||(e[22]=r=>A.value=r),title:x.value,preset:"card",class:"w-800px"},{footer:l(()=>[a(Ee,{justify:"end",size:16},{default:l(()=>[a(o(T),{onClick:ue},{default:l(()=>[v(k(o(j)("common.cancel")),1)]),_:1}),a(o(T),{type:"primary",onClick:o($e)},{default:l(()=>[v(k(o(j)("common.confirm")),1)]),_:1},8,["onClick"])]),_:1})]),default:l(()=>[a(Me,{class:"pr-20px"},{default:l(()=>[a(Be,{ref_key:"formRef",ref:Y,model:t,rules:re,"label-placement":"left","label-width":120},{default:l(()=>[a(ye,{responsive:"screen","item-responsive":""},{default:l(()=>[a(u,{span:"24 m:12",label:"项目列表",path:"pid"},{default:l(()=>[a(o(pe),{clearable:"",filterable:"",value:t.pid,"onUpdate:value":[e[0]||(e[0]=r=>t.pid=r),c],placeholder:"请选择项目","label-field":"proname","value-field":"id",onClear:J,options:_.value,onScroll:K},null,8,["value","options"])]),_:1}),a(u,{span:"24 m:12",label:"绑定合同设备",path:"cid"},{default:l(()=>[a(b,{value:t.cid,"onUpdate:value":[e[1]||(e[1]=r=>t.cid=r),X],placeholder:"请选择合同设备",options:h.value,"render-label":Re,"render-suffix":Ie,"check-strategy":"child","show-path":!1,labelKey:"label",remote:"","on-load":te,"onUpdate:show":Pe},null,8,["value","options"])]),_:1}),t.cid?(d(),m(u,{key:0,span:"24 m:12",label:"设备名称",path:"devname"},{default:l(()=>[a(o(P),{value:t.devname,"onUpdate:value":e[2]||(e[2]=r=>t.devname=r),clearable:"",placeholder:"请输入"},null,8,["value"])]),_:1})):N("",!0),t.cid?(d(),m(u,{key:1,span:"24 m:12",label:"数量",path:"devnum"},{default:l(()=>[a(o(Ye),{value:t.devnum,"onUpdate:value":e[3]||(e[3]=r=>t.devnum=r),placeholder:"请输入",max:F.value,style:{width:"100%"}},null,8,["value","max"])]),_:1})):N("",!0),t.cid?(d(),m(u,{key:2,span:"24 m:12",label:"设备单位",path:"devunit"},{default:l(()=>[a(o(P),{value:t.devunit,"onUpdate:value":e[4]||(e[4]=r=>t.devunit=r),placeholder:"请输入",readonly:""},null,8,["value"])]),_:1})):N("",!0),t.cid?(d(),m(u,{key:3,span:"24 m:12",label:"型号",path:"devmodel"},{default:l(()=>[a(o(P),{value:t.devmodel,"onUpdate:value":e[5]||(e[5]=r=>t.devmodel=r),placeholder:"请输入",readonly:""},null,8,["value"])]),_:1})):N("",!0),t.cid?(d(),m(u,{key:4,span:"24 m:12",label:"是否为我司设备",path:"etype"},{default:l(()=>[a(je,{value:t.etype,"onUpdate:value":e[6]||(e[6]=r=>t.etype=r),name:"radiogroup",disabled:""},{default:l(()=>[a($,{value:0},{default:l(()=>e[23]||(e[23]=[v("是")])),_:1,__:[23]}),a($,{value:1},{default:l(()=>e[24]||(e[24]=[v("否")])),_:1,__:[24]})]),_:1},8,["value"])]),_:1})):N("",!0),t.cid?(d(),m(u,{key:5,span:"24 m:12",label:"设备厂家",path:"devmanu"},{default:l(()=>[a(o(P),{value:t.devmanu,"onUpdate:value":e[7]||(e[7]=r=>t.devmanu=r),placeholder:"请输入",readonly:""},null,8,["value"])]),_:1})):N("",!0),g.operateType=="edit"?(d(),m(u,{key:6,span:"24 m:12",label:"清点状态",path:"status"},{default:l(()=>[a(o(pe),{clearable:"",value:t.status,"onUpdate:value":e[8]||(e[8]=r=>t.status=r),placeholder:"请选择",options:[{label:"未清点",value:0},{label:"正常",value:1},{label:"增补",value:2},{label:"退货",value:3},{label:"换货",value:4}]},null,8,["value"])]),_:1})):N("",!0),t.cid?(d(),m(u,{key:7,span:"24 m:12",label:"备注",path:"notes"},{default:l(()=>[a(o(P),{value:t.notes,"onUpdate:value":e[9]||(e[9]=r=>t.notes=r),placeholder:"请输入"},null,8,["value"])]),_:1})):N("",!0),a(u,{span:"24 m:24",label:"",path:"notes","show-feedback":!1},{default:l(()=>[a(ye,{responsive:"screen","item-responsive":""},{default:l(()=>[a(u,{span:"24 m:12",label:"附件1",path:"notes"},{default:l(()=>[a(o(P),{value:t.re1,"onUpdate:value":e[10]||(e[10]=r=>t.re1=r),placeholder:"请输入",style:{width:"250px"}},null,8,["value"])]),_:1}),a(u,{span:"24 m:12",label:"",path:"notes"},{default:l(()=>{var r;return[t.fl1?(d(),ee("span",bt,[v(k((r=t.fl1)==null?void 0:r.split("?")[1])+" ",1),L("span",{class:"cursor-pointer c-#c92a2a",onClick:e[11]||(e[11]=w=>t.fl1="")},"删除"),L("span",{class:"cursor-pointer c-#1890ff ml-5px inline-block",onClick:e[12]||(e[12]=w=>ae(t.fl1))},"下载")])):(d(),m(le,{key:1,style:{width:"auto","margin-left":"20px"},ref:"uploadRef",action:"#","custom-request":w=>f(w,"fl1"),"show-file-list":!1},{default:l(()=>[a(o(T),{loading:s.value>0&&!t.fl1&&i.value=="fl1",size:"small",ghost:"",type:"primary"},{default:l(()=>[v(k(s.value>0&&!t.fl1&&i.value=="fl1"?"上传中":"选择文件"),1)]),_:1},8,["loading"])]),_:1},8,["custom-request"])),s.value&&!t.fl1&&i.value=="fl1"?(d(),m(ne,{key:2,type:"line",percentage:s.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):N("",!0)]}),_:1})]),_:1})]),_:1}),a(u,{span:"24 m:12",label:"附件2",path:"notes"},{default:l(()=>[a(o(P),{value:t.re2,"onUpdate:value":e[13]||(e[13]=r=>t.re2=r),placeholder:"请输入",style:{width:"250px"}},null,8,["value"])]),_:1}),a(u,{span:"24 m:12",label:"",path:"notes"},{default:l(()=>{var r;return[t.fl2?(d(),ee("span",wt,[v(k((r=t.fl2)==null?void 0:r.split("?")[1])+" ",1),L("span",{class:"cursor-pointer c-#c92a2a",onClick:e[14]||(e[14]=w=>t.fl2="")},"删除"),L("span",{class:"cursor-pointer c-#1890ff ml-5px inline-block",onClick:e[15]||(e[15]=w=>ae(t.fl2))},"下载")])):(d(),m(le,{key:1,style:{width:"auto","margin-left":"20px"},ref:"uploadRef",action:"#","custom-request":w=>f(w,"fl2"),"show-file-list":!1},{default:l(()=>[a(o(T),{loading:s.value>0&&!t.fl2&&i.value=="fl2",size:"small",ghost:"",type:"primary"},{default:l(()=>[v(k(s.value>0&&!t.fl2&&i.value=="fl2"?"上传中":"选择文件"),1)]),_:1},8,["loading"])]),_:1},8,["custom-request"])),s.value&&!t.fl2&&i.value=="fl2"?(d(),m(ne,{key:2,type:"line",percentage:s.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):N("",!0)]}),_:1}),a(u,{span:"24 m:12",label:"附件3",path:"notes"},{default:l(()=>[a(o(P),{value:t.re3,"onUpdate:value":e[16]||(e[16]=r=>t.re3=r),placeholder:"请输入",style:{width:"250px"}},null,8,["value"])]),_:1}),a(u,{span:"24 m:12",label:"",path:"notes"},{default:l(()=>{var r;return[t.fl3?(d(),ee("span",kt,[v(k((r=t.fl3)==null?void 0:r.split("?")[1])+" ",1),L("span",{class:"cursor-pointer c-#c92a2a",onClick:e[17]||(e[17]=w=>t.fl3="")},"删除"),L("span",{class:"cursor-pointer c-#1890ff ml-5px inline-block",onClick:e[18]||(e[18]=w=>ae(t.fl3))},"下载")])):(d(),m(le,{key:1,style:{width:"auto","margin-left":"20px"},ref:"uploadRef",action:"#","custom-request":w=>f(w,"fl3"),"show-file-list":!1},{default:l(()=>[a(o(T),{loading:s.value>0&&!t.fl3&&i.value=="fl3",size:"small",ghost:"",type:"primary"},{default:l(()=>[v(k(s.value>0&&!t.fl3&&i.value=="fl3"?"上传中":"选择文件"),1)]),_:1},8,["loading"])]),_:1},8,["custom-request"])),s.value&&!t.fl3&&i.value=="fl3"?(d(),m(ne,{key:2,type:"line",percentage:s.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):N("",!0)]}),_:1}),a(u,{span:"24 m:12",label:"附件4",path:"notes"},{default:l(()=>[a(o(P),{value:t.re4,"onUpdate:value":e[19]||(e[19]=r=>t.re4=r),placeholder:"请输入",style:{width:"250px"}},null,8,["value"])]),_:1}),a(u,{span:"24 m:12",label:"",path:"notes"},{default:l(()=>{var r;return[t.fl4?(d(),ee("span",xt,[v(k((r=t.fl2)==null?void 0:r.split("?")[1])+" ",1),L("span",{class:"cursor-pointer c-#c92a2a",onClick:e[20]||(e[20]=w=>t.fl4="")},"删除"),L("span",{class:"cursor-pointer c-#1890ff ml-5px inline-block",onClick:e[21]||(e[21]=w=>ae(t.fl4))},"下载")])):(d(),m(le,{key:1,style:{width:"auto","margin-left":"20px"},ref:"uploadRef",action:"#","custom-request":w=>f(w,"fl4"),"show-file-list":!1},{default:l(()=>[a(o(T),{loading:s.value>0&&!t.fl4&&i.value=="fl4",size:"small",ghost:"",type:"primary"},{default:l(()=>[v(k(s.value>0&&!t.fl4&&i.value=="fl4"?"上传中":"选择文件"),1)]),_:1},8,["loading"])]),_:1},8,["custom-request"])),s.value&&!t.fl4&&i.value=="fl4"?(d(),m(ne,{key:2,type:"line",percentage:s.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):N("",!0)]}),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show","title"])}}}),Dt=ve({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:ce(["reset","search","clear"],["update:model"]),setup(q,{emit:H}){const C=H,{formRef:B,restoreValidation:g}=Ce(),t=De(q,"model"),S=xe(),_=U([]),{pageData:y,getData:z,nextPage:M}=fe(Se),K=async p=>{const c=p.currentTarget,h=c.scrollTop;c.scrollTop+c.offsetHeight>=c.scrollHeight&&y.data.length<y.total&&(await M(),_.value=y.data,await me(),setTimeout(()=>{c.scrollTop=h}))},J=async p=>{var c;p?(t.value.pid=p,C("search"),S.setProjectInfo({pname:(c=_.value.find(h=>h.id==p))==null?void 0:c.proname,pid:p})):C("clear")},Q=async p=>{await z({fuzzy:p,page:1}),_.value=y.data},E=async()=>{await z({page:1}),_.value=y.data};(async()=>{var p,c;await z({fuzzy:S.userInfo.pname}),_.value=y.data,t.value.pid=S.userInfo.pid?S.userInfo.pid:(p=_.value[0])==null?void 0:p.id,S.setProjectInfo({pid:t.value.pid,pname:(c=_.value.find(h=>h.id==t.value.pid))==null?void 0:c.proname}),C("search")})();async function R(){await g(),t.value.fuzzy="",C("reset")}const W=()=>{t.value.fuzzy="",C("search")};async function V(){var p,c;t.value.pid?C("search"):((p=window.$message)==null||p.destroyAll(),(c=window.$message)==null||c.warning("请选择项目"))}return(p,c)=>{const h=pe,I=Ue,F=P,X=ht,s=T,i=yt,f=ge,O=Te,Y=Ne,Z=ze;return d(),m(Z,{bordered:!1,size:"small",class:"card-wrapper"},{default:l(()=>[a(Y,{ref_key:"formRef",ref:B,model:t.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:rt(V,["enter"])},{default:l(()=>[a(O,{responsive:"screen","item-responsive":"","x-gap":16,"y-gap":16},{default:l(()=>[a(I,{span:"24 s:12 m:6",label:"项目列表",path:"PrjId"},{default:l(()=>[a(h,{filterable:"",clearable:"",value:t.value.pid,"onUpdate:value":[c[0]||(c[0]=G=>t.value.pid=G),J],placeholder:"请选择项目","label-field":"proname","value-field":"id",options:_.value,onScroll:K,onClear:E,onSearch:Q},null,8,["value","options"])]),_:1}),a(I,{span:"24 s:12 m:6",label:"设备名称",path:"fuzzy"},{default:l(()=>[a(F,{value:t.value.fuzzy,"onUpdate:value":c[1]||(c[1]=G=>t.value.fuzzy=G),placeholder:"请输入",clearable:"",onClear:W},null,8,["value"])]),_:1}),a(I,{span:"24  s:12 m:6",class:"pr-24px"},{default:l(()=>[a(f,{class:"w-full"},{default:l(()=>[a(s,{onClick:R},{icon:l(()=>[a(X,{class:"text-icon"})]),default:l(()=>[v(" "+k(o(j)("common.reset")),1)]),_:1}),a(s,{type:"primary",ghost:"",onClick:V},{icon:l(()=>[a(i,{class:"text-icon"})]),default:l(()=>[v(" "+k(o(j)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),Nt={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function ke(q){return typeof q=="function"||Object.prototype.toString.call(q)==="[object Object]"&&!mt(q)}const Ft=ve({name:"projectmanagement_device",__name:"index",setup(q){const H=it(),{columns:C,columnChecks:B,data:g,getData:t,loading:S,pagination:_,mobilePagination:y,searchParams:z}=ft({showTotal:!0,immediate:!1,apiFn:pt,apiParams:{page:1,pageSize:20,limit:20,fuzzy:"",_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48},{key:"devname",title:"设备名称",align:"center",width:180},{key:"devmodel",title:"型号",align:"center",width:160},{key:"devnum",title:"数量",align:"center",width:120},{key:"devunit",title:"设备单位",align:"center",width:120},{key:"etype",title:"是否为我司设备",align:"center",width:120,render(s){return be("div",{},s.etype==0?"是":"否")}},{key:"devmanu",title:"设备厂家",align:"center",width:120},{key:"status",title:"清点状态",align:"center",width:120,render(s){return be("div",{},s.status==0?"未清点":s.status==1?"正常":s.status==2?"增补":s.status==3?"退货":"换货")}},{key:"notes",title:"备注",align:"center",width:120},{key:"dusername",title:"清点人",align:"center",width:120},{key:"ddbtime",title:"清点时间",align:"center",width:160},{key:"username",title:"操作人",align:"center",width:120},{key:"dbtime",title:"操作时间",align:"center",width:160},{key:"operate",title:j("common.operate"),align:"center",width:140,fixed:"right",render:s=>{let i;return a("div",{class:"flex-center gap-8px"},[se(a(T,{type:"primary",ghost:!0,size:"small",onClick:()=>c(s.id)},ke(i=j("common.edit"))?i:{default:()=>[i]}),[[de("no-auth"),"project:Equipment:update"]]),a(we,{onPositiveClick:()=>p(s.id)},{default:()=>j("common.confirmDelete"),trigger:()=>{let f;return se(a(T,{type:"error",ghost:!0,size:"small"},ke(f=j("common.delete"))?f:{default:()=>[f]}),[[de("no-auth"),"project:Equipment:delete"]])}})])}}]}),{drawerVisible:M,operateType:K,editingData:J,handleAdd:Q,handleEdit:E,checkedRowKeys:D,onBatchDeleted:R,onDeleted:W}=vt(g,t);ut(async()=>{});async function V(){console.log(D.value),h(D.value.join(","),s=>{R()})}async function p(s){const{data:i,error:f}=await he(s);f||W()}function c(s){E(s)}async function h(s,i){const{data:f,error:O}=await he(s);if(!O)i&&i(f);else return!1}const I=()=>{g.value=[],_.itemCount=0},F=s=>{t()},X=()=>{t()};return(s,i)=>{const f=ge,O=Ae,Y=Ge,Z=Oe,G=dt,re=ze,te=de("no-auth");return d(),ee("div",Nt,[a(Dt,{model:o(z),"onUpdate:model":i[0]||(i[0]=x=>oe(z)?z.value=x:null),onReset:X,onSearch:o(t),onClear:I},null,8,["model","onSearch"]),a(re,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:l(()=>[a(f,{align:"center",wrap:"",class:"lt-sm:w-200px"},{default:l(()=>i[4]||(i[4]=[L("div",null,"待调试设备",-1)])),_:1,__:[4]})]),"header-extra":l(()=>[a(f,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:l(()=>[se((d(),m(o(T),{onClick:o(Q),size:"small",ghost:"",type:"primary"},{icon:l(()=>[a(O,{class:"text-icon"})]),default:l(()=>[i[5]||(i[5]=v(" "+k("新增")))]),_:1,__:[5]},8,["onClick"])),[[te,"project:Equipment:insert"]]),a(o(we),{onPositiveClick:V},{trigger:l(()=>[se((d(),m(o(T),{size:"small",ghost:"",type:"error",disabled:o(D).length==0},{icon:l(()=>[a(Y,{class:ct(["text-icon",{"animate-spin":o(S)}])},null,8,["class"])]),default:l(()=>[i[6]||(i[6]=v(" "+k("批量删除")))]),_:1,__:[6]},8,["disabled"])),[[te,"project:Equipment:delete"]])]),default:l(()=>[i[7]||(i[7]=v(" 确定要删除选中的设备吗？ "))]),_:1,__:[7]}),a(Z,{columns:o(B),"onUpdate:columns":i[1]||(i[1]=x=>oe(B)?B.value=x:null)},null,8,["columns"])]),_:1})]),default:l(()=>[a(G,{"checked-row-keys":o(D),"onUpdate:checkedRowKeys":i[2]||(i[2]=x=>oe(D)?D.value=x:null),columns:o(C),data:o(g),size:"small","flex-height":!o(H).isMobile,loading:o(S),remote:"","row-key":x=>x.id,"scroll-x":o(C).reduce((x,A)=>x+(A.width||100),0),pagination:o(y),class:"sm:h-full","onUpdate:filters":F},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","scroll-x","pagination"]),a(Ct,{visible:o(M),"onUpdate:visible":i[3]||(i[3]=x=>oe(M)?M.value=x:null),onSubmitted:o(t),pid:o(z).pid,"operate-type":o(K),"row-data":o(J)},null,8,["visible","onSubmitted","pid","operate-type","row-data"])]),_:1})])}}});export{Ft as default};

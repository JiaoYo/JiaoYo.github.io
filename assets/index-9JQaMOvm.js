import{_ as Q}from"./table-column-setting.vue_vue_type_script_setup_true_lang-DdTZDRM1.js";import{_ as A}from"./export-Gdn-3gQx.js";import{_ as L}from"./round-search-Bhgp6hzv.js";import{d as W,a_ as m,m as _,o as X,b as Y,g as t,w as a,f as n,B as f,ae as Z,h as g,t as p,$ as S,ao as M,e as ee,Q as te,P as ae,ar as ne,M as oe,an as le,a5 as se,_ as ie}from"./index-7pxtdcYT.js";import{b as ce,c as re}from"./metar-Da4-tK0D.js";import{u as me,a as pe}from"./table-CG4zQhwQ.js";import{e as de}from"./exportExcel-Bv4G4H50.js";import{_ as P}from"./DatePicker-D4GQQI2B.js";import{_ as ue}from"./FormItemGridItem-CkO_YQk2.js";import{_ as _e}from"./Grid-Y4ivQjio.js";const fe={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},ge=W({name:"realtimequery_datastatistics",__name:"index",setup(he){const{columns:k,columnChecks:h,data:d,getData:x,loading:D,mobilePagination:z,searchParams:w,resetSearchParams:we}=me({apiFn:ce,apiParams:{page:1,pageSize:20,limit:20,startTime:m(0,Date.now()-2592e5),endTime:m(0,Date.now()),_t:new Date().getTime()},immediate:!0,showTotal:!0,columns:()=>[{type:"selection",width:50},{key:"dbtime",title:"更新时间",align:"center",width:160,fixed:"left"},{key:"etime",title:"有效时长(小时)",align:"center",width:120},{key:"powermax",title:"功率最大值",align:"center",width:120},{key:"avgpower",title:"功率平均值",align:"center",width:120},{key:"stdpower",title:"功率标准差",align:"center",width:120},{key:"powertime",title:"功率最大发生时间",align:"center",width:160},{key:"uhours",title:"利用小时数",align:"center",width:120},{key:"avgload",title:"平均负荷率",align:"center",width:120},{key:"prmse",title:"均方根误差",align:"center",width:120},{key:"pmae",title:"平均绝对误差",align:"center",width:120},{key:"pme",title:"平均误差",align:"center",width:120},{key:"pclcf",title:"相关性系数",align:"center",width:120},{key:"pmaxe",title:"最大预测误差",align:"center",width:120},{key:"prate",title:"合格率",align:"center",width:120},{key:"avgenvt",title:"环境温度平均值",align:"center",width:120},{key:"avgenvh",title:"环境湿度平均值",align:"center",width:120},{key:"avgldt",title:"露点温度平均值",align:"center",width:120},{key:"avgqy",title:"气压平均值",align:"center",width:120}]}),{checkedRowKeys:r}=pe(d,x),b=()=>{x()},N=_([Date.now()-864e5*3,Date.now()]);async function U(s,e){w.startTime=m(0,e[0]),w.endTime=m(0,e[1]),b()}const B=()=>{const s={};k.value.forEach(o=>{o.key!="index"&&o.key!="operation"&&o.type!=="selection"&&(s[o.key]=typeof o.title=="string"?o.title:o.title().children[0])});const e=[];d.value.forEach(o=>{if(r.value.includes(o.id)){const i=JSON.parse(JSON.stringify(s));for(const c in i)o.hasOwnProperty(c)?i[c]=o[c]:i[c]="";e.push(i)}}),de(e,s,"数据统计")},V={近七天:[Date.now()-864e5*7,Date.now()],近一月:[Date.now()-864e5*30,Date.now()],近三月:[Date.now()-864e5*90,Date.now()]},u=_(!1),y=_(new Date().getTime()),v=_(0),E=()=>{T(),u.value=!0},G=(s,e)=>{T()},O=()=>{u.value=!1},T=async()=>{const{data:s,error:e}=await re({date:m(3,y.value)});e||(typeof s=="number"?v.value=s:v.value="")};return(s,e)=>{const o=P,i=L,c=ue,R=_e,$=te,j=A,F=Q,C=ae,q=ne,I=P,J=oe,K=le,H=se;return X(),Y("div",fe,[t(H,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:a(()=>[t($,{ref:"formRef",model:n(w),"label-placement":"left","show-feedback":!1},{default:a(()=>[t(R,{"y-gap":16,responsive:"screen","item-responsive":""},{default:a(()=>[t(c,{span:"24 s:12 m:12",label:"起止时间",path:"startTime"},{default:a(()=>[t(o,{value:N.value,"onUpdate:value":e[0]||(e[0]=l=>N.value=l),type:"daterange","value-format":"yyyy-MM-dd","onUpdate:formattedValue":U,"default-time":["00:00:00","23:59:59"],shortcuts:V},null,8,["value"]),t(n(f),{type:"primary",ghost:"",onClick:b,class:"ml-20px"},{icon:a(()=>[t(i,{class:Z(["text-icon",{"animate-spin":n(D)}])},null,8,["class"])]),default:a(()=>[g(" "+p(n(S)("common.search")),1)]),_:1}),t(n(f),{type:"primary",ghost:"",onClick:E,class:"ml-20px"},{default:a(()=>[g(p("月均方根误差"))]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),"header-extra":a(()=>[t(C,{justify:"end",class:"lt-sm:w-200px"},{default:a(()=>[t(n(f),{onClick:B,size:"small",disabled:n(r).length==0},{icon:a(()=>[t(j,{class:"text-icon"})]),default:a(()=>[g(" "+p(n(S)("common.export")),1)]),_:1},8,["disabled"]),t(F,{columns:n(h),"onUpdate:columns":e[1]||(e[1]=l=>M(h)?h.value=l:null)},null,8,["columns"])]),_:1})]),default:a(()=>[t(q,{"checked-row-keys":n(r),"onUpdate:checkedRowKeys":e[2]||(e[2]=l=>M(r)?r.value=l:null),columns:n(k),data:n(d),size:"small",loading:n(D),remote:"","row-key":l=>l.id,pagination:n(d).length?n(z):void 0,class:"sm:h-full","flex-height":!0,"scroll-x":""},null,8,["checked-row-keys","columns","data","loading","row-key","pagination"]),t(K,{show:u.value,"onUpdate:show":e[4]||(e[4]=l=>u.value=l),preset:"card",class:"w-320px"},{footer:a(()=>[t(C,{justify:"end"},{default:a(()=>[t(n(f),{size:"small",class:"mt-16px",onClick:O},{default:a(()=>[g(p("关闭"))]),_:1})]),_:1})]),default:a(()=>[t(J,{label:"日期","label-placement":"left"},{default:a(()=>[t(I,{value:y.value,"onUpdate:value":[e[3]||(e[3]=l=>y.value=l),G],type:"month",clearable:""},null,8,["value"])]),_:1}),ee("h2",null,"月均方根误差："+p(v.value),1)]),_:1},8,["show"])]),_:1})])}}}),Me=ie(ge,[["__scopeId","data-v-a140810c"]]);export{Me as default};

import{_ as _e}from"./table-column-setting.vue_vue_type_script_setup_true_lang-D-5uH7kQ.js";import{d as A,av as B,X as se,s as F,D as te,A as oe,E as we,a as he,at as G,au as O,c as K,o as V,w as t,f as e,bo as ie,M as re,L as ue,N as ke,h as a,ay as le,H as q,J as Y,B as I,g as i,t as P,$ as E,bq as ce,aT as xe,aE as de,cz as De,cR as Te,cS as Ce,bl as pe,a2 as Z,aS as ae,aJ as J,b4 as Ne,b5 as Le,a3 as ze,ax as W,W as Se,e as X,a4 as me,cT as je,cQ as Me,aD as ne,z as Ue,Y as Pe,i as Re,b as Fe,aL as H,cM as $e,cC as Be}from"./index-9Ko_9_TI.js";import{u as ee,a as fe}from"./table-BtCxAkgO.js";import{u as ge}from"./usePageData-BWaYhHgw.js";import{_ as Ie}from"./round-search-BEVIxLnz.js";import{_ as Ae}from"./round-refresh-bTt_nT21.js";import{_ as Ve}from"./Grid-C4COR-OK.js";import{_ as qe}from"./FormItemGridItem-BlsYHznD.js";import{_ as Ee}from"./DatePicker-DdutLwK7.js";import{_ as Ge,a as Ke}from"./DescriptionsItem-BE-EQXL2.js";const He=A({name:"OperateDrawer",__name:"operate-drawer",props:B({operateType:{},rowData:{},projectList:{},pid:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:B(["submitted"],["update:visible"]),setup(C,{emit:N}){se(),F(!1);const r=N,p=C,n=te(u());te({contactList:[],debuggedBusinessList:[],debuggedDevieceList:[],prjCycleList:[]});function u(){return{id:0,pid:void 0,contractname:"",contractnum:"",businesscon:void 0,businessinfo:"",precautions:"",notes:""}}const{pageData:T,getData:L,nextPage:j}=ge(xe),x=async()=>{await L({usertypes:"1"})},M=async g=>{const c=g.currentTarget,h=c.scrollTop;c.scrollTop+c.offsetHeight>=c.scrollHeight&&T.data.length<T.total&&(await j(),await de(),setTimeout(()=>{c.scrollTop=h}))};async function D(){x(),Object.assign(n,u()),n.pid=p.pid,p.operateType==="edit"&&p.rowData&&Object.assign(n,p.rowData)}const{formRef:o,validate:v,restoreValidation:U}=oe(),{defaultRequiredRule:y,patternRules:m}=we(),_={pid:{type:"number",required:!0,trigger:["blur","change"],message:"请选择项目"},contractname:y,contractnum:{required:!0,trigger:["blur","input"],message:"请输入合同编号"},businesscon:y,businessinfo:{...y,...m.mobile}},z=he(()=>({add:"新增合同",edit:"修改合同"})[p.operateType]),S=G(C,"visible");O(S,()=>{S.value&&(D(),setTimeout(()=>{const g=document.querySelector(".n-scrollbar-content");g==null||g.scrollTo(0,0)},300),U())});function R(g){g||l()}function l(){S.value=!1}async function f(){var g;await v(),(g=window.$dialog)==null||g.info({title:"提示",content:"确定提交吗？",positiveText:"确定",negativeText:"取消",onPositiveClick:async()=>{await w()}})}async function w(){var g,c,h,$,b;if(console.log(n),p.operateType==="add"){const d=De(),{data:s,error:Q}=await Te([{pid:n.pid,contractname:n.contractname,contractnum:n.contractnum,businesscon:n.businesscon,businessinfo:n.businessinfo,notes:n.notes,precautions:n.precautions,uuid:d}]);Q||((g=window.$message)==null||g.destroyAll(),(c=window.$message)==null||c.success("操作成功"),l(),r("submitted"))}else{const{data:d,error:s}=await Ce([{id:(h=p.rowData)==null?void 0:h.id,pid:n.pid,contractname:n.contractname,contractnum:n.contractnum,businesscon:n.businesscon,businessinfo:n.businessinfo,precautions:n.precautions,notes:n.notes}],p.pid);if(!s){($=window.$message)==null||$.destroyAll(),(b=window.$message)==null||b.success("操作成功"),l(),r("submitted");return}}}return(g,c)=>{const h=ke,$=re,b=ie,d=ce;return V(),K(d,{show:S.value,"onUpdate:show":[c[6]||(c[6]=s=>S.value=s),R],"display-directive":"show",width:1200,onMaskClick:l,onEsc:l},{default:t(()=>[e(b,{title:z.value,"native-scrollbar":!1,closable:""},{footer:t(()=>[e(a(Y),{size:16,justify:"end"},{default:t(()=>[e(a(I),{onClick:l},{default:t(()=>[i(P(a(E)("common.cancel")),1)]),_:1}),e(a(I),{type:"primary",onClick:f},{default:t(()=>[i(P(a(E)("common.confirm")),1)]),_:1})]),_:1})]),default:t(()=>[e($,{ref_key:"formRef",ref:o,model:n,rules:_,onKeyup:ue(f,["enter"])},{default:t(()=>[e(h,{label:"所属项目",path:"pid"},{default:t(()=>[e(a(le),{filterable:"",value:n.pid,"onUpdate:value":c[0]||(c[0]=s=>n.pid=s),placeholder:"请选择所属项目","label-field":"proname","value-field":"id",options:p.projectList},null,8,["value","options"])]),_:1}),e(h,{label:"合同名称",path:"contractname"},{default:t(()=>[e(a(q),{clearable:"",value:n.contractname,"onUpdate:value":c[1]||(c[1]=s=>n.contractname=s),placeholder:"请输入合同名称"},null,8,["value"])]),_:1}),e(h,{label:"合同编号",path:"contractnum"},{default:t(()=>[e(a(q),{clearable:"",value:n.contractnum,"onUpdate:value":c[2]||(c[2]=s=>n.contractnum=s),placeholder:"请输入合同编号"},null,8,["value"])]),_:1}),e(h,{label:"商务负责人",path:"businesscon"},{default:t(()=>[e(a(le),{filterable:"",value:n.businesscon,"onUpdate:value":c[3]||(c[3]=s=>n.businesscon=s),tag:"",placeholder:"请选择商务负责人","label-field":"username","value-field":"username",options:a(T).data,onScroll:M},null,8,["value","options"])]),_:1}),e(h,{label:"商务负责人联系方式"},{default:t(()=>[e(a(q),{clearable:"",value:n.businessinfo,"onUpdate:value":c[4]||(c[4]=s=>n.businessinfo=s),placeholder:"请输入商务负责人联系方式"},null,8,["value"])]),_:1}),e(h,{label:"注意事项",path:"precautions"},{default:t(()=>[e(a(q),{clearable:"",type:"textarea",value:n.precautions,"onUpdate:value":c[5]||(c[5]=s=>n.precautions=s),placeholder:"请输入注意事项"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Oe=A({name:"FormSearch",__name:"form-search",props:B({projectList:{}},{model:{required:!0},modelModifiers:{}}),emits:B(["reset","search","scrollPrj"],["update:model"]),setup(C,{emit:N}){pe();const r=N,{formRef:p,restoreValidation:n}=oe(),u=G(C,"model"),T={当日:()=>{const o=new Date().getTime();return[o,o]},本周:()=>{const o=new Date().getTime();return[o-24*60*60*1e3*7,o]},上月:()=>{const o=new Date().getTime();return[o-24*60*60*1e3*30,o]},近一年:()=>{const o=new Date().getTime();return[o-24*60*60*1e3*365,o]},近三年:()=>{const o=new Date().getTime();return[o-24*60*60*1e3*365*3,o]}};function L(){u.value.fuzzy=void 0,r("search")}function j(){u.value.contractnum=void 0,r("search")}async function x(o,v){u.value.startTime=String(ae(1,v[0])),u.value.endTime=String(ae(1,v[1]))}async function M(){u.value.contractnum=null,u.value.fuzzy=null,u.value.startTime=null,u.value.endTime=null,u.value.startAndTimeRange=null,await n(),r("reset")}async function D(){console.log(u.value),r("search")}return(o,v)=>{const U=q,y=qe,m=Ee,_=Ae,z=I,S=Ie,R=Y,l=Ve,f=re,w=Z;return V(),K(w,{bordered:!1,size:"small",class:"card-wrapper"},{default:t(()=>[e(f,{ref_key:"formRef",ref:p,model:u.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:ue(D,["enter"])},{default:t(()=>[e(l,{responsive:"screen","item-responsive":"","x-gap":16,"y-gap":16},{default:t(()=>[e(y,{span:"24 s:12 m:5",label:"合同名称",path:"fuzzy"},{default:t(()=>[e(U,{clearable:"",value:u.value.fuzzy,"onUpdate:value":v[0]||(v[0]=g=>u.value.fuzzy=g),placeholder:"请输入合同名称",onClear:L},null,8,["value"])]),_:1}),e(y,{span:"24 s:12 m:5",label:"合同编号",path:"contractnum"},{default:t(()=>[e(U,{clearable:"",value:u.value.contractnum,"onUpdate:value":v[1]||(v[1]=g=>u.value.contractnum=g),placeholder:"请输入合同编号",onClear:j},null,8,["value"])]),_:1}),e(y,{span:"24 s:12 m:7",label:"起止时间",path:"datetimerange"},{default:t(()=>[e(m,{value:u.value.startAndTimeRange,"onUpdate:value":v[2]||(v[2]=g=>u.value.startAndTimeRange=g),type:"datetimerange",clearable:"",shortcuts:T,"onUpdate:formattedValue":x},null,8,["value"])]),_:1}),e(y,{span:"24  s:12 m:6",class:"pr-24px"},{default:t(()=>[e(R,{class:"w-full"},{default:t(()=>[e(z,{onClick:M},{icon:t(()=>[e(_,{class:"text-icon"})]),default:t(()=>[i(" "+P(a(E)("common.reset")),1)]),_:1}),e(z,{type:"primary",ghost:"",onClick:D},{icon:t(()=>[e(S,{class:"text-icon"})]),default:t(()=>[i(" "+P(a(E)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),Je=A({name:"ViewDetail",__name:"view-detail",props:B({propId:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:B(["submitted"],["update:visible"]),setup(C,{emit:N}){const r=J(),p=G(C,"visible"),n=F("chap1"),u=R=>{n.value=R},T=[{key:"name",title:"姓名",align:"center"},{key:"phone",title:"联系方式",align:"center"},{key:"office",title:"职位",align:"center"}],L=[{key:"name",title:"设备名称",align:"center"},{key:"model",title:"型号",align:"center"},{key:"num",title:"数量",align:"center"},{key:"desc",title:"备注",align:"center"}],j=[{key:"stage",title:"项目阶段",align:"center"},{key:"engineer",title:"调试工程师",align:"center"},{key:"phone",title:"联系方式",align:"center"},{key:"startTime",title:"计划开始时间",align:"center",width:180},{key:"endTime",title:"计划结束时间",align:"center",width:180},{key:"desc",title:"备注",align:"center"}],x=[{key:"stage",title:"业务名称",align:"center"},{key:"engineer",title:"对接方",align:"center"},{key:"engineer",title:"对接方负责人",align:"center"},{key:"phone",title:"联系方式",align:"center"},{key:"startTime",title:"调试结果",align:"center",width:180},{key:"desc",title:"备注",align:"center"}],M=[{key:"name",title:"设备名称",align:"center"},{key:"model",title:"型号",align:"center"},{key:"num",title:"数量",align:"center"},{key:"type",title:"类型",align:"center"},{key:"desc",title:"备注",align:"center"}],D=[{key:"name",title:"设备名称",align:"center"},{key:"model",title:"型号",align:"center"},{key:"num",title:"对接方",align:"center"},{key:"type",title:"设备支持",align:"center"},{key:"desc",title:"文件",align:"center"}],o=[{key:"content",title:"影响的业务",align:"center"},{key:"deviceName",title:"设备名称",align:"center"},{key:"interfaceDocumentation",title:"接口文档",align:"center"},{key:"header",title:"研发对接人",align:"center"},{key:"cycle",title:"研发周期",align:"center"}],v=[{key:"content",title:"需求内容",align:"center"},{key:"header",title:"客户联系人",align:"center"},{key:"mobile",title:"联系方式",align:"center"},{key:"result",title:"结果",align:"center"},{key:"desc",title:"备注",align:"center"}],U=[{key:"type",title:"类型",align:"center"},{key:"fileUrl",title:"文件",align:"center"}],y=[{key:"type",title:"类型",align:"center"},{key:"fileUrl",title:"文件",align:"center"}],m=F({prjName:"",orderName:"",orderNo:"",officalId:0,officalName:"",officalMobile:"",prjadress:"",precautions:"",contactList:[],debuggedDevieceList:[],debuggedBusinessList:[],prjCycleList:[],companyDeviceList:[],developBusinessList:[],needsList:[],debugFileList:[],checkFileList:[],prjcontactor:"",startAndTimeRange:[],startTime:"",endTime:""});async function _(){n.value="chap1"}O(p,()=>{p.value&&_()});function z(R){R||S()}function S(){p.value=!1}return(R,l)=>{const f=Ke,w=W,g=Ge,c=ze,h=Le,$=Ne,b=ie,d=ce;return V(),K(d,{show:p.value,"onUpdate:show":[l[1]||(l[1]=s=>p.value=s),z],"display-directive":"show",width:1200,onMaskClick:S,onEsc:S},{default:t(()=>[e(b,{title:"合同详情","native-scrollbar":!1,closable:""},{default:t(()=>[e($,{type:"segment",animated:"",value:n.value,"onUpdate:value":[l[0]||(l[0]=s=>n.value=s),u]},{default:t(()=>[e(h,{name:"chap1",tab:"基本信息"},{default:t(()=>[e(c,{class:"h-800px pr-20px"},{default:t(()=>[e(g,{bordered:"","label-placement":"left","label-align":"center",columns:2,"label-style":{width:"160px"}},{default:t(()=>[e(f,{span:2},{label:t(()=>l[2]||(l[2]=[i(" 项目名称 ")])),default:t(()=>[i(" "+P(m.value.prjName),1)]),_:1}),e(f,null,{label:t(()=>l[3]||(l[3]=[i(" 合同名称 ")])),default:t(()=>[i(" "+P(m.value.orderName),1)]),_:1}),e(f,null,{label:t(()=>l[4]||(l[4]=[i(" 合同名称 ")])),default:t(()=>[i(" "+P(m.value.orderNo),1)]),_:1}),e(f,null,{label:t(()=>l[5]||(l[5]=[i(" 商务负责人 ")])),default:t(()=>[i(" "+P(m.value.officalName),1)]),_:1}),e(f,null,{label:t(()=>l[6]||(l[6]=[i(" 商务负责人联系方式 ")])),default:t(()=>[i(" "+P(m.value.officalMobile),1)]),_:1}),e(f,{span:2},{label:t(()=>l[7]||(l[7]=[i(" 项目地点 ")])),default:t(()=>[i(" "+P(m.value.prjadress),1)]),_:1}),e(f,{span:2},{label:t(()=>l[8]||(l[8]=[i(" 注意事项 ")])),default:t(()=>[i(" "+P(m.value.precautions),1)]),_:1}),e(f,{span:2},{label:t(()=>l[9]||(l[9]=[i(" 项目联系人 ")])),default:t(()=>[e(w,{columns:T,data:m.value.contactList,size:"small","flex-height":!a(r).isMobile,"scroll-x":702,"row-key":s=>s.id,class:"sm:h-full"},null,8,["data","flex-height","row-key"])]),_:1}),e(f,{span:2},{label:t(()=>l[10]||(l[10]=[i(" 待调试设备 ")])),default:t(()=>[e(w,{columns:L,data:m.value.debuggedDevieceList,size:"small","flex-height":!a(r).isMobile,"scroll-x":702,"row-key":s=>s.id,class:"sm:h-full"},null,8,["data","flex-height","row-key"])]),_:1}),e(f,{span:2},{label:t(()=>l[11]||(l[11]=[i(" 项目周期 ")])),default:t(()=>[e(w,{columns:j,data:m.value.prjCycleList,size:"small","flex-height":!a(r).isMobile,"scroll-x":702,"row-key":s=>s.id,class:"sm:h-full"},null,8,["data","flex-height","row-key"])]),_:1}),e(f,{span:2},{label:t(()=>l[12]||(l[12]=[i(" 文件 ")])),_:1})]),_:1})]),_:1})]),_:1}),e(h,{name:"chap2",tab:"实施信息"},{default:t(()=>[e(c,{class:"h-800px pr-20px"},{default:t(()=>[e(g,{bordered:"","label-placement":"left","label-align":"center",columns:2,"label-style":{width:"160px"}},{default:t(()=>[e(f,{span:2},{label:t(()=>l[13]||(l[13]=[i(" 待调试业务 ")])),default:t(()=>[e(w,{columns:x,data:m.value.debuggedBusinessList,size:"small","flex-height":!a(r).isMobile,"scroll-x":702,"row-key":s=>s.id,class:"sm:h-full"},null,8,["data","flex-height","row-key"])]),_:1}),e(f,{span:2},{label:t(()=>l[14]||(l[14]=[i(" 清点设备 ")])),default:t(()=>[e(w,{columns:M,data:m.value.debuggedDevieceList,size:"small","flex-height":!a(r).isMobile,"scroll-x":702,"row-key":s=>s.id,class:"sm:h-full"},null,8,["data","flex-height","row-key"])]),_:1}),e(f,{span:2},{label:t(()=>l[15]||(l[15]=[i(" 其他厂家设备 ")])),default:t(()=>[e(w,{columns:D,data:m.value.companyDeviceList,size:"small","flex-height":!a(r).isMobile,"scroll-x":702,"row-key":s=>s.id,class:"sm:h-full"},null,8,["data","flex-height","row-key"])]),_:1}),e(f,{span:2},{label:t(()=>l[16]||(l[16]=[i(" 需要开发 ")])),default:t(()=>[e(w,{columns:o,data:m.value.developBusinessList,size:"small","flex-height":!a(r).isMobile,"scroll-x":702,"row-key":s=>s.id,class:"sm:h-full"},null,8,["data","flex-height","row-key"])]),_:1}),e(f,{span:2},{label:t(()=>l[17]||(l[17]=[i(" 客户需求变更 ")])),default:t(()=>[e(w,{columns:v,data:m.value.needsList,size:"small","flex-height":!a(r).isMobile,"scroll-x":702,"row-key":s=>s.id,class:"sm:h-full"},null,8,["data","flex-height","row-key"])]),_:1}),e(f,{span:2},{label:t(()=>l[18]||(l[18]=[i(" 文件 ")])),default:t(()=>[e(w,{columns:U,data:m.value.debugFileList,size:"small","flex-height":!a(r).isMobile,"scroll-x":702,"row-key":s=>s.id,class:"sm:h-full"},null,8,["data","flex-height","row-key"])]),_:1})]),_:1})]),_:1})]),_:1}),e(h,{name:"chap3",tab:"第三章"},{default:t(()=>[e(c,{class:"h-800px pr-20px"},{default:t(()=>[e(g,{bordered:"","label-placement":"left","label-align":"center",columns:2,"label-style":{width:"160px"}},{default:t(()=>[e(f,{span:2},{label:t(()=>l[19]||(l[19]=[i(" 文件 ")])),default:t(()=>[e(w,{columns:y,data:m.value.checkFileList,size:"small","flex-height":!a(r).isMobile,"scroll-x":702,"row-key":s=>s.id,class:"sm:h-full"},null,8,["data","flex-height","row-key"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["show"])}}}),We=Se(Je,[["__scopeId","data-v-546ad5c5"]]),Qe={class:"min-h-500px flex gap-16px overflow-hidden"},Xe={class:"flex items-center justify-end gap-16px"},Ye=A({__name:"relatedProject1",props:B({id:{}},{visable:{type:Boolean},visableModifiers:{}}),emits:["update:visable"],setup(C){const N=C,r=G(C,"visable");J();const{columns:p,data:n,getData:u,loading:T,mobilePagination:L,searchParams:j}=ee({apiFn:je,immediate:!1,apiParams:{page:1,pageSize:20,limit:20,conid:N.id,_t:new Date().getTime()},columns:()=>[{key:"proname",title:"项目名称",align:"center",width:120}]}),{checkedRowKeys:x}=fe(n,u),M=()=>{r.value=!1};return O(()=>r.value,D=>{D&&(j.conid=N.id,u())}),(D,o)=>{const v=W,U=Z,y=I,m=me;return V(),K(m,{show:r.value,"onUpdate:show":o[0]||(o[0]=_=>r.value=_),preset:"card",class:"w-600px",title:"关联项目列表"},{footer:t(()=>[X("div",Xe,[e(y,{type:"primary",size:"small",onClick:M},{default:t(()=>o[1]||(o[1]=[i(" 关闭 ")])),_:1,__:[1]})])]),default:t(()=>[X("div",Qe,[e(U,{bordered:!1,size:"small",class:"flex-1 card-wrapper"},{default:t(()=>[e(v,{columns:a(p),data:a(n),size:"small",remote:"",loading:a(T),"scroll-x":a(p).reduce((_,z)=>_+(z.width||100),0),pagination:a(L),"row-key":_=>_.id,"paginate-single-page":!1,"max-height":500,"checked-row-keys":a(x)},null,8,["columns","data","loading","scroll-x","pagination","row-key","checked-row-keys"])]),_:1})])]),_:1},8,["show"])}}}),Ze=A({__name:"lookDevice",props:B({rowData:{}},{visible:{},visibleModifiers:{}}),emits:["update:visible"],setup(C){const N=J(),r=C,p=G(C,"visible"),{columns:n,data:u,getData:T,loading:L,mobilePagination:j,searchParams:x}=ee({showTotal:!0,immediate:!1,apiFn:Me,apiParams:{page:1,pageSize:20,limit:20,fuzzy:"",pids:void 0,_t:new Date().getTime()},columns:()=>[{key:"devname",title:"设备名称",align:"center",width:180,ellipsis:{tooltip:!0}},{key:"devcount",title:"数量",align:"center",width:80},{key:"devmodel",title:"型号",align:"center",width:120},{key:"devunit",title:"单位",align:"center",width:120},{key:"devtype",title:"是否为我司厂家",align:"center",width:120,render:D=>D.devtype==1?e(ne,{type:"success"},{default:()=>[i("是")]}):e(ne,{type:"info"},{default:()=>[i("否")]})},{key:"devmanu",title:"设备厂家",align:"center",width:120},{key:"notes",title:"备注",align:"center",width:120},{key:"username",title:"创建人",align:"center",width:120},{key:"dbtime",title:"创建时间",align:"center",width:120}]}),M=F("");return O(()=>p.value,D=>{var o,v;D&&(console.log(r.rowData,"propspropsprops"),x.pids=(o=r.rowData)==null?void 0:o.id,M.value=((v=r.rowData)==null?void 0:v.contractname)+"的设备",T())}),(D,o)=>{const v=W,U=me;return V(),K(U,{show:p.value,"onUpdate:show":o[0]||(o[0]=y=>p.value=y),title:M.value,preset:"card",style:{width:"80vw",height:"70vh"}},{default:t(()=>[e(v,{columns:a(n),data:a(u),size:"small","flex-height":!a(N).isMobile,loading:a(L),remote:"","row-key":y=>y.id,pagination:a(j),class:"sm:h-full"},null,8,["columns","data","flex-height","loading","row-key","pagination"])]),_:1},8,["show","title"])}}}),et={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},dt=A({name:"projectmanagement_contractlist",__name:"index",setup(C){const N=se(),r=J();Ue(),Pe(),pe();const p=F(!1),n=F(!1),u=F(0),{columns:T,columnChecks:L,data:j,getData:x,loading:M,mobilePagination:D,searchParams:o}=ee({showTotal:!0,apiFn:$e,apiParams:{page:1,pageSize:20,limit:20,pid:void 0,fuzzy:null,contractnum:null,status:null,startAndTimeRange:null,startTime:null,endTime:null,_t:new Date().getTime()},immediate:!1,columns:()=>[{type:"selection",align:"center",width:48,fixed:"left"},{key:"contractname",title:"合同名称",align:"center",width:200},{key:"contractnum",title:"合同编号",align:"center",width:180,ellipsis:{tooltip:!0}},{key:"businesscon",title:"商务负责人",align:"center",width:100,ellipsis:{tooltip:!0}},{key:"businessinfo",title:"商务联系方式",align:"center",width:160,ellipsis:{tooltip:!0}},{key:"precautions",title:"注意事项",align:"center",width:120},{key:"notes",title:"备注",align:"center",width:120,ellipsis:{tooltip:!0}},{key:"username",title:"创建者",align:"center",width:100},{key:"dbtime",title:"创建时间",align:"center",width:180},{key:"operate",title:E("common.operate"),align:"center",width:240,fixed:"right",render:b=>e("div",{class:"flex-center gap-8px"},[e(I,{type:"primary",ghost:!0,size:"small",onClick:()=>g(b)},{default:()=>["关联项目"]}),e(I,{type:"primary",ghost:!0,size:"small",onClick:()=>$(b)},{default:()=>["查看设备列表"]})])}]}),{drawerVisible:v,operateType:U,editingData:y,checkedRowKeys:m}=fe(j,x),_=F([]),{pageData:z,getData:S,nextPage:R}=ge(Be),l=async b=>{const d=b.currentTarget,s=d.scrollTop;d.scrollTop+d.offsetHeight>=d.scrollHeight&&z.data.length<z.total&&(await R(),_.value=z.data,await de(),setTimeout(()=>{d.scrollTop=s}))};Re(async()=>{var b;await S(),_.value=z.data,o.pid=N.query.PrjId*1||((b=_.value[0])==null?void 0:b.id),o.status=N.query.status*1?N.query.status*1:void 0,o.pid&&x()});const f=F(!1),w=F(null),g=b=>{w.value=b.id,f.value=!0},c=b=>{o.status=b.status,x()},h=()=>{x()},$=b=>{y.value=b,n.value=!0};return(b,d)=>{const s=Y,Q=_e,ve=W,be=Z;return V(),Fe("div",et,[e(Oe,{projectList:_.value,onScrollPrj:l,model:a(o),"onUpdate:model":d[0]||(d[0]=k=>H(o)?o.value=k:null),onReset:h,onSearch:a(x)},null,8,["projectList","model","onSearch"]),e(be,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:t(()=>[e(s,{align:"center",wrap:"",class:"lt-sm:w-200px"},{default:t(()=>d[7]||(d[7]=[X("div",null,"合同列表",-1)])),_:1,__:[7]})]),"header-extra":t(()=>[e(s,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:t(()=>[e(Q,{columns:a(L),"onUpdate:columns":d[1]||(d[1]=k=>H(L)?L.value=k:null),ctype:6},null,8,["columns"])]),_:1})]),default:t(()=>[e(ve,{"checked-row-keys":a(m),"onUpdate:checkedRowKeys":d[2]||(d[2]=k=>H(m)?m.value=k:null),columns:a(T),data:a(j),size:"small","flex-height":!a(r).isMobile,"scroll-x":a(T).reduce((k,ye)=>k+(ye.width||100),0),loading:a(M),remote:"","row-key":k=>k.id,pagination:a(D),class:"sm:h-full","onUpdate:filters":c},null,8,["checked-row-keys","columns","data","flex-height","scroll-x","loading","row-key","pagination"]),e(He,{visible:a(v),"onUpdate:visible":d[3]||(d[3]=k=>H(v)?v.value=k:null),onSubmitted:a(x),projectList:_.value,pid:a(o).pid,"operate-type":a(U),"row-data":a(y)},null,8,["visible","onSubmitted","projectList","pid","operate-type","row-data"]),e(Ze,{visible:n.value,"onUpdate:visible":d[4]||(d[4]=k=>n.value=k),"row-data":a(y)},null,8,["visible","row-data"]),e(Ye,{visable:f.value,"onUpdate:visable":d[5]||(d[5]=k=>f.value=k),id:w.value},null,8,["visable","id"]),e(We,{visible:p.value,"onUpdate:visible":d[6]||(d[6]=k=>p.value=k),propId:u.value},null,8,["visible","propId"])]),_:1})])}}});export{dt as default};

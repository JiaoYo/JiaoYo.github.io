import{_ as I}from"./table-header-operation.vue_vue_type_script_setup_true_lang-DOgh_89k.js";import{d as z,q,j as X,s as J,x as Q,o as k,c as R,w as l,g as a,i as e,$ as D,X as Y,e as O,ao as Z,H as ee,h as M,t as U,f as te,G as ae,a0 as ne,B as le,O as oe,P as se,ad as A,a4 as ie,av as re,ah as P,ai as ce,aj as me}from"./index-C5IVBnuT.js";import{u as pe,a as de}from"./table-CQwo57Cc.js";import{_ as ue,a as _e}from"./arrow-open-up-BGzdQEeg.js";import{_ as fe}from"./round-search-BDs78GhZ.js";import{_ as ge}from"./round-refresh-DiPTY6w8.js";import{u as $}from"./usePageData-B-2UX2DD.js";import{g as he,h as ve,i as ye}from"./events-CBEXM-sY.js";import{a as be,T as ke}from"./basicconf-Co9dl9Q4.js";import{_ as De}from"./lodash-Bi0mdSrH.js";import{_ as xe}from"./FormItemGridItem-0rbPDrs6.js";import{_ as we}from"./DatePicker-BILi7KHr.js";import{_ as Te}from"./Grid-BAhwGuO1.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-q-O0l1pH.js";import"./setting-outlined-DnWUUCAN.js";import"./export-SR1Whgcp.js";import"./refresh-C-J5xeSd.js";import"./round-delete-CgapNMDE.js";import"./round-plus-CEbJe1F4.js";import"./Upload-BuS47aQS.js";import"./Progress-CG76YBZ6.js";import"./Popconfirm-8Mt3zkJO.js";import"./TimePicker-Dx4geqmp.js";import"./defineProperty-BYqLBAK_.js";const Se=z({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:q(["reset","search"],["update:model"]),setup(u,{emit:T}){const f=T,c=X(!1),{formRef:x,restoreValidation:g}=J(),n=Q(u,"model"),{pageData:h,getData:v,nextPage:S}=$(he),B=async i=>{const t=i.currentTarget;t.scrollTop+t.offsetHeight>=t.scrollHeight&&h.data.length<h.total&&S()},{pageData:w,getData:H,nextPage:N}=$(ve),V=async i=>{const t=i.currentTarget;t.scrollTop+t.offsetHeight>=t.scrollHeight&&w.data.length<w.total&&N()};async function m(i,t){i?(n.value.startTime=i[0],n.value.endTime=i[1]):(n.value.startTime=null,n.value.endTime=null),f("search")}async function E(){await g(),n.value.timeRange=null,f("reset")}async function y(){f("search")}const C=De.throttle(y,1e3,{trailing:!1});return v(),H(),(i,t)=>{const b=ne,o=xe,s=we,d=ge,_=le,L=fe,r=ue,F=_e,G=oe,j=Te,K=se,W=A;return k(),R(W,{bordered:!1,size:"small",class:"card-wrapper"},{default:l(()=>[a(K,{ref_key:"formRef",ref:x,model:n.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:ae(e(C),["enter"])},{default:l(()=>[a(j,{responsive:"screen","item-responsive":"","y-gap":20},{default:l(()=>[a(o,{span:"24 s:24 m:8 l:6",label:"事件名称",path:"enameid"},{default:l(()=>[a(b,{value:n.value.enameid,"onUpdate:value":[t[0]||(t[0]=p=>n.value.enameid=p),y],placeholder:"请选择事件名称",clearable:"",filterable:"","value-field":"id","label-field":"ename",options:e(h).data,"reset-menu-on-options-change":!1,onScroll:B},null,8,["value","options"])]),_:1}),a(o,{span:"24 s:24 m:8 l:6",label:e(D)("page.manage.alarm.level"),path:"elevel"},{default:l(()=>[a(b,{filterable:"",clearable:"",placeholder:e(D)("page.manage.alarm.form.level"),value:n.value.elevel,"onUpdate:value":[t[1]||(t[1]=p=>n.value.elevel=p),y],options:e(Y)(e(be))},null,8,["placeholder","value","options"])]),_:1},8,["label"]),c.value?(k(),O(Z,{key:0},[a(o,{span:"24 s:24 m:8 l:6",label:"时间",path:"timeRange"},{default:l(()=>[a(s,{clearable:"",value:n.value.timeRange,"onUpdate:value":t[2]||(t[2]=p=>n.value.timeRange=p),type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss",style:{width:"100%"},"onUpdate:formattedValue":m},null,8,["value"])]),_:1}),a(o,{span:"24 s:24 m:8 l:6",label:"策略名称",path:"pnameid"},{default:l(()=>[a(b,{value:n.value.pnameid,"onUpdate:value":[t[3]||(t[3]=p=>n.value.pnameid=p),y],placeholder:"请选择策略名称",clearable:"",filterable:"","value-field":"id","label-field":"aname",options:e(w).data,"reset-menu-on-options-change":!1,onScroll:V},null,8,["value","options"])]),_:1})],64)):ee("",!0),a(o,{span:"24 s:24 m:8 l:6",label:" "},{default:l(()=>[a(G,{class:"w-full",align:"center"},{default:l(()=>[a(_,{onClick:E},{icon:l(()=>[a(d,{class:"text-icon"})]),default:l(()=>[M(" "+U(e(D)("common.reset")),1)]),_:1}),a(_,{type:"primary",ghost:"",onClick:e(C)},{icon:l(()=>[a(L,{class:"text-icon"})]),default:l(()=>[M(" "+U(e(D)("common.search")),1)]),_:1},8,["onClick"]),te("div",{class:"cursor-pointer",title:"精准查询",onClick:t[4]||(t[4]=p=>c.value=!c.value)},[c.value?(k(),R(r,{key:0,class:"text-icon"})):(k(),R(F,{key:1,class:"text-icon"}))])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","onKeyup"])]),_:1})}}}),Ne={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function Ce(u){return typeof u=="function"||Object.prototype.toString.call(u)==="[object Object]"&&!ce(u)}const Ze=z({name:"eventalarm_associatedevents",__name:"index",setup(u){const T=ie(),{columns:f,columnChecks:c,data:x,getData:g,loading:n,mobilePagination:h,searchParams:v,resetSearchParams:S}=pe({apiFn:ye,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,pnameid:null,enameid:null,elevel:null,startTime:null,endTime:null,fuzzy:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48,fixed:"left"},{key:"pname",title:"事件类型",align:"center",minWidth:160,ellipsis:{tooltip:!0}},{key:"ename",title:"事件名称",align:"center",minWidth:160,ellipsis:{tooltip:!0}},{key:"aname",title:"策略名称",align:"center",minWidth:160,ellipsis:{tooltip:!0}},{key:"elevel",title:"事件等级",align:"center",minWidth:120,render:o=>{(o.elevel===void 0||o.elevel===null)&&(o.elevel=1);const s={0:"#8e9dff",1:"#5da8ff",2:"#fedc69",3:"#ff9874",4:"#ff0000"},d=D(ke[o.elevel]);let _={color:s[o.elevel],textColor:"#ffffff",borderColor:s[o.elevel]};return a(re,{size:"small",color:_},Ce(d)?d:{default:()=>[d]})}},{key:"num",title:"次数",align:"center",width:180},{key:"gnrtime",title:"产生时间",align:"center",width:180},{key:"dbtime",title:"更新时间",align:"center",width:180}]}),{drawerVisible:B,operateType:w,editingData:H,handleAdd:N,handleEdit:V,checkedRowKeys:m,onBatchDeleted:E,onDeleted:y,closeDrawer:C}=de(x,g);async function i(){console.log(m.value),t(m.value)}async function t(o,s){}async function b(){}return(o,s)=>{const d=I,_=me,L=A;return k(),O("div",Ne,[a(Se,{model:e(v),"onUpdate:model":s[0]||(s[0]=r=>P(v)?v.value=r:null),onReset:e(S),onSearch:e(g)},null,8,["model","onReset","onSearch"]),a(L,{title:"关联事件",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":l(()=>[a(d,{columns:e(c),"onUpdate:columns":s[1]||(s[1]=r=>P(c)?c.value=r:null),"disabled-delete":e(m).length===0,loading:e(n),onAdd:e(N),onDelete:i,onRefresh:e(g),"is-view-export-button":!0,onExportHandler:b},null,8,["columns","disabled-delete","loading","onAdd","onRefresh"])]),default:l(()=>[a(_,{"checked-row-keys":e(m),"onUpdate:checkedRowKeys":s[2]||(s[2]=r=>P(m)?m.value=r:null),columns:e(f),data:e(x),size:"small","flex-height":!e(T).isMobile,"scroll-x":962,loading:e(n),remote:"","row-key":r=>r.id,pagination:e(h),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1})])}}});export{Ze as default};

import{_ as L}from"./export-CRNNAALd.js";import{_ as Y}from"./round-search-BDwdOV7z.js";import{d as C,k as i,av as w,o as u,e as B,g as o,w as n,i as c,B as f,h as y,t as h,$ as D,c as g,D as v,aw as Q,aK as R,Q as G,P as V,a6 as Z,_ as z}from"./index-CVr6HMAr.js";import{f as $}from"./metar-Rvx_y_E0.js";import{e as I}from"./exportExcel-Bv4G4H50.js";import{_ as K}from"./DatePicker-zOoaul88.js";import{_ as U}from"./FormItemGridItem-DmWV2D-y.js";import{_ as j}from"./Grid-te9_3H3g.js";const q={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},A=C({name:"realtimequery_powerweatheroverview",__name:"index",setup(J){const x=[{key:"dbtime",title:"时间",align:"center",width:160,fixed:"left"},{key:"EnvT",title:"环境温度",align:"center",width:140},{key:"LDT",title:"露点温度",align:"center",width:140},{key:"EnvH",title:"环境湿度",align:"center",width:140},{key:"WindD",title:"风向瞬时值",align:"center",width:140},{key:"WindS",title:"风速瞬时值",align:"center",width:140},{key:"YLDayE",title:"雨量日累计",align:"center",width:140},{key:"QY",title:"气压",align:"center",width:80},{key:"RZDayHour",title:"日照日累计时数",align:"center",width:140},{key:"FSD2Day",title:"直接辐射日累计量",align:"center",width:140},{key:"FSD1Day",title:"散射辐射日累计量",align:"center",width:140},{key:"power",title:"实际功率(MW)",align:"center",width:100,fixed:"right"},{key:"prePower",title:"预测功率(MW)",align:"center",width:100,fixed:"right"},{key:"operate",title:"误差(MW)",align:"center",width:100,fixed:"right",render(t){const a=t.prePower-t.power>=0?t.prePower-t.power:t.power-t.prePower;return o("span",null,[a?parseFloat(a.toFixed(6)):""])}}],k=i(!1),r=i({dateTime:w(0,Date.now())}),T=t=>{r.value.dateTime=w(0,t),d()},s=i([]),d=async()=>{const{data:t,error:a}=await $({date:r.value.dateTime});a||(s.value=t,E())};d();const E=async()=>{const{data:t,error:a}=await Q({date:r.value.dateTime});a||(console.log(t),s.value.forEach(e=>{const l=t.find(p=>p.dbtime===e.dbtime);l&&(e.power=l.power,e.prePower=l.prePower)}))},m=i("0"),S=async()=>{d()},P=()=>{const t={dbtime:"时间",EnvT:"环境温度",LDT:"露点温度",EnvH:"环境湿度",WindD:"风向瞬时值",WindS:"风速瞬时值",YLDayE:"雨量日累计",QY:"气压",RZDayHour:"日照日累计时数",FSD2Day:"直接辐射日累计量",FSD1Day:"散射辐射日累计量",power:"实际功率(MW)",prePower:"预测功率(MW)",error:"误差(MW)"},a=[];s.value.forEach(e=>{a.push({dbtime:e.dbtime,EnvT:e.EnvT,LDT:e.LDT,EnvH:e.EnvH,WindD:e.WindD,WindS:e.WindS,YLDayE:e.YLDayE,QY:e.QY,RZDayHour:e.RZDayHour,FSD2Day:e.FSD2Day,FSD1Day:e.FSD1Day,power:e.power,prePower:e.prePower,error:e.prePower-e.power>=0?e.prePower-e.power:e.power-e.prePower||""})}),I(a,t,r.value.dateTime+"_气象功率概览")};return(t,a)=>{const e=R,l=K,p=Y,W=U,b=j,F=G,H=L,M=V,N=Z;return u(),B("div",q,[o(N,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:n(()=>[o(F,{ref:"formRef",model:r.value,"label-placement":"left","show-feedback":!1},{default:n(()=>[o(b,{"y-gap":16,responsive:"screen","item-responsive":""},{default:n(()=>[o(W,{span:"24 s:12 m:18",label:"日期",path:"startTime"},{default:n(()=>[o(l,{"formatted-value":r.value.dateTime,"onUpdate:formattedValue":a[0]||(a[0]=_=>r.value.dateTime=_),"value-format":"yyyy-MM-dd",type:"date","onUpdate:value":T,style:{width:"200px"}},null,8,["formatted-value"]),o(c(f),{type:"primary",ghost:"",onClick:S,class:"mx-20px"},{icon:n(()=>[o(p,{class:"text-icon"})]),default:n(()=>[y(" "+h(c(D)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),"header-extra":n(()=>[m.value==="0"?(u(),g(M,{key:0,align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:n(()=>[o(c(f),{onClick:P,size:"small"},{icon:n(()=>[o(H,{class:"text-icon"})]),default:n(()=>[y(" "+h(c(D)("common.export")),1)]),_:1})]),_:1})):v("",!0)]),default:n(()=>[m.value==="0"?(u(),g(e,{key:0,columns:x,data:s.value,size:"small",loading:k.value,remote:"","row-key":_=>_.id,class:"sm:h-full","flex-height":!0,"scroll-x":""},null,8,["data","loading","row-key"])):v("",!0)]),_:1})])}}}),le=z(A,[["__scopeId","data-v-4362e82e"]]);export{le as default};

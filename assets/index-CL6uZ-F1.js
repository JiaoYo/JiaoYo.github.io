import{_ as X}from"./table-header-operation.vue_vue_type_script_setup_true_lang-DInf_94l.js";import{d as K,q as F,s as q,v as E,x as Y,b as ee,r as te,y as ne,o as V,c as L,w as n,g as e,h as P,t as U,i as o,$ as f,M as W,ao as oe,A as H,C as ae,E as Z,D as J,B as T,aa as se,ab as le,K as O,L as A,a9 as Q,Z as ie,e as re,ac as M,ad as pe}from"./index-D4ngyqj9.js";import{v as de,w as ce,e as ue,x as me}from"./asset-Dnbld3Pr.js";import{u as _e,a as fe}from"./table-B-O-KQBR.js";import{b as ve,a as ge,_ as we}from"./DataTable-Bkf-sC_U.js";import{_ as he}from"./round-search-afmjBCkU.js";import{_ as ye}from"./round-refresh-DGUmO54G.js";import{_ as be}from"./FormItemGridItem-tGN8LyML.js";import{_ as ke}from"./Grid-3ti0RnUO.js";import{h as j}from"./permission-Ble3lU0D.js";import{_ as De}from"./Popconfirm-DsZjOQOD.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-QeSS3CPK.js";import"./setting-outlined-DuD7pXau.js";import"./round-delete-DNpSdI2L.js";import"./refresh-CahwNtd4.js";import"./Upload-B89re_JK.js";import"./Progress-Q6s-Jzjc.js";import"./Forward-Bpby_coU.js";const Ne=K({name:"OperateDrawer",__name:"operate-drawer",props:F({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:F(["submitted"],["update:visible"]),setup(v,{emit:z}){const r=v,w=z,m=q(v,"visible"),{formRef:c,validate:N,restoreValidation:S}=E(),{defaultRequiredRule:h,formRules:C}=Y(),y=ee(()=>({add:"新增网络配置",edit:"编辑网络配置"})[r.operateType]),t=te(D());function D(){return{nname:"",iptype:0,startip:"",endip:"",ndesc:""}}const R={nname:h,startip:C.ip,endip:C.ip};function x(){Object.assign(t,D()),r.operateType==="edit"&&r.rowData&&Object.assign(t,r.rowData)}function p(){m.value=!1}async function I(){var b,s,u,d;if(await N(),oe(t.startip,t.endip)>0)return(b=window.$message)==null||b.destroyAll(),(s=window.$message)==null||s.error("起始IP不能大于结束IP"),!1;if(r.operateType==="add"){const{data:k,error:g}=await de([{nname:t.nname,iptype:t.iptype,startip:t.startip,endip:t.endip,ndesc:t.ndesc}]);g||((u=window.$message)==null||u.success(f("common.addSuccess")),p(),w("submitted"))}else{const{data:k,error:g}=await ce([{id:r.rowData.id,nname:t.nname,iptype:t.iptype,startip:t.startip,endip:t.endip,ndesc:t.ndesc}]);g||((d=window.$message)==null||d.success(f("common.updateSuccess")),p(),w("submitted"))}}return ne(m,()=>{m.value&&(x(),S())}),(b,s)=>{const u=H,d=ae,k=ve,g=Z,l=ge,i=J,_=T,$=se,B=le;return V(),L(B,{show:m.value,"onUpdate:show":s[5]||(s[5]=a=>m.value=a),"display-directive":"show",width:360},{default:n(()=>[e($,{title:y.value,"native-scrollbar":!1,closable:""},{footer:n(()=>[e(g,{size:16},{default:n(()=>[e(_,{onClick:p},{default:n(()=>[P(U(o(f)("common.cancel")),1)]),_:1}),e(_,{type:"primary",onClick:I},{default:n(()=>[P(U(o(f)("common.confirm")),1)]),_:1})]),_:1})]),default:n(()=>[e(i,{ref_key:"formRef",ref:c,model:t,rules:R,onKeyup:W(I,["enter"])},{default:n(()=>[e(d,{label:"网络名称",path:"nname"},{default:n(()=>[e(u,{value:t.nname,"onUpdate:value":s[0]||(s[0]=a=>t.nname=a),placeholder:"请输入网络名称",clearable:""},null,8,["value"])]),_:1}),e(d,{label:"IP类型",path:"iptype"},{default:n(()=>[e(l,{value:t.iptype,"onUpdate:value":s[1]||(s[1]=a=>t.iptype=a)},{default:n(()=>[e(g,null,{default:n(()=>[e(k,{value:0},{default:n(()=>[P("IPv4")]),_:1}),e(k,{value:1},{default:n(()=>[P("IPv6")]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),e(d,{label:"起始IP",path:"startip"},{default:n(()=>[e(u,{value:t.startip,"onUpdate:value":s[2]||(s[2]=a=>t.startip=a),placeholder:"请输入起始IP",clearable:""},null,8,["value"])]),_:1}),e(d,{label:"结束IP",path:"endip"},{default:n(()=>[e(u,{value:t.endip,"onUpdate:value":s[3]||(s[3]=a=>t.endip=a),placeholder:"请输入结束IP",clearable:""},null,8,["value"])]),_:1}),e(d,{label:"描述",path:"ndesc"},{default:n(()=>[e(u,{value:t.ndesc,"onUpdate:value":s[4]||(s[4]=a=>t.ndesc=a),type:"textarea",placeholder:"请输入描述",clearable:""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),xe=K({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:F(["reset","search"],["update:model"]),setup(v,{emit:z}){const r=z,{formRef:w,restoreValidation:m}=E(),c=q(v,"model");function N(){c.value.fuzzy="",r("search")}async function S(){await m(),r("reset")}async function h(){r("search")}return(C,y)=>{const t=H,D=be,R=ye,x=T,p=he,I=Z,b=ke,s=J,u=Q,d=O("no-space");return V(),L(u,{bordered:!1,size:"small",class:"card-wrapper"},{default:n(()=>[e(s,{ref_key:"formRef",ref:w,model:c.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:W(h,["enter"])},{default:n(()=>[e(b,{responsive:"screen","item-responsive":""},{default:n(()=>[e(D,{span:"24 s:12 m:6",label:"名称",path:"fuzzy",class:"pr-24px"},{default:n(()=>[A(e(t,{value:c.value.fuzzy,"onUpdate:value":y[0]||(y[0]=k=>c.value.fuzzy=k),placeholder:"请输入名称",clearable:"",onClear:N},null,8,["value"]),[[d]])]),_:1}),e(D,{span:"24 m:6",class:"pr-24px"},{default:n(()=>[e(I,{class:"w-full"},{default:n(()=>[e(x,{onClick:S},{icon:n(()=>[e(R,{class:"text-icon"})]),default:n(()=>[P(" "+U(o(f)("common.reset")),1)]),_:1}),e(x,{type:"primary",ghost:"",onClick:h},{icon:n(()=>[e(p,{class:"text-icon"})]),default:n(()=>[P(" "+U(o(f)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),Ie={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function G(v){return typeof v=="function"||Object.prototype.toString.call(v)==="[object Object]"&&!pe(v)}const Ee=K({name:"assetmanagement_network",__name:"index",setup(v){const z=ie(),{columns:r,columnChecks:w,data:m,getData:c,loading:N,mobilePagination:S,searchParams:h,resetSearchParams:C}=_e({apiFn:ue,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,fuzzy:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48},{key:"nname",title:"名称",align:"center",minWidth:160,ellipsis:{tooltip:!0}},{key:"iptype",title:"IP类型",align:"center",width:120,render:l=>e("div",null,[l.iptype==0?"IPv4":"IPv6"])},{key:"startip",title:"IP范围",align:"center",width:260,render:l=>`${l.startip} ~ ${l.endip}`,ellipsis:{tooltip:!0}},{key:"ndesc",title:"描述",align:"center",minWidth:160,ellipsis:{tooltip:!0}},{key:"operate",title:f("common.operate"),align:"center",width:130,render:l=>{let i;return e("div",{class:"flex-center gap-8px"},[A(e(T,{type:"primary",ghost:!0,size:"small",onClick:()=>k(l.id)},G(i=f("common.edit"))?i:{default:()=>[i]}),[[O("no-auth"),"sys.network.mengement.update"]]),e(De,{onPositiveClick:()=>d(l.id)},{default:()=>f("common.confirmDelete"),trigger:()=>{let _;return A(e(T,{type:"error",ghost:!0,size:"small"},G(_=f("common.delete"))?_:{default:()=>[_]}),[[O("no-auth"),"sys.network.mengement.delete"]])}})])}}]}),{drawerVisible:y,operateType:t,editingData:D,handleAdd:R,handleEdit:x,checkedRowKeys:p,onBatchDeleted:I,onDeleted:b,closeDrawer:s}=fe(m,c);async function u(){console.log(p.value),g(p.value,l=>{I()})}function d(l){console.log(l),g([l],i=>{b()})}function k(l){x(l)}async function g(l,i){const{data:_,error:$}=await me(l);if(!$)i&&i(_);else return!1}return(l,i)=>{const _=X,$=we,B=Q;return V(),re("div",Ie,[e(xe,{model:o(h),"onUpdate:model":i[0]||(i[0]=a=>M(h)?h.value=a:null),onReset:o(C),onSearch:o(c)},null,8,["model","onReset","onSearch"]),e(B,{title:"网络管理",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":n(()=>[e(_,{columns:o(w),"onUpdate:columns":i[1]||(i[1]=a=>M(w)?w.value=a:null),"disabled-delete":o(p).length===0,"is-view-add-button":o(j)("sys.network.mengement.insert"),"is-view-delete-button":o(j)("sys.network.mengement.delete"),loading:o(N),onAdd:o(R),onDelete:u,onRefresh:o(c)},null,8,["columns","disabled-delete","is-view-add-button","is-view-delete-button","loading","onAdd","onRefresh"])]),default:n(()=>[e($,{"checked-row-keys":o(p),"onUpdate:checkedRowKeys":i[2]||(i[2]=a=>M(p)?p.value=a:null),columns:o(r),data:o(m),size:"small","flex-height":!o(z).isMobile,"scroll-x":962,loading:o(N),remote:"","row-key":a=>a.id,pagination:o(S),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(Ne,{visible:o(y),"onUpdate:visible":i[3]||(i[3]=a=>M(y)?y.value=a:null),"operate-type":o(t),"row-data":o(D),onSubmitted:o(c)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1})])}}});export{Ee as default};

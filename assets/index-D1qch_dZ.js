import{d as H,o as x,e as F,f as a,a4 as te,_ as O,k as y,al as ge,b as ae,am as xe,i as C,an as ue,R as J,T as Y,c as me,w as j,t as v,D as fe,af as q,ao as oe,ap as ve,g as L,j as Se,x as se,ag as ce,ac as Ce,h as ee,q as $e,ab as _e,u as Fe,a1 as De,r as ke,aj as Te,aq as Ie,ar as de,as as Le,at as Ae,au as Ne,av as G,aw as Be,ax as Me,y as Ee,H as Oe,ay as ie,az as We,aA as He,aB as Pe,aC as Re,ak as Ve}from"./index-BkKwuL7t.js";import{u as pe,L as V}from"./echarts-2DZrcJCR.js";import{G as ze,h as je,a as Ge,b as qe}from"./metar-DsZcFXBl.js";const Ue={class:"loader-overlay"},Je=H({__name:"loading",props:{color:{default:"#1890ff"}},setup(d){const t=d;return(i,n)=>(x(),F("div",Ue,[a("div",{class:"loader",style:te({"--c":`no-repeat linear-gradient(${t.color} 0 0)`})},null,4)]))}}),Ye=O(Je,[["__scopeId","data-v-c4fc24aa"]]),Qe=d=>(J("data-v-4ea05f61"),d=d(),Y(),d),Ke=["width","height"],Xe=["fill","stroke","d"],Ze=["stroke"],et=Qe(()=>a("path",{fill:"transparent",stroke:"{mergedColor[1]}",d:"M 5 20 L 5 10 L 12 3  L 60 3 L 68 10"},null,-1)),tt=["stroke","d"],at={class:"dv-border-box-content"},ot=H({__name:"border-box-13",props:{color:{type:Array,default:()=>[]},backgroundColor:{type:String,default:"transparent"}},setup(d){const t=d,i=["#6586ec","#2cf7fe"],n=y(null),{width:h,height:b}=ge(n,{width:0,height:0},{box:"border-box"}),_=ae(()=>xe(i,t.color));return($,k)=>(x(),F("div",{class:"dv-border-box-13 dv-border-box",ref_key:"domRef",ref:n},[(x(),F("svg",{width:C(h),height:C(b),class:"dv-border-svg-container"},[a("path",{fill:d.backgroundColor,stroke:_.value[0],d:`
            M 5 20 L 5 10 L 12 3  L 60 3 L 68 10
            L ${C(h)-20} 10 L ${C(h)-5} 25
            L ${C(h)-5} ${C(b)-5} L 20 ${C(b)-5}
            L 5 ${C(b)-20} L 5 20
        `},null,8,Xe),a("path",{fill:"transparent","stroke-width":"3","stroke-linecap":"round","stroke-dasharray":"10, 5",stroke:_.value[0],d:"M 16 9 L 61 9"},null,8,Ze),et,a("path",{fill:"transparent",stroke:_.value[1],d:`M ${C(h)-5} ${C(b)-30} L ${C(h)-5} ${C(b)-5} L ${C(h)-30} ${C(b)-5}`},null,8,tt)],8,Ke)),a("div",at,[ue($.$slots,"default",{},void 0,!0)])],512))}}),st=O(ot,[["__scopeId","data-v-4ea05f61"]]),he=d=>(J("data-v-9eaf43ad"),d=d(),Y(),d),lt={key:0,class:"item_title"},nt=he(()=>a("div",{class:"zuo"},null,-1)),rt={class:"title-inner"},ct=he(()=>a("div",{class:"you"},null,-1)),dt=H({__name:"item-wrap",props:{title:{default:""}},setup(d){return(t,i)=>{const n=st;return x(),me(n,null,{default:j(()=>[t.title!==""?(x(),F("div",lt,[nt,a("span",rt,"   "+v(t.title)+"   ",1),ct])):fe("",!0),a("div",{class:q(t.title!==""?"item_title_content":"item_title_content_def")},[ue(t.$slots,"default",{},void 0,!0)],2)]),_:3})}}}),it=O(dt,[["__scopeId","data-v-9eaf43ad"]]),ut={class:"list"},mt={class:"item_info"},ft={class:"title"},vt={class:"value"},_t=H({__name:"left-bottom",props:{data:{type:Object,default:()=>({})}},setup(d){const t=d,i=[{minTemp:-1/0,maxTemp:-20,color:"#00008B",name:"深蓝色"},{minTemp:-20,maxTemp:0,color:"#1E90FF",name:"蓝色"},{minTemp:0,maxTemp:10,color:"#87CEFA",name:"浅蓝色"},{minTemp:10,maxTemp:20,color:"#32CD32",name:"绿色"},{minTemp:20,maxTemp:30,color:"#FFD700",name:"黄色"},{minTemp:30,maxTemp:40,color:"#FF8C00",name:"橙色"},{minTemp:40,maxTemp:1/0,color:"#FF0000",name:"红色"}];function n(l){const e=i.find(s=>l>s.minTemp&&l<=s.maxTemp);return e?e.color:"#CCCCCC"}const h=[{min:-1/0,max:970,level:"极低",color:"#8A2BE2",desc:"强低压系统(如台风)"},{min:970,max:990,level:"低",color:"#9370DB",desc:"低压系统(如气旋)"},{min:990,max:1010,level:"偏低",color:"#4169E1",desc:"弱低压"},{min:1010,max:1030,level:"正常",color:"#3CB371",desc:"正常气压范围"},{min:1030,max:1050,level:"偏高",color:"#FFD700",desc:"高压脊"},{min:1050,max:1/0,level:"高",color:"#FF8C00",desc:"强高压系统"}];function b(l){const e=h.find(s=>l>s.min&&l<=s.max);return e?e.color:"#CCCCCC"}const _=[{max:20,level:"极干燥",color:"#D2B48C"},{max:40,level:"干燥",color:"#F4A460"},{max:55,level:"较干燥",color:"#FFE4B5"},{max:65,level:"理想",color:"#98FB98"},{max:75,level:"较湿润",color:"#AFEEEE"},{max:85,level:"高湿",color:"#6495ED"},{max:95,level:"极高湿",color:"#4169E1"},{max:1/0,level:"饱和",color:"#9370DB"}];function $(l){const e=_.find(s=>l<=s.max);return e?e.color:"#CCCCCC"}const k=[{maxSpeed:.5,level:0,desc:"无风",color:"#FFFFFF"},{maxSpeed:1.5,level:1,desc:"软风",color:"#E6F7FF"},{maxSpeed:3.3,level:2,desc:"轻风",color:"#B3E0FF"},{maxSpeed:5.4,level:3,desc:"微风",color:"#66C2FF"},{maxSpeed:7.9,level:4,desc:"和风",color:"#4CD964"},{maxSpeed:10.7,level:5,desc:"清风",color:"#A3E043"},{maxSpeed:13.8,level:6,desc:"强风",color:"#FFCC00"},{maxSpeed:17.1,level:7,desc:"疾风",color:"#FF9500"},{maxSpeed:20.7,level:8,desc:"大风",color:"#FF6600"},{maxSpeed:24.4,level:9,desc:"烈风",color:"#FF3B30"},{maxSpeed:28.4,level:10,desc:"狂风",color:"#CC0000"},{maxSpeed:32.6,level:11,desc:"暴风",color:"#9900CC"},{maxSpeed:1/0,level:12,desc:"飓风",color:"#660066"}];function T(l){const e=k.find(s=>l<=s.maxSpeed);return e?e.color:"#000000"}const B=[{max:100,level:"极弱",color:"#1A237E"},{max:200,level:"弱",color:"#1976D2"},{max:400,level:"中等",color:"#4CAF50"},{max:600,level:"强",color:"#FFEB3B"},{max:800,level:"很强",color:"#FF9800"},{max:1e3,level:"极强",color:"#F44336"},{max:1/0,level:"危险",color:"#9C27B0"}];function N(l){const e=B.find(s=>l<=s.max);return e?e.color:"#000000"}const M=ae(()=>{var l,e,s,o,r,g,m,f,I,S,D;return[{key:"envT",title:"温度",value:((l=t.data)==null?void 0:l.envT)||0,color:n(((e=t.data)==null?void 0:e.envT)||0),unit:"℃",icon:"carbon:temperature-celsius"},{key:"envH",title:"湿度",value:((s=t.data)==null?void 0:s.envH)||0,color:$(((o=t.data)==null?void 0:o.envH)||0),unit:"%",icon:"lets-icons:humidity"},{key:"qy",title:"气压",value:((r=t.data)==null?void 0:r.qy)||0,color:b(((g=t.data)==null?void 0:g.qy)||0),unit:"hPa",icon:"mdi:car-brake-low-pressure"},{key:"windS",title:"风速",value:((m=t.data)==null?void 0:m.windS)||0,color:T(((f=t.data)==null?void 0:f.windS)||0),unit:"m/s",icon:"hugeicons:slow-winds"},{key:"windD",title:"风向",value:((I=t.data)==null?void 0:I.windD)||0,color:"#00FFFF",unit:"°",icon:"mdi:windsock"},{key:"zfsdCount",title:"总辐射",value:((S=t.data)==null?void 0:S.zfsd)||0,color:N(((D=t.data)==null?void 0:D.zfsd)||0),unit:"W/㎡",icon:"material-symbols:clear-day-rounded"}]});return(l,e)=>{const s=Se;return x(),F("div",ut,[(x(!0),F(oe,null,ve(M.value,(o,r)=>(x(),F("div",{class:q(["item",{brBom:[0,1,2].includes(r),brLeft:[0,1,3,4].includes(r)}]),key:o.key},[L(s,{icon:o.icon,class:"iconx",style:te({color:o.color})},null,8,["icon","style"]),a("div",mt,[a("div",ft,v(o.title),1),a("div",vt,v(o.value)+v(o.unit),1)])],2))),128))])}}}),pt=O(_t,[["__scopeId","data-v-7350fa7e"]]),A=d=>(J("data-v-ca7927ed"),d=d(),Y(),d),ht={class:"dashboard"},bt={class:"stats-table"},wt=A(()=>a("td",{class:"label"},"CPU使用率:",-1)),yt=A(()=>a("td",{class:"label"},"内存使用率:",-1)),gt=A(()=>a("td",{class:"label"},"运行状态:",-1)),xt={class:"value",colspan:"2"},St=A(()=>a("td",{class:"label"},"是否限电:",-1)),Ct={class:"value",colspan:"2"},$t=A(()=>a("td",{class:"label"},"数据接入:",-1)),Ft={class:"value",colspan:"2"},Dt=A(()=>a("td",{class:"label"},"数据上报:",-1)),kt={class:"value",colspan:"2"},Tt=A(()=>a("td",{class:"label"},"有功功率(MW):",-1)),It={class:"value",colspan:"2"},Lt=A(()=>a("td",{class:"label"},"无功功率(MVar):",-1)),At={class:"value",colspan:"2"},Nt=A(()=>a("td",{class:"label"},"更新时间:",-1)),Bt={class:"value",colspan:"2"},Mt=A(()=>a("td",{class:"label"},"功率因数:",-1)),Et={class:"value"},Ot=A(()=>a("td",{class:"label"},"日发电量(MWh):",-1)),Wt={class:"value",colspan:"2"},Ht=A(()=>a("td",{class:"label"},"总发电量(MWh):",-1)),Pt={class:"value",colspan:"2"},Rt=H({__name:"left-top",props:{data:{type:Object,default:()=>({})}},setup(d){const t=d;return(i,n)=>(x(),F("div",ht,[a("table",bt,[a("tbody",null,[a("tr",null,[wt,a("td",{class:q(["value",{"status-success":t.data.cpu&&t.data.cpu<50,"status-warning":t.data.cpu&&t.data.cpu>=50&&t.data.cpu<80,"status-error":t.data.cpu&&t.data.cpu>=80}]),colspan:"2"},v(t.data.cpu?t.data.cpu+"%":""),3),yt,a("td",{class:q(["value",{"status-success":t.data.mem&&t.data.mem<50,"status-warning":t.data.mem&&t.data.mem>=50&&t.data.mem<80,"status-error":t.data.mem&&t.data.mem>=80}]),colspan:"2"},v(t.data.mem?t.data.mem+"%":""),3)]),a("tr",null,[gt,a("td",xt,v(t.data.stationP&&t.data.stationP>0&&t.data.stationControlled==0?"并网运行":t.data.stationP&&t.data.stationP>0&&t.data.stationControlled==1?"降额运行":t.data.stationP==0?"待机":""),1),St,a("td",Ct,v(t.data.stationControlled==1?"是":"否"),1)]),a("tr",null,[$t,a("td",Ft,v(t.data.col=="0"?"🟢":t.data.col=="1"?"🔴":"⚪"),1),Dt,a("td",kt,v(t.data.trs=="0"?"🟢":t.data.trs=="1"?"🔴":"⚪"),1)]),a("tr",null,[Tt,a("td",It,v(t.data.stationP??"-"),1),Lt,a("td",At,v(t.data.stationQ??"-"),1)]),a("tr",null,[Nt,a("td",Bt,v(t.data.dbtime||"-"),1),Mt,a("td",Et,v(t.data.stationCOS??"-"),1)]),a("tr",null,[Ot,a("td",Wt,v(t.data.stationDayE??"-"),1),Ht,a("td",Pt,v(t.data.stationTotalE??"-"),1)])])])]))}}),Vt=O(Rt,[["__scopeId","data-v-ca7927ed"]]),zt=d=>(J("data-v-9190f62b"),d=d(),Y(),d),jt={class:"inner_right"},Gt=zt(()=>a("div",{class:"dibu"},null,-1)),qt={class:"info"},Ut={class:"alarmName"},Jt={class:"info_bottom"},Yt={class:"alarmLevel"},Qt={class:"time"},Kt=5e3,Xt=3,Zt={__name:"left-center",props:{data:{type:Array,default:()=>[]}},setup(d){const t=d,i=[{label:"一般",color:"#0091FF",value:0},{label:"低级",color:"#ffd600",value:1},{label:"中级",color:"#ffab00",value:2},{label:"高级",color:"#ff6d00",value:3},{label:"严重",color:"#dd2c00",value:4}],n=e=>i.find(s=>s.value===e)||{},h=y(!0),b=ae(()=>h.value?[...t.data,...t.data]:t.data),_=y(!1),$=y(),k=y();let T=null;const B=()=>{_.value=!0,h.value=!1,clearInterval(T)},N=()=>{_.value=!1,h.value=!0,ce(()=>{M()})},M=()=>{clearInterval(T),T=setInterval(()=>{var m;if(_.value||!h.value)return;const e=$.value,s=k.value;if(!e||!s)return;const o=((m=s.children[0])==null?void 0:m.offsetHeight)||0,r=s.scrollHeight/2,g=e.scrollTop+o*Xt;g>=r?l(g,()=>{e.scrollTop=g-r}):l(g)},Kt)},l=(e,s)=>{const o=$.value,r=800,g=o.scrollTop,m=e-g,f=performance.now(),I=D=>D<.5?2*D*D:-1+(4-2*D)*D,S=D=>{const E=D-f,z=Math.min(E/r,1);o.scrollTop=g+m*I(z),z<1?requestAnimationFrame(S):s&&s()};requestAnimationFrame(S)};return se(()=>{ce(()=>{M()})}),Ce(()=>{clearInterval(T)}),(e,s)=>(x(),F("div",{class:q(["left_boottom scroll-view",{"show-scrollbar":_.value}]),ref_key:"scrollViewRef",ref:$,onMouseenter:B,onMouseleave:N},[a("div",{ref_key:"listRef",ref:k,class:"left_boottom_list"},[(x(!0),F(oe,null,ve(b.value,(o,r)=>(x(),F("div",{class:"left_boottom_item",key:r},[a("div",jt,[Gt,a("div",qt,[a("div",Ut,"告警名称："+v(o.aname),1),a("div",Jt,[a("div",Yt,[ee(" 告警等级： "),a("span",{style:te({color:n(o.alevel).color,border:"1px solid "+n(o.alevel).color,padding:"0 5px",borderRadius:"5px"})},v(n(o.alevel).label),5)]),a("div",Qt,"时间："+v(o.dbtime),1)])])])]))),128))],512)],34))}},ea=O(Zt,[["__scopeId","data-v-9190f62b"]]),ta=H({name:"LineChart",__name:"power",props:{data:{required:!0},dataModifiers:{}},emits:["update:data"],setup(d){const t=(e,s)=>{const o=e.match(/\d+/g);return o?`rgba(${o[0]}, ${o[1]}, ${o[2]}, ${s})`:""};function i(e,s){return e===0||typeof e=="number"&&!isNaN(e)?e+s:""}const n=["rgb(233, 4, 69)","rgb(0, 150, 136)","rgb(59, 66, 146)","rgb(255, 99, 71)"],h=["实际功率","预测功率","实际辐射","预测辐射"],b=$e(d,"data"),_=y(null),$=Date.now(),k=new Date($).setHours(23,59,59,999),{domRef:T,updateOptions:B,updateOptionsAsync:N}=pe(()=>({tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}},formatter:function(e){var m;const o=(Array.isArray(e)?e:[e]).filter(f=>{var I;return((I=f==null?void 0:f.value)==null?void 0:I[1])!=null&&(f==null?void 0:f.seriesName)});if(o.length===0)return"";let g=`${((m=o[0])==null?void 0:m.axisValueLabel)||""}<br/>`;return o.forEach((f,I)=>{const S=I<2?" MW":" W/m²";g+=`
          <span class="round" style="background-color: ${n[h.indexOf(f.seriesName)]||"#ccc"}"></span>
          ${f.seriesName}: ${i(f.value[1],S)}<br/>
        `}),g},backgroundColor:"rgba(0,0,0,.6)",borderColor:"#384a86",borderWidth:2,textStyle:{color:"#FFF"}},legend:{data:["实际功率","预测功率","实际辐射","预测辐射"],textStyle:{color:"#d3d6dd"}},grid:{left:"3%",right:"3%",bottom:"0%",containLabel:!0},xAxis:{type:"time",axisLabel:{formatter:"{HH}:{mm}",color:"#d3d6dd"},max:k+60*1e3,data:[]},yAxis:[{name:"功率MW",type:"value",axisLabel:{formatter:"{value} MW",color:"#d3d6dd"},splitLine:{show:!0,lineStyle:{color:"rgba(31,99,163,.2)",width:1}}},{name:"辐射W/m²",type:"value",axisLabel:{formatter:"{value} W/m²",color:"#d3d6dd"},nameTextStyle:{color:"#d3d6dd"},alignTicks:!0,splitLine:{show:!0,lineStyle:{color:"rgba(31,99,163,.2)",width:1}}}],series:[{color:n[0],name:"实际功率",type:"line",emphasis:{focus:"series"},yAxisIndex:0,lineStyle:{width:1},showSymbol:!1,areaStyle:{color:new V(0,0,0,1,[{offset:0,color:t(n[0],.3)},{offset:1,color:t(n[0],0)}],!1),shadowColor:t(n[0],.9),shadowBlur:20},data:[],connectNulls:!0},{color:n[1],name:"预测功率",type:"line",yAxisIndex:0,emphasis:{focus:"series"},lineStyle:{width:1},showSymbol:!1,areaStyle:{color:new V(0,0,0,1,[{offset:0,color:t(n[1],.3)},{offset:1,color:t(n[1],0)}],!1),shadowColor:t(n[1],.9),shadowBlur:20},data:[],connectNulls:!0},{color:n[2],name:"实际辐射",type:"line",showSymbol:!1,yAxisIndex:1,emphasis:{focus:"series"},lineStyle:{width:1},areaStyle:{color:new V(0,0,0,1,[{offset:0,color:t(n[2],.3)},{offset:1,color:t(n[2],0)}],!1),shadowColor:t(n[2],.7),shadowBlur:20},data:[],connectNulls:!0},{color:n[3],name:"预测辐射",type:"line",yAxisIndex:1,showSymbol:!1,emphasis:{focus:"series"},lineStyle:{width:1},areaStyle:{color:new V(0,0,0,1,[{offset:0,color:t(n[3],.3)},{offset:1,color:t(n[3],0)}],!1),shadowColor:t(n[3],.7),shadowBlur:20},data:[],connectNulls:!0}]}));async function M(){await new Promise(e=>{setTimeout(e,1e3)}),B(e=>{if(b.value){const s=b.value.map(o=>({dbtime:o.dbtime,prePower:o.prePower,power:o.power,zfsd:o.zfsd,ssrd:o.ssrd}));e.xAxis.data=s.map(o=>o.dbtime),e.series[0].data=s.map(o=>[o.dbtime,o.power]),e.series[1].data=s.map(o=>[o.dbtime,o.prePower]),e.series[2].data=s.map(o=>[o.dbtime,o.zfsd]),e.series[3].data=s.map(o=>[o.dbtime,o.ssrd]),console.log(e.series,"seriesseriesseries")}return e})}_e(()=>b.value,e=>{N(s=>{if(b.value){const o=b.value.map(r=>({dbtime:r.dbtime,prePower:r.prePower,power:r.power,zfsd:r.zfsd,ssrd:r.ssrd}));s.xAxis.data=o.map(r=>r.dbtime),s.series[0].data=o.map(r=>[r.dbtime,r.power]),s.series[1].data=o.map(r=>[r.dbtime,r.prePower]),s.series[2].data=o.map(r=>[r.dbtime,r.zfsd]),s.series[3].data=o.map(r=>[r.dbtime,r.ssrd])}return s})});async function l(){await M()}return se(()=>{T.value=_.value}),l(),(e,s)=>(x(),F("div",{ref_key:"chartDom",ref:_,class:"chart"},null,512))}}),aa=O(ta,[["__scopeId","data-v-43de4541"]]),oa=H({name:"LineChart",__name:"weather-chart",props:{data:{type:Array,default:[]}},setup(d){function t(l,e){return l===0||typeof l=="number"&&!isNaN(l)?l+e:""}const i=d,n=["#27ae60","#c0392b","#ffa000"],h=["环境温度","预测温度","组件温度"],b=Date.now(),_=new Date(b).setHours(23,59,59,999),{domRef:$,updateOptions:k,showLoading:T,updateOptionsAsync:B}=pe(()=>({tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}},formatter:function(l){var g;const s=(Array.isArray(l)?l:[l]).filter(m=>{var f;return((f=m==null?void 0:m.value)==null?void 0:f[1])!=null&&(m==null?void 0:m.seriesName)});if(s.length===0)return"";let r=`${((g=s[0])==null?void 0:g.axisValueLabel)||""}<br/>`;return s.forEach((m,f)=>{r+=`
          <span class="round" style="background-color: ${n[h.indexOf(m.seriesName)]||"#ccc"}"></span>
          ${m.seriesName}: ${t(m.value[1],"°C")}<br/>
        `}),r},backgroundColor:"rgba(0,0,0,.6)",borderColor:"#384a86",borderWidth:2,textStyle:{color:"#FFF"}},legend:{data:["环境温度","预测温度","组件温度"],textStyle:{color:"#d3d6dd"}},grid:{left:"3%",right:"3%",bottom:"0%",containLabel:!0},xAxis:{type:"time",axisLabel:{formatter:"{HH}:{mm}",color:"#d3d6dd"},max:_+60*1e3,data:[]},yAxis:{name:"温度(°C)",type:"value",axisLabel:{formatter:"{value} °C",color:"#d3d6dd"},splitLine:{show:!0,lineStyle:{color:"rgba(31,99,163,.2)",width:1}},nameTextStyle:{color:"#d3d6dd"}},series:[{color:"#27ae60",name:"环境温度",type:"line",lineStyle:{width:1},showSymbol:!1,areaStyle:{color:new V(0,0,0,1,[{offset:0,color:"rgba(39, 174, 96,0.4)"},{offset:1,color:"rgba(39, 174, 96,0)"}],!1),shadowColor:"rgba(39, 174, 96,0.9)",shadowBlur:20},emphasis:{focus:"series"},data:[],connectNulls:!0},{color:"#c0392b",name:"预测温度",type:"line",lineStyle:{width:1},showSymbol:!1,areaStyle:{color:new V(0,0,0,1,[{offset:0,color:"rgba(192, 57, 43,0.3)"},{offset:1,color:"rgba(192, 57, 43,0)"}],!1),shadowColor:"rgba(192, 57, 43,0.9)",shadowBlur:20},emphasis:{focus:"series"},data:[],connectNulls:!0},{color:"#ffa000",name:"组件温度",type:"line",lineStyle:{width:1},showSymbol:!1,areaStyle:{color:new V(0,0,0,1,[{offset:0,color:"rgba(255, 160, 0,0.3)"},{offset:1,color:"rgba(255, 160, 0,0)"}],!1),shadowColor:"rgba(255, 160, 0,0.9)",shadowBlur:20},emphasis:{focus:"series"},data:[],connectNulls:!0}]}));async function N(){await new Promise(l=>{setTimeout(l,1e3)}),k(l=>(i.data&&(l.xAxis.data=i.data.map(e=>e.dbtime),l.series[0].data=i.data.map(e=>[e.dbtime,e.envT]),l.series[1].data=i.data.map(e=>[e.dbtime,e.tt2]),l.series[2].data=i.data.map(e=>[e.dbtime,e.moduleT])),l))}async function M(){N()}return _e(()=>i.data,()=>{B(l=>(i.data&&(l.xAxis.data=i.data.map(e=>e.dbtime),l.series[0].data=i.data.map(e=>[e.dbtime,e.envT]),l.series[1].data=i.data.map(e=>[e.dbtime,e.tt2]),l.series[2].data=i.data.map(e=>[e.dbtime,e.moduleT])),l))}),M(),(l,e)=>(x(),F("div",{ref_key:"domRef",ref:$,class:"chart"},null,512))}}),sa=O(oa,[["__scopeId","data-v-7d36a49f"]]),la="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='12'%20height='12'%20viewBox='0%200%2012%2012'%3e%3cpath%20fill='%23fff'%20d='M2.5%2012c-.13%200-.25-.05-.35-.14l-2-1.93A.55.55%200%200%201%200%209.57V2.43c0-.13.06-.26.15-.36l2-1.93c.15-.14.36-.18.55-.1c.18.08.3.26.3.46v11c0%20.2-.12.38-.3.46c-.07.03-.13.04-.2.04m7-3.5c-.06%200-.13-.01-.19-.04A.5.5%200%200%201%209%208l-.01-4.06c0-.2.12-.39.31-.46c.19-.08.4-.03.54.11l1.67%201.7c.38.39.38%201.02-.01%201.41L9.85%208.35a.47.47%200%200%201-.35.15'%20/%3e%3cpath%20fill='none'%20stroke='%23fff'%20stroke-linecap='round'%20d='M2.5%202.5H6c.28%200%20.5.22.5.5v1m-4%205.5H6c.28%200%20.5-.22.5-.5V8M11%206H5'%20stroke-width='1'%20/%3e%3c/svg%3e",na={class:"content_wrap"},ra={class:"d-flex jc-center title_wrap"},ca=Ie('<div class="zuojuxing" data-v-5abf07ae></div><div class="youjuxing" data-v-5abf07ae></div><div class="guang" data-v-5abf07ae></div><div class="d-flex jc-center" data-v-5abf07ae><div class="title" data-v-5abf07ae><span class="title-text" data-v-5abf07ae>光功率预测系统可视化</span></div></div>',4),da={class:"top_Info"},ia={class:"left"},ua={class:"right"},ma={class:"setting_icon"},fa=["src"],va={class:"index-box"},_a={class:"content_left"},pa={class:"content_right"},ha=H({name:"bigscreen",__name:"index",setup(d){const t=Fe(),i=De(),n=ke({dateDay:"",dateYear:"",dateWeek:"",timing:null}),h=["周日","周一","周二","周三","周四","周五","周六"];(()=>{n.timing=setInterval(()=>{n.dateDay=de().format("YYYY-MM-DD hh : mm : ss"),n.dateWeek=h[de().day()]},1e3)})();const _=y({}),$=async()=>{const{data:c,error:p}=await Le();p||Object.assign(_.value,c)},k=async()=>{const{data:c,error:p}=await Ae();p||(_.value.cpu=c.cpu,_.value.mem=c.mem)},T=y(),B=async()=>{const{data:c,error:p}=await Ne({_t:new Date().getTime()});T.value=c==null?void 0:c.pname},N=y(),M=async()=>{var u;const{data:c,error:p}=await ze();p||(N.value=c,N.value.length!=0&&(l.value=(u=c[0])==null?void 0:u.id,s()))},l=y(),e=y(),s=async()=>{const{data:c,error:p}=await je({devId:l.value});p||(e.value=c)},o=c=>{l.value=c,s(),z()},r=Date.now(),g=new Date(r).setHours(0,0,0,0),m=new Date(r).setHours(23,59,59,999),f=y(),I=async()=>{const{data:c,error:p}=await Ge({startTime:G(1,g),endTime:G(1,m),page:1,limit:100});p||(f.value=JSON.parse(JSON.stringify(c)).list)},S=y(),D=async()=>{const{data:c,error:p}=await Be({date:G(0,Date.now())});p||(S.value=c,S.value.forEach(u=>(f.value.forEach(w=>{u.dbtime==w.dbtime&&(u.ssrd=w.ssrd)}),u)),E.value.forEach(u=>{const w=S.value.find(P=>P.dbtime===u.dbtime);w?Object.assign(w,u):S.value.push(u)}),S.value=S.value.sort((u,w)=>new Date(u.dbtime).getTime()-new Date(w.dbtime).getTime()))},E=y(),z=async()=>{if(!l.value)return;const{data:c,error:p}=await qe({id:l.value,startTime:G(0,Date.now())+" 00:00:00",endTime:G(1,Date.now())});console.log("气象实际数据",c),E.value=c,f.value.forEach(u=>{const w=E.value.find(P=>P.dbtime===u.dbtime);w?Object.assign(w,u):E.value.push(u)}),E.value=E.value.sort((u,w)=>new Date(u.dbtime).getTime()-new Date(w.dbtime).getTime())},le=y([]),ne=async()=>{const{data:c,error:p}=await Me({page:1,limit:20});p||(le.value=JSON.parse(JSON.stringify(c)).list)},Q=y(null),be=()=>{var re;(re=Q.value)==null||re.close();const c=new Date().getTime(),p=Ee(),u=Oe(`${p}${c}getchlstatus`),w=ie(u),P=ie("getchlstatus"),W=new We(He+`/ChannelStatusWebsocket/${P}/${w}/${c}/${p}?token=${Pe()}`,{maxReconnectAttempts:3,heartbeatInterval:1e3*30});Q.value=W,W.connect(),W.onclose(()=>{}),W.onerror(()=>{}),W.onopen(()=>{}),W.onmessage(Z=>{if(console.log(Z,"通道状态websocket接受数据"),!we(Z.data))return;const R=JSON.parse(Z.data).dataStatus;R&&(_.value.col=R.col+""=="0"||R.col+""=="1"?R.col+"":"",_.value.trs=R.trs+""=="0"||R.trs+""=="1"?R.trs+"":"")})},we=c=>{try{return JSON.parse(c),!0}catch{return!1}},ye=()=>{var c;(c=window.$dialog)==null||c.info({title:"退出登录",content:"确定要退出登录吗?",positiveText:"确定",negativeText:"取消",onPositiveClick:async()=>{const{data:p,error:u}=await Re();u||(t.clearInfo(),window.location.reload())}})},K=y(null),X=y(null),U=y(!1);return se(async()=>{B(),i.themeScheme!="dark"&&i.toggleThemeScheme(),be();try{U.value=!0,await M(),await $(),await k(),await I(),await z(),await D(),await ne(),U.value=!1}catch{U.value=!1}K.value=setInterval(async()=>{await $(),await I(),await z(),await D(),await ne(),B()},1e3*60*1),X.value=setInterval(async()=>{await s(),await k()},1e3*5)}),Te(()=>{var c;K.value&&clearInterval(K.value),X.value&&clearInterval(X.value),(c=Q.value)==null||c.close()}),(c,p)=>{const u=Ve,w=it,P=Ye;return x(),F(oe,null,[a("div",na,[a("div",ra,[ca,a("div",da,[a("div",ia,[ee(v(T.value)+" ",1),L(u,{filterable:"",placeholder:"请选择气象站",value:l.value,"onUpdate:value":p[0]||(p[0]=W=>l.value=W),options:N.value,"label-field":"sname",size:"tiny","value-field":"id",style:{width:"140px","margin-left":"10px"},onUpdateValue:o},null,8,["value","options"])]),a("div",ua,[ee(v(n.dateYear)+" "+v(n.dateWeek)+" "+v(n.dateDay)+" ",1),a("div",ma,[a("img",{src:C(la),alt:"",onClick:ye},null,8,fa)])])])]),a("div",va,[a("div",_a,[L(w,{class:"content_left-top",title:"运行状态"},{default:j(()=>[L(Vt,{data:_.value},null,8,["data"])]),_:1}),L(w,{class:"content_left-center",title:"最近告警"},{default:j(()=>[L(ea,{data:le.value},null,8,["data"])]),_:1}),L(w,{class:"content_left-bottom",title:"气象信息"},{default:j(()=>[L(pt,{data:e.value},null,8,["data"])]),_:1})]),a("div",pa,[L(w,{class:"content_right-top",title:"今日功率"},{default:j(()=>[L(aa,{data:S.value},null,8,["data"])]),_:1}),L(w,{class:"content_right-bottom",title:"今日气象"},{default:j(()=>[L(sa,{data:E.value},null,8,["data"])]),_:1})])])]),U.value?(x(),me(P,{key:0})):fe("",!0)],64)}}}),ga=O(ha,[["__scopeId","data-v-5abf07ae"]]);export{ga as default};

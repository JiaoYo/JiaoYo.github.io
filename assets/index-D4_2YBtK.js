import{_ as Y}from"./table-column-setting.vue_vue_type_script_setup_true_lang-BtWmmJ2O.js";import{d as $,p as R,q as G,r as Z,aw as ee,s as Q,ab as O,o as B,c as E,w as a,g as e,h as b,t as T,i as o,$ as V,eC as A,b1 as q,eD as ae,ak as K,L as J,Q as L,B as j,P as F,aJ as te,k as le,a6 as H,e as oe,aN as M,f as U,eE as ne,eF as se,A as re,z as ie,N as me,aT as de,aO as ue}from"./index-7yfIBuqI.js";import{u as ce,a as pe}from"./table-t7-GHjoG.js";import{_ as _e}from"./lodash-DQ4YFNYk.js";import{_ as W}from"./FormItemGridItem-ijIAr9Du.js";import{_ as X}from"./Grid-Dc0y3lqU.js";import{_ as fe}from"./round-search--SxcGQWM.js";import{_ as ve}from"./round-refresh-DYDiNFsb.js";import{_ as ge}from"./DatePicker-CfzGw-VJ.js";import{M as be}from"./shield-question-outline-rounded-Bt6j_Z0A.js";const he=$({__name:"modelParam_model",props:R({rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:R(["submitted"],["update:visible"]),setup(c,{emit:k}){const i=G(c,"visible"),l=k,p=c,s=Z(v());function v(){return{modelIdx:"",modelParamIdx:void 0,modelParamVal:void 0,modelParamName:"",dbtime:ee(0,new Date)}}function _(){Object.assign(s,p.rowData)}const{formRef:N,validate:g,restoreValidation:S}=Q();O(()=>p.rowData,()=>{_()}),O(i,()=>{i.value&&(_(),S())});const h=()=>{i.value=!1},C=async()=>{var f;await g();const{data:z,error:n}=await ae([{modelParamVal:s.modelParamVal,id:s.id}]);n||((f=window.$message)==null||f.success("修改成功"),h(),l("submitted"))},d=_e.debounce(C,1e3,{leading:!0,trailing:!1}),u={modelIdx:{type:"number",required:!0,message:"不能为空",trigger:["input","blur"]},modelParamIdx:{type:"number",required:!0,message:"不能为空",trigger:["input","blur"]},modelParamVal:{type:"number",required:!0,message:"不能为空",trigger:["input","blur"]}};return(z,n)=>{const f=K,m=W,r=J,w=X,y=L,x=j,P=F,D=te;return B(),E(D,{show:i.value,"onUpdate:show":n[4]||(n[4]=t=>i.value=t),title:"修改模型参数",preset:"card",class:"w-600px"},{footer:a(()=>[e(P,{size:16,justify:"center"},{default:a(()=>[e(x,{onClick:h,class:"w-100px"},{default:a(()=>[b(T(o(V)("common.cancel")),1)]),_:1}),e(x,{type:"primary",class:"w-100px",onClick:o(d)},{default:a(()=>[b(T(o(V)("common.confirm")),1)]),_:1},8,["onClick"])]),_:1})]),default:a(()=>[e(y,{ref_key:"formRef",ref:N,model:s,rules:u,"label-placement":"left","label-width":140,"require-mark-placement":"left"},{default:a(()=>[e(w,{responsive:"screen","item-responsive":""},{default:a(()=>[e(m,{span:"24 m:24",label:"模型索引",path:"modelIdx"},{default:a(()=>[e(f,{disabled:"",value:s.modelIdx,"onUpdate:value":n[0]||(n[0]=t=>s.modelIdx=t),options:o(A),filterable:"",placeholder:"请选择模型索引",clearable:"",style:{width:"100%"}},null,8,["value","options"])]),_:1}),e(m,{span:"24 m:24",label:"模型参数索引",path:"modelParamIdx"},{default:a(()=>[e(o(q),{disabled:"",clearable:"",value:s.modelParamIdx,"onUpdate:value":n[1]||(n[1]=t=>s.modelParamIdx=t),placeholder:"请输入",style:{width:"100%"}},null,8,["value"])]),_:1}),e(m,{span:"24 m:24",label:"模型参数值",path:"modelParamVal"},{default:a(()=>[e(o(q),{clearable:"",value:s.modelParamVal,"onUpdate:value":n[2]||(n[2]=t=>s.modelParamVal=t),min:.7,max:1.2,placeholder:"请输入",style:{width:"100%"}},null,8,["value"])]),_:1}),e(m,{span:"24 m:24",label:"备注",path:"manu"},{default:a(()=>[e(r,{disabled:"",clearable:"",value:s.modelParamName,"onUpdate:value":n[3]||(n[3]=t=>s.modelParamName=t),placeholder:"请输入",maxlength:"64",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])}}}),we=$({name:"SearchQuery",__name:"searchQuery",props:{model:{required:!0},modelModifiers:{}},emits:R(["reset","search"],["update:model"]),setup(c,{emit:k}){const i=k,l=G(c,"model"),{formRef:p,restoreValidation:s}=Q(),v=le(null),_=d=>{d?(l.value.startTime=d[0],l.value.endTime=d[1]):(l.value.startTime=void 0,l.value.endTime=void 0),i("search")};async function N(){await s(),l.value.startTime=null,l.value.endTime=null,v.value=null,l.value.fuzzy=null,i("reset")}const g=()=>{l.value.fuzzy="",i("search")},S={近一天:[Date.now()-864e5*1,Date.now()],近三天:[Date.now()-864e5*3,Date.now()],近七天:[Date.now()-864e5*7,Date.now()]};async function h(){i("search"),console.log(l.value)}const C=d=>{l.value.model_idx=d,i("search")};return(d,u)=>{const z=J,n=W,f=K,m=ge,r=ve,w=j,y=fe,x=F,P=X,D=L,t=H;return B(),E(t,{bordered:!1,size:"small"},{default:a(()=>[e(D,{ref_key:"formRef",ref:p,model:l.value,"label-placement":"left","show-feedback":!1},{default:a(()=>[e(P,{responsive:"screen","item-responsive":"","x-gap":12,"y-gap":12},{default:a(()=>[e(n,{span:"24 s:8 m:6 l:4",label:""},{default:a(()=>[e(z,{value:l.value.fuzzy,"onUpdate:value":u[0]||(u[0]=I=>l.value.fuzzy=I),clearable:"",placeholder:"请输入",onClear:g},null,8,["value"])]),_:1}),e(n,{span:"24 s:12 m:8 l:6",label:"模型索引"},{default:a(()=>[e(f,{value:l.value.model_idx,"onUpdate:value":[u[1]||(u[1]=I=>l.value.model_idx=I),C],options:o(A),filterable:"",placeholder:"请选择模型索引",clearable:"",style:{width:"100%"}},null,8,["value","options"])]),_:1}),e(n,{span:"24 s:16 m:12 l:8",label:"起止时间"},{default:a(()=>[e(m,{value:v.value,"onUpdate:value":u[2]||(u[2]=I=>v.value=I),type:"datetimerange","value-format":"yyyy-MM-dd hh:mm:ss",style:{width:"100%"},"onUpdate:formattedValue":_,clearable:"",shortcuts:S},null,8,["value"])]),_:1}),e(n,{span:"24 s:12 m:8 l:6",label:""},{default:a(()=>[e(x,{class:"w-full"},{default:a(()=>[e(w,{onClick:N},{icon:a(()=>[e(r,{class:"text-icon"})]),default:a(()=>[b(" "+T(d.$t("common.reset")),1)]),_:1}),e(w,{type:"primary",ghost:"",onClick:h},{icon:a(()=>[e(y,{class:"text-icon"})]),default:a(()=>[b(" "+T(d.$t("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),ye={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},xe=U("span",{style:{width:"200px"}},[U("p",null,"提示："),b(" 1. 模型参数值影响最终预测结果，举例如果预测结果偏大，可以通过改小参数值来进行调整；"),U("br"),b(" 2. 参数值修改后立即生效，且仅当天生效，次日会自动根据预测结果动态调整。 ")],-1);function ke(c){return typeof c=="function"||Object.prototype.toString.call(c)==="[object Object]"&&!ue(c)}const Ue=$({name:"stationmanagement_modelparameter",__name:"index",setup(c){const{columns:k,columnChecks:i,data:l,getData:p,loading:s,mobilePagination:v,searchParams:_,resetSearchParams:N}=ce({apiFn:ne,apiParams:{page:1,pageSize:20,limit:20,model_idx:void 0,fuzzy:null,startTime:null,endTime:null},immediate:!0,showTotal:!0,columns:()=>[{key:"modelIdx",title:"模型索引",align:"center",width:140,render:m=>e("span",null,[se[m.modelIdx]])},{key:"modelParamIdx",title:"模型参数索引",align:"center",width:100},{key:"modelParamVal",title:"模型参数值",align:"center",width:100},{key:"modelParamName",title:"备注",align:"center",width:100},{key:"dbtime",title:"更新时间",align:"center",width:180},{key:"operate",title:V("common.operate"),align:"center",width:200,fixed:"right",render:m=>{let r;return e("div",{class:"flex-center gap-8px"},[re(e(j,{type:"primary",ghost:!0,size:"small",onClick:()=>f(m.id)},ke(r=V("common.edit"))?r:{default:()=>[r]}),[[ie("no-auth"),"model.param.update"]])])}}]}),{drawerVisible:g,operateType:S,editingData:h,handleAdd:C,handleEdit:d,checkedRowKeys:u,onBatchDeleted:z,onDeleted:n}=pe(l,p),f=m=>{d(m)};return(m,r)=>{const w=me,y=F,x=Y,P=de,D=H;return B(),oe("div",ye,[e(we,{model:o(_),"onUpdate:model":r[0]||(r[0]=t=>M(_)?_.value=t:null),onReset:o(N),onSearch:o(p)},null,8,["model","onReset","onSearch"]),e(D,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:a(()=>[e(y,{align:"center",wrap:"",justify:"start",class:"lt-sm:w-200px"},{default:a(()=>[b(" 模型参数设置 "),e(w,{trigger:"hover",placement:"top-start"},{trigger:a(()=>[e(o(be),{class:"text-xl cursor-pointer c-#ff6f00"})]),default:a(()=>[xe]),_:1})]),_:1})]),"header-extra":a(()=>[e(y,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:a(()=>[e(x,{columns:o(i),"onUpdate:columns":r[1]||(r[1]=t=>M(i)?i.value=t:null)},null,8,["columns"])]),_:1})]),default:a(()=>[e(P,{"checked-row-keys":o(u),"onUpdate:checkedRowKeys":r[2]||(r[2]=t=>M(u)?u.value=t:null),columns:o(k),data:o(l),size:"small",loading:o(s),remote:"","row-key":t=>t.id,pagination:o(v),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","loading","row-key","pagination"]),e(he,{visible:o(g),"onUpdate:visible":r[3]||(r[3]=t=>M(g)?g.value=t:null),onSubmitted:o(p),"row-data":o(h)},null,8,["visible","onSubmitted","row-data"])]),_:1})])}}});export{Ue as default};

import{_ as K}from"./round-search-GCqtZmH9.js";import{_ as P}from"./round-refresh-CzNrhDxl.js";import{d as X,Z,r as g,$ as u,g as e,L as _,K as D,B as m,j as T,J as H,o as Q,e as Y,w as n,i as r,h as v,t as b,ad as ee,X as te,A as ne,E as ae,D as oe,a9 as se,C as le,aa as ie,ab as re}from"./index-DE8JjPFO.js";import{c as pe,f as ce,a as ue,d as de,e as me}from"./common-CPsxPdSt.js";import{_ as _e}from"./Popconfirm-tGD_AQ1j.js";import{_ as fe}from"./FormItemGridItem-C8_xdsl_.js";import{_ as ge}from"./Grid-C3IXGS4o.js";import{_ as ve}from"./DataTable-Dhl1KVmG.js";import"./Forward-zVbnYjOG.js";const ye={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function E(y){return typeof y=="function"||Object.prototype.toString.call(y)==="[object Object]"&&!ee(y)}const Ne=X({name:"eventalarm_eventtype",__name:"index",setup(y){const $=Z(),p=g({fuzzy:"",pid:null}),S=g([{key:"pid",title:"事件类别",align:"center",minWidth:160,ellipsis:{tooltip:!0},render:a=>{var o;return(o=c.eventsCategoryDataList.find(s=>s.id===a.pid))==null?void 0:o.pname}},{key:"pname",title:"事件类型",align:"center",minWidth:160,ellipsis:{tooltip:!0}},{key:"operate",title:u("common.operate"),align:"center",width:160,render:a=>{let t;return a.sysparam!=0?e("div",{class:"flex-center gap-8px"},[_(e(m,{type:"primary",ghost:!0,size:"small",onClick:()=>O(a)},E(t=u("common.edit"))?t:{default:()=>[t]}),[[D("no-auth"),"sys.asset.type.update"]]),e(_e,{onPositiveClick:()=>I(a.id)},{default:()=>u("common.confirmDelete"),trigger:()=>{let o;return _(e(m,{type:"error",ghost:!0,size:"small"},E(o=u("common.delete"))?o:{default:()=>[o]}),[[D("no-auth"),"sys.asset.type.delete"]])}})]):null}}]),c=g({eventsCategoryDataList:[],eventsTypeDataList:[]}),A=T(!1),d=T(!1);async function U(){const{data:a,error:t}=await ce();t||(c.eventsCategoryDataList=a)}async function f(){const{data:a,error:t}=await ue();t||(c.eventsTypeDataList=a)}H(()=>{U(),f()});const j=()=>{d.value=!0},l=g({pid:null,pname:null,id:null}),B=g({pid:{type:"number",required:!0,message:"请选择事件类别",trigger:["blur","change"]},pname:{type:"string",required:!0,message:"请输入事件类型",trigger:["blur","change"]}}),F=async()=>{var a,t;if(l.pid){const{data:o,error:s}=await me([l]);s||((t=window.$message)==null||t.success("修改成功"),d.value=!1,f())}else{const{data:o,error:s}=await de([l]);s||((a=window.$message)==null||a.success("添加成功"),d.value=!1,f())}},G=()=>{d.value=!1,l.pid=null,l.pname=null},I=async a=>{var s;const{data:t,error:o}=await pe({ids:a});o||((s=window.$message)==null||s.success("删除成功"),f())},O=a=>{d.value=!0,Object.assign(l,a)},V=()=>{p.fuzzy=null,p.pid=null,x()},x=()=>{const{fuzzy:a,pid:t}=p;if(!a&&!t){f();return}const o=c.eventsTypeDataList.filter(s=>{const h=t?s.pid===t:!0,C=a?s.pname.toLowerCase().includes(a.toLowerCase()):!0;return h&&C});c.eventsTypeDataList=o};return(a,t)=>{const o=te,s=fe,h=ne,C=P,q=K,z=ae,M=ge,L=oe,k=se,R=ve,N=le,W=ie,J=re,w=D("no-space");return Q(),Y("div",ye,[e(k,{title:"",bordered:!1,size:"small"},{header:n(()=>[e(L,{ref:"formRef",model:p,"label-placement":"left","label-width":100,"show-feedback":!1},{default:n(()=>[e(M,{responsive:"screen","item-responsive":""},{default:n(()=>[e(s,{span:"24 s:12 m:6",label:"类别",path:"pid",class:"pr-24px"},{default:n(()=>[_(e(o,{clearable:"",value:p.pid,"onUpdate:value":t[0]||(t[0]=i=>p.pid=i),placeholder:"请选择事件类别",options:c.eventsCategoryDataList,"reset-menu-on-options-change":!1,"value-field":"id","label-field":"pname"},null,8,["value","options"]),[[w]])]),_:1}),e(s,{span:"24 s:12 m:6",label:"类型",path:"fuzzy",class:"pr-24px"},{default:n(()=>[_(e(h,{value:p.fuzzy,"onUpdate:value":t[1]||(t[1]=i=>p.fuzzy=i),placeholder:"请输入事件类型"},null,8,["value"]),[[w]])]),_:1}),e(s,{span:"24 m:12",class:"pr-24px"},{default:n(()=>[e(z,{class:"w-full"},{default:n(()=>[e(r(m),{onClick:V},{icon:n(()=>[e(C,{class:"text-icon"})]),default:n(()=>[v(" "+b(r(u)("common.reset")),1)]),_:1}),e(r(m),{type:"primary",ghost:"",onClick:x},{icon:n(()=>[e(q,{class:"text-icon"})]),default:n(()=>[v(" "+b(r(u)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(k,{title:"事件类型",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":n(()=>[e(r(m),{type:"primary",onClick:j},{default:n(()=>[v("添加")]),_:1})]),default:n(()=>[e(R,{columns:S,data:c.eventsTypeDataList,size:"small","flex-height":!r($).isMobile,"scroll-x":962,loading:A.value,remote:"","row-key":i=>i.id,class:"sm:h-full"},null,8,["columns","data","flex-height","loading","row-key"])]),_:1}),e(J,{show:d.value,"onUpdate:show":t[4]||(t[4]=i=>d.value=i),"display-directive":"show",width:450},{default:n(()=>[e(W,{title:l.id?"编辑":"添加","native-scrollbar":!1,closable:""},{footer:n(()=>[e(z,{size:16},{default:n(()=>[e(r(m),{onClick:G},{default:n(()=>[v(b(r(u)("common.cancel")),1)]),_:1}),e(r(m),{type:"primary",onClick:F},{default:n(()=>[v(b(r(u)("common.confirm")),1)]),_:1})]),_:1})]),default:n(()=>[e(L,{ref:"formRef",model:l,rules:B},{default:n(()=>[e(N,{label:"事件类别",path:"pid"},{default:n(()=>[_(e(o,{clearable:"",value:l.pid,"onUpdate:value":t[2]||(t[2]=i=>l.pid=i),placeholder:"请选择事件类别",options:c.eventsCategoryDataList,"reset-menu-on-options-change":!1,"value-field":"id","label-field":"pname"},null,8,["value","options"]),[[w]])]),_:1}),e(N,{label:"事件类型",path:"pname"},{default:n(()=>[_(e(h,{value:l.pname,"onUpdate:value":t[3]||(t[3]=i=>l.pname=i),placeholder:"请输入事件类型"},null,8,["value"]),[[w]])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])])}}});export{Ne as default};

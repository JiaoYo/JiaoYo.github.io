import{_ as R}from"./export-BzU9pzLL.js";import{d as B,n as $,s as U,o as S,c as L,w as a,g as t,i as e,$ as o,W as M,dq as F,h as z,t as D,F as I,J as P,Z as W,B as O,N as A,O as G,ad as T,a3 as K,dr as V,av as q,j as J,D as Z,e as H,ah as Q,E as X,ai as Y,aj as ee}from"./index-aotvD7SW.js";import{b as te,c as oe}from"./system-log-DAYhbwEk.js";import{u as ae}from"./table-CRv8U80w.js";import{_ as ne}from"./round-search-D5uXX6Zf.js";import{_ as se}from"./round-refresh-C7ic4Fq9.js";import{_ as le}from"./lodash-Tbr0y-hd.js";import{_ as re}from"./FormItemGridItem-C8b8gQ7-.js";import{_ as ie}from"./Grid-DmviDiKc.js";const ce=B({name:"LoginlogSearch",__name:"loginlog-search",props:{model:{required:!0},modelModifiers:{}},emits:$(["reset","search"],["update:model"]),setup(m,{expose:b,emit:h}){const y=h,l=U(m,"model");function x(c){l.value.creatorName=c.replace(/\s/g,"")}function N(c){return!c.startsWith(" ")&&!c.endsWith(" ")}function _(){y("reset")}function u(){y("search")}async function v(){const{data:c,error:n}=await te({creatorName:l.value.creatorName,status:l.value.status});if(!n){let r=c,s=new Blob([r],{type:"application/vnd.ms-excel"}),d=new Date().getTime()+".xls",f=window.webkitURL.createObjectURL(s),i=document.createElement("a");i.href=f,i.download=d,document.body.appendChild(i),i.click(),i.remove()}}const g=le.debounce(u,1e3,{leading:!0,trailing:!1});return b({handleExportChange:v}),(c,n)=>{const r=P,s=re,d=W,f=se,i=O,w=ne,p=A,k=ie,j=G,E=T;return S(),L(E,{bordered:!1,size:"small",class:"card-wrapper"},{default:a(()=>[t(j,{model:l.value,"label-placement":"left","label-width":80,"show-feedback":!1,onKeyup:I(e(g),["enter"])},{default:a(()=>[t(k,{responsive:"screen","item-responsive":"","x-gap":12,"y-gap":12},{default:a(()=>[t(s,{span:"24 s:12 m:8 l:6",label:e(o)("page.systemlog.login.creatorName"),path:"creatorName"},{default:a(()=>[t(r,{clearable:"",value:l.value.creatorName,"onUpdate:value":n[0]||(n[0]=C=>l.value.creatorName=C),placeholder:e(o)("page.systemlog.login.form.creatorName"),onInput:x,"allow-input":N,onClear:_},null,8,["value","placeholder"])]),_:1},8,["label"]),t(s,{span:"24 s:12 m:8 l:6",label:e(o)("page.systemlog.login.status"),path:"status"},{default:a(()=>[t(d,{filterable:"",clearable:"",value:l.value.status,"onUpdate:value":[n[1]||(n[1]=C=>l.value.status=C),u],placeholder:e(o)("page.systemlog.login.form.status"),options:e(M)(e(F)),onClear:_},null,8,["value","placeholder","options"])]),_:1},8,["label"]),t(s,{span:"24 s:12 m:8 l:6"},{default:a(()=>[t(p,{class:"w-full"},{default:a(()=>[t(i,{onClick:_},{icon:a(()=>[t(f,{class:"text-icon"})]),default:a(()=>[z(" "+D(e(o)("common.reset")),1)]),_:1}),t(i,{type:"primary",ghost:"",onClick:e(g)},{icon:a(()=>[t(w,{class:"text-icon"})]),default:a(()=>[z(" "+D(e(o)("common.search")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","onKeyup"])]),_:1})}}}),pe={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function me(m){return typeof m=="function"||Object.prototype.toString.call(m)==="[object Object]"&&!Y(m)}const Ne=B({name:"logmanage_loginlog",__name:"index",setup(m){const b=K(),{columns:h,columnChecks:y,data:l,getData:x,loading:N,pagination:_,searchParams:u,resetSearchParams:v}=ae({apiFn:oe,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,creatorName:null,status:null,_t:new Date().getTime()},columns:()=>[{key:"creatorName",title:o("page.systemlog.login.creatorName"),align:"center",width:160,resizable:!0},{key:"operation",title:o("page.systemlog.login.operation"),width:140,align:"center",render:n=>{const r=n.operation==0?o("page.manage.common.loginStatus.login"):o("page.manage.common.loginStatus.logout");return t("span",null,[r])},resizable:!0},{key:"status",title:o("page.systemlog.login.status"),width:100,align:"center",render:n=>{n.status==null&&(n.status=0);const r={0:"error",1:"success",2:"warning",3:"info",4:"info",5:"error",6:"info",7:"error"},s=o(V[n.status].label);return t(q,{size:"small",type:r[n.status]},me(s)?s:{default:()=>[s]})},resizable:!0},{key:"ip",title:o("page.systemlog.login.ip"),width:160,align:"center",resizable:!0},{key:"userAgent",title:o("page.systemlog.login.userAgent"),minWidth:400,align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"createDate",title:o("page.systemlog.login.createDate"),width:160,align:"center"}]}),g=J(),c=()=>{g.value.handleExportChange()};return(n,r)=>{const s=R,d=O,f=ee,i=T,w=Z("no-auth");return S(),H("div",pe,[t(ce,{model:e(u),"onUpdate:model":r[0]||(r[0]=p=>Q(u)?u.value=p:null),onReset:e(v),onSearch:e(x),ref_key:"searchRef",ref:g},null,8,["model","onReset","onSearch"]),t(i,{title:e(o)("page.systemlog.login.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":a(()=>[X((S(),L(d,{type:"info",size:"small",ghost:"",onClick:c},{icon:a(()=>[t(s,{class:"text-icon"})]),default:a(()=>[z(" "+D(e(o)("common.export")),1)]),_:1})),[[w,"sys:log:login.export"]])]),default:a(()=>[t(f,{columns:e(h),data:e(l),size:"small","flex-height":!e(b).isMobile,"scroll-x":e(h).reduce((p,k)=>p+k.width,0),loading:e(N),remote:"","row-key":p=>p.id,pagination:e(_),class:"sm:h-full"},null,8,["columns","data","flex-height","scroll-x","loading","row-key","pagination"])]),_:1},8,["title"])])}}});export{Ne as default};

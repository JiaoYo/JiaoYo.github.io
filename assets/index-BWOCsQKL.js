import{_ as ue}from"./table-column-setting.vue_vue_type_script_setup_true_lang-BKGQGhnn.js";import{_ as pe}from"./export-D5mM1_lU.js";import{_ as _e}from"./round-search-DD978IKC.js";import{d as J,ab as G,a0 as fe,m as _,z as ge,aj as he,o as N,b as H,_ as K,a$ as x,g as t,w as n,f as i,B as b,af as ye,h as D,t as g,$ as V,e as j,ap as E,c as I,aF as we,T as ve,R as ke,as as xe,O as be,ao as De,a6 as Te}from"./index-gpPDz5v7.js";import{c as A,d as Ce,e as Se}from"./metar-JrZcg88G.js";import{u as Ne,a as Me}from"./table-Cwd2MoGh.js";import{e as ze}from"./exportExcel-Bv4G4H50.js";import{u as Oe}from"./echarts-BDocV4tW.js";import{_ as Re}from"./RadioButton-De-kEDdb.js";import{_ as F}from"./DatePicker-DmJMy14k.js";import{_ as Le}from"./FormItemGridItem-CFl77Dqz.js";import{_ as Pe}from"./Grid-CZgCF5Xo.js";const Ue=J({name:"LineChart",__name:"line-chart",props:{data:{type:Object,default:()=>({})}},setup(L){const c=L;G(()=>c.data,async a=>{M(),z()});const h=fe(),m=_(null),{domRef:y,updateOptions:w,showLoading:M,hideLoading:u}=Oe(()=>({tooltip:{trigger:"axis",axisPointer:{type:"shadow",label:{show:!0}}},legend:{data:["功率标准差","均方根误差","平均绝对误差","平均误差","最大预测误差"]},calculable:!0,grid:{left:"6%",right:"6%",bottom:"10%",containLabel:!0},xAxis:{type:"category",boundaryGap:!0,data:[]},yAxis:{type:"value",axisLabel:{formatter:"{value}"},position:"left"},series:[{name:"功率标准差",type:"bar",emphasis:{focus:"series"},data:[]},{name:"均方根误差",type:"bar",emphasis:{focus:"series"},data:[]},{name:"平均绝对误差",type:"bar",emphasis:{focus:"series"},data:[]},{name:"平均误差",type:"bar",emphasis:{focus:"series"},data:[]},{name:"最大预测误差",type:"bar",emphasis:{focus:"series"},data:[]}],dataZoom:[{type:"inside",start:0,end:100},{start:0,end:100}]}));async function z(){await new Promise(a=>{setTimeout(a,1e3)}),w(a=>(a.xAxis.data=c.data.map(l=>l.dbtime),a.series[0].data=c.data.map(l=>l.stdpower),a.series[1].data=c.data.map(l=>l.prmse),a.series[2].data=c.data.map(l=>l.pmae),a.series[3].data=c.data.map(l=>l.pme),a.series[4].data=c.data.map(l=>l.pmaxe),a))}function f(){w((a,l)=>{const v=l();return a.legend.data=v.legend.data,a.series[0].name=v.series[0].name,a.series[1].name=v.series[1].name,a})}async function T(){z()}return G(()=>h.locale,()=>{f()}),T(),ge(()=>{m.value=window.setInterval(()=>{console.log("mainHomeLineChart timer")},1e3*60*5)}),he(()=>{m.value!==null&&(clearInterval(m.value),m.value=null)}),(a,l)=>(N(),H("div",{ref_key:"domRef",ref:y,class:"h-100% overflow-hidden"},null,512))}}),$e=K(Ue,[["__scopeId","data-v-7655cf3a"]]),Be={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},Ge={style:{width:"200px","margin-left":"20px"}},Ve=J({name:"realtimequery_datastatistics",__name:"index",setup(L){const{columns:c,columnChecks:h,data:m,getData:y,loading:w,mobilePagination:M,searchParams:u,resetSearchParams:z}=Ne({apiFn:A,apiParams:{page:1,pageSize:20,limit:20,startTime:x(0,Date.now()-2592e5),endTime:x(0,Date.now()),_t:new Date().getTime()},immediate:!0,showTotal:!0,columns:()=>[{type:"selection",width:50},{key:"dbtime",title:"更新时间",align:"center",width:160,fixed:"left"},{key:"etime",title:"有效时长(小时)",align:"center",width:120},{key:"powermax",title:"功率最大值",align:"center",width:120},{key:"avgpower",title:"功率平均值",align:"center",width:120},{key:"stdpower",title:"功率标准差",align:"center",width:120},{key:"powertime",title:"功率最大发生时间",align:"center",width:160},{key:"uhours",title:"利用小时数",align:"center",width:120},{key:"avgload",title:"平均负荷率",align:"center",width:120},{key:"prmse",title:"均方根误差",align:"center",width:120},{key:"pmae",title:"平均绝对误差",align:"center",width:120},{key:"pme",title:"平均误差",align:"center",width:120},{key:"pclcf",title:"相关性系数",align:"center",width:120},{key:"pmaxe",title:"最大预测误差",align:"center",width:120},{key:"prate",title:"合格率",align:"center",width:120},{key:"avgenvt",title:"环境温度平均值",align:"center",width:120},{key:"avgenvh",title:"环境湿度平均值",align:"center",width:120},{key:"avgldt",title:"露点温度平均值",align:"center",width:120},{key:"avgqy",title:"气压平均值",align:"center",width:120},{key:"avgwindd",title:"风向平均值",align:"center",width:120},{key:"avgwinds",title:"风速平均值",align:"center",width:120},{key:"avgzfsd",title:"总辐射平均值",align:"center",width:120}]}),{checkedRowKeys:f}=Me(m,y),T=()=>{k.value=="0"?y():U()},a=_([Date.now()-864e5*3,Date.now()]);async function l(s,e){u.startTime=x(0,e[0]),u.endTime=x(0,e[1]),T()}const v=()=>{const s={};c.value.forEach(o=>{o.key!="index"&&o.key!="operate"&&o.type!=="selection"&&(s[o.key]=typeof o.title=="string"?o.title:o.title().children[0])});const e=[];m.value.forEach(o=>{if(f.value.includes(o.id)){const d=JSON.parse(JSON.stringify(s));for(const p in d)o.hasOwnProperty(p)?d[p]=o[p]:d[p]="";e.push(d)}}),ze(e,s,"数据统计")},q={近七天:[Date.now()-864e5*7,Date.now()],近一月:[Date.now()-864e5*30,Date.now()],近三月:[Date.now()-864e5*90,Date.now()]},C=_(!1),O=_(new Date().getTime()),R=_(0),Z=()=>{$(),C.value=!0},Q=(s,e)=>{$()},W=()=>{C.value=!1},k=_("0"),X=s=>{k.value=s,s=="0"?y():U()},Y=(s,e)=>{const o=new Date(s).getTime(),p=(new Date(e).getTime()-o)/(1e3*60*60*24);return Math.abs(p)},P=_([]),U=async()=>{const{data:s,error:e}=await A({startTime:u.startTime,endTime:u.endTime,page:1,limit:Math.floor(Y(u.startTime,u.endTime)+1)});P.value=JSON.parse(JSON.stringify(s)).list.sort((o,d)=>new Date(o.dbtime).getTime()-new Date(d.dbtime).getTime())},$=async()=>{const{data:s,error:e}=await Ce({date:x(3,O.value)});e||(typeof s=="number"?R.value=s:R.value="")},S=_(),ee=async()=>{const{data:s,error:e}=await Se();S.value=s};return(s,e)=>{const o=F,d=Re,p=we,te=_e,ae=Le,ne=Pe,se=ve,oe=pe,ie=ue,B=ke,le=xe,re=F,ce=be,de=De,me=Te;return N(),H("div",Be,[t(me,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:n(()=>[t(se,{ref:"formRef",model:i(u),"label-placement":"left","show-feedback":!1},{default:n(()=>[t(ne,{"y-gap":16,responsive:"screen","item-responsive":""},{default:n(()=>[t(ae,{span:"24 s:12 m:20",label:"起止时间",path:"startTime"},{default:n(()=>[t(o,{value:a.value,"onUpdate:value":e[0]||(e[0]=r=>a.value=r),type:"daterange","value-format":"yyyy-MM-dd","onUpdate:formattedValue":l,"default-time":["00:00:00","23:59:59"],shortcuts:q},null,8,["value"]),t(p,{value:k.value,"onUpdate:value":[e[1]||(e[1]=r=>k.value=r),X],class:"ml-20px"},{default:n(()=>[t(d,{value:"0",label:"表格"}),t(d,{value:"1",label:"图表"})]),_:1},8,["value"]),t(i(b),{type:"primary",ghost:"",onClick:T,class:"ml-20px"},{icon:n(()=>[t(te,{class:ye(["text-icon",{"animate-spin":i(w)}])},null,8,["class"])]),default:n(()=>[D(" "+g(i(V)("common.search")),1)]),_:1}),t(i(b),{type:"primary",ghost:"",onClick:Z,class:"ml-20px"},{default:n(()=>[D(g("月均方根误差"))]),_:1}),t(i(b),{type:"primary",ghost:"",onClick:ee,class:"ml-20px"},{default:n(()=>[D(" 查询日照时数平均值 ")]),_:1}),j("span",Ge,g(S.value&&S.value>0?"日照时数平均值为："+S.value:""),1)]),_:1})]),_:1})]),_:1},8,["model"])]),"header-extra":n(()=>[t(B,{justify:"end",class:"lt-sm:w-200px"},{default:n(()=>[t(i(b),{onClick:v,size:"small",disabled:i(f).length==0},{icon:n(()=>[t(oe,{class:"text-icon"})]),default:n(()=>[D(" "+g(i(V)("common.export")),1)]),_:1},8,["disabled"]),t(ie,{columns:i(h),"onUpdate:columns":e[2]||(e[2]=r=>E(h)?h.value=r:null)},null,8,["columns"])]),_:1})]),default:n(()=>[k.value=="0"?(N(),I(le,{key:0,"checked-row-keys":i(f),"onUpdate:checkedRowKeys":e[3]||(e[3]=r=>E(f)?f.value=r:null),columns:i(c),data:i(m),size:"small",loading:i(w),remote:"","row-key":r=>r.id,pagination:i(m).length?i(M):void 0,class:"sm:h-full","flex-height":!0,"scroll-x":""},null,8,["checked-row-keys","columns","data","loading","row-key","pagination"])):(N(),I($e,{key:1,data:P.value},null,8,["data"])),t(de,{show:C.value,"onUpdate:show":e[5]||(e[5]=r=>C.value=r),preset:"card",class:"w-320px"},{footer:n(()=>[t(B,{justify:"end"},{default:n(()=>[t(i(b),{size:"small",class:"mt-16px",onClick:W},{default:n(()=>[D(g("关闭"))]),_:1})]),_:1})]),default:n(()=>[t(ce,{label:"日期","label-placement":"left"},{default:n(()=>[t(re,{value:O.value,"onUpdate:value":[e[4]||(e[4]=r=>O.value=r),Q],type:"month",clearable:""},null,8,["value"])]),_:1}),j("h2",null,"月均方根误差："+g(R.value),1)]),_:1},8,["show"])]),_:1})])}}}),Xe=K(Ve,[["__scopeId","data-v-b64e1b30"]]);export{Xe as default};

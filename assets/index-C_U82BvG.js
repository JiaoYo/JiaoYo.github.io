import{m as L,a as N,n as ne,q as re,d as B,s as K,v as W,u as le,j as A,x as G,r as q,y as H,z as ie,A as I,C as ce,o as h,c as E,w as c,g as r,D as X,f as _,$ as v,E as j,e as s,F as D,h as U,G as de,t as P,H as ue,I as pe,J as me,K as fe,L as J,M as Q,S as _e,N as he,O as ge,B as Y,P as Z,Q as ee,p as we,i as ve,_ as T,R as ye,T as xe,U as ke,V as be,W as F,X as Ce,Y as Pe,Z as Se,a0 as $e,a1 as Ne,b,a2 as Le,a3 as Re,a4 as M,a5 as Ue}from"./index-CyATXoWD.js";function Ee(w){const p=L(0),C=N(()=>Math.ceil(p.value/60)),k=N(()=>p.value>0),{pause:a,resume:x}=ne(()=>{p.value>0?p.value-=1:a()},{immediate:!1});function m(o=w){p.value=60*o,x()}function e(){p.value=0,a()}return re(()=>{a()}),{count:C,isCounting:k,start:m,stop:e}}const g=w=>(we("data-v-9886755a"),w=w(),ve(),w),Me={class:"w-full flex-y-center gap-16px"},ze=["src"],Ie={class:"flex-y-center justify-between updatePsd"},je={class:"agreement-container"},Fe=g(()=>s("h2",null,"用户协议",-1)),qe={class:"agreement-content"},De=g(()=>s("h3",null,"1. 协议的接受",-1)),Be=g(()=>s("p",null,"在查询或修改用户信息之前，您必须阅读并同意本协议的全部内容。点击“同意”按钮，即表示您已详细阅读并理解本协议，并同意受其约束。",-1)),Te=g(()=>s("h3",null,"2. 用户信息的使用",-1)),Ve=g(()=>s("p",null,"您同意并授权本系统在合法合规的前提下，使用您的用户信息以提供相关服务，包括但不限于：",-1)),Oe=g(()=>s("ul",null,[s("li",null,"查询个人账户信息；"),s("li",null,"修改个人资料，如联系方式、密码等；"),s("li",null,"保障账户安全，防止未经授权的访问或篡改。")],-1)),Xe=g(()=>s("h3",null,"3. 用户责任",-1)),Ke=g(()=>s("p",null,"您保证所提供的所有信息真实、准确、完整，并对您的账户安全负全部责任。",-1)),We=g(()=>s("p",null,"不得冒用他人身份或提供虚假信息，否则系统有权拒绝提供服务，并依法追究责任。",-1)),Ae=g(()=>s("h3",null,"4. 隐私保护",-1)),Ge=g(()=>s("p",null,"我们承诺严格保护您的个人隐私，不会泄露或滥用您的个人信息，除非法律法规另有规定或获得您的明确授权。",-1)),He=g(()=>s("h3",null,"5. 协议变更",-1)),Je=g(()=>s("p",null,"本协议可能会不定期更新，更新后的协议一旦发布即自动生效。如果您继续使用本系统的查询和修改功能，即视为接受新的协议内容。",-1)),Qe=g(()=>s("h3",null,"6. 其他",-1)),Ye=g(()=>s("p",null,"如对本协议有任何疑问，您可联系系统管理员获取进一步解释。",-1)),Ze=g(()=>s("div",{style:{display:"flex","justify-content":"right","align-items":"center"}},null,-1)),et=B({name:"PwdLogin",__name:"pwd-login",props:{status:{type:String,required:!0},statusModifiers:{}},emits:K(["getUsername"],["update:status"]),setup(w,{emit:d}){const p=W(w,"status"),C=d,k=le();A();const{formRef:a,validate:x}=G(),m=q({username:"",captcha:"",password:""}),e=q({uuid:"",captchaSrc:"",captchaEnable:0,checked:!1}),o=L(!1);async function i(){const{data:t,error:n}=await ue();n||(e.captchaEnable=t,e.captchaEnable==1&&l())}async function l(){e.uuid=I(),e.captchaSrc=pe+"/captcha?uuid="+e.uuid;const t=I(),n=Date.now().toString(),R=me(`${t}${n}`);fe.get(e.captchaSrc,{headers:{"X-Nonce":t,"X-Timestamp":n,"X-Signature":R},responseType:"blob"}).then(S=>{const z=URL.createObjectURL(S.data);e.captchaSrc=z}).catch(S=>{console.error("Error:",S)})}const f=N(()=>{const{formRules:t}=H();return{username:t.username,captcha:t.captcha,password:t.password1}});async function u(){var n;if(!o.value)return(n=window.$message)==null?void 0:n.warning("请先同意协议");await x();const t=await k.login(m.username,m.password,m.captcha.trim(),e.uuid);console.log(t),t=="fail"&&e.captchaEnable==1&&(m.captcha="",l())}const y=()=>{p.value="resetPwd",C("getUsername",m.username)};return L(!1),ie(()=>{e.uuid=I(),i()}),(t,n)=>{const R=J,S=Q,z=_e,te=he,oe=ge,V=Y,se=Z,ae=ee,O=ce("no-space");return h(),E(ae,{ref_key:"formRef",ref:a,model:m,rules:f.value,size:"large","show-label":!1},{default:c(()=>[r(S,{path:"userName"},{default:c(()=>[X(r(R,{autofocus:"",value:m.username,"onUpdate:value":n[0]||(n[0]=$=>m.username=$),placeholder:_(v)("page.login.common.userNamePlaceholder"),onKeyup:j(u,["enter"])},null,8,["value","placeholder"]),[[O]])]),_:1}),r(S,{path:"password"},{default:c(()=>[X(r(R,{value:m.password,"onUpdate:value":n[1]||(n[1]=$=>m.password=$),type:"password","show-password-on":"click",minlength:6,maxlength:18,placeholder:_(v)("page.login.common.passwordPlaceholder"),onKeyup:j(u,["enter"])},null,8,["value","placeholder"]),[[O]])]),_:1}),e.captchaEnable==1?(h(),E(S,{key:0,path:"captcha"},{default:c(()=>[s("div",Me,[r(R,{value:m.captcha,"onUpdate:value":n[2]||(n[2]=$=>m.captcha=$),placeholder:"请输入验证码",onKeyup:j(u,["enter"])},null,8,["value"]),s("img",{src:e.captchaSrc,alt:"captcha",style:{height:"40px"},onClick:l},null,8,ze)])]),_:1})):D("",!0),r(se,{vertical:"",size:8},{default:c(()=>[s("div",Ie,[r(oe,{checked:o.value,"onUpdate:checked":n[4]||(n[4]=$=>o.value=$)},{default:c(()=>[U("我已阅读并同意 "),r(te,{style:{"background-color":"#fff",color:"#1f2225"},trigger:"click","content-style":{padding:0}},{trigger:c(()=>[s("span",{class:"c-#1890ff",onClick:n[3]||(n[3]=de(()=>{},["stop"]))},"用户协议")]),default:c(()=>[s("div",je,[Fe,s("div",qe,[r(z,{style:{"max-height":"320px",width:"520px"},"content-style":{padding:"0 0 30px 0"}},{default:c(()=>[De,Be,Te,Ve,Oe,Xe,Ke,We,Ae,Ge,He,Je,Qe,Ye]),_:1})])])]),_:1})]),_:1},8,["checked"]),r(V,{quaternary:"",onClick:y},{default:c(()=>[U(P("修改密码"))]),_:1})]),r(V,{type:"primary",size:"large",ghost:"",round:"",block:"",loading:_(k).loginLoading,disabled:!o.value,onClick:u},{default:c(()=>[U(P(_(v)("common.confirm")),1)]),_:1},8,["loading","disabled"]),Ze]),_:1})]),_:1},8,["model","rules"])}}}),tt=T(et,[["__scopeId","data-v-9886755a"]]);function ot(){const{loading:w,startLoading:d,endLoading:p}=ye(),{count:C,start:k,stop:a,isCounting:x}=Ee(60),m=N(()=>{let i=v("page.login.codeLogin.getCode");const l=v("page.login.codeLogin.reGetCode",{time:C.value});return w.value&&(i=""),x.value&&(i=l),i});function e(i){var l,f,u,y;return i.trim()===""?((f=(l=window.$message)==null?void 0:l.error)==null||f.call(l,v("form.mobile.required")),!1):ke.test(i)?!0:((y=(u=window.$message)==null?void 0:u.error)==null||y.call(u,v("form.mobile.invalid")),!1)}async function o(i,l){!e(i)||w.value||(d(),await new Promise(u=>{xe(i,l).then(y=>{var t,n;console.log("response",y),y.error||(setTimeout(u,500),(n=(t=window.$message)==null?void 0:t.success)==null||n.call(t,v("page.login.codeLogin.sendCodeSuccess")),k(),p())}).catch(y=>{var t,n;return console.log("error",y),(n=(t=window.$message)==null?void 0:t.error)==null||n.call(t,v("page.login.codeLogin.sendCodeFailed")),!1})}))}return{label:m,start:k,stop:a,isCounting:x,loading:w,getCaptcha:o}}const st=B({name:"ResetPwd",__name:"reset-pwd",props:K({username:{type:String,required:!0}},{status:{type:String,required:!0},statusModifiers:{}}),emits:["update:status"],setup(w){const d=W(w,"status"),p=w;A();const{formRef:C,validate:k}=G();ot();const a=q({username:p.username||"",oripwd:"",code:"",password:"",confirmPassword:""}),x=N(()=>{const{formRules:e,createConfirmPwdRule:o,defaultRequiredRule:i}=H();return{username:e.username,oripwd:e.password1,password:[{...i},{asyncValidator:(l,f)=>f==""||f==null?Promise.resolve():be(f)?a.username&&f.toLocaleLowerCase().includes(a.username.toLocaleLowerCase())?Promise.reject("密码禁止与用户名相同或包含用户名(不区分大小写)"):a.password==a.oripwd?Promise.reject("新密码不能与旧密码相同"):Promise.resolve():Promise.reject("密码应符合：大、小写字母、数字、特殊字符的8-18位组合"),trigger:["blur","input"]}],code:e.code,confirmPassword:o(a.password)}});async function m(){var u,y;await k();const e=F(a.oripwd),o=F(a.password),i=F(a.username),{data:l,error:f}=await Ce(i,e,o);console.log("data",l),f?(y=window.$message)==null||y.error("修改失败"):((u=window.$message)==null||u.success("修改成功"),d.value="pwd-login1")}return(e,o)=>{const i=J,l=Q,f=Y,u=Z,y=ee;return h(),E(y,{ref_key:"formRef",ref:C,model:a,rules:x.value,size:"large","show-label":!1},{default:c(()=>[r(l,{path:"username"},{default:c(()=>[r(i,{value:a.username,"onUpdate:value":o[0]||(o[0]=t=>a.username=t),placeholder:_(v)("page.login.common.userNamePlaceholder")},null,8,["value","placeholder"])]),_:1}),r(l,{path:"oripwd"},{default:c(()=>[r(i,{value:a.oripwd,"onUpdate:value":o[1]||(o[1]=t=>a.oripwd=t),type:"password","show-password-on":"click",placeholder:"请输入原密码"},null,8,["value"])]),_:1}),r(l,{path:"password"},{default:c(()=>[r(i,{value:a.password,"onUpdate:value":o[2]||(o[2]=t=>a.password=t),type:"password","show-password-on":"click",placeholder:"请输入新密码"},null,8,["value"])]),_:1}),r(l,{path:"confirmPassword"},{default:c(()=>[r(i,{value:a.confirmPassword,"onUpdate:value":o[3]||(o[3]=t=>a.confirmPassword=t),type:"password","show-password-on":"click",placeholder:_(v)("page.login.common.confirmPasswordPlaceholder")},null,8,["value","placeholder"])]),_:1}),r(u,{vertical:"",size:18,class:"w-full"},{default:c(()=>[r(f,{type:"primary",size:"large",ghost:"",round:"",block:"",onClick:m},{default:c(()=>[U(P(_(v)("common.confirm")),1)]),_:1}),r(f,{size:"large",ghost:"",round:"",block:"",onClick:o[4]||(o[4]=t=>d.value="pwd-login"),class:"c-#fff"},{default:c(()=>[U(P(_(v)("page.login.common.back")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])}}}),at=T(st,[["__scopeId","data-v-74e31eee"]]),nt={class:"w-400px lt-sm:w-300px"},rt={class:"flex-y-center justify-center"},lt={key:0,src:M,alt:"Linkqi",style:{width:"64px",position:"absolute",left:"20px"}},it={key:1,src:M,alt:"Linkqi",style:{width:"64px",position:"absolute",left:"20px"}},ct={key:2,class:"text-28px text-primary font-500 lt-sm:text-22px",style:{color:"#fff","text-align":"center"}},dt={key:3,class:"text-28px text-primary font-500 lt-sm:text-22px",style:{color:"#fff","text-align":"center"}},ut={class:"pt-24px"},pt={class:"pt-16px"},mt={class:"flex justify-center items-center",style:{position:"fixed",top:"20px",right:"20px","z-index":"999"}},ft={key:0,src:M,alt:"Linkqi",class:"w-100px pr-10px"},_t={key:1,src:M,alt:"Linkqi",class:"w-100px pr-10px"},ht={key:2,style:{color:"#fff","font-size":"1.2rem","font-weight":"500"}},gt={key:3,style:{color:"#fff","font-size":"1.2rem","font-weight":"500"}},wt={key:0,style:{color:"#fff",position:"fixed",left:"50%",bottom:"5%",transform:"translateX(-50%)","font-size":"1rem","z-index":"999"}},vt={key:1,style:{color:"#fff",position:"fixed",left:"50%",bottom:"5%",transform:"translateX(-50%)","font-size":"1rem","z-index":"999"}},yt=B({name:"login",__name:"index",props:{module:{}},setup(w){Pe();const d=Se(),p=L("pwd-login");N(()=>d.darkMode?$e(d.themeColor,600):d.themeColor);const C=L(""),k=e=>{C.value=e},a=N(()=>{const e="#ffffff",o=d.darkMode?.5:.2;return Ne(e,d.themeColor,o)}),x=L();return(async()=>{fetch("/version.json").then(e=>e.json()).then(e=>{x.value=e}).catch(e=>{console.error("Error fetching version.json:",e)})})(),(e,o)=>{var l,f;const i=Ue;return h(),b("div",{class:"relative size-full flex-center overflow-hidden login",style:Re({backgroundColor:a.value})},[r(i,{bordered:!1,class:"relative z-4 w-auto rd-12px loginClass","content-style":{padding:"24px 36px"}},{default:c(()=>[s("div",nt,[s("header",rt,[_(d).darkMode?(h(),b("img",it)):(h(),b("img",lt)),_(d).darkMode?(h(),b("h3",ct,P(_(v)("system.title")),1)):(h(),b("h3",dt,P(_(v)("system.title")),1))]),s("main",ut,[s("div",pt,[r(Le,{name:_(d).page.animateMode,mode:"out-in",appear:""},{default:c(()=>[p.value=="pwd-login"||p.value=="pwd-login1"?(h(),E(tt,{key:0,status:p.value,"onUpdate:status":o[0]||(o[0]=u=>p.value=u),onGetUsername:k},null,8,["status"])):(h(),E(at,{key:1,status:p.value,"onUpdate:status":o[1]||(o[1]=u=>p.value=u),username:C.value},null,8,["status","username"]))]),_:1},8,["name"])])])])]),_:1}),s("div",mt,[_(d).darkMode?(h(),b("img",_t)):(h(),b("img",ft)),_(d).darkMode?(h(),b("span",ht,P(((l=x.value)==null?void 0:l.ver)||""),1)):(h(),b("span",gt,P(((f=x.value)==null?void 0:f.ver)||""),1))]),_(d).darkMode?D("",!0):(h(),b("div",wt," Copyright (c) 2025 · 杭州领祺科技有限公司")),_(d).darkMode?(h(),b("div",vt," Copyright (c) 2025 · 杭州领祺科技有限公司")):D("",!0)],4)}}}),kt=T(yt,[["__scopeId","data-v-aa3703d2"]]);export{kt as default};

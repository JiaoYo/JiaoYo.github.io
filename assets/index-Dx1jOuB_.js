import{_ as B}from"./export-CaaNVRvS.js";import{d as C,q as E,s as M,o as S,c as R,w as a,g as o,i as e,$ as t,Z as U,dl as q,h as N,t as z,a2 as j,B as D,E as P,D as $,ad as O,a4 as L,at as A,j as F,e as G,ag as V,ah as I,ai as Z}from"./index-ByfxsQvj.js";import{d as H,e as J}from"./system-log-xDESFOLE.js";import{u as K}from"./table-Ca-5bYro.js";import{_ as Q}from"./round-search-U_wZ0GRt.js";import{_ as W}from"./round-refresh-BRVSTvae.js";import{_ as X}from"./lodash-21GmhknM.js";import{_ as Y}from"./FormItemGridItem-Dtr_7n7z.js";import{_ as ee}from"./Grid-B9K_tFX2.js";const te=C({name:"OptionlogSearch",__name:"optionlog-search",props:{model:{required:!0},modelModifiers:{}},emits:E(["reset","search"],["update:model"]),setup(p,{expose:y,emit:d}){const b=d,m=M(p,"model");function g(){b("reset")}function f(){b("search")}async function x(){const{data:h,error:r}=await H({status:m.value.status});if(!r){let _=h,s=new Blob([_],{type:"application/vnd.ms-excel"}),i=new Date().getTime()+".xls",n=window.webkitURL.createObjectURL(s),l=document.createElement("a");l.href=n,l.download=i,document.body.appendChild(l),l.click(),l.remove()}}const u=X.throttle(f,1e3,{trailing:!1});return y({handleExportChange:x}),(h,r)=>{const _=j,s=Y,i=W,n=D,l=Q,w=P,k=ee,c=$,v=O;return S(),R(v,{bordered:!1,size:"small",class:"card-wrapper"},{default:a(()=>[o(c,{model:m.value,"label-placement":"left","label-width":80,"show-feedback":!1},{default:a(()=>[o(k,{responsive:"screen","item-responsive":"","x-gap":12,"y-gap":12},{default:a(()=>[o(s,{span:"24 s:12 m:8 l:6",label:e(t)("page.systemlog.option.status"),path:"status"},{default:a(()=>[o(_,{filterable:"",clearable:"",value:m.value.status,"onUpdate:value":[r[0]||(r[0]=T=>m.value.status=T),f],placeholder:e(t)("page.systemlog.option.form.status"),options:e(U)(e(q)),onClear:g},null,8,["value","placeholder","options"])]),_:1},8,["label"]),o(s,{span:"24 s:12 m:8 l:6"},{default:a(()=>[o(w,{class:"w-full"},{default:a(()=>[o(n,{onClick:g},{icon:a(()=>[o(i,{class:"text-icon"})]),default:a(()=>[N(" "+z(e(t)("common.reset")),1)]),_:1}),o(n,{type:"primary",ghost:"",onClick:e(u)},{icon:a(()=>[o(l,{class:"text-icon"})]),default:a(()=>[N(" "+z(e(t)("common.search")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),oe={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function ae(p){return typeof p=="function"||Object.prototype.toString.call(p)==="[object Object]"&&!I(p)}const _e=C({name:"logmanage_optionlog",__name:"index",setup(p){const y=L(),{columns:d,columnChecks:b,data:m,getData:g,loading:f,pagination:x,searchParams:u,resetSearchParams:h}=K({apiFn:J,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,status:null,_t:new Date().getTime()},columns:()=>[{key:"creatorName",title:t("page.systemlog.option.creatorName"),align:"center",width:160,resizable:!0},{key:"operation",title:t("page.systemlog.option.operation"),width:140,align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"requestUri",title:t("page.systemlog.option.requestUri"),width:160,align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"requestMethod",title:t("page.systemlog.option.requestMethod"),width:100,align:"center"},{key:"requestParams",title:t("page.systemlog.option.requestParams"),width:140,align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"requestTime",title:t("page.systemlog.option.requestTime")+"(ms)",width:120,align:"center",resizable:!0},{key:"status",title:t("page.systemlog.option.status"),width:100,align:"center",render:s=>{s.status==null&&(s.status=0);const i={0:"error",1:"primary"},n=t(q[s.status].label);return o(A,{size:"small",type:i[s.status]},ae(n)?n:{default:()=>[n]})},resizable:!0},{key:"ip",title:t("page.systemlog.option.ip"),width:160,align:"center",resizable:!0},{key:"userAgent",title:t("page.systemlog.option.userAgent"),align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"createDate",title:t("page.systemlog.option.createDate"),width:160,align:"center"}]}),r=F(),_=()=>{r.value.handleExportChange()};return(s,i)=>{const n=B,l=D,w=Z,k=O;return S(),G("div",oe,[o(te,{model:e(u),"onUpdate:model":i[0]||(i[0]=c=>V(u)?u.value=c:null),onReset:e(h),onSearch:e(g),ref_key:"searchRef",ref:r},null,8,["model","onReset","onSearch"]),o(k,{title:e(t)("page.systemlog.option.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":a(()=>[o(l,{type:"info",size:"small",ghost:"",onClick:_},{icon:a(()=>[o(n,{class:"text-icon"})]),default:a(()=>[N(" "+z(e(t)("common.export")),1)]),_:1})]),default:a(()=>[o(w,{columns:e(d),data:e(m),size:"small","flex-height":!e(y).isMobile,"scroll-x":e(d).reduce((c,v)=>c+v.width,0),loading:e(f),remote:"","row-key":c=>c.id,pagination:e(x),class:"sm:h-full"},null,8,["columns","data","flex-height","scroll-x","loading","row-key","pagination"])]),_:1},8,["title"])])}}});export{_e as default};

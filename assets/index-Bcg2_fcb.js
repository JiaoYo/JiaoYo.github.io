import{_ as W}from"./table-column-setting.vue_vue_type_script_setup_true_lang-P1qKwD6q.js";import{_ as X}from"./refresh-516o5uee.js";import{d as K,q as Z,Z as O,v as H,s as J,K as $,o as R,c as V,w as a,g as e,L as A,i as t,$ as c,U as Q,h as u,t as B,M as Y,A as ee,X as te,B as x,E as j,D as ae,a9 as E,am as ne,e as oe,ac as D,b7 as se,ad as le}from"./index-BthjjP8Z.js";import{d as re,e as ie}from"./common-DWrY_MNZ.js";import{u as ce,a as me}from"./table-DgUtF0JO.js";import{_ as pe}from"./round-search-D0y4Bi99.js";import{_ as ue}from"./round-refresh-7YBMJmxM.js";import{C as de,a as _e}from"./common-Cfy7P7FO.js";import{_ as fe}from"./FormItemGridItem-Cf_xNcQf.js";import{_ as he}from"./Grid-CrjQrgB8.js";import{_ as P}from"./Popconfirm-DUBjdYuJ.js";import{_ as ge}from"./DataTable-DVNKf1bg.js";import"./setting-outlined-CB-n0fXZ.js";import"./Forward-B9_DMOnd.js";const ye=K({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:Z(["reset","search"],["update:model"]),setup(m,{emit:z}){const d=z,_=O(),{formRef:y,restoreValidation:p}=H(),l=J(m,"model");function C(){l.value.fuzzy=void 0,d("search")}async function f(){await p(),d("reset")}async function h(){d("search")}return(G,g)=>{const T=ee,v=fe,U=te,r=ue,S=x,F=pe,M=j,N=he,w=ae,n=E,o=$("no-space");return R(),V(n,{bordered:!1,size:"small",class:"card-wrapper"},{default:a(()=>[e(w,{ref_key:"formRef",ref:y,model:l.value,"label-placement":"left","label-width":t(_).locale=="en-US"?120:100,"show-feedback":!1,onKeyup:Y(h,["enter"])},{default:a(()=>[e(N,{responsive:"screen","item-responsive":""},{default:a(()=>[e(v,{span:"24 s:12 m:6",label:"告警名称",path:"fuzzy",class:"pr-24px"},{default:a(()=>[A(e(T,{autofocus:"",value:l.value.fuzzy,"onUpdate:value":g[0]||(g[0]=s=>l.value.fuzzy=s),placeholder:"请输入告警名称",clearable:"",onClear:C},null,8,["value"]),[[o]])]),_:1}),e(v,{span:"24 s:12 m:6",label:"告警状态",path:"alarmtypel",class:"pr-24px"},{default:a(()=>[e(U,{filterable:"",clearable:"",placeholder:t(c)("page.manage.alarm.form.status"),value:l.value.alarmtypel,"onUpdate:value":[g[1]||(g[1]=s=>l.value.alarmtypel=s),h],options:t(Q)(t(de))},null,8,["placeholder","value","options"])]),_:1}),e(v,{span:"24 s:12 m:6",class:"pr-24px"},{default:a(()=>[e(M,{class:"w-full flex items-center"},{default:a(()=>[e(S,{onClick:f},{icon:a(()=>[e(r,{class:"text-icon"})]),default:a(()=>[u(" "+B(t(c)("common.reset")),1)]),_:1}),e(S,{type:"primary",ghost:"",onClick:h},{icon:a(()=>[e(F,{class:"text-icon"})]),default:a(()=>[u(" "+B(t(c)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","label-width"])]),_:1})}}}),ve={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function we(m){return typeof m=="function"||Object.prototype.toString.call(m)==="[object Object]"&&!le(m)}const Fe=K({name:"platformalarm_systemalarm",__name:"index",setup(m){const z=O(),{columns:d,columnChecks:_,data:y,getData:p,loading:l,mobilePagination:C,searchParams:f,resetSearchParams:h}=ce({apiFn:re,immediate:!0,apiParams:{page:1,limit:20,alarmtypel:null,fuzzy:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48,fixed:"left"},{key:"alarmname",title:"告警名称",align:"center",minWidth:120,ellipsis:{tooltip:!0}},{key:"type",title:"类型",align:"center",width:100,render:n=>"系统"},{key:"alarmtype",title:c("page.manage.alarm.status"),align:"center",width:120,render:n=>{(n.alarmtype===void 0||n.alarmtype===null)&&(n.alarmtype=0);const o={0:"error",1:"success"},s=c(_e[n.alarmtype]);return e(ne,{size:"small",type:o[n.alarmtype]},we(s)?s:{default:()=>[s]})}},{key:"dbtime",title:"发生时间",align:"center",width:180},{key:"alarmdesc",title:"告警描述",align:"center",minWidth:160,ellipsis:{tooltip:!0}},{key:"operate",title:c("common.operate"),align:"center",width:130,fixed:"right",render:n=>n.alarmtype==0?e("div",{class:"flex-center gap-8px"},[e(P,{onPositiveClick:()=>w(n.id+"")},{default:()=>"确定要确认该告警数据吗？",trigger:()=>A(e(x,{type:"success",ghost:!0,size:"small"},{default:()=>[u("确认")]}),[[$("no-auth"),"sys.alarm.update"]])})]):null}]}),{drawerVisible:G,operateType:g,editingData:T,handleAdd:v,handleEdit:U,checkedRowKeys:r,onBatchDeleted:S,onDeleted:F,closeDrawer:M}=me(y,p),N=()=>{w(r.value.join(","))},w=async n=>{var b,k;const{data:o,error:s}=await ie({ids:n});s||(p(),(b=window.$message)==null||b.destroyAll(),(k=window.$message)==null||k.success("确认成功"))};return(n,o)=>{const s=X,b=W,k=j,I=ge,q=E,L=$("no-auth");return R(),oe("div",ve,[e(ye,{model:t(f),"onUpdate:model":o[0]||(o[0]=i=>D(f)?f.value=i:null),onReset:t(h),onSearch:t(p)},null,8,["model","onReset","onSearch"]),e(q,{title:"系统告警",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":a(()=>[e(k,null,{default:a(()=>[e(t(P),{onPositiveClick:N},{trigger:a(()=>[A((R(),V(t(x),{size:"small",ghost:"",type:"primary",disabled:t(r).length===0},{default:a(()=>[u(" 全部确认 ")]),_:1},8,["disabled"])),[[L,"sys.alarm.update"]])]),default:a(()=>[u(" 确定要确认选中的数据吗？ ")]),_:1}),e(t(x),{size:"small",onClick:t(p)},{icon:a(()=>[e(s,{class:se(["text-icon",{"animate-spin":t(l)}])},null,8,["class"])]),default:a(()=>[u(" "+B(t(c)("common.refresh")),1)]),_:1},8,["onClick"]),e(b,{columns:t(_),"onUpdate:columns":o[1]||(o[1]=i=>D(_)?_.value=i:null)},null,8,["columns"])]),_:1})]),default:a(()=>[e(I,{"checked-row-keys":t(r),"onUpdate:checkedRowKeys":o[2]||(o[2]=i=>D(r)?r.value=i:null),columns:t(d),data:t(y),size:"small","flex-height":!t(z).isMobile,"scroll-x":702,loading:t(l),remote:"","row-key":i=>i.id,pagination:t(C),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1})])}}});export{Fe as default};

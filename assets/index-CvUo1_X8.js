import{_ as Z}from"./table-header-operation.vue_vue_type_script_setup_true_lang-BLZqLGKQ.js";import{bz as P,d as A,q as j,s as E,v as G,x as ee,b as te,r as oe,y as ne,L as F,o as K,c as L,w as a,g as e,h as I,t as M,i as t,$ as d,N as H,M as U,A as W,C as ae,D as J,B as O,E as Q,ab as se,ac as le,aa as X,a0 as re,as as ie,an as ce,e as me,ad as B,ae as ue}from"./index-bmrF5t8f.js";import{u as de,a as pe}from"./table-D3vktSOg.js";import{_ as _e}from"./round-search-BkS6wno-.js";import{_ as fe}from"./round-refresh-DE6-F-wi.js";import{_ as he}from"./FormItemGridItem-Dh6nDgK2.js";import{_ as ye}from"./Grid-PcVCV9VT.js";import{h as q}from"./permission-CXHyUD8r.js";import{_ as ge}from"./Popconfirm-DnCBdUAN.js";import{_ as ve}from"./DataTable-BkNQhf46.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-C3yzJfMk.js";import"./setting-outlined-B1KkxL92.js";import"./round-delete-CCyWp6lL.js";import"./refresh-C6yTiYgx.js";import"./round-plus-BQ1eErvH.js";import"./Upload-BMjE5905.js";import"./Progress-BlN5LrMM.js";import"./Forward-DNQo90l-.js";function we(s){return P({url:"/manu/selectPage.do",method:"get",params:s})}function be(s){return P({url:"/manu/insert.do",method:"post",data:s})}function De(s){return P({url:"/manu/update.do",method:"post",data:s})}function ke(s){return P({url:"/manu/delete.do",method:"get",params:{ids:s.join(",")}})}const xe=A({name:"OperateDrawer",__name:"operate-drawer",props:j({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:j(["submitted"],["update:visible"]),setup(s,{emit:z}){const i=s,h=z,p=E(s,"visible"),{formRef:c,validate:b,restoreValidation:C}=G(),{defaultRequiredRule:y}=ee(),T=te(()=>({add:"新增厂商",edit:"编辑厂商"})[i.operateType]),l=oe(D());function D(){return{mname:"",sysparam:1}}const k={mname:y};function S(){Object.assign(l,D()),i.operateType==="edit"&&i.rowData&&Object.assign(l,i.rowData)}function g(){p.value=!1}async function m(){var v,u;if(await b(),i.operateType==="add"){const{data:x,error:_}=await be([{mname:l.mname,sysparam:l.sysparam}]);_||((v=window.$message)==null||v.success(d("common.addSuccess")),g(),h("submitted"))}else{const{data:x,error:_}=await De([{id:i.rowData.id,mname:l.mname,sysparam:l.sysparam}]);_||((u=window.$message)==null||u.success(d("common.updateSuccess")),g(),h("submitted"))}}return ne(p,()=>{p.value&&(S(),C())}),(v,u)=>{const x=W,_=ae,R=J,N=O,$=Q,o=se,n=le,r=F("no-space");return K(),L(n,{show:p.value,"onUpdate:show":u[1]||(u[1]=w=>p.value=w),"display-directive":"show",width:360},{default:a(()=>[e(o,{title:T.value,"native-scrollbar":!1,closable:""},{footer:a(()=>[e($,{size:16},{default:a(()=>[e(N,{onClick:g},{default:a(()=>[I(M(t(d)("common.cancel")),1)]),_:1}),e(N,{type:"primary",onClick:m},{default:a(()=>[I(M(t(d)("common.confirm")),1)]),_:1})]),_:1})]),default:a(()=>[e(R,{ref_key:"formRef",ref:c,model:l,rules:k,onKeyup:H(m,["enter"])},{default:a(()=>[e(_,{label:"名称",path:"mname"},{default:a(()=>[U(e(x,{value:l.mname,"onUpdate:value":u[0]||(u[0]=w=>l.mname=w),placeholder:"请输入名称",clearable:""},null,8,["value"]),[[r]])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Ne=A({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:j(["reset","search"],["update:model"]),setup(s,{emit:z}){const i=z,{formRef:h,restoreValidation:p}=G(),c=E(s,"model");function b(){c.value.fuzzy="",i("search")}async function C(){await p(),i("reset")}async function y(){i("search")}return(T,l)=>{const D=W,k=he,S=fe,g=O,m=_e,v=Q,u=ye,x=J,_=X,R=F("no-space");return K(),L(_,{bordered:!1,size:"small",class:"card-wrapper"},{default:a(()=>[e(x,{ref_key:"formRef",ref:h,model:c.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:H(y,["enter"])},{default:a(()=>[e(u,{responsive:"screen","item-responsive":""},{default:a(()=>[e(k,{span:"24 s:12 m:6",label:"名称",path:"fuzzy",class:"pr-24px"},{default:a(()=>[U(e(D,{clearable:"",value:c.value.fuzzy,"onUpdate:value":l[0]||(l[0]=N=>c.value.fuzzy=N),placeholder:"请输入名称",onClear:b},null,8,["value"]),[[R]])]),_:1}),e(k,{span:"24 m:12",class:"pr-24px"},{default:a(()=>[e(v,{class:"w-full"},{default:a(()=>[e(g,{onClick:C},{icon:a(()=>[e(S,{class:"text-icon"})]),default:a(()=>[I(" "+M(t(d)("common.reset")),1)]),_:1}),e(g,{type:"primary",ghost:"",onClick:y},{icon:a(()=>[e(m,{class:"text-icon"})]),default:a(()=>[I(" "+M(t(d)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),ze={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function V(s){return typeof s=="function"||Object.prototype.toString.call(s)==="[object Object]"&&!ue(s)}const Ge=A({name:"manage_company",__name:"index",setup(s){const z=re(),{columns:i,columnChecks:h,data:p,getData:c,loading:b,mobilePagination:C,searchParams:y,resetSearchParams:T}=de({apiFn:we,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,fuzzy:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48,disabled:o=>o.sysparam==0},{key:"mname",title:"名称",align:"center",minWidth:160,ellipsis:{tooltip:!0}},{key:"sysparam",title:"系统内置",align:"center",width:140,render:o=>{o.sysparam==null&&(o.sysparam=0);const n={0:"success",1:"info"},r=d(ie[o.sysparam]);return e(ce,{size:"small",type:n[o.sysparam]},V(r)?r:{default:()=>[r]})}},{key:"operate",title:d("common.operate"),align:"center",width:160,render:o=>{let n;return o.sysparam!=0?e("div",{class:"flex-center gap-8px"},[U(e(O,{type:"primary",ghost:!0,size:"small",onClick:()=>N(o.id)},V(n=d("common.edit"))?n:{default:()=>[n]}),[[F("no-auth"),"manu.source.update"]]),e(ge,{onPositiveClick:()=>R(o.id)},{default:()=>d("common.confirmDelete"),trigger:()=>{let r;return U(e(O,{type:"error",ghost:!0,size:"small"},V(r=d("common.delete"))?r:{default:()=>[r]}),[[F("no-auth"),"manu.source.delete"]])}})]):null}}]}),{drawerVisible:l,operateType:D,editingData:k,handleAdd:S,handleEdit:g,checkedRowKeys:m,onBatchDeleted:v,onDeleted:u,closeDrawer:x}=pe(p,c);async function _(){console.log(m.value),$(m.value,o=>{v()})}function R(o){console.log(o),$([o],n=>{u()})}function N(o){g(o)}async function $(o,n){const{data:r,error:w}=await ke(o);if(!w)n&&n(r);else return!1}return(o,n)=>{const r=Z,w=ve,Y=X;return K(),me("div",ze,[e(Ne,{model:t(y),"onUpdate:model":n[0]||(n[0]=f=>B(y)?y.value=f:null),onReset:t(T),onSearch:t(c)},null,8,["model","onReset","onSearch"]),e(Y,{title:"厂商列表",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":a(()=>[e(r,{columns:t(h),"onUpdate:columns":n[1]||(n[1]=f=>B(h)?h.value=f:null),"disabled-delete":t(m).length===0,loading:t(b),onAdd:t(S),onDelete:_,onRefresh:t(c),"is-view-add-button":t(q)("manu.source.insert"),"is-view-delete-button":t(q)("manu.source.delete")},null,8,["columns","disabled-delete","loading","onAdd","onRefresh","is-view-add-button","is-view-delete-button"])]),default:a(()=>[e(w,{"checked-row-keys":t(m),"onUpdate:checkedRowKeys":n[2]||(n[2]=f=>B(m)?m.value=f:null),columns:t(i),data:t(p),size:"small","flex-height":!t(z).isMobile,"scroll-x":962,loading:t(b),remote:"","row-key":f=>f.id,pagination:t(C),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(xe,{visible:t(l),"onUpdate:visible":n[3]||(n[3]=f=>B(l)?l.value=f:null),"operate-type":t(D),"row-data":t(k),onSubmitted:t(c)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1})])}}});export{Ge as default};

import{_ as re}from"./table-column-setting.vue_vue_type_script_setup_true_lang-P1qKwD6q.js";import{_ as ce}from"./refresh-516o5uee.js";import{d as j,q as T,s as E,v as L,x as ue,r as X,y as pe,o as S,c as R,w as t,g as e,h as n,t as s,f as u,b5 as de,S as me,F as Z,aw as _e,ax as fe,ay as ge,i as o,U as he,$ as k,M as be,X as ve,B as x,E as H,D as J,a9 as Q,Z as ye,am as we,aV as xe,j as q,K as ke,e as Ce,ac as F,L as O,b7 as Ie,ad as Se,as as $e,A as De,C as Ne}from"./index-BthjjP8Z.js";import{D as Re,a as Pe}from"./collection-gkpbHMFr.js";import{u as Ue,a as Me}from"./table-DgUtF0JO.js";import{f as Be,a as ze,b as Fe,c as Ae,d as Ve}from"./Collection-BZegAhPl.js";import{_ as Oe,a as Te}from"./DescriptionsItem-BMrXBvZ-.js";import{_ as je}from"./Table-BGGCbpXr.js";import{_ as Ge}from"./round-search-D0y4Bi99.js";import{_ as Ke}from"./round-refresh-7YBMJmxM.js";import{_ as qe}from"./FormItemGridItem-Cf_xNcQf.js";import{_ as Ee}from"./Grid-CrjQrgB8.js";import{_ as Le}from"./DataTable-DVNKf1bg.js";import"./setting-outlined-CB-n0fXZ.js";import"./Forward-B9_DMOnd.js";const Xe=p=>(_e("data-v-0c758ac5"),p=p(),fe(),p),Ze=Xe(()=>u("thead",null,[u("tr",null,[u("th",null,"盘符路径"),u("th",null,"盘符类型"),u("th",null,"文件类型"),u("th",null,"总大小"),u("th",null,"已经使用量"),u("th",null,"剩余大小"),u("th",null,"使用率")])],-1)),He=j({name:"InfoModal",__name:"info_modal",props:T({id:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:T(["submitted"],["update:visible"]),setup(p,{emit:P}){const v=p,d=E(p,"visible"),{formRef:$,validate:m,restoreValidation:C}=L();ue();const a=X(f());function f(){return{pip:"",uninstall:0,pdesc:"",sysaudit:4,cpuusg:0,cpusysusg:0,cpuwait:0,cpuidle:0,memrtal:0,usedmem:0,resmem:0,memrat:0,servername:"",opersystem:"",architecture:"",proxyver:"",dispath:"",distype:"",filetype:"",distal:0,disuse:0,userat:0,status:1,dbtime:""}}async function U(){const{data:_,error:I}=await Be(v.id);Object.assign(a,_)}return pe(d,()=>{d.value&&(U(),C())}),(_,I)=>{const g=de,r=Oe,b=Te,y=je,M=me,B=Z;return S(),R(B,{show:d.value,"onUpdate:show":I[0]||(I[0]=z=>d.value=z),title:"代理服务器中心配置",preset:"card",class:"w-1000px"},{default:t(()=>[e(M,{style:{"max-height":"550px"}},{default:t(()=>[e(g,{"title-placement":"left"},{default:t(()=>[n("当前状况")]),_:1}),e(b,{"label-placement":"left","label-style":{width:"140px",color:"#1873D7",display:"inline-block",textAlign:"right",marginRight:"10px"}},{default:t(()=>[e(r,{label:"IP"},{default:t(()=>[n(s(a.pip),1)]),_:1}),e(r,{label:"状态"},{default:t(()=>[n(s(a.status==0?"在线":"离线"),1)]),_:1}),e(r,{label:"更新时间"},{default:t(()=>[n(s(a.dbtime||""),1)]),_:1}),e(r,{label:"卸载恢复"},{default:t(()=>[n(s(a.uninstall==0?"开":"关"),1)]),_:1}),e(r,{label:"描述"},{default:t(()=>[n(s(a.pdesc||""),1)]),_:1})]),_:1}),e(g,{"title-placement":"left"},{default:t(()=>[n("CPU信息")]),_:1}),e(b,{"label-placement":"left","label-style":{width:"140px",color:"#1873D7",display:"inline-block",textAlign:"right",marginRight:"10px"}},{default:t(()=>[e(r,{label:"核心数"},{default:t(()=>[n(s(a.sysaudit||""),1)]),_:1}),e(r,{label:"CPU系统使用率"},{default:t(()=>[n(s(a.cpuusg||""),1)]),_:1}),e(r,{label:"CPU用户使用率"},{default:t(()=>[n(s(a.cpusysusg||""),1)]),_:1}),e(r,{label:"CPU当前等待率"},{default:t(()=>[n(s(a.cpuwait||""),1)]),_:1}),e(r,{label:"CPU当前空闲率"},{default:t(()=>[n(s(a.cpuidle||""),1)]),_:1})]),_:1}),e(g,{"title-placement":"left"},{default:t(()=>[n("内存信息")]),_:1}),e(b,{"label-placement":"left","label-style":{width:"140px",color:"#1873D7",display:"inline-block",textAlign:"right",marginRight:"10px"}},{default:t(()=>[e(r,{label:"内存总量（GB）"},{default:t(()=>[n(s(a.memrtal||""),1)]),_:1}),e(r,{label:"已用内存"},{default:t(()=>[n(s(a.usedmem||""),1)]),_:1}),e(r,{label:"剩余内存"},{default:t(()=>[n(s(a.resmem||""),1)]),_:1}),e(r,{label:"使用率"},{default:t(()=>[n(s(a.memrat||""),1)]),_:1})]),_:1}),e(g,{"title-placement":"left"},{default:t(()=>[n("系统信息")]),_:1}),e(b,{"label-placement":"left","label-style":{width:"140px",color:"#1873D7",display:"inline-block",textAlign:"right",marginRight:"10px"}},{default:t(()=>[e(r,{label:"服务器名称"},{default:t(()=>[n(s(a.servername||""),1)]),_:1}),e(r,{label:"操作系统"},{default:t(()=>[n(s(a.opersystem||""),1)]),_:1}),e(r,{label:"系统架构"},{default:t(()=>[n(s(a.architecture||""),1)]),_:1}),e(r,{label:"代理版本"},{default:t(()=>[n(s(a.proxyver||""),1)]),_:1})]),_:1}),e(g,{"title-placement":"left"},{default:t(()=>[n("系统文件信息")]),_:1}),e(y,{bordered:!1,"single-line":!1},{default:t(()=>[Ze,u("tbody",null,[u("tr",null,[u("td",null,s(a.dispath||""),1),u("td",null,s(a.distype||""),1),u("td",null,s(a.filetype||""),1),u("td",null,s(a.distal||""),1),u("td",null,s(a.disuse||""),1),u("td",null,s(a.distal-a.disuse),1),u("td",null,s(a.userat||""),1)])])]),_:1})]),_:1})]),_:1},8,["show"])}}}),Je=ge(He,[["__scopeId","data-v-0c758ac5"]]),Qe=j({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:T(["reset","search"],["update:model"]),setup(p,{emit:P}){const v=P,{formRef:d,restoreValidation:$}=L(),m=E(p,"model");function C(){m.value.status=void 0,v("search")}async function a(){await $(),v("reset")}async function f(){v("search")}return(U,_)=>{const I=ve,g=qe,r=Ke,b=x,y=Ge,M=H,B=Ee,z=J,A=Q;return S(),R(A,{bordered:!1,size:"small",class:"card-wrapper"},{default:t(()=>[e(z,{ref_key:"formRef",ref:d,model:m.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:be(f,["enter"])},{default:t(()=>[e(B,{responsive:"screen","item-responsive":""},{default:t(()=>[e(g,{span:"24 s:12 m:6",label:"在线状态",path:"status",class:"pr-24px"},{default:t(()=>[e(I,{filterable:"",clearable:"",value:m.value.status,"onUpdate:value":[_[0]||(_[0]=w=>m.value.status=w),f],placeholder:"请选择在线状态",options:o(he)(o(Re)),onClear:C},null,8,["value","options"])]),_:1}),e(g,{span:"24 m:6",class:"pr-24px"},{default:t(()=>[e(M,{class:"w-full"},{default:t(()=>[e(b,{onClick:a},{icon:t(()=>[e(r,{class:"text-icon"})]),default:t(()=>[n(" "+s(o(k)("common.reset")),1)]),_:1}),e(b,{type:"primary",ghost:"",onClick:f},{icon:t(()=>[e(y,{class:"text-icon"})]),default:t(()=>[n(" "+s(o(k)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),We={class:"min-h-500px flex-col-stretch gap-16px overflow-auto lt-sm:overflow-auto"};function Ye(p){return typeof p=="function"||Object.prototype.toString.call(p)==="[object Object]"&&!Se(p)}const ft=j({name:"collectionmanagement_agentserver",__name:"index",setup(p){const P=ye(),{columns:v,columnChecks:d,data:$,getData:m,loading:C,mobilePagination:a,searchParams:f,resetSearchParams:U}=Ue({apiFn:ze,apiParams:{page:1,pageSize:20,limit:20,status:null,_t:new Date().getTime()},immediate:!0,columns:()=>[{type:"selection",align:"center",width:48},{key:"pip",title:"IP",align:"center",width:200},{key:"status",title:"状态",align:"center",width:100,render:i=>{i.status===null?i.status=0:(i.status===2||i.status===3)&&(i.status=1);const l={1:"error",0:"success"},h=k(Pe[i.status]);return e(we,{type:l[i.status]},Ye(h)?h:{default:()=>[h]})}},{key:"dbtime",title:"更新时间",align:"center",width:160},{key:"uninstall",title:"卸载恢复",align:"center",width:200,render:i=>e(xe,{disabled:!0,value:i.uninstall,"onUpdate:value":l=>i.uninstall=l,"checked-value":0,"unchecked-value":1},null)},{key:"operate",title:k("common.operate"),align:"center",width:130,render:i=>e("div",{class:"flex-center gap-8px"},[e(x,{type:"primary",ghost:!0,size:"small",onClick:()=>te(i.id)},{default:()=>[n("详情")]})])}]}),{drawerVisible:_,operateType:I,editingData:g,handleAdd:r,handleEdit:b,checkedRowKeys:y,onBatchDeleted:M,onDeleted:B,closeDrawer:z}=Me($,m),A=async()=>{const{data:i,error:l}=await Fe();l||(D.centerIp=i)},w=q(!1),W=async()=>{var i,l;try{const{data:h,error:N}=await Ae(D.centerIp);N||(i=window.$message)==null||i.success("设置成功")}catch{(l=window.$message)==null||l.error("设置失败")}finally{w.value=!1}},D=X({centerIp:""}),Y={centerIp:[{required:!0,message:"IP不能为空",trigger:["input","blur"]},{required:!0,validator:$e,trigger:["input","blur"]}]},ee=async()=>{var i,l;try{const{data:h,error:N}=await Ve();N||(i=window.$message)==null||i.success("检测成功")}catch{(l=window.$message)==null||l.error("检测成功")}},G=q(),te=i=>{G.value=i,_.value=!0};return(i,l)=>{const h=ce,N=re,K=H,le=Le,ae=De,ne=Ne,se=J,oe=Z,ie=Q,V=ke("no-auth");return S(),Ce("div",We,[e(Qe,{model:o(f),"onUpdate:model":l[0]||(l[0]=c=>F(f)?f.value=c:null),onReset:o(U),onSearch:o(m)},null,8,["model","onReset","onSearch"]),e(ie,{title:"代理服务器",bordered:!1,size:"small",class:"sm:flex-1-hidden"},{"header-extra":t(()=>[e(K,null,{default:t(()=>[O((S(),R(o(x),{type:"info",ghost:"",size:"small",onClick:l[1]||(l[1]=c=>{w.value=!0,A()})},{default:t(()=>[n(" 设置中心IP ")]),_:1})),[[V,"proxy.server.centreip.select"]]),O((S(),R(o(x),{type:"info",ghost:"",size:"small",onClick:l[2]||(l[2]=c=>ee())},{default:t(()=>[n(" 一键检测 ")]),_:1})),[[V,"proxy.server.centreip.detection"]]),e(o(x),{size:"small",onClick:l[3]||(l[3]=c=>o(m)())},{icon:t(()=>[e(h,{class:Ie(["text-icon",{"animate-spin":o(C)}])},null,8,["class"])]),default:t(()=>[n(" "+s(o(k)("common.refresh")),1)]),_:1}),e(N,{columns:o(d),"onUpdate:columns":l[4]||(l[4]=c=>F(d)?d.value=c:null)},null,8,["columns"])]),_:1})]),default:t(()=>[e(le,{"checked-row-keys":o(y),"onUpdate:checkedRowKeys":l[5]||(l[5]=c=>F(y)?y.value=c:null),columns:o(v),data:o($),size:"small","flex-height":!o(P).isMobile,"scroll-x":962,loading:o(C),remote:"","row-key":c=>c.id,pagination:o(a),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(Je,{visible:o(_),"onUpdate:visible":l[6]||(l[6]=c=>F(_)?_.value=c:null),id:G.value,onSubmitted:o(m)},null,8,["visible","id","onSubmitted"]),e(oe,{show:w.value,"onUpdate:show":l[10]||(l[10]=c=>w.value=c),title:"代理服务器中心配置",preset:"card",class:"w-500px"},{footer:t(()=>[e(K,{justify:"end",size:16},{default:t(()=>[e(o(x),{onClick:l[8]||(l[8]=c=>w.value=!1)},{default:t(()=>[n(s(o(k)("common.cancel")),1)]),_:1}),O((S(),R(o(x),{type:"primary",onClick:l[9]||(l[9]=c=>W())},{default:t(()=>[n(s(o(k)("common.confirm")),1)]),_:1})),[[V,"proxy.server.centreip.insert"]])]),_:1})]),default:t(()=>[e(se,{model:D,rules:Y,"label-placement":"left","label-width":100},{default:t(()=>[e(ne,{label:"设置中心IP",path:"centerIp",class:"pr-24px"},{default:t(()=>[e(ae,{value:D.centerIp,"onUpdate:value":l[7]||(l[7]=c=>D.centerIp=c)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])]),_:1})])}}});export{ft as default};

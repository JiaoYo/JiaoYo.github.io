import{_ as E}from"./export-JteQWZNf.js";import{d as D,n as R,s as U,o as C,c as O,w as a,g as o,i as e,$ as t,W as $,ds as T,h as z,t as S,Z as q,B,N as M,O as L,ad as j,a3 as P,av as A,j as F,D as G,e as V,ah as I,E as W,ai as Z,aj as H}from"./index-Cx7KIf91.js";import{d as J,e as K}from"./system-log-C_0cxHR_.js";import{u as Q}from"./table-CXqkni0e.js";import{_ as X}from"./round-search-BI_CoZ5E.js";import{_ as Y}from"./round-refresh-H8vv-sLt.js";import{_ as ee}from"./lodash-DBno-G8B.js";import{_ as te}from"./FormItemGridItem-2AG1jRS6.js";import{_ as oe}from"./Grid-Cu_AT9np.js";const ae=D({name:"OptionlogSearch",__name:"optionlog-search",props:{model:{required:!0},modelModifiers:{}},emits:R(["reset","search"],["update:model"]),setup(p,{expose:y,emit:d}){const b=d,m=U(p,"model");function g(){b("reset")}function f(){b("search")}async function x(){const{data:h,error:r}=await J({status:m.value.status});if(!r){let _=h,n=new Blob([_],{type:"application/vnd.ms-excel"}),i=new Date().getTime()+".xls",s=window.webkitURL.createObjectURL(n),l=document.createElement("a");l.href=s,l.download=i,document.body.appendChild(l),l.click(),l.remove()}}const u=ee.debounce(f,1e3,{leading:!0,trailing:!1});return y({handleExportChange:x}),(h,r)=>{const _=q,n=te,i=Y,s=B,l=X,w=M,k=oe,v=L,c=j;return C(),O(c,{bordered:!1,size:"small",class:"card-wrapper"},{default:a(()=>[o(v,{model:m.value,"label-placement":"left","label-width":80,"show-feedback":!1},{default:a(()=>[o(k,{responsive:"screen","item-responsive":"","x-gap":12,"y-gap":12},{default:a(()=>[o(n,{span:"24 s:12 m:8 l:6",label:e(t)("page.systemlog.option.status"),path:"status"},{default:a(()=>[o(_,{filterable:"",clearable:"",value:m.value.status,"onUpdate:value":[r[0]||(r[0]=N=>m.value.status=N),f],placeholder:e(t)("page.systemlog.option.form.status"),options:e($)(e(T)),onClear:g},null,8,["value","placeholder","options"])]),_:1},8,["label"]),o(n,{span:"24 s:12 m:8 l:6"},{default:a(()=>[o(w,{class:"w-full"},{default:a(()=>[o(s,{onClick:g},{icon:a(()=>[o(i,{class:"text-icon"})]),default:a(()=>[z(" "+S(e(t)("common.reset")),1)]),_:1}),o(s,{type:"primary",ghost:"",onClick:e(u)},{icon:a(()=>[o(l,{class:"text-icon"})]),default:a(()=>[z(" "+S(e(t)("common.search")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),ne={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function se(p){return typeof p=="function"||Object.prototype.toString.call(p)==="[object Object]"&&!Z(p)}const ge=D({name:"logmanage_optionlog",__name:"index",setup(p){const y=P(),{columns:d,columnChecks:b,data:m,getData:g,loading:f,pagination:x,searchParams:u,resetSearchParams:h}=Q({apiFn:K,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,status:null,_t:new Date().getTime()},columns:()=>[{key:"creatorName",title:t("page.systemlog.option.creatorName"),align:"center",width:160,resizable:!0},{key:"operation",title:t("page.systemlog.option.operation"),width:140,align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"requestUri",title:t("page.systemlog.option.requestUri"),width:160,align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"requestTime",title:t("page.systemlog.option.requestTime")+"(ms)",width:120,align:"center",resizable:!0},{key:"status",title:t("page.systemlog.option.status"),width:100,align:"center",render:n=>{n.status==null&&(n.status=0);const i={0:"error",1:"primary"},s=t(T[n.status].label);return o(A,{size:"small",type:i[n.status]},se(s)?s:{default:()=>[s]})},resizable:!0},{key:"ip",title:t("page.systemlog.option.ip"),width:160,align:"center",resizable:!0},{key:"userAgent",title:t("page.systemlog.option.userAgent"),align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"createDate",title:t("page.systemlog.option.createDate"),width:160,align:"center"}]}),r=F(),_=()=>{r.value.handleExportChange()};return(n,i)=>{const s=E,l=B,w=H,k=j,v=G("no-auth");return C(),V("div",ne,[o(ae,{model:e(u),"onUpdate:model":i[0]||(i[0]=c=>I(u)?u.value=c:null),onReset:e(h),onSearch:e(g),ref_key:"searchRef",ref:r},null,8,["model","onReset","onSearch"]),o(k,{title:e(t)("page.systemlog.option.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":a(()=>[W((C(),O(l,{type:"info",size:"small",ghost:"",onClick:_},{icon:a(()=>[o(s,{class:"text-icon"})]),default:a(()=>[z(" "+S(e(t)("common.export")),1)]),_:1})),[[v,"sys:log:operation.export"]])]),default:a(()=>[o(w,{columns:e(d),data:e(m),size:"small","flex-height":!e(y).isMobile,"scroll-x":e(d).reduce((c,N)=>c+N.width,0),loading:e(f),remote:"","row-key":c=>c.id,pagination:e(x),class:"sm:h-full"},null,8,["columns","data","flex-height","scroll-x","loading","row-key","pagination"])]),_:1},8,["title"])])}}});export{ge as default};

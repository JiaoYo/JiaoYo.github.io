import{_ as Ge}from"./table-column-setting.vue_vue_type_script_setup_true_lang-EHNO_Faz.js";import{_ as He}from"./round-delete-De_Adgrb.js";import{_ as Ve}from"./round-add-Ceubgvwo.js";import{d as ge,aE as pe,m as Ce,r as Ke,H as T,n as De,a as Qe,aG as Ne,aC as Ye,bY as Se,cQ as Je,cR as Ze,c as f,o as c,w as l,f as a,a0 as We,C as ze,s as N,h as s,aD as me,v as P,b8 as Xe,aK as et,aL as tt,g as m,b as te,e as L,t as k,aI as at,B as U,aJ as lt,y as ye,$ as B,a1 as nt,cs as Ue,aO as fe,cG as ot,cS as st,aQ as rt,cT as it,A as ut,Z as Te,aS as dt,i as ct,q as ce,aT as re,aH as pt,x as ie,aU as mt,cU as be,ct as ft,ae as we,aY as vt}from"./index-ByRkKuMU.js";import{u as gt,a as yt}from"./table-VoODD8Rc.js";import{u as ve}from"./usePageData-DJSm323_.js";import{N as _t}from"./Cascader-HVipwO8h.js";import{_ as Pe}from"./Grid-CFg9gfMA.js";import{_ as $e}from"./FormItemGridItem-BCpPvk0p.js";import{_ as ht}from"./round-search-SxIJJabH.js";import{_ as bt}from"./round-refresh-_Q7iiaNa.js";import{N as ke}from"./Popconfirm-BARyXAms.js";const wt={key:0,style:{"margin-left":"20px"}},kt={key:0,style:{"margin-left":"20px"}},xt={key:0,style:{"margin-left":"20px"}},Ct={key:0,style:{"margin-left":"20px"}},Dt=ge({name:"OperateDrawer",__name:"operate-drawer",props:pe({operateType:{},rowData:{},pid:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:pe(["submitted"],["update:visible"]),setup($,{emit:H}){const C=H,I=Ce(),g=$,t=Ke(S());function S(){return{pid:void 0,cid:void 0,contractId:void 0,id:"",devname:"",devmodel:"",devunit:"",devnum:0,notes:"",etype:0,devmanu:"",status:0,re1:"",re2:"",re3:"",re4:"",fl1:"",fl2:"",fl3:"",fl4:""}}const y=T([]),{pageData:_,getData:z,nextPage:j}=ve(Ue),V=async n=>{const e=n.currentTarget,u=e.scrollTop;e.scrollTop+e.offsetHeight>=e.scrollHeight&&_.data.length<_.total&&(await j(),y.value=_.data,await fe(),setTimeout(()=>{e.scrollTop=u}))},K=async()=>{await z({page:1}),y.value=_.data},Q=async()=>{var n,e;await z({fuzzy:I.userInfo.pname,page:1}),t.pid=g.pid?g.pid:(n=_.data[0])==null?void 0:n.id,y.value=_.data,await D(),t.contractId=(e=d.value[0])==null?void 0:e.id,R()},E=T([]),w=T(),{pageData:A,getData:Y,nextPage:J}=ve(ot),R=async(n=t.contractId)=>{await Y({pids:n}),w.value=[],E.value=Array.from(new Set([...E.value,...A.data])),w.value=A.data.map(e=>({label:e.devname,value:e.id}))},p=async n=>{var e;t.pid=n,await D(),t.contractId=(e=d.value[0])==null?void 0:e.id,await R(),t.cid=null},d=T([]),D=async()=>{const{data:n,error:e}=await st({id:t.pid,limit:100,page:1});d.value=n==null?void 0:n.list.map(u=>({value:u.id,label:u.contractname,isLeaf:!1}))},q=T(),Z=async n=>{t.cid=n;const e=E.value.find(u=>u.id==n);t.devname=e==null?void 0:e.devname,t.devnum=e==null?void 0:e.devcount,q.value=e==null?void 0:e.devcount,t.etype=e==null?void 0:e.devtype,t.devmanu=e==null?void 0:e.devmanu,t.notes=e==null?void 0:e.notes,t.devmodel=e==null?void 0:e.devmodel,t.devunit=e==null?void 0:e.devunit},o=T(0),r=T("");async function v({file:n},e){o.value=0,r.value=e;const u=await rt(n.file,n.name,"",h=>{o.value=h});u&&(t[e]=u,o.value=0)}async function O(){var n;if(await Q(),Object.assign(t,S()),g.operateType==="add"&&(t.pid=g.pid),g.operateType==="edit"&&g.rowData){Object.assign(t,g.rowData),q.value=(n=A.data.find(h=>h.id==t.cid))==null?void 0:n.devcount;const{data:e,error:u}=await it(t.cid);u||d.value.push({value:e.id,label:e.devname,disabled:!0,isLeaf:!0,hidden:!0})}}const{formRef:W,validate:X,restoreValidation:ee}=De(),M={pid:{type:"number",required:!0,trigger:["blur","change"],message:"请选择"},contractId:{type:"number",required:!0,trigger:["blur","change"],message:"请选择"},cid:{type:"number",required:!0,trigger:["blur","change"],message:"请选择"},devname:{type:"string",required:!0,trigger:["blur","change"],message:"请输入"},devmodel:{type:"string",required:!0,trigger:["blur","change"],message:"请输入"},devnum:{type:"number",required:!0,trigger:["blur","change"],message:"请输入"},devunit:{type:"string",required:!0,trigger:["blur","change"],message:"请输入"}},ae=async n=>{var e;await R(n.value),n.children=(e=w.value)==null?void 0:e.map(u=>({label:u.label,value:u.value,isLeaf:!0}))},x=Qe(()=>({add:"新增设备",edit:"修改设备"})[g.operateType]),G=Ne($,"visible"),qe=async n=>{if(n){await fe();const e=document.querySelector(".n-cascader-menu");e&&(e.removeEventListener("scroll",_e),e.addEventListener("scroll",_e))}},ue=T(!1),Fe=T(!0),_e=async n=>{const e=n.target;e.scrollHeight-e.scrollTop-e.clientHeight<10&&!ue.value&&Fe.value&&(ue.value=!0,J(),w.value=A.data.map(h=>({label:h.devname,value:h.id})),ue.value=!1)};Ye(G,()=>{G.value&&(O(),setTimeout(()=>{const n=document.querySelector(".n-scrollbar-content");n==null||n.scrollTo(0,0)},300),ee())});async function le(n){if(n)try{const u=await(await fetch(n==null?void 0:n.split("?")[0],{mode:"cors"})).blob(),h=URL.createObjectURL(u),F=document.createElement("a");F.href=h,F.download=n==null?void 0:n.split("?")[1],F.style.display="none",document.body.appendChild(F),F.click(),document.body.removeChild(F),URL.revokeObjectURL(h)}catch(e){console.error("下载失败:",e)}}function de(){G.value=!1}const Le=Se.debounce(async()=>{await Re()},1e3,{leading:!0,trailing:!1});async function Re(){var n,e;if(await X(),g.operateType==="edit"){const{data:u,error:h}=await Je([t]);h||(de(),C("submitted"),(n=window.$message)==null||n.success("修改成功"))}else{const{data:u,error:h}=await Ze([{...t}]);h||(de(),C("submitted"),(e=window.$message)==null||e.success("添加成功"))}}async function ne(n){var e;return n.file.file.size>100*1024*1024?((e=window.$message)==null||e.error("文件大小不能超过100M"),!1):!0}const Be=n=>n.hidden?null:n.label,Ie=n=>n.option.hidden?null:n.node;return(n,e)=>{const u=$e,h=_t,F=tt,je=et,oe=at,se=lt,he=Pe,Ee=ze,Ae=We,Oe=ye,Me=nt;return c(),f(Me,{show:G.value,"onUpdate:show":e[22]||(e[22]=i=>G.value=i),title:x.value,preset:"card",class:"w-800px","mask-closable":!1,draggable:!0},{footer:l(()=>[a(Oe,{justify:"end",size:16},{default:l(()=>[a(s(U),{onClick:de},{default:l(()=>[m(k(s(B)("common.cancel")),1)]),_:1}),a(s(U),{type:"primary",onClick:s(Le)},{default:l(()=>[m(k(s(B)("common.confirm")),1)]),_:1},8,["onClick"])]),_:1})]),default:l(()=>[a(Ae,{class:"pr-20px"},{default:l(()=>[a(Ee,{ref_key:"formRef",ref:W,model:t,rules:M,"label-placement":"left","label-width":120},{default:l(()=>[a(he,{responsive:"screen","item-responsive":""},{default:l(()=>[a(u,{span:"24 m:12",label:"项目列表",path:"pid"},{default:l(()=>[a(s(me),{clearable:"",filterable:"",value:t.pid,"onUpdate:value":[e[0]||(e[0]=i=>t.pid=i),p],placeholder:"请选择项目","label-field":"proname","value-field":"id",onClear:K,options:y.value,onScroll:V},null,8,["value","options"])]),_:1}),a(u,{span:"24 m:12",label:"绑定合同设备",path:"cid"},{default:l(()=>[a(h,{value:t.cid,"onUpdate:value":[e[1]||(e[1]=i=>t.cid=i),Z],placeholder:"请选择合同设备",options:d.value,"render-label":Be,"render-suffix":Ie,"check-strategy":"child","show-path":!1,labelKey:"label",remote:"","on-load":ae,"onUpdate:show":qe},null,8,["value","options"])]),_:1}),t.cid?(c(),f(u,{key:0,span:"24 m:12",label:"设备名称",path:"devname"},{default:l(()=>[a(s(P),{value:t.devname,"onUpdate:value":e[2]||(e[2]=i=>t.devname=i),clearable:"",placeholder:"请输入"},null,8,["value"])]),_:1})):N("",!0),t.cid?(c(),f(u,{key:1,span:"24 m:12",label:"数量",path:"devnum"},{default:l(()=>[a(s(Xe),{value:t.devnum,"onUpdate:value":e[3]||(e[3]=i=>t.devnum=i),placeholder:"请输入",max:q.value,style:{width:"100%"}},null,8,["value","max"])]),_:1})):N("",!0),t.cid?(c(),f(u,{key:2,span:"24 m:12",label:"设备单位",path:"devunit"},{default:l(()=>[a(s(P),{value:t.devunit,"onUpdate:value":e[4]||(e[4]=i=>t.devunit=i),placeholder:"请输入",readonly:""},null,8,["value"])]),_:1})):N("",!0),t.cid?(c(),f(u,{key:3,span:"24 m:12",label:"型号",path:"devmodel"},{default:l(()=>[a(s(P),{value:t.devmodel,"onUpdate:value":e[5]||(e[5]=i=>t.devmodel=i),placeholder:"请输入",readonly:""},null,8,["value"])]),_:1})):N("",!0),t.cid?(c(),f(u,{key:4,span:"24 m:12",label:"是否为我司设备",path:"etype"},{default:l(()=>[a(je,{value:t.etype,"onUpdate:value":e[6]||(e[6]=i=>t.etype=i),name:"radiogroup",disabled:""},{default:l(()=>[a(F,{value:0},{default:l(()=>e[23]||(e[23]=[m("是")])),_:1,__:[23]}),a(F,{value:1},{default:l(()=>e[24]||(e[24]=[m("否")])),_:1,__:[24]})]),_:1},8,["value"])]),_:1})):N("",!0),t.cid?(c(),f(u,{key:5,span:"24 m:12",label:"设备厂家",path:"devmanu"},{default:l(()=>[a(s(P),{value:t.devmanu,"onUpdate:value":e[7]||(e[7]=i=>t.devmanu=i),placeholder:"请输入",readonly:""},null,8,["value"])]),_:1})):N("",!0),g.operateType=="edit"?(c(),f(u,{key:6,span:"24 m:12",label:"清点状态",path:"status"},{default:l(()=>[a(s(me),{clearable:"",value:t.status,"onUpdate:value":e[8]||(e[8]=i=>t.status=i),placeholder:"请选择",options:[{label:"未清点",value:0},{label:"正常",value:1},{label:"增补",value:2},{label:"退货",value:3},{label:"换货",value:4}]},null,8,["value"])]),_:1})):N("",!0),t.cid?(c(),f(u,{key:7,span:"24 m:12",label:"备注",path:"notes"},{default:l(()=>[a(s(P),{value:t.notes,"onUpdate:value":e[9]||(e[9]=i=>t.notes=i),placeholder:"请输入"},null,8,["value"])]),_:1})):N("",!0),a(u,{span:"24 m:24",label:"",path:"notes","show-feedback":!1},{default:l(()=>[a(he,{responsive:"screen","item-responsive":""},{default:l(()=>[a(u,{span:"24 m:12",label:"附件1",path:"notes"},{default:l(()=>[a(s(P),{value:t.re1,"onUpdate:value":e[10]||(e[10]=i=>t.re1=i),placeholder:"请输入",style:{width:"250px"}},null,8,["value"])]),_:1}),a(u,{span:"24 m:12",label:"",path:"notes"},{default:l(()=>{var i;return[t.fl1?(c(),te("span",wt,[m(k((i=t.fl1)==null?void 0:i.split("?")[1])+" ",1),L("span",{class:"cursor-pointer c-#c92a2a",onClick:e[11]||(e[11]=b=>t.fl1="")},"删除"),L("span",{class:"cursor-pointer c-#1890ff ml-5px inline-block",onClick:e[12]||(e[12]=b=>le(t.fl1))},"下载")])):(c(),f(oe,{key:1,style:{width:"auto","margin-left":"20px"},ref:"uploadRef",action:"#","custom-request":b=>v(b,"fl1"),"show-file-list":!1,onBeforeUpload:ne},{default:l(()=>[a(s(U),{loading:o.value>0&&!t.fl1&&r.value=="fl1",size:"small",ghost:"",type:"primary"},{default:l(()=>[m(k(o.value>0&&!t.fl1&&r.value=="fl1"?"上传中":"选择文件"),1)]),_:1},8,["loading"])]),_:1},8,["custom-request"])),o.value&&!t.fl1&&r.value=="fl1"?(c(),f(se,{key:2,type:"line",percentage:o.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):N("",!0)]}),_:1})]),_:1})]),_:1}),a(u,{span:"24 m:12",label:"附件2",path:"notes"},{default:l(()=>[a(s(P),{value:t.re2,"onUpdate:value":e[13]||(e[13]=i=>t.re2=i),placeholder:"请输入",style:{width:"250px"}},null,8,["value"])]),_:1}),a(u,{span:"24 m:12",label:"",path:"notes"},{default:l(()=>{var i;return[t.fl2?(c(),te("span",kt,[m(k((i=t.fl2)==null?void 0:i.split("?")[1])+" ",1),L("span",{class:"cursor-pointer c-#c92a2a",onClick:e[14]||(e[14]=b=>t.fl2="")},"删除"),L("span",{class:"cursor-pointer c-#1890ff ml-5px inline-block",onClick:e[15]||(e[15]=b=>le(t.fl2))},"下载")])):(c(),f(oe,{key:1,style:{width:"auto","margin-left":"20px"},ref:"uploadRef",action:"#","custom-request":b=>v(b,"fl2"),"show-file-list":!1,onBeforeUpload:ne},{default:l(()=>[a(s(U),{loading:o.value>0&&!t.fl2&&r.value=="fl2",size:"small",ghost:"",type:"primary"},{default:l(()=>[m(k(o.value>0&&!t.fl2&&r.value=="fl2"?"上传中":"选择文件"),1)]),_:1},8,["loading"])]),_:1},8,["custom-request"])),o.value&&!t.fl2&&r.value=="fl2"?(c(),f(se,{key:2,type:"line",percentage:o.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):N("",!0)]}),_:1}),a(u,{span:"24 m:12",label:"附件3",path:"notes"},{default:l(()=>[a(s(P),{value:t.re3,"onUpdate:value":e[16]||(e[16]=i=>t.re3=i),placeholder:"请输入",style:{width:"250px"}},null,8,["value"])]),_:1}),a(u,{span:"24 m:12",label:"",path:"notes"},{default:l(()=>{var i;return[t.fl3?(c(),te("span",xt,[m(k((i=t.fl3)==null?void 0:i.split("?")[1])+" ",1),L("span",{class:"cursor-pointer c-#c92a2a",onClick:e[17]||(e[17]=b=>t.fl3="")},"删除"),L("span",{class:"cursor-pointer c-#1890ff ml-5px inline-block",onClick:e[18]||(e[18]=b=>le(t.fl3))},"下载")])):(c(),f(oe,{key:1,style:{width:"auto","margin-left":"20px"},ref:"uploadRef",action:"#","custom-request":b=>v(b,"fl3"),"show-file-list":!1,onBeforeUpload:ne},{default:l(()=>[a(s(U),{loading:o.value>0&&!t.fl3&&r.value=="fl3",size:"small",ghost:"",type:"primary"},{default:l(()=>[m(k(o.value>0&&!t.fl3&&r.value=="fl3"?"上传中":"选择文件"),1)]),_:1},8,["loading"])]),_:1},8,["custom-request"])),o.value&&!t.fl3&&r.value=="fl3"?(c(),f(se,{key:2,type:"line",percentage:o.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):N("",!0)]}),_:1}),a(u,{span:"24 m:12",label:"附件4",path:"notes"},{default:l(()=>[a(s(P),{value:t.re4,"onUpdate:value":e[19]||(e[19]=i=>t.re4=i),placeholder:"请输入",style:{width:"250px"}},null,8,["value"])]),_:1}),a(u,{span:"24 m:12",label:"",path:"notes"},{default:l(()=>{var i;return[t.fl4?(c(),te("span",Ct,[m(k((i=t.fl4)==null?void 0:i.split("?")[1])+" ",1),L("span",{class:"cursor-pointer c-#c92a2a",onClick:e[20]||(e[20]=b=>t.fl4="")},"删除"),L("span",{class:"cursor-pointer c-#1890ff ml-5px inline-block",onClick:e[21]||(e[21]=b=>le(t.fl4))},"下载")])):(c(),f(oe,{key:1,style:{width:"auto","margin-left":"20px"},ref:"uploadRef",action:"#","custom-request":b=>v(b,"fl4"),"show-file-list":!1,onBeforeUpload:ne},{default:l(()=>[a(s(U),{loading:o.value>0&&!t.fl4&&r.value=="fl4",size:"small",ghost:"",type:"primary"},{default:l(()=>[m(k(o.value>0&&!t.fl4&&r.value=="fl4"?"上传中":"选择文件"),1)]),_:1},8,["loading"])]),_:1},8,["custom-request"])),o.value&&!t.fl4&&r.value=="fl4"?(c(),f(se,{key:2,type:"line",percentage:o.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):N("",!0)]}),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show","title"])}}}),Nt=ge({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:pe(["reset","search","clear"],["update:model"]),setup($,{emit:H}){const C=H,{formRef:I,restoreValidation:g}=De(),t=Ne($,"model"),S=Ce(),y=T([]),{pageData:_,getData:z,nextPage:j}=ve(Ue),V=async p=>{const d=p.currentTarget,D=d.scrollTop;d.scrollTop+d.offsetHeight>=d.scrollHeight&&_.data.length<_.total&&(await j(),y.value=_.data,await fe(),setTimeout(()=>{d.scrollTop=D}))},K=async p=>{var d;p?(t.value.pid=p,C("search"),S.setProjectInfo({pname:(d=y.value.find(D=>D.id==p))==null?void 0:d.proname,pid:p})):C("clear")},Q=Se.debounce(async p=>{await z({fuzzy:p,page:1}),y.value=_.data},300),E=p=>{if(!p){t.value.pid=null,w();return}Q(p)},w=async()=>{await z({page:1}),y.value=_.data};(async()=>{var p,d;await z({fuzzy:S.userInfo.pname}),y.value=_.data,t.value.pid=S.userInfo.pid?S.userInfo.pid:(p=y.value[0])==null?void 0:p.id,S.setProjectInfo({pid:t.value.pid,pname:(d=y.value.find(D=>D.id==t.value.pid))==null?void 0:d.proname}),C("search")})();async function Y(){await g(),t.value.fuzzy="",C("reset")}const J=()=>{t.value.fuzzy="",C("search")};async function R(){var p,d;t.value.pid?C("search"):((p=window.$message)==null||p.destroyAll(),(d=window.$message)==null||d.warning("请选择项目"))}return(p,d)=>{const D=me,q=$e,Z=P,o=bt,r=U,v=ht,O=ye,W=Pe,X=ze,ee=Te;return c(),f(ee,{bordered:!1,size:"small",class:"card-wrapper"},{default:l(()=>[a(X,{ref_key:"formRef",ref:I,model:t.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:ut(R,["enter"])},{default:l(()=>[a(W,{responsive:"screen","item-responsive":"","x-gap":16,"y-gap":16},{default:l(()=>[a(q,{span:"24 s:12 m:6",label:"项目列表",path:"PrjId"},{default:l(()=>[a(D,{filterable:"",clearable:"",value:t.value.pid,"onUpdate:value":[d[0]||(d[0]=M=>t.value.pid=M),K],placeholder:"请选择项目","label-field":"proname","value-field":"id",options:y.value,onScroll:V,onClear:w,onSearch:E},null,8,["value","options"])]),_:1}),a(q,{span:"24 s:12 m:6",label:"设备名称",path:"fuzzy"},{default:l(()=>[a(Z,{value:t.value.fuzzy,"onUpdate:value":d[1]||(d[1]=M=>t.value.fuzzy=M),placeholder:"请输入",clearable:"",onClear:J},null,8,["value"])]),_:1}),a(q,{span:"24  s:12 m:6",class:"pr-24px"},{default:l(()=>[a(O,{class:"w-full"},{default:l(()=>[a(r,{onClick:Y},{icon:l(()=>[a(o,{class:"text-icon"})]),default:l(()=>[m(" "+k(s(B)("common.reset")),1)]),_:1}),a(r,{type:"primary",ghost:"",onClick:R},{icon:l(()=>[a(v,{class:"text-icon"})]),default:l(()=>[m(" "+k(s(B)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),St={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function xe($){return typeof $=="function"||Object.prototype.toString.call($)==="[object Object]"&&!vt($)}const Et=ge({name:"projectmanagement_device",__name:"index",setup($){const H=dt(),{columns:C,columnChecks:I,data:g,getData:t,loading:S,pagination:y,mobilePagination:_,searchParams:z}=gt({showTotal:!0,immediate:!1,apiFn:ft,apiParams:{page:1,pageSize:20,limit:20,fuzzy:"",_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48},{key:"devname",title:"设备名称",align:"center",width:180},{key:"devmodel",title:"型号",align:"center",width:160},{key:"devnum",title:"数量",align:"center",width:80},{key:"devunit",title:"设备单位",align:"center",width:100},{key:"etype",title:"是否为我司设备",align:"center",width:120,render(o){return we("div",{},o.etype==0?"是":"否")}},{key:"devmanu",title:"设备厂家",align:"center",width:100},{key:"status",title:"清点状态",align:"center",width:100,render(o){return we("div",{},o.status==0?"未清点":o.status==1?"正常":o.status==2?"增补":o.status==3?"退货":"换货")}},{key:"notes",title:"备注",align:"center",width:120},{key:"dusername",title:"清点信息",align:"left",width:200,render(o){return a("div",{style:"display:flex; flex-direction:column; gap:3px; line-height:1.4;"},[a("div",null,[a("span",{style:"color:#666"},[m("清点人：")]),a("span",{style:"font-weight:500"},[o.dusername||"-"])]),a("div",null,[a("span",{style:"color:#666"},[m("时间：")]),a("span",{style:" font-weight:500"},[o.ddbtime||"-"])])])}},{key:"username",title:"创建信息",align:"left",width:200,render(o){return a("div",{style:"display:flex; flex-direction:column; gap:3px; line-height:1.4;"},[a("div",null,[a("span",{style:"color:#666"},[m("创建人：")]),a("span",{style:"font-weight:500"},[o.username||"-"])]),a("div",null,[a("span",{style:"color:#666"},[m("时间：")]),a("span",{style:" font-weight:500"},[o.dbtime||"-"])])])}},{key:"operate",title:B("common.operate"),align:"center",width:140,fixed:"right",render:o=>{let r;return a("div",{class:"flex-center gap-8px"},[ie(a(U,{type:"primary",ghost:!0,size:"small",onClick:()=>p(o.id)},xe(r=B("common.edit"))?r:{default:()=>[r]}),[[ce("no-auth"),"project:Equipment:update"]]),a(ke,{onPositiveClick:()=>R(o.id)},{default:()=>B("common.confirmDelete"),trigger:()=>{let v;return ie(a(U,{type:"error",ghost:!0,size:"small"},xe(v=B("common.delete"))?v:{default:()=>[v]}),[[ce("no-auth"),"project:Equipment:delete"]])}})])}}]}),{drawerVisible:j,operateType:V,editingData:K,handleAdd:Q,handleEdit:E,checkedRowKeys:w,onBatchDeleted:A,onDeleted:Y}=yt(g,t);ct(async()=>{});async function J(){console.log(w.value),d(w.value.join(","),o=>{A()})}async function R(o){const{data:r,error:v}=await be(o);v||Y()}function p(o){E(o)}async function d(o,r){const{data:v,error:O}=await be(o);if(!O)r&&r(v);else return!1}const D=()=>{g.value=[],y.itemCount=0},q=o=>{t()},Z=()=>{t()};return(o,r)=>{const v=ye,O=Ve,W=He,X=Ge,ee=pt,M=Te,ae=ce("no-auth");return c(),te("div",St,[a(Nt,{model:s(z),"onUpdate:model":r[0]||(r[0]=x=>re(z)?z.value=x:null),onReset:Z,onSearch:s(t),onClear:D},null,8,["model","onSearch"]),a(M,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:l(()=>[a(v,{align:"center",wrap:"",class:"lt-sm:w-200px"},{default:l(()=>r[4]||(r[4]=[L("div",null,"待调试设备",-1)])),_:1,__:[4]})]),"header-extra":l(()=>[a(v,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:l(()=>[ie((c(),f(s(U),{onClick:s(Q),size:"small",ghost:"",type:"primary"},{icon:l(()=>[a(O,{class:"text-icon"})]),default:l(()=>[r[5]||(r[5]=m(" "+k("新增")))]),_:1,__:[5]},8,["onClick"])),[[ae,"project:Equipment:insert"]]),a(s(ke),{onPositiveClick:J},{trigger:l(()=>[ie((c(),f(s(U),{size:"small",ghost:"",type:"error",disabled:s(w).length==0},{icon:l(()=>[a(W,{class:mt(["text-icon",{"animate-spin":s(S)}])},null,8,["class"])]),default:l(()=>[r[6]||(r[6]=m(" "+k("批量删除")))]),_:1,__:[6]},8,["disabled"])),[[ae,"project:Equipment:delete"]])]),default:l(()=>[r[7]||(r[7]=m(" 确定要删除选中的设备吗？ "))]),_:1,__:[7]}),a(X,{columns:s(I),"onUpdate:columns":r[1]||(r[1]=x=>re(I)?I.value=x:null)},null,8,["columns"])]),_:1})]),default:l(()=>[a(ee,{"checked-row-keys":s(w),"onUpdate:checkedRowKeys":r[2]||(r[2]=x=>re(w)?w.value=x:null),columns:s(C),data:s(g),size:"small","flex-height":!s(H).isMobile,loading:s(S),remote:"","row-key":x=>x.id,"scroll-x":s(C).reduce((x,G)=>x+(G.width||100),0),pagination:s(_),class:"sm:h-full","onUpdate:filters":q},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","scroll-x","pagination"]),a(Dt,{visible:s(j),"onUpdate:visible":r[3]||(r[3]=x=>re(j)?j.value=x:null),onSubmitted:s(t),pid:s(z).pid,"operate-type":s(V),"row-data":s(K)},null,8,["visible","onSubmitted","pid","operate-type","row-data"])]),_:1})])}}});export{Et as default};

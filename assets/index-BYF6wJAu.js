import{_ as re,a as ue}from"./close-small-rounded-C6Jdm4jC.js";import{d as P,v as K,r as A,J as ye,K as R,o as h,c as $,w as n,f as x,g as e,h as c,L as N,aV as de,C as j,B as E,aj as X,aZ as ce,E as O,D as J,S as he,ax as Z,j as B,t as q,a9 as L,e as F,ai as pe,a_ as ke,a$ as we,at as Ce,A as W,aS as xe,N as I,i as S,b0 as Q,b1 as Y,ar as me,b2 as ee,b3 as te,X as z,am as $e,b4 as _e,y as Te,b5 as Se,b6 as Ue,P as De,ap as Ve,aq as Ne}from"./index-COCU-dRC.js";import{h as Ie,i as Ee,j as qe,k as Be,l as Pe,m as Oe,n as Me,o as je,p as Ge,q as Fe,r as Ae,s as Re,t as Le,u as Je,v as ze,w as We,x as He,y as Ke,z as Xe,A as Ze,B as Qe,C as Ye,D as et,E as tt,F as nt,G as at}from"./basic-config-CigqUKbC.js";import{_ as fe}from"./Table-V2U-WvB9.js";import{f as ne}from"./reportForm-BtvdI97H.js";import{f as ae}from"./scheduleTask-CWKPKXif.js";import{b as lt,a as st,_ as le}from"./DataTable-W68blcrm.js";import{_ as ot}from"./DatePicker-C8CF71gD.js";import{_ as se}from"./TimePicker-hUC2kxSD.js";import{u as oe}from"./table-DBL-1SAi.js";import{_ as it}from"./FormItemGridItem-BgX6gCvp.js";import{_ as rt}from"./Grid-DXM2gQBE.js";import{_ as ut}from"./Popconfirm-DYcjMzR5.js";import{_ as ge}from"./Upload-BGb7fzaY.js";import{u as dt}from"./usePageData-YwCZ_Txz.js";import{a as ct}from"./events-CLAzewCH.js";import"./Forward-Cj8r8vQs.js";import"./defineProperty-rwZg3Jcs.js";import"./Progress-mNtdJSDf.js";const pt={class:"flex justify-center"},mt=P({name:"basicConfig",__name:"basicConfig",setup(M){const{formRef:u,validate:b,restoreValidation:l}=K(),i=A(w());function w(){return{enablelock:1,locktime:5,lockcount:3,unlockeanble:1,unlocktime:5,aceffective:1,pwdexpire:1,expiretime:1,cputhreshold:80,memthreshold:80,captcha:1,tokentime:30}}const C={type:"number",required:!0,message:"不能为空",trigger:["blur","change"]},v={locktime:C,lockcount:C,unlocktime:C,expiretime:C,cputhreshold:C,memthreshold:C,tokentime:C},_=async()=>{const{data:s,error:a}=await Ie();a||Object.assign(i,s)};ye(()=>{_()});const t=async()=>{var a;await b();const{error:s}=await Ee(i);s||(a=window.$message)==null||a.success("设置成功")};return(s,a)=>{const g=de,p=j,o=E,f=X,m=ce,d=O,y=J,k=he,T=R("no-auth");return h(),$(k,{style:{"max-height":"calc(100vh - 245px)"}},{default:n(()=>[x("div",pt,[e(y,{ref_key:"formRef",ref:u,"label-width":180,"label-placement":"left",model:i,rules:v},{default:n(()=>[e(p,{label:"是否开启账号锁定",path:"enablelock"},{default:n(()=>[e(g,{value:i.enablelock,"onUpdate:value":a[0]||(a[0]=r=>i.enablelock=r),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),e(p,{label:"锁定周期",path:"locktime"},{default:n(()=>[e(m,{class:"flex items-center"},{default:n(()=>[e(o,{onClick:a[1]||(a[1]=r=>i.locktime--),disabled:i.locktime==1},{default:n(()=>[c(" − ")]),_:1},8,["disabled"]),e(f,{"show-button":!1,value:i.locktime,"onUpdate:value":a[2]||(a[2]=r=>i.locktime=r),placeholder:"",min:1,max:5},null,8,["value"]),e(o,{onClick:a[3]||(a[3]=r=>i.locktime++),disabled:i.locktime==5,class:"mr-5px"},{default:n(()=>[c(" + ")]),_:1},8,["disabled"]),c(" 分钟 ")]),_:1})]),_:1}),e(p,{label:"锁定次数",path:"lockcount"},{default:n(()=>[e(m,{class:"flex items-center"},{default:n(()=>[e(o,{onClick:a[4]||(a[4]=r=>i.lockcount--),disabled:i.lockcount==2},{default:n(()=>[c(" − ")]),_:1},8,["disabled"]),e(f,{"show-button":!1,value:i.lockcount,"onUpdate:value":a[5]||(a[5]=r=>i.lockcount=r),placeholder:"",min:2,max:5},null,8,["value"]),e(o,{onClick:a[6]||(a[6]=r=>i.lockcount++),disabled:i.lockcount==5,class:"mr-5px"},{default:n(()=>[c(" + ")]),_:1},8,["disabled"]),c(" 次 ")]),_:1})]),_:1}),e(p,{label:"是否开启自动解锁",path:"unlockeanble"},{default:n(()=>[e(g,{value:i.unlockeanble,"onUpdate:value":a[7]||(a[7]=r=>i.unlockeanble=r),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),e(p,{label:"解锁时间",path:"unlocktime"},{default:n(()=>[e(m,{class:"flex items-center"},{default:n(()=>[e(o,{onClick:a[8]||(a[8]=r=>i.unlocktime--),disabled:i.unlocktime==i.locktime},{default:n(()=>[c(" − ")]),_:1},8,["disabled"]),e(f,{"show-button":!1,value:i.unlocktime,"onUpdate:value":a[9]||(a[9]=r=>i.unlocktime=r),placeholder:"",min:i.locktime},null,8,["value","min"]),e(o,{onClick:a[10]||(a[10]=r=>i.unlocktime++),class:"mr-5px"},{default:n(()=>[c(" + ")]),_:1}),c(" 分钟 ")]),_:1})]),_:1}),e(p,{label:"是否开启账号有效期登录",path:"aceffective"},{default:n(()=>[e(g,{value:i.aceffective,"onUpdate:value":a[11]||(a[11]=r=>i.aceffective=r),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),e(p,{label:"是否开启密码过期",path:"pwdexpire"},{default:n(()=>[e(g,{value:i.pwdexpire,"onUpdate:value":a[12]||(a[12]=r=>i.pwdexpire=r),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),e(p,{label:"密码过期时间",path:"expiretime"},{default:n(()=>[e(m,{class:"flex items-center"},{default:n(()=>[e(o,{onClick:a[13]||(a[13]=r=>i.expiretime--),disabled:i.expiretime==1},{default:n(()=>[c(" − ")]),_:1},8,["disabled"]),e(f,{"show-button":!1,value:i.expiretime,"onUpdate:value":a[14]||(a[14]=r=>i.expiretime=r),placeholder:"",min:1},null,8,["value"]),e(o,{onClick:a[15]||(a[15]=r=>i.expiretime++),class:"mr-5px"},{default:n(()=>[c(" + ")]),_:1}),c(" 天 ")]),_:1})]),_:1}),e(p,{label:"CPU阈值",path:"cputhreshold"},{default:n(()=>[e(m,{class:"flex items-center"},{default:n(()=>[e(o,{onClick:a[16]||(a[16]=r=>i.cputhreshold--),disabled:i.cputhreshold==0},{default:n(()=>[c(" − ")]),_:1},8,["disabled"]),e(f,{"show-button":!1,value:i.cputhreshold,"onUpdate:value":a[17]||(a[17]=r=>i.cputhreshold=r),placeholder:"",min:0,max:100},null,8,["value"]),e(o,{onClick:a[18]||(a[18]=r=>i.cputhreshold++),disabled:i.cputhreshold==100,class:"mr-5px"},{default:n(()=>[c(" + ")]),_:1},8,["disabled"]),c(" % ")]),_:1})]),_:1}),e(p,{label:"MEM阈值",path:"memthreshold"},{default:n(()=>[e(m,{class:"flex items-center"},{default:n(()=>[e(o,{onClick:a[19]||(a[19]=r=>i.memthreshold--),disabled:i.memthreshold==0},{default:n(()=>[c(" − ")]),_:1},8,["disabled"]),e(f,{"show-button":!1,value:i.memthreshold,"onUpdate:value":a[20]||(a[20]=r=>i.memthreshold=r),placeholder:"",min:0,max:100},null,8,["value"]),e(o,{onClick:a[21]||(a[21]=r=>i.memthreshold++),disabled:i.memthreshold==100,class:"mr-5px"},{default:n(()=>[c(" + ")]),_:1},8,["disabled"]),c(" % ")]),_:1})]),_:1}),e(p,{label:"是否开启验证码",path:"captcha"},{default:n(()=>[e(g,{value:i.captcha,"onUpdate:value":a[22]||(a[22]=r=>i.captcha=r),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),e(p,{label:"token过期时间",path:"tokentime"},{default:n(()=>[e(m,{class:"flex items-center"},{default:n(()=>[e(o,{onClick:a[23]||(a[23]=r=>i.tokentime--),disabled:i.tokentime==1},{default:n(()=>[c(" − ")]),_:1},8,["disabled"]),e(f,{"show-button":!1,value:i.tokentime,"onUpdate:value":a[24]||(a[24]=r=>i.tokentime=r),placeholder:"",min:1},null,8,["value"]),e(o,{onClick:a[25]||(a[25]=r=>i.tokentime++),class:"mr-5px"},{default:n(()=>[c(" + ")]),_:1}),c(" 小时 ")]),_:1})]),_:1}),e(p,{label:" "},{default:n(()=>[e(d,null,{default:n(()=>[N((h(),$(o,{type:"default",ghost:"",onClick:_},{default:n(()=>[c(" 刷新 ")]),_:1})),[[T,"system.conf.select"]]),N((h(),$(o,{type:"info",ghost:"",onClick:t},{default:n(()=>[c(" 保存 ")]),_:1})),[[T,"system.conf.update"]])]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1})}}}),_t=Z(mt,[["__scopeId","data-v-3c461f33"]]),ft=x("td",null,"产品名称",-1),gt=x("td",null,"产品版本",-1),vt=x("td",null,"build号",-1),bt=x("td",null,"产品型号",-1),yt=P({name:"basicInfo",__name:"basicInfo",setup(M){const u=B({id:1,pname:"",pversion:"",pbuild:"",pmodel:""});(async()=>{const{data:w,error:C}=await qe();C||(u.value=w)})(),B(0);const l=async()=>{var v,_;const{data:w,error:C}=await Be();C||(w==="重启失败"?(v=window.$message)==null||v.error(w):(_=window.$message)==null||_.success(w))},i=async()=>{var v,_;const{data:w,error:C}=await Pe();C||(w==="关机失败"?(v=window.$message)==null||v.error(w):(_=window.$message)==null||_.success(w))};return(w,C)=>{const v=fe,_=E,t=O,s=L,a=R("no-auth");return h(),$(s,{class:"w-600px text-center m-auto mt-20px"},{default:n(()=>[e(v,{bordered:!0,"single-line":!1},{default:n(()=>[x("tbody",null,[x("tr",null,[ft,x("td",null,q(u.value.pname||""),1)]),x("tr",null,[gt,x("td",null,q(u.value.pversion),1)]),x("tr",null,[vt,x("td",null,q(u.value.pbuild),1)]),x("tr",null,[bt,x("td",null,q(u.value.pmodel),1)])])]),_:1}),e(t,{justify:"center",class:"mt-50px"},{default:n(()=>[N((h(),$(_,{type:"info",ghost:"",onClick:l},{default:n(()=>[c("重启")]),_:1})),[[a,"sysmanger.basicInfo.restart"]]),N((h(),$(_,{type:"info",ghost:"",onClick:i},{default:n(()=>[c("关机")]),_:1})),[[a,"sysmanger.basicInfo.shutdown"]])]),_:1})]),_:1})}}}),ht=P({name:"emailService",__name:"emailSever",setup(M){const{formRef:u,validate:b}=K(),l=B({port:void 0,pwd:"",sendserver:"",essl:0,uname:""}),i={sendserver:[{required:!0,validator:(t,s,a)=>s?ke(s)?a():a(new Error("请输入正确的IP地址或域名")):new Error("请输入服务器地址"),trigger:["blur","input"]}],port:{type:"number",required:!0,trigger:["blur","input"],validator:(t,s,a)=>s==null||s==null?new Error("请输入端口号"):we(s)?!0:new Error("请输入在0-65535之间的数字")},uname:[{required:!0,message:"请输入账号",trigger:"blur"}],pwd:[{required:!0,message:"请输入密码",trigger:"blur"}],sendaddr:[{required:!0,message:"请输入发件邮箱",trigger:["blur","input"]},{validator:Ce,trigger:["blur","input"]}]},w=async()=>{const{data:t,error:s}=await Oe();s||(l.value.sendserver=(t==null?void 0:t.sendserver)??l.value.sendserver,l.value.port=(t==null?void 0:t.port)??l.value.port,l.value.pwd=(t==null?void 0:t.pwd)??l.value.pwd,l.value.essl=(t==null?void 0:t.essl)??l.value.essl,l.value.uname=(t==null?void 0:t.uname)??l.value.uname,l.value.id=(t==null?void 0:t.id)??l.value.id)};w();const C=async()=>{var t,s,a,g;if(await b(),l.value.id){const{data:p,error:o}=await Me(l.value);o||((t=window.$message)==null||t.destroyAll(),(s=window.$message)==null||s.success("保存成功"))}else{const{data:p,error:o}=await je(l.value);o||((a=window.$message)==null||a.destroyAll(),(g=window.$message)==null||g.success("保存成功"))}},v=async()=>{var a,g;const{data:t,error:s}=await Ge();s||((a=window.$message)==null||a.destroyAll(),(g=window.$message)==null||g.success("重置成功"),w())},_=async()=>{var a,g;await b();const{data:t,error:s}=await Fe(l.value);s||((a=window.$message)==null||a.destroyAll(),(g=window.$message)==null||g.success("测试成功"))};return(t,s)=>{const a=W,g=j,p=X,o=de,f=J,m=E,d=O,y=R("no-auth");return h(),F(pe,null,[e(f,{ref_key:"formRef",ref:u,"label-width":150,model:l.value,rules:i,"label-placement":"left",class:"w-400px",style:{margin:"50px auto"}},{default:n(()=>[e(g,{label:"发送邮件服务器",path:"sendserver"},{default:n(()=>[e(a,{value:l.value.sendserver,"onUpdate:value":s[0]||(s[0]=k=>l.value.sendserver=k),placeholder:"输入服务器或IP地址"},null,8,["value"])]),_:1}),e(g,{label:"端口",path:"port"},{default:n(()=>[e(p,{value:l.value.port,"onUpdate:value":s[1]||(s[1]=k=>l.value.port=k),placeholder:"输入端口",style:{width:"100%"}},null,8,["value"])]),_:1}),e(g,{label:"用户名",path:"uname"},{default:n(()=>[e(a,{value:l.value.uname,"onUpdate:value":s[2]||(s[2]=k=>l.value.uname=k),placeholder:"用户名"},null,8,["value"])]),_:1}),e(g,{label:"密码",path:"pwd"},{default:n(()=>[e(a,{type:"password",value:l.value.pwd,"onUpdate:value":s[3]||(s[3]=k=>l.value.pwd=k),placeholder:"密码","show-password-on":"click"},null,8,["value"])]),_:1}),e(g,{label:"ssl",path:"essl"},{default:n(()=>[e(o,{value:l.value.essl,"onUpdate:value":s[4]||(s[4]=k=>l.value.essl=k),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1})]),_:1},8,["model"]),e(d,{justify:"center"},{default:n(()=>[N((h(),$(m,{type:"info",ghost:"",onClick:_},{default:n(()=>[c("测试")]),_:1})),[[y,"sysmanger.basicInfo.test.mailInfo"]]),N((h(),$(m,{type:"info",ghost:"",onClick:C},{default:n(()=>[c("保存")]),_:1})),[[y,"sysmanger.mailInfo.update"]]),N((h(),$(m,{type:"info",ghost:"",onClick:v},{default:n(()=>[c("重置")]),_:1})),[[y,"sysmanger.mailInfo.delete"]])]),_:1})],64)}}}),kt=P({name:"TimingConfig",__name:"timingConfig",setup(M){const{formRef:u,validate:b}=K(),l=A({automatic:1,time:xe(1,new Date),ip:"",taskId:"",showCron:!1,setting:{settingCycle:void 0,settingCycleValue:void 0,settingTime:void 0}}),i={time:{required:!0,message:"请选择时间",trigger:"blur"},ip:[{required:!0,message:"请输入IP",trigger:"blur"},{validator:me,trigger:"blur"}],task:{required:!0,message:"请设置表达式",trigger:"blur"},setting:{settingCycle:{type:"number",required:!0,message:"请选择设置周期",trigger:"blur"},settingCycleValue:{type:"number",required:!0,message:"请选择设置周期值",trigger:"blur"},settingTime:{required:!0,message:"请选择设置时间",trigger:"blur"}}},w=async()=>{const{data:_,error:t}=await Ae();t||(l.time=_)};w(),(async()=>{const{data:_,error:t}=await Re();if(t)return;const{id:s,params:a}=_;try{if(a){const{cron:g,ip:p}=JSON.parse(a),o=ee(g);l.setting.settingCycle=o==null?void 0:o.settingCycle,l.setting.settingTime=o==null?void 0:o.settingTime,l.setting.settingCycleValue=o==null?void 0:o.settingCycleValue,l.ip=p,l.taskId=s}}catch(g){console.error("Error parsing params:",g)}})();const v=async()=>{var _,t;if(await b(),l.automatic){const{data:s,error:a}=await Le({dtime:l.time});a||(_=window.$message)==null||_.success(s)}else{const s=te(l.setting.settingCycle==1?{dayOfWeek:l.setting.settingCycleValue,time:l.setting.settingTime}:null,l.setting.settingCycle==2?{dayOfMonth:l.setting.settingCycleValue,time:l.setting.settingTime}:null,l.setting.settingCycle==3?{time:l.setting.settingTime}:null);l.taskId?await ae({id:l.taskId,beanName:"NtpTask",cronExpression:s,remark:"",status:1,params:JSON.stringify({ip:l.ip,cron:s})}):await ne({beanName:"NtpTask",cronExpression:s,remark:"",status:1,params:JSON.stringify({ip:l.ip,cron:s})});const{data:a,error:g}=await Je({ip:l.ip});g||(t=window.$message)==null||t.success(a)}};return(_,t)=>{const s=lt,a=O,g=st,p=j,o=ot,f=W,m=z,d=se,y=E,k=J,T=R("no-auth");return h(),$(k,{ref_key:"formRef",ref:u,"label-width":180,"label-placement":"left",model:l,class:"m-auto w-600px mt-20px",rules:i},{default:n(()=>[e(p,{label:"校时",path:"enablelock"},{default:n(()=>[e(g,{value:l.automatic,"onUpdate:value":t[0]||(t[0]=r=>l.automatic=r),name:"radiogroup"},{default:n(()=>[e(a,null,{default:n(()=>[e(s,{value:1},{default:n(()=>[c("手动校时")]),_:1}),e(s,{value:0},{default:n(()=>[c("自动校时")]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),l.automatic?(h(),$(p,{key:0,label:"设置中心服务器时间",path:"time"},{default:n(()=>[e(o,{"formatted-value":l.time,"onUpdate:formattedValue":t[1]||(t[1]=r=>l.time=r),format:"yyyy-MM-dd HH:mm:ss",type:"datetime",clearable:""},null,8,["formatted-value"])]),_:1})):I("",!0),l.automatic?I("",!0):(h(),F(pe,{key:1},[e(p,{label:"NTP服务器设置",path:"ip"},{default:n(()=>[e(f,{value:l.ip,"onUpdate:value":t[2]||(t[2]=r=>l.ip=r),placeholder:"输入NTP服务器设置"},null,8,["value"])]),_:1}),e(p,{label:"设置周期",path:"setting.settingCycle"},{default:n(()=>[e(a,{justify:"space-between"},{default:n(()=>[e(m,{value:l.setting.settingCycle,"onUpdate:value":[t[3]||(t[3]=r=>l.setting.settingCycle=r),t[4]||(t[4]=r=>l.setting.settingCycleValue=1)],options:[{label:"每周",value:1},{label:"每月",value:2},{label:"每日",value:3}],style:{width:"200px"}},null,8,["value"]),e(p,{label:"",path:"setting.settingCycleValue","show-feedback":!1},{default:n(()=>[e(a,null,{default:n(()=>[l.setting.settingCycle==1?(h(),$(m,{key:0,value:l.setting.settingCycleValue,"onUpdate:value":t[5]||(t[5]=r=>l.setting.settingCycleValue=r),options:S(Q)(),style:{width:"200px"}},null,8,["value","options"])):I("",!0),l.setting.settingCycle==2?(h(),$(m,{key:1,value:l.setting.settingCycleValue,"onUpdate:value":t[6]||(t[6]=r=>l.setting.settingCycleValue=r),options:S(Y)(),style:{width:"200px"}},null,8,["value","options"])):I("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),e(p,{label:"设置时间",path:"setting.settingTime"},{default:n(()=>[e(d,{"formatted-value":l.setting.settingTime,"onUpdate:formattedValue":t[7]||(t[7]=r=>l.setting.settingTime=r)},null,8,["formatted-value"])]),_:1})],64)),e(p,null,{label:n(()=>[l.automatic?N((h(),$(y,{key:0,type:"info",ghost:"",onClick:w},{default:n(()=>[c(" 查看服务器时间 ")]),_:1})),[[T,"sysmanger.basicInfo.gettiming"]]):I("",!0)]),default:n(()=>[e(a,null,{default:n(()=>[N((h(),$(y,{type:"info",ghost:"",onClick:v},{default:n(()=>[c(" 保存 ")]),_:1})),[[T,"sysmanger.basicInfo.manu.timing"]])]),_:1})]),_:1})]),_:1},8,["model"])}}}),wt={class:"h-full flex-col"},Ct=P({name:"dataBase",__name:"dataBase",setup(M){const u=()=>[...Array(12).keys()].map(p=>({label:`${p+1}个月`,value:p+1})),b=A({space:80,retention:void 0,id:void 0}),{columns:l,columnChecks:i,data:w,getData:C,loading:v,mobilePagination:_,searchParams:t,resetSearchParams:s}=oe({apiFn:ze,immediate:!0,apiParams:{page:1,limit:20},columns:()=>[{title:"时间",key:"dbtime",align:"center"},{title:"描述",key:"dmsg",align:"center"},{title:"结果",key:"resultmsg",align:"center"}]});(async()=>{const{data:p,error:o}=await We();o||(b.space=p.space,b.retention=p.retention,b.id=p.id)})();const g=async()=>{var f;const{data:p,error:o}=await He({space:b.space,retention:b.retention,id:b.id});o||(f=window.$message)==null||f.success("保存成功")};return(p,o)=>{const f=E,m=X,d=ce,y=j,k=z,T=O,r=L,G=le,D=R("no-auth");return h(),F("div",wt,[e(r,{title:"数据库维护配置",bordered:!1,class:"mb-20px","content-style":{padding:"0"},"header-style":{paddingTop:"0"}},{default:n(()=>[e(T,{class:"ml-50px"},{default:n(()=>[e(y,{label:"已用空间超过","label-placement":"left"},{default:n(()=>[e(d,{class:"flex items-center"},{default:n(()=>[e(f,{onClick:o[0]||(o[0]=V=>b.space--),disabled:b.space==1},{default:n(()=>[c(" − ")]),_:1},8,["disabled"]),e(m,{"show-button":!1,value:b.space,"onUpdate:value":o[1]||(o[1]=V=>b.space=V),placeholder:"",min:1,max:100,style:{width:"100px","text-align":"center"}},null,8,["value"]),e(f,{onClick:o[2]||(o[2]=V=>b.space++),disabled:b.space==100,class:"mr-5px"},{default:n(()=>[c(" + ")]),_:1},8,["disabled"]),c(" % 时自动维护 ")]),_:1})]),_:1}),e(y,{label:"数据保留时间","label-placement":"left",class:"mx-20px"},{default:n(()=>[e(k,{value:b.retention,"onUpdate:value":o[3]||(o[3]=V=>b.retention=V),placeholder:"请选择",options:u(),style:{width:"150px"}},null,8,["value","options"])]),_:1}),e(y,{label:" ","label-placement":"left"},{default:n(()=>[N((h(),$(f,{type:"info",ghost:"",onClick:g},{default:n(()=>[c("保存")]),_:1})),[[D,"sysmanger.basicInfo.insert.dataBaseMaintenance"]])]),_:1})]),_:1})]),_:1}),e(r,{title:"数据库维护列表",bordered:!1,class:"flex-1","content-style":{padding:"0"},"header-style":{paddingTop:"0"}},{default:n(()=>[e(G,{columns:S(l),data:S(w),size:"small","scroll-x":462,loading:S(v),remote:"","row-key":V=>V.id,pagination:S(_),class:"sm:h-full"},null,8,["columns","data","loading","row-key","pagination"])]),_:1})])}}}),xt={class:"h-full flex-col"},$t=P({name:"dataBackup",__name:"dataBackup",setup(M){const{columns:u,columnChecks:b,data:l,getData:i,loading:w,mobilePagination:C,searchParams:v,resetSearchParams:_}=oe({apiFn:Ke,immediate:!0,apiParams:{page:1,limit:20},columns:()=>[{title:"时间",key:"dbtime",align:"center"},{title:"描述",key:"dbdesc",align:"center"},{title:"结果",key:"dbstatus",align:"center"}]}),t=A({id:"",ip:"",username:"",pwd:"",path:"",cron:"",showCron:!1,setting:{settingCycle:void 0,settingCycleValue:void 0,settingTime:void 0}}),s=B(null),a={ip:[{required:!0,message:"请输入IP",trigger:"blur"},{validator:me,trigger:"blur"}],cron:{required:!0,message:"请设置表达式",trigger:"blur"},username:{required:!0,message:"请输入账号",trigger:"blur"},pwd:{required:!0,message:"请输入密码",trigger:"blur"},path:{required:!0,message:"请输入路径",trigger:"blur"},setting:{settingCycle:{type:"number",required:!0,message:"请选择设置周期",trigger:"blur"},settingCycleValue:{type:"number",required:!0,message:"请选择设置周期值",trigger:"blur"},settingTime:{required:!0,message:"请选择设置时间",trigger:"blur"}}};(async()=>{const{data:m,error:d}=await Xe();if(d)return;const{id:y,params:k}=m;if(t.id=y,k)try{const{ip:T,username:r,pwd:G,path:D,cron:V}=JSON.parse(k),H=ee(V);Object.assign(t,{ip:T,username:r,pwd:G,path:D,cron:V,setting:H})}catch(T){console.error("Error parsing params:",T)}})();const p=async()=>{var d,y,k;await((d=s.value)==null?void 0:d.validate());const m=te(t.setting.settingCycle==1?{dayOfWeek:t.setting.settingCycleValue,time:t.setting.settingTime}:null,t.setting.settingCycle==2?{dayOfMonth:t.setting.settingCycleValue,time:t.setting.settingTime}:null,t.setting.settingCycle==3?{time:t.setting.settingTime}:null);if(t.id){const{data:T,error:r}=await ae({beanName:"DataBackUpsTask",id:t.id,cronExpression:m,remark:"",status:1,params:JSON.stringify({ip:t.ip,username:t.username,pwd:t.pwd,path:t.path,cron:m})});r||(y=window.$message)==null||y.success("备份设置成功")}else{const{data:T,error:r}=await ne({beanName:"DataBackUpsTask",cronExpression:m,remark:"",status:1,params:JSON.stringify({ip:t.ip,username:t.username,pwd:t.pwd,path:t.path,cron:m})});r||(k=window.$message)==null||k.success("备份设置成功")}},o=(m,d)=>d===null?!1:Number(d)==6?m!=0:!1,f=(m,d,y)=>y===null||d===null?!1:Number(y)==6?m!=0:!1;return(m,d)=>{const y=W,k=it,T=z,r=j,G=O,D=se,V=E,H=rt,ve=J,ie=L,be=le;return h(),F("div",xt,[e(ie,{title:"数据库备份",bordered:!1,class:"mb-20px","content-style":{padding:"0"},"header-style":{paddingTop:"0"}},{default:n(()=>[e(ve,{"label-placement":"left",model:t,rules:a,"label-width":150,class:"px-100px"},{default:n(()=>[e(H,{cols:24,"x-gap":24},{default:n(()=>[e(k,{span:8,label:"IP地址",path:"ip"},{default:n(()=>[e(y,{value:t.ip,"onUpdate:value":d[0]||(d[0]=U=>t.ip=U),placeholder:"",style:{width:"100%"}},null,8,["value"])]),_:1}),e(k,{span:8,label:"账号",path:"username"},{default:n(()=>[e(y,{value:t.username,"onUpdate:value":d[1]||(d[1]=U=>t.username=U),placeholder:"",style:{width:"100%"}},null,8,["value"])]),_:1}),e(k,{span:8,label:"密码",path:"pwd"},{default:n(()=>[e(y,{type:"password","show-password-on":"mousedown",value:t.pwd,"onUpdate:value":d[2]||(d[2]=U=>t.pwd=U),placeholder:"",style:{width:"100%"}},null,8,["value"])]),_:1}),e(k,{span:8,label:"路径",path:"path"},{default:n(()=>[e(y,{value:t.path,"onUpdate:value":d[3]||(d[3]=U=>t.path=U),placeholder:"",style:{width:"100%"}},null,8,["value"])]),_:1}),e(k,{span:8,label:"设置周期",path:"setting.settingCycle"},{default:n(()=>[e(G,{justify:"space-between"},{default:n(()=>[e(T,{value:t.setting.settingCycle,"onUpdate:value":[d[4]||(d[4]=U=>t.setting.settingCycle=U),d[5]||(d[5]=U=>t.setting.settingCycleValue=1)],options:[{label:"每周",value:1},{label:"每月",value:2}],style:{width:"140px"}},null,8,["value"]),e(r,{label:"",path:"setting.settingCycleValue","show-feedback":!1},{default:n(()=>[t.setting.settingCycle==1?(h(),$(T,{key:0,value:t.setting.settingCycleValue,"onUpdate:value":d[6]||(d[6]=U=>t.setting.settingCycleValue=U),options:S(Q)(),style:{width:"140px"}},null,8,["value","options"])):I("",!0),t.setting.settingCycle==2?(h(),$(T,{key:1,value:t.setting.settingCycleValue,"onUpdate:value":d[7]||(d[7]=U=>t.setting.settingCycleValue=U),options:S(Y)(),style:{width:"140px"}},null,8,["value","options"])):I("",!0)]),_:1})]),_:1})]),_:1}),e(k,{span:8,label:"设置时间",path:"setting.settingTime"},{default:n(()=>[e(G,{justify:"space-between"},{default:n(()=>[e(D,{"formatted-value":t.setting.settingTime,"onUpdate:formattedValue":d[8]||(d[8]=U=>t.setting.settingTime=U),hours:[0,1,2,3,4,5,6],"is-minute-disabled":o,"is-second-disabled":f,actions:["confirm"]},null,8,["formatted-value"]),e(V,{type:"info",ghost:"",onClick:p},{default:n(()=>[c("保存")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(ie,{title:"数据备份列表",bordered:!1,class:"flex-1","content-style":{padding:"0"},"header-style":{paddingTop:"0"}},{default:n(()=>[e(be,{columns:S(u),data:S(l),size:"small","scroll-x":462,loading:S(w),remote:"","row-key":U=>U.id,pagination:S(C),class:"sm:h-full"},null,8,["columns","data","loading","row-key","pagination"])]),_:1})])}}}),Tt=Z($t,[["__scopeId","data-v-cd1a61b3"]]),St={class:"h-full flex-col"},Ut=P({name:"systemSnapshot",__name:"systemSnapshot",setup(M){const{columns:u,columnChecks:b,data:l,getData:i,loading:w,mobilePagination:C,searchParams:v,resetSearchParams:_}=oe({apiFn:Ze,immediate:!0,apiParams:{page:1,limit:20},columns:()=>[{title:"时间",key:"dbtime",align:"center"},{title:"描述",key:"dmsg",align:"center"},{title:"结果",key:"resultmsg",align:"center",render:o=>e($e,{type:o.resultmsg==1?"error":"success"},{default:()=>[o.resultmsg==1?"失败":"成功"]})},{title:"操作",key:"operate",align:"center",width:100,fixed:"right",render:o=>e(ut,{onPositiveClick:()=>p(o.id)},{default:()=>"确定恢复吗?恢复后将重启系统",trigger:()=>e(E,{type:"info",ghost:!0,size:"small"},{default:()=>[c("恢复")]})})}]}),t=A({id:"",setting:{settingCycle:void 0,settingCycleValue:void 0,settingTime:void 0}}),s={setting:{settingCycle:{type:"number",required:!0,message:"请选择设置周期",trigger:"blur"},settingCycleValue:{type:"number",required:!0,message:"请选择设置周期值",trigger:"blur"},settingTime:{required:!0,message:"请选择设置时间",trigger:"blur"}}};(async()=>{const{data:o,error:f}=await Qe();if(f)return;console.log(o,"asdas");const m=ee(o.cronExpression);Object.assign(t,{id:o.id,setting:m})})();const g=async()=>{var f,m;const o=te(t.setting.settingCycle==1?{dayOfWeek:t.setting.settingCycleValue,time:t.setting.settingTime}:null,t.setting.settingCycle==2?{dayOfMonth:t.setting.settingCycleValue,time:t.setting.settingTime}:null,t.setting.settingCycle==3?{time:t.setting.settingTime}:null);if(t.id){const{data:d,error:y}=await ae({id:t.id,beanName:"SnapshotTask",cronExpression:o,status:1,params:JSON.stringify({corn:o})});y||(f=window.$message)==null||f.success("设置成功")}else{const{data:d,error:y}=await ne({beanName:"SnapshotTask",cronExpression:o,remark:"",status:1,params:JSON.stringify({corn:o})});y||(m=window.$message)==null||m.success("设置成功")}},p=async o=>{var d;const{data:f,error:m}=await Ye({id:o});m||(d=window.$message)==null||d.success("恢复成功")};return(o,f)=>{const m=z,d=j,y=O,k=se,T=J,r=L,G=le;return h(),F("div",St,[e(r,{title:"快照备份设置",bordered:!1,"content-style":{padding:"0"},"header-style":{paddingTop:"0"}},{default:n(()=>[e(y,{class:"ml-50px"},{default:n(()=>[e(T,{"label-placement":"left",inline:"",model:t,rules:s,"label-width":150,class:"px-100px"},{default:n(()=>[e(d,{label:"设置周期",path:"setting.settingCycle"},{default:n(()=>[e(y,{justify:"space-between"},{default:n(()=>[e(m,{value:t.setting.settingCycle,"onUpdate:value":[f[0]||(f[0]=D=>t.setting.settingCycle=D),f[1]||(f[1]=D=>t.setting.settingCycleValue=1)],options:[{label:"每周",value:1},{label:"每月",value:2},{label:"每日",value:3}],style:{width:"140px"}},null,8,["value"]),e(d,{label:"",path:"setting.settingCycleValue","show-feedback":!1},{default:n(()=>[t.setting.settingCycle==1?(h(),$(m,{key:0,value:t.setting.settingCycleValue,"onUpdate:value":f[2]||(f[2]=D=>t.setting.settingCycleValue=D),options:S(Q)(),style:{width:"140px"}},null,8,["value","options"])):I("",!0),t.setting.settingCycle==2?(h(),$(m,{key:1,value:t.setting.settingCycleValue,"onUpdate:value":f[3]||(f[3]=D=>t.setting.settingCycleValue=D),options:S(Y)(),style:{width:"140px"}},null,8,["value","options"])):I("",!0)]),_:1})]),_:1})]),_:1}),e(d,{label:"设置时间",path:"setting.settingTime"},{default:n(()=>[e(k,{"formatted-value":t.setting.settingTime,"onUpdate:formattedValue":f[4]||(f[4]=D=>t.setting.settingTime=D)},null,8,["formatted-value"])]),_:1}),e(d,{label:" ","label-placement":"left"},{default:n(()=>[e(S(E),{type:"info",ghost:"",onClick:g},{default:n(()=>[c("保存")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),e(r,{title:"快照备份列表",bordered:!1,"content-style":{padding:"0"},"header-style":{paddingTop:"0"},class:"flex-1"},{default:n(()=>[e(G,{columns:S(u),data:S(l),size:"small","scroll-x":462,loading:S(w),remote:"","row-key":D=>D.id,pagination:S(C),class:"sm:h-full"},null,8,["columns","data","loading","row-key","pagination"])]),_:1})])}}}),Dt={class:"flex"},Vt=x("td",null,"序列号",-1),Nt=x("td",null,"创建时间",-1),It=x("td",null,"有效时间",-1),Et=x("td",null,"可配置采集器数量",-1),qt=P({__name:"LicenseConfig",setup(M){const u=B(""),b=B(null),l=({file:v})=>{console.log(v),b.value=v.file,u.value=v.name},i=v=>{v.stopPropagation(),u.value="",b.value=null},w=A({fs:""}),C=async()=>{var v,_;if(!u.value.endsWith(".lic"))return(v=window.$message)==null?void 0:v.error("请上传.lic文件");try{const t=new FormData;t.append("fi",b.value);const{data:s,error:a}=await et(t);if(a)return;(_=window.$message)==null||_.success(s)}catch{}};return(v,_)=>{const t=re,s=ue,a=E,g=ge,p=j,o=fe,f=O;return h(),$(f,{justify:"center",class:"pt-20px important-flex-col items-center"},{default:n(()=>[x("div",Dt,[e(p,{label:"License管理","label-placement":"left"},{default:n(()=>[e(g,{action:"","custom-request":l,"show-file-list":!1,accept:".lic"},{default:n(()=>[u.value?(h(),F("div",{key:0,onClick:_[0]||(_[0]=_e(()=>{},["stop"]))},[c(q(u.value)+" ",1),e(t,{class:"font-size-30px cursor-pointer",onClick:i})])):(h(),$(a,{key:1},{icon:n(()=>[e(s,{class:"text-icon"})]),default:n(()=>[c(" 选择文件")]),_:1}))]),_:1})]),_:1}),e(p,{label:"","label-placement":"left",class:"ml-20px"},{default:n(()=>[e(a,{type:"info",ghost:"",disabled:!u.value,onClick:C},{default:n(()=>[c("上传")]),_:1},8,["disabled"])]),_:1})]),e(o,{bordered:!0,"single-line":!1,class:"w-800px text-center m-auto mt-20px"},{default:n(()=>[x("tbody",null,[x("tr",null,[Vt,x("td",null,q(w.fs||""),1)]),x("tr",null,[Nt,x("td",null,q(w.fs),1)]),x("tr",null,[It,x("td",null,q(w.fs),1)]),x("tr",null,[Et,x("td",null,q(w.fs),1)])])]),_:1})]),_:1})}}}),Bt=P({__name:"sysStatus",setup(M){const u=A({mailaddr:"",snmpaddr:void 0,stype:0,tmail:0,tsnmp:0});(async()=>{const{data:t,error:s}=await tt();s||(u.mailaddr=(t==null?void 0:t.mailaddr)??u.mailaddr,u.snmpaddr=(t==null?void 0:t.snmpaddr)??u.snmpaddr,u.stype=(t==null?void 0:t.stype)??u.stype,u.tmail=(t==null?void 0:t.tmail)??u.tmail,u.tsnmp=(t==null?void 0:t.tsnmp)??u.tsnmp)})();const l=async()=>{var a;const{data:t,error:s}=await nt(u);s||(a=window.$message)==null||a.success("保存成功")},{pageData:i,getData:w,nextPage:C}=dt(ct),v=async t=>{const s=t.currentTarget;s.scrollTop+s.offsetHeight>=s.scrollHeight&&i.data.length<i.total&&C()},_=B();return Te(()=>i.data,t=>{t&&(_.value=t.filter(s=>s.ftype===1))}),w(),(t,s)=>{const a=Ue,g=De,p=W,o=j,f=z,m=E,d=O,y=L,k=R("no-auth");return h(),$(d,{justify:"center"},{default:n(()=>[e(y,{title:"通知方式",class:"w-600px"},{default:n(()=>[e(a),e(g,{checked:u.tmail,"onUpdate:checked":s[0]||(s[0]=T=>u.tmail=T),"checked-value":1,"unchecked-value":0},{default:n(()=>[c(" 邮件 ")]),_:1},8,["checked"]),u.tmail?(h(),$(o,{key:0,label:"邮件地址","label-placement":"left","label-width":"120",class:"mt-30px",rule:{required:!0,validator:()=>{if(!u.mailaddr)return new Error("请输入邮件地址");if(!S(Se)(u.mailaddr))return new Error("请输入正确的邮件地址")},trigger:["blur","input"]}},{default:n(()=>[e(p,{value:u.mailaddr,"onUpdate:value":s[1]||(s[1]=T=>u.mailaddr=T)},null,8,["value"])]),_:1},8,["rule"])):I("",!0),e(a),e(g,{checked:u.tsnmp,"onUpdate:checked":s[2]||(s[2]=T=>u.tsnmp=T),"checked-value":1,"unchecked-value":0},{default:n(()=>[c(" snmp trap ")]),_:1},8,["checked"]),u.tsnmp?(h(),$(o,{key:1,label:"通知服务器","label-placement":"left","label-width":"120",class:"mt-30px"},{default:n(()=>[e(f,{value:u.snmpaddr,"onUpdate:value":s[3]||(s[3]=T=>u.snmpaddr=T),options:_.value,"label-field":"ipaddr","value-field":"ipaddr",onScroll:v},null,8,["value","options"])]),_:1})):I("",!0),e(a),e(d,{justify:"end"},{default:n(()=>[N((h(),$(m,{type:"info",ghost:"",onClick:l},{default:n(()=>[c("保存")]),_:1})),[[k,"sysmanger.basicInfo.alarmNotification"]])]),_:1})]),_:1})]),_:1})}}}),Pt={class:"h-full"},Ot=P({name:"basicconfig_system-config",__name:"index",setup(M){const u=B("基本信息"),b=B(""),l=B(null),i=({file:v})=>{l.value=v.file,b.value=v.name},w=v=>{v.stopPropagation(),b.value="",l.value=null};A({fs:""});const C=async()=>{var v;try{const _=new FormData;_.append("fi",l.value);const{data:t,error:s}=await at({name:b.value},_);if(s)return;(v=window.$message)==null||v.success(t)}catch{}};return(v,_)=>{const t=Ve,s=re,a=ue,g=E,p=ge,o=j,f=O,m=Ne,d=L,y=R("no-auth");return h(),F("div",Pt,[e(d,{style:{"margin-bottom":"16px"},class:"h-full","content-style":{height:"100%"}},{default:n(()=>[e(m,{type:"card",animated:"",class:"h-100%",value:u.value,"onUpdate:value":_[1]||(_[1]=k=>u.value=k)},{default:n(()=>[e(t,{name:"基本信息",tab:"基本信息"},{default:n(()=>[e(yt)]),_:1}),e(t,{name:"基础配置",tab:"基础配置"},{default:n(()=>[e(_t)]),_:1}),e(t,{name:"邮件服务",tab:"邮件服务"},{default:n(()=>[e(ht)]),_:1}),e(t,{name:"校时配置",tab:"校时配置"},{default:n(()=>[e(kt)]),_:1}),e(t,{name:"数据库维护",tab:"数据库维护",class:"h-100%"},{default:n(()=>[e(Ct)]),_:1}),e(t,{name:"数据库备份",tab:"数据库备份",class:"h-100%"},{default:n(()=>[e(Tt)]),_:1}),e(t,{name:"系统快照",tab:"系统快照",class:"h-100%"},{default:n(()=>[e(Ut)]),_:1}),e(t,{name:"License管理",tab:"License管理"},{default:n(()=>[e(qt)]),_:1}),e(t,{name:"情报库",tab:"情报库"},{default:n(()=>[e(f,{justify:"center",class:"pt-20px important-flex-col items-center"},{default:n(()=>[e(o,{label:"上传情报库文件","label-placement":"left"},{default:n(()=>[e(p,{action:"","custom-request":i,"show-file-list":!1,accept:".zip"},{default:n(()=>[b.value?(h(),F("div",{key:0,onClick:_[0]||(_[0]=_e(()=>{},["stop"]))},[c(q(b.value)+" ",1),e(s,{class:"font-size-30px cursor-pointer",onClick:w})])):(h(),$(g,{key:1},{icon:n(()=>[e(a,{class:"text-icon"})]),default:n(()=>[c(" 选择文件")]),_:1}))]),_:1})]),_:1}),e(o,{label:"","label-placement":"left",class:"ml-20px"},{default:n(()=>[N((h(),$(g,{type:"info",ghost:"",disabled:!b.value,onClick:C},{default:n(()=>[c("提交")]),_:1},8,["disabled"])),[[y,"sysmanger.basicInfo.intelligence"]])]),_:1})]),_:1})]),_:1}),e(t,{name:"系统告警通知",tab:"系统告警通知"},{default:n(()=>[e(Bt)]),_:1})]),_:1},8,["value"])]),_:1})])}}}),an=Z(Ot,[["__scopeId","data-v-4f1c343e"]]);export{an as default};

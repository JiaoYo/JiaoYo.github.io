import{d as B,q as M,dB as E,a5 as V,s as F,j as v,y as j,o as R,c as G,w as a,f as y,g as t,aa as L,i as C,aV as u,S as q,F as H,T as Q,U as W,V as z,e as J,h as N,aM as T,$ as K,ao as O,aq as X,a2 as Y,C as Z,B as ee,D as te,ad as ae}from"./index-7Q9xZuwa.js";import{l as ne,m as oe}from"./reportForm-CrOLjfvW.js";import{f as le}from"./asset-BpzDQjbF.js";import{_ as se,b as ie,c as re,d as pe,f as de,a as ue}from"./templateDataFilter-B3gVaP5x.js";import{u as ce}from"./usePageData-PYHx9xl8.js";import{_ as _e}from"./DatePicker-CNtih3Cp.js";import{a as me,_ as fe}from"./Grid-CRtcNhSF.js";import"./index-BS8KoN7o.js";import"./installCanvasRenderer-iCPGNWhM.js";import"./TimePicker-BYx0IEL9.js";import"./defineProperty-B4q_dn_D.js";import"./Forward-BzUEeUAa.js";const ve=r=>(Q("data-v-d674d4e5"),r=r(),W(),r),ge=ve(()=>y("span",{class:"mr-20px"},"报表预览",-1)),Te={title:"导出PDF"},ye={title:"导出Word"},be={title:"导出Excel"},he=B({name:"reportPreview",__name:"reportPreview",props:M({data:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:["update:visible"],setup(r){E(_=>({"03cdc49e":C(h)}));const p=V(),n=r,i=F(r,"visible"),c=v(""),b=()=>{var _,o;c.value=((o=(_=n.data)==null?void 0:_.find(g=>g.type=="title"))==null?void 0:o.value)+"报表"+u(1,new Date)};j(i,()=>{i.value&&b()});const s=v(),h=p.themeScheme=="dark"?"#001428":"#fff";return(_,o)=>{const g=se,x=ie,w=re,k=pe,S=q,l=H;return R(),G(l,{show:i.value,"onUpdate:show":o[3]||(o[3]=e=>i.value=e),preset:"card",class:"w-1000px reportPreview",style:L({"background-color":C(p).themeScheme=="dark"?"#001428":"#fff"})},{header:a(()=>[ge,y("span",Te,[t(g,{class:"text-32px c-#d63031 cursor-pointer",onClick:o[0]||(o[0]=e=>s.value.toPdf(c.value))})]),y("span",ye,[t(x,{class:"text-32px c-#1e90ff cursor-pointer",onClick:o[1]||(o[1]=e=>s.value.toWord(c.value))})]),y("span",be,[t(w,{class:"text-32px c-#15703d cursor-pointer",onClick:o[2]||(o[2]=e=>s.value.toExcel(c.value))})])]),default:a(()=>[t(S,{class:"max-h-600px"},{default:a(()=>[t(k,{ref_key:"filePreviewExportRef",ref:s,width:800,data:n.data},null,8,["data"])]),_:1})]),_:1},8,["show","style"])}}}),xe=z(he,[["__scopeId","data-v-d674d4e5"]]),Ue=B({name:"reportmanagement_reporttemplate",__name:"index",setup(r){const p=v(!1),n=v({atypes:[],time:void 0,startTime:void 0,endTime:void 0}),i=v([]),c=async()=>{var m;i.value=[];const{data:l,error:e}=await ne({startTime:n.value.startTime,endTime:n.value.endTime,atypes:(m=n.value.atypes)==null?void 0:m.join(",")});e||(p.value=!0,i.value=de(l,{startTime:n.value.startTime,endTime:n.value.endTime}))};async function b(l,e){n.value.startTime=u(0,e[0]),n.value.endTime=u(0,e[1])}const s=v({time:[new Date().getTime()-864e5*30,new Date().getTime()],startTime:u(0,new Date().getTime()-864e5*30),endTime:u(0,new Date().getTime())}),h=async()=>{i.value=[];const{data:l,error:e}=await oe({startTime:s.value.startTime,endTime:s.value.endTime});e||(p.value=!0,i.value=ue(l,{startTime:s.value.startTime,endTime:s.value.endTime}))};async function _(l,e){s.value.startTime=e?u(0,e[0]):void 0,s.value.endTime=e?u(0,e[1]):void 0}const{pageData:o,getData:g,nextPage:x}=ce(le),w=async l=>{const e=l.currentTarget;e.scrollTop+e.offsetHeight>=e.scrollHeight&&o.data.length<o.total&&x()};g();const k=l=>{const e=l.pid;return T("div",{style:{width:"100%",display:"flex",justifyContent:"space-between"}},[T("div",null,[l.aname]),T("span",{depth:3,tag:"div",style:{color:"#999"}},{default:()=>K(O[e])})])},S=({option:l,handleClose:e})=>T(X,{style:{padding:"0 6px 0 4px"},closable:!0,onClose:m=>{m.stopPropagation(),e()}},{default:()=>T("div",{style:{display:"flex",alignItems:"center"}},[l.aname])});return(l,e)=>{const m=Y,f=Z,P=_e,D=ee,I=te,$=ae,A=me,U=fe;return R(),J("div",null,[t(U,{"x-gap":"12",cols:2},{default:a(()=>[t(A,null,{default:a(()=>[t($,{title:"资产信息报表"},{default:a(()=>[t(I,{ref:"formRef",class:"h-200px","label-width":80,"label-placement":"left",model:n.value},{default:a(()=>[t(f,{label:"资产类型",path:"atypes"},{default:a(()=>[t(m,{value:n.value.atypes,"onUpdate:value":e[0]||(e[0]=d=>n.value.atypes=d),placeholder:"请选择资产类型",clearable:"",filterable:"","value-field":"id",multiple:"","label-field":"aname",options:C(o).data,"reset-menu-on-options-change":!1,class:"w-60%","render-label":k,"render-tag":S,onScroll:w},null,8,["value","options"])]),_:1}),t(f,{label:"查询日期",path:"selectTime"},{default:a(()=>[t(P,{value:n.value.time,"onUpdate:value":e[1]||(e[1]=d=>n.value.time=d),type:"daterange",clearable:"",class:"w-60%","onUpdate:formattedValue":b},null,8,["value"])]),_:1}),t(f,{label:" "},{default:a(()=>[t(D,{"attr-type":"button",onClick:c},{default:a(()=>[N(" 查询 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),t(A,null,{default:a(()=>[t($,{title:"综合报表"},{default:a(()=>[t(I,{ref:"formRef",class:"h-200px","label-width":80,"label-placement":"left",model:s.value},{default:a(()=>[t(f,{label:"查询日期",path:"selectTime"},{default:a(()=>[t(P,{value:s.value.time,"onUpdate:value":e[2]||(e[2]=d=>s.value.time=d),type:"daterange",class:"w-60%","onUpdate:formattedValue":_},null,8,["value"])]),_:1}),t(f,{label:""}),t(f,{label:" "},{default:a(()=>[t(D,{"attr-type":"button",onClick:h},{default:a(()=>[N(" 查询 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]),_:1}),t(xe,{data:i.value,visible:p.value,"onUpdate:visible":e[3]||(e[3]=d=>p.value=d)},null,8,["data","visible"])])}}});export{Ue as default};

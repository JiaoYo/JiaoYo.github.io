import{_ as Wt}from"./round-refresh-bYfHOtol.js";import{_ as qt}from"./round-search-Dzp6xJh-.js";import{_ as Tn}from"./table-column-setting.vue_vue_type_script_setup_true_lang-rgBDZvjO.js";import{_ as Rn}from"./round-delete-vxljK2J6.js";import{_ as On}from"./round-add-XwPZokqe.js";import{W as Un,X as Dn,Y as Nn,Z as q,a0 as Fe,a1 as xe,a2 as de,a3 as yt,a4 as Bn,d as Pe,a5 as p,a6 as Mn,a7 as Hn,a8 as at,a9 as Vn,aa as st,ab as Wn,ac as Kt,ad as Gt,ae as rt,af as qe,ag as qn,ah as Ot,ai as Jt,aj as Zt,a as ke,ak as me,al as Yt,am as Ut,an as Kn,ao as Gn,ap as Jn,aq as ue,ar as Zn,as as Yn,at as kt,au as Qt,q as Lt,v as be,r as re,s as Ct,av as Xt,aw as Qn,c as U,o as R,w as a,f as n,e as wt,G as _t,ax as Xn,z as N,h as m,C as fe,ay as en,az as St,aA as tn,g as z,B as T,b as ot,aB as ei,aC as nn,N as Ft,aD as ln,$ as Y,t as Z,aE as rn,aF as it,aG as an,aH as We,aI as ti,aJ as ni,F as ii,aK as sn,E as on,U as dn,aL as un,M as li,aM as Ue,A as ri,aN as ai,aO as si,D as X,aP as tt,y as ee,aQ as nt,aR as oi,aS as di}from"./index-BHFXhhrx.js";import{u as lt}from"./upload-C-EyKG-1.js";import{u as gt,a as vt}from"./table-02_NjBh1.js";import{_ as zt}from"./Grid-DeUxXMwD.js";import{_ as Et}from"./FormItemGridItem-CfqayFMK.js";import{h as ae}from"./permission-BTV9NQAl.js";import{N as De}from"./Popconfirm-BQM7uy2f.js";import"./v4-FuVw324d.js";let Dt=!1;function ui(){if(Un&&window.CSS&&!Dt&&(Dt=!0,"registerProperty"in(window==null?void 0:window.CSS)))try{CSS.registerProperty({name:"--n-color-start",syntax:"<color>",inherits:!1,initialValue:"#0000"}),CSS.registerProperty({name:"--n-color-end",syntax:"<color>",inherits:!1,initialValue:"#0000"})}catch{}}function ci(o){const{textColor3:P,infoColor:E,errorColor:y,successColor:u,warningColor:g,textColor1:e,textColor2:h,railColor:b,fontWeightStrong:x,fontSize:s}=o;return Object.assign(Object.assign({},Nn),{contentFontSize:s,titleFontWeight:x,circleBorder:`2px solid ${P}`,circleBorderInfo:`2px solid ${E}`,circleBorderError:`2px solid ${y}`,circleBorderSuccess:`2px solid ${u}`,circleBorderWarning:`2px solid ${g}`,iconColor:P,iconColorInfo:E,iconColorError:y,iconColorSuccess:u,iconColorWarning:g,titleTextColor:e,contentTextColor:h,metaTextColor:P,lineColor:b})}const pi={common:Dn,self:ci},fi=q("steps",`
 width: 100%;
 display: flex;
`,[q("step",`
 position: relative;
 display: flex;
 flex: 1;
 `,[Fe("disabled","cursor: not-allowed"),Fe("clickable",`
 cursor: pointer;
 `),xe("&:last-child",[q("step-splitor","display: none;")])]),q("step-splitor",`
 background-color: var(--n-splitor-color);
 margin-top: calc(var(--n-step-header-font-size) / 2);
 height: 1px;
 flex: 1;
 align-self: flex-start;
 margin-left: 12px;
 margin-right: 12px;
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `),q("step-content","flex: 1;",[q("step-content-header",`
 color: var(--n-header-text-color);
 margin-top: calc(var(--n-indicator-size) / 2 - var(--n-step-header-font-size) / 2);
 line-height: var(--n-step-header-font-size);
 font-size: var(--n-step-header-font-size);
 position: relative;
 display: flex;
 font-weight: var(--n-step-header-font-weight);
 margin-left: 9px;
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `,[de("title",`
 white-space: nowrap;
 flex: 0;
 `)]),de("description",`
 color: var(--n-description-text-color);
 margin-top: 12px;
 margin-left: 9px;
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `)]),q("step-indicator",`
 background-color: var(--n-indicator-color);
 box-shadow: 0 0 0 1px var(--n-indicator-border-color);
 height: var(--n-indicator-size);
 width: var(--n-indicator-size);
 border-radius: 50%;
 display: flex;
 align-items: center;
 justify-content: center;
 transition:
 background-color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
 `,[q("step-indicator-slot",`
 position: relative;
 width: var(--n-indicator-icon-size);
 height: var(--n-indicator-icon-size);
 font-size: var(--n-indicator-icon-size);
 line-height: var(--n-indicator-icon-size);
 `,[de("index",`
 display: inline-block;
 text-align: center;
 position: absolute;
 left: 0;
 top: 0;
 white-space: nowrap;
 font-size: var(--n-indicator-index-font-size);
 width: var(--n-indicator-icon-size);
 height: var(--n-indicator-icon-size);
 line-height: var(--n-indicator-icon-size);
 color: var(--n-indicator-text-color);
 transition: color .3s var(--n-bezier);
 `,[yt()]),q("icon",`
 color: var(--n-indicator-text-color);
 transition: color .3s var(--n-bezier);
 `,[yt()]),q("base-icon",`
 color: var(--n-indicator-text-color);
 transition: color .3s var(--n-bezier);
 `,[yt()])])]),Fe("vertical","flex-direction: column;",[Bn("show-description",[xe(">",[q("step","padding-bottom: 8px;")])]),xe(">",[q("step","margin-bottom: 16px;",[xe("&:last-child","margin-bottom: 0;"),xe(">",[q("step-indicator",[xe(">",[q("step-splitor",`
 position: absolute;
 bottom: -8px;
 width: 1px;
 margin: 0 !important;
 left: calc(var(--n-indicator-size) / 2);
 height: calc(100% - var(--n-indicator-size));
 `)])]),q("step-content",[de("description","margin-top: 8px;")])])])])])]);function mi(o,P){return typeof o!="object"||o===null||Array.isArray(o)?null:(o.props||(o.props={}),o.props.internalIndex=P+1,o)}function yi(o){return o.map((P,E)=>mi(P,E))}const gi=Object.assign(Object.assign({},st.props),{current:Number,status:{type:String,default:"process"},size:{type:String,default:"medium"},vertical:Boolean,"onUpdate:current":[Function,Array],onUpdateCurrent:[Function,Array]}),cn=Kt("n-steps"),vi=Pe({name:"Steps",props:gi,slots:Object,setup(o,{slots:P}){const{mergedClsPrefixRef:E,mergedRtlRef:y}=at(o),u=Vn("Steps",y,E),g=st("Steps","-steps",fi,Wn,o,E);return Gt(cn,{props:o,mergedThemeRef:g,mergedClsPrefixRef:E,stepsSlots:P}),{mergedClsPrefix:E,rtlEnabled:u}},render(){const{mergedClsPrefix:o}=this;return p("div",{class:[`${o}-steps`,this.rtlEnabled&&`${o}-steps--rtl`,this.vertical&&`${o}-steps--vertical`]},yi(Mn(Hn(this))))}}),hi={status:String,title:String,description:String,disabled:Boolean,internalIndex:{type:Number,default:0}},bi=Pe({name:"Step",props:hi,slots:Object,setup(o){const P=Jt(cn,null);P||Zt("step","`n-step` must be placed inside `n-steps`.");const{inlineThemeDisabled:E}=at(),{props:y,mergedThemeRef:u,mergedClsPrefixRef:g,stepsSlots:e}=P,h=ke(()=>y.vertical),b=ke(()=>{const{status:c}=o;if(c)return c;{const{internalIndex:$}=o,{current:d}=y;if(d===void 0)return"process";if($<d)return"finish";if($===d)return y.status||"process";if($>d)return"wait"}return"process"}),x=ke(()=>{const{value:c}=b,{size:$}=y,{common:{cubicBezierEaseInOut:d},self:{stepHeaderFontWeight:f,[me("stepHeaderFontSize",$)]:C,[me("indicatorIndexFontSize",$)]:j,[me("indicatorSize",$)]:k,[me("indicatorIconSize",$)]:M,[me("indicatorTextColor",c)]:S,[me("indicatorBorderColor",c)]:ie,[me("headerTextColor",c)]:se,[me("splitorColor",c)]:O,[me("indicatorColor",c)]:we,[me("descriptionTextColor",c)]:ce}}=u.value;return{"--n-bezier":d,"--n-description-text-color":ce,"--n-header-text-color":se,"--n-indicator-border-color":ie,"--n-indicator-color":we,"--n-indicator-icon-size":M,"--n-indicator-index-font-size":j,"--n-indicator-size":k,"--n-indicator-text-color":S,"--n-splitor-color":O,"--n-step-header-font-size":C,"--n-step-header-font-weight":f}}),s=E?Yt("step",ke(()=>{const{value:c}=b,{size:$}=y;return`${c[0]}${$[0]}`}),x,y):void 0,v=ke(()=>{if(o.disabled)return;const{onUpdateCurrent:c,"onUpdate:current":$}=y;return c||$?()=>{c&&Ut(c,o.internalIndex),$&&Ut($,o.internalIndex)}:void 0});return{stepsSlots:e,mergedClsPrefix:g,vertical:h,mergedStatus:b,handleStepClick:v,cssVars:E?void 0:x,themeClass:s==null?void 0:s.themeClass,onRender:s==null?void 0:s.onRender}},render(){const{mergedClsPrefix:o,onRender:P,handleStepClick:E,disabled:y}=this,u=rt(this.$slots.default,g=>{const e=g||this.description;return e?p("div",{class:`${o}-step-content__description`},e):null});return P==null||P(),p("div",{class:[`${o}-step`,y&&`${o}-step--disabled`,!y&&E&&`${o}-step--clickable`,this.themeClass,u&&`${o}-step--show-description`,`${o}-step--${this.mergedStatus}-status`],style:this.cssVars,onClick:E},p("div",{class:`${o}-step-indicator`},p("div",{class:`${o}-step-indicator-slot`},p(qn,null,{default:()=>rt(this.$slots.icon,g=>{const{mergedStatus:e,stepsSlots:h}=this;return e==="finish"||e==="error"?e==="finish"?p(Ot,{clsPrefix:o,key:"finish"},{default:()=>qe(h["finish-icon"],()=>[p(Kn,null)])}):e==="error"?p(Ot,{clsPrefix:o,key:"error"},{default:()=>qe(h["error-icon"],()=>[p(Gn,null)])}):null:g||p("div",{key:this.internalIndex,class:`${o}-step-indicator-slot__index`},this.internalIndex)})})),this.vertical?p("div",{class:`${o}-step-splitor`}):null),p("div",{class:`${o}-step-content`},p("div",{class:`${o}-step-content-header`},p("div",{class:`${o}-step-content-header__title`},qe(this.$slots.title,()=>[this.title])),this.vertical?null:p("div",{class:`${o}-step-splitor`})),u))}}),Nt=1.25,xi=q("timeline",`
 position: relative;
 width: 100%;
 display: flex;
 flex-direction: column;
 line-height: ${Nt};
`,[Fe("horizontal",`
 flex-direction: row;
 `,[xe(">",[q("timeline-item",`
 flex-shrink: 0;
 padding-right: 40px;
 `,[Fe("dashed-line-type",[xe(">",[q("timeline-item-timeline",[de("line",`
 background-image: linear-gradient(90deg, var(--n-color-start), var(--n-color-start) 50%, transparent 50%, transparent 100%);
 background-size: 10px 1px;
 `)])])]),xe(">",[q("timeline-item-content",`
 margin-top: calc(var(--n-icon-size) + 12px);
 `,[xe(">",[de("meta",`
 margin-top: 6px;
 margin-bottom: unset;
 `)])]),q("timeline-item-timeline",`
 width: 100%;
 height: calc(var(--n-icon-size) + 12px);
 `,[de("line",`
 left: var(--n-icon-size);
 top: calc(var(--n-icon-size) / 2 - 1px);
 right: 0px;
 width: unset;
 height: 2px;
 `)])])])])]),Fe("right-placement",[q("timeline-item",[q("timeline-item-content",`
 text-align: right;
 margin-right: calc(var(--n-icon-size) + 12px);
 `),q("timeline-item-timeline",`
 width: var(--n-icon-size);
 right: 0;
 `)])]),Fe("left-placement",[q("timeline-item",[q("timeline-item-content",`
 margin-left: calc(var(--n-icon-size) + 12px);
 `),q("timeline-item-timeline",`
 left: 0;
 `)])]),q("timeline-item",`
 position: relative;
 `,[xe("&:last-child",[q("timeline-item-timeline",[de("line",`
 display: none;
 `)]),q("timeline-item-content",[de("meta",`
 margin-bottom: 0;
 `)])]),q("timeline-item-content",[de("title",`
 margin: var(--n-title-margin);
 font-size: var(--n-title-font-size);
 transition: color .3s var(--n-bezier);
 font-weight: var(--n-title-font-weight);
 color: var(--n-title-text-color);
 `),de("content",`
 transition: color .3s var(--n-bezier);
 font-size: var(--n-content-font-size);
 color: var(--n-content-text-color);
 `),de("meta",`
 transition: color .3s var(--n-bezier);
 font-size: 12px;
 margin-top: 6px;
 margin-bottom: 20px;
 color: var(--n-meta-text-color);
 `)]),Fe("dashed-line-type",[q("timeline-item-timeline",[de("line",`
 --n-color-start: var(--n-line-color);
 transition: --n-color-start .3s var(--n-bezier);
 background-color: transparent;
 background-image: linear-gradient(180deg, var(--n-color-start), var(--n-color-start) 50%, transparent 50%, transparent 100%);
 background-size: 1px 10px;
 `)])]),q("timeline-item-timeline",`
 width: calc(var(--n-icon-size) + 12px);
 position: absolute;
 top: calc(var(--n-title-font-size) * ${Nt} / 2 - var(--n-icon-size) / 2);
 height: 100%;
 `,[de("circle",`
 border: var(--n-circle-border);
 transition:
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 width: var(--n-icon-size);
 height: var(--n-icon-size);
 border-radius: var(--n-icon-size);
 box-sizing: border-box;
 `),de("icon",`
 color: var(--n-icon-color);
 font-size: var(--n-icon-size);
 height: var(--n-icon-size);
 width: var(--n-icon-size);
 display: flex;
 align-items: center;
 justify-content: center;
 `),de("line",`
 transition: background-color .3s var(--n-bezier);
 position: absolute;
 top: var(--n-icon-size);
 left: calc(var(--n-icon-size) / 2 - 1px);
 bottom: 0px;
 width: 2px;
 background-color: var(--n-line-color);
 `)])])]),ki=Object.assign(Object.assign({},st.props),{horizontal:Boolean,itemPlacement:{type:String,default:"left"},size:{type:String,default:"medium"},iconSize:Number}),pn=Kt("n-timeline"),fn=Pe({name:"Timeline",props:ki,setup(o,{slots:P}){const{mergedClsPrefixRef:E}=at(o),y=st("Timeline","-timeline",xi,pi,o,E);return Gt(pn,{props:o,mergedThemeRef:y,mergedClsPrefixRef:E}),()=>{const{value:u}=E;return p("div",{class:[`${u}-timeline`,o.horizontal&&`${u}-timeline--horizontal`,`${u}-timeline--${o.size}-size`,!o.horizontal&&`${u}-timeline--${o.itemPlacement}-placement`]},P)}}}),Li={time:[String,Number],title:String,content:String,color:String,lineType:{type:String,default:"default"},type:{type:String,default:"default"}},B=Pe({name:"TimelineItem",props:Li,slots:Object,setup(o){const P=Jt(pn);P||Zt("timeline-item","`n-timeline-item` must be placed inside `n-timeline`."),ui();const{inlineThemeDisabled:E}=at(),y=ke(()=>{const{props:{size:g,iconSize:e},mergedThemeRef:h}=P,{type:b}=o,{self:{titleTextColor:x,contentTextColor:s,metaTextColor:v,lineColor:c,titleFontWeight:$,contentFontSize:d,[me("iconSize",g)]:f,[me("titleMargin",g)]:C,[me("titleFontSize",g)]:j,[me("circleBorder",b)]:k,[me("iconColor",b)]:M},common:{cubicBezierEaseInOut:S}}=h.value;return{"--n-bezier":S,"--n-circle-border":k,"--n-icon-color":M,"--n-content-font-size":d,"--n-content-text-color":s,"--n-line-color":c,"--n-meta-text-color":v,"--n-title-font-size":j,"--n-title-font-weight":$,"--n-title-margin":C,"--n-title-text-color":x,"--n-icon-size":Jn(e)||f}}),u=E?Yt("timeline-item",ke(()=>{const{props:{size:g,iconSize:e}}=P,{type:h}=o;return`${g[0]}${e||"a"}${h[0]}`}),y,P.props):void 0;return{mergedClsPrefix:P.mergedClsPrefixRef,cssVars:E?void 0:y,themeClass:u==null?void 0:u.themeClass,onRender:u==null?void 0:u.onRender}},render(){const{mergedClsPrefix:o,color:P,onRender:E,$slots:y}=this;return E==null||E(),p("div",{class:[`${o}-timeline-item`,this.themeClass,`${o}-timeline-item--${this.type}-type`,`${o}-timeline-item--${this.lineType}-line-type`],style:this.cssVars},p("div",{class:`${o}-timeline-item-timeline`},p("div",{class:`${o}-timeline-item-timeline__line`}),rt(y.icon,u=>u?p("div",{class:`${o}-timeline-item-timeline__icon`,style:{color:P}},u):p("div",{class:`${o}-timeline-item-timeline__circle`,style:{borderColor:P}}))),p("div",{class:`${o}-timeline-item-content`},rt(y.header,u=>u||this.title?p("div",{class:`${o}-timeline-item-content__title`},u||this.title):null),p("div",{class:`${o}-timeline-item-content__content`},qe(y.default,()=>[this.content])),p("div",{class:`${o}-timeline-item-content__meta`},qe(y.footer,()=>[this.time]))))}});function Ci(o){return ue({url:"/aftermarketComp/getPage.do",method:"get",params:function(){console.log("params",o);const P={...o};return Object.prototype.hasOwnProperty.call(P,"checkboxList")&&delete P.checkboxList,P}()})}function Bt(o,P){return ue({url:"/aftermarketComp/insert.do?creater="+o,method:"post",data:P})}function ht(o){return ue({url:"/aftermarketComp/update.do",method:"put",data:o})}function wi(o){return ue({url:"/aftermarketComp/review.do",method:"put",data:Zn.stringify(o)})}function _i(o,P){return ue({url:"/aftermarketComp/delete.do",method:"delete",params:{arrIds:o.join(","),pwd:P}})}function Si(o){return ue({url:"/aftermarket/getProjectPage.do",method:"get",params:o})}function Fi(o){return ue({url:"/aftermarket/getPage.do",method:"get",params:o})}function zi(o){return ue({url:"/aftermarket/getById.do",method:"get",params:o})}function Mt(o,P){return ue({url:"/aftermarket/insert.do?uid="+P,method:"post",data:o})}function bt(o){return ue({url:"/aftermarket/update.do",method:"put",data:o})}function Ei(o,P){return ue({url:"/aftermarket/delete.do",method:"delete",params:{arrIds:o.join(","),pwd:P}})}function ji(o){return ue({url:"/aftermarketRes/getPage.do",method:"get",params:o})}function $i(o){return ue({url:"/aftermarketRes/insert.do",method:"post",data:o})}function Pi(o){return ue({url:"/aftermarketRes/update.do",method:"put",data:o})}function Ii(o){return ue({url:"/aftermarketRes/delete.do",method:"delete",params:{arrIds:o.join(",")}})}function Ai(o){return ue({url:"/aftermarket/selectBySn.do",method:"get",params:{sn:o,_t:new Date().getTime()}})}var xt={exports:{}},Ht;function Ti(){return Ht||(Ht=1,function(o,P){(function(y,u){o.exports=u()})(window,function(){return function(E){var y={};function u(g){if(y[g])return y[g].exports;var e=y[g]={i:g,l:!1,exports:{}};return E[g].call(e.exports,e,e.exports,u),e.l=!0,e.exports}return u.m=E,u.c=y,u.d=function(g,e,h){u.o(g,e)||Object.defineProperty(g,e,{enumerable:!0,get:h})},u.r=function(g){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(g,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(g,"__esModule",{value:!0})},u.t=function(g,e){if(e&1&&(g=u(g)),e&8||e&4&&typeof g=="object"&&g&&g.__esModule)return g;var h=Object.create(null);if(u.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:g}),e&2&&typeof g!="string")for(var b in g)u.d(h,b,(function(x){return g[x]}).bind(null,b));return h},u.n=function(g){var e=g&&g.__esModule?function(){return g.default}:function(){return g};return u.d(e,"a",e),e},u.o=function(g,e){return Object.prototype.hasOwnProperty.call(g,e)},u.p="",u(u.s=0)}({"./src/index.js":function(E,y,u){u.r(y),u("./src/sass/index.scss");var g=u("./src/js/init.js"),e=g.default.init;typeof window<"u"&&(window.printJS=e),y.default=e},"./src/js/browser.js":function(E,y,u){u.r(y);var g={isFirefox:function(){return typeof InstallTrigger<"u"},isIE:function(){return navigator.userAgent.indexOf("MSIE")!==-1||!!document.documentMode},isEdge:function(){return!g.isIE()&&!!window.StyleMedia},isChrome:function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;return!!h.chrome},isSafari:function(){return Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0||navigator.userAgent.toLowerCase().indexOf("safari")!==-1},isIOSChrome:function(){return navigator.userAgent.toLowerCase().indexOf("crios")!==-1}};y.default=g},"./src/js/functions.js":function(E,y,u){u.r(y),u.d(y,"addWrapper",function(){return b}),u.d(y,"capitalizePrint",function(){return x}),u.d(y,"collectStyles",function(){return s}),u.d(y,"addHeader",function(){return c}),u.d(y,"cleanUp",function(){return $}),u.d(y,"isRawHTML",function(){return d});var g=u("./src/js/modal.js"),e=u("./src/js/browser.js");function h(f){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?h=function(j){return typeof j}:h=function(j){return j&&typeof Symbol=="function"&&j.constructor===Symbol&&j!==Symbol.prototype?"symbol":typeof j},h(f)}function b(f,C){var j="font-family:"+C.font+" !important; font-size: "+C.font_size+" !important; width:100%;";return'<div style="'+j+'">'+f+"</div>"}function x(f){return f.charAt(0).toUpperCase()+f.slice(1)}function s(f,C){for(var j=document.defaultView||window,k="",M=j.getComputedStyle(f,""),S=0;S<M.length;S++)(C.targetStyles.indexOf("*")!==-1||C.targetStyle.indexOf(M[S])!==-1||v(C.targetStyles,M[S]))&&M.getPropertyValue(M[S])&&(k+=M[S]+":"+M.getPropertyValue(M[S])+";");return k+="max-width: "+C.maxWidth+"px !important; font-size: "+C.font_size+" !important;",k}function v(f,C){for(var j=0;j<f.length;j++)if(h(C)==="object"&&C.indexOf(f[j])!==-1)return!0;return!1}function c(f,C){var j=document.createElement("div");if(d(C.header))j.innerHTML=C.header;else{var k=document.createElement("h1"),M=document.createTextNode(C.header);k.appendChild(M),k.setAttribute("style",C.headerStyle),j.appendChild(k)}f.insertBefore(j,f.childNodes[0])}function $(f){f.showModal&&g.default.close(),f.onLoadingEnd&&f.onLoadingEnd(),(f.showModal||f.onLoadingStart)&&window.URL.revokeObjectURL(f.printable);var C="mouseover";(e.default.isChrome()||e.default.isFirefox())&&(C="focus");var j=function k(){window.removeEventListener(C,k),f.onPrintDialogClose();var M=document.getElementById(f.frameId);M&&M.remove()};window.addEventListener(C,j)}function d(f){var C=new RegExp("<([A-Za-z][A-Za-z0-9]*)\\b[^>]*>(.*?)</\\1>");return C.test(f)}},"./src/js/html.js":function(E,y,u){u.r(y);var g=u("./src/js/functions.js"),e=u("./src/js/print.js");function h(s){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?h=function(c){return typeof c}:h=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},h(s)}y.default={print:function(v,c){var $=x(v.printable)?v.printable:document.getElementById(v.printable);if(!$){window.console.error("Invalid HTML element id: "+v.printable);return}v.printableElement=b($,v),v.header&&Object(g.addHeader)(v.printableElement,v),e.default.send(v,c)}};function b(s,v){for(var c=s.cloneNode(),$=Array.prototype.slice.call(s.childNodes),d=0;d<$.length;d++)if(v.ignoreElements.indexOf($[d].id)===-1){var f=b($[d],v);c.appendChild(f)}switch(v.scanStyles&&s.nodeType===1&&c.setAttribute("style",Object(g.collectStyles)(s,v)),s.tagName){case"SELECT":c.value=s.value;break;case"CANVAS":c.getContext("2d").drawImage(s,0,0);break}return c}function x(s){return h(s)==="object"&&s&&(s instanceof HTMLElement||s.nodeType===1)}},"./src/js/image.js":function(E,y,u){u.r(y);var g=u("./src/js/functions.js"),e=u("./src/js/print.js"),h=u("./src/js/browser.js");y.default={print:function(x,s){x.printable.constructor!==Array&&(x.printable=[x.printable]),x.printableElement=document.createElement("div"),x.printable.forEach(function(v){var c=document.createElement("img");if(c.setAttribute("style",x.imageStyle),c.src=v,h.default.isFirefox()){var $=c.src;c.src=$}var d=document.createElement("div");d.appendChild(c),x.printableElement.appendChild(d)}),x.header&&Object(g.addHeader)(x.printableElement,x),e.default.send(x,s)}}},"./src/js/init.js":function(E,y,u){u.r(y);var g=u("./src/js/browser.js"),e=u("./src/js/modal.js"),h=u("./src/js/pdf.js"),b=u("./src/js/html.js"),x=u("./src/js/raw-html.js"),s=u("./src/js/image.js"),v=u("./src/js/json.js");function c(d){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?c=function(C){return typeof C}:c=function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},c(d)}var $=["pdf","html","image","json","raw-html"];y.default={init:function(){var f={printable:null,fallbackPrintable:null,type:"pdf",header:null,headerStyle:"font-weight: 300;",maxWidth:800,properties:null,gridHeaderStyle:"font-weight: bold; padding: 5px; border: 1px solid #dddddd;",gridStyle:"border: 1px solid lightgray; margin-bottom: -1px;",showModal:!1,onError:function(se){throw se},onLoadingStart:null,onLoadingEnd:null,onPrintDialogClose:function(){},onIncompatibleBrowser:function(){},modalMessage:"Retrieving Document...",frameId:"printJS",printableElement:null,documentTitle:"Document",targetStyle:["clear","display","width","min-width","height","min-height","max-height"],targetStyles:["border","box","break","text-decoration"],ignoreElements:[],repeatTableHeader:!0,css:null,style:null,scanStyles:!0,base64:!1,onPdfOpen:null,font:"TimesNewRoman",font_size:"12pt",honorMarginPadding:!0,honorColor:!1,imageStyle:"max-width: 100%;"},C=arguments[0];if(C===void 0)throw new Error("printJS expects at least 1 attribute.");switch(c(C)){case"string":f.printable=encodeURI(C),f.fallbackPrintable=f.printable,f.type=arguments[1]||f.type;break;case"object":f.printable=C.printable,f.fallbackPrintable=typeof C.fallbackPrintable<"u"?C.fallbackPrintable:f.printable,f.fallbackPrintable=f.base64?"data:application/pdf;base64,".concat(f.fallbackPrintable):f.fallbackPrintable;for(var j in f)j==="printable"||j==="fallbackPrintable"||(f[j]=typeof C[j]<"u"?C[j]:f[j]);break;default:throw new Error('Unexpected argument type! Expected "string" or "object", got '+c(C))}if(!f.printable)throw new Error("Missing printable information.");if(!f.type||typeof f.type!="string"||$.indexOf(f.type.toLowerCase())===-1)throw new Error("Invalid print type. Available types are: pdf, html, image and json.");f.showModal&&e.default.show(f),f.onLoadingStart&&f.onLoadingStart();var k=document.getElementById(f.frameId);k&&k.parentNode.removeChild(k);var M=document.createElement("iframe");switch(g.default.isFirefox()?M.setAttribute("style","width: 1px; height: 100px; position: fixed; left: 0; top: 0; opacity: 0; border-width: 0; margin: 0; padding: 0"):M.setAttribute("style","visibility: hidden; height: 0; width: 0; position: absolute; border: 0"),M.setAttribute("id",f.frameId),f.type!=="pdf"&&(M.srcdoc="<html><head><title>"+f.documentTitle+"</title>",f.css&&(Array.isArray(f.css)||(f.css=[f.css]),f.css.forEach(function(ie){M.srcdoc+='<link rel="stylesheet" href="'+ie+'">'})),M.srcdoc+="</head><body></body></html>"),f.type){case"pdf":if(g.default.isIE())try{console.info("Print.js doesn't support PDF printing in Internet Explorer.");var S=window.open(f.fallbackPrintable,"_blank");S.focus(),f.onIncompatibleBrowser()}catch(ie){f.onError(ie)}finally{f.showModal&&e.default.close(),f.onLoadingEnd&&f.onLoadingEnd()}else h.default.print(f,M);break;case"image":s.default.print(f,M);break;case"html":b.default.print(f,M);break;case"raw-html":x.default.print(f,M);break;case"json":v.default.print(f,M);break}}}},"./src/js/json.js":function(E,y,u){u.r(y);var g=u("./src/js/functions.js"),e=u("./src/js/print.js");function h(x){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?h=function(v){return typeof v}:h=function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},h(x)}y.default={print:function(s,v){if(h(s.printable)!=="object")throw new Error("Invalid javascript data object (JSON).");if(typeof s.repeatTableHeader!="boolean")throw new Error("Invalid value for repeatTableHeader attribute (JSON).");if(!s.properties||!Array.isArray(s.properties))throw new Error("Invalid properties array for your JSON data.");s.properties=s.properties.map(function(c){return{field:h(c)==="object"?c.field:c,displayName:h(c)==="object"?c.displayName:c,columnSize:h(c)==="object"&&c.columnSize?c.columnSize+";":100/s.properties.length+"%;"}}),s.printableElement=document.createElement("div"),s.header&&Object(g.addHeader)(s.printableElement,s),s.printableElement.innerHTML+=b(s),e.default.send(s,v)}};function b(x){var s=x.printable,v=x.properties,c='<table style="border-collapse: collapse; width: 100%;">';x.repeatTableHeader&&(c+="<thead>"),c+="<tr>";for(var $=0;$<v.length;$++)c+='<th style="width:'+v[$].columnSize+";"+x.gridHeaderStyle+'">'+Object(g.capitalizePrint)(v[$].displayName)+"</th>";c+="</tr>",x.repeatTableHeader&&(c+="</thead>"),c+="<tbody>";for(var d=0;d<s.length;d++){c+="<tr>";for(var f=0;f<v.length;f++){var C=s[d],j=v[f].field.split(".");if(j.length>1)for(var k=0;k<j.length;k++)C=C[j[k]];else C=C[v[f].field];c+='<td style="width:'+v[f].columnSize+x.gridStyle+'">'+C+"</td>"}c+="</tr>"}return c+="</tbody></table>",c}},"./src/js/modal.js":function(E,y,u){u.r(y);var g={show:function(h){var b="font-family:sans-serif; display:table; text-align:center; font-weight:300; font-size:30px; left:0; top:0;position:fixed; z-index: 9990;color: #0460B5; width: 100%; height: 100%; background-color:rgba(255,255,255,.9);transition: opacity .3s ease;",x=document.createElement("div");x.setAttribute("style",b),x.setAttribute("id","printJS-Modal");var s=document.createElement("div");s.setAttribute("style","display:table-cell; vertical-align:middle; padding-bottom:100px;");var v=document.createElement("div");v.setAttribute("class","printClose"),v.setAttribute("id","printClose"),s.appendChild(v);var c=document.createElement("span");c.setAttribute("class","printSpinner"),s.appendChild(c);var $=document.createTextNode(h.modalMessage);s.appendChild($),x.appendChild(s),document.getElementsByTagName("body")[0].appendChild(x),document.getElementById("printClose").addEventListener("click",function(){g.close()})},close:function(){var h=document.getElementById("printJS-Modal");h&&h.parentNode.removeChild(h)}};y.default=g},"./src/js/pdf.js":function(E,y,u){u.r(y);var g=u("./src/js/print.js"),e=u("./src/js/functions.js");y.default={print:function(x,s){if(x.base64){var v=Uint8Array.from(atob(x.printable),function($){return $.charCodeAt(0)});h(x,s,v);return}x.printable=/^(blob|http|\/\/)/i.test(x.printable)?x.printable:window.location.origin+(x.printable.charAt(0)!=="/"?"/"+x.printable:x.printable);var c=new window.XMLHttpRequest;c.responseType="arraybuffer",c.addEventListener("error",function(){Object(e.cleanUp)(x),x.onError(c.statusText,c)}),c.addEventListener("load",function(){if([200,201].indexOf(c.status)===-1){Object(e.cleanUp)(x),x.onError(c.statusText,c);return}h(x,s,c.response)}),c.open("GET",x.printable,!0),c.send()}};function h(b,x,s){var v=new window.Blob([s],{type:"application/pdf"});v=window.URL.createObjectURL(v),x.setAttribute("src",v),g.default.send(b,x)}},"./src/js/print.js":function(E,y,u){u.r(y);var g=u("./src/js/browser.js"),e=u("./src/js/functions.js"),h={send:function(c,$){document.getElementsByTagName("body")[0].appendChild($);var d=document.getElementById(c.frameId);d.onload=function(){if(c.type==="pdf"){g.default.isFirefox()?setTimeout(function(){return b(d,c)},1e3):b(d,c);return}var f=d.contentWindow||d.contentDocument;if(f.document&&(f=f.document),f.body.appendChild(c.printableElement),c.type!=="pdf"&&c.style){var C=document.createElement("style");C.innerHTML=c.style,f.head.appendChild(C)}var j=f.getElementsByTagName("img");j.length>0?x(Array.from(j)).then(function(){return b(d,c)}):b(d,c)}}};function b(v,c){try{if(v.focus(),g.default.isEdge()||g.default.isIE())try{v.contentWindow.document.execCommand("print",!1,null)}catch{v.contentWindow.print()}else v.contentWindow.print()}catch($){c.onError($)}finally{g.default.isFirefox()&&(v.style.visibility="hidden",v.style.left="-1px"),Object(e.cleanUp)(c)}}function x(v){var c=v.map(function($){if($.src&&$.src!==window.location.href)return s($)});return Promise.all(c)}function s(v){return new Promise(function(c){var $=function d(){!v||typeof v.naturalWidth>"u"||v.naturalWidth===0||!v.complete?setTimeout(d,500):c()};$()})}y.default=h},"./src/js/raw-html.js":function(E,y,u){u.r(y);var g=u("./src/js/print.js");y.default={print:function(h,b){h.printableElement=document.createElement("div"),h.printableElement.setAttribute("style","width:100%"),h.printableElement.innerHTML=h.printable,g.default.send(h,b)}}},"./src/sass/index.scss":function(E,y,u){},0:function(E,y,u){E.exports=u("./src/index.js")}}).default})}(xt)),xt.exports}var Ri=Ti();const Oi=Yn(Ri),Ui=async(o,P=`${o} 已复制`)=>{var E,y,u,g,e,h;try{if(!o)return;await Di(o),P===!0?((E=window.$message)==null||E.destroyAll(),(y=window.$message)==null||y.success("已复制")):P&&((u=window.$message)==null||u.destroyAll(),(g=window.$message)==null||g.success(P))}catch{(e=window.$message)==null||e.destroyAll(),(h=window.$message)==null||h.error("复制失败")}},Di=async o=>{var P,E;if(navigator.clipboard)await navigator.clipboard.writeText(o);else{const y=document.createElement("textarea");y.textContent=o,y.style.position="absolute",y.style.left="-9999px",document.body.appendChild(y),y.select();try{document.execCommand("copy")||((P=window.$message)==null||P.destroyAll(),(E=window.$message)==null||E.error("当前环境无法复制到剪切板"))}catch(u){throw u}finally{document.body.removeChild(y)}}},Ni=["src"],Bi=Pe({name:"OperateDrawer",__name:"operate-drawer",props:kt({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:kt(["submitted"],["update:visible"]),setup(o,{emit:P}){const E=P,y=Qt(),u=o,g=Lt(),e=be(f()),h=re(100),b=re(1),x=re(0),s=be([{label:"标准双向寄送",value:0},{label:"仅客户寄回",value:1},{label:"我司先寄双向",value:2},{label:"仅我司寄出",value:3}]),v=[{key:"dbtime",title:"创建时间",align:"center",width:160,fixed:"left"},{key:"comp",title:"客户信息",width:200,fixed:"left",align:"center",ellipsis:{tooltip:!0}},{key:"sn",title:"客户设备信息",width:200,titleAlign:"center",ellipsis:{tooltip:!0},render:l=>{const r=l.sn?l.rsn?l.rsn==l.sn||l.rsn.includes("无")?l.sn:l.sn+'(<span style="color: red; font-weight: bold;">更换</span>)':l.sn:"--";return p("div",{class:"flex flex-col items-start justify-start gap-1"},[p("div",{class:"w-full truncate",title:`设备编号：${l.sn||"--"}`,innerHTML:`设备编号：${r}`}),p("div",{class:"w-full truncate",title:`设备型号：${l.model||"--"}`},`设备型号：${l.model||"--"}`)])}},{key:"project",title:"项目名称",align:"center",width:180,ellipsis:{tooltip:!0}},{key:"fault",title:"故障现象",align:"center",width:120,ellipsis:{tooltip:!0}},{key:"duration",title:"处理时长",align:"center",width:180,ellipsis:{tooltip:!0}},{key:"status",align:"center",width:120,fixed:"right",title:()=>p("div",{class:"flex flex-col items-center justify-center"},[p("span","当前状态"),p("span",{style:"font-size: 11px; color: #FF0000; margin-top: 2px;"},"悬浮查看详情")]),render:l=>{const r=()=>{const{mtype:A,status:_}=l;return A===0?[p(B,{type:_>=0?"success":"default",time:l.dbtime},{default:()=>"待处理"}),p(B,{type:_>=1?"success":"default",time:l.redbtime},{default:()=>["分析中",l.receipt&&p("span",{style:{marginLeft:"5px"}},["(寄出单号: ",p("a",{href:`https://www.kuaidi100.com?nu=${encodeURIComponent(l.receipt)}`,target:"_blank",style:{color:"#4169E1",marginLeft:"5px"}},l.receipt),")"])]}),p(B,{type:_>=2?"success":"default"},{default:()=>"处理中"}),p(B,{type:_>=3?"success":"default"},{default:()=>"待寄回"}),p(B,{type:_>=4?"success":"default"},{default:()=>"待客户收件"}),p(B,{type:_>=5?"success":"default",time:l.rdbtime},{default:()=>["完成",l.returnnum&&p("span",{style:{marginLeft:"5px"}},["(寄出单号: ",p("a",{href:`https://www.kuaidi100.com?nu=${encodeURIComponent(l.returnnum)}`,target:"_blank",style:{color:"#4169E1",marginLeft:"5px"}},l.returnnum),")"])]})]:A===1?[p(B,{type:_>=0?"success":"default",time:l.dbtime},{default:()=>"待处理"}),p(B,{type:_>=1?"success":"default",time:l.return_time||l.complete_time},{default:()=>"完成"})]:A===2?[p(B,{type:_>=0?"success":"default",time:l.dbtime},{default:()=>"待处理"}),p(B,{type:_>=1?"success":"default"},{default:()=>"待客户收件"}),p(B,{type:_>=2?"success":"default"},{default:()=>"待我司收件"}),p(B,{type:_>=3?"success":"default",time:l.return_time||l.complete_time},{default:()=>"完成"})]:A===3?[p(B,{type:_>=0?"success":"default",time:l.dbtime},{default:()=>"待处理"}),p(B,{type:_>=1?"success":"default"},{default:()=>"待客户收件"}),p(B,{type:_>=2?"success":"default",time:l.return_time||l.complete_time},{default:()=>"完成"})]:[p(B,{type:_>=0?"success":"default",time:l.dbtime},{default:()=>"待处理"}),p(B,{type:_>=1?"success":"default",time:l.redbtime},{default:()=>["分析中",l.receipt&&p("span",{style:{marginLeft:"5px"}},["(寄出单号: ",p("a",{href:`https://www.kuaidi100.com?nu=${encodeURIComponent(l.receipt)}`,target:"_blank",style:{color:"#4169E1",marginLeft:"5px"}},l.receipt),")"])]}),p(B,{type:_>=2?"success":"default"},{default:()=>"处理中"}),p(B,{type:_>=3?"success":"default"},{default:()=>"待寄回"}),p(B,{type:_>=4?"success":"default"},{default:()=>"待客户收件"}),p(B,{type:_>=5?"success":"default",time:l.rdbtime},{default:()=>["完成",l.returnnum&&p("span",{style:{marginLeft:"5px"}},["(寄出单号: ",p("a",{href:`https://www.kuaidi100.com?nu=${encodeURIComponent(l.returnnum)}`,target:"_blank",style:{color:"#4169E1",marginLeft:"5px"}},l.returnnum),")"])]})]};return p(an,{placement:"top",style:{maxWidth:"450px"}},{trigger:()=>p(it,{type:"primary",style:{cursor:"pointer"}},{default:()=>d(l.mtype,l.status)}),default:()=>p("div",{class:"custom-timeline",style:{padding:"12px"}},[p("p",{style:{marginBottom:"12px",fontWeight:"bold"}},[p("strong",null,"当前状态："),d(l.mtype,l.status)]),p(fn,null,{default:()=>r()})])})}}],c=re([]);async function $(){try{const l=await Si({page:1,limit:10,_t:new Date().getTime()});c.value=l.data.list}catch(l){console.log("获取客户网关信息",l)}}const d=(l,r)=>l===0?r===0?"待处理":r===1?"分析中":r===2?"处理中":r===3?"待寄回":r===4?"待客户收件":r===5?"完成":"未知":l===1?r===0?"待处理":r===5?"完成":"未知":l===2?r===0?"待处理":r===1?"待客户收件":r===2?"待我司收件":r===5?"完成":"未知":l===3?r===0?"待处理":r===1?"待客户收件":r===5?"完成":"未知":r===0?"待处理":r===1?"分析中":r===2?"处理中":r===3?"待寄回":r===4?"待客户收件":r===5?"完成":"未知";function f(){return{id:0,sn:"",comp:"",contact:"",contactinfo:"",project:"",fault:"",dock:"",address:`收件人：吴越
手机号：19032214987
地址：浙江杭州市钱塘区6号路中自科技园 领祺科技 (13F幢)4楼`,details:0,accessory:"",receipt:"",rcontact:"",rcontactinfo:"",raddress:"",returnnum:"",re1:"",re2:"",re3:"",re4:"",re5:"",re6:"",re7:"",re8:"",re9:"",re10:"",re11:"",re12:"",rsn:"",rdetails:0,raccessory:"",videoSrc:"",fileList:[],sendFileList:[],receiveFileList:[],uploadVideoFileList:[],analyzeFileList:[],mtype:0}}async function C(){if(e.videoSrc="",e.fileList=[],e.sendFileList=[],e.receiveFileList=[],e.uploadVideoFileList=[],e.analyzeFileList=[],b.value=1,Object.assign(e,f()),await $(),u.operateType==="edit"&&u.rowData)O();else{let l=localStorage.getItem("draftData")?JSON.parse(localStorage.getItem("draftData")):{};JSON.stringify(l)!="{}"&&(b.value=l.currentStep||0,e.fileList=l.fileList||[],e.sendFileList=l.sendFileList||[],e.receiveFileList=l.receiveFileList||[],e.uploadVideoFileList=l.uploadVideoFileList||[],e.analyzeFileList=l.analyzeFileList||[],e.videoSrc=l.videoSrc,Object.assign(e,l))}await Ae()}const{formRef:j,validate:k,restoreValidation:M}=Ct(),S={sn:{validator:(l,r)=>{if(!r||r.trim().length===0)return new Error("请输入设备编号");const A=Ie(r);for(const _ of A){if(!_||_.trim().length===0)return new Error("存在空的设备编号，请检查输入");if(_==="null"||_==="undefined")return new Error("存在无效的设备编号，请检查输入");if(_.length<9)return new Error("设备编号长度至少 9 位")}return!0},trigger:["input","blur"]},comp:{type:"string",required:!0,trigger:["blur","change"],message:"请输入贵司名称"},contact:{type:"string",required:!0,trigger:["blur","change"],message:"请输入联系人"},contactinfo:{type:"string",required:!0,pattern:/^(?:\d{3}-\d{8}|\d{4}-\d{7,8}|1[3-9]\d{9})$/,trigger:["blur","change"],message:"请输入正确的联系方式"},project:{type:"string",required:!0,trigger:["blur","change"],message:"请输入项目名称"},fault:{type:"string",required:!0,trigger:["blur","change"],message:"请输入故障现象"},dock:[{type:"string",required:!0,trigger:["blur","change"],message:"请输入对接工程师"},{min:2,trigger:["blur","change"],message:"对接工程师至少输入2个字符"}],rcontact:{type:"string",required:!0,trigger:["blur","change"],message:"请输入联系人"},rcontactinfo:{type:"string",required:!0,pattern:/^(?:\d{3}-\d{8}|\d{4}-\d{7,8}|1[3-9]\d{9})$/,trigger:["blur","change"],message:"请输入正确的联系方式"},raddress:{type:"string",required:!0,trigger:["blur","change"],message:"请输入收件地址"},accessory:{type:"string",required:!1,trigger:["blur","change"],message:"请输入客户寄件配件详情"}},ie=ke(()=>{if(b.value===1)return{sn:S.sn};if(b.value===2){const l={comp:S.comp,contact:S.contact,contactinfo:S.contactinfo,project:S.project,fault:S.fault,dock:S.dock};return e.mtype===0?(e.details===1?l.accessory={...S.accessory,required:!0}:l.accessory={...S.accessory,required:!1},l.rcontact=S.rcontact,l.rcontactinfo=S.rcontactinfo,l.raddress=S.raddress):e.mtype===1?e.details===1?l.accessory={...S.accessory,required:!0}:l.accessory={...S.accessory,required:!1}:(e.mtype===2||e.mtype===3)&&(l.rcontact=S.rcontact,l.rcontactinfo=S.rcontactinfo,l.raddress=S.raddress),l}return{}}),se=ke(()=>({add:"新增",edit:"修改"})[u.operateType]);async function O(){var A;const{data:l,error:r}=await zi({id:(A=u.rowData)==null?void 0:A.id,_t:new Date().getTime()});r||(Object.assign(e,l),l.re1&&e.fileList.push({id:"0",name:"0",url:l.re1,status:"finished"}),l.re2&&e.fileList.push({id:"1",name:"1",url:l.re2,status:"finished"}),l.re3&&e.fileList.push({id:"2",name:"2",url:l.re2,status:"finished"}),l.re4&&(e.videoSrc=l.re4,e.uploadVideoFileList.push({id:"0",name:"0",url:l.re4,status:"finished"})),l.re5&&e.sendFileList.push({id:"0",name:"0",url:l.re5,status:"finished"}),l.re6&&e.sendFileList.push({id:"1",name:"1",url:l.re6,status:"finished"}),l.re7&&e.sendFileList.push({id:"2",name:"2",url:l.re7,status:"finished"}),l.re8&&e.receiveFileList.push({id:"0",name:"0",url:l.re8,status:"finished"}),l.re9&&e.receiveFileList.push({id:"1",name:"1",url:l.re9,status:"finished"}),l.re10&&e.receiveFileList.push({id:"2",name:"2",url:l.re10,status:"finished"}),l.re11&&e.analyzeFileList.push({id:"0",name:"0",url:l.re11,status:"finished"}),l.re12&&e.analyzeFileList.push({id:"1",name:"1",url:l.re12,status:"finished"}))}const we=ke(()=>{if(!e.sn)return[];let l=e.sn.trim();return l===""?[]:(l=l.replace(/，|、/g,","),l[l.length-1]===","&&(l=l.substring(0,l.length-1)),l.split(",").map(r=>r.trim().replace(/\u3000/g,"").trim()).filter(r=>r!==""))}),ce=Xt(o,"visible");Qn(ce,()=>{ce.value&&(C(),M())});function Le(l){let r=l.replace(/，/g,",").replace(/、/g,",").replace(/　/g," ");const A=Ie(r),_=r[r.length-1];if(A.length>=h.value&&_===","){We(()=>{e.sn=l.substring(0,l.length-1)});return}if(A.length>h.value){const I=A.slice(0,h.value).join(", ");We(()=>{e.sn=I});return}r!==l&&We(()=>{e.sn=r})}function Ie(l){return l?(l=l.trim(),l===""?[]:l.split(",").map(r=>r.trim().replace(/\u3000/g,"").trim()).filter(r=>r!=="")):[]}function ze(){b.value--}async function Ee(){await k(),b.value===1?ge(()=>{We(()=>{e.sn&&b.value++})}):(e.rcontact||(e.rcontact=e.contact),e.rcontactinfo||(e.rcontactinfo=e.contactinfo),b.value++)}async function ge(l){let r=[...we.value];if(r.length===0)return;async function A(){var Q,G,le;const _=r.shift();if(!_){l();return}const I=we.value;if(!I.includes(_)){A();return}try{const{data:K,error:pe}=await Ai(_);pe?y.warning({title:"提示",content:`编号 [${_}] ${(le=pe==null?void 0:pe.response)==null?void 0:le.data.data}，是否保留？`,positiveText:"保留",negativeText:"删除",maskClosable:!1,onPositiveClick:()=>{A()},onNegativeClick:()=>{const te=I.filter(ye=>ye!==_);e.sn=te.join(","),A()}}):typeof K=="string"?K==="该编号无任何记录"?y.warning({title:"提示",content:`编号 [${_}] 没有任何记录，是否继续？`,positiveText:"继续",negativeText:"删除",maskClosable:!1,onPositiveClick:()=>{A()},onNegativeClick:()=>{const te=I.filter(ye=>ye!==_);e.sn=te.join(","),A()}}):((Q=window.$message)==null||Q.destroyAll(),(G=window.$message)==null||G.info(`编号 [${_}] ${K}`),A()):(e.id||(e.comp=K.username,e.project=K.company),A())}catch(K){console.log("查询SN失败:",K),y.warning({title:"提示",content:`查询编号 [${_}] 失败，是否保留？`,positiveText:"保留",negativeText:"删除",maskClosable:!1,onPositiveClick:()=>{A()},onNegativeClick:()=>{const pe=I.filter(te=>te!==_);e.sn=pe.join(","),A()}})}}A()}async function Ae(){let l={_t:new Date().getTime()};ti.get("/companyReceiveaddress.json",{params:l}).then(({data:r})=>{r.username&&r.mobile&&r.address?e.address="收件人："+r.username+`
手机号：`+r.mobile+`
地址：`+r.address:e.address=`收件人：吴越
手机号：19032214987
地址：浙江杭州市钱塘区6号路中自科技园 领祺科技 (13F幢)4楼`}).catch(r=>(console.log("error",r),e.address=`收件人：吴越
手机号：19032214987
地址：浙江杭州市钱塘区6号路中自科技园 领祺科技 (13F幢)4楼`,!1))}function oe(l){var I,Q,G,le;const r=["image/jpeg","image/png","image/jpg","image/x-icon"];console.log("data.file.file",l.file.file);const A=r.includes(l.file.file.type),_=l.file.file.size/1024/1024<10;return A||((I=window.$message)==null||I.destroyAll(),(Q=window.$message)==null||Q.error("只能上传 JPG/PNG/JPEG/ICO 格式的图片")),_||((G=window.$message)==null||G.destroyAll(),(le=window.$message)==null||le.error("上传图片大小不能超过 10MB")),A&&_}async function je(l){var I,Q;const{file:r,onFinish:A,onError:_}=l;try{const G=await lt(r.file,r.name,"aftermarket/image");G&&(r.url=G,A({...r,url:G}),(I=window.$message)==null||I.destroyAll(),(Q=window.$message)==null||Q.success("上传成功"))}catch(G){_(G)}}function Ne(l){var I,Q,G,le;const r=["video/mp4","video/avi","video/mov","video/mpeg"];console.log("data.file.file",l.file.file);const A=r.includes(l.file.file.type),_=l.file.file.size/1024/1024<100;return A||((I=window.$message)==null||I.destroyAll(),(Q=window.$message)==null||Q.error("格式错误，请上传视频！")),_||((G=window.$message)==null||G.destroyAll(),(le=window.$message)==null||le.error("上传视频大小不能超过 100MB！")),A&&_}async function Ke(l){x.value=0;const{file:r,onFinish:A,onError:_}=l;try{const I=await lt(r.file,r.name,"aftermarket/image/",Q=>{x.value=Q});I&&(A({...r,url:I}),e.videoSrc=I,x.value=0)}catch(I){_(I)}}async function Ge(l){var I,Q;const{file:r,onFinish:A,onError:_}=l;try{const G=await lt(r.file,r.name,"aftermarket/image");G&&(r.url=G,A({...r,url:G}),(I=window.$message)==null||I.destroyAll(),(Q=window.$message)==null||Q.success("上传成功"))}catch(G){_(G)}}function dt(){var l,r;b.value===1?localStorage.setItem("draftData",JSON.stringify({currentStep:b.value,sn:e.sn,comp:e.comp,contact:e.contact,contactinfo:e.contactinfo,project:e.project,fault:e.fault,dock:e.dock,fileList:e.fileList,videoSrc:e.videoSrc,details:e.details,sendFileList:e.sendFileList,accessory:e.accessory,receipt:e.receipt,rcontact:e.rcontact,rcontactinfo:e.rcontactinfo,raddress:e.raddress,returnnum:e.returnnum,rsn:e.rsn,rdetails:e.rdetails,receiveFileList:e.receiveFileList,uploadVideoFileList:e.uploadVideoFileList,raccessory:e.raccessory,analyzeFileList:e.analyzeFileList,mtype:e.mtype})):localStorage.setItem("draftData",JSON.stringify({currentStep:b.value,sn:e.sn,comp:e.comp,contact:e.contact,contactinfo:e.contactinfo,project:e.project,fault:e.fault,dock:e.dock,fileList:e.fileList,videoSrc:e.videoSrc,details:e.details,sendFileList:e.sendFileList,accessory:e.accessory,receipt:e.receipt,rcontact:e.rcontact,rcontactinfo:e.rcontactinfo,raddress:e.raddress,returnnum:e.returnnum,rsn:e.rsn,rdetails:e.rdetails,receiveFileList:e.receiveFileList,uploadVideoFileList:e.uploadVideoFileList,raccessory:e.raccessory,analyzeFileList:e.analyzeFileList,mtype:e.mtype})),(l=window.$message)==null||l.destroyAll(),(r=window.$message)==null||r.success("草稿已保存")}function he(){ce.value=!1}function Be(l){return new Promise((r,A)=>{Ge({file:l,onFinish:()=>r(!0),onError:_=>A(_)})})}function ut(l){return new Promise((r,A)=>{Ke({file:l,onFinish:()=>r(!0),onError:_=>A(_)})})}async function Me(){var I,Q,G,le;await k();let l=[],r=[];if(e.details==1&&e.sendFileList.length==0)return(I=window.$message)==null||I.destroyAll(),(Q=window.$message)==null||Q.warning("客户寄出照片不能为空"),!1;if(e.rdetails==1&&e.receiveFileList.length==0)return(G=window.$message)==null||G.destroyAll(),(le=window.$message)==null||le.warning("寄出照片不能为空"),!1;await Promise.all([...e.fileList.map(K=>Be(K)),...e.sendFileList.map(K=>Be(K)),...e.receiveFileList.map(K=>Be(K)),...e.uploadVideoFileList.map(K=>ut(K))]),e.mtype===0?l.push({comp:e.comp,contact:e.contact,contactinfo:e.contactinfo,dock:e.dock,project:e.project,raddress:e.raddress,rcontact:e.rcontact,rcontactinfo:e.rcontactinfo,receipt:e.receipt,mtype:e.mtype,re1:e.sendFileList.length>0?e.sendFileList[0].url:null,re2:e.sendFileList.length>1?e.sendFileList[1].url:null,re3:e.sendFileList.length>2?e.sendFileList[2].url:null,re4:e.receiveFileList.length>0?e.receiveFileList[0].url:null,re5:e.receiveFileList.length>1?e.receiveFileList[1].url:null,re6:e.receiveFileList.length>2?e.receiveFileList[2].url:null}):e.mtype===1?l.push({comp:e.comp,contact:e.contact,contactinfo:e.contactinfo,dock:e.dock,project:e.project,receipt:e.receipt,mtype:e.mtype,re1:e.sendFileList.length>0?e.sendFileList[0].url:null,re2:e.sendFileList.length>1?e.sendFileList[1].url:null,re3:e.sendFileList.length>2?e.sendFileList[2].url:null}):e.mtype===2?l.push({comp:e.comp,contact:e.contact,contactinfo:e.contactinfo,dock:e.dock,project:e.project,raddress:e.raddress,rcontact:e.rcontact,rcontactinfo:e.rcontactinfo,receipt:e.receipt,mtype:e.mtype,re1:e.sendFileList.length>0?e.sendFileList[0].url:null,re2:e.sendFileList.length>1?e.sendFileList[1].url:null,re3:e.sendFileList.length>2?e.sendFileList[2].url:null,re4:e.receiveFileList.length>0?e.receiveFileList[0].url:null,re5:e.receiveFileList.length>1?e.receiveFileList[1].url:null,re6:e.receiveFileList.length>2?e.receiveFileList[2].url:null}):e.mtype===3&&l.push({comp:e.comp,contact:e.contact,contactinfo:e.contactinfo,dock:e.dock,project:e.project,raddress:e.raddress,rcontact:e.rcontact,rcontactinfo:e.rcontactinfo,receipt:e.receipt,mtype:e.mtype,re4:e.receiveFileList.length>0?e.receiveFileList[0].url:null,re5:e.receiveFileList.length>1?e.receiveFileList[1].url:null,re6:e.receiveFileList.length>2?e.receiveFileList[2].url:null});let A=we.value;if(e.mtype!=3&&!e.receipt)y.warning({title:"提示",content:"快递单号未填写，是否继续？",positiveText:"确定",negativeText:"取消",maskClosable:!1,onPositiveClick:async()=>{const{data:K,error:pe}=await Bt(g.userInfo.id?Number(g.userInfo.id):0,l);if(!pe){let ye=JSON.parse(K).uuid;for(var te=0;te<A.length;te++)r.push({sn:A[te],details:e.details,accessory:e.accessory,fault:e.fault,re1:e.fileList.length>0?e.fileList[0].url:null,re2:e.fileList.length>1?e.fileList[1].url:null,re3:e.fileList.length>2?e.fileList[2].url:null,re4:e.videoSrc||null});const{data:Ce,error:Te}=await Mt(r,ye);Te||(localStorage.removeItem("draftData"),he(),E("submitted"))}},onNegativeClick:()=>{}});else{const{data:K,error:pe}=await Bt(g.userInfo.id?Number(g.userInfo.id):0,l);if(!pe){let te=JSON.parse(K).uuid;for(var _=0;_<A.length;_++)e.mtype===0?r.push({sn:A[_],details:e.details,accessory:e.accessory,fault:e.fault,re1:e.fileList.length>0?e.fileList[0].url:null,re2:e.fileList.length>1?e.fileList[1].url:null,re3:e.fileList.length>2?e.fileList[2].url:null,re4:e.videoSrc||null}):e.mtype===1?r.push({sn:A[_],details:e.details,accessory:e.accessory,fault:e.fault,re1:e.fileList.length>0?e.fileList[0].url:null,re2:e.fileList.length>1?e.fileList[1].url:null,re3:e.fileList.length>2?e.fileList[2].url:null,re4:e.videoSrc||null}):e.mtype===2?r.push({sn:A[_],details:e.details,accessory:e.accessory,fault:e.fault,re1:e.fileList.length>0?e.fileList[0].url:null,re2:e.fileList.length>1?e.fileList[1].url:null,re3:e.fileList.length>2?e.fileList[2].url:null,re4:e.videoSrc||null}):e.mtype===3&&r.push({sn:A[_],details:e.details,fault:e.fault,returnnum:e.returnnum,rsn:e.rsn,rdetails:e.rdetails,raccessory:e.raccessory,re1:e.fileList.length>0?e.fileList[0].url:null,re2:e.fileList.length>1?e.fileList[1].url:null,re3:e.fileList.length>2?e.fileList[2].url:null,re4:e.videoSrc||null});const{data:ye,error:Ce}=await Mt(r,te);Ce||(localStorage.removeItem("draftData"),he(),E("submitted"))}}}return(l,r)=>{const A=bi,_=vi,I=Et,Q=en,G=St,le=tn,K=ei,pe=ln,te=Ft,ye=nn,Ce=zt,Te=Xn,Je=_t,Se=rn;return R(),U(Se,{show:ce.value,"onUpdate:show":r[19]||(r[19]=D=>ce.value=D),title:se.value,preset:"card",class:"w-85%"},{footer:a(()=>[n(te,{justify:"end",size:16,class:"pr-20px"},{default:a(()=>[n(m(T),{onClick:he},{default:a(()=>[z(Z(m(Y)("common.cancel")),1)]),_:1}),b.value!==1?(R(),U(m(T),{key:0,type:"primary",onClick:ze},{default:a(()=>r[26]||(r[26]=[z(Z("上一步"))])),_:1,__:[26]})):N("",!0),b.value!==1?(R(),U(m(T),{key:1,type:"primary",onClick:dt},{default:a(()=>r[27]||(r[27]=[z(Z("存为草稿"))])),_:1,__:[27]})):N("",!0),b.value===1?(R(),U(m(T),{key:2,type:"primary",onClick:Ee},{default:a(()=>r[28]||(r[28]=[z(Z("下一步"))])),_:1,__:[28]})):N("",!0),b.value===2?(R(),U(m(T),{key:3,type:"primary",onClick:Me},{default:a(()=>[z(Z(m(Y)("common.confirm")),1)]),_:1})):N("",!0)]),_:1})]),default:a(()=>[n(_,{current:b.value},{default:a(()=>[n(A,{title:"步骤一"}),n(A,{title:"步骤二"}),n(A,{title:"步骤三"})]),_:1},8,["current"]),r[29]||(r[29]=wt("div",{style:{"margin-top":"30px"}},null,-1)),n(Je,{ref_key:"formRef",ref:j,model:e,rules:ie.value,"label-placement":"left","label-width":140},{default:a(()=>[n(Te,{style:{"max-height":"600px"},class:"pr-20px"},{default:a(()=>[n(Ce,{responsive:"screen","item-responsive":""},{default:a(()=>[b.value===1?(R(),U(I,{key:0,span:"24 m:24 s:24",label:"设备编号",path:"sn"},{default:a(()=>[n(m(fe),{clearable:"",type:"textarea",value:e.sn,"onUpdate:value":r[0]||(r[0]=D=>e.sn=D),placeholder:"请输入设备编号",disabled:l.operateType==="edit",onInput:Le},null,8,["value","disabled"])]),_:1})):N("",!0),b.value===1?(R(),U(I,{key:1,span:"24 m:24 s:24",label:"最近售后记录",path:"comp"},{default:a(()=>[n(Q,{columns:v,data:c.value,size:"small",remote:"","max-height":400,"row-key":D=>D.id,class:"sm:h-full",striped:""},null,8,["data","row-key"])]),_:1})):N("",!0),b.value===2?(R(),U(I,{key:2,span:"24 m:12 s:12",label:"贵司名称",path:"comp"},{default:a(()=>[n(m(fe),{value:e.comp,"onUpdate:value":r[1]||(r[1]=D=>e.comp=D),placeholder:"请输入贵司名称"},null,8,["value"])]),_:1})):N("",!0),b.value===2?(R(),U(I,{key:3,span:"24 m:12 s:12",label:"联系人",path:"contact"},{default:a(()=>[n(m(fe),{value:e.contact,"onUpdate:value":r[2]||(r[2]=D=>e.contact=D),placeholder:"请输入联系人",clearable:""},null,8,["value"])]),_:1})):N("",!0),b.value===2?(R(),U(I,{key:4,span:"24 m:12 s:12",label:"联系方式",path:"contactinfo"},{default:a(()=>[n(m(fe),{value:e.contactinfo,"onUpdate:value":r[3]||(r[3]=D=>e.contactinfo=D),placeholder:"请输入联系方式",clearable:""},null,8,["value"])]),_:1})):N("",!0),b.value===2?(R(),U(I,{key:5,span:"24 m:12 s:12",label:"项目名称",path:"project"},{default:a(()=>[n(m(fe),{value:e.project,"onUpdate:value":r[4]||(r[4]=D=>e.project=D),placeholder:"请输入项目名称",clearable:""},null,8,["value"])]),_:1})):N("",!0),b.value===2?(R(),U(I,{key:6,span:"24 m:12 s:12",label:"售后类型",path:"mtype"},{default:a(()=>[n(G,{filterable:"",value:e.mtype,"onUpdate:value":r[5]||(r[5]=D=>e.mtype=D),placeholder:"请选择售后类型","label-field":"label","value-field":"value",options:s},null,8,["value","options"])]),_:1})):N("",!0),b.value===2?(R(),U(I,{key:7,span:"24 m:24 s:24",label:"故障现象",path:"fault"},{default:a(()=>[n(m(fe),{type:"textarea",value:e.fault,"onUpdate:value":r[6]||(r[6]=D=>e.fault=D),placeholder:"请输入故障现象",clearable:""},null,8,["value"])]),_:1})):N("",!0),b.value===2?(R(),U(I,{key:8,span:"24 m:24 s:24",label:"对接工程师",path:"dock"},{default:a(()=>[n(m(fe),{value:e.dock,"onUpdate:value":r[7]||(r[7]=D=>e.dock=D),placeholder:"请输入对接的厂家工程师, 例如胡工",clearable:""},null,8,["value"])]),_:1})):N("",!0),b.value===2?(R(),U(I,{key:9,span:"24 m:24 s:24",label:"现场照片"},{default:a(()=>[n(le,{multiple:"",max:3,"file-list":e.fileList,"onUpdate:fileList":r[8]||(r[8]=D=>e.fileList=D),"list-type":"image-card","default-upload":!1,onBeforeUpload:oe,"custom-request":je},{default:a(()=>r[20]||(r[20]=[z(" 点击上传 ")])),_:1,__:[20]},8,["file-list"])]),_:1})):N("",!0),b.value===2?(R(),U(I,{key:10,span:"24 m:24 s:24",label:"现场视频"},{default:a(()=>[n(le,{"show-file-list":!e.videoSrc,"file-list":e.uploadVideoFileList,"onUpdate:fileList":r[9]||(r[9]=D=>e.uploadVideoFileList=D),"default-upload":!1,onBeforeUpload:Ne,"custom-request":Ke},{default:a(()=>[n(m(T),{type:"primary"},{default:a(()=>r[21]||(r[21]=[z(" 上传视频 ")])),_:1,__:[21]})]),_:1},8,["show-file-list","file-list"])]),_:1})):N("",!0),b.value===2?(R(),U(I,{key:11,span:"24 m:24 s:24",label:"","label-width":"0"},{default:a(()=>[x.value&&!e.videoSrc?(R(),U(K,{key:0,type:"line",percentage:x.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):N("",!0),e.videoSrc?(R(),ot("video",{key:1,src:e.videoSrc,autoplay:"",style:{width:"100%"}},null,8,Ni)):N("",!0)]),_:1})):N("",!0),b.value===2&&e.mtype!==3?(R(),U(I,{key:12,span:"24 m:24 s:24",label:"客户寄件类型"},{default:a(()=>[n(ye,{value:e.details,"onUpdate:value":r[10]||(r[10]=D=>e.details=D),name:"radiogroup"},{default:a(()=>[n(te,null,{default:a(()=>[n(pe,{value:0},{default:a(()=>r[22]||(r[22]=[z("仅裸机")])),_:1,__:[22]}),n(pe,{value:1},{default:a(()=>r[23]||(r[23]=[z("含配件")])),_:1,__:[23]})]),_:1})]),_:1},8,["value"])]),_:1})):N("",!0),b.value===2&&e.mtype!==3?(R(),U(I,{key:13,span:"24 m:24 s:24",label:"我司收件信息"},{default:a(()=>[n(te,{justify:"space-between",align:"center"},{default:a(()=>[n(m(fe),{clearable:"",type:"textarea",value:e.address,"onUpdate:value":r[11]||(r[11]=D=>e.address=D),placeholder:"请输入我司收件信息",disabled:"",style:{width:"calc(100vw - 600px)"}},null,8,["value"]),n(m(T),{type:"primary",onClick:r[12]||(r[12]=D=>e.address&&m(Ui)(e.address,m(Y)("page.common.copySuccess")))},{default:a(()=>r[24]||(r[24]=[z("复制 ")])),_:1,__:[24]})]),_:1})]),_:1})):N("",!0),b.value===2&&e.mtype!==3?(R(),U(I,{key:14,span:"24 m:24 s:24",label:"客户寄出照片"},{default:a(()=>[n(le,{multiple:"",max:3,"file-list":e.sendFileList,"onUpdate:fileList":r[13]||(r[13]=D=>e.sendFileList=D),"list-type":"image-card","default-upload":!1,onBeforeUpload:oe,"custom-request":Ge},{default:a(()=>r[25]||(r[25]=[z(" 点击上传 ")])),_:1,__:[25]},8,["file-list"])]),_:1})):N("",!0),b.value===2&&e.details==1&&e.mtype!==3?(R(),U(I,{key:15,span:"24 m:24 s:24",label:"客户寄件配件详情",path:"accessory"},{default:a(()=>[n(m(fe),{value:e.accessory,"onUpdate:value":r[14]||(r[14]=D=>e.accessory=D),placeholder:"请输入客户寄件配件详情",clearable:""},null,8,["value"])]),_:1})):N("",!0),b.value===2&&e.mtype!==3?(R(),U(I,{key:16,span:"24 m:24 s:24",label:"客户寄出信息",path:"receipt"},{default:a(()=>[n(m(fe),{value:e.receipt,"onUpdate:value":r[15]||(r[15]=D=>e.receipt=D),placeholder:"请输入客户寄出信息",clearable:""},null,8,["value"])]),_:1})):N("",!0),b.value===2&&e.mtype!==1?(R(),U(I,{key:17,span:"24 m:24 s:24",label:"* 您的收件信息(售后完成时的回寄地址)","label-width":"100%","label-style":"font-size: 1.17em; font-weight: bolder;"})):N("",!0),b.value===2&&e.mtype!==1?(R(),U(I,{key:18,span:"24 m:12 s:12",label:"联系人",path:"rcontact"},{default:a(()=>[n(m(fe),{value:e.rcontact,"onUpdate:value":r[16]||(r[16]=D=>e.rcontact=D),placeholder:"请输入联系人",clearable:""},null,8,["value"])]),_:1})):N("",!0),b.value===2&&e.mtype!==1?(R(),U(I,{key:19,span:"24 m:12 s:12",label:"联系方式",path:"rcontactinfo"},{default:a(()=>[n(m(fe),{value:e.rcontactinfo,"onUpdate:value":r[17]||(r[17]=D=>e.rcontactinfo=D),placeholder:"请输入联系方式",clearable:""},null,8,["value"])]),_:1})):N("",!0),b.value===2&&e.mtype!==1?(R(),U(I,{key:20,span:"24 m:12 s:12",label:"收件地址",path:"raddress"},{default:a(()=>[n(m(fe),{value:e.raddress,"onUpdate:value":r[18]||(r[18]=D=>e.raddress=D),placeholder:"请输入收件地址",clearable:""},null,8,["value"])]),_:1})):N("",!0)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1,__:[29]},8,["show","title"])}}}),Mi={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"};function Hi(o,P){return R(),ot("svg",Mi,P[0]||(P[0]=[wt("path",{fill:"currentColor",d:"M8.616 20q-.667 0-1.141-.475T7 18.386V16H5.192q-.666 0-1.14-.475t-.475-1.14v-3.77q0-.85.577-1.424q.577-.576 1.423-.576h12.846q.85 0 1.425.576t.575 1.424v3.77q0 .666-.474 1.14T18.808 16H17v2.385q0 .666-.475 1.14t-1.14.475zm-3.424-5H7q.039-.633.502-1.086q.463-.452 1.114-.452h6.769q.65 0 1.113.453q.463.452.502 1.085h1.808q.269 0 .442-.173t.173-.442v-3.77q0-.424-.287-.712t-.713-.288H5.577q-.425 0-.712.288t-.288.713v3.769q0 .269.173.442t.442.173M16 8.616V6.23q0-.27-.173-.442q-.173-.173-.442-.173h-6.77q-.269 0-.442.173T8 6.23v2.385H7V6.23q0-.666.475-1.141q.474-.475 1.14-.475h6.77q.666 0 1.14.475q.475.475.475 1.14v2.386zm1.616 3.5q.425 0 .712-.288t.288-.712t-.288-.713t-.712-.288t-.713.288t-.287.713t.287.712t.713.288M16 18.384v-3.307q0-.27-.173-.443t-.442-.173h-6.77q-.269 0-.442.173q-.173.174-.173.443v3.308q0 .269.173.442t.443.173h6.769q.269 0 .442-.173t.173-.443M5.192 9.616h-.615h14.846z"},null,-1)]))}const Vi=ni({name:"material-symbols-light-print-outline-rounded",render:Hi}),Wi={key:0,style:{display:"flex",gap:"0 10px"}},qi=Pe({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:kt(["reset","search","printDataList"],["update:model"]),setup(o,{emit:P}){const E=P,y=Lt(),{formRef:u,restoreValidation:g}=Ct(),e=Xt(o,"model"),h=re([{label:"待完善",value:0},{label:"待审核",value:1},{label:"审核通过",value:2},{label:"进行中",value:3},{label:"完成",value:4}]),b=be([{label:"标准双向寄送",value:0},{label:"仅客户寄回",value:1},{label:"我司先寄双向",value:2},{label:"仅我司寄出",value:3}]);function x(){e.value.cname="",d()}function s(){e.value.pname="",d()}function v(j){console.log("val",j),j===0?h.value=[{label:"待完善",value:0},{label:"待审核",value:1},{label:"审核通过",value:2},{label:"进行中",value:3},{label:"完成",value:4}]:j===1?h.value=[{label:"待完善",value:0},{label:"待审核",value:1},{label:"审核通过",value:4}]:j===2?h.value=[{label:"待审核",value:0},{label:"审核通过",value:1},{label:"进行中",value:3},{label:"完成",value:4}]:j===3?h.value=[{label:"待审核",value:0},{label:"审核通过",value:1},{label:"进行中",value:3},{label:"完成",value:4}]:(e.value.status=null,h.value=[{label:"待完善",value:0},{label:"待审核",value:1},{label:"审核通过",value:2},{label:"进行中",value:3},{label:"完成",value:4}]),e.value.status!==null&&h.value.findIndex(M=>{M.value,e.value.status})===-1&&(e.value.status=null),d()}function c(){e.value.sn="",d()}async function $(){await g(),E("reset")}async function d(){var j,k;if(!ae("aftermarket:select:permission.do")){(j=window.$message)==null||j.destroyAll(),(k=window.$message)==null||k.warning("暂无查询权限权限，请联系管理员");return}e.value.page=1,E("search")}function f(j,k){console.log("value",j),e.value.uid=null,e.value.dbtime=null,e.value.checkboxList.includes("me")&&(e.value.uid=Number(y.userInfo.id)),e.value.checkboxList.includes("handle")&&(e.value.dbtime=new Date(new Date().getTime()).toISOString().split("T")[0]),d()}async function C(){E("printDataList")}return(j,k)=>{const M=fe,S=Et,ie=St,se=on,O=Ft,we=sn,ce=qt,Le=T,Ie=Vi,ze=Wt,Ee=zt,ge=_t,Ae=dn;return R(),U(Ae,{bordered:!1,size:"small",class:"card-wrapper"},{default:a(()=>[n(ge,{ref_key:"formRef",ref:u,model:e.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:ii(d,["enter"])},{default:a(()=>[n(Ee,{responsive:"screen","item-responsive":"","x-gap":16,"y-gap":16},{default:a(()=>[n(S,{span:"24 s:12 m:6",label:"客户名称",path:"cname"},{default:a(()=>[n(M,{clearable:"",value:e.value.cname,"onUpdate:value":k[0]||(k[0]=oe=>e.value.cname=oe),placeholder:"请输入客户名称",onClear:x},null,8,["value"])]),_:1}),n(S,{span:"24 s:12 m:6",label:"项目名称",path:"pname"},{default:a(()=>[n(M,{clearable:"",value:e.value.pname,"onUpdate:value":k[1]||(k[1]=oe=>e.value.pname=oe),placeholder:"请输入项目名称",onClear:s},null,8,["value"])]),_:1}),n(S,{span:"24 s:12 m:6",label:"设备编号",path:"sn"},{default:a(()=>[n(M,{clearable:"",value:e.value.sn,"onUpdate:value":k[2]||(k[2]=oe=>e.value.sn=oe),placeholder:"请输入设备编号",onClear:c},null,8,["value"])]),_:1}),n(S,{span:"24 s:12 m:6",label:"售后类型",path:"mtype"},{default:a(()=>[n(ie,{clearable:"",filterable:"",value:e.value.mtype,"onUpdate:value":[k[3]||(k[3]=oe=>e.value.mtype=oe),v],placeholder:"请选择售后类型","label-field":"label","value-field":"value",options:b},null,8,["value","options"])]),_:1}),e.value.mtype!==null?(R(),U(S,{key:0,span:"24 s:12 m:6",label:"状态",path:"status"},{default:a(()=>[n(ie,{clearable:"",filterable:"",value:e.value.status,"onUpdate:value":[k[4]||(k[4]=oe=>e.value.status=oe),d],placeholder:"请选择状态","label-field":"label","value-field":"value",options:h.value},null,8,["value","options"])]),_:1})):N("",!0),n(S,{span:e.value.mtype!==null?"24 s:24 m:18":"24 s:24 m:24",label:"快速筛选"},{default:a(()=>[n(O,{class:"w-full",justify:"space-between"},{default:a(()=>[n(we,{value:e.value.checkboxList,"onUpdate:value":[k[5]||(k[5]=oe=>e.value.checkboxList=oe),f]},{default:a(()=>[n(O,{"item-style":"display: flex;"},{default:a(()=>[n(se,{value:"me",label:"与我相关"}),n(se,{value:"handle",label:"近7日待处理"})]),_:1})]),_:1},8,["value"]),m(ae)("aftermarket:select:permission.do")?(R(),ot("div",Wi,[m(ae)("aftermarket:select:permission.do")?(R(),U(Le,{key:0,ghost:"",onClick:d},{icon:a(()=>[n(ce,{class:"text-icon"})]),default:a(()=>[k[6]||(k[6]=z(" "+Z("查询")))]),_:1,__:[6]})):N("",!0),m(ae)("aftermarket:select:permission.do")?(R(),U(Le,{key:1,type:"primary",onClick:C},{icon:a(()=>[n(Ie,{class:"text-icon"})]),default:a(()=>[k[7]||(k[7]=z(" "+Z("打印")))]),_:1,__:[7]})):N("",!0),m(ae)("aftermarket:select:permission.do")?(R(),U(Le,{key:2,onClick:$},{icon:a(()=>[n(ze,{class:"text-icon"})]),default:a(()=>[k[8]||(k[8]=z(" "+Z("刷新")))]),_:1,__:[8]})):N("",!0)])):N("",!0)]),_:1})]),_:1},8,["span"])]),_:1})]),_:1},8,["model"])]),_:1})}}}),Ki=un(qi,[["__scopeId","data-v-68931b3e"]]);function Vt(o){const P={SF:/^\d{12}$|^[A-Za-z]\d{12}$/,ZTO:/^\d{12}$/,STO:/^\d{12}$/,YTO:/^\d{10,12}$/,YD:/^\d{13}$/,EMS:/^[A-Z]{2}\d{9}[A-Z]{2}$/,COMMON:/^[A-Za-z0-9]{8,20}$/};o=o.trim();for(let E in P)if(P[E].test(o))return!0;return!1}const Gi={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function Ve(o){return typeof o=="function"||Object.prototype.toString.call(o)==="[object Object]"&&!di(o)}const Ji=Pe({name:"aftersales",__name:"index",setup(o){const P=li(),E=Lt();Qt();const y=re(!1),u=re(0),g=re([]),{formRef:e}=Ct(),h=be([{label:"待处理",value:1},{label:"分析中",value:2},{label:"处理中",value:3},{label:"待厂家发出",value:4}]),b=re(null),x=re(!1),s=be({id:0,type:"",returnOrder:"",returnOrderType:1,rsn:"",rdetails:0,raccessory:""}),v={rsn:{required:!1,trigger:["blur","change"],message:"请输入寄出设备编号"},raccessory:{required:!1,trigger:["blur","change"],message:""}},c=ke(()=>{const t={};return s.type==="receipt"&&(t.returnOrder={...v.rsn,message:s.type==="receipt"?"请输入客户寄出信息":"请输入寄出信息"}),s.type==="returnnum"?t.rsn=[{...v.rsn,required:!0},{min:9,trigger:["blur","change"],message:"寄出设备编号长度至少 9 位"}]:t.raccessory={...v.raccessory,required:!1},s.rdetails===1?t.raccessory={...v.raccessory,required:!0,message:s.type==="returnnum"?"请输出寄出配件详情":"请输入寄件配件详情"}:t.raccessory={...v.raccessory,required:!1,message:s.type==="returnnum"?"请输出寄出配件详情":"请输入寄件配件详情"},t}),$=re(!1),d=be({id:0,type:"",sendFileList:[],receiveFileList:[],analyzeFileList:[]}),f=re(!1),C=be({id:0,type:"",notes:""}),j=re(!1),k=be({id:[],type:"",password:""}),M=re(!1),S=be({cid:0,mtype:0,status:void 0,customername:"",gwsn:"",model:void 0,checkboxList:[]}),ie=re(!1),se=re(!1),O=be({id:0,uid:0,aid:0,type:"add",username:"",sn:"",reason:"",resolution:"",improvement:""}),we=re(""),ce=re(!1),Le=be({aid:null,uid:null,sn:""}),{columns:Ie,columnChecks:ze,data:Ee,getData:ge,loading:Ae,mobilePagination:oe,searchParams:je}=gt({showTotal:!0,immediate:ae("aftermarket:select:permission.do"),apiFn:Ci,apiParams:{page:1,pageSize:20,limit:20,cname:null,pname:null,sn:null,status:null,uid:null,dbtime:null,mtype:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48,fixed:"left"},{key:"dbtime",title:"创建时间",align:"center",width:100,fixed:"left",render:t=>n("div",{class:"flex flex-col items-start justify-start gap-1"},[n("div",{class:"w-full truncate"},[t.dbtime.substring(0,10)]),n("div",{class:"w-full truncate"},[t.dbtime.substr(11)])])},{key:"comp",title:"客户信息",width:200,fixed:"left",titleAlign:"center",ellipsis:{tooltip:!0},render:t=>n("div",{class:"flex flex-col items-start justify-start gap-1"},[n("div",{class:"w-full truncate",title:`公司名称：${t.comp}`},[z("公司名称："),t.comp]),n("div",{class:"w-full truncate",title:`联系人：${t.contact}`},[z("联系人："),t.contact]),n("div",{class:"w-full truncate",title:`联系方式：${t.contactinfo}`},[z("联系方式："),t.contactinfo])])},{key:"receipt",title:"客户寄出信息",align:"center",width:220,titleAlign:"center",ellipsis:{tooltip:!0},render:t=>n("div",{class:"flex flex-col items-start justify-start gap-1"},[t.mtype!==3&&t.receipt&&n("div",{class:"flex items-center gap-4px"},[Vt(t.receipt)?n("a",{href:`https://www.kuaidi100.com?nu=${encodeURIComponent(t.receipt)}`,target:"_blank",style:"color: #4169E1;"},[t.receipt||"--"]):n("span",null,[t.receipt||"--"]),n(tt,{trigger:"hover",placement:"right"},{trigger:()=>X(n(T,{text:!0,type:"primary",onClick:()=>Ze(t.id,t,"receipt")},{default:()=>[n("span",{class:"akar-icons--edit"},null)]}),[[ee("no-auth"),"aftermarket:update:permission.do"]]),default:()=>Y("common.update")})]),t.mtype!==3&&t.receipt&&n("div",null,[`时间：${t.redbtime||""}`]),t.mtype!==3&&!t.receipt&&X(n(T,{text:!0,type:"primary",onClick:()=>Ze(t.id,null,"receipt")},{default:()=>["填写"]}),[[ee("no-auth"),"aftermarket:update:permission.do"]]),t.mtype===3&&!t.receipt&&n("span",null,["无",z(" ")])])},{key:"afterMarketPojoList",title:"售后信息",align:"center",width:300,titleAlign:"center",ellipsis:{tooltip:!0},render:t=>n("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-around"}},[t.afterMarketPojoList.length>5?n("div",{style:{marginRight:"20px"}},[n(tt,{placement:"right",trigger:"hover"},{trigger:()=>n("div",null,[n("span",{style:{fontWeight:"bolder"}},[`总数量: ${t.afterMarketPojoList.length}个`]),t.afterMarketPojoList.slice(0,5).map((i,L)=>n("div",{key:L,style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},[n("span",null,[i.sn]),n("span",{style:{marginLeft:"5px"}},[Se(t.mtype,i.status)])]))]),default:()=>n("div",{innerHTML:D(t.mtype,t.afterMarketPojoList)},null)})]):n("div",{style:{marginRight:"20px"}},[n("span",{style:{fontWeight:"bolder"}},[`总数量: ${t.afterMarketPojoList.length}个`]),t.afterMarketPojoList.map((i,L)=>n("div",{key:L,style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},[i.sn?n("span",null,[i.sn]):n("span",{style:{color:"#f00"}},[z("设备信息为空")]),n("span",{style:{marginLeft:"5px"}},[Se(t.mtype,i.status)])]))]),t.afterMarketPojoList.length>0?X(n(T,{text:!0,type:"primary",size:"small",onClick:()=>wn(t)},{default:()=>[z("查看")]}),[[ee("no-auth"),"aftermarket:select:permission.do"]]):null])},{key:"project",title:"项目名称",align:"center",width:180,ellipsis:{tooltip:!0}},{key:"dock",title:"对接工程师",align:"center",width:120},{key:"rcontact",title:"客户收件信息",width:200,titleAlign:"center",ellipsis:{tooltip:!0},render:t=>t.mtype!==1&&n("div",{class:"flex flex-col items-start justify-start gap-1"},[n("div",{class:"w-full truncate",title:`联系人：${t.rcontact}`},[z("联系人："),t.rcontact]),n("div",{class:"w-full truncate",title:`联系方式：${t.rcontactinfo}`},[z("联系方式："),t.rcontactinfo]),n("div",{class:"w-full truncate",title:`地址：${t.raddress}`},[z("地址："),t.raddress])])},{key:"re1",title:"客户寄出照片",align:"center",width:300,render:t=>n("div",{class:"flex items-center justify-center gap-4px"},[t.mtype!==3&&(t.re1||t.re2||t.re3)?n("div",{style:{cursor:"pointer"},onClick:()=>Xe([t.re1,t.re2,t.re3].filter(i=>i),0)},[n(nt,{width:70,src:t.re1||t.re2||t.re3,previewDisabled:!0,style:{maxHeight:"70px",cursor:"pointer"}},null)]):null,n("div",null,[t.mtype!==3&&!t.re1&&!t.re2&&!t.re3&&X(n(T,{size:"small",type:"primary",onClick:()=>Re(t,"customer")},{default:()=>[z("点击上传")]}),[[ee("no-auth"),"aftermarket:update:permission.do"]]),t.mtype!==3&&(t.re1||t.re2||t.re3)&&X(n(T,{size:"small",type:"primary",onClick:()=>Re(t,"customer"),style:{marginLeft:"5px"}},{default:()=>[z("编辑图片")]}),[[ee("no-auth"),"aftermarket:update:permission.do"]])])])},{key:"re8",title:"厂家寄出照片",align:"center",width:300,render:t=>n("div",{class:"flex items-center justify-center gap-4px"},[t.mtype!==1&&(t.re8||t.re4||t.re5||t.re6)?n("div",{style:{cursor:"pointer"},onClick:()=>Xe([t.re8,t.re4,t.re5||t.re6].filter(i=>i),0)},[n(nt,{width:70,src:t.re8||t.re4||t.re5||t.re6,previewDisabled:!0,style:{maxHeight:"70px",cursor:"pointer"}},null)]):null,n("div",null,[t.mtype!==1&&!t.re8&&!t.re4&&!t.re5&&!t.re6&&X(n(T,{size:"small",type:"primary",onClick:()=>Re(t,"company")},{default:()=>[z("点击上传")]}),[[ee("no-auth"),"aftermarket:update:permission.do"]]),t.mtype!==1&&(t.re8||t.re4||t.re5||t.re6)&&X(n(T,{size:"small",type:"primary",onClick:()=>Re(t,"company"),style:{marginLeft:"5px"}},{default:()=>[z("编辑图片")]}),[[ee("no-auth"),"aftermarket:update:permission.do"]])])])},{key:"notes",title:"备注",align:"center",width:180,ellipsis:{tooltip:!0},render:t=>n("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-around"}},[t.notes?n(oi,null,[n("div",{class:"w-full truncate",title:`${t.notes}`},[t.notes]),n(tt,{trigger:"hover",placement:"right"},{trigger:()=>X(n(T,{text:!0,type:"primary",onClick:()=>Qe(t.id,t.notes,"comp")},{default:()=>[n("span",{class:"akar-icons--edit"},null)]}),[[ee("no-auth"),"aftermarket:update:permission.do"]]),default:()=>Y("common.update")})]):X(n(T,{text:!0,type:"primary",size:"small",onClick:()=>Qe(t.id,"","comp")},{default:()=>[z("填写")]}),[[ee("no-auth"),"aftermarket:update:permission.do"]])])},{key:"ckusername",title:"审核人",align:"center",width:120,ellipsis:{tooltip:!0}},{key:"ckdbtime",title:"审核时间",align:"center",width:100,ellipsis:{tooltip:!0},render:t=>t.ckdbtime?n("div",{class:"flex flex-col items-start justify-start gap-1"},[n("div",{class:"w-full truncate"},[t.ckdbtime.substring(0,10)]),n("div",{class:"w-full truncate"},[t.ckdbtime.substr(11)])]):null},{key:"mtype",title:"售后类型",align:"center",width:120,fixed:"right",render:t=>{let i;return n(it,{type:"primary"},Ve(i=Te(t.mtype))?i:{default:()=>[i]})}},{key:"status",title:"当前状态",align:"center",width:100,fixed:"right",render:t=>{let i;return n(it,{type:(H=>(t.mtype===0?{0:"default",1:"default",2:"primary",3:"warning",4:"success"}:t.mtype===1?{0:"default",1:"default",4:"success"}:t.mtype===2?{0:"default",1:"primary",3:"warning",4:"success"}:{0:"default",1:"primary",3:"warning",4:"success"})[H]||"default")(t.status)},Ve(i=Je(t.mtype,t.status))?i:{default:()=>[i]})}},{key:"operate",title:Y("common.operate"),align:"center",width:ae("aftermarket:update:permission.do")||ae("aftermarket:delete:permission.do")?120:0,fixed:"right",render:t=>n("div",{class:"flex-center gap-8px"},[(t.mtype===0||t.mtype===1)&&t.status===1&&n(De,{onPositiveClick:()=>jt(t.id)},{default:()=>"确认要审核通过吗？",trigger:()=>X(n(T,{type:"primary",ghost:!0,size:"small"},{default:()=>[z("审核")]}),[[ee("no-auth"),"aftermarket:update:permission.do"]])}),(t.mtype===2||t.mtype===3)&&t.status===0&&n(De,{onPositiveClick:()=>jt(t.id)},{default:()=>"确认要审核通过吗？",trigger:()=>n(T,{type:"primary",ghost:!0,size:"small"},{default:()=>[z("审核")]})}),n(De,{onPositiveClick:()=>xn(t.id)},{default:()=>Y("common.confirmDelete"),trigger:()=>{let i;return X(n(T,{type:"error",ghost:!0,size:"small"},Ve(i=Y("common.delete"))?i:{default:()=>[i]}),[[ee("no-auth"),"aftermarket:delete:permission.do"]])}})])}]}),{drawerVisible:Ne,operateType:Ke,editingData:Ge,handleAdd:dt,checkedRowKeys:he,onDeleted:Be}=vt(Ee,ge),{columns:ut,data:Me,getData:l,loading:r,mobilePagination:A,searchParams:_}=gt({showTotal:!0,immediate:!1,apiFn:Fi,apiParams:{page:1,pageSize:20,limit:20,cid:null,gws:null,sn:null,status:null,uid:null,dbtime:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48,fixed:"left"},{key:"sn",title:"客户设备信息",width:240,titleAlign:"center",ellipsis:{tooltip:!0},render:t=>n("div",{class:"flex flex-col items-start justify-start gap-1"},[n("div",{class:"w-full truncate",title:`设备编号：${t.sn}`},[z("设备编号："),t.sn?t.rsn?t.rsn==t.sn||t.rsn.includes("无")?t.sn:n("span",null,[t.sn,z(" ("),n("span",{style:"color: red; font-weight: bold;"},[z("更换")]),z(")")]):t.sn:"--"]),n("div",{class:"w-full truncate",title:`设备型号：${t.model||"--"}`},[z("设备型号："),t.model||"--"])])},{key:"fault",title:"故障现象",align:"center",width:220,ellipsis:{tooltip:!0}},{key:"re1",title:"现场照片",align:"center",width:300,render:t=>n("div",{class:"flex items-center justify-center gap-4px"},[t.re1||t.re2||t.re3?n("div",{style:{cursor:"pointer"},onClick:()=>Xe([t.re1,t.re2,t.re3].filter(i=>i),0)},[n(nt,{width:70,src:t.re1||t.re2||t.re3,previewDisabled:!0,style:{maxHeight:"70px",cursor:"pointer"}},null)]):null])},{key:"re4",title:"现场视频",align:"center",width:300,render:t=>n("div",{class:"flex items-center justify-center gap-4px"},[t.re4?n("video",{src:t.re4,style:{height:"70px",width:"100%",cursor:"pointer",objectFit:"cover"},onClick:()=>Fn(t.re4)},null):null])},{key:"returnnum",title:"物流信息",align:"center",width:220,titleAlign:"center",ellipsis:{tooltip:!0},render:t=>n("div",{class:"flex flex-col items-start justify-start gap-1"},[t.returnnum&&S.mtype!==1&&n("div",{class:"flex items-center gap-4px"},[Vt(t.returnnum)?n("a",{href:`https://www.kuaidi100.com?nu=${encodeURIComponent(t.returnnum)}`,target:"_blank",style:"color: #4169E1;"},[t.returnnum||"--"]):n("span",null,[t.returnnum||"--"]),n(tt,{trigger:"hover",placement:"right"},{trigger:()=>X(n(T,{text:!0,type:"primary",onClick:()=>Ze(t.id,t,"returnnum")},{default:()=>[n("span",{class:"akar-icons--edit"},null)]}),[[ee("no-auth"),"aftermarket:update:permission.do"]]),default:()=>Y("common.update")})]),t.returnnum&&n("div",null,[`时间：${t.rdbtime?t.rdbtime:""}`]),t.returnnum&&n("div",null,[`寄件类型：${t.rdetails==0?"仅裸机":t.raccessory?"含配件("+t.raccessory+")":"未知"}`]),!t.returnnum&&X(n(T,{text:!0,type:"primary",onClick:()=>Ze(t.id,null,"returnnum")},{default:()=>["填写"]}),[[ee("no-auth"),"aftermarket:update:permission.do"]])])},{key:"re8",title:"分析照片",align:"center",width:300,render:t=>n("div",{class:"flex items-center justify-center gap-4px"},[t.re5||t.re6||t.re7?n("div",{style:{cursor:"pointer"},onClick:()=>Xe([t.re5||t.re6||t.re7].filter(i=>i),0)},[n(nt,{width:70,src:t.re5||t.re6||t.re7,previewDisabled:!0,style:{maxHeight:"70px",cursor:"pointer"}},null)]):null,n("div",null,[!t.re5&&!t.re6&&!t.re7&&X(n(T,{size:"small",type:"primary",onClick:()=>Re(t,"analyze")},{default:()=>[z("点击上传")]}),[[ee("no-auth"),"aftermarket:update:permission.do"]]),(t.re5||t.re6||t.re7)&&X(n(T,{size:"small",type:"primary",onClick:()=>Re(t,"analyze"),style:{marginLeft:"5px"}},{default:()=>[z("编辑图片")]}),[[ee("no-auth"),"aftermarket:update:permission.do"]])])])},{key:"rsn",title:"设备信息",width:200,titleAlign:"center",ellipsis:{tooltip:!0},render:t=>n("div",{class:"flex flex-col items-start justify-start gap-1"},[n("div",{class:"w-full truncate",title:`设备编号：${t.rsn||"--"}`},[z("设备编号："),t.rsn||"--"]),n("div",{class:"w-full truncate",title:`设备型号：${t.rmodel||"--"}`},[z("设备型号："),t.rmodel||"--"])])},{key:"notes",title:"备注",align:"center",width:180,ellipsis:{tooltip:!0},render:t=>n("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-around"}},[t.notes?n("div",{class:"w-full truncate",title:`${t.notes}`},[t.notes]):X(n(T,{text:!0,type:"primary",size:"small",onClick:()=>Qe(t.id,"","sn")},{default:()=>[z("填写")]}),[[ee("no-auth"),"aftermarket:update:permission.do"]])])},{key:"duration",title:"处理时长",align:"center",width:180,ellipsis:{tooltip:!0}},{key:"status",align:"center",width:120,fixed:"right",title:()=>p("div",{class:"flex flex-col items-center justify-center"},[p("span","当前状态"),p("span",{style:"font-size: 11px; color: #FF0000; margin-top: 2px;"},"悬浮查看详情")]),render:t=>{const i=()=>{const{status:L}=t;return S.mtype===0?[p(B,{type:L>=0?"success":"default",time:t.dbtime},{default:()=>"待处理"}),p(B,{type:L>=1?"success":"default",time:t.redbtime},{default:()=>["分析中",t.receipt&&p("span",{style:{marginLeft:"5px"}},["(寄出单号: ",p("a",{href:`https://www.kuaidi100.com?nu=${encodeURIComponent(t.receipt)}`,target:"_blank",style:{color:"#4169E1",marginLeft:"5px"}},t.receipt),")"])]}),p(B,{type:L>=2?"success":"default"},{default:()=>"处理中"}),p(B,{type:L>=3?"success":"default"},{default:()=>"待寄回"}),p(B,{type:L>=4?"success":"default"},{default:()=>"待客户收件"}),p(B,{type:L>=5?"success":"default",time:t.rdbtime},{default:()=>["完成",t.returnnum&&p("span",{style:{marginLeft:"5px"}},["(寄出单号: ",p("a",{href:`https://www.kuaidi100.com?nu=${encodeURIComponent(t.returnnum)}`,target:"_blank",style:{color:"#4169E1",marginLeft:"5px"}},t.returnnum),")"])]})]:S.mtype===1?[p(B,{type:L>=0?"success":"default",time:t.dbtime},{default:()=>"待处理"}),p(B,{type:L>=1?"success":"default",time:t.return_time||t.complete_time},{default:()=>"完成"})]:S.mtype===2?[p(B,{type:L>=0?"success":"default",time:t.dbtime},{default:()=>"待处理"}),p(B,{type:L>=1?"success":"default"},{default:()=>"待客户收件"}),p(B,{type:L>=2?"success":"default"},{default:()=>"待我司收件"}),p(B,{type:L>=3?"success":"default",time:t.return_time||t.complete_time},{default:()=>"完成"})]:S.mtype===3?[p(B,{type:L>=0?"success":"default",time:t.dbtime},{default:()=>"待处理"}),p(B,{type:L>=1?"success":"default"},{default:()=>"待客户收件"}),p(B,{type:L>=2?"success":"default",time:t.return_time||t.complete_time},{default:()=>"完成"})]:[p(B,{type:L>=0?"success":"default",time:t.dbtime},{default:()=>"待处理"}),p(B,{type:L>=1?"success":"default",time:t.redbtime},{default:()=>["分析中",t.receipt&&p("span",{style:{marginLeft:"5px"}},["(寄出单号: ",p("a",{href:`https://www.kuaidi100.com?nu=${encodeURIComponent(t.receipt)}`,target:"_blank",style:{color:"#4169E1",marginLeft:"5px"}},t.receipt),")"])]}),p(B,{type:L>=2?"success":"default"},{default:()=>"处理中"}),p(B,{type:L>=3?"success":"default"},{default:()=>"待寄回"}),p(B,{type:L>=4?"success":"default"},{default:()=>"待客户收件"}),p(B,{type:L>=5?"success":"default",time:t.rdbtime},{default:()=>["完成",t.returnnum&&p("span",{style:{marginLeft:"5px"}},["(寄出单号: ",p("a",{href:`https://www.kuaidi100.com?nu=${encodeURIComponent(t.returnnum)}`,target:"_blank",style:{color:"#4169E1",marginLeft:"5px"}},t.returnnum),")"])]})]};return p(an,{placement:"top",style:{maxWidth:"450px"}},{trigger:()=>p(it,{type:"primary",style:{cursor:"pointer"}},{default:()=>Se(S.mtype,t.status)}),default:()=>p("div",{class:"custom-timeline",style:{padding:"12px"}},[p("p",{style:{marginBottom:"12px",fontWeight:"bold"}},[p("strong",null,"当前状态："),Se(S.mtype,t.status)]),p(fn,null,{default:()=>i()})])})}},{key:"responsibleperson",title:"售后处理",align:"center",width:160,fixed:"right",render:t=>n("div",{class:"flex-center gap-8px"},[X(n(T,{type:"primary",ghost:!0,size:"small",onClick:()=>_n(t,"option")},{default:()=>["查看"+(t.rescount>0?"("+t.rescount+")":"")]}),[[ee("no-auth"),"aftermarketRes:select:permission.do"]]),X(n(T,{type:"primary",ghost:!0,size:"small",onClick:()=>ft(t,"add")},{default:()=>["添加"]}),[[ee("no-auth"),"aftermarketRes:insert:permission.do"]])])},{key:"operate",title:Y("common.operate"),align:"center",width:160,fixed:"right",render:t=>n("div",{class:"flex-center gap-8px"},[X(n(T,{type:"primary",ghost:!0,size:"small",onClick:()=>Qe(t.id,t.notes,"sn")},{default:()=>["修改备注"]}),[[ee("no-auth"),"aftermarket:update:permission.do"]]),n(De,{onPositiveClick:()=>$t(t.id)},{default:()=>Y("common.confirmDelete"),trigger:()=>{let i;return X(n(T,{type:"error",ghost:!0,size:"small"},Ve(i=Y("common.delete"))?i:{default:()=>[i]}),[[ee("no-auth"),"aftermarket:delete:permission.do"]])}})])}]}),{checkedRowKeys:I,onDeleted:Q}=vt(Me,l),{columns:G,data:le,getData:K,loading:pe,mobilePagination:te,searchParams:ye}=gt({showTotal:!0,immediate:!1,apiFn:ji,apiParams:{page:1,pageSize:20,limit:20,aid:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48,fixed:"left"},{key:"username",title:"责任人",width:200,align:"center",ellipsis:{tooltip:!0}},{key:"reason",title:"原因分析",align:"center",width:300,ellipsis:{tooltip:!0}},{key:"resolution",title:"处理意见",align:"center",width:300,ellipsis:{tooltip:!0}},{key:"improvement",title:"改进措施",align:"center",width:300,ellipsis:{tooltip:!0}},{key:"dbtime",title:"创建时间",align:"center",width:160},{key:"operate",title:Y("common.operate"),align:"center",width:160,fixed:"right",render:t=>n("div",{class:"flex-center gap-8px"},[X(n(T,{type:"primary",ghost:!0,size:"small",onClick:()=>ft(t,"edit")},{default:()=>["修改"]}),[[ee("no-auth"),"aftermarketRes:update:permission.do"]]),n(De,{onPositiveClick:()=>Pt(t.id)},{default:()=>Y("common.confirmDelete"),trigger:()=>{let i;return X(n(T,{type:"error",ghost:!0,size:"small"},Ve(i=Y("common.delete"))?i:{default:()=>[i]}),[[ee("no-auth"),"aftermarketRes:delete:permission.do"]])}})])}]}),{checkedRowKeys:Ce}=vt(le,K),Te=t=>t===0?"标准双向寄送":t===1?"仅客户寄回":t===2?"我司先寄双向":t===3?"仅我司寄出":"未知",Je=(t,i)=>t===0?i===0?"待完善":i===1?"待审核":i===2?"审核通过":i===3?"进行中":i===4?"完成":"未知":t===1?i===0?"待完善":i===1?"待审核":i===4?"完成":"未知":t===2||t===3?i===0?"待审核":i===1?"审核通过":i===3?"进行中":i===4?"完成":"未知":i===0?"待完善":i===1?"待审核":i===2?"审核通过":i===3?"进行中":i===4?"完成":"未知",Se=(t,i)=>t===0?i===0?"待处理":i===1?"分析中":i===2?"处理中":i===3?"待寄回":i===4?"待客户收件":i===5?"完成":"未知":t===1?i===0?"待处理":i===5?"完成":"未知":t===2?i===0?"待处理":i===1?"待客户收件":i===2?"待我司收件":i===5?"完成":"未知":t===3?i===0?"待处理":i===1?"待客户收件":i===5?"完成":"未知":i===0?"待处理":i===1?"分析中":i===2?"处理中":i===3?"待寄回":i===4?"待客户收件":i===5?"完成":"未知",D=(t,i)=>{let L="",H=i.slice(5);return H.forEach((F,J)=>{J!=H.length-1?L+=F.sn+"    "+Se(t,F.status)+"<br />":L+=F.sn+"    "+Se(t,F.status)}),L};function Ze(t,i,L){s.type=L,s.returnOrder=i?L=="receipt"?i.receipt:i.returnnum:"",s.returnOrderType=i?L=="receipt"?i.receipt.includes("无")?2:1:i.returnnum.includes("无")?2:1:1,s.id=t,s.rsn=i&&i.hasOwnProperty("rsn")?i.rsn:"",s.rdetails=i&&i.hasOwnProperty("rdetails")?Number(i.rdetails):0,s.raccessory=i&&i.hasOwnProperty("raccessory")?i.raccessory:"",x.value=!0}function mn(){x.value=!1,s.id=0,s.type="",s.returnOrder="",s.returnOrderType=1,s.rsn="",s.rdetails=0,s.raccessory=""}async function yn(){var i,L,H,F;await b.value.validate();let t=s.type=="receipt"?s.rdetails===0?[{id:s.id,receipt:s.returnOrder,details:s.rdetails}]:[{id:s.id,receipt:s.returnOrder,details:s.rdetails,accessory:s.raccessory}]:s.rdetails===0?[{id:s.id,returnnum:s.returnOrder,rsn:s.rsn,rdetails:s.rdetails}]:[{id:s.id,returnnum:s.returnOrder,rsn:s.rsn,rdetails:s.rdetails,raccessory:s.raccessory}];if(s.type=="receipt"){const{data:J,error:V}=await ht(t);V||((i=window.$message)==null||i.destroyAll(),(L=window.$message)==null||L.success(J.msg||"操作成功"),ge(),x.value=!1,s.type="",s.returnOrder="",s.id=0)}else{const{data:J,error:V}=await bt(t);V||((H=window.$message)==null||H.destroyAll(),(F=window.$message)==null||F.success(J.msg||"操作成功"),l(),x.value=!1,s.type="",s.returnOrder="",s.id=0)}}function Re(t,i){d.sendFileList=[],d.receiveFileList=[],d.analyzeFileList=[],d.id=t.id,d.type=i,i==="customer"?(t.re1&&d.sendFileList.push({id:"0",name:"0",url:t.re1,status:"finished"}),t.re2&&d.sendFileList.push({id:"1",name:"1",url:t.re2,status:"finished"}),t.re3&&d.sendFileList.push({id:"2",name:"2",url:t.re3,status:"finished"})):i==="company"?(t.re4&&d.receiveFileList.push({id:"0",name:"0",url:t.re4,status:"finished"}),t.re5&&d.receiveFileList.push({id:"1",name:"1",url:t.re5,status:"finished"}),t.re6&&d.receiveFileList.push({id:"2",name:"2",url:t.re6,status:"finished"})):(t.re5&&d.analyzeFileList.push({id:"0",name:"0",url:t.re5,status:"finished"}),t.re6&&d.analyzeFileList.push({id:"1",name:"1",url:t.re6,status:"finished"}),t.re7&&d.analyzeFileList.push({id:"2",name:"2",url:t.re7,status:"finished"})),$.value=!0}function ct(t){var F,J,V,W;const i=["image/jpeg","image/png","image/jpg","image/x-icon"];console.log("data.file.file",t.file.file);const L=i.includes(t.file.file.type),H=t.file.file.size/1024/1024<10;return L||((F=window.$message)==null||F.destroyAll(),(J=window.$message)==null||J.error("只能上传 JPG/PNG/JPEG/ICO 格式的图片")),H||((V=window.$message)==null||V.destroyAll(),(W=window.$message)==null||W.error("上传图片大小不能超过 10MB")),L&&H}async function Ye(t){var F,J;const{file:i,onFinish:L,onError:H}=t;try{const V=await lt(i.file,i.name,"aftermarket/image");V&&(i.url=V,L({...i,url:V}),(F=window.$message)==null||F.destroyAll(),(J=window.$message)==null||J.success("上传成功"))}catch(V){H(V)}}function gn(){$.value=!1,d.sendFileList=[],d.receiveFileList=[],d.analyzeFileList=[]}function vn(t){return new Promise((i,L)=>{Ye({file:t,onFinish:()=>i(!0),onError:H=>L(H)})})}async function hn(){var F,J,V,W,ve,He,et,_e;let t=[{id:d.id}];const i=d.type==="customer"?d.sendFileList:d.type==="company"?d.receiveFileList:d.analyzeFileList;if(await Promise.all([...i.map(ne=>vn(ne))]),i.some(ne=>ne.url&&ne.url.startsWith("blob:"))){(F=window.$message)==null||F.destroyAll(),(J=window.$message)==null||J.warning("还有文件正在上传或上传失败，请稍后提交");return}if(i.some(ne=>!ne.url||ne.url.trim()==="")){(V=window.$message)==null||V.destroyAll(),(W=window.$message)==null||W.warning("存在上传失败的文件，请重新上传");return}if(d.type==="customer"?(d.sendFileList.length==0&&(t[0].re1="",t[0].re2="",t[0].re3=""),d.sendFileList.length==1&&(t[0].re1=d.sendFileList[0].url,t[0].re2="",t[0].re3=""),d.sendFileList.length==2&&(t[0].re1=d.sendFileList[0].url,t[0].re2=d.sendFileList[1].url,t[0].re3=""),d.sendFileList.length==3&&(t[0].re1=d.sendFileList[0].url,t[0].re2=d.sendFileList[1].url,t[0].re3=d.sendFileList[2].url)):d.type==="company"?(d.receiveFileList.length==0&&(t[0].re4="",t[0].re5="",t[0].re6=""),d.receiveFileList.length==1&&(t[0].re4=d.receiveFileList[0].url,t[0].re5="",t[0].re6=""),d.receiveFileList.length==2&&(t[0].re4=d.receiveFileList[0].url,t[0].re5=d.receiveFileList[1].url,t[0].re6=""),d.receiveFileList.length==3&&(t[0].re4=d.receiveFileList[0].url,t[0].re5=d.receiveFileList[1].url,t[0].re6=d.receiveFileList[2].url)):(d.analyzeFileList.length==0&&(t[0].re5="",t[0].re6="",t[0].re7=""),d.analyzeFileList.length==1&&(t[0].re5=d.analyzeFileList[0].url,t[0].re6="",t[0].re7=""),d.analyzeFileList.length==2&&(t[0].re5=d.analyzeFileList[0].url,t[0].re6=d.analyzeFileList[1].url,t[0].re7=""),d.analyzeFileList.length==3&&(t[0].re5=d.analyzeFileList[0].url,t[0].re6=d.analyzeFileList[1].url,t[0].re7=d.analyzeFileList[2].url)),d.type==="customer"||d.type==="company"){const{data:ne,error:$e}=await ht(t);$e||((ve=window.$message)==null||ve.destroyAll(),(He=window.$message)==null||He.success(ne.msg||"操作成功"),ge(),$.value=!1,d.id=0,d.sendFileList=[],d.receiveFileList=[])}else{const{data:ne,error:$e}=await bt(t);$e||((et=window.$message)==null||et.destroyAll(),(_e=window.$message)==null||_e.success(ne.msg||"操作成功"),l(),$.value=!1,d.id=0,d.analyzeFileList=[])}}function Qe(t,i,L){C.id=t,C.notes=i,C.type=L,f.value=!0}function pt(){f.value=!1,C.id=0,C.notes="",C.type=""}async function bn(){var H,F;if(!C.notes){(H=window.$message)==null||H.destroyAll(),(F=window.$message)==null||F.error("请输入备注");return}const{id:t,notes:i,type:L}=C;if(L==="comp"){const{data:J,error:V}=await ht([{id:t,notes:i}]);V||(pt(),ge())}else{const{data:J,error:V}=await bt([{id:t,notes:i}]);V||(pt(),l())}}async function jt(t){var H,F;const{data:i,error:L}=await wi({id:t});L||((H=window.$message)==null||H.destroyAll(),(F=window.$message)==null||F.success("审核通过"),je.page=1,ge())}async function xn(t){k.id=[t],k.type="deleteComp",k.password="",j.value=!0}async function kn(){k.id=he.value,k.type="deleteComp",k.password="",j.value=!0}function Ln(){j.value=!1,k.id=[],k.type="",k.password=""}async function Cn(){var t,i;if(!k.password){(t=window.$message)==null||t.destroyAll(),(i=window.$message)==null||i.error("请输入密码");return}if(k.type==="deleteComp"){const{data:L,error:H}=await _i(k.id,k.password);H||(j.value=!1,k.id=[],k.type="",k.password="",Be(),je.page=1,ge())}else if(k.type==="deleteSn"){const{data:L,error:H}=await Ei(k.id,k.password);H||(j.value=!1,k.id=[],k.type="",k.password="",Q(),_.page=1,l())}}function wn(t){var i,L;if(!ae("aftermarket:select:permission.do"))return(i=window.$message)==null||i.destroyAll(),(L=window.$message)==null||L.warning("暂无售后设备查询权限，请联系管理员"),!1;S.cid=t.id,S.mtype=t.mtype,S.status=void 0,S.customername="",S.model=void 0,S.gwsn="",S.checkboxList=[],Me.value=[],r.value=!1,S.gwsn=t.rsn||"",M.value=!0,We(()=>{A.value.page=1,_.cid=S.cid,l()})}function $t(t){k.id=t?[t]:I.value,k.type="deleteSn",k.password="",j.value=!0}function _n(t,i){we.value=i,Le.aid=t.id,Le.uid="",ce.value=!0,ye.page=1,ye.aid=t.id,K()}function ft(t,i){console.log("row",t),se.value=!1,O.type=i,i==="edit"?(O.uid=t.uid,O.username=t.username,O.aid=t.aid,O.id=t.id,O.reason=t.reason,O.resolution=t.resolution,O.improvement=t.improvement):(O.uid=Number(E.userInfo.id),O.username=E.userInfo.username,O.aid=t.id,O.id=0,O.reason="",O.resolution="",O.improvement=""),ie.value=!0}function mt(){ie.value=!1,se.value=!1,O.id=0,O.username="",O.reason="",O.resolution="",O.improvement=""}async function Sn(){var i,L,H,F;let t=[{aid:O.aid,uid:E.userInfo.id,reason:O.reason,resolution:O.resolution,improvement:O.improvement}];if(se.value=!0,O.id){t[0].id=O.id;const{data:J,error:V}=await Pi(t);V?se.value=!1:(se.value=!1,(i=window.$message)==null||i.destroyAll(),(L=window.$message)==null||L.success(J.msg||"操作成功"),mt(),ce.value&&(te.value.page=1,ye.aid=O.aid,K()),l())}else{const{data:J,error:V}=await $i(t);V?se.value=!1:(se.value=!1,(H=window.$message)==null||H.destroyAll(),(F=window.$message)==null||F.success(J.msg||"操作成功"),mt(),ce.value&&(te.value.page=1,ye.aid=O.aid,K()),l())}}async function Pt(t){var F,J,V,W;let i={};if(t)i.arrIds=[t];else{if(Ce.value.length===0)return(F=window.$message)==null||F.destroyAll(),(J=window.$message)==null||J.error("请选择要删除的数据"),!1;i.arrIds=Ce.value}const{data:L,error:H}=await Ii(i.arrIds);if(!H)(V=window.$message)==null||V.destroyAll(),(W=window.$message)==null||W.success(L.msg||"操作成功"),te.value.page=1,ye.aid=O.aid,K(),l();else return!1}function Fn(t){window.open(t,"_blank")}const Xe=(t,i=0)=>{g.value=t,u.value=i,y.value=!0},zn=t=>{u.value=t},En=()=>{ge()};function jn(){var L,H;if(he.value.length===0){(L=window.$message)==null||L.destroyAll(),(H=window.$message)==null||H.warning("请先选择要打印的数据");return}const i=Ee.value.filter(F=>he.value.includes(F.id)).map(F=>{[F.re1,F.re2,F.re3].filter(W=>W);const J=[F.re5,F.re6,F.re7].filter(W=>W),V=[F.re8,F.re9,F.re10].filter(W=>W);return[F.re11,F.re12].filter(W=>W),{创建时间:F.dbtime||"",客户信息:"公司名称: "+F.comp+`
联系人: `+F.contact+`
联系方式: `+F.contactinfo,客户寄出信息:F.receipt?F.receipt+`
寄出时间: `+(F.redbtime?F.redbtime:""):"",项目名称:F.project||"",对接工程师:F.dock||"",客户收件信息:"联系人: "+F.rcontact+`
联系方式: `+F.rcontactinfo+`
地址: `+F.raddress,客户寄出照片:J.map(W=>`<img src="${W}" style="width:100px;margin:2px;">`).join(""),厂家寄出照片:V.map(W=>`<img src="${W}" style="width:100px;margin:2px;">`).join(""),备注:F.notes||"",审核人:F.ckusername||"",审核时间:F.ckdbtime||"",售后类型:Te(F.mtype),当前状态:Je(F.mtype,F.status)}});Oi({printable:i,properties:[{field:"创建时间",displayName:"创建时间"},{field:"客户信息",displayName:"客户信息"},{field:"客户寄出信息",displayName:"客户寄出信息"},{field:"项目名称",displayName:"项目名称"},{field:"对接工程师",displayName:"对接工程师"},{field:"客户收件信息",displayName:"客户收件信息"},{field:"客户寄出照片",displayName:"客户寄出照片",type:"html"},{field:"厂家寄出照片",displayName:"厂家寄出照片",type:"html"},{field:"备注",displayName:"备注"},{field:"审核人",displayName:"审核人"},{field:"审核时间",displayName:"审核时间"},{field:"售后类型",displayName:"售后类型"},{field:"当前状态",displayName:"当前状态"}],type:"json",header:"售后管理",style:`
            @media print {
                body { font-size: 12px; }
                table { table-layout: fixed; width: 100%; border-collapse: collapse; }
                th, td {
                    border: 1px solid #ccc;
                    padding: 8px;
                    text-align: center;
                    vertical-align: top;
                    word-wrap: break-word;
                }
                th { background-color: #f0f0f0; font-weight: bold; }
                img, video { max-width: 100%; height: auto; }
                .no-break { page-break-inside: avoid; }
            }
        `,gridHeaderStyle:"font-size: 16px; font-weight: bold; color: #000; padding: 8px;",gridStyle:"font-size: 14px; border: 1px solid #ccc; padding: 8px;"})}return(t,i)=>{const L=Ft,H=On,F=Rn,J=Tn,V=en,W=fe,ve=ri,He=ln,et=nn,_e=_t,ne=rn,$e=tn,Oe=Et,$n=St,It=on,Pn=sn,At=qt,Tt=Wt,Rt=zt,In=dn,An=si;return R(),ot("div",Gi,[n(Ki,{model:m(je),"onUpdate:model":i[0]||(i[0]=w=>Ue(je)?je.value=w:null),onPrintDataList:jn,onReset:En,onSearch:m(ge)},null,8,["model","onSearch"]),n(In,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper h-full"},{header:a(()=>[n(L,{align:"center",wrap:"",class:"lt-sm:w-200px"},{default:a(()=>i[34]||(i[34]=[wt("div",null,"售后列表",-1)])),_:1,__:[34]})]),"header-extra":a(()=>[n(L,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:a(()=>[n(m(T),{onClick:m(dt),size:"small",ghost:"",type:"primary"},{icon:a(()=>[n(H,{class:"text-icon"})]),default:a(()=>[i[35]||(i[35]=z(" "+Z("新增")))]),_:1,__:[35]},8,["onClick"]),m(ae)("aftermarket:delete:permission.do")?(R(),U(m(De),{key:0,onPositiveClick:kn},{trigger:a(()=>[n(m(T),{size:"small",ghost:"",type:"error",disabled:m(he).length===0},{icon:a(()=>[n(F,{class:ai(["text-icon",{"animate-spin":m(Ae)}])},null,8,["class"])]),default:a(()=>[i[36]||(i[36]=z(" "+Z("批量删除")))]),_:1,__:[36]},8,["disabled"])]),default:a(()=>[i[37]||(i[37]=z(" 确定要删除选中的售后吗？ "))]),_:1,__:[37]})):N("",!0),n(J,{columns:m(ze),"onUpdate:columns":i[1]||(i[1]=w=>Ue(ze)?ze.value=w:null)},null,8,["columns"])]),_:1})]),default:a(()=>[n(V,{"checked-row-keys":m(he),"onUpdate:checkedRowKeys":i[2]||(i[2]=w=>Ue(he)?he.value=w:null),columns:m(Ie),data:m(Ee),size:"small",loading:m(Ae),remote:"","flex-height":!m(P).isMobile,"scroll-x":3e3,"row-key":w=>w.id,pagination:m(oe),class:"sm:h-full",striped:""},null,8,["checked-row-keys","columns","data","loading","flex-height","row-key","pagination"]),n(Bi,{visible:m(Ne),"onUpdate:visible":i[3]||(i[3]=w=>Ue(Ne)?Ne.value=w:null),onSubmitted:m(ge),"operate-type":m(Ke),"row-data":m(Ge)},null,8,["visible","onSubmitted","operate-type","row-data"]),n(ne,{show:x.value,"onUpdate:show":i[8]||(i[8]=w=>x.value=w),title:s.type==="receipt"?"填写客户寄出信息":"填写寄出信息",preset:"card",class:"w-800px"},{footer:a(()=>[n(L,{justify:"end"},{default:a(()=>[n(m(T),{size:"small",class:"mt-16px",onClick:mn},{default:a(()=>[z(Z(m(Y)("common.cancel")),1)]),_:1}),n(m(T),{type:"primary",size:"small",class:"mt-16px",onClick:yn},{default:a(()=>[z(Z(m(Y)("common.confirm")),1)]),_:1})]),_:1})]),default:a(()=>[n(_e,{ref_key:"returnOrderFormRef",ref:b,rules:c.value,model:s,"label-placement":"left"},{default:a(()=>[n(ve,{label:s.type==="receipt"?"客户寄出信息":"寄出信息",path:"returnOrder",required:""},{default:a(()=>[n(W,{value:s.returnOrder,"onUpdate:value":i[4]||(i[4]=w=>s.returnOrder=w),placeholder:s.type==="receipt"?"请输入客户寄出信息":"请输入寄出信息",clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"]),s.type==="returnnum"?(R(),U(ve,{key:0,label:"寄出设备编号",path:"rsn"},{default:a(()=>[n(W,{value:s.rsn,"onUpdate:value":i[5]||(i[5]=w=>s.rsn=w),placeholder:"请输入寄出设备编号",clearable:""},null,8,["value"])]),_:1})):N("",!0),n(ve,{label:(s.type==="returnnum","寄件类型"),path:"rdetails"},{default:a(()=>[n(et,{value:s.rdetails,"onUpdate:value":i[6]||(i[6]=w=>s.rdetails=w)},{default:a(()=>[n(L,null,{default:a(()=>[n(He,{value:0},{default:a(()=>i[38]||(i[38]=[z("仅裸机")])),_:1,__:[38]}),n(He,{value:1},{default:a(()=>i[39]||(i[39]=[z("含配件")])),_:1,__:[39]})]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),s.rdetails===1?(R(),U(ve,{key:1,required:"",label:s.type==="returnnum"?"寄出配件详情":"寄件配件详情",path:"raccessory"},{default:a(()=>[n(W,{value:s.raccessory,"onUpdate:value":i[7]||(i[7]=w=>s.raccessory=w),placeholder:s.type==="returnnum"?"请输出寄出配件详情":"请输入寄件配件详情",clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"])):N("",!0)]),_:1},8,["rules","model"])]),_:1},8,["show","title"]),n(ne,{show:$.value,"onUpdate:show":i[12]||(i[12]=w=>$.value=w),title:d.type==="customer"?"客户寄出照片上传":d.type==="company"?"寄出照片上传":"分析照片上传",preset:"card",class:"w-800px"},{footer:a(()=>[n(L,{justify:"end"},{default:a(()=>[n(m(T),{size:"small",class:"mt-16px",onClick:gn},{default:a(()=>[z(Z(m(Y)("common.cancel")),1)]),_:1}),n(m(T),{type:"primary",size:"small",class:"mt-16px",onClick:hn},{default:a(()=>[z(Z(m(Y)("common.confirm")),1)]),_:1})]),_:1})]),default:a(()=>[d.type==="customer"?(R(),U($e,{key:0,multiple:"",max:3,"file-list":d.sendFileList,"onUpdate:fileList":i[9]||(i[9]=w=>d.sendFileList=w),"list-type":"image-card","default-upload":!1,onBeforeUpload:ct,"custom-request":Ye},{default:a(()=>i[40]||(i[40]=[z(" 点击上传 ")])),_:1,__:[40]},8,["file-list"])):d.type==="company"?(R(),U($e,{key:1,multiple:"",max:3,"file-list":d.receiveFileList,"onUpdate:fileList":i[10]||(i[10]=w=>d.receiveFileList=w),"list-type":"image-card","default-upload":!1,onBeforeUpload:ct,"custom-request":Ye},{default:a(()=>i[41]||(i[41]=[z(" 点击上传 ")])),_:1,__:[41]},8,["file-list"])):(R(),U($e,{key:2,multiple:"",max:3,"file-list":d.analyzeFileList,"onUpdate:fileList":i[11]||(i[11]=w=>d.analyzeFileList=w),"list-type":"image-card",onBeforeUpload:ct,"default-upload":!1,"custom-request":Ye},{default:a(()=>i[42]||(i[42]=[z(" 点击上传 ")])),_:1,__:[42]},8,["file-list"]))]),_:1},8,["show","title"]),n(ne,{show:f.value,"onUpdate:show":i[14]||(i[14]=w=>f.value=w),title:"备注",preset:"card",class:"w-600px"},{footer:a(()=>[n(L,{justify:"end"},{default:a(()=>[n(m(T),{size:"small",class:"mt-16px",onClick:pt},{default:a(()=>[z(Z(m(Y)("common.cancel")),1)]),_:1}),n(m(T),{type:"primary",size:"small",class:"mt-16px",onClick:bn},{default:a(()=>[z(Z(m(Y)("common.confirm")),1)]),_:1})]),_:1})]),default:a(()=>[n(_e,{ref_key:"formRef",ref:e,model:C,"label-placement":"left"},{default:a(()=>[n(ve,{label:"备注",path:"notes",required:""},{default:a(()=>[n(W,{type:"textarea",value:C.notes,"onUpdate:value":i[13]||(i[13]=w=>C.notes=w),placeholder:"请输入备注",clearable:""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"]),n(ne,{show:j.value,"onUpdate:show":i[16]||(i[16]=w=>j.value=w),title:"二次确认",preset:"card",class:"w-600px"},{footer:a(()=>[n(L,{justify:"end"},{default:a(()=>[n(m(T),{size:"small",class:"mt-16px",onClick:Ln},{default:a(()=>[z(Z(m(Y)("common.cancel")),1)]),_:1}),n(m(T),{type:"primary",size:"small",class:"mt-16px",onClick:Cn},{default:a(()=>[z(Z(m(Y)("common.confirm")),1)]),_:1})]),_:1})]),default:a(()=>[n(_e,{ref_key:"formRef",ref:e,model:k,"label-placement":"left"},{default:a(()=>[n(ve,{label:"密码",path:"password",required:""},{default:a(()=>[n(W,{type:"password","show-password-on":"mousedown",value:k.password,"onUpdate:value":i[15]||(i[15]=w=>k.password=w),placeholder:"请输入密码",clearable:""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"]),n(ne,{show:M.value,"onUpdate:show":i[22]||(i[22]=w=>M.value=w),title:"售后设备信息",preset:"card",class:"w-85%"},{default:a(()=>[n(_e,{ref_key:"formRef",ref:e,model:S,"label-placement":"left","label-width":100,"show-feedback":!1},{default:a(()=>[n(Rt,{responsive:"screen","item-responsive":"","x-gap":16,"y-gap":16},{default:a(()=>[n(Oe,{span:"24 s:12 m:5",label:"客户名称",path:"customername"},{default:a(()=>[n(W,{clearable:"",value:S.customername,"onUpdate:value":i[17]||(i[17]=w=>S.customername=w),placeholder:"请输入客户名称"},null,8,["value"])]),_:1}),n(Oe,{span:"24 s:12 m:5",label:"设备编号",path:"gwsn"},{default:a(()=>[n(W,{clearable:"",value:S.gwsn,"onUpdate:value":i[18]||(i[18]=w=>S.gwsn=w),placeholder:"请输入设备编号"},null,8,["value"])]),_:1}),n(Oe,{span:"24 s:12 m:4",label:"状态",path:"status"},{default:a(()=>[n($n,{clearable:"",filterable:"",value:S.status,"onUpdate:value":i[19]||(i[19]=w=>S.status=w),placeholder:"请选择状态","label-field":"label","value-field":"value",options:h},null,8,["value","options"])]),_:1}),n(Oe,{span:"24 s:12 m:5",label:"快速筛选"},{default:a(()=>[n(Pn,{value:S.checkboxList,"onUpdate:value":i[20]||(i[20]=w=>S.checkboxList=w)},{default:a(()=>[n(L,{"item-style":"display: flex;"},{default:a(()=>[n(It,{value:"me",label:"与我相关"}),n(It,{value:"handle",label:"近7日待处理"})]),_:1})]),_:1},8,["value"])]),_:1}),n(Oe,{span:"24 s:12 m:5"},{default:a(()=>[n(L,{class:"w-full"},{default:a(()=>[m(ae)("aftermarket:select:permission.do")?(R(),U(m(T),{key:0,ghost:"",onClick:m(l)},{icon:a(()=>[n(At,{class:"text-icon"})]),default:a(()=>[i[43]||(i[43]=z(" "+Z("查询")))]),_:1,__:[43]},8,["onClick"])):N("",!0),m(ae)("aftermarket:delete:permission.do")?(R(),U(m(T),{key:1,type:"error",disabled:m(I).length===0,onClick:$t},{icon:a(()=>[n(F,{class:"text-icon"})]),default:a(()=>[i[44]||(i[44]=z(" "+Z("批量删除")))]),_:1,__:[44]},8,["disabled"])):N("",!0),m(ae)("aftermarket:select:permission.do")?(R(),U(m(T),{key:2,onClick:m(l)},{icon:a(()=>[n(Tt,{class:"text-icon"})]),default:a(()=>[i[45]||(i[45]=z(" "+Z("刷新")))]),_:1,__:[45]},8,["onClick"])):N("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),n(V,{"checked-row-keys":m(I),"onUpdate:checkedRowKeys":i[21]||(i[21]=w=>Ue(I)?I.value=w:null),columns:m(ut),data:m(Me),size:"small",loading:m(r),remote:"",style:{"margin-top":"20px"},"max-height":400,"scroll-x":2600,"row-key":w=>w.id,pagination:m(A),class:"sm:h-full",striped:""},null,8,["checked-row-keys","columns","data","loading","row-key","pagination"])]),_:1},8,["show"]),n(ne,{show:ce.value,"onUpdate:show":i[26]||(i[26]=w=>ce.value=w),title:"售后处理",preset:"card",class:"w-85%"},{default:a(()=>[n(_e,{ref_key:"formRef",ref:e,model:Le,"label-placement":"left","label-width":100,"show-feedback":!1},{default:a(()=>[n(Rt,{responsive:"screen","item-responsive":"","x-gap":16,"y-gap":16},{default:a(()=>[n(Oe,{span:"24 s:24 m:24"},{default:a(()=>[n(L,{class:"w-full"},{default:a(()=>[m(ae)("aftermarketRes:select:permission.do")?(R(),U(m(T),{key:0,ghost:"",onClick:m(K)},{icon:a(()=>[n(At,{class:"text-icon"})]),default:a(()=>[i[46]||(i[46]=z(" "+Z("查询")))]),_:1,__:[46]},8,["onClick"])):N("",!0),m(ae)("aftermarketRes:insert:permission.do")?(R(),U(m(T),{key:1,type:"primary",ghost:"",onClick:i[23]||(i[23]=w=>ft({id:Le.aid||O.aid},"add"))},{icon:a(()=>[n(H,{class:"text-icon"})]),default:a(()=>[i[47]||(i[47]=z(" "+Z("添加")))]),_:1,__:[47]})):N("",!0),m(ae)("aftermarketRes:delete:permission.do")?(R(),U(m(T),{key:2,type:"error",disabled:m(I).length===0,onClick:i[24]||(i[24]=w=>Pt(void 0))},{icon:a(()=>[n(F,{class:"text-icon"})]),default:a(()=>[i[48]||(i[48]=z(" "+Z("批量删除")))]),_:1,__:[48]},8,["disabled"])):N("",!0),m(ae)("aftermarketRes:select:permission.do")?(R(),U(m(T),{key:3,onClick:m(K)},{icon:a(()=>[n(Tt,{class:"text-icon"})]),default:a(()=>[i[49]||(i[49]=z(" "+Z("刷新")))]),_:1,__:[49]},8,["onClick"])):N("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),n(V,{"checked-row-keys":m(Ce),"onUpdate:checkedRowKeys":i[25]||(i[25]=w=>Ue(Ce)?Ce.value=w:null),columns:m(G),data:m(le),size:"small",loading:m(pe),remote:"",style:{"margin-top":"20px"},"max-height":400,"row-key":w=>w.id,pagination:m(te),class:"sm:h-full",striped:""},null,8,["checked-row-keys","columns","data","loading","row-key","pagination"])]),_:1},8,["show"]),n(ne,{show:ie.value,"onUpdate:show":i[31]||(i[31]=w=>ie.value=w),title:O.type==="add"?"添加责任人":"修改责任人",preset:"card",class:"w-600px"},{footer:a(()=>[n(L,{justify:"end"},{default:a(()=>[n(m(T),{size:"small",class:"mt-16px",onClick:mt},{default:a(()=>[z(Z(m(Y)("common.cancel")),1)]),_:1}),n(m(T),{type:"primary",size:"small",class:"mt-16px",onClick:Sn},{default:a(()=>[z(Z(m(Y)("common.confirm")),1)]),_:1})]),_:1})]),default:a(()=>[n(_e,{ref_key:"formRef",ref:e,model:C,"label-placement":"left"},{default:a(()=>[n(ve,{label:"责任人",path:"notes",required:""},{default:a(()=>[n(W,{disabled:"",value:O.username,"onUpdate:value":i[27]||(i[27]=w=>O.username=w),placeholder:"请输入责任人",clearable:""},null,8,["value"])]),_:1}),n(ve,{label:"原因分析",path:"notes"},{default:a(()=>[n(W,{type:"textarea",value:O.reason,"onUpdate:value":i[28]||(i[28]=w=>O.reason=w),placeholder:"请输入原因分析",clearable:""},null,8,["value"])]),_:1}),n(ve,{label:"处理意见",path:"notes"},{default:a(()=>[n(W,{type:"textarea",value:O.resolution,"onUpdate:value":i[29]||(i[29]=w=>O.resolution=w),placeholder:"请输入处理意见",clearable:""},null,8,["value"])]),_:1}),n(ve,{label:"改进措施",path:"notes"},{default:a(()=>[n(W,{type:"textarea",value:O.improvement,"onUpdate:value":i[30]||(i[30]=w=>O.improvement=w),placeholder:"请输入改进措施",clearable:""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title"])]),_:1}),n(An,{show:y.value,"onUpdate:show":i[32]||(i[32]=w=>y.value=w),current:u.value,"onUpdate:current":[i[33]||(i[33]=w=>u.value=w),zn],"src-list":g.value},null,8,["show","current","src-list"])])}}}),dl=un(Ji,[["__scopeId","data-v-de6656fc"]]);export{dl as default};

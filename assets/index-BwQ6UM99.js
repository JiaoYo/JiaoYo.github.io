import{_ as _e,a as fe}from"./close-small-rounded-LpT_N4ly.js";import{d as E,v as K,r as A,J as ge,K as F,o as b,c as $,w as n,f as V,g as e,h as p,L as N,aV as re,C as j,B,aj as X,aZ as ue,E as q,D as z,S as ve,ax as Z,j as M,t as J,a9 as R,e as G,ai as de,a_ as be,a$ as ye,at as ke,A as W,aS as he,N as I,i as T,b0 as Q,b1 as Y,ar as ce,b2 as ee,b3 as te,X as L,y as we,b4 as Ce,b5 as xe,P as $e,b6 as Te,ap as Se,aq as Ue}from"./index-DvMCw3Rq.js";import{h as Ve,i as De,j as Ne,k as Ie,l as Ee,m as Be,n as qe,o as Pe,p as Oe,q as Me,r as je,s as Ge,t as Ae,u as Fe,v as Re,w as Je,x as ze,y as Le,z as We,A as He,B as Ke,C as Xe,D as Ze,E as Qe}from"./basic-config-JbWbfaap.js";import{_ as Ye}from"./Table-DUXfg9p0.js";import{f as ne}from"./reportForm-BzqZPaHr.js";import{f as ae}from"./scheduleTask-DhcLTABZ.js";import{b as et,a as tt,_ as le}from"./DataTable-BnT_71C1.js";import{_ as nt}from"./DatePicker-Dl0NE0go.js";import{_ as se}from"./TimePicker-DEF8Y02A.js";import{u as oe}from"./table-T3UoskuP.js";import{_ as at}from"./FormItemGridItem-B8AmNpme.js";import{_ as lt}from"./Grid-BUt7FBa5.js";import{u as st}from"./usePageData-Cbb2Peb0.js";import{a as ot}from"./events-DWT4oJab.js";import{_ as it}from"./Upload-DUayfKBS.js";import"./Forward-Cwgm3-FY.js";import"./defineProperty-Do2CpaIT.js";import"./Progress-CRnql7vs.js";const rt={class:"flex justify-center"},ut=E({name:"basicConfig",__name:"basicConfig",setup(P){const{formRef:c,validate:y,restoreValidation:l}=K(),i=A(h());function h(){return{enablelock:1,locktime:5,lockcount:3,unlockeanble:1,unlocktime:5,aceffective:1,pwdexpire:1,expiretime:1,cputhreshold:80,memthreshold:80,captcha:1,tokentime:30}}const x={type:"number",required:!0,message:"不能为空",trigger:["blur","change"]},w={locktime:x,lockcount:x,unlocktime:x,expiretime:x,cputhreshold:x,memthreshold:x,tokentime:x},f=async()=>{const{data:s,error:a}=await Ve();a||Object.assign(i,s)};ge(()=>{f()});const t=async()=>{var a;await y();const{error:s}=await De(i);s||(a=window.$message)==null||a.success("设置成功")};return(s,a)=>{const _=re,u=j,o=B,v=X,m=ue,d=q,k=z,g=ve,C=F("no-auth");return b(),$(g,{style:{"max-height":"calc(100vh - 245px)"}},{default:n(()=>[V("div",rt,[e(k,{ref_key:"formRef",ref:c,"label-width":180,"label-placement":"left",model:i,rules:w},{default:n(()=>[e(u,{label:"是否开启账号锁定",path:"enablelock"},{default:n(()=>[e(_,{value:i.enablelock,"onUpdate:value":a[0]||(a[0]=r=>i.enablelock=r),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),e(u,{label:"锁定周期",path:"locktime"},{default:n(()=>[e(m,{class:"flex items-center"},{default:n(()=>[e(o,{onClick:a[1]||(a[1]=r=>i.locktime--),disabled:i.locktime==1},{default:n(()=>[p(" − ")]),_:1},8,["disabled"]),e(v,{"show-button":!1,value:i.locktime,"onUpdate:value":a[2]||(a[2]=r=>i.locktime=r),placeholder:"",min:1,max:5},null,8,["value"]),e(o,{onClick:a[3]||(a[3]=r=>i.locktime++),disabled:i.locktime==5,class:"mr-5px"},{default:n(()=>[p(" + ")]),_:1},8,["disabled"]),p(" 分钟 ")]),_:1})]),_:1}),e(u,{label:"锁定次数",path:"lockcount"},{default:n(()=>[e(m,{class:"flex items-center"},{default:n(()=>[e(o,{onClick:a[4]||(a[4]=r=>i.lockcount--),disabled:i.lockcount==2},{default:n(()=>[p(" − ")]),_:1},8,["disabled"]),e(v,{"show-button":!1,value:i.lockcount,"onUpdate:value":a[5]||(a[5]=r=>i.lockcount=r),placeholder:"",min:2,max:5},null,8,["value"]),e(o,{onClick:a[6]||(a[6]=r=>i.lockcount++),disabled:i.lockcount==5,class:"mr-5px"},{default:n(()=>[p(" + ")]),_:1},8,["disabled"]),p(" 次 ")]),_:1})]),_:1}),e(u,{label:"是否开启自动解锁",path:"unlockeanble"},{default:n(()=>[e(_,{value:i.unlockeanble,"onUpdate:value":a[7]||(a[7]=r=>i.unlockeanble=r),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),e(u,{label:"解锁时间",path:"unlocktime"},{default:n(()=>[e(m,{class:"flex items-center"},{default:n(()=>[e(o,{onClick:a[8]||(a[8]=r=>i.unlocktime--),disabled:i.unlocktime==i.locktime},{default:n(()=>[p(" − ")]),_:1},8,["disabled"]),e(v,{"show-button":!1,value:i.unlocktime,"onUpdate:value":a[9]||(a[9]=r=>i.unlocktime=r),placeholder:"",min:i.locktime},null,8,["value","min"]),e(o,{onClick:a[10]||(a[10]=r=>i.unlocktime++),class:"mr-5px"},{default:n(()=>[p(" + ")]),_:1}),p(" 分钟 ")]),_:1})]),_:1}),e(u,{label:"是否开启账号有效期登录",path:"aceffective"},{default:n(()=>[e(_,{value:i.aceffective,"onUpdate:value":a[11]||(a[11]=r=>i.aceffective=r),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),e(u,{label:"是否开启密码过期",path:"pwdexpire"},{default:n(()=>[e(_,{value:i.pwdexpire,"onUpdate:value":a[12]||(a[12]=r=>i.pwdexpire=r),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),e(u,{label:"密码过期时间",path:"expiretime"},{default:n(()=>[e(m,{class:"flex items-center"},{default:n(()=>[e(o,{onClick:a[13]||(a[13]=r=>i.expiretime--),disabled:i.expiretime==1},{default:n(()=>[p(" − ")]),_:1},8,["disabled"]),e(v,{"show-button":!1,value:i.expiretime,"onUpdate:value":a[14]||(a[14]=r=>i.expiretime=r),placeholder:"",min:1},null,8,["value"]),e(o,{onClick:a[15]||(a[15]=r=>i.expiretime++),class:"mr-5px"},{default:n(()=>[p(" + ")]),_:1}),p(" 天 ")]),_:1})]),_:1}),e(u,{label:"CPU阈值",path:"cputhreshold"},{default:n(()=>[e(m,{class:"flex items-center"},{default:n(()=>[e(o,{onClick:a[16]||(a[16]=r=>i.cputhreshold--),disabled:i.cputhreshold==0},{default:n(()=>[p(" − ")]),_:1},8,["disabled"]),e(v,{"show-button":!1,value:i.cputhreshold,"onUpdate:value":a[17]||(a[17]=r=>i.cputhreshold=r),placeholder:"",min:0,max:100},null,8,["value"]),e(o,{onClick:a[18]||(a[18]=r=>i.cputhreshold++),disabled:i.cputhreshold==100,class:"mr-5px"},{default:n(()=>[p(" + ")]),_:1},8,["disabled"]),p(" % ")]),_:1})]),_:1}),e(u,{label:"MEM阈值",path:"memthreshold"},{default:n(()=>[e(m,{class:"flex items-center"},{default:n(()=>[e(o,{onClick:a[19]||(a[19]=r=>i.memthreshold--),disabled:i.memthreshold==0},{default:n(()=>[p(" − ")]),_:1},8,["disabled"]),e(v,{"show-button":!1,value:i.memthreshold,"onUpdate:value":a[20]||(a[20]=r=>i.memthreshold=r),placeholder:"",min:0,max:100},null,8,["value"]),e(o,{onClick:a[21]||(a[21]=r=>i.memthreshold++),disabled:i.memthreshold==100,class:"mr-5px"},{default:n(()=>[p(" + ")]),_:1},8,["disabled"]),p(" % ")]),_:1})]),_:1}),e(u,{label:"是否开启验证码",path:"captcha"},{default:n(()=>[e(_,{value:i.captcha,"onUpdate:value":a[22]||(a[22]=r=>i.captcha=r),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),e(u,{label:"token过期时间",path:"tokentime"},{default:n(()=>[e(m,{class:"flex items-center"},{default:n(()=>[e(o,{onClick:a[23]||(a[23]=r=>i.tokentime--),disabled:i.tokentime==1},{default:n(()=>[p(" − ")]),_:1},8,["disabled"]),e(v,{"show-button":!1,value:i.tokentime,"onUpdate:value":a[24]||(a[24]=r=>i.tokentime=r),placeholder:"",min:1},null,8,["value"]),e(o,{onClick:a[25]||(a[25]=r=>i.tokentime++),class:"mr-5px"},{default:n(()=>[p(" + ")]),_:1}),p(" 小时 ")]),_:1})]),_:1}),e(u,{label:" "},{default:n(()=>[e(d,null,{default:n(()=>[N((b(),$(o,{type:"default",ghost:"",onClick:f},{default:n(()=>[p(" 刷新 ")]),_:1})),[[C,"system.conf.select"]]),N((b(),$(o,{type:"info",ghost:"",onClick:t},{default:n(()=>[p(" 保存 ")]),_:1})),[[C,"system.conf.update"]])]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1})}}}),dt=Z(ut,[["__scopeId","data-v-3c461f33"]]),ct=V("td",null,"产品名称",-1),pt=V("td",null,"产品版本",-1),mt=V("td",null,"build号",-1),_t=V("td",null,"产品型号",-1),ft=E({name:"basicInfo",__name:"basicInfo",setup(P){const c=M({id:1,pname:"",pversion:"",pbuild:"",pmodel:""});(async()=>{const{data:h,error:x}=await Ne();x||(c.value=h)})(),M(0);const l=async()=>{var w,f;const{data:h,error:x}=await Ie();x||(h==="重启失败"?(w=window.$message)==null||w.error(h):(f=window.$message)==null||f.success(h))},i=async()=>{var w,f;const{data:h,error:x}=await Ee();x||(h==="关机失败"?(w=window.$message)==null||w.error(h):(f=window.$message)==null||f.success(h))};return(h,x)=>{const w=Ye,f=B,t=q,s=R,a=F("no-auth");return b(),$(s,{class:"w-600px text-center m-auto mt-20px"},{default:n(()=>[e(w,{bordered:!0,"single-line":!1},{default:n(()=>[V("tbody",null,[V("tr",null,[ct,V("td",null,J(c.value.pname||""),1)]),V("tr",null,[pt,V("td",null,J(c.value.pversion),1)]),V("tr",null,[mt,V("td",null,J(c.value.pbuild),1)]),V("tr",null,[_t,V("td",null,J(c.value.pmodel),1)])])]),_:1}),e(t,{justify:"center",class:"mt-50px"},{default:n(()=>[N((b(),$(f,{type:"info",ghost:"",onClick:l},{default:n(()=>[p("重启")]),_:1})),[[a,"sysmanger.basicInfo.restart"]]),N((b(),$(f,{type:"info",ghost:"",onClick:i},{default:n(()=>[p("关机")]),_:1})),[[a,"sysmanger.basicInfo.shutdown"]])]),_:1})]),_:1})}}}),gt=E({name:"emailService",__name:"emailSever",setup(P){const{formRef:c,validate:y}=K(),l=M({port:void 0,pwd:"",sendserver:"",essl:0,uname:""}),i={sendserver:[{required:!0,validator:(t,s,a)=>s?be(s)?a():a(new Error("请输入正确的IP地址或域名")):new Error("请输入服务器地址"),trigger:["blur","input"]}],port:{type:"number",required:!0,trigger:["blur","input"],validator:(t,s,a)=>s==null||s==null?new Error("请输入端口号"):ye(s)?!0:new Error("请输入在0-65535之间的数字")},uname:[{required:!0,message:"请输入账号",trigger:"blur"}],pwd:[{required:!0,message:"请输入密码",trigger:"blur"}],sendaddr:[{required:!0,message:"请输入发件邮箱",trigger:["blur","input"]},{validator:ke,trigger:["blur","input"]}]},h=async()=>{const{data:t,error:s}=await Be();s||(l.value.sendserver=(t==null?void 0:t.sendserver)??l.value.sendserver,l.value.port=(t==null?void 0:t.port)??l.value.port,l.value.pwd=(t==null?void 0:t.pwd)??l.value.pwd,l.value.essl=(t==null?void 0:t.essl)??l.value.essl,l.value.uname=(t==null?void 0:t.uname)??l.value.uname,l.value.id=(t==null?void 0:t.id)??l.value.id)};h();const x=async()=>{var t,s,a,_;if(await y(),l.value.id){const{data:u,error:o}=await qe(l.value);o||((t=window.$message)==null||t.destroyAll(),(s=window.$message)==null||s.success("保存成功"))}else{const{data:u,error:o}=await Pe(l.value);o||((a=window.$message)==null||a.destroyAll(),(_=window.$message)==null||_.success("保存成功"))}},w=async()=>{var a,_;const{data:t,error:s}=await Oe();s||((a=window.$message)==null||a.destroyAll(),(_=window.$message)==null||_.success("重置成功"),h())},f=async()=>{var a,_;await y();const{data:t,error:s}=await Me(l.value);s||((a=window.$message)==null||a.destroyAll(),(_=window.$message)==null||_.success("测试成功"))};return(t,s)=>{const a=W,_=j,u=X,o=re,v=z,m=B,d=q,k=F("no-auth");return b(),G(de,null,[e(v,{ref_key:"formRef",ref:c,"label-width":150,model:l.value,rules:i,"label-placement":"left",class:"w-400px",style:{margin:"50px auto"}},{default:n(()=>[e(_,{label:"发送邮件服务器",path:"sendserver"},{default:n(()=>[e(a,{value:l.value.sendserver,"onUpdate:value":s[0]||(s[0]=g=>l.value.sendserver=g),placeholder:"输入服务器或IP地址"},null,8,["value"])]),_:1}),e(_,{label:"端口",path:"port"},{default:n(()=>[e(u,{value:l.value.port,"onUpdate:value":s[1]||(s[1]=g=>l.value.port=g),placeholder:"输入端口",style:{width:"100%"}},null,8,["value"])]),_:1}),e(_,{label:"用户名",path:"uname"},{default:n(()=>[e(a,{value:l.value.uname,"onUpdate:value":s[2]||(s[2]=g=>l.value.uname=g),placeholder:"用户名"},null,8,["value"])]),_:1}),e(_,{label:"密码",path:"pwd"},{default:n(()=>[e(a,{type:"password",value:l.value.pwd,"onUpdate:value":s[3]||(s[3]=g=>l.value.pwd=g),placeholder:"密码","show-password-on":"click"},null,8,["value"])]),_:1}),e(_,{label:"ssl",path:"essl"},{default:n(()=>[e(o,{value:l.value.essl,"onUpdate:value":s[4]||(s[4]=g=>l.value.essl=g),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1})]),_:1},8,["model"]),e(d,{justify:"center"},{default:n(()=>[N((b(),$(m,{type:"info",ghost:"",onClick:f},{default:n(()=>[p("测试")]),_:1})),[[k,"sysmanger.basicInfo.test.mailInfo"]]),N((b(),$(m,{type:"info",ghost:"",onClick:x},{default:n(()=>[p("保存")]),_:1})),[[k,"sysmanger.mailInfo.update"]]),N((b(),$(m,{type:"info",ghost:"",onClick:w},{default:n(()=>[p("重置")]),_:1})),[[k,"sysmanger.mailInfo.delete"]])]),_:1})],64)}}}),vt=E({name:"TimingConfig",__name:"timingConfig",setup(P){const{formRef:c,validate:y}=K(),l=A({automatic:1,time:he(1,new Date),ip:"",taskId:"",showCron:!1,setting:{settingCycle:void 0,settingCycleValue:void 0,settingTime:void 0}}),i={time:{required:!0,message:"请选择时间",trigger:"blur"},ip:[{required:!0,message:"请输入IP",trigger:"blur"},{validator:ce,trigger:"blur"}],task:{required:!0,message:"请设置表达式",trigger:"blur"},setting:{settingCycle:{type:"number",required:!0,message:"请选择设置周期",trigger:"blur"},settingCycleValue:{type:"number",required:!0,message:"请选择设置周期值",trigger:"blur"},settingTime:{required:!0,message:"请选择设置时间",trigger:"blur"}}},h=async()=>{const{data:f,error:t}=await je();t||(l.time=f)};h(),(async()=>{const{data:f,error:t}=await Ge();if(t)return;const{id:s,params:a}=f;try{if(a){const{cron:_,ip:u}=JSON.parse(a),o=ee(_);l.setting.settingCycle=o==null?void 0:o.settingCycle,l.setting.settingTime=o==null?void 0:o.settingTime,l.setting.settingCycleValue=o==null?void 0:o.settingCycleValue,l.ip=u,l.taskId=s}}catch(_){console.error("Error parsing params:",_)}})();const w=async()=>{var f,t;if(await y(),l.automatic){const{data:s,error:a}=await Ae({dtime:l.time});a||(f=window.$message)==null||f.success(s)}else{const s=te(l.setting.settingCycle==1?{dayOfWeek:l.setting.settingCycleValue,time:l.setting.settingTime}:null,l.setting.settingCycle==2?{dayOfMonth:l.setting.settingCycleValue,time:l.setting.settingTime}:null,l.setting.settingCycle==3?{time:l.setting.settingTime}:null);l.taskId?await ae({id:l.taskId,beanName:"NtpTask",cronExpression:s,remark:"",status:1,params:JSON.stringify({ip:l.ip,cron:s})}):await ne({beanName:"NtpTask",cronExpression:s,remark:"",status:1,params:JSON.stringify({ip:l.ip,cron:s})});const{data:a,error:_}=await Fe({ip:l.ip});_||(t=window.$message)==null||t.success(a)}};return(f,t)=>{const s=et,a=q,_=tt,u=j,o=nt,v=W,m=L,d=se,k=B,g=z,C=F("no-auth");return b(),$(g,{ref_key:"formRef",ref:c,"label-width":180,"label-placement":"left",model:l,class:"m-auto w-600px mt-20px",rules:i},{default:n(()=>[e(u,{label:"校时",path:"enablelock"},{default:n(()=>[e(_,{value:l.automatic,"onUpdate:value":t[0]||(t[0]=r=>l.automatic=r),name:"radiogroup"},{default:n(()=>[e(a,null,{default:n(()=>[e(s,{value:1},{default:n(()=>[p("手动校时")]),_:1}),e(s,{value:0},{default:n(()=>[p("自动校时")]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),l.automatic?(b(),$(u,{key:0,label:"设置中心服务器时间",path:"time"},{default:n(()=>[e(o,{"formatted-value":l.time,"onUpdate:formattedValue":t[1]||(t[1]=r=>l.time=r),format:"yyyy-MM-dd HH:mm:ss",type:"datetime",clearable:""},null,8,["formatted-value"])]),_:1})):I("",!0),l.automatic?I("",!0):(b(),G(de,{key:1},[e(u,{label:"NTP服务器设置",path:"ip"},{default:n(()=>[e(v,{value:l.ip,"onUpdate:value":t[2]||(t[2]=r=>l.ip=r),placeholder:"输入NTP服务器设置"},null,8,["value"])]),_:1}),e(u,{label:"设置周期",path:"setting.settingCycle"},{default:n(()=>[e(a,{justify:"space-between"},{default:n(()=>[e(m,{value:l.setting.settingCycle,"onUpdate:value":[t[3]||(t[3]=r=>l.setting.settingCycle=r),t[4]||(t[4]=r=>l.setting.settingCycleValue=1)],options:[{label:"每周",value:1},{label:"每月",value:2},{label:"每日",value:3}],style:{width:"200px"}},null,8,["value"]),e(u,{label:"",path:"setting.settingCycleValue","show-feedback":!1},{default:n(()=>[e(a,null,{default:n(()=>[l.setting.settingCycle==1?(b(),$(m,{key:0,value:l.setting.settingCycleValue,"onUpdate:value":t[5]||(t[5]=r=>l.setting.settingCycleValue=r),options:T(Q)(),style:{width:"200px"}},null,8,["value","options"])):I("",!0),l.setting.settingCycle==2?(b(),$(m,{key:1,value:l.setting.settingCycleValue,"onUpdate:value":t[6]||(t[6]=r=>l.setting.settingCycleValue=r),options:T(Y)(),style:{width:"200px"}},null,8,["value","options"])):I("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),e(u,{label:"设置时间",path:"setting.settingTime"},{default:n(()=>[e(d,{"formatted-value":l.setting.settingTime,"onUpdate:formattedValue":t[7]||(t[7]=r=>l.setting.settingTime=r)},null,8,["formatted-value"])]),_:1})],64)),e(u,null,{label:n(()=>[l.automatic?N((b(),$(k,{key:0,type:"info",ghost:"",onClick:h},{default:n(()=>[p(" 查看服务器时间 ")]),_:1})),[[C,"sysmanger.basicInfo.gettiming"]]):I("",!0)]),default:n(()=>[e(a,null,{default:n(()=>[N((b(),$(k,{type:"info",ghost:"",onClick:w},{default:n(()=>[p(" 保存 ")]),_:1})),[[C,"sysmanger.basicInfo.manu.timing"]])]),_:1})]),_:1})]),_:1},8,["model"])}}}),bt={class:"h-full flex-col"},yt=E({name:"dataBase",__name:"dataBase",setup(P){const c=()=>[...Array(12).keys()].map(u=>({label:`${u+1}个月`,value:u+1})),y=A({space:80,retention:void 0,id:void 0}),{columns:l,columnChecks:i,data:h,getData:x,loading:w,mobilePagination:f,searchParams:t,resetSearchParams:s}=oe({apiFn:Re,immediate:!0,apiParams:{page:1,limit:20},columns:()=>[{title:"时间",key:"dbtime",align:"center"},{title:"描述",key:"dbdesc",align:"center"},{title:"结果",key:"dbstatus",align:"center"}]});(async()=>{const{data:u,error:o}=await Je();o||(y.space=u.space,y.retention=u.retention,y.id=u.id)})();const _=async()=>{var v;const{data:u,error:o}=await ze({space:y.space,retention:y.retention,id:y.id});o||(v=window.$message)==null||v.success("保存成功")};return(u,o)=>{const v=B,m=X,d=ue,k=j,g=L,C=q,r=R,O=le,U=F("no-auth");return b(),G("div",bt,[e(r,{title:"数据库维护配置",bordered:!1,class:"mb-20px","content-style":{padding:"0"},"header-style":{paddingTop:"0"}},{default:n(()=>[e(C,{class:"ml-50px"},{default:n(()=>[e(k,{label:"已用空间超过","label-placement":"left"},{default:n(()=>[e(d,{class:"flex items-center"},{default:n(()=>[e(v,{onClick:o[0]||(o[0]=D=>y.space--),disabled:y.space==1},{default:n(()=>[p(" − ")]),_:1},8,["disabled"]),e(m,{"show-button":!1,value:y.space,"onUpdate:value":o[1]||(o[1]=D=>y.space=D),placeholder:"",min:1,max:100,style:{width:"100px","text-align":"center"}},null,8,["value"]),e(v,{onClick:o[2]||(o[2]=D=>y.space++),disabled:y.space==100,class:"mr-5px"},{default:n(()=>[p(" + ")]),_:1},8,["disabled"]),p(" % 时自动维护 ")]),_:1})]),_:1}),e(k,{label:"数据保留时间","label-placement":"left",class:"mx-20px"},{default:n(()=>[e(g,{value:y.retention,"onUpdate:value":o[3]||(o[3]=D=>y.retention=D),placeholder:"请选择",options:c(),style:{width:"150px"}},null,8,["value","options"])]),_:1}),e(k,{label:" ","label-placement":"left"},{default:n(()=>[N((b(),$(v,{type:"info",ghost:"",onClick:_},{default:n(()=>[p("保存")]),_:1})),[[U,"sysmanger.basicInfo.insert.dataBaseMaintenance"]])]),_:1})]),_:1})]),_:1}),e(r,{title:"数据库维护列表",bordered:!1,class:"flex-1","content-style":{padding:"0"},"header-style":{paddingTop:"0"}},{default:n(()=>[e(O,{columns:T(l),data:T(h),size:"small","scroll-x":462,loading:T(w),remote:"","row-key":D=>D.id,pagination:T(f),class:"sm:h-full"},null,8,["columns","data","loading","row-key","pagination"])]),_:1})])}}}),kt={class:"h-full flex-col"},ht=E({name:"dataBackup",__name:"dataBackup",setup(P){const{columns:c,columnChecks:y,data:l,getData:i,loading:h,mobilePagination:x,searchParams:w,resetSearchParams:f}=oe({apiFn:Le,immediate:!0,apiParams:{page:1,limit:20},columns:()=>[{title:"时间",key:"dbtime",align:"center"},{title:"描述",key:"dbdesc",align:"center"},{title:"结果",key:"dbstatus",align:"center"}]}),t=A({id:"",ip:"",username:"",pwd:"",path:"",cron:"",showCron:!1,setting:{settingCycle:void 0,settingCycleValue:void 0,settingTime:void 0}}),s=M(null),a={ip:[{required:!0,message:"请输入IP",trigger:"blur"},{validator:ce,trigger:"blur"}],cron:{required:!0,message:"请设置表达式",trigger:"blur"},username:{required:!0,message:"请输入账号",trigger:"blur"},pwd:{required:!0,message:"请输入密码",trigger:"blur"},path:{required:!0,message:"请输入路径",trigger:"blur"},setting:{settingCycle:{type:"number",required:!0,message:"请选择设置周期",trigger:"blur"},settingCycleValue:{type:"number",required:!0,message:"请选择设置周期值",trigger:"blur"},settingTime:{required:!0,message:"请选择设置时间",trigger:"blur"}}};(async()=>{const{data:m,error:d}=await We();if(d)return;const{id:k,params:g}=m;if(t.id=k,g)try{const{ip:C,username:r,pwd:O,path:U,cron:D}=JSON.parse(g),H=ee(D);Object.assign(t,{ip:C,username:r,pwd:O,path:U,cron:D,setting:H})}catch(C){console.error("Error parsing params:",C)}})();const u=async()=>{var d,k,g;await((d=s.value)==null?void 0:d.validate());const m=te(t.setting.settingCycle==1?{dayOfWeek:t.setting.settingCycleValue,time:t.setting.settingTime}:null,t.setting.settingCycle==2?{dayOfMonth:t.setting.settingCycleValue,time:t.setting.settingTime}:null,t.setting.settingCycle==3?{time:t.setting.settingTime}:null);if(t.id){const{data:C,error:r}=await ae({beanName:"DataBackUpsTask",id:t.id,cronExpression:m,remark:"",status:1,params:JSON.stringify({ip:t.ip,username:t.username,pwd:t.pwd,path:t.path,cron:m})});r||(k=window.$message)==null||k.success("备份设置成功")}else{const{data:C,error:r}=await ne({beanName:"DataBackUpsTask",cronExpression:m,remark:"",status:1,params:JSON.stringify({ip:t.ip,username:t.username,pwd:t.pwd,path:t.path,cron:m})});r||(g=window.$message)==null||g.success("备份设置成功")}},o=(m,d)=>d===null?!1:Number(d)==6?m!=0:!1,v=(m,d,k)=>k===null||d===null?!1:Number(k)==6?m!=0:!1;return(m,d)=>{const k=W,g=at,C=L,r=j,O=q,U=se,D=B,H=lt,pe=z,ie=R,me=le;return b(),G("div",kt,[e(ie,{title:"数据库备份",bordered:!1,class:"mb-20px","content-style":{padding:"0"},"header-style":{paddingTop:"0"}},{default:n(()=>[e(pe,{"label-placement":"left",model:t,rules:a,"label-width":150,class:"px-100px"},{default:n(()=>[e(H,{cols:24,"x-gap":24},{default:n(()=>[e(g,{span:8,label:"IP地址",path:"ip"},{default:n(()=>[e(k,{value:t.ip,"onUpdate:value":d[0]||(d[0]=S=>t.ip=S),placeholder:"",style:{width:"100%"}},null,8,["value"])]),_:1}),e(g,{span:8,label:"账号",path:"username"},{default:n(()=>[e(k,{value:t.username,"onUpdate:value":d[1]||(d[1]=S=>t.username=S),placeholder:"",style:{width:"100%"}},null,8,["value"])]),_:1}),e(g,{span:8,label:"密码",path:"pwd"},{default:n(()=>[e(k,{type:"password","show-password-on":"mousedown",value:t.pwd,"onUpdate:value":d[2]||(d[2]=S=>t.pwd=S),placeholder:"",style:{width:"100%"}},null,8,["value"])]),_:1}),e(g,{span:8,label:"路径",path:"path"},{default:n(()=>[e(k,{value:t.path,"onUpdate:value":d[3]||(d[3]=S=>t.path=S),placeholder:"",style:{width:"100%"}},null,8,["value"])]),_:1}),e(g,{span:8,label:"设置周期",path:"setting.settingCycle"},{default:n(()=>[e(O,{justify:"space-between"},{default:n(()=>[e(C,{value:t.setting.settingCycle,"onUpdate:value":[d[4]||(d[4]=S=>t.setting.settingCycle=S),d[5]||(d[5]=S=>t.setting.settingCycleValue=1)],options:[{label:"每周",value:1},{label:"每月",value:2}],style:{width:"140px"}},null,8,["value"]),e(r,{label:"",path:"setting.settingCycleValue","show-feedback":!1},{default:n(()=>[t.setting.settingCycle==1?(b(),$(C,{key:0,value:t.setting.settingCycleValue,"onUpdate:value":d[6]||(d[6]=S=>t.setting.settingCycleValue=S),options:T(Q)(),style:{width:"140px"}},null,8,["value","options"])):I("",!0),t.setting.settingCycle==2?(b(),$(C,{key:1,value:t.setting.settingCycleValue,"onUpdate:value":d[7]||(d[7]=S=>t.setting.settingCycleValue=S),options:T(Y)(),style:{width:"140px"}},null,8,["value","options"])):I("",!0)]),_:1})]),_:1})]),_:1}),e(g,{span:8,label:"设置时间",path:"setting.settingTime"},{default:n(()=>[e(O,{justify:"space-between"},{default:n(()=>[e(U,{"formatted-value":t.setting.settingTime,"onUpdate:formattedValue":d[8]||(d[8]=S=>t.setting.settingTime=S),hours:[0,1,2,3,4,5,6],"is-minute-disabled":o,"is-second-disabled":v,actions:["confirm"]},null,8,["formatted-value"]),e(D,{type:"info",ghost:"",onClick:u},{default:n(()=>[p("保存")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(ie,{title:"数据备份列表",bordered:!1,class:"flex-1","content-style":{padding:"0"},"header-style":{paddingTop:"0"}},{default:n(()=>[e(me,{columns:T(c),data:T(l),size:"small","scroll-x":462,loading:T(h),remote:"","row-key":S=>S.id,pagination:T(x),class:"sm:h-full"},null,8,["columns","data","loading","row-key","pagination"])]),_:1})])}}}),wt=Z(ht,[["__scopeId","data-v-cd1a61b3"]]),Ct={class:"h-full flex-col"},xt=E({name:"systemSnapshot",__name:"systemSnapshot",setup(P){const{columns:c,columnChecks:y,data:l,getData:i,loading:h,mobilePagination:x,searchParams:w,resetSearchParams:f}=oe({apiFn:He,immediate:!0,apiParams:{page:1,limit:20},columns:()=>[{title:"时间",key:"dbtime",align:"center"},{title:"描述",key:"dbdesc",align:"center"},{title:"结果",key:"dbstatus",align:"center"}]}),t=A({id:"",setting:{settingCycle:void 0,settingCycleValue:void 0,settingTime:void 0}}),s={setting:{settingCycle:{type:"number",required:!0,message:"请选择设置周期",trigger:"blur"},settingCycleValue:{type:"number",required:!0,message:"请选择设置周期值",trigger:"blur"},settingTime:{required:!0,message:"请选择设置时间",trigger:"blur"}}};(async()=>{const{data:u,error:o}=await Ke();if(o)return;console.log(u,"asdas");const v=ee(u.cronExpression);Object.assign(t,{id:u.id,setting:v})})();const _=async()=>{var o,v;const u=te(t.setting.settingCycle==1?{dayOfWeek:t.setting.settingCycleValue,time:t.setting.settingTime}:null,t.setting.settingCycle==2?{dayOfMonth:t.setting.settingCycleValue,time:t.setting.settingTime}:null,t.setting.settingCycle==3?{time:t.setting.settingTime}:null);if(t.id){const{data:m,error:d}=await ae({id:t.id,beanName:"SnapshotTask",cronExpression:u,status:1,params:JSON.stringify({corn:u})});d||(o=window.$message)==null||o.success("设置成功")}else{const{data:m,error:d}=await ne({beanName:"SnapshotTask",cronExpression:u,remark:"",status:1,params:JSON.stringify({corn:u})});d||(v=window.$message)==null||v.success("设置成功")}};return(u,o)=>{const v=L,m=j,d=q,k=se,g=B,C=z,r=R,O=le;return b(),G("div",Ct,[e(r,{title:"快照备份设置",bordered:!1,"content-style":{padding:"0"},"header-style":{paddingTop:"0"}},{default:n(()=>[e(d,{class:"ml-50px"},{default:n(()=>[e(C,{"label-placement":"left",inline:"",model:t,rules:s,"label-width":150,class:"px-100px"},{default:n(()=>[e(m,{label:"设置周期",path:"setting.settingCycle"},{default:n(()=>[e(d,{justify:"space-between"},{default:n(()=>[e(v,{value:t.setting.settingCycle,"onUpdate:value":[o[0]||(o[0]=U=>t.setting.settingCycle=U),o[1]||(o[1]=U=>t.setting.settingCycleValue=1)],options:[{label:"每周",value:1},{label:"每月",value:2},{label:"每日",value:3}],style:{width:"140px"}},null,8,["value"]),e(m,{label:"",path:"setting.settingCycleValue","show-feedback":!1},{default:n(()=>[t.setting.settingCycle==1?(b(),$(v,{key:0,value:t.setting.settingCycleValue,"onUpdate:value":o[2]||(o[2]=U=>t.setting.settingCycleValue=U),options:T(Q)(),style:{width:"140px"}},null,8,["value","options"])):I("",!0),t.setting.settingCycle==2?(b(),$(v,{key:1,value:t.setting.settingCycleValue,"onUpdate:value":o[3]||(o[3]=U=>t.setting.settingCycleValue=U),options:T(Y)(),style:{width:"140px"}},null,8,["value","options"])):I("",!0)]),_:1})]),_:1})]),_:1}),e(m,{label:"设置时间",path:"setting.settingTime"},{default:n(()=>[e(k,{"formatted-value":t.setting.settingTime,"onUpdate:formattedValue":o[4]||(o[4]=U=>t.setting.settingTime=U)},null,8,["formatted-value"])]),_:1}),e(m,{label:" ","label-placement":"left"},{default:n(()=>[e(g,{type:"info",ghost:"",onClick:_},{default:n(()=>[p("保存")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),e(r,{title:"快照备份列表",bordered:!1,"content-style":{padding:"0"},"header-style":{paddingTop:"0"},class:"flex-1"},{default:n(()=>[e(O,{columns:T(c),data:T(l),size:"small","scroll-x":462,loading:T(h),remote:"","row-key":U=>U.id,pagination:T(x),class:"sm:h-full"},null,8,["columns","data","loading","row-key","pagination"])]),_:1})])}}}),$t=E({__name:"sysStatus",setup(P){const c=A({mailaddr:"",snmpaddr:void 0,stype:0,tmail:0,tsnmp:0});(async()=>{const{data:t,error:s}=await Xe();s||(c.mailaddr=(t==null?void 0:t.mailaddr)??c.mailaddr,c.snmpaddr=(t==null?void 0:t.snmpaddr)??c.snmpaddr,c.stype=(t==null?void 0:t.stype)??c.stype,c.tmail=(t==null?void 0:t.tmail)??c.tmail,c.tsnmp=(t==null?void 0:t.tsnmp)??c.tsnmp)})();const l=async()=>{var a;const{data:t,error:s}=await Ze(c);s||(a=window.$message)==null||a.success("保存成功")},{pageData:i,getData:h,nextPage:x}=st(ot),w=async t=>{const s=t.currentTarget;s.scrollTop+s.offsetHeight>=s.scrollHeight&&i.data.length<i.total&&x()},f=M();return we(()=>i.data,t=>{t&&(f.value=t.filter(s=>s.ftype===1))}),h(),(t,s)=>{const a=xe,_=$e,u=W,o=j,v=L,m=B,d=q,k=R,g=F("no-auth");return b(),$(d,{justify:"center"},{default:n(()=>[e(k,{title:"通知方式",class:"w-600px"},{default:n(()=>[e(a),e(_,{checked:c.tmail,"onUpdate:checked":s[0]||(s[0]=C=>c.tmail=C),"checked-value":1,"unchecked-value":0},{default:n(()=>[p(" 邮件 ")]),_:1},8,["checked"]),c.tmail?(b(),$(o,{key:0,label:"邮件地址","label-placement":"left","label-width":"120",class:"mt-30px",rule:{required:!0,validator:()=>{if(!c.mailaddr)return new Error("请输入邮件地址");if(!T(Ce)(c.mailaddr))return new Error("请输入正确的邮件地址")},trigger:["blur","input"]}},{default:n(()=>[e(u,{value:c.mailaddr,"onUpdate:value":s[1]||(s[1]=C=>c.mailaddr=C)},null,8,["value"])]),_:1},8,["rule"])):I("",!0),e(a),e(_,{checked:c.tsnmp,"onUpdate:checked":s[2]||(s[2]=C=>c.tsnmp=C),"checked-value":1,"unchecked-value":0},{default:n(()=>[p(" snmp trap ")]),_:1},8,["checked"]),c.tsnmp?(b(),$(o,{key:1,label:"通知服务器","label-placement":"left","label-width":"120",class:"mt-30px"},{default:n(()=>[e(v,{value:c.snmpaddr,"onUpdate:value":s[3]||(s[3]=C=>c.snmpaddr=C),options:f.value,"label-field":"ipaddr","value-field":"ipaddr",onScroll:w},null,8,["value","options"])]),_:1})):I("",!0),e(a),e(d,{justify:"end"},{default:n(()=>[N((b(),$(m,{type:"info",ghost:"",onClick:l},{default:n(()=>[p("保存")]),_:1})),[[g,"sysmanger.basicInfo.alarmNotification"]])]),_:1})]),_:1})]),_:1})}}}),Tt={class:"h-full"},St=E({name:"basicconfig_system-config",__name:"index",setup(P){const c=M("基本信息"),y=M(""),l=M(null),i=({file:w})=>{l.value=w.file,y.value=w.name},h=w=>{w.stopPropagation(),y.value="",l.value=null};A({fs:""});const x=async()=>{var w;try{const f=new FormData;f.append("fi",l.value);const{data:t,error:s}=await Qe({name:y.value},f);if(s)return;(w=window.$message)==null||w.success(t)}catch{}};return(w,f)=>{const t=Se,s=_e,a=fe,_=B,u=it,o=j,v=q,m=Ue,d=R,k=F("no-auth");return b(),G("div",Tt,[e(d,{style:{"margin-bottom":"16px"},class:"h-full","content-style":{height:"100%"}},{default:n(()=>[e(m,{type:"card",animated:"",class:"h-100%",value:c.value,"onUpdate:value":f[1]||(f[1]=g=>c.value=g)},{default:n(()=>[e(t,{name:"基本信息",tab:"基本信息"},{default:n(()=>[e(ft)]),_:1}),e(t,{name:"基础配置",tab:"基础配置"},{default:n(()=>[e(dt)]),_:1}),e(t,{name:"邮件服务",tab:"邮件服务"},{default:n(()=>[e(gt)]),_:1}),e(t,{name:"校时配置",tab:"校时配置"},{default:n(()=>[e(vt)]),_:1}),e(t,{name:"数据库维护",tab:"数据库维护",class:"h-100%"},{default:n(()=>[e(yt)]),_:1}),e(t,{name:"数据库备份",tab:"数据库备份",class:"h-100%"},{default:n(()=>[e(wt)]),_:1}),e(t,{name:"系统快照",tab:"系统快照",class:"h-100%"},{default:n(()=>[e(xt)]),_:1}),e(t,{name:"情报库",tab:"情报库"},{default:n(()=>[e(v,{justify:"center",class:"pt-20px important-flex-col items-center"},{default:n(()=>[e(o,{label:"上传情报库文件","label-placement":"left"},{default:n(()=>[e(u,{action:"","custom-request":i,"show-file-list":!1,accept:".zip"},{default:n(()=>[y.value?(b(),G("div",{key:0,onClick:f[0]||(f[0]=Te(()=>{},["stop"]))},[p(J(y.value)+" ",1),e(s,{class:"font-size-30px cursor-pointer",onClick:h})])):(b(),$(_,{key:1},{icon:n(()=>[e(a,{class:"text-icon"})]),default:n(()=>[p(" 选择文件")]),_:1}))]),_:1})]),_:1}),e(o,{label:"","label-placement":"left",class:"ml-20px"},{default:n(()=>[N((b(),$(_,{type:"info",ghost:"",disabled:!y.value,onClick:x},{default:n(()=>[p("提交")]),_:1},8,["disabled"])),[[k,"sysmanger.basicInfo.intelligence"]])]),_:1})]),_:1})]),_:1}),e(t,{name:"系统告警通知",tab:"系统告警通知"},{default:n(()=>[e($t)]),_:1})]),_:1},8,["value"])]),_:1})])}}}),Lt=Z(St,[["__scopeId","data-v-a3e9a019"]]);export{Lt as default};

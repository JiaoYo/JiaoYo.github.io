import{G as v,d as z,q as Z,s as ee,j as L,y as te,o as Y,c as ae,w as s,f as U,g as n,aS as g,S as oe,F as ne,av as le,aw as se,ax as ue,e as re,i as ie,h as X,aJ as I,$ as pe,ak as de,am as ce,X as me,C as ye,B as ve,D as _e,a9 as fe}from"./index-COCU-dRC.js";import{j as be,k as Pe}from"./reportForm-BtvdI97H.js";import{f as Ce}from"./asset-Dndavozh.js";import{u as he}from"./usePageData-YwCZ_Txz.js";import{_ as ge,a as xe,b as Te,c as je}from"./file-pdf-Ct8_Brz3.js";import{_ as we}from"./DatePicker-C8CF71gD.js";import{a as Le,_ as De}from"./Grid-DXM2gQBE.js";import"./index-BS8KoN7o.js";import"./installCanvasRenderer-iCPGNWhM.js";import"./TimePicker-hUC2kxSD.js";import"./defineProperty-rwZg3Jcs.js";import"./Forward-Cj8r8vQs.js";const Se=d=>{const p=JSON.parse(JSON.stringify(d));return[{type:"title",value:"资产信息报表"},{type:"subtitle",value:"一、资产基本信息"},{type:"table",value:{head:["资产名称","资产类型","网段名称","主IP","创建时间"],body:p.baseInfo.map(o=>[o.aname,o.assname,o.nname,o.aip,o.dbtime])}},{type:"subtitle",value:"二、资产类型分布统计"},{type:"chart",value:{chartType:"pie",id:v(),data:Object.entries(p.assetType).map(([o,P],m)=>({value:P,name:o}))}}]},$e=(d,p)=>{var P,m,u,r,C,h,x,T,j,w,_,i,a,f,b,D,S,$,k,A,N,y,O,R,B,E,M,J,G,H,V,F,K,Q,W;const t=JSON.parse(JSON.stringify(d)),o=["一般","低级","中级","高级","严重"];return[{type:"title",value:"审计信息"},{type:"title",value:p.startTime+" — "+p.endTime},{type:"subtitle",value:"一、概述"},{type:"text",value:"1.1 产生事件数量如下"},{type:"table",value:{head:["事件类型","事件数量"],body:[["安全事件",t.e1],["关联事件",t.e2],["审计事件",t.e3],["告警事件",t.e4],["威胁情报事件",t.e5]]}},{type:"subtitle",value:"二、安全事件"},{type:"text",value:"2.1 安全事件等级统计"},{type:"chart",value:{chartType:"pie",id:v(),data:o.map((e,c)=>{const l=`e${c+1}`;return{value:t.secureCountPojo[l]==0||t.secureCountPojo[l]==null?null:t.secureCountPojo[l],name:e}})}},{type:"table",value:{head:["安全事件等级","事件数量"],body:o.map((e,c)=>{const l=t.secureCountPojo[`e${c+1}`];return[e,l]})}},{type:"text",value:"2.2 安全事件类型统计（TOP10）"},{type:"chart",value:{chartType:"bar",id:v(),data:{xAxis:(m=(P=t.secureCountPojo)==null?void 0:P.typeCountPojoList)==null?void 0:m.map(e=>e.tname),series:[{name:"",data:(r=(u=t.secureCountPojo)==null?void 0:u.typeCountPojoList)==null?void 0:r.map(e=>e.tcount)}]}}},{type:"table",value:{head:["安全事件类型","事件数量"],body:(h=(C=t.secureCountPojo)==null?void 0:C.typeCountPojoList)==null?void 0:h.map(e=>[e.tname,e.tcount])}},{type:"text",value:"2.3 安全事件数量趋势"},{type:"chart",value:{chartType:"line",id:v(),data:{xAxis:(T=(x=t.secureCountPojo)==null?void 0:x.dayCountPojoList)==null?void 0:T.map(e=>e.date.substring(0,10)),series:[{name:"",data:(w=(j=t.secureCountPojo)==null?void 0:j.dayCountPojoList)==null?void 0:w.map(e=>e.dailycount)}]}}},{type:"table",value:{head:["日期","事件数量"],body:(_=t.secureCountPojo.dayCountPojoList)==null?void 0:_.map(e=>[e.date.substring(0,10),e.dailycount])}},{type:"subtitle",value:"三、审计事件"},{type:"text",value:"3.1 审计事件等级统计"},{type:"chart",value:{chartType:"pie",id:v(),data:o.map((e,c)=>{const l=`e${c+1}`;return{value:t.auditCountPojo[l]==0||t.auditCountPojo[l]==null?null:t.auditCountPojo[l],name:e}})}},{type:"table",value:{head:["审计事件等级","事件数量"],body:o.map((e,c)=>{const l=t.auditCountPojo[`e${c+1}`];return[e,l]})}},{type:"text",value:"3.2 审计事件类型统计（TOP10）"},{type:"chart",value:{chartType:"bar",id:v(),data:{xAxis:(a=(i=t.auditCountPojo)==null?void 0:i.typeCountPojoList)==null?void 0:a.map(e=>e.tname),series:[{name:"",data:(b=(f=t.auditCountPojo)==null?void 0:f.typeCountPojoList)==null?void 0:b.map(e=>e.tcount)}]}}},{type:"table",value:{head:["审计事件类型","事件数量"],body:(S=(D=t.auditCountPojo)==null?void 0:D.typeCountPojoList)==null?void 0:S.map(e=>[e.tname,e.tcount])}},{type:"text",value:"3.3 审计事件数量趋势"},{type:"chart",value:{chartType:"line",id:v(),data:{xAxis:(k=($=t.auditCountPojo)==null?void 0:$.dayCountPojoList)==null?void 0:k.map(e=>e.date.substring(0,10)),series:[{name:"",data:(N=(A=t.auditCountPojo)==null?void 0:A.dayCountPojoList)==null?void 0:N.map(e=>e.dailycount)}]}}},{type:"table",value:{head:["日期","事件数量"],body:(O=(y=t.auditCountPojo)==null?void 0:y.dayCountPojoList)==null?void 0:O.map(e=>[e.date.substring(0,10),e.dailycount])}},{type:"subtitle",value:"四、告警事件"},{type:"text",value:"4.1 告警事件等级统计"},{type:"chart",value:{chartType:"pie",id:v(),data:o.map((e,c)=>{const l=`e${c+1}`;return{value:t.alarmCountPojo[l]==0||t.alarmCountPojo[l]==null?null:t.alarmCountPojo[l],name:e}})}},{type:"table",value:{head:["告警事件等级","事件数量"],body:o.map((e,c)=>{const l=t.alarmCountPojo[`e${c+1}`];return[e,l]})}},{type:"text",value:"4.2 告警事件类型统计（TOP10）"},{type:"chart",value:{chartType:"bar",id:v(),data:{xAxis:(B=(R=t.alarmCountPojo)==null?void 0:R.typeCountPojoList)==null?void 0:B.map(e=>e.tname),series:[{name:"",data:(M=(E=t.alarmCountPojo)==null?void 0:E.typeCountPojoList)==null?void 0:M.map(e=>e.tcount)}]}}},{type:"table",value:{head:["告警事件类型","事件数量"],body:(G=(J=t.alarmCountPojo)==null?void 0:J.typeCountPojoList)==null?void 0:G.map(e=>[e.tname,e.tcount])}},{type:"text",value:"4.3 告警事件数量趋势"},{type:"chart",value:{chartType:"line",id:v(),data:{xAxis:(V=(H=t.alarmCountPojo)==null?void 0:H.dayCountPojoList)==null?void 0:V.map(e=>e.date.substring(0,10)),series:[{name:"",data:(K=(F=t.alarmCountPojo)==null?void 0:F.dayCountPojoList)==null?void 0:K.map(e=>e.dailycount)}]}}},{type:"table",value:{head:["日期","事件数量"],body:(W=(Q=t.alarmCountPojo)==null?void 0:Q.dayCountPojoList)==null?void 0:W.map(e=>[e.date.substring(0,10),e.dailycount])}}]},ke=d=>(le("data-v-81822e3e"),d=d(),se(),d),Ae=ke(()=>U("span",{class:"mr-20px"},"报表预览",-1)),Ie={title:"导出PDF"},Ne={title:"导出Word"},Ue={title:"导出Excel"},Oe=z({name:"reportPreview",__name:"reportPreview",props:Z({data:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:["update:visible"],setup(d){const p=d,t=ee(d,"visible"),o=L(""),P=()=>{var u,r;o.value=((r=(u=p.data)==null?void 0:u.find(C=>C.type=="title"))==null?void 0:r.value)+"报表"+g(1,new Date)};te(t,()=>{t.value&&P()});const m=L();return(u,r)=>{const C=ge,h=xe,x=Te,T=je,j=oe,w=ne;return Y(),ae(w,{show:t.value,"onUpdate:show":r[3]||(r[3]=_=>t.value=_),preset:"card",class:"w-1000px"},{header:s(()=>[Ae,U("span",Ie,[n(C,{class:"text-32px c-#d63031 cursor-pointer",onClick:r[0]||(r[0]=_=>m.value.toPdf(o.value))})]),U("span",Ne,[n(h,{class:"text-32px c-#1e90ff cursor-pointer",onClick:r[1]||(r[1]=_=>m.value.toWord(o.value))})]),U("span",Ue,[n(x,{class:"text-32px c-#15703d cursor-pointer",onClick:r[2]||(r[2]=_=>m.value.toExcel(o.value))})])]),default:s(()=>[n(j,{class:"max-h-600px"},{default:s(()=>[n(T,{ref_key:"filePreviewExportRef",ref:m,width:800,data:p.data},null,8,["data"])]),_:1})]),_:1},8,["show"])}}}),Re=ue(Oe,[["__scopeId","data-v-81822e3e"]]),Xe=z({name:"reportmanagement_reporttemplate",__name:"index",setup(d){const p=L(!1),t=L({atypes:[],time:void 0,startTime:void 0,endTime:void 0}),o=L([]),P=async()=>{var f;o.value=[];const{data:i,error:a}=await be({startTime:t.value.startTime,endTime:t.value.endTime,atypes:(f=t.value.atypes)==null?void 0:f.join(",")});a||(p.value=!0,o.value=Se(i))};async function m(i,a){t.value.startTime=g(1,a[0]),t.value.endTime=g(1,a[1])}const u=L({time:[new Date().getTime()-864e5*30,new Date().getTime()],startTime:g(0,new Date().getTime()-864e5*30),endTime:g(0,new Date().getTime())}),r=async()=>{o.value=[];const{data:i,error:a}=await Pe({startTime:u.value.startTime,endTime:u.value.endTime});a||(p.value=!0,o.value=$e(i,{startTime:u.value.startTime,endTime:u.value.endTime}))};async function C(i,a){u.value.startTime=g(0,a[0]),u.value.endTime=g(0,a[1])}const{pageData:h,getData:x,nextPage:T}=he(Ce),j=async i=>{const a=i.currentTarget;a.scrollTop+a.offsetHeight>=a.scrollHeight&&h.data.length<h.total&&T()};x();const w=i=>{const a=i.pid;return I("div",{style:{width:"100%",display:"flex",justifyContent:"space-between"}},[I("div",null,[i.aname]),I("span",{depth:3,tag:"div",style:{color:"#999"}},{default:()=>pe(de[a])})])},_=({option:i,handleClose:a})=>I(ce,{style:{padding:"0 6px 0 4px"},closable:!0,onClose:f=>{f.stopPropagation(),a()}},{default:()=>I("div",{style:{display:"flex",alignItems:"center"}},[i.aname])});return(i,a)=>{const f=me,b=ye,D=we,S=ve,$=_e,k=fe,A=Le,N=De;return Y(),re("div",null,[n(N,{"x-gap":"12",cols:2},{default:s(()=>[n(A,null,{default:s(()=>[n(k,{title:"资产信息报表"},{default:s(()=>[n($,{ref:"formRef",class:"h-200px","label-width":80,"label-placement":"left",model:t.value},{default:s(()=>[n(b,{label:"资产类型",path:"atypes"},{default:s(()=>[n(f,{value:t.value.atypes,"onUpdate:value":a[0]||(a[0]=y=>t.value.atypes=y),placeholder:"请选择资产类型",clearable:"",filterable:"","value-field":"id",multiple:"","label-field":"aname",options:ie(h).data,"reset-menu-on-options-change":!1,class:"w-60%","render-label":w,"render-tag":_,onScroll:j},null,8,["value","options"])]),_:1}),n(b,{label:"查询日期",path:"selectTime"},{default:s(()=>[n(D,{value:t.value.time,"onUpdate:value":a[1]||(a[1]=y=>t.value.time=y),type:"daterange",clearable:"",class:"w-60%","onUpdate:formattedValue":m},null,8,["value"])]),_:1}),n(b,{label:" "},{default:s(()=>[n(S,{"attr-type":"button",onClick:P},{default:s(()=>[X(" 查询 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),n(A,null,{default:s(()=>[n(k,{title:"综合报表"},{default:s(()=>[n($,{ref:"formRef",class:"h-200px","label-width":80,"label-placement":"left",model:u.value},{default:s(()=>[n(b,{label:"查询日期",path:"selectTime"},{default:s(()=>[n(D,{value:u.value.time,"onUpdate:value":a[2]||(a[2]=y=>u.value.time=y),type:"daterange",clearable:"",class:"w-60%","onUpdate:formattedValue":C},null,8,["value"])]),_:1}),n(b,{label:""}),n(b,{label:" "},{default:s(()=>[n(S,{"attr-type":"button",onClick:r},{default:s(()=>[X(" 查询 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]),_:1}),n(Re,{data:o.value,visible:p.value,"onUpdate:visible":a[3]||(a[3]=y=>p.value=y)},null,8,["data","visible"])])}}});export{Xe as default};

import{d as N,o as b,b as x,e as t,a4 as Q,_ as A,m as v,al as fe,a as K,am as _e,f as y,an as ne,p as q,i as U,c as ce,w as z,t as f,F as re,af as X,ao as Z,ap as de,g as L,k as pe,z as ee,ag as ae,ac as ve,h as J,v as he,ab as ie,u as be,r as we,aq as ye,ar as oe,as as ge,at as se,A as xe,J as Se,au as le,av as Ce,aw as $e,ax as ke,ay as Fe,ak as De}from"./index-C8U_DyWX.js";import{u as ue,L as P}from"./echarts-DN_MmwPL.js";import{G as Te,h as Le,a as Ie}from"./metar-CIZDaPPF.js";const Me={class:"loader-overlay"},Ae=N({__name:"loading",props:{color:{default:"#1890ff"}},setup(r){const e=r;return(d,n)=>(b(),x("div",Me,[t("div",{class:"loader",style:Q({"--c":`no-repeat linear-gradient(${e.color} 0 0)`})},null,4)]))}}),Be=A(Ae,[["__scopeId","data-v-c4fc24aa"]]),Ne=r=>(q("data-v-4ea05f61"),r=r(),U(),r),Ee=["width","height"],We=["fill","stroke","d"],He=["stroke"],Pe=Ne(()=>t("path",{fill:"transparent",stroke:"{mergedColor[1]}",d:"M 5 20 L 5 10 L 12 3  L 60 3 L 68 10"},null,-1)),Re=["stroke","d"],ze={class:"dv-border-box-content"},Oe=N({__name:"border-box-13",props:{color:{type:Array,default:()=>[]},backgroundColor:{type:String,default:"transparent"}},setup(r){const e=r,d=["#6586ec","#2cf7fe"],n=v(null),{width:u,height:_}=fe(n,{width:0,height:0},{box:"border-box"}),h=K(()=>_e(d,e.color));return(C,S)=>(b(),x("div",{class:"dv-border-box-13 dv-border-box",ref_key:"domRef",ref:n},[(b(),x("svg",{width:y(u),height:y(_),class:"dv-border-svg-container"},[t("path",{fill:r.backgroundColor,stroke:h.value[0],d:`
            M 5 20 L 5 10 L 12 3  L 60 3 L 68 10
            L ${y(u)-20} 10 L ${y(u)-5} 25
            L ${y(u)-5} ${y(_)-5} L 20 ${y(_)-5}
            L 5 ${y(_)-20} L 5 20
        `},null,8,We),t("path",{fill:"transparent","stroke-width":"3","stroke-linecap":"round","stroke-dasharray":"10, 5",stroke:h.value[0],d:"M 16 9 L 61 9"},null,8,He),Pe,t("path",{fill:"transparent",stroke:h.value[1],d:`M ${y(u)-5} ${y(_)-30} L ${y(u)-5} ${y(_)-5} L ${y(u)-30} ${y(_)-5}`},null,8,Re)],8,Ee)),t("div",ze,[ne(C.$slots,"default",{},void 0,!0)])],512))}}),Ve=A(Oe,[["__scopeId","data-v-4ea05f61"]]),me=r=>(q("data-v-586f7d9f"),r=r(),U(),r),je={key:0,class:"item_title"},qe=me(()=>t("div",{class:"zuo"},null,-1)),Ue={class:"title-inner"},Ye=me(()=>t("div",{class:"you"},null,-1)),Ge=N({__name:"item-wrap",props:{title:{default:""}},setup(r){return(e,d)=>{const n=Ve;return b(),ce(n,null,{default:z(()=>[e.title!==""?(b(),x("div",je,[qe,t("span",Ue,"   "+f(e.title)+"   ",1),Ye])):re("",!0),t("div",{class:X(e.title!==""?"item_title_content":"item_title_content_def")},[ne(e.$slots,"default",{},void 0,!0)],2)]),_:3})}}}),Je=A(Ge,[["__scopeId","data-v-586f7d9f"]]),Qe={class:"list"},Ke={class:"item_info"},Xe={class:"title"},Ze={class:"value"},et=N({__name:"left-bottom",props:{data:{type:Object,default:()=>({})}},setup(r){const e=r,d=[{minTemp:-1/0,maxTemp:-20,color:"#00008B",name:"深蓝色"},{minTemp:-20,maxTemp:0,color:"#1E90FF",name:"蓝色"},{minTemp:0,maxTemp:10,color:"#87CEFA",name:"浅蓝色"},{minTemp:10,maxTemp:20,color:"#32CD32",name:"绿色"},{minTemp:20,maxTemp:30,color:"#FFD700",name:"黄色"},{minTemp:30,maxTemp:40,color:"#FF8C00",name:"橙色"},{minTemp:40,maxTemp:1/0,color:"#FF0000",name:"红色"}];function n(o){const s=d.find(a=>o>a.minTemp&&o<=a.maxTemp);return s?s.color:"#CCCCCC"}const u=[{min:-1/0,max:970,level:"极低",color:"#8A2BE2",desc:"强低压系统(如台风)"},{min:970,max:990,level:"低",color:"#9370DB",desc:"低压系统(如气旋)"},{min:990,max:1010,level:"偏低",color:"#4169E1",desc:"弱低压"},{min:1010,max:1030,level:"正常",color:"#3CB371",desc:"正常气压范围"},{min:1030,max:1050,level:"偏高",color:"#FFD700",desc:"高压脊"},{min:1050,max:1/0,level:"高",color:"#FF8C00",desc:"强高压系统"}];function _(o){const s=u.find(a=>o>a.min&&o<=a.max);return s?s.color:"#CCCCCC"}const h=[{max:20,level:"极干燥",color:"#D2B48C"},{max:40,level:"干燥",color:"#F4A460"},{max:55,level:"较干燥",color:"#FFE4B5"},{max:65,level:"理想",color:"#98FB98"},{max:75,level:"较湿润",color:"#AFEEEE"},{max:85,level:"高湿",color:"#6495ED"},{max:95,level:"极高湿",color:"#4169E1"},{max:1/0,level:"饱和",color:"#9370DB"}];function C(o){const s=h.find(a=>o<=a.max);return s?s.color:"#CCCCCC"}const S=[{maxSpeed:.5,level:0,desc:"无风",color:"#FFFFFF"},{maxSpeed:1.5,level:1,desc:"软风",color:"#E6F7FF"},{maxSpeed:3.3,level:2,desc:"轻风",color:"#B3E0FF"},{maxSpeed:5.4,level:3,desc:"微风",color:"#66C2FF"},{maxSpeed:7.9,level:4,desc:"和风",color:"#4CD964"},{maxSpeed:10.7,level:5,desc:"清风",color:"#A3E043"},{maxSpeed:13.8,level:6,desc:"强风",color:"#FFCC00"},{maxSpeed:17.1,level:7,desc:"疾风",color:"#FF9500"},{maxSpeed:20.7,level:8,desc:"大风",color:"#FF6600"},{maxSpeed:24.4,level:9,desc:"烈风",color:"#FF3B30"},{maxSpeed:28.4,level:10,desc:"狂风",color:"#CC0000"},{maxSpeed:32.6,level:11,desc:"暴风",color:"#9900CC"},{maxSpeed:1/0,level:12,desc:"飓风",color:"#660066"}];function $(o){const s=S.find(a=>o<=a.maxSpeed);return s?s.color:"#000000"}const w=[{max:100,level:"极弱",color:"#1A237E"},{max:200,level:"弱",color:"#1976D2"},{max:400,level:"中等",color:"#4CAF50"},{max:600,level:"强",color:"#FFEB3B"},{max:800,level:"很强",color:"#FF9800"},{max:1e3,level:"极强",color:"#F44336"},{max:1/0,level:"危险",color:"#9C27B0"}];function i(o){const s=w.find(a=>o<=a.max);return s?s.color:"#000000"}const c=K(()=>{var o,s,a,l,p,k,M,E,R,W,F;return[{key:"envT",title:"温度",value:((o=e.data)==null?void 0:o.envT)||0,color:n(((s=e.data)==null?void 0:s.envT)||0),unit:"℃",icon:"carbon:temperature-celsius"},{key:"envH",title:"湿度",value:((a=e.data)==null?void 0:a.envH)||0,color:C(((l=e.data)==null?void 0:l.envH)||0),unit:"%",icon:"lets-icons:humidity"},{key:"qy",title:"气压",value:((p=e.data)==null?void 0:p.qy)||0,color:_(((k=e.data)==null?void 0:k.qy)||0),unit:"hPa",icon:"mdi:car-brake-low-pressure"},{key:"windS",title:"风速",value:((M=e.data)==null?void 0:M.windS)||0,color:$(((E=e.data)==null?void 0:E.windS)||0),unit:"m/s",icon:"hugeicons:slow-winds"},{key:"windD",title:"风向",value:((R=e.data)==null?void 0:R.windD)||0,color:"#00FFFF",unit:"°",icon:"mdi:windsock"},{key:"zfsdCount",title:"总辐射",value:((W=e.data)==null?void 0:W.zfsd)||0,color:i(((F=e.data)==null?void 0:F.zfsd)||0),unit:"W/㎡",icon:"material-symbols:clear-day-rounded"}]});return(o,s)=>{const a=pe;return b(),x("div",Qe,[(b(!0),x(Z,null,de(c.value,(l,p)=>(b(),x("div",{class:X(["item",{brBom:[0,1,2].includes(p),brLeft:[0,1,3,4].includes(p)}]),key:l.key},[L(a,{icon:l.icon,class:"iconx",style:Q({color:l.color})},null,8,["icon","style"]),t("div",Ke,[t("div",Xe,f(l.title),1),t("div",Ze,f(l.value)+f(l.unit),1)])],2))),128))])}}}),tt=A(et,[["__scopeId","data-v-457a9dd9"]]),I=r=>(q("data-v-ee7e91f5"),r=r(),U(),r),at={class:"dashboard"},ot={class:"stats-table"},st=I(()=>t("td",{class:"label"},"CPU使用率:",-1)),lt={class:"value",colspan:"2"},nt=I(()=>t("td",{class:"label"},"内存使用率:",-1)),ct={class:"value",colspan:"2"},rt=I(()=>t("td",{class:"label"},"运行状态:",-1)),dt={class:"value",colspan:"2"},it=I(()=>t("td",{class:"label"},"是否限电:",-1)),ut={class:"value",colspan:"2"},mt=I(()=>t("td",{class:"label"},"数据接入:",-1)),ft={class:"value",colspan:"2"},_t=I(()=>t("td",{class:"label"},"数据上报:",-1)),pt={class:"value",colspan:"2"},vt=I(()=>t("td",{class:"label"},"有功功率(MW):",-1)),ht={class:"value",colspan:"2"},bt=I(()=>t("td",{class:"label"},"无功功率(MVar):",-1)),wt={class:"value",colspan:"2"},yt=I(()=>t("td",{class:"label"},"更新时间:",-1)),gt={class:"value",colspan:"2"},xt=I(()=>t("td",{class:"label"},"功率因数:",-1)),St={class:"value"},Ct=I(()=>t("td",{class:"label"},"日发电量(MWh):",-1)),$t={class:"value",colspan:"2"},kt=I(()=>t("td",{class:"label"},"总发电量(MWh):",-1)),Ft={class:"value",colspan:"2"},Dt=N({__name:"left-top",props:{data:{type:Object,default:()=>({})}},setup(r){const e=r;return(d,n)=>(b(),x("div",at,[t("table",ot,[t("tbody",null,[t("tr",null,[st,t("td",lt,f(e.data.cpu?e.data.cpu+"%":""),1),nt,t("td",ct,f(e.data.mem?e.data.mem+"%":""),1)]),t("tr",null,[rt,t("td",dt,f(e.data.stationP&&e.data.stationP>0&&e.data.stationControlled==0?"并网运行":e.data.stationP&&e.data.stationP>0&&e.data.stationControlled==1?"降额运行":e.data.stationP==0?"待机":""),1),it,t("td",ut,f(e.data.stationControlled==1?"是":"否"),1)]),t("tr",null,[mt,t("td",ft,f(e.data.col=="0"?"🟢":e.data.col=="1"?"🔴":"⚪"),1),_t,t("td",pt,f(e.data.trs=="0"?"🟢":e.data.trs=="1"?"🔴":"⚪"),1)]),t("tr",null,[vt,t("td",ht,f(e.data.stationP??"-"),1),bt,t("td",wt,f(e.data.stationQ??"-"),1)]),t("tr",null,[yt,t("td",gt,f(e.data.dbtime||"-"),1),xt,t("td",St,f(e.data.stationCOS??"-"),1)]),t("tr",null,[Ct,t("td",$t,f(e.data.stationDayE??"-"),1),kt,t("td",Ft,f(e.data.stationTotalE??"-"),1)])])])]))}}),Tt=A(Dt,[["__scopeId","data-v-ee7e91f5"]]),Lt=r=>(q("data-v-dc930ac1"),r=r(),U(),r),It={class:"inner_right"},Mt=Lt(()=>t("div",{class:"dibu"},null,-1)),At={class:"info"},Bt={class:"alarmName"},Nt={class:"info_bottom"},Et={class:"alarmLevel"},Wt={class:"time"},Ht=5e3,Pt=3,Rt={__name:"left-center",props:{data:{type:Array,default:()=>[]}},setup(r){const e=r,d=[{label:"一般",color:"#0091FF",value:0},{label:"低级",color:"#ffd600",value:1},{label:"中级",color:"#ffab00",value:2},{label:"高级",color:"#ff6d00",value:3},{label:"严重",color:"#dd2c00",value:4}],n=s=>d.find(a=>a.value===s)||{},u=v(!0),_=K(()=>u.value?[...e.data,...e.data]:e.data),h=v(!1),C=v(),S=v();let $=null;const w=()=>{h.value=!0,u.value=!1,clearInterval($)},i=()=>{h.value=!1,u.value=!0,ae(()=>{c()})},c=()=>{clearInterval($),$=setInterval(()=>{var M;if(h.value||!u.value)return;const s=C.value,a=S.value;if(!s||!a)return;const l=((M=a.children[0])==null?void 0:M.offsetHeight)||0,p=a.scrollHeight/2,k=s.scrollTop+l*Pt;k>=p?o(k,()=>{s.scrollTop=k-p}):o(k)},Ht)},o=(s,a)=>{const l=C.value,p=800,k=l.scrollTop,M=s-k,E=performance.now(),R=F=>F<.5?2*F*F:-1+(4-2*F)*F,W=F=>{const Y=F-E,V=Math.min(Y/p,1);l.scrollTop=k+M*R(V),V<1?requestAnimationFrame(W):a&&a()};requestAnimationFrame(W)};return ee(()=>{ae(()=>{c()})}),ve(()=>{clearInterval($)}),(s,a)=>(b(),x("div",{class:X(["left_boottom scroll-view",{"show-scrollbar":h.value}]),ref_key:"scrollViewRef",ref:C,onMouseenter:w,onMouseleave:i},[t("div",{ref_key:"listRef",ref:S,class:"left_boottom_list"},[(b(!0),x(Z,null,de(_.value,(l,p)=>(b(),x("div",{class:"left_boottom_item",key:p},[t("div",It,[Mt,t("div",At,[t("div",Bt,"告警名称："+f(l.aname),1),t("div",Nt,[t("div",Et,[J(" 告警等级： "),t("span",{style:Q({color:n(l.alevel).color,border:"1px solid "+n(l.alevel).color,padding:"0 5px",borderRadius:"5px"})},f(n(l.alevel).label),5)]),t("div",Wt,"时间："+f(l.dbtime),1)])])])]))),128))],512)],34))}},zt=A(Rt,[["__scopeId","data-v-dc930ac1"]]),Ot=N({name:"LineChart",__name:"power",props:{data:{required:!0},dataModifiers:{}},emits:["update:data"],setup(r){const e=(o,s)=>{const a=o.match(/\d+/g);return a?`rgba(${a[0]}, ${a[1]}, ${a[2]}, ${s})`:""};function d(o,s){return o===0||typeof o=="number"&&!isNaN(o)?o+s:""}const n=["rgb(233, 4, 69)","rgb(0, 150, 136)","rgb(59, 66, 146)","rgb(255, 99, 71)"],u=he(r,"data"),_=v(null),h=Date.now(),C=new Date(h).setHours(23,59,59,999),{domRef:S,updateOptions:$,updateOptionsAsync:w}=ue(()=>({tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}},formatter:function(o){return`
      ${o[0].axisValueLabel||""}<br/>
      <span class="round" style="background-color: ${n[0]}"></span> ${o[0].seriesName}: ${d(o[0].value[1]," MW")}<br/>
      <span class="round" style="background-color: ${n[1]}"></span> ${o[1].seriesName}: ${d(o[1].value[1]," MW")}<br/>
      <span class="round" style="background-color: ${n[2]}"></span> ${o[2].seriesName}: ${d(o[2].value[1]," W/m^2")}<br/>
      <span class="round" style="background-color: ${n[3]}"></span> ${o[3].seriesName}: ${d(o[3].value[1]," W/m^2")}<br/>
      `},backgroundColor:"#6a7985",textStyle:{color:"#d3d6dd"}},legend:{data:["实际功率","预测功率","实际辐射","预测辐射"],textStyle:{color:"#d3d6dd"}},grid:{left:"3%",right:"3%",bottom:"0%",containLabel:!0},xAxis:{type:"time",axisLabel:{formatter:"{HH}:{mm}",color:"#d3d6dd"},max:C+60*1e3,data:[]},yAxis:[{name:"功率MW",type:"value",axisLabel:{formatter:"{value} MW",color:"#d3d6dd"},splitLine:{show:!1,lineStyle:{color:"#757575",width:1}},nameTextStyle:{color:"#d3d6dd"}},{name:"辐射W/m²",type:"value",axisLabel:{formatter:"{value} W/m²",color:"#d3d6dd"},nameTextStyle:{color:"#d3d6dd"},splitLine:{show:!0,lineStyle:{color:"#757575",width:1}}}],series:[{color:n[0],name:"实际功率",type:"line",emphasis:{focus:"series"},yAxisIndex:0,lineStyle:{width:1},showSymbol:!1,areaStyle:{color:new P(0,0,0,1,[{offset:0,color:e(n[0],.3)},{offset:1,color:e(n[0],0)}],!1),shadowColor:e(n[0],.9),shadowBlur:20},data:[],connectNulls:!0},{color:n[1],name:"预测功率",type:"line",yAxisIndex:0,emphasis:{focus:"series"},lineStyle:{width:1},showSymbol:!1,areaStyle:{color:new P(0,0,0,1,[{offset:0,color:e(n[1],.3)},{offset:1,color:e(n[1],0)}],!1),shadowColor:e(n[1],.9),shadowBlur:20},data:[],connectNulls:!0},{color:n[2],name:"实际辐射",type:"line",showSymbol:!1,yAxisIndex:1,emphasis:{focus:"series"},lineStyle:{width:1},areaStyle:{color:new P(0,0,0,1,[{offset:0,color:e(n[2],.3)},{offset:1,color:e(n[2],0)}],!1),shadowColor:e(n[2],.7),shadowBlur:20},data:[],connectNulls:!0},{color:n[3],name:"预测辐射",type:"line",yAxisIndex:1,showSymbol:!1,emphasis:{focus:"series"},lineStyle:{width:1},areaStyle:{color:new P(0,0,0,1,[{offset:0,color:e(n[3],.3)},{offset:1,color:e(n[3],0)}],!1),shadowColor:e(n[3],.7),shadowBlur:20},data:[],connectNulls:!0}]}));async function i(){await new Promise(o=>{setTimeout(o,1e3)}),$(o=>{if(u.value){const s=u.value.map(a=>({dbtime:a.dbtime,prePower:a.prePower,power:a.power,zfsd:a.zfsd,ssrd:a.ssrd}));o.xAxis.data=s.map(a=>a.dbtime),o.series[0].data=s.map(a=>[a.dbtime,a.power]),o.series[1].data=s.map(a=>[a.dbtime,a.prePower]),o.series[2].data=s.map(a=>[a.dbtime,a.zfsd]),o.series[3].data=s.map(a=>[a.dbtime,a.ssrd]),console.log(o.series,"seriesseriesseries")}return o})}ie(()=>u.value,o=>{w(s=>{if(u.value){const a=u.value.map(l=>({dbtime:l.dbtime,prePower:l.prePower,power:l.power,zfsd:l.zfsd,ssrd:l.ssrd}));s.xAxis.data=a.map(l=>l.dbtime),s.series[0].data=a.map(l=>[l.dbtime,l.power]),s.series[1].data=a.map(l=>[l.dbtime,l.prePower]),s.series[2].data=a.map(l=>[l.dbtime,l.zfsd]),s.series[3].data=a.map(l=>[l.dbtime,l.ssrd])}return s})});async function c(){await i()}return ee(()=>{S.value=_.value}),c(),(o,s)=>(b(),x("div",{ref_key:"chartDom",ref:_,class:"chart"},null,512))}}),Vt=A(Ot,[["__scopeId","data-v-3741cc7e"]]),jt=N({name:"LineChart",__name:"weather-chart",props:{data:{type:Array,default:[]}},setup(r){function e(i,c){return i===0||typeof i=="number"&&!isNaN(i)?i+c:""}const d=r,n=Date.now(),u=new Date(n).setHours(23,59,59,999),{domRef:_,updateOptions:h,showLoading:C,updateOptionsAsync:S}=ue(()=>({tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}},valueFormatter:function(i){return e(i,"°C")},backgroundColor:"#6a7985",textStyle:{color:"#d3d6dd"}},legend:{data:["环境温度","预测温度","组件温度"],textStyle:{color:"#d3d6dd"}},grid:{left:"3%",right:"3%",bottom:"0%",containLabel:!0},xAxis:{type:"time",axisLabel:{formatter:"{HH}:{mm}",color:"#d3d6dd"},max:u+60*1e3,data:[]},yAxis:{name:"温度(°C)",type:"value",axisLabel:{formatter:"{value} °C",color:"#d3d6dd"},splitLine:{show:!0,lineStyle:{color:"#757575",width:1}},nameTextStyle:{color:"#d3d6dd"}},series:[{color:"#27ae60",name:"环境温度",type:"line",lineStyle:{width:1},showSymbol:!1,areaStyle:{color:new P(0,0,0,1,[{offset:0,color:"rgba(39, 174, 96,0.4)"},{offset:1,color:"rgba(39, 174, 96,0)"}],!1),shadowColor:"rgba(39, 174, 96,0.9)",shadowBlur:20},emphasis:{focus:"series"},data:[],connectNulls:!0},{color:"#c0392b",name:"预测温度",type:"line",lineStyle:{width:1},showSymbol:!1,areaStyle:{color:new P(0,0,0,1,[{offset:0,color:"rgba(192, 57, 43,0.3)"},{offset:1,color:"rgba(192, 57, 43,0)"}],!1),shadowColor:"rgba(192, 57, 43,0.9)",shadowBlur:20},emphasis:{focus:"series"},data:[],connectNulls:!0},{color:"#ffa000",name:"组件温度",type:"line",lineStyle:{width:1},showSymbol:!1,areaStyle:{color:new P(0,0,0,1,[{offset:0,color:"rgba(255, 160, 0,0.3)"},{offset:1,color:"rgba(255, 160, 0,0)"}],!1),shadowColor:"rgba(255, 160, 0,0.9)",shadowBlur:20},emphasis:{focus:"series"},data:[],connectNulls:!0}]}));async function $(){await new Promise(i=>{setTimeout(i,1e3)}),h(i=>(d.data&&(i.xAxis.data=d.data.map(c=>c.dbtime),i.series[0].data=d.data.map(c=>[c.dbtime,c.envT]),i.series[1].data=d.data.map(c=>[c.dbtime,c.tt2]),i.series[2].data=d.data.map(c=>[c.dbtime,c.moduleT])),i))}async function w(){$()}return ie(()=>d.data,()=>{S(i=>(d.data&&(i.xAxis.data=d.data.map(c=>c.dbtime),i.series[0].data=d.data.map(c=>[c.dbtime,c.envT]),i.series[1].data=d.data.map(c=>[c.dbtime,c.tt2]),i.series[2].data=d.data.map(c=>[c.dbtime,c.moduleT])),i))}),w(),(i,c)=>(b(),x("div",{ref_key:"domRef",ref:_,class:"chart"},null,512))}}),qt=A(jt,[["__scopeId","data-v-ec72b241"]]),Ut="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='12'%20height='12'%20viewBox='0%200%2012%2012'%3e%3cpath%20fill='%23fff'%20d='M2.5%2012c-.13%200-.25-.05-.35-.14l-2-1.93A.55.55%200%200%201%200%209.57V2.43c0-.13.06-.26.15-.36l2-1.93c.15-.14.36-.18.55-.1c.18.08.3.26.3.46v11c0%20.2-.12.38-.3.46c-.07.03-.13.04-.2.04m7-3.5c-.06%200-.13-.01-.19-.04A.5.5%200%200%201%209%208l-.01-4.06c0-.2.12-.39.31-.46c.19-.08.4-.03.54.11l1.67%201.7c.38.39.38%201.02-.01%201.41L9.85%208.35a.47.47%200%200%201-.35.15'%20/%3e%3cpath%20fill='none'%20stroke='%23fff'%20stroke-linecap='round'%20d='M2.5%202.5H6c.28%200%20.5.22.5.5v1m-4%205.5H6c.28%200%20.5-.22.5-.5V8M11%206H5'%20stroke-width='1'%20/%3e%3c/svg%3e",Yt={class:"content_wrap"},Gt={class:"d-flex jc-center title_wrap"},Jt=ye('<div class="zuojuxing" data-v-91961ed0></div><div class="youjuxing" data-v-91961ed0></div><div class="guang" data-v-91961ed0></div><div class="d-flex jc-center" data-v-91961ed0><div class="title" data-v-91961ed0><span class="title-text" data-v-91961ed0>光功率预测系统可视化</span></div></div>',4),Qt={class:"top_Info"},Kt={class:"left"},Xt={class:"right"},Zt={class:"setting_icon"},ea=["src"],ta={class:"index-box"},aa={class:"content_left"},oa={class:"content_right"},sa=N({name:"bigscreen",__name:"index",setup(r){const e=be(),d=we({dateDay:"",dateYear:"",dateWeek:"",timing:null}),n=["周日","周一","周二","周三","周四","周五","周六"];(()=>{d.timing=setInterval(()=>{d.dateDay=oe().format("YYYY-MM-DD hh : mm : ss"),d.dateWeek=n[oe().day()]},1e3)})();const _=v({}),h=v(),C=async()=>{const{data:m,error:D}=await ge({_t:new Date().getTime()});h.value=m==null?void 0:m.pname},S=v(),$=async()=>{var g;const{data:m,error:D}=await Te();D||(S.value=m,S.value.length!=0&&(w.value=(g=m[0])==null?void 0:g.id,c()))},w=v(),i=v(),c=async()=>{const{data:m,error:D}=await Le({devId:w.value});D||(i.value=m)},o=m=>{w.value=m,c(),k()},s=Date.now();new Date(s).setHours(0,0,0,0),new Date(s).setHours(23,59,59,999);const a=v(),l=v(),p=v(),k=async()=>{if(!w.value)return;const{data:m,error:D}=await Ie({id:w.value,startTime:se(0,Date.now())+" 00:00:00",endTime:se(1,Date.now())});console.log("气象实际数据",m),p.value=m,a.value.forEach(g=>{const T=p.value.find(O=>O.dbtime===g.dbtime);T?Object.assign(T,g):p.value.push(g)}),p.value=p.value.sort((g,T)=>new Date(g.dbtime).getTime()-new Date(T.dbtime).getTime())},M=v([]),E=v(null),R=()=>{var te;(te=E.value)==null||te.close();const m=new Date().getTime(),D=xe(),g=Se(`${D}${m}getchlstatus`),T=le(g),O=le("getchlstatus"),B=new Ce($e+`/ChannelStatusWebsocket/${O}/${T}/${m}/${D}?token=${ke()}`,{maxReconnectAttempts:3,heartbeatInterval:1e3*30});E.value=B,B.connect(),B.onclose(()=>{}),B.onerror(()=>{}),B.onopen(()=>{}),B.onmessage(G=>{if(console.log(G,"通道状态websocket接受数据"),!W(G.data))return;const H=JSON.parse(G.data).dataStatus;H&&(_.value.col=H.col+""=="0"||H.col+""=="1"?H.col+"":"",_.value.trs=H.trs+""=="0"||H.trs+""=="1"?H.trs+"":"")})},W=m=>{try{return JSON.parse(m),!0}catch{return!1}},F=()=>{var m;(m=window.$dialog)==null||m.info({title:"退出登录",content:"确定要退出登录吗?",positiveText:"确定",negativeText:"取消",onPositiveClick:async()=>{const{data:D,error:g}=await Fe();g||(e.clearInfo(),window.location.reload())}})},Y=v(null),V=v(null),j=v(!1);return ee(async()=>{C(),R();try{j.value=!0,await $(),await c(),j.value=!1}catch{j.value=!1}Y.value=setInterval(async()=>{},1e3*60*1),V.value=setInterval(async()=>{},1e3*5)}),(m,D)=>{const g=De,T=Je,O=Be;return b(),x(Z,null,[t("div",Yt,[t("div",Gt,[Jt,t("div",Qt,[t("div",Kt,[J(f(h.value)+" ",1),L(g,{filterable:"",placeholder:"请选择气象站",value:w.value,"onUpdate:value":D[0]||(D[0]=B=>w.value=B),options:S.value,"label-field":"sname",size:"tiny","value-field":"id",style:{width:"140px","margin-left":"10px"},onUpdateValue:o},null,8,["value","options"])]),t("div",Xt,[J(f(d.dateYear)+" "+f(d.dateWeek)+" "+f(d.dateDay)+" ",1),t("div",Zt,[t("img",{src:y(Ut),alt:"",onClick:F},null,8,ea)])])])]),t("div",ta,[t("div",aa,[L(T,{class:"content_left-top",title:"运行状态"},{default:z(()=>[L(Tt,{data:_.value},null,8,["data"])]),_:1}),L(T,{class:"content_left-center",title:"最近告警"},{default:z(()=>[L(zt,{data:M.value},null,8,["data"])]),_:1}),L(T,{class:"content_left-bottom",title:"气象信息"},{default:z(()=>[L(tt,{data:i.value},null,8,["data"])]),_:1})]),t("div",oa,[L(T,{class:"content_right-top",title:"今日功率"},{default:z(()=>[L(Vt,{data:l.value},null,8,["data"])]),_:1}),L(T,{class:"content_right-bottom",title:"今日气象"},{default:z(()=>[L(qt,{data:p.value},null,8,["data"])]),_:1})])])]),j.value?(b(),ce(O,{key:0})):re("",!0)],64)}}}),ra=A(sa,[["__scopeId","data-v-91961ed0"]]);export{ra as default};

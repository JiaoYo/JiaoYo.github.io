import{_ as L}from"./twotone-add-circle-outline-CxkuWcNB.js";import{d as C,o as d,e as O,t as k,n as j,ah as A,U as W,q as H,p as J,j as Q,aV as i,c as b,w as n,g as a,i as t,$ as M,ai as X,C as R,h as E,A as Y,af as Z,B as ee,K as te,L as ae,a1 as q,b as oe,aK as z,v as ne,ae as re,al as K,f as P,z as le,bq as se}from"./index-C2u6vOA1.js";import{f as ie}from"./data_report-BMIKGoLf.js";import{u as pe,a as de}from"./table-Cb07FrQD.js";import{e as me}from"./exportExcel-Bv4G4H50.js";import{_ as ce}from"./export-CJmFwq0I.js";import{_ as ue}from"./round-search-SK0LkSqR.js";import{_ as _e}from"./FormItemGridItem-DjiNuyrh.js";import{_ as ye}from"./DatePicker-BQxig712.js";import{_ as fe}from"./Grid-CW5-Kn8z.js";import{_ as he}from"./DataTable-B59_lcFE.js";import"./TimePicker-w36dimYy.js";import"./Forward-DB9iWvzA.js";import"./RadioGroup-dVRs7CWd.js";const we=C({__name:"info",props:["rowData"],setup(f){const m=f;return(h,c)=>(d(),O("div",null,k(m.rowData),1))}}),ge=C({name:"AlarmSearch",__name:"search",props:{model:{required:!0},modelModifiers:{}},emits:j(["reset","search","exportData"],["update:model"]),setup(f,{emit:m}){A({1:"电场1",2:"电场2",3:"电场3"});const h=A({day:"日报",month:"月报",year:"年报"}),c=m,U=W(),{formRef:w,restoreValidation:T}=H(),e=J(f,"model");e.value.time=Q([Number(i(5,Date.now()-864e5*6)),Number(i(5,Date.now()+864e5))]),e.value.startTime=i(0,Date.now()-864e5*6),e.value.endTime=i(0,Date.now()+864e5),e.value.reportType="day";async function u(s,l){e.value.startTime=s[0],e.value.endTime=s[1]}async function r(){var s;if(!e.value.electricFieId){(s=window.$message)==null||s.warning("请选择电场后在进行查询");return}c("search")}const D=()=>{c("exportData")};return(s,l)=>{const V=Z,g=_e,v=ye,F=ue,S=ee,_=ce,$=te,B=fe,N=ae,x=q;return d(),b(x,{bordered:!1,size:"small",class:"card-wrapper"},{default:n(()=>[a(N,{ref_key:"formRef",ref:w,model:e.value,"label-placement":"left","label-width":t(U).locale=="en-US"?120:80,"show-feedback":!1,onKeyup:Y(r,["enter"])},{default:n(()=>[a(B,{"y-gap":16,responsive:"screen","item-responsive":""},{default:n(()=>[a(g,{span:"24 s:12 m:4",label:t(M)("page.datareport.reportType"),path:"level",class:"pr-24px"},{default:n(()=>[a(V,{filterable:"",placeholder:"请选择报表类型",value:e.value.reportType,"onUpdate:value":l[0]||(l[0]=o=>e.value.reportType=o),options:t(X)(t(h))},null,8,["value","options"])]),_:1},8,["label"]),a(g,{span:"24 s:12 m:6",label:"时间",path:"time",class:"pr-24px"},{default:n(()=>[e.value.reportType=="day"?(d(),b(v,{key:0,value:e.value.time,"onUpdate:value":l[1]||(l[1]=o=>e.value.time=o),type:"daterange","value-format":"yyyy-MM-dd","onUpdate:formattedValue":u},null,8,["value"])):R("",!0),e.value.reportType=="month"?(d(),b(v,{key:1,value:e.value.time,"onUpdate:value":l[2]||(l[2]=o=>e.value.time=o),type:"monthrange","value-format":"yyyy-MM",style:{width:"100%"},"onUpdate:formattedValue":u},null,8,["value"])):R("",!0),e.value.reportType=="year"?(d(),b(v,{key:2,value:e.value.time,"onUpdate:value":l[3]||(l[3]=o=>e.value.time=o),type:"yearrange","value-format":"yyyy",style:{width:"100%"},"onUpdate:formattedValue":u},null,8,["value"])):R("",!0)]),_:1}),a(g,{span:"24 s:12 m:6",class:"pr-24px"},{default:n(()=>[a($,{class:"w-full"},{default:n(()=>[a(S,{type:"primary",ghost:"",onClick:r},{icon:n(()=>[a(F,{class:"text-icon"})]),default:n(()=>[E(" "+k(t(M)("common.search")),1)]),_:1}),a(S,{onClick:D},{icon:n(()=>[a(_,{class:"text-icon"})]),default:n(()=>[E(" "+k(t(M)("common.export")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","label-width"])]),_:1})}}}),ve={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},xe={class:"font-size-12px"},Be=C({name:"datareport_ultrashorttermforecastreport",__name:"index",setup(f){const m=oe(()=>r.reportType=="day"?50:0),h=W(),{columns:c,columnChecks:U,data:w,getData:T,loading:e,mobilePagination:u,searchParams:r,resetSearchParams:D}=pe({apiFn:ie,apiParams:{page:1,pageSize:20,limit:20,startTime:i(0,Date.now()-864e5*6)||null,endTime:i(0,Date.now()+864e5)||null,reportType:"",_t:new Date().getTime()},immediate:!1,showTotal:!0,columns:()=>[{title:"",key:"index",width:50,align:"center",render:(o,p)=>`${p+1}`},{type:"expand",width:m,renderExpand:o=>z(we,{rowData:o}),expandable:()=>r.reportType=="day"},{key:"timeFrame",title:"时间范围",align:"center",width:160},{key:"describe",title:"描述",align:"center",minWidth:180},{key:"power_byte",title:"开机容量(兆瓦)",align:"center",width:160},{key:"real_power",title:"实发功率(兆瓦)",align:"center",minWidth:180},{key:"predicted_power",title:"预测功率(兆瓦)",align:"center",width:160},{key:"RMSE",title:"均方根误差",align:"center",width:160},{key:"MAE",title:"平均绝对误差",align:"center",width:160},{key:"Rs",title:"相关性系数",align:"center",minWidth:200}]}),s=[{id:"1",timeFrame:i(0,Date.now()-864e5*5),describe:"日报汇总",power_byte:"53.02",real_power:"44.8",predicted_power:"45.3",RMSE:"0.025",MAE:"0.32",Rs:"0.021"},{id:"2",timeFrame:i(0,Date.now()-864e5*6),describe:"日报汇总",power_byte:"44.21",real_power:"39.2",predicted_power:"48.5",RMSE:"0.051",MAE:"0.02",Rs:"0.04"}],l=()=>{me(s,{timeFrame:"时间范围",describe:"描述",statrttime:"开机容量",devname:"实发功率",dtype:"预测功率",subdtype:"均方根误差",reoetits:"平均绝对误差",content:"相关性系数"},"短期预测日报","sheet1")},{drawerVisible:V,operateType:g,editingData:v,handleAdd:F,handleEdit:S,checkedRowKeys:_,onBatchDeleted:$,onDeleted:B}=de(w,T),N=()=>z(a(L,null,null)),x=o=>{o.detail.key};return ne(()=>{window.addEventListener("localStorageChanged",x)}),re(()=>{window.removeEventListener("localStorageChanged",x)}),(o,p)=>{const G=he,I=q;return d(),O("div",ve,[a(ge,{model:t(r),"onUpdate:model":p[0]||(p[0]=y=>K(r)?r.value=y:null),onReset:t(D),onSearch:t(T),onExportData:l},null,8,["model","onReset","onSearch"]),a(I,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:n(()=>[P("span",null,[E("超短期预测"+k(t(r).reportType=="day"?"日报":t(r).reportType=="month"?"月报":"年报"),1),le(P("span",xe,"(点击+号加载每日报表细化数据)",512),[[se,t(r).reportType=="day"]])])]),default:n(()=>[a(G,{bordered:!1,"render-expand-icon":N,"single-line":!1,"checked-row-keys":t(_),"onUpdate:checkedRowKeys":p[1]||(p[1]=y=>K(_)?_.value=y:null),columns:t(c),data:s,size:"small","flex-height":!t(h).isMobile,"scroll-x":702,loading:t(e),remote:"","row-key":y=>y.id,pagination:t(w).length?t(u):void 0,class:"sm:h-full"},null,8,["checked-row-keys","columns","flex-height","loading","row-key","pagination"])]),_:1})])}}});export{Be as default};

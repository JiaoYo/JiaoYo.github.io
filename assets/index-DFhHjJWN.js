import{o as p,e as R,f as A,d as J,p as se,a0 as X,s as le,q as ie,k as W,aw as u,aE as re,c as U,w as o,g as t,h as d,t as $,i as a,$ as ce,C as de,ag as V,ak as ue,B as E,P as Y,Q as me,a6 as Z,bU as _e,b7 as H,A as M,z as I,r as pe,x as fe,bV as he,bW as ge,aN as j,aT as ve}from"./index-7yfIBuqI.js";import{u as be,a as we}from"./table-t7-GHjoG.js";import{_ as ye}from"./round-search--SxcGQWM.js";import{c as ke}from"./common-CZLua4-n.js";import{_ as Te}from"./FormItemGridItem-ijIAr9Du.js";import{_ as xe}from"./DatePicker-CfzGw-VJ.js";import{_ as Ce}from"./Grid-Dc0y3lqU.js";import{_ as qe}from"./lodash-DQ4YFNYk.js";import{N as Q}from"./Popconfirm-CAqKbe_t.js";const Ne={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"},De=A("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h12.475q.425 0 .713.288t.287.712t-.288.713t-.712.287H5v14h14v-6.5q0-.425.288-.712T20 11.5t.713.288t.287.712V19q0 .825-.587 1.413T19 21zm6.525-6.8l8.5-8.5q.275-.275.675-.275t.7.275t.3.7t-.3.725L12.225 16.3q-.3.3-.7.3t-.7-.3l-4.25-4.25q-.275-.275-.275-.7t.275-.7t.7-.275t.7.275z"},null,-1),Se=[De];function ze(k,f){return p(),R("svg",Ne,[...Se])}const Pe={name:"material-symbols-select-check-box-rounded",render:ze},Be={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"},Ve=A("path",{fill:"currentColor",d:"m12.7 11.2l-1.45-1.425q-.275-.275-.687-.275t-.713.3q-.275.275-.275.7t.275.7L12 13.35q.3.3.7.3t.7-.3l4.25-4.25q.3-.3.288-.7t-.288-.7q-.3-.3-.712-.312t-.713.287zM8 18q-.825 0-1.412-.587T6 16V4q0-.825.588-1.412T8 2h12q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm0-2h12V4H8zm-4 6q-.825 0-1.412-.587T2 20V7q0-.425.288-.712T3 6t.713.288T4 7v13h13q.425 0 .713.288T18 21t-.288.713T17 22zM8 4v12z"},null,-1),Me=[Ve];function Ue(k,f){return p(),R("svg",Be,[...Me])}const $e={name:"material-symbols-library-add-check-outline-rounded",render:Ue},Ee=J({name:"foreCastSearch",__name:"foreCastSearch",props:{model:{required:!0},modelModifiers:{}},emits:se(["search"],["update:model"]),setup(k,{emit:f}){const h=f,F=X(),{formRef:T,restoreValidation:g}=le(),n=ie(k,"model"),x=W([Number(u(5,Date.now()-864e5*3)),Number(u(5,Date.now()))]);n.value.startTime=u(1,Date.now()-864e5*3),n.value.endTime=u(1,Date.now());async function i(r,s){n.value.startTime=u(1,s[0]),n.value.endTime=u(1,s[1])}async function C(){h("search")}const L=r=>{n.value.code=r,r==8?(n.value.fcode=r,V(()=>{n.value.code=void 0})):n.value.fcode=void 0,V(()=>{h("search")})},D=W(re(ke));D.value.splice(1,0,{label:"失败",value:8});const G=r=>{n.value.config=r,V(()=>{h("search")})};return(r,s)=>{const l=ue,v=Te,K=xe,c=ye,q=E,S=Y,z=Ce,P=me,b=Z;return p(),U(b,{bordered:!1,size:"small",class:"card-wrapper"},{default:o(()=>[t(P,{ref_key:"formRef",ref:T,model:n.value,"label-placement":"left","label-width":a(F).locale=="en-US"?120:100,"show-feedback":!1,onKeyup:de(C,["enter"])},{default:o(()=>[t(z,{responsive:"screen","item-responsive":"","x-gap":12,"y-gap":12},{default:o(()=>[t(v,{span:"24 s:12 m:8 l:6",label:"状态码",path:"code"},{default:o(()=>[t(l,{filterable:"",clearable:"",placeholder:"请选择状态码",value:n.value.code,"onUpdate:value":s[0]||(s[0]=m=>n.value.code=m),style:{width:"100%"},options:D.value,onUpdateValue:L},null,8,["value","options"])]),_:1}),t(v,{span:"24 s:12 m:6 l:4",label:"状态",path:"config"},{default:o(()=>[t(l,{filterable:"",clearable:"",placeholder:"请选择状态",value:n.value.config,"onUpdate:value":s[1]||(s[1]=m=>n.value.config=m),style:{width:"100%"},options:[{label:"已确认",value:1},{label:"未确认",value:0}],onUpdateValue:G},null,8,["value"])]),_:1}),t(v,{span:"24 s:12 m:16 l:10",label:"起止时间",path:"time"},{default:o(()=>[t(K,{value:x.value,"onUpdate:value":s[2]||(s[2]=m=>x.value=m),type:"datetimerange","value-format":"yyyy-MM-dd hh:mm:ss",style:{width:"100%"},"onUpdate:formattedValue":i},null,8,["value"])]),_:1}),t(v,{span:"24 s:12 m:8 l:4"},{default:o(()=>[t(S,{class:"w-full"},{default:o(()=>[t(q,{type:"primary",ghost:"",onClick:C},{icon:o(()=>[t(c,{class:"text-icon"})]),default:o(()=>[d(" "+$(a(ce)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","label-width"])]),_:1})}}}),Re={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},je=J({name:"logmanage_forecastlog",__name:"index",setup(k){const f=X(),{columns:h,columnChecks:F,data:T,getData:g,loading:n,pagination:x,searchParams:i,resetSearchParams:C}=be({apiFn:_e,apiParams:{page:1,pageSize:20,limit:20,startTime:u(1,Date.now()-864e5*3),endTime:u(1,Date.now()),code:void 0,config:void 0,order:"1",_t:new Date().getTime()},columns:()=>[{type:"selection",width:50,align:"center",resizable:!0,disabled:e=>e.config==1||e.code==0},{key:"errormsg",title:"详细说明",minWidth:140,align:"center",resizable:!0},{key:"dbtime",title:"时间",minWidth:140,align:"center",resizable:!0,sorter:!0},{key:"code",title:"状态码",width:120,align:"center",resizable:!0,render(e){return t(H,{type:e.code==0?"success":"error"},{default:()=>[e.code==0?"成功":"失败"]})}},{key:"config",title:"操作",minWidth:140,align:"center",render(e){return e.code===0?t("span",null,[d(" ")]):e.config!==0?t(H,{type:"success"},{default:()=>[d("已确认")]}):M(t(Q,{onPositiveClick:()=>S(e)},{default:()=>"确认要执行该操作吗？",trigger:()=>t(E,{type:"info",ghost:!0,size:"small",disabled:e.config!==0||e.code===0},{default:()=>[d("确认")]})}),[[I("no-auth"),"power.updatePowerStatus"]])}}]}),{drawerVisible:L,operateType:D,editingData:G,handleAdd:r,handleEdit:s,checkedRowKeys:l,onBatchDeleted:v,onDeleted:K}=we(T,g);let c=pe({total:0,uncfm:0});fe(()=>{q()});const q=async()=>{const{data:e,error:_}=await he();c.total=(e==null?void 0:e.total)||0,c.uncfm=(e==null?void 0:e.uncfm)||0},S=async e=>{b(e.id)},z=async()=>{const e=l.value.join(",");b(e),l.value=[]},P=async()=>{b()},b=async e=>{var w;const{data:_,error:B}=await ge(e?{ids:e}:void 0);if(!B){(w=window.$message)==null||w.success("确认成功"),g(),await q();const N=new CustomEvent("ErrorMsg",{detail:{uncfm:c.uncfm}});window.dispatchEvent(N)}},m=e=>{if(e.order=="ascend"){if(i.order==null)return;i.order=void 0}else i.order="1";g()},ee=qe.debounce(g,1e3,{leading:!0,trailing:!1});return(e,_)=>{const B=$e,w=E,N=Q,te=Pe,oe=Y,ne=ve,ae=Z,O=I("no-auth");return p(),R("div",Re,[t(Ee,{model:a(i),"onUpdate:model":_[0]||(_[0]=y=>j(i)?i.value=y:null),onReset:a(C),onSearch:a(ee)},null,8,["model","onReset","onSearch"]),t(ae,{title:"预测日志",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":o(()=>[t(oe,null,{default:o(()=>[A("span",null," 未确认/全部： "+$(a(c).uncfm)+"/"+$(a(c).total),1),M((p(),U(N,{onPositiveClick:z},{trigger:o(()=>[t(w,{size:"small",ghost:"",type:"info",disabled:a(l).length==0},{icon:o(()=>[t(B,{class:"text-icon"})]),default:o(()=>[d(" 批量确认 ")]),_:1},8,["disabled"])]),default:o(()=>[d(" 确认要确认选中的数据吗？ ")]),_:1})),[[O,"power.updatePowerStatus"]]),M((p(),U(N,{onPositiveClick:P},{trigger:o(()=>[t(w,{size:"small",ghost:"",type:"info",disabled:a(c).uncfm==0},{icon:o(()=>[t(te,{class:"text-icon"})]),default:o(()=>[d(" 全部确认 ")]),_:1},8,["disabled"])]),default:o(()=>[d(" 确认要确认全部的数据吗？ ")]),_:1})),[[O,"power.updatePowerStatus"]])]),_:1})]),default:o(()=>[t(ne,{"checked-row-keys":a(l),"onUpdate:checkedRowKeys":_[1]||(_[1]=y=>j(l)?l.value=y:null),columns:a(h),data:a(T),size:"small","flex-height":!a(f).isMobile,"scroll-x":"",loading:a(n),remote:"","row-key":y=>y.id,pagination:a(x),class:"sm:h-full","onUpdate:sorter":m},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1})])}}});export{je as default};

import{_ as ne}from"./table-column-setting.vue_vue_type_script_setup_true_lang-EHNO_Faz.js";import{_ as le}from"./round-delete-De_Adgrb.js";import{_ as se}from"./round-add-Ceubgvwo.js";import{d as G,aE as V,r as ie,n as Y,a as re,aG as H,aC as ce,bY as ue,cm as de,cn as me,c as M,o as $,w as t,f as e,a0 as pe,C as L,h as o,v as Z,b8 as _e,y as I,B as k,g as N,t as D,$ as y,a1 as fe,A as ge,aD as he,Z as J,aS as ve,q as R,b as we,aT as W,aH as be,x as F,aU as ye,e as xe,co as q,cp as ke,aY as Ne}from"./index-ByRkKuMU.js";import{u as Ce,a as De}from"./table-VoODD8Rc.js";import{_ as Q}from"./Grid-CFg9gfMA.js";import{_ as X}from"./FormItemGridItem-BCpPvk0p.js";import{_ as Se}from"./round-search-SxIJJabH.js";import{_ as ze}from"./round-refresh-_Q7iiaNa.js";import{h as A}from"./permission-fVfH3_nA.js";import{N as E}from"./Popconfirm-BARyXAms.js";const je=G({name:"OperateDrawer",__name:"operate-drawer",props:V({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:V(["submitted"],["update:visible"]),setup(d,{emit:S}){const h=S,r=d,l=ie(s());function s(){return{tname:"",weight:void 0}}async function C(){Object.assign(l,s()),r.operateType==="edit"&&r.rowData&&Object.assign(l,r.rowData)}const{formRef:z,validate:x,restoreValidation:m}=Y(),B={tname:{type:"string",required:!0,trigger:["blur","change"],message:"请输入"},weight:{type:"number",required:!0,trigger:["blur","change"],message:"请输入"}},v=re(()=>({add:"新增权重",edit:"修改权重"})[r.operateType]),p=H(d,"visible");ce(p,()=>{p.value&&(C(),m())});function _(){p.value=!1}const c=ue.debounce(async()=>{var w,i;if(await x(),r.operateType==="edit"){const{data:b,error:f}=await de([l]);f||(_(),h("submitted"),(w=window.$message)==null||w.success("修改成功"))}else{const{data:b,error:f}=await me([{...l}]);f||(_(),h("submitted"),(i=window.$message)==null||i.success("添加成功"))}},1e3,{leading:!0,trailing:!1});return(w,i)=>{const b=X,f=Q,j=L,T=pe,U=I,n=fe;return $(),M(n,{show:p.value,"onUpdate:show":i[2]||(i[2]=a=>p.value=a),title:v.value,preset:"card",class:"w-500px"},{footer:t(()=>[e(U,{justify:"end",size:16},{default:t(()=>[e(o(k),{onClick:_},{default:t(()=>[N(D(o(y)("common.cancel")),1)]),_:1}),e(o(k),{type:"primary",onClick:o(c)},{default:t(()=>[N(D(o(y)("common.confirm")),1)]),_:1},8,["onClick"])]),_:1})]),default:t(()=>[e(T,{class:"pr-20px"},{default:t(()=>[e(j,{ref_key:"formRef",ref:z,model:l,rules:B,"label-placement":"left","label-width":120},{default:t(()=>[e(f,{responsive:"screen","item-responsive":""},{default:t(()=>[e(b,{span:"24 m:24",label:"类型名称",path:"tname"},{default:t(()=>[e(o(Z),{value:l.tname,"onUpdate:value":i[0]||(i[0]=a=>l.tname=a),placeholder:"请输入"},null,8,["value"])]),_:1}),e(b,{span:"24 m:24",label:"权重",path:"weight"},{default:t(()=>[e(o(_e),{value:l.weight,"onUpdate:value":i[1]||(i[1]=a=>l.weight=a),placeholder:"请输入",min:1,max:100,style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show","title"])}}}),Te=G({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:V(["reset","search"],["update:model"]),setup(d,{emit:S}){const h=S,{formRef:r,restoreValidation:l}=Y(),s=H(d,"model"),C=[{label:"1",value:1},{label:"2",value:2},{label:"3",value:3},{label:"4",value:4},{label:"5",value:5},{label:"6",value:6},{label:"7",value:7},{label:"8",value:8},{label:"9",value:9},{label:"10",value:10}];function z(){s.value.fuzzy="",h("search")}async function x(){await l(),h("reset")}async function m(){h("search")}return(B,v)=>{const p=Z,_=X,c=he,w=ze,i=k,b=Se,f=I,j=Q,T=L,U=J;return $(),M(U,{bordered:!1,size:"small",class:"card-wrapper"},{default:t(()=>[e(T,{ref_key:"formRef",ref:r,model:s.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:ge(m,["enter"])},{default:t(()=>[e(j,{responsive:"screen","item-responsive":"","x-gap":16,"y-gap":16},{default:t(()=>[e(_,{span:"24 s:12 m:6",label:"类型名称",path:"fuzzy"},{default:t(()=>[e(p,{clearable:"",value:s.value.fuzzy,"onUpdate:value":v[0]||(v[0]=n=>s.value.fuzzy=n),placeholder:"请输入类型名称",onClear:z},null,8,["value"])]),_:1}),e(_,{span:"24 s:12 m:4",label:"权重",path:"weight"},{default:t(()=>[e(c,{clearable:"",filterable:"",value:s.value.weight,"onUpdate:value":[v[1]||(v[1]=n=>s.value.weight=n),m],placeholder:"请选择",options:C},null,8,["value"])]),_:1}),e(_,{span:"24  s:12 m:6",class:"pr-24px"},{default:t(()=>[e(f,{class:"w-full"},{default:t(()=>[e(i,{onClick:x},{icon:t(()=>[e(w,{class:"text-icon"})]),default:t(()=>[N(" "+D(o(y)("common.reset")),1)]),_:1}),e(i,{type:"primary",ghost:"",onClick:m},{icon:t(()=>[e(b,{class:"text-icon"})]),default:t(()=>[N(" "+D(o(y)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),Ue={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function K(d){return typeof d=="function"||Object.prototype.toString.call(d)==="[object Object]"&&!Ne(d)}const qe=G({name:"manage_weight",__name:"index",setup(d){const S=ve(),{columns:h,columnChecks:r,data:l,getData:s,loading:C,mobilePagination:z,searchParams:x}=Ce({showTotal:!0,apiFn:ke,apiParams:{page:1,pageSize:20,limit:20,weight:void 0,fuzzy:"",_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48},{key:"tname",title:"类型名称",align:"center",width:120},{key:"weight",title:"权重",align:"center",width:120},{key:"username",title:"创建人",align:"center",width:120},{key:"dbtime",title:"创建时间",align:"center",width:120},{key:"operate",title:y("common.operate"),align:"center",width:A("project:Weight:update")&&A("project:Weight:delete")?180:0,fixed:"right",render:n=>{let a;return e("div",{class:"flex-center gap-8px"},[F(e(k,{type:"primary",ghost:!0,size:"small",onClick:()=>j(n.id)},K(a=y("common.edit"))?a:{default:()=>[a]}),[[R("no-auth"),"project:Weight:update"]]),e(E,{onPositiveClick:()=>f(n.id)},{default:()=>y("common.confirmDelete"),trigger:()=>{let u;return F(e(k,{type:"error",ghost:!0,size:"small"},K(u=y("common.delete"))?u:{default:()=>[u]}),[[R("no-auth"),"project:Weight:delete"]])}})])}}]}),{drawerVisible:m,operateType:B,editingData:v,handleAdd:p,handleEdit:_,checkedRowKeys:c,onBatchDeleted:w,onDeleted:i}=De(l,s);async function b(){console.log(c.value),T(c.value.join(","),n=>{w()})}async function f(n){const{data:a,error:u}=await q(n);u||i()}function j(n){_(n)}async function T(n,a){const{data:u,error:P}=await q(n);if(!P)a&&a(u);else return!1}const U=()=>{s()};return(n,a)=>{const u=I,P=se,ee=le,te=ne,ae=be,oe=J,O=R("no-auth");return $(),we("div",Ue,[e(Te,{model:o(x),"onUpdate:model":a[0]||(a[0]=g=>W(x)?x.value=g:null),onReset:U,onSearch:o(s)},null,8,["model","onSearch"]),e(oe,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:t(()=>[e(u,{align:"center",wrap:"",class:"lt-sm:w-200px"},{default:t(()=>a[4]||(a[4]=[xe("div",null,"权重列表",-1)])),_:1,__:[4]})]),"header-extra":t(()=>[e(u,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:t(()=>[F(($(),M(o(k),{onClick:o(p),size:"small",ghost:"",type:"primary"},{icon:t(()=>[e(P,{class:"text-icon"})]),default:t(()=>[a[5]||(a[5]=N(" "+D("新增")))]),_:1,__:[5]},8,["onClick"])),[[O,"project:Weight:insert"]]),e(o(E),{onPositiveClick:b},{trigger:t(()=>[F(($(),M(o(k),{size:"small",ghost:"",type:"error",disabled:o(c).length==0},{icon:t(()=>[e(ee,{class:ye(["text-icon",{"animate-spin":o(C)}])},null,8,["class"])]),default:t(()=>[a[6]||(a[6]=N(" "+D("批量删除")))]),_:1,__:[6]},8,["disabled"])),[[O,"project:Weight:delete"]])]),default:t(()=>[a[7]||(a[7]=N(" 确定要删除选中的权重吗？ "))]),_:1,__:[7]}),e(te,{columns:o(r),"onUpdate:columns":a[1]||(a[1]=g=>W(r)?r.value=g:null)},null,8,["columns"])]),_:1})]),default:t(()=>[e(ae,{"checked-row-keys":o(c),"onUpdate:checkedRowKeys":a[2]||(a[2]=g=>W(c)?c.value=g:null),columns:o(h),data:o(l),size:"small","flex-height":!o(S).isMobile,loading:o(C),remote:"","row-key":g=>g.id,pagination:o(z),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(je,{visible:o(m),"onUpdate:visible":a[3]||(a[3]=g=>W(m)?m.value=g:null),onSubmitted:o(s),"operate-type":o(B),"row-data":o(v)},null,8,["visible","onSubmitted","operate-type","row-data"])]),_:1})])}}});export{qe as default};

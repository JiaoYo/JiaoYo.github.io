import{_ as I}from"./table-column-setting.vue_vue_type_script_setup_true_lang-BSGgSlEs.js";import{_ as q}from"./export-OwU1rog4.js";import{_ as W}from"./round-search-BwENOchH.js";import{d as j,j as v,v as G,ea as R,a$ as m,g as n,o as V,e as H,w as s,i as l,B as w,ae as Q,h as S,t as k,$ as D,ap as x,eb as A,P as J,O as K,as as L,a5 as X,S as Y}from"./index-DskrvN6Q.js";import{u as Z,a as tt}from"./table-BmoG-Cxs.js";import{e as et}from"./exportExcel-Bv4G4H50.js";import{_ as nt}from"./DatePicker-CmVc5iJY.js";import{_ as at}from"./FormItemGridItem-Cdb3lzPV.js";import{_ as ot}from"./Grid-DT9kj7lv.js";const lt={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},st=j({name:"realtimequery_sitehistoryquery",__name:"index",setup(it){const a=v(),C=async()=>{const{data:t,error:e}=await A();e||(a.value=t)};G(()=>{C(),d.value.forEach(t=>{typeof t.title=="function"&&(t.title=t.title().children[0])})});const{columns:h,columnChecks:d,data:p,getData:_,loading:g,mobilePagination:b,searchParams:f,resetSearchParams:rt}=Z({apiFn:R,apiParams:{page:1,limit:20,pageSize:20,startTime:m(1,Date.now()-864e5*3)||null,endTime:m(1,Date.now())||null,_t:new Date().getTime()},immediate:!0,showTotal:!0,columns:()=>[{type:"selection",width:50},{key:"dbtime",title:"更新时间",align:"center",width:160},{key:"stationP",title:()=>{var t;return n("span",null,[`总有功功率${(t=a.value)!=null&&t.StationP?"("+a.value.StationP+")":"(MW)"}`])},align:"center",width:120},{key:"stationQ",title:()=>{var t;return n("span",null,[`总无功功率${(t=a.value)!=null&&t.StationQ?"("+a.value.StationQ+")":"(MW)"}`])},align:"center",width:120},{key:"stationS",title:()=>{var t;return n("span",null,[`总视在功率${(t=a.value)!=null&&t.StationS?"("+a.value.StationS+")":"(MW)"}`])},align:"center",width:120},{key:"stationCOS",title:()=>{var t,e;return n("span",null,[`总功率因数${((t=a.value)==null?void 0:t.StationCOS)=="-"?"":(e=a.value)!=null&&e.StationCOS?"("+a.value.StationCOS+")":""}`])},align:"center",width:120},{key:"stationU",title:()=>{var t,e;return n("span",null,[`总电压${(t=a.value)!=null&&t.StationI?"("+((e=a.value)==null?void 0:e.StationU)+")":"(MV)"}`])},align:"center",width:120},{key:"stationI",title:()=>{var t,e;return n("span",null,[`总电流${(t=a.value)!=null&&t.StationI?"("+((e=a.value)==null?void 0:e.StationI)+")":"(A)"}`])},align:"center",width:120},{key:"stationFreq",title:()=>{var t;return n("span",null,[`频率${(t=a.value)!=null&&t.StationFreq?"("+a.value.StationFreq+")":"(Hz)"}`])},align:"center",width:100},{key:"stationDayE",title:()=>{var t;return n("span",null,[`日发电量${(t=a.value)!=null&&t.StationDayE?"("+a.value.StationDayE+")":"(MWh)"}`])},align:"center",width:120},{key:"stationTotalE",title:()=>{var t;return n("span",null,[`总发电量${(t=a.value)!=null&&t.StationTotalE?"("+a.value.StationTotalE+")":"(MWh)"}`])},align:"center",width:140},{key:"stationControlled",title:"是否限电",align:"center",width:140,render:t=>n("span",null,[t.stationControlled?t.stationControlled==1?"是":"否":""])}]}),{drawerVisible:ct,operateType:ut,editingData:dt,handleAdd:pt,handleEdit:mt,checkedRowKeys:u,onBatchDeleted:_t,onDeleted:ft}=tt(p,_),T=()=>{_()},y=v([Date.now()-864e5*3,Date.now()]);async function $(t,e){f.startTime=m(1,e[0]),f.endTime=m(1,e[1]),_()}const E=()=>{const t={};h.value.forEach(o=>{o.key!="index"&&o.key!="operation"&&o.type!=="selection"&&(t[o.key]=typeof o.title=="string"?o.title:o.title().children[0])});const e=[];p.value.forEach(o=>{if(u.value.includes(o.id)){const r=JSON.parse(JSON.stringify(t));for(const i in r)o.hasOwnProperty(i)?i=="stationControlled"?r[i]=o[i]==1?"是":"否":r[i]=o[i]:r[i]="";e.push(r)}}),et(e,t,"站点历史数据")},N={近一天:[Date.now()-864e5*1,Date.now()],近三天:[Date.now()-864e5*3,Date.now()],近七天:[Date.now()-864e5*7,Date.now()]};return(t,e)=>{const o=nt,r=W,i=at,O=ot,P=J,M=q,U=I,B=K,z=L,F=X;return V(),H("div",lt,[n(F,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:s(()=>[n(P,{ref:"formRef",model:l(f),"label-placement":"left","show-feedback":!1},{default:s(()=>[n(O,{"y-gap":16,responsive:"screen","item-responsive":""},{default:s(()=>[n(i,{span:"24 s:12 m:12",label:"起止时间",path:"startTime"},{default:s(()=>[n(o,{value:y.value,"onUpdate:value":e[0]||(e[0]=c=>y.value=c),type:"datetimerange","value-format":"yyyy-MM-dd hh:mm:ss","onUpdate:formattedValue":$,shortcuts:N,"default-time":["00:00:00","23:59:59"]},null,8,["value"]),n(l(w),{type:"primary",ghost:"",onClick:T,class:"ml-20px"},{icon:s(()=>[n(r,{class:Q(["text-icon",{"animate-spin":l(g)}])},null,8,["class"])]),default:s(()=>[S(" "+k(l(D)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),"header-extra":s(()=>[n(B,{justify:"end",class:"lt-sm:w-200px"},{default:s(()=>[n(l(w),{onClick:E,size:"small",disabled:l(u).length==0},{icon:s(()=>[n(M,{class:"text-icon"})]),default:s(()=>[S(" "+k(l(D)("common.export")),1)]),_:1},8,["disabled"]),n(U,{columns:l(d),"onUpdate:columns":e[1]||(e[1]=c=>x(d)?d.value=c:null)},null,8,["columns"])]),_:1})]),default:s(()=>[n(z,{"checked-row-keys":l(u),"onUpdate:checkedRowKeys":e[2]||(e[2]=c=>x(u)?u.value=c:null),columns:l(h),data:l(p),size:"small",loading:l(g),remote:"","row-key":c=>c.id,pagination:l(p).length?l(b):void 0,class:"sm:h-full","flex-height":!0,"scroll-x":""},null,8,["checked-row-keys","columns","data","loading","row-key","pagination"])]),_:1})])}}}),Ct=Y(st,[["__scopeId","data-v-609dce85"]]);export{Ct as default};

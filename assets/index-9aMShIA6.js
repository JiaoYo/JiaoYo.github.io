import{_ as H}from"./table-header-operation.vue_vue_type_script_setup_true_lang-BifTwrmi.js";import{d as G,q as L,j as U,s as Q,x as J,F as X,o as I,c as Y,w as e,g as l,G as P,h as a,t as u,i,$,H as Z,L as ee,a1 as le,B as K,P as ne,Q as te,af as O,a5 as ae,r as oe,ax as j,e as se,aj as B,f as ie,ak as re,al as ue,S as ce,at as de}from"./index-CMYYrBkk.js";import{u as me,a as pe}from"./table-BuckZeDa.js";import{f as fe,a as _e}from"./vulnerability-Be4JBwyy.js";import{_ as ve}from"./round-search-ClFi9Zus.js";import{_ as he}from"./round-refresh-Dpbi0W29.js";import{_ as be}from"./lodash-CI5YquUK.js";import{_ as ge}from"./FormItemGridItem-BOTHt4p0.js";import{_ as ye}from"./DatePicker-CrO8_QIT.js";import{_ as Ce}from"./Grid-CzH0335I.js";import{_ as Ne,a as we}from"./DescriptionsItem-CPIkCaML.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-S8f8P1LL.js";import"./setting-outlined-CSeh-oYh.js";import"./export-CDi1O_5Z.js";import"./refresh-Cy0vs_-o.js";import"./round-delete-wYUGKRY1.js";import"./round-plus-BDiwrNS9.js";import"./Upload-DRQmq4gc.js";import"./Progress-vsCufhmZ.js";import"./Popconfirm-DWdKhYPV.js";import"./TimePicker-BZvwrBhh.js";import"./defineProperty-BYxgcSOb.js";const xe=G({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:L(["reset","search"],["update:model"]),setup(f,{emit:V}){const v=[{label:"未定义",value:0},{label:"超危",value:1},{label:"高危",value:2},{label:"中级",value:3},{label:"低级",value:4}],n=V;U(!1);const{formRef:C,restoreValidation:z}=Q(),o=J(f,"model");U(null);function N(){o.value.cnnvdnum=void 0,n("search")}function h(){o.value.cnenum=void 0,n("search")}function w(){o.value.fuzzy=void 0,n("search")}async function S(g,c){g?(o.value.startTime=g[0],o.value.endTime=g[1]):(o.value.startTime=null,o.value.endTime=null),n("search")}async function b(){await z(),o.value.timeRange=null,n("reset")}async function x(){n("search")}const T=be.throttle(x,1e3,{trailing:!1});return(g,c)=>{const k=ee,p=ge,_=ye,E=le,F=he,R=K,M=ve,r=ne,t=Ce,d=te,y=O,D=X("no-space");return I(),Y(y,{bordered:!1,size:"small",class:"card-wrapper"},{default:e(()=>[l(d,{ref_key:"formRef",ref:C,model:o.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:Z(i(T),["enter"])},{default:e(()=>[l(t,{responsive:"screen","item-responsive":"","y-gap":20},{default:e(()=>[l(p,{span:"24 s:12 m:8 l:8",label:"CNNVD编号",path:"cnnvdnum"},{default:e(()=>[P(l(k,{clearable:"",value:o.value.cnnvdnum,"onUpdate:value":c[0]||(c[0]=s=>o.value.cnnvdnum=s),placeholder:"请输入CNNVD编号",onClear:N},null,8,["value"]),[[D]])]),_:1}),l(p,{span:"24 s:12 m:8 l:8",label:"漏洞名称",path:"fuzzy"},{default:e(()=>[l(k,{clearable:"",value:o.value.fuzzy,"onUpdate:value":c[1]||(c[1]=s=>o.value.fuzzy=s),placeholder:"请输入漏洞名称",onClear:w},null,8,["value"])]),_:1}),l(p,{span:"24 s:12 m:8 l:8",label:"CVE编号",path:"cnenum"},{default:e(()=>[P(l(k,{clearable:"",value:o.value.cnenum,"onUpdate:value":c[2]||(c[2]=s=>o.value.cnenum=s),placeholder:"请输入CVE编号",onClear:h},null,8,["value"]),[[D]])]),_:1}),l(p,{span:"24 s:12 m:8 l:8",label:"收录时间"},{default:e(()=>[l(_,{"start-placeholder":"收录开始时间","end-placeholder":"收录结束时间","formatted-value":o.value.timeRange,"onUpdate:formattedValue":[c[3]||(c[3]=s=>o.value.timeRange=s),S],"value-format":"yyyy-MM-dd",type:"daterange",clearable:"",style:{width:"100%"}},null,8,["formatted-value"])]),_:1}),l(p,{span:"24 s:12 m:8 l:8",label:"危害等级",path:"level"},{default:e(()=>[l(E,{filterable:"",clearable:"",value:o.value.level,"onUpdate:value":[c[4]||(c[4]=s=>o.value.level=s),x],placeholder:"请选择漏洞等级",options:v},null,8,["value"])]),_:1}),l(p,{span:"24 m:8 l:6",label:" "},{default:e(()=>[l(r,{align:"center"},{default:e(()=>[l(R,{onClick:b},{icon:e(()=>[l(F,{class:"text-icon"})]),default:e(()=>[a(" "+u(i($)("common.reset")),1)]),_:1}),l(R,{type:"primary",ghost:"",onClick:i(T)},{icon:e(()=>[l(M,{class:"text-icon"})]),default:e(()=>[a(" "+u(i($)("common.search")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","onKeyup"])]),_:1})}}}),ke={class:"min-h-500px flex-col-stretch gap-16px overflow-auto lt-sm:overflow-auto"},De=ie("hr",{style:{"border-color":"#ccc","margin-bottom":"20px"}},null,-1);function Ve(f){return typeof f=="function"||Object.prototype.toString.call(f)==="[object Object]"&&!re(f)}const Je=G({name:"knowledgebase_cnnvd",__name:"index",setup(f){const V=ae(),v=U(!1),n=oe({cname:"",cnnvdnum:"",cnenum:"",manu:"",level:0,ctype:"",cdbtime:"",udbtime:"",snapshot:"",refwedsite:"",patch:""}),C={0:"未定义",1:"超危",2:"高危",3:"中级",4:"低级"},{columns:z,columnChecks:o,data:N,getData:h,loading:w,mobilePagination:S,searchParams:b,resetSearchParams:x}=me({apiFn:fe,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,fuzzy:null,cnnvdnum:null,cnenum:null,level:null,startTime:null,endTime:null,_t:new Date().getTime()},columns:()=>[{key:"cnnvdnum",title:"CNNVD编号编号",align:"center",minWidth:180,fixed:"left",ellipsis:{tooltip:!0}},{key:"cname",title:"漏洞名称",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"level",title:"危害等级",align:"center",width:100,render:r=>{(r.level===null||r.level===void 0)&&(r.level=0);const t={0:"#8e9dff",4:"#5da8ff",3:"#fedc69",2:"#ff9874",1:"#ff0000"},d=C[r.level];let y={color:t[r.level],textColor:"#ffffff",borderColor:t[r.level]};return l(j,{size:"small",color:y},Ve(d)?d:{default:()=>[d]})}},{key:"cnenum",title:"CVE编号",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"manu",title:"厂商",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"cdbtime",title:"收录时间",align:"center",minWidth:180,ellipsis:{tooltip:!0},render:r=>l("span",null,[r.cdbtime.substring(0,10)])},{key:"operate",title:$("common.operate"),align:"center",width:80,fixed:"right",render:r=>l("div",{class:"flex-center gap-8px"},[l(K,{type:"primary",ghost:!0,size:"small",onClick:()=>M(r)},{default:()=>[a("详情")]})])}]}),{drawerVisible:T,operateType:g,editingData:c,handleAdd:k,handleEdit:p,checkedRowKeys:_,onBatchDeleted:E,onDeleted:F,closeDrawer:R}=pe(N,h);async function M(r){const{data:t,error:d}=await _e({id:r.id});d||(n.cnnvdnum=t.cnnvdnum,n.cname=t.cname,n.cnenum=t.cnenum,n.manu=t.manu,n.level=t.level,n.ctype=t.ctype,n.cdbtime=t.cdbtime,n.udbtime=t.udbtime,n.snapshot=t.snapshot,n.refwedsite=t.refwedsite,n.patch=t.patch,v.value=!0)}return(r,t)=>{const d=H,y=ue,D=O,s=Ne,W=we,q=ce,A=de;return I(),se("div",ke,[l(xe,{model:i(b),"onUpdate:model":t[0]||(t[0]=m=>B(b)?b.value=m:null),onReset:i(x),onSearch:i(h)},null,8,["model","onReset","onSearch"]),l(D,{title:"CNNVD漏洞信息",bordered:!1,size:"small",class:"sm:flex-1-hidden"},{"header-extra":e(()=>[l(d,{columns:i(o),"onUpdate:columns":t[1]||(t[1]=m=>B(o)?o.value=m:null),"disabled-delete":i(_).length===0,loading:i(w),onRefresh:i(h)},null,8,["columns","disabled-delete","loading","onRefresh"])]),default:e(()=>[l(y,{"checked-row-keys":i(_),"onUpdate:checkedRowKeys":t[2]||(t[2]=m=>B(_)?_.value=m:null),columns:i(z),data:i(N),size:"small","flex-height":!i(V).isMobile,"scroll-x":962,loading:i(w),remote:"","row-key":m=>m.id,pagination:i(S),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1}),l(A,{show:v.value,"onUpdate:show":t[3]||(t[3]=m=>v.value=m),title:"CNNVD漏洞信息详情",preset:"card",class:"w-800px"},{default:e(()=>[De,l(q,{class:"h-480px pr-20px"},{default:e(()=>[l(W,{"label-placement":"left",bordered:"",column:1,"label-style":{width:"120px"}},{default:e(()=>[l(s,null,{label:e(()=>[a(" CNNVD编号 ")]),default:e(()=>[a(" "+u(n.cnnvdnum),1)]),_:1}),l(s,null,{label:e(()=>[a(" 漏洞名称 ")]),default:e(()=>[a(" "+u(n.cname),1)]),_:1}),l(s,null,{label:e(()=>[a(" 危害等级 ")]),default:e(()=>[l(i(j),{color:{textColor:"#ffffff",borderColor:n.level===0?"#8e9dff":n.level===4?"#5da8ff":n.level===3?"#fedc69":n.level===2?"#ff9874":n.level===1?"#ff0000":"#5da8ff",color:n.level===0?"#8e9dff":n.level===4?"#5da8ff":n.level===3?"#fedc69":n.level===2?"#ff9874":n.level===1?"#ff0000":"#5da8ff"}},{default:e(()=>[a(u(C[n.level]),1)]),_:1},8,["color"])]),_:1}),l(s,null,{label:e(()=>[a(" CVE编号 ")]),default:e(()=>[a(" "+u(n.cnenum),1)]),_:1}),l(s,null,{label:e(()=>[a(" 厂商 ")]),default:e(()=>[a(" "+u(n.manu),1)]),_:1}),l(s,null,{label:e(()=>[a(" 漏洞类型 ")]),default:e(()=>[a(" "+u(n.ctype),1)]),_:1}),l(s,null,{label:e(()=>[a(" 收录时间 ")]),default:e(()=>[a(" "+u(n.cdbtime),1)]),_:1}),l(s,null,{label:e(()=>[a(" 更新时间 ")]),default:e(()=>[a(" "+u(n.udbtime),1)]),_:1}),l(s,null,{label:e(()=>[a(" 简介 ")]),default:e(()=>[a(" "+u(n.snapshot),1)]),_:1}),l(s,null,{label:e(()=>[a(" 参考网址 ")]),default:e(()=>[a(" "+u(n.refwedsite),1)]),_:1}),l(s,null,{label:e(()=>[a(" 补丁 ")]),default:e(()=>[a(" "+u(n.patch),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])])}}});export{Je as default};

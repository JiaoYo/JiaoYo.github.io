import{_ as X}from"./table-header-operation.vue_vue_type_script_setup_true_lang-BLZqLGKQ.js";import{d as j,q as P,v as K,s as E,L as F,o as A,c as G,w as a,g as e,M as I,h as M,t as U,i as t,$ as m,N as Y,A as L,B as O,E as H,D as W,aa as J,x as Z,b as ee,r as te,y as oe,C as ae,ab as ne,ac as se,a0 as le,e as ie,ad as $,as as re,an as ce,ae as me}from"./index-bmrF5t8f.js";import{u as de,a as pe}from"./table-D3vktSOg.js";import{_ as ue}from"./round-search-BkS6wno-.js";import{_ as _e}from"./round-refresh-DE6-F-wi.js";import{_ as fe}from"./FormItemGridItem-Dh6nDgK2.js";import{_ as he}from"./Grid-PcVCV9VT.js";import{q as ve,r as ye,g as ge,s as we}from"./events-CcstSBuP.js";import{h as q}from"./permission-CXHyUD8r.js";import{_ as be}from"./Popconfirm-DnCBdUAN.js";import{_ as De}from"./DataTable-BkNQhf46.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-C3yzJfMk.js";import"./setting-outlined-B1KkxL92.js";import"./round-delete-CCyWp6lL.js";import"./refresh-C6yTiYgx.js";import"./round-plus-BQ1eErvH.js";import"./Upload-BMjE5905.js";import"./Progress-BlN5LrMM.js";import"./Forward-DNQo90l-.js";const xe=j({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:P(["reset","search"],["update:model"]),setup(u,{emit:z}){const i=z,{formRef:h,restoreValidation:d}=K(),r=E(u,"model");function b(){r.value.fuzzy=void 0,i("search")}async function S(){await d(),i("reset")}async function v(){i("search")}return(B,s)=>{const D=L,x=fe,C=_e,y=O,p=ue,g=H,c=he,k=W,_=J,R=F("no-space");return A(),G(_,{bordered:!1,size:"small",class:"card-wrapper"},{default:a(()=>[e(k,{ref_key:"formRef",ref:h,model:r.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:Y(v,["enter"])},{default:a(()=>[e(c,{responsive:"screen","item-responsive":""},{default:a(()=>[e(x,{span:"24 s:12 m:6",label:"事件名称",path:"fuzzy",class:"pr-24px"},{default:a(()=>[I(e(D,{clearable:"",value:r.value.fuzzy,"onUpdate:value":s[0]||(s[0]=N=>r.value.fuzzy=N),placeholder:"请输入事件名称",onClear:b},null,8,["value"]),[[R]])]),_:1}),e(x,{span:"24 m:4",class:"pr-24px"},{default:a(()=>[e(g,{class:"w-full"},{default:a(()=>[e(y,{onClick:S},{icon:a(()=>[e(C,{class:"text-icon"})]),default:a(()=>[M(" "+U(t(m)("common.reset")),1)]),_:1}),e(y,{type:"primary",ghost:"",onClick:v},{icon:a(()=>[e(p,{class:"text-icon"})]),default:a(()=>[M(" "+U(t(m)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),ke=j({name:"OperateDrawer",__name:"operate-drawer",props:P({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:P(["submitted"],["update:visible"]),setup(u,{emit:z}){const i=u,h=z,d=E(u,"visible"),{formRef:r,validate:b,restoreValidation:S}=K(),{defaultRequiredRule:v}=Z(),B=ee(()=>({add:"新增事件",edit:"修改事件"})[i.operateType]),s=te(D());function D(){return{ename:"",sysparam:1,id:void 0}}const x={ename:v};function C(){Object.assign(s,D()),i.operateType==="edit"&&i.rowData&&Object.assign(s,i.rowData)}function y(){d.value=!1}async function p(){var g,c;if(await b(),i.operateType==="add"){const{data:k,error:_}=await ve([{ename:s.ename,sysparam:s.sysparam}]);_||((g=window.$message)==null||g.success(m("common.addSuccess")),y(),h("submitted"))}else{const{data:k,error:_}=await ye([{id:i.rowData.id,ename:s.ename,sysparam:s.sysparam}]);_||((c=window.$message)==null||c.success(m("common.updateSuccess")),y(),h("submitted"))}}return oe(d,()=>{d.value&&(C(),S())}),(g,c)=>{const k=L,_=ae,R=W,N=O,T=H,n=ne,o=se,l=F("no-space");return A(),G(o,{show:d.value,"onUpdate:show":c[1]||(c[1]=w=>d.value=w),"display-directive":"show",width:400},{default:a(()=>[e(n,{title:B.value,"native-scrollbar":!1,closable:""},{footer:a(()=>[e(T,{size:16},{default:a(()=>[e(N,{onClick:y},{default:a(()=>[M(U(t(m)("common.cancel")),1)]),_:1}),e(N,{type:"primary",onClick:p},{default:a(()=>[M(U(t(m)("common.confirm")),1)]),_:1})]),_:1})]),default:a(()=>[e(R,{ref_key:"formRef",ref:r,model:s,rules:x},{default:a(()=>[e(_,{label:"事件名称",path:"ename"},{default:a(()=>[I(e(k,{value:s.ename,"onUpdate:value":c[0]||(c[0]=w=>s.ename=w),placeholder:"请输入事件名称",clearable:""},null,8,["value"]),[[l]])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Ne={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function V(u){return typeof u=="function"||Object.prototype.toString.call(u)==="[object Object]"&&!me(u)}const Ge=j({name:"eventalarm_event",__name:"index",setup(u){const z=le(),{columns:i,columnChecks:h,data:d,getData:r,loading:b,mobilePagination:S,searchParams:v,resetSearchParams:B}=de({apiFn:ge,immediate:!0,apiParams:{page:1,limit:20,fuzzy:void 0},columns:()=>[{type:"selection",align:"center",width:48,fixed:"left"},{key:"ename",title:"事件名称",align:"center",minWidth:160,ellipsis:{tooltip:!0}},{key:"sysparam",title:"系统内置",align:"center",width:120,render:n=>{const o={0:"success",1:"info"},l=m(re[n.sysparam]);return e(ce,{size:"small",type:o[n.sysparam]},V(l)?l:{default:()=>[l]})}},{key:"operate",title:m("common.operate"),align:"center",width:160,fixed:"right",render:n=>{let o;return e("div",{class:"flex-center gap-8px"},[I(e(O,{type:"info",disabled:n.sysparam==0,ghost:!0,size:"small",onClick:()=>R(n.id)},V(o=m("common.edit"))?o:{default:()=>[o]}),[[F("no-auth"),"event.update"]]),e(be,{onPositiveClick:()=>N(n.id)},{default:()=>m("common.confirmDelete"),trigger:()=>{let l;return I(e(O,{type:"error",ghost:!0,size:"small",disabled:n.sysparam==0},V(l=m("common.delete"))?l:{default:()=>[l]}),[[F("no-auth"),"event.delete"]])}})])}}]}),{drawerVisible:s,operateType:D,editingData:x,handleAdd:C,handleEdit:y,checkedRowKeys:p,onBatchDeleted:g,onDeleted:c,closeDrawer:k}=pe(d,r);async function _(){console.log(p.value),T(p.value,n=>{g()})}function R(n){y(n)}function N(n){console.log(n),T([n],o=>{c()})}async function T(n,o){const{data:l,error:w}=await we(n);if(!w)o&&o(l);else return!1}return(n,o)=>{const l=X,w=De,Q=J;return A(),ie("div",Ne,[e(xe,{model:t(v),"onUpdate:model":o[0]||(o[0]=f=>$(v)?v.value=f:null),onReset:t(B),onSearch:t(r)},null,8,["model","onReset","onSearch"]),e(Q,{title:"事件",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":a(()=>[e(l,{columns:t(h),"onUpdate:columns":o[1]||(o[1]=f=>$(h)?h.value=f:null),"disabled-delete":t(p).length===0,loading:t(b),onAdd:t(C),onDelete:_,onRefresh:t(r),"is-view-add-button":t(q)("event.insert"),"is-view-delete-button":t(q)("event.delete")},null,8,["columns","disabled-delete","loading","onAdd","onRefresh","is-view-add-button","is-view-delete-button"])]),default:a(()=>[e(w,{"checked-row-keys":t(p),"onUpdate:checkedRowKeys":o[2]||(o[2]=f=>$(p)?p.value=f:null),columns:t(i),data:t(d),size:"small","flex-height":!t(z).isMobile,"scroll-x":962,loading:t(b),remote:"","row-key":f=>f.id,pagination:t(S),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(ke,{visible:t(s),"onUpdate:visible":o[3]||(o[3]=f=>$(s)?s.value=f:null),"operate-type":t(D),"row-data":t(x),onSubmitted:t(r)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1})])}}});export{Ge as default};

import{_ as H}from"./round-plus-tcwoI66X.js";import{_ as Q}from"./round-search-Bb27uErK.js";import{_ as Y}from"./round-refresh-Nk_s_Ewb.js";import{d as ee,Z as te,r as f,$ as c,g as e,L as m,K as D,B as _,j as $,J as ne,o as S,e as ae,w as n,i as r,h,t as w,c as oe,ad as se,X as le,A as ie,E as re,D as pe,a9 as ce,C as ue,aa as de,ab as me,ay as _e}from"./index-T9gyDO4y.js";import{c as fe,f as ge,a as ve,d as ye,e as he}from"./common-CzYApJIe.js";import{_ as we}from"./Popconfirm-CEXt8nva.js";import{_ as be}from"./FormItemGridItem-C_-M-bXe.js";import{_ as xe}from"./Grid-LF9MSaZw.js";import{_ as Ce}from"./DataTable-C_gfPMHZ.js";import"./Forward-CxaZO0Rb.js";const De={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function E(b){return typeof b=="function"||Object.prototype.toString.call(b)==="[object Object]"&&!se(b)}const ze=ee({name:"eventalarm_eventtype",__name:"index",setup(b){const I=te(),u=f({fuzzy:"",pid:null}),A=f([{key:"pid",title:"事件类别",align:"center",minWidth:160,ellipsis:{tooltip:!0},render:a=>{var o;return(o=p.eventsCategoryDataList.find(s=>s.id===a.pid))==null?void 0:o.pname}},{key:"pname",title:"事件类型",align:"center",minWidth:160,ellipsis:{tooltip:!0}},{key:"operate",title:c("common.operate"),align:"center",width:160,render:a=>{let t;return a.sysparam!=0?e("div",{class:"flex-center gap-8px"},[m(e(_,{type:"primary",ghost:!0,size:"small",onClick:()=>R(a)},E(t=c("common.edit"))?t:{default:()=>[t]}),[[D("no-auth"),"event.type.update"]]),e(we,{onPositiveClick:()=>O(a.id)},{default:()=>c("common.confirmDelete"),trigger:()=>{let o;return m(e(_,{type:"error",ghost:!0,size:"small"},E(o=c("common.delete"))?o:{default:()=>[o]}),[[D("no-auth"),"event.type.delete"]])}})]):null}}]),p=f({eventsCategoryDataList:[],eventsTypeDataList:[]}),g=$(!1),d=$(!1);async function B(){const{data:a,error:t}=await ge();t||(p.eventsCategoryDataList=a)}async function v(){try{g.value=!0;const{data:a,error:t}=await ve();t||(p.eventsTypeDataList=a)}finally{g.value=!1}}ne(()=>{B(),v()});const U=()=>{d.value=!0},l=f({pid:null,pname:null,id:null}),j=f({pid:{type:"number",required:!0,message:"请选择事件类别",trigger:["blur","change"]},pname:{type:"string",required:!0,message:"请输入事件类型",trigger:["blur","change"]}}),F=async()=>{var a,t;if(l.id){const{data:o,error:s}=await he([l]);s||((t=window.$message)==null||t.success("修改成功"),d.value=!1,v())}else{const{data:o,error:s}=await ye([{pname:l.pname,pid:l.pid}]);s||((a=window.$message)==null||a.success("添加成功"),d.value=!1,v())}},G=()=>{d.value=!1,l.pid=null,l.pname=null},O=async a=>{var s;const{data:t,error:o}=await fe({ids:a});o||((s=window.$message)==null||s.success("删除成功"),v())},R=a=>{d.value=!0,Object.assign(l,a)},V=()=>{u.fuzzy=null,u.pid=null,z()},z=()=>{g.value=!0;const{fuzzy:a,pid:t}=u;if(!a&&!t){v();return}const o=p.eventsTypeDataList.filter(s=>{const y=t?s.pid===t:!0,x=a?s.pname.toLowerCase().includes(a.toLowerCase()):!0;return y&&x});p.eventsTypeDataList=o,g.value=!1},q=f({page:1,pageCount:1,pageSize:20,total:0,prefix({startIndex:a,endIndex:t,page:o,pageSize:s,pageCount:y,itemCount:x}){return`${p.eventsTypeDataList.length}条`}});return(a,t)=>{const o=le,s=be,y=ie,x=Y,M=Q,L=re,W=xe,k=pe,T=ce,J=H,K=Ce,N=ue,P=de,X=me,C=D("no-space"),Z=D("no-auth");return S(),ae("div",De,[e(T,{title:"",bordered:!1,size:"small"},{header:n(()=>[e(k,{ref:"formRef",model:u,"label-placement":"left","label-width":100,"show-feedback":!1},{default:n(()=>[e(W,{responsive:"screen","item-responsive":""},{default:n(()=>[e(s,{span:"24 s:12 m:6",label:"类别",path:"pid",class:"pr-24px"},{default:n(()=>[m(e(o,{clearable:"",value:u.pid,"onUpdate:value":[t[0]||(t[0]=i=>u.pid=i),z],placeholder:"请选择事件类别",options:p.eventsCategoryDataList,"reset-menu-on-options-change":!1,"value-field":"id","label-field":"pname"},null,8,["value","options"]),[[C]])]),_:1}),e(s,{span:"24 s:12 m:6",label:"类型",path:"fuzzy",class:"pr-24px"},{default:n(()=>[m(e(y,{value:u.fuzzy,"onUpdate:value":t[1]||(t[1]=i=>u.fuzzy=i),placeholder:"请输入事件类型"},null,8,["value"]),[[C]])]),_:1}),e(s,{span:"24 m:12",class:"pr-24px"},{default:n(()=>[e(L,{class:"w-full"},{default:n(()=>[e(r(_),{onClick:V},{icon:n(()=>[e(x,{class:"text-icon"})]),default:n(()=>[h(" "+w(r(c)("common.reset")),1)]),_:1}),e(r(_),{type:"primary",ghost:"",onClick:z},{icon:n(()=>[e(M,{class:"text-icon"})]),default:n(()=>[h(" "+w(r(c)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(T,{title:"事件类型",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":n(()=>[m((S(),oe(r(_),{size:"small",ghost:"",type:"primary",onClick:U},{icon:n(()=>[e(J,{class:"text-icon"})]),default:n(()=>[h(" "+w(r(c)("common.add")),1)]),_:1})),[[Z,"event.type.insert"]])]),default:n(()=>[e(K,{columns:A,data:p.eventsTypeDataList,size:"small",pagination:q,"flex-height":!r(I).isMobile,"scroll-x":962,loading:g.value,remote:"","row-key":i=>i.id,class:"sm:h-full"},null,8,["columns","data","pagination","flex-height","loading","row-key"])]),_:1}),e(X,{show:d.value,"onUpdate:show":t[4]||(t[4]=i=>d.value=i),"display-directive":"show",width:300},{default:n(()=>[e(P,{title:l.id?"编辑":"添加","native-scrollbar":!1,closable:""},{footer:n(()=>[e(L,{size:16},{default:n(()=>[e(r(_),{onClick:G},{default:n(()=>[h(w(r(c)("common.cancel")),1)]),_:1}),e(r(_),{type:"primary",onClick:F},{default:n(()=>[h(w(r(c)("common.confirm")),1)]),_:1})]),_:1})]),default:n(()=>[e(k,{ref:"formRef",model:l,rules:j},{default:n(()=>[e(N,{label:"事件类别",path:"pid"},{default:n(()=>[m(e(o,{clearable:"",value:l.pid,"onUpdate:value":t[2]||(t[2]=i=>l.pid=i),placeholder:"请选择事件类别",options:p.eventsCategoryDataList,"reset-menu-on-options-change":!1,"value-field":"id","label-field":"pname"},null,8,["value","options"]),[[C]])]),_:1}),e(N,{label:"事件类型",path:"pname"},{default:n(()=>[m(e(y,{value:l.pname,"onUpdate:value":t[3]||(t[3]=i=>l.pname=i),placeholder:"请输入事件类型"},null,8,["value"]),[[C]])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])])}}}),Ue=_e(ze,[["__scopeId","data-v-def8049e"]]);export{Ue as default};

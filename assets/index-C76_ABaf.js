import{_ as F}from"./table-column-setting.vue_vue_type_script_setup_true_lang-Cd5KE_J6.js";import{_ as V}from"./export-3ZTZd4Wv.js";import{_ as q}from"./round-search-wX8as3A6.js";import{d as j,j as w,v as G,e2 as R,aT as d,g as n,o as A,e as H,w as s,i as l,B as v,a9 as J,h as k,t as S,$ as D,ak as x,by as Q,J as W,I as K,a0 as L,M as X}from"./index-odpIOa9D.js";import{u as Y,a as Z}from"./table-C1XmBycW.js";import{e as tt}from"./exportExcel-Bv4G4H50.js";import{_ as et}from"./DatePicker-pBfmJvE9.js";import{_ as nt}from"./FormItemGridItem-CgDGNqgG.js";import{_ as at}from"./Grid-DWwU4KsZ.js";import{_ as ot}from"./DataTable-Wz0nH3gM.js";import"./TimePicker-BW_j6-Te.js";import"./Forward-CKxk1mVh.js";import"./RadioGroup-DN5hCKz_.js";const lt={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},st=j({name:"realtimequery_sitehistoryquery",__name:"index",setup(it){const a=w(),b=async()=>{const{data:t,error:e}=await Q();e||(a.value=t)};G(()=>{b()});const{columns:f,columnChecks:m,data:p,getData:h,loading:g,mobilePagination:C,searchParams:_,resetSearchParams:rt}=Y({apiFn:R,apiParams:{page:1,limit:20,pageSize:20,startTime:d(1,Date.now()-864e5*3)||null,endTime:d(1,Date.now())||null,_t:new Date().getTime()},immediate:!0,showTotal:!0,columns:()=>[{type:"selection",width:50},{key:"dbtime",title:"更新时间",align:"center",width:160},{key:"stationP",title:()=>{var t;return n("span",null,[`总有功功率${(t=a.value)!=null&&t.StationP?"("+a.value.StationP+")":"(MW)"}`])},align:"center",width:120},{key:"stationQ",title:()=>{var t;return n("span",null,[`总无功功率${(t=a.value)!=null&&t.StationQ?"("+a.value.StationQ+")":"(MVar)"}`])},align:"center",width:120},{key:"stationS",title:()=>{var t;return n("span",null,[`总视在功率${(t=a.value)!=null&&t.StationS?"("+a.value.StationS+")":"(MVA)"}`])},align:"center",width:120},{key:"stationCOS",title:()=>{var t,e;return n("span",null,[`总功率因数${((t=a.value)==null?void 0:t.StationCOS)=="-"?"":"("+((e=a.value)==null?void 0:e.StationCOS)+")"}`])},align:"center",width:120},{key:"stationU",title:()=>{var t,e;return n("span",null,[`总电压${(t=a.value)!=null&&t.StationI?"("+((e=a.value)==null?void 0:e.StationU)+")":"(kV)"}`])},align:"center",width:120},{key:"stationI",title:()=>{var t,e;return n("span",null,[`总电流${(t=a.value)!=null&&t.StationI?"("+((e=a.value)==null?void 0:e.StationI)+")":"(A)"}`])},align:"center",width:120},{key:"stationFreq",title:()=>{var t;return n("span",null,[`频率${(t=a.value)!=null&&t.StationFreq?"("+a.value.StationFreq+")":"(Hz)"}`])},align:"center",width:100},{key:"stationDayE",title:()=>{var t;return n("span",null,[`日发电量${(t=a.value)!=null&&t.StationDayE?"("+a.value.StationDayE+")":"(kWh)"}`])},align:"center",width:120},{key:"stationTotalE",title:()=>{var t;return n("span",null,[`总发电量${(t=a.value)!=null&&t.StationTotalE?"("+a.value.StationTotalE+")":"(kWh)"}`])},align:"center",width:140},{key:"stationControlled",title:"是否限电",align:"center",width:140,render:t=>n("span",null,[t.stationControlled?t.stationControlled==1?"是":"否":""])}]}),{drawerVisible:ct,operateType:ut,editingData:pt,handleAdd:dt,handleEdit:mt,checkedRowKeys:u,onBatchDeleted:_t,onDeleted:ft}=Z(p,h),T=()=>{h()},y=w([Date.now()-864e5*3,Date.now()]);async function $(t,e){_.startTime=d(1,e[0]),_.endTime=d(1,e[1])}const E=()=>{const t={};f.value.forEach(o=>{o.key!="index"&&o.key!="operation"&&o.type!=="selection"&&(t[o.key]=typeof o.title=="string"?o.title:o.title().children[0])});const e=[];p.value.forEach(o=>{if(u.value.includes(o.id)){const r=JSON.parse(JSON.stringify(t));for(const i in r)o.hasOwnProperty(i)?i=="stationControlled"?r[i]=o[i]==1?"是":"否":r[i]=o[i]:r[i]="";e.push(r)}}),tt(e,t,"站点历史数据")},N={近一天:[Date.now()-864e5*1,Date.now()],近三天:[Date.now()-864e5*3,Date.now()],近七天:[Date.now()-864e5*7,Date.now()]};return(t,e)=>{const o=et,r=q,i=nt,P=at,O=W,U=V,B=F,I=K,M=ot,z=L;return A(),H("div",lt,[n(z,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:s(()=>[n(O,{ref:"formRef",model:l(_),"label-placement":"left","show-feedback":!1},{default:s(()=>[n(P,{"y-gap":16,responsive:"screen","item-responsive":""},{default:s(()=>[n(i,{span:"24 s:12 m:12",label:"起止时间",path:"startTime"},{default:s(()=>[n(o,{value:y.value,"onUpdate:value":e[0]||(e[0]=c=>y.value=c),type:"datetimerange","value-format":"yyyy-MM-dd hh:mm:ss","onUpdate:formattedValue":$,shortcuts:N},null,8,["value"]),n(l(v),{type:"primary",ghost:"",onClick:T,class:"ml-20px"},{icon:s(()=>[n(r,{class:J(["text-icon",{"animate-spin":l(g)}])},null,8,["class"])]),default:s(()=>[k(" "+S(l(D)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),"header-extra":s(()=>[n(I,{justify:"end",class:"lt-sm:w-200px"},{default:s(()=>[n(l(v),{onClick:E,size:"small",disabled:l(u).length==0},{icon:s(()=>[n(U,{class:"text-icon"})]),default:s(()=>[k(" "+S(l(D)("common.export")),1)]),_:1},8,["disabled"]),n(B,{columns:l(m),"onUpdate:columns":e[1]||(e[1]=c=>x(m)?m.value=c:null)},null,8,["columns"])]),_:1})]),default:s(()=>[n(M,{"checked-row-keys":l(u),"onUpdate:checkedRowKeys":e[2]||(e[2]=c=>x(u)?u.value=c:null),columns:l(f),data:l(p),size:"small",loading:l(g),remote:"","row-key":c=>c.id,pagination:l(p).length?l(C):void 0,class:"sm:h-full","flex-height":!0,"scroll-x":""},null,8,["checked-row-keys","columns","data","loading","row-key","pagination"])]),_:1})])}}}),Et=X(st,[["__scopeId","data-v-db35bb0a"]]);export{Et as default};

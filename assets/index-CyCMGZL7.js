import{_ as Ve}from"./table-column-setting.vue_vue_type_script_setup_true_lang-C1xlHjp4.js";import{_ as Je}from"./round-delete-DlIoPaUp.js";import{_ as Le}from"./round-add-DKf3GUZ5.js";import{aZ as pe,d as ge,ay as ye,aw as we,z as be,ax as Ne,s as G,cC as fe,cD as he,aL as Ee,c as P,o as v,w as o,f as s,M as Me,h as a,H as ee,aM as xe,a3 as De,b as C,aA as Oe,b1 as Ae,e as r,t as _,B as b,g as y,G as W,aC as He,aF as Ge,J as ke,a4 as ze,b9 as Te,aG as _e,aU as ue,aK as Ke,a6 as We,W as Ue,A as Xe,i as Ye,L as Ze,$ as le,a2 as je,aN as Qe,F as ie,aO as ve,aD as et,I as te,aP as tt,aV as lt}from"./index-CMHgEXMh.js";import{u as st,a as at}from"./table-CJiCbcco.js";import{u as Ie}from"./usePageData-Dn3H-SiY.js";import{_ as Re}from"./Grid-C5178DSn.js";import{_ as Pe}from"./FormItemGridItem-Dqi8bF12.js";import{_ as qe}from"./DatePicker-BXJxaIxz.js";import{_ as ot}from"./round-search-C1L9tT6c.js";import{_ as nt}from"./round-refresh-CcRANCic.js";import{N as rt}from"./Table-xSzXXY9c.js";import{N as $e}from"./Popconfirm-B5UVwpKW.js";function it(g){return pe({url:"/projectMeeting/getPage.do",method:"get",params:g})}function Fe(g){return pe({url:"/projectMeeting/getById.do",method:"get",params:{id:g}})}function ut(g){return pe({url:"/projectMeeting/insert.do",method:"post",data:g})}function pt(g){return pe({url:"/projectMeeting/update.do",method:"put",data:g})}function Se(g){return pe({url:"/projectMeeting/delete.do",method:"delete",params:{arrIds:g}})}const dt={class:"flex pr-20px"},ct={class:"flex-1"},mt={class:"flex mb-10px"},ft={class:"flex mb-10px"},vt={class:"flex mb-10px"},_t={class:"flex mb-10px"},yt={class:"flex-col ml-20px justify-center"},gt={key:0,class:""},bt={key:1,class:"flex items-center w-300px"},ht={key:0,class:""},xt={key:1,class:"flex items-center w-300px"},wt={key:0,class:""},kt={key:1,class:"flex items-center w-300px"},$t=ge({__name:"meetingModal",props:ye({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:ye(["submitted"],["update:visible"]),setup(g,{emit:J}){var de;const $=we(g,"visible"),O=(de=be().userInfo)==null?void 0:de.usertype,q=g,f=J,h=[{label:"技术部每日例会",value:0},{label:"技术部周例会",value:1}],L=[{label:"研发周例会(网络安全) ",value:2},{label:"研发周例会(数据通讯)",value:3}],c=[{label:"生产部周例会",value:4}],F=[{label:"销售周例会",value:5}],N=[...h,...L,...c,...F,{label:"管理层周例会",value:6}];Ne(()=>$.value,async e=>{e&&w()});const B=G(null),t=G({id:void 0,con1:"",mdbtime:void 0,mtype:void 0,musers:[],mtopic:"",contentArr:[{id:fe(),person:"",proname:"",desc:"",problem:"",status1:"",status2:"",status3:""}],fl1:"",fl2:"",fl3:""}),n={con2:{type:"string",required:!0,message:"请输入",trigger:"blur"},mtopic:{type:"string",required:!0,message:"请输入",trigger:"blur"},mdbtime:{type:"string",required:!0,message:"请输入",trigger:"blur"},mtype:{type:"number",required:!0,message:"请输入",trigger:"blur"},musers:{type:"array",required:!0,message:"请输入",trigger:"blur"}},I=()=>{const e=new Date;e.setHours(17),e.setMinutes(30),e.setSeconds(0);const l=u=>u<10?"0"+u:u;return`${e.getFullYear()}-${l(e.getMonth()+1)}-${l(e.getDate())} ${l(e.getHours())}:${l(e.getMinutes())}:${l(e.getSeconds())}`},{pageData:M,getData:A,nextPage:R}=Ie(Te),S=async e=>{const l=e.currentTarget,u=l.scrollTop;l.scrollTop+l.offsetHeight>=l.scrollHeight&&M.data.length<M.total&&(await R(),await _e(),setTimeout(()=>{l.scrollTop=u}))},m=async e=>{await A({usertypes:e,page:1})},E=async()=>{var l;const{data:e}=await Fe(q.rowData.id);e&&(t.value=e,t.value.mtype==0&&(t.value.contentArr=JSON.parse(e.con2)),t.value.mdbtime=ue(1,e.mdbtime),t.value.musers=(l=e.musers.replaceAll("、",","))==null?void 0:l.split(","))};async function z(e){await _e();const l=document.getElementById(e);if(l){l.scrollIntoView({behavior:"smooth",block:"center"});const u=l.querySelector("input, textarea");u==null||u.focus()}}const w=async()=>{if(m("0,2,3"),q.operateType=="add"){t.value={id:void 0,con1:"",mdbtime:I(),mtype:void 0,musers:[],mtopic:"",contentArr:[{id:fe(),person:"",proname:"",desc:"",problem:"",status1:"",status2:"",status3:""}],fl1:"",fl2:""};let e=he.get("setMeeting");t.value={...e,musers:e.musers.split("、"),contentArr:JSON.parse(e.contentArr)}}else E()},H=Ee.debounce(async()=>{var l,u,T,k,Z,Q,ce;await((l=B.value)==null?void 0:l.validate());let e=JSON.parse(JSON.stringify(t.value));if(t.value.mtype==0){for(let U=0;U<t.value.contentArr.length;U++){const D=t.value.contentArr[U];if(D.status1=D.person?"":"error",D.status2=D.proname?"":"error",D.status3=D.desc?"":"error",!D.person)return z("person-"+U),(u=window.$message)==null?void 0:u.error("请填写完整的调试人员");if(!D.proname)return z("proname-"+U),(T=window.$message)==null?void 0:T.error("请填写完整的项目名称");if(!D.desc)return z("desc-"+U),(k=window.$message)==null?void 0:k.error("请填写完整的工作描述")}e.con2=JSON.stringify(e.contentArr),delete e.contentArr}if(e.con1="",e.con3="",e.musers=(Z=e.musers)==null?void 0:Z.join("、"),q.operateType=="edit"){const{data:U,error:D}=await pt([e]);U&&((Q=window.$message)==null||Q.success("编辑成功"),V(),f("submitted"))}else{e.id=void 0;const{data:U,error:D}=await ut([e]);U&&((ce=window.$message)==null||ce.success("新增成功"),V(),he.set("setMeeting",null),f("submitted"))}},1e3,{leading:!0,trailing:!1}),V=()=>{$.value=!1,t.value={id:void 0,con1:"",mdbtime:void 0,mtype:void 0,musers:[],mtopic:"",contentArr:[{id:fe(),person:"",proname:"",desc:"",problem:"",status1:"",status2:"",status3:""}],fl1:"",fl2:"",fl3:""}},K=G(),se=e=>{var l;if(e.status1=e.person?"":"error",e.status2=e.proname?"":"error",e.status3=e.desc?"":"error",e.status1=="error"||e.status2=="error"||e.status3=="error")return(l=window.$message)==null?void 0:l.warning("请填写完整的信息，在进行添加");t.value.contentArr.push({id:fe(),person:"",proname:"",desc:"",problem:t.value.contentArr[t.value.contentArr.length-1].problem,status1:"",status2:"",status3:""}),_e(()=>{var u;(u=K.value)==null||u.scrollTo({top:Number.MAX_SAFE_INTEGER,behavior:"smooth"})})},Y=e=>{e.status1=e.person?"":"error"},ae=e=>{e.status2=e.proname?"":"error"},oe=e=>{e.status3=e.desc?"":"error"},ne=e=>{var l;if(e==0)(((l=t.value.contentArr)==null?void 0:l.length)==0||!Object.keys(t.value).includes("contentArr"))&&(t.value.contentArr=[{person:"",proname:"",desc:"",problem:"",status1:"",status2:"",status3:""}]);else{let u=function(T){if(!T)return!1;try{return JSON.parse(T),!0}catch{return!1}};t.value.con2=u(t.value.con2)?"":t.value.con2}(e==0||e==1)&&(m("0,2,3"),t.value.mdbtime=e==0?ue(0,new Date)+" 17:30:00":ue(0,new Date)+" 08:30:00"),(e==2||e==3)&&(m("0,5"),t.value.mdbtime=ue(0,new Date)+" 09:00:00"),e==4&&m("0,6"),e==5&&m("0,1"),e==6&&m("0,4"),t.value.musers=[]},i=G(0),d=G("");async function x({file:e},l){d.value=l;const u=await Ke(e.file,e.name,"",T=>{i.value=T});u&&(l=="fl1"?t.value.fl1=u:l=="fl2"?t.value.fl2=u:l=="fl3"&&(t.value.fl3=u),i.value=0)}const re=()=>{var l,u;let e=JSON.parse(JSON.stringify(t.value));e.musers=(l=e.musers)==null?void 0:l.join("、"),e.contentArr=JSON.stringify(e.contentArr),he.set("setMeeting",e),(u=window.$message)==null||u.success("存草稿成功")};return(e,l)=>{const u=Pe,T=qe,k=We,Z=He,Q=Ge,ce=Re,U=Me,D=ke,Be=ze;return v(),P(Be,{show:$.value,"onUpdate:show":l[8]||(l[8]=p=>$.value=p),title:q.operateType==="add"?"新增会议纪要":q.operateType==="edit"?"编辑会议纪要":"新增会议纪要（复制）",preset:"card",class:"w-900px","mask-closable":!1,draggable:!0},{footer:o(()=>[s(D,{justify:"end"},{default:o(()=>[s(a(b),{size:"small",class:"mt-16px",onClick:V},{default:o(()=>[y(_(e.$t("common.cancel")),1)]),_:1}),s(a(b),{type:"primary",size:"small",class:"mt-16px",onClick:re},{default:o(()=>l[18]||(l[18]=[y(_("存草稿"))])),_:1,__:[18]}),s(a(b),{type:"primary",size:"small",class:"mt-16px",onClick:a(H)},{default:o(()=>[y(_(e.$t("common.confirm")),1)]),_:1},8,["onClick"])]),_:1})]),default:o(()=>[s(U,{ref_key:"formRef",ref:B,model:t.value,rules:n,"label-placement":"left"},{default:o(()=>[s(ce,{responsive:"screen","item-responsive":"","x-gap":"15"},{default:o(()=>[s(u,{span:"24 s:24 m:24",label:"会议标题",path:"mtopic"},{default:o(()=>[s(a(ee),{value:t.value.mtopic,"onUpdate:value":l[0]||(l[0]=p=>t.value.mtopic=p),placeholder:"请输入会议标题"},null,8,["value"])]),_:1}),s(u,{span:"24 s:12 m:12",label:"会议类型",path:"mtype"},{default:o(()=>[s(a(xe),{clearable:"",value:t.value.mtype,"onUpdate:value":[l[1]||(l[1]=p=>t.value.mtype=p),ne],options:a(O)==0||a(O)==4?N:a(O)==2||a(O)==3?h:a(O)==5?L:a(O)==6?c:F,placeholder:"请选择会议类型"},null,8,["value","options"])]),_:1}),s(u,{span:"24 s:12 m:12",label:"会议时间",path:"mdbtime"},{default:o(()=>[s(T,{"formatted-value":t.value.mdbtime,"onUpdate:formattedValue":l[2]||(l[2]=p=>t.value.mdbtime=p),"default-time":"17:30:00",type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",style:{width:"100%"}},null,8,["formatted-value"])]),_:1}),s(u,{span:"24 s:12 m:24",label:"参会人员",path:"musers"},{default:o(()=>[s(a(xe),{clearable:"",multiple:"",filterable:"",value:t.value.musers,"onUpdate:value":l[3]||(l[3]=p=>t.value.musers=p),placeholder:"请选择",options:a(M).data,"label-field":"username","value-field":"username",onScroll:S},null,8,["value","options"])]),_:1}),t.value.mtype==0?(v(),P(u,{key:0,span:"24 s:12 m:24",label:"会议内容",path:"",class:"flex-col"},{default:o(()=>[s(a(De),{ref_key:"scrollbarRef",ref:K,style:{"max-height":"300px"},class:"flex-col w-100%"},{default:o(()=>[(v(!0),C(Oe,null,Ae(t.value.contentArr,(p,me)=>(v(),C("div",{class:"ml-20px",key:p.id},[r("div",dt,[r("div",ct,[r("div",mt,[l[9]||(l[9]=r("h3",{class:"font-size-12px font-bold mt-2 w-100px"},"调试人员",-1)),s(a(ee),{clearable:"",value:p.person,"onUpdate:value":j=>p.person=j,status:p.status1,onInput:j=>Y(p),id:"person-"+me,placeholder:"请输入"},null,8,["value","onUpdate:value","status","onInput","id"])]),r("div",ft,[l[10]||(l[10]=r("h3",{class:"font-size-12px font-bold mt-2 w-100px"},"项目名称",-1)),s(a(ee),{clearable:"",value:p.proname,"onUpdate:value":j=>p.proname=j,status:p.status2,onInput:j=>ae(p),id:"proname-"+me,placeholder:"请输入"},null,8,["value","onUpdate:value","status","onInput","id"])]),r("div",vt,[l[11]||(l[11]=r("h3",{class:"font-size-12px font-bold mt-2 w-100px"},"工作描述",-1)),s(a(ee),{clearable:"",value:p.desc,"onUpdate:value":j=>p.desc=j,onInput:j=>oe(p),status:p.status3,id:"desc-"+me,placeholder:"请输入",type:"textarea",rows:4},null,8,["value","onUpdate:value","onInput","status","id"])]),r("div",_t,[l[12]||(l[12]=r("h3",{class:"font-size-12px font-bold mt-2 w-100px"},"遇到的问题",-1)),s(a(ee),{clearable:"",value:p.problem,"onUpdate:value":j=>p.problem=j,placeholder:"请输入",type:"textarea",rows:2},null,8,["value","onUpdate:value"])])]),r("div",yt,[s(a(b),{class:"mb-10px",text:"",type:"info",onClick:j=>se(p)},{default:o(()=>l[13]||(l[13]=[y("添加")])),_:2,__:[13]},1032,["onClick"]),t.value.contentArr.length>1?(v(),P(a(b),{key:0,text:"",type:"error",onClick:j=>t.value.contentArr.splice(me,1)},{default:o(()=>l[14]||(l[14]=[y("删除")])),_:2,__:[14]},1032,["onClick"])):W("",!0)])]),s(k,{dashed:""})]))),128))]),_:1},512)]),_:1})):(v(),P(u,{key:1,span:"24 s:12 m:24",label:"会议内容",path:"con2",class:"flex-col"},{default:o(()=>[s(a(ee),{clearable:"",value:t.value.con2,"onUpdate:value":l[4]||(l[4]=p=>t.value.con2=p),placeholder:"请输入",type:"textarea",rows:8},null,8,["value"])]),_:1})),s(u,{span:"24 s:24 m:12",label:"附件1:",path:"fl1"},{default:o(()=>[t.value.fl1?(v(),C("div",gt,[r("span",null,_(t.value.fl1.split("?")[1]),1),s(a(b),{text:"",type:"error",onClick:l[5]||(l[5]=p=>t.value.fl1="")},{default:o(()=>l[15]||(l[15]=[y("删除")])),_:1,__:[15]})])):(v(),C("div",bt,[s(Z,{ref:"uploadRef",action:"#","show-file-list":!1,"custom-request":p=>x(p,"fl1")},{default:o(()=>[s(a(b),{loading:i.value>0&&!t.value.fl1},{default:o(()=>[y(_(i.value>0&&!t.value.fl1&&d.value=="fl1"?"上传中":"上传文件"),1)]),_:1},8,["loading"])]),_:1},8,["custom-request"]),i.value&&!t.value.fl1&&d.value=="fl1"?(v(),P(Q,{key:0,type:"line",percentage:i.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):W("",!0)]))]),_:1}),s(u,{span:"24 s:24 m:12",label:"附件2:",path:"fl2"},{default:o(()=>[t.value.fl2?(v(),C("div",ht,[r("span",null,_(t.value.fl2.split("?")[1]),1),s(a(b),{text:"",type:"error",onClick:l[6]||(l[6]=p=>t.value.fl2="")},{default:o(()=>l[16]||(l[16]=[y("删除")])),_:1,__:[16]})])):(v(),C("div",xt,[s(Z,{ref:"uploadRef",action:"#","show-file-list":!1,"custom-request":p=>x(p,"fl2")},{default:o(()=>[s(a(b),{loading:i.value>0&&!t.value.fl2},{default:o(()=>[y(_(i.value>0&&!t.value.fl2&&d.value=="fl2"?"上传中":"上传文件"),1)]),_:1},8,["loading"])]),_:1},8,["custom-request"]),i.value&&!t.value.fl2&&d.value=="fl2"?(v(),P(Q,{key:0,type:"line",percentage:i.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):W("",!0)]))]),_:1}),s(u,{span:"24 s:24 m:12",label:"附件3:",path:"fl3"},{default:o(()=>[t.value.fl3?(v(),C("div",wt,[r("span",null,_(t.value.fl3.split("?")[1]),1),s(a(b),{text:"",type:"error",onClick:l[7]||(l[7]=p=>t.value.fl3="")},{default:o(()=>l[17]||(l[17]=[y("删除")])),_:1,__:[17]})])):(v(),C("div",kt,[s(Z,{ref:"uploadRef",action:"#","show-file-list":!1,"custom-request":p=>x(p,"fl3")},{default:o(()=>[s(a(b),{loading:i.value>0&&!t.value.fl3},{default:o(()=>[y(_(i.value>0&&!t.value.fl3&&d.value=="fl3"?"上传中":"上传文件"),1)]),_:1},8,["loading"])]),_:1},8,["custom-request"]),i.value&&!t.value.fl3&&d.value=="fl3"?(v(),P(Q,{key:0,type:"line",percentage:i.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):W("",!0)]))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title"])}}}),St=Ue($t,[["__scopeId","data-v-253329cc"]]),Ct=ge({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:ye(["reset","search"],["update:model"]),setup(g,{emit:J}){var E;const $=J,{formRef:X,restoreValidation:O}=Xe(),f=(E=be().userInfo)==null?void 0:E.usertype,h=we(g,"model"),L=[{label:"技术部每日例会",value:0},{label:"技术部周例会",value:1}],c=[{label:"研发周例会(网络安全) ",value:2},{label:"研发周例会(数据通讯)",value:3}],F=[{label:"生产部周例会",value:4}],N=[{label:"销售周例会",value:5}],B=[...L,...c,...F,...N,{label:"管理层周例会",value:6}],{pageData:t,getData:n,nextPage:I}=Ie(Te),M=async z=>{const w=z.currentTarget,H=w.scrollTop;w.scrollTop+w.offsetHeight>=w.scrollHeight&&t.data.length<t.total&&(await I(),await _e(),setTimeout(()=>{w.scrollTop=H}))};Ye(async()=>{n({usertypes:f==0||f==4?"0,1,2,3,4,5,6":f==2||f==3?"0,2,3":f==5?"0,5":f==6?"0,6":"0,1"}),h.value.mtype=f==0||f==4?void 0:f==2||f==3?0:f==5?2:f==6?4:5,$("search")});const A=async z=>{h.value.dates=z,$("search")},R=async z=>{h.value.creater=z,$("search")};async function S(){await O(),h.value.dates=null,h.value.mtype=null,h.value.creater=null,$("reset")}async function m(){$("search")}return(z,w)=>{const H=qe,V=Pe,K=xe,se=nt,Y=b,ae=ot,oe=ke,ne=Re,i=Me,d=je;return v(),P(d,{bordered:!1,size:"small",class:"card-wrapper"},{default:o(()=>[s(i,{ref_key:"formRef",ref:X,model:h.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:Ze(m,["enter"])},{default:o(()=>[s(ne,{responsive:"screen","item-responsive":"","x-gap":16,"y-gap":16},{default:o(()=>[s(V,{span:"24 s:12 m:6",label:"日期",path:"dates"},{default:o(()=>[s(H,{clearable:"","formatted-value":h.value.dates,"onUpdate:formattedValue":[w[0]||(w[0]=x=>h.value.dates=x),A],type:"date","value-format":"yyyy-MM-dd",style:{width:"100%"}},null,8,["formatted-value"])]),_:1}),s(V,{span:"24 s:12 m:6",label:"会议类型",path:"mtype"},{default:o(()=>[s(K,{clearable:a(f)==0||a(f)==4,filterable:"",value:h.value.mtype,"onUpdate:value":[w[1]||(w[1]=x=>h.value.mtype=x),m],placeholder:"请选择",options:a(f)==0||a(f)==4?B:a(f)==2||a(f)==3?L:a(f)==5?c:a(f)==6?F:N},null,8,["clearable","value","options"])]),_:1}),s(V,{span:"24 s:12 m:6",label:"创建者",path:"pid"},{default:o(()=>[s(K,{clearable:"",filterable:"",value:h.value.creater,"onUpdate:value":[w[2]||(w[2]=x=>h.value.creater=x),R],placeholder:"请选择","label-field":"username","value-field":"id",options:a(t).data,onScroll:M},null,8,["value","options"])]),_:1}),s(V,{span:"24  s:12 m:6",class:"pr-24px"},{default:o(()=>[s(oe,{class:"w-full"},{default:o(()=>[s(Y,{onClick:S},{icon:o(()=>[s(se,{class:"text-icon"})]),default:o(()=>[y(" "+_(a(le)("common.reset")),1)]),_:1}),s(Y,{type:"primary",ghost:"",onClick:m},{icon:o(()=>[s(ae,{class:"text-icon"})]),default:o(()=>[y(" "+_(a(le)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),Nt={class:"ml-40px font-bold"},Mt={key:0},Dt={class:"mb-20px ml-40px"},Ot={class:"flex items-center"},At={class:"preview-text"},zt={class:"flex items-center"},Tt={class:"preview-text"},Ut={class:"flex"},jt={class:"preview-text"},It={class:"flex"},Rt={class:"preview-text"},Pt={key:1},qt={class:"preview-text ml-40px"},Ft={key:2,class:"mt-3 mb-3 ml-40px text-gray-700 preview-text"},Bt={key:3,class:"mt-3 mb-3 ml-40px text-gray-700 preview-text"},Vt={key:4,class:"mt-3 mb-3 ml-40px text-gray-700 preview-text"},Jt=ge({__name:"lookModal",props:ye({id:{}},{lookisible:{type:Boolean,default:!1},lookisibleModifiers:{}}),emits:["update:lookisible"],setup(g){var B;const J=we(g,"lookisible");(B=be().userInfo)==null||B.usertype;const X=[{label:"技术部每日例会",value:0},{label:"技术部周例会",value:1}],O=[{label:"研发周例会(网络安全) ",value:2},{label:"研发周例会(数据通讯)",value:3}],q=[{label:"生产部周例会",value:4}],f=[{label:"销售周例会",value:5}],h=[...X,...O,...q,...f,{label:"管理层周例会",value:6}],L=g;Ne(()=>J.value,async t=>{t&&F()});const c=G({}),F=async()=>{const{data:t}=await Fe(L.id);t&&(c.value=t,c.value.mtype==0&&(c.value.contentArr=JSON.parse(t.con2)),c.value.mdbtime=ue(1,t.mdbtime))};async function N(t){if(!t)return;const n=t.split("?")[0],I=t.split("?")[1];try{const A=await(await fetch(n,{mode:"cors"})).blob(),R=URL.createObjectURL(A),S=document.createElement("a");S.href=R,S.download=I,S.style.display="none",document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL(R)}catch(M){console.error("下载失败:",M)}}return(t,n)=>{const I=rt,M=ze;return v(),P(M,{show:J.value,"onUpdate:show":n[3]||(n[3]=A=>J.value=A),preset:"card",class:"w-1000px"},{header:o(()=>n[4]||(n[4]=[r("div",null,"详细信息",-1)])),default:o(()=>[s(a(De),{style:{height:"calc(80vh)","padding-right":"20px"}},{default:o(()=>{var A,R,S;return[n[15]||(n[15]=r("h3",{class:"font-size-16px font-bold mt-2"},"标题",-1)),r("div",Nt,_(c.value.mtopic),1),n[16]||(n[16]=r("h3",{class:"font-size-16px font-bold mt-2"},"会议信息",-1)),s(I,{bordered:!1,"single-line":!1,class:"ml-40px w-90%"},{default:o(()=>{var m;return[r("tbody",null,[r("tr",null,[n[5]||(n[5]=r("th",null,"会议时间",-1)),r("th",null,_(c.value.mdbtime),1)]),r("tr",null,[n[6]||(n[6]=r("th",null,"会议类型",-1)),r("th",null,_((m=h.find(E=>E.value===c.value.mtype))==null?void 0:m.label),1)]),r("tr",null,[n[7]||(n[7]=r("th",null,"参会人员",-1)),r("th",null,_(c.value.musers),1)])])]}),_:1}),n[17]||(n[17]=r("h3",{class:"font-size-16px font-bold mt-2 mb-2"},"会议内容",-1)),c.value.mtype==0?(v(),C("div",Mt,[(v(!0),C(Oe,null,Ae(c.value.contentArr,m=>(v(),C("div",Dt,[r("div",Ot,[n[8]||(n[8]=r("h3",{class:"font-size-14px font-bold whitespace-nowrap"},"调试人员：",-1)),r("div",At,_(m.person),1)]),r("div",zt,[n[9]||(n[9]=r("h3",{class:"font-size-14px font-bold whitespace-nowrap"},"项目名称：",-1)),r("div",Tt,_(m.proname),1)]),r("div",Ut,[n[10]||(n[10]=r("h3",{class:"font-size-14px font-bold whitespace-nowrap"},"工作描述：",-1)),r("div",jt,_(m.desc),1)]),r("div",It,[n[11]||(n[11]=r("h3",{class:"font-size-14px font-bold whitespace-nowrap"},"遇到的问题：",-1)),r("div",Rt,_(m.problem),1)])]))),256))])):(v(),C("div",Pt,[r("div",qt,_(c.value.con2),1)])),n[18]||(n[18]=r("h3",{class:"font-size-16px font-bold mt-2"},"附件1：",-1)),c.value.fl1?(v(),C("div",Ft,[y(_((A=c.value.fl1)==null?void 0:A.split("?")[1])+" ",1),s(a(b),{text:"",type:"primary",size:"small",onClick:n[0]||(n[0]=m=>N(c.value.fl1))},{default:o(()=>n[12]||(n[12]=[y("下载")])),_:1,__:[12]})])):W("",!0),n[19]||(n[19]=r("h3",{class:"font-size-16px font-bold mt-2"},"附件2：",-1)),c.value.fl2?(v(),C("div",Bt,[y(_((R=c.value.fl2)==null?void 0:R.split("?")[1])+" ",1),s(a(b),{text:"",type:"primary",size:"small",onClick:n[1]||(n[1]=m=>N(c.value.fl2))},{default:o(()=>n[13]||(n[13]=[y("下载")])),_:1,__:[13]})])):W("",!0),n[20]||(n[20]=r("h3",{class:"font-size-16px font-bold mt-2"},"附件3：",-1)),c.value.fl3?(v(),C("div",Vt,[y(_((S=c.value.fl3)==null?void 0:S.split("?")[1])+" ",1),s(a(b),{text:"",type:"primary",size:"small",onClick:n[2]||(n[2]=m=>N(c.value.fl3))},{default:o(()=>n[14]||(n[14]=[y("下载")])),_:1,__:[14]})])):W("",!0)]}),_:1,__:[15,16,17,18,19,20]})]),_:1},8,["show"])}}}),Lt=Ue(Jt,[["__scopeId","data-v-18001e28"]]),Et={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function Ce(g){return typeof g=="function"||Object.prototype.toString.call(g)==="[object Object]"&&!lt(g)}const ol=ge({name:"meetingminutes",__name:"index",setup(g){const J=Qe(),$=be(),X=[{label:"技术部每日例会",value:0},{label:"技术部周例会",value:1}],O=[{label:"研发周例会(网络安全) ",value:2},{label:"研发周例会(数据通讯)",value:3}],q=[{label:"生产部周例会",value:4}],f=[{label:"销售周例会",value:5}],h=[...X,...O,...q,...f,{label:"管理层周例会",value:6}],{columns:L,columnChecks:c,data:F,getData:N,loading:B,mobilePagination:t,searchParams:n}=st({showTotal:!0,immediate:!1,apiFn:it,apiParams:{page:1,pageSize:20,limit:20,mtype:void 0,dates:void 0,creater:void 0,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48,disabled:i=>$.userInfo.id!=i.creater},{key:"mtopic",title:"会议标题",align:"center",width:120},{key:"mtype",title:"会议类型",align:"center",width:120,render:i=>s("span",null,[h[i.mtype].label])},{key:"mdbtime",title:"会议时间",align:"center",width:120},{key:"username",title:"创建人",align:"center",width:120},{key:"dates",title:"创建日期",align:"center",width:120},{key:"operate",title:le("common.operate"),align:"center",width:140,fixed:"right",render:i=>{let d;return s("div",{class:"flex-center gap-8px"},[te(s(b,{type:"primary",ghost:!0,size:"small",onClick:()=>V(i.id)},{default:()=>[y("详情")]}),[[ie("no-auth"),"project:Meeting:select"]]),$.userInfo.id==i.creater&&te(s(b,{type:"success",ghost:!0,size:"small",onClick:()=>oe(i)},{default:()=>[y("复制")]}),[[ie("no-auth"),"project:Meeting:insert"]]),$.userInfo.id==i.creater&&te(s(b,{type:"primary",ghost:!0,size:"small",onClick:()=>Y(i.id)},Ce(d=le("common.edit"))?d:{default:()=>[d]}),[[ie("no-auth"),"project:Meeting:update"]]),$.userInfo.id==i.creater&&s($e,{onPositiveClick:()=>se(i.id)},{default:()=>le("common.confirmDelete"),trigger:()=>{let x;return te(s(b,{type:"error",ghost:!0,size:"small"},Ce(x=le("common.delete"))?x:{default:()=>[x]}),[[ie("no-auth"),"project:Meeting:delete"]])}})])}}]}),{drawerVisible:I,operateType:M,editingData:A,handleAdd:R,handleEdit:S,checkedRowKeys:m,onBatchDeleted:E,onDeleted:z}=at(F,N),w=G(!1),H=G(0),V=i=>{w.value=!0,H.value=i};async function K(){console.log(m.value),ae(m.value.join(","),i=>{E()})}async function se(i){const{data:d,error:x}=await Se(i);x||z()}function Y(i){S(i)}async function ae(i,d){const{data:x,error:re}=await Se(i);if(!re)d&&d(x);else return!1}const oe=async i=>{S(i.id),M.value="copy"},ne=()=>{N()};return(i,d)=>{const x=ke,re=Le,de=Je,e=Ve,l=et,u=je,T=ie("no-auth");return v(),C("div",Et,[s(Ct,{model:a(n),"onUpdate:model":d[0]||(d[0]=k=>ve(n)?n.value=k:null),onReset:ne,onSearch:a(N)},null,8,["model","onSearch"]),s(u,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:o(()=>[s(x,{align:"center",wrap:"",class:"lt-sm:w-200px"},{default:o(()=>d[5]||(d[5]=[r("div",null,"会议纪要",-1)])),_:1,__:[5]})]),"header-extra":o(()=>[s(x,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:o(()=>[te((v(),P(a(b),{onClick:a(R),size:"small",ghost:"",type:"primary"},{icon:o(()=>[s(re,{class:"text-icon"})]),default:o(()=>[d[6]||(d[6]=y(" "+_("新增")))]),_:1,__:[6]},8,["onClick"])),[[T,"project:Meeting:insert"]]),s(a($e),{onPositiveClick:K},{trigger:o(()=>[te((v(),P(a(b),{size:"small",ghost:"",type:"error",disabled:a(m).length==0},{icon:o(()=>[s(de,{class:tt(["text-icon",{"animate-spin":a(B)}])},null,8,["class"])]),default:o(()=>[d[7]||(d[7]=y(" "+_("批量删除")))]),_:1,__:[7]},8,["disabled"])),[[T,"project:Meeting:delete"]])]),default:o(()=>[d[8]||(d[8]=y(" 确定要删除选中的会议吗？ "))]),_:1,__:[8]}),s(e,{columns:a(c),"onUpdate:columns":d[1]||(d[1]=k=>ve(c)?c.value=k:null)},null,8,["columns"])]),_:1})]),default:o(()=>[s(l,{"checked-row-keys":a(m),"onUpdate:checkedRowKeys":d[2]||(d[2]=k=>ve(m)?m.value=k:null),columns:a(L),data:a(F),size:"small","flex-height":!a(J).isMobile,loading:a(B),remote:"","row-key":k=>k.id,pagination:a(t),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),s(Lt,{id:H.value,lookisible:w.value,"onUpdate:lookisible":d[3]||(d[3]=k=>w.value=k)},null,8,["id","lookisible"]),s(St,{visible:a(I),"onUpdate:visible":d[4]||(d[4]=k=>ve(I)?I.value=k:null),onSubmitted:a(N),"operate-type":a(M),"row-data":a(A)},null,8,["visible","onSubmitted","operate-type","row-data"])]),_:1})])}}});export{ol as default};

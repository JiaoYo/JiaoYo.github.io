import{_ as ee}from"./table-column-setting.vue_vue_type_script_setup_true_lang-DTyciG8n.js";import{_ as te}from"./refresh-Uz8cUEvu.js";import{d as Q,p as ae,a0 as H,s as se,q as le,z as S,o as N,c as M,w as a,g as e,A as b,i as t,$ as p,aE as oe,h as u,t as O,C as ne,L as re,ak as ie,B as f,P as J,Q as ce,a6 as X,ay as ue,b7 as L,cf as me,cg as de,e as pe,aN as B,af as _e,aO as fe,aT as ge}from"./index-00pZtPBt.js";import{u as he,a as ye}from"./table-BUcbG8zn.js";import{_ as ve}from"./round-search-Cgm8cfgb.js";import{_ as be}from"./round-refresh-Ce8bIByR.js";import{C as we,a as ke}from"./common-BHxhCnia.js";import{_ as xe}from"./FormItemGridItem-CHgxRxLI.js";import{_ as ze}from"./Grid-DZYnaI-Y.js";import{_ as Ce}from"./lodash-C5_8fDzz.js";import{N as C}from"./Popconfirm-B352hAvh.js";const Se=Q({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:ae(["reset","search"],["update:model"]),setup(_,{emit:D}){const g=D,A=H(),{formRef:h,restoreValidation:w}=se(),n=le(_,"model");function k(){n.value.fuzzy=void 0,g("search")}async function P(){await w(),g("reset")}async function m(){g("search")}return(U,y)=>{const F=re,x=xe,j=ie,V=be,r=f,E=ve,I=J,K=ze,$=ce,R=X,z=S("no-space");return N(),M(R,{bordered:!1,size:"small",class:"card-wrapper"},{default:a(()=>[e($,{ref_key:"formRef",ref:h,model:n.value,"label-placement":"left","label-width":t(A).locale=="en-US"?120:100,"show-feedback":!1,onKeyup:ne(m,["enter"])},{default:a(()=>[e(K,{responsive:"screen","item-responsive":"","x-gap":12,"y-gap":12},{default:a(()=>[e(x,{span:"24 s:12 m:8 l:6",label:"告警名称",path:"fuzzy"},{default:a(()=>[b(e(F,{autofocus:"",value:n.value.fuzzy,"onUpdate:value":y[0]||(y[0]=v=>n.value.fuzzy=v),placeholder:"请输入告警名称",clearable:"",onClear:k},null,8,["value"]),[[z]])]),_:1}),e(x,{span:"24 s:12 m:8 l:6",label:"告警状态",path:"status"},{default:a(()=>[e(j,{filterable:"",clearable:"",placeholder:t(p)("page.manage.alarm.form.status"),value:n.value.status,"onUpdate:value":[y[1]||(y[1]=v=>n.value.status=v),m],options:t(oe)(t(we))},null,8,["placeholder","value","options"])]),_:1}),e(x,{span:"24 s:12 m:8 l:6"},{default:a(()=>[e(I,{class:"w-full flex items-center"},{default:a(()=>[e(r,{onClick:P},{icon:a(()=>[e(V,{class:"text-icon"})]),default:a(()=>[u(" "+O(t(p)("common.reset")),1)]),_:1}),e(r,{type:"primary",ghost:"",onClick:m},{icon:a(()=>[e(E,{class:"text-icon"})]),default:a(()=>[u(" "+O(t(p)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","label-width"])]),_:1})}}}),Ne={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function W(_){return typeof _=="function"||Object.prototype.toString.call(_)==="[object Object]"&&!fe(_)}const je=Q({name:"manage_systemalarm",__name:"index",setup(_){const D=H(),g=[{label:"一般",value:0},{label:"低级",value:1},{label:"中级",value:2},{label:"高级",value:3},{label:"严重",value:4}],{columns:A,columnChecks:h,data:w,getData:n,loading:k,mobilePagination:P,searchParams:m,resetSearchParams:U}=he({apiFn:ue,immediate:!0,apiParams:{page:1,limit:20,status:null,fuzzy:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48,fixed:"left"},{key:"aname",title:"告警名称",align:"center",minWidth:120,ellipsis:{tooltip:!0}},{key:"uname",title:"用户",align:"center",width:100},{key:"alevel",title:"告警等级",align:"center",width:100,render:s=>{var i;const l={0:"#8e9dff",1:"#5da8ff",2:"#fedc69",3:"#ff9874",4:"#ff0000"},o=(i=g.find(T=>T.value===s.alevel))==null?void 0:i.label;let c={color:l[s.alevel],textColor:"#ffffff",borderColor:l[s.alevel]};return e(L,{size:"small",color:c},W(o)?o:{default:()=>[o]})}},{key:"status",title:p("page.manage.alarm.status"),align:"center",width:120,render:s=>{(s.status===void 0||s.status===null)&&(s.status=0);const l={0:"error",1:"success"},o=p(ke[s.status]);return e(L,{size:"small",type:l[s.status]},W(o)?o:{default:()=>[o]})}},{key:"dbtime",title:"发生时间",align:"center",width:180},{key:"adec",title:"告警描述",align:"center",minWidth:160,ellipsis:{tooltip:!0}},{key:"operate",title:p("common.operate"),align:"center",width:130,fixed:"right",render:s=>e("div",{class:"flex-center gap-8px"},[s.status==0&&e(C,{onPositiveClick:()=>z(s.id+"")},{default:()=>"确定要确认该告警数据吗？",trigger:()=>b(e(f,{type:"primary",ghost:!0,size:"small"},{default:()=>[u("确认")]}),[[S("no-auth"),"sys.system.alarm.update"]])}),e(C,{onPositiveClick:()=>G(s.id+"")},{default:()=>"确定要删除该告警数据吗？",trigger:()=>b(e(f,{type:"error",ghost:!0,size:"small"},{default:()=>[u("删除")]}),[[S("no-auth"),"sys.system.alarm.delete"]])})])}]}),{drawerVisible:y,operateType:F,editingData:x,handleAdd:j,handleEdit:V,checkedRowKeys:r,onBatchDeleted:E,onDeleted:I,closeDrawer:K}=ye(w,n),$=()=>{z(r.value.join(","))},R=()=>{n()},z=async s=>{var c,i;const{data:l,error:o}=await me({ids:s});o||(n(),(c=window.$message)==null||c.destroyAll(),(i=window.$message)==null||i.success("确认成功"),r.value=[])},v=()=>{G(r.value.join(","))},G=async s=>{var c,i;const{data:l,error:o}=await de({ids:s});o||(n(),(c=window.$message)==null||c.destroyAll(),(i=window.$message)==null||i.success("删除成功"))},Y=Ce.debounce(n,1e3,{leading:!0,trailing:!1});return(s,l)=>{const o=te,c=ee,i=J,T=ge,Z=X,q=S("no-auth");return N(),pe("div",Ne,[e(Se,{model:t(m),"onUpdate:model":l[0]||(l[0]=d=>B(m)?m.value=d:null),onReset:t(U),onSearch:t(Y)},null,8,["model","onReset","onSearch"]),e(Z,{title:"系统告警",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":a(()=>[e(i,null,{default:a(()=>[e(t(C),{onPositiveClick:$},{trigger:a(()=>[b((N(),M(t(f),{size:"small",ghost:"",type:"primary",disabled:t(r).length===0},{default:a(()=>[u(" 批量确认 ")]),_:1},8,["disabled"])),[[q,"sys.system.alarm.update"]])]),default:a(()=>[u(" 确定要确认选中的数据吗？ ")]),_:1}),e(t(C),{onPositiveClick:v},{trigger:a(()=>[b((N(),M(t(f),{size:"small",ghost:"",type:"error",disabled:t(r).length===0},{default:a(()=>[u(" 批量删除 ")]),_:1},8,["disabled"])),[[q,"sys.system.alarm.delete"]])]),default:a(()=>[u(" 确定要删除选中的数据吗？ ")]),_:1}),e(t(f),{size:"small",onClick:R},{icon:a(()=>[e(o,{class:_e(["text-icon",{"animate-spin":t(k)}])},null,8,["class"])]),default:a(()=>[u(" "+O(t(p)("common.refresh")),1)]),_:1}),e(c,{columns:t(h),"onUpdate:columns":l[1]||(l[1]=d=>B(h)?h.value=d:null)},null,8,["columns"])]),_:1})]),default:a(()=>[e(T,{"checked-row-keys":t(r),"onUpdate:checkedRowKeys":l[2]||(l[2]=d=>B(r)?r.value=d:null),columns:t(A),data:t(w),size:"small","flex-height":!t(D).isMobile,"scroll-x":702,loading:t(k),remote:"","row-key":d=>d.id,pagination:t(P),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1})])}}});export{je as default};

import{_ as Q}from"./export-DiTNICj-.js";import{_ as Z}from"./round-search-BkIFSzTE.js";import{d as F,a6 as W,U as G,j as _,v as I,ae as U,o as f,e as M,N as Y,aU as T,g as n,w as l,i as g,B as P,h as E,t as H,$ as L,c as k,C as O,bA as V,K as j,J as z,a1 as K}from"./index-QmClEG7y.js";import{e as q}from"./metar-KTWU9_Pm.js";import{e as J}from"./exportExcel-Bv4G4H50.js";import{u as X,L as C}from"./echarts-Btoru9zf.js";import{_ as ee}from"./RadioButton--K73zusS.js";import{_ as ae}from"./DataTable-BOogGWCD.js";import{_ as te}from"./DatePicker-C6kltwlQ.js";import{a as oe}from"./RadioGroup-BI3HroPe.js";import{_ as ne}from"./FormItemGridItem-Bi831RuM.js";import{_ as re}from"./Grid-D9ukfblt.js";import"./Forward-Bl4P6wDi.js";import"./TimePicker-CT1GZhA6.js";const le=F({name:"LineChart",__name:"line-chart",props:{data:{type:Object,default:()=>({})}},setup(S){const s=S;W(()=>s.data,async o=>{u(e=>(e.xAxis.data=s.data.map(t=>t.dbtime),e.series[0].data=s.data.map(t=>t.power),e.series[1].data=s.data.map(t=>t.prePower),e))});const v=G(),r=_(null),{domRef:h,updateOptions:i,updateOptionsAsync:u}=X(()=>({tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}},backgroundColor:"#6a7985",textStyle:{color:"rgb(224, 224, 224)"},formatter:function(o){console.log(o);const e=o[0].data,{value:t,prePower:a,temperature:c,envH:p,WindD:y,WindS:x,QY:w}=e;return`${o[0].name}<br/>实际功率：${t?t+"MW":"--"}<br/>
      预测功率：${a?a+"MW":"--"}<br/>
      环境温度：${c?c+"°C":"--"}<br/>
      环境湿度：${p?p+"%":"--"}<br/>
      风向瞬时值：${y||"--"}<br/>
      风速瞬时值：${x||"--"}<br/>
      气压: ${w?w+"Pa":"--"}<br/>`}},legend:{data:["实际功率","预测功率"]},toolbox:{show:!0,feature:{saveAsImage:{show:!0,name:"功率图表"},magicType:{show:!0,type:["line","bar"]}}},grid:{left:"2%",right:"4%",bottom:"10%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value",axisLabel:{formatter:"{value} MW"}},series:[{color:"#e90445",name:"实际功率",type:"line",emphasis:{focus:"series"},lineStyle:{width:1},areaStyle:{color:new C(0,0,0,1,[{offset:0,color:"rgba(233, 4, 69,0.3)"},{offset:1,color:"rgba(233, 4, 69,0)"}],!1),shadowColor:"rgba(233, 4, 69,0.9)",shadowBlur:20},data:[],connectNulls:!0},{color:"#009688",name:"预测功率",type:"line",emphasis:{focus:"series"},lineStyle:{width:1},areaStyle:{color:new C(0,0,0,1,[{offset:0,color:"rgba(0, 150, 136,0.3)"},{offset:1,color:"rgba(0, 150, 136,0)"}],!1),shadowColor:"rgba(0, 150, 136,0.9)",shadowBlur:20},data:[],connectNulls:!0}],dataZoom:[{type:"inside",start:0,end:100},{start:0,end:100}]}));async function D(){await new Promise(o=>{setTimeout(o,1e3)}),i(o=>(o.xAxis.data=s.data.map(e=>e.dbtime),o.series[0].data=s.data.map(e=>({value:e.power,prePower:e.prePower,envT:e.envT,envH:e.envH,dbtime:e.dbtime,EnvH:e.EnvH,WindD:e.WindD,WindS:e.WindS,YLDayE:e.YLDayE,QY:e.QY,RZDayHour:e.RZDayHour,FSD2Day:e.FSD2Day,FSD1Day:e.FSD1Day})),o.series[1].data=s.data.map(e=>({value:e.prePower})),o))}function d(){i((o,e)=>{const t=e();return o.legend.data=t.legend.data,o.series[0].name=t.series[0].name,o.series[1].name=t.series[1].name,o})}async function b(){D()}return W(()=>v.locale,()=>{d()}),b(),I(()=>{r.value=window.setInterval(()=>{console.log("mainHomeLineChart timer")},1e3*60*5)}),U(()=>{r.value!==null&&(clearInterval(r.value),r.value=null)}),(o,e)=>(f(),M("div",{ref_key:"domRef",ref:h,class:"h-600px overflow-hidden"},null,512))}}),se=Y(le,[["__scopeId","data-v-10811f8e"]]),ie={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},ce=F({name:"realtimequery_powerweatheroverview",__name:"index",setup(S){const s=[{key:"dbtime",title:"时间",align:"center",width:160,fixed:"left"},{key:"EnvT",title:"环境温度",align:"center",width:140},{key:"LDT",title:"露点温度",align:"center",width:140},{key:"EnvH",title:"环境湿度",align:"center",width:140},{key:"WindD",title:"风向瞬时值",align:"center",width:140},{key:"WindS",title:"风速瞬时值",align:"center",width:140},{key:"YLDayE",title:"雨量日累计",align:"center",width:140},{key:"QY",title:"气压",align:"center",width:80},{key:"RZDayHour",title:"日照日累计时数",align:"center",width:140},{key:"FSD2Day",title:"直接辐射日累计量",align:"center",width:140},{key:"FSD1Day",title:"散射辐射日累计量",align:"center",width:140},{key:"power",title:"实际功率(MW)",align:"center",width:100,fixed:"right"},{key:"prePower",title:"预测功率(MW)",align:"center",width:100,fixed:"right"},{key:"operate",title:"误差(MW)",align:"center",width:100,fixed:"right",render(e){const t=e.prePower-e.power>=0?e.prePower-e.power:e.power-e.prePower;return n("span",null,[t?parseFloat(t.toFixed(6)):""])}}],v=_(!1),r=_({dateTime:T(0,Date.now())}),h=e=>{r.value.dateTime=T(0,e),u()},i=_([]),u=async()=>{const{data:e,error:t}=await q({date:r.value.dateTime});t||(i.value=e,D())};u();const D=async()=>{const{data:e,error:t}=await V({date:r.value.dateTime});t||(console.log(e),i.value.forEach(a=>{const c=e.find(p=>p.dbtime===a.dbtime);c&&(a.power=c.power,a.prePower=c.prePower)}))},d=_("0"),b=async()=>{u()},o=()=>{const e={dbtime:"时间",EnvT:"环境温度",LDT:"露点温度",EnvH:"环境湿度",WindD:"风向瞬时值",WindS:"风速瞬时值",YLDayE:"雨量日累计",QY:"气压",RZDayHour:"日照日累计时数",FSD2Day:"直接辐射日累计量",FSD1Day:"散射辐射日累计量",power:"实际功率(MW)",prePower:"预测功率(MW)",error:"误差(MW)"},t=[];i.value.forEach(a=>{t.push({dbtime:a.dbtime,EnvT:a.EnvT,LDT:a.LDT,EnvH:a.EnvH,WindD:a.WindD,WindS:a.WindS,YLDayE:a.YLDayE,QY:a.QY,RZDayHour:a.RZDayHour,FSD2Day:a.FSD2Day,FSD1Day:a.FSD1Day,power:a.power,prePower:a.prePower,error:a.prePower-a.power>=0?a.prePower-a.power:a.power-a.prePower||""})}),J(t,e,r.value.dateTime+"_气象功率概览")};return(e,t)=>{const a=ae,c=te,p=Z,y=ee,x=oe,w=ne,$=re,N=j,R=Q,A=z,B=K;return f(),M("div",ie,[n(B,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:l(()=>[n(N,{ref:"formRef",model:r.value,"label-placement":"left","show-feedback":!1},{default:l(()=>[n($,{"y-gap":16,responsive:"screen","item-responsive":""},{default:l(()=>[n(w,{span:"24 s:12 m:18",label:"日期",path:"startTime"},{default:l(()=>[n(c,{"formatted-value":r.value.dateTime,"onUpdate:formattedValue":t[0]||(t[0]=m=>r.value.dateTime=m),"value-format":"yyyy-MM-dd",type:"date","onUpdate:value":h,style:{width:"200px"}},null,8,["formatted-value"]),n(g(P),{type:"primary",ghost:"",onClick:b,class:"mx-20px"},{icon:l(()=>[n(p,{class:"text-icon"})]),default:l(()=>[E(" "+H(g(L)("common.search")),1)]),_:1}),n(x,{value:d.value,"onUpdate:value":t[1]||(t[1]=m=>d.value=m),name:"radiobuttongroup1"},{default:l(()=>[n(y,{value:"0",label:"表格"}),n(y,{value:"1",label:"图表"})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1},8,["model"])]),"header-extra":l(()=>[d.value==="0"?(f(),k(A,{key:0,align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:l(()=>[n(g(P),{onClick:o,size:"small"},{icon:l(()=>[n(R,{class:"text-icon"})]),default:l(()=>[E(" "+H(g(L)("common.export")),1)]),_:1})]),_:1})):O("",!0)]),default:l(()=>[d.value==="0"?(f(),k(a,{key:0,columns:s,data:i.value,size:"small",loading:v.value,remote:"","row-key":m=>m.id,class:"sm:h-full","flex-height":!0,"scroll-x":""},null,8,["data","loading","row-key"])):(f(),k(se,{key:1,data:i.value},null,8,["data"]))]),_:1})])}}}),ke=Y(ce,[["__scopeId","data-v-bf6a54c0"]]);export{ke as default};

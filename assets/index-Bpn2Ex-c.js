import{_ as ee}from"./table-header-operation.vue_vue_type_script_setup_true_lang-BgfKE8t2.js";import{d as V,q as O,x as q,s as W,b as te,r as ae,ag as oe,F as B,o as L,c as E,w as a,g as e,h as I,t as F,i as o,$ as p,H,G as R,aD as J,L as Q,M as ne,au as se,P as X,as as le,Q as Y,B as j,ah as ie,ai as re,af as Z,a5 as ue,ax as A,aC as ce,e as pe,aj as U,ak as de,al as me}from"./index-b-tEOQea.js";import{u as _e,a as fe}from"./table-BfCfNean.js";import{I as he,J as ge,K as ve,L as ye}from"./basic-config-eKsEPR9J.js";import{_ as be}from"./round-search-BOrpJEk6.js";import{_ as we}from"./round-refresh-CerSsMY0.js";import{_ as ke}from"./lodash-CqSdoX1d.js";import{_ as De}from"./FormItemGridItem-BGGD_lC8.js";import{_ as Ne}from"./Grid-BHUm-qXA.js";import{h as G}from"./permission-D09LFsGp.js";import{_ as xe}from"./Popconfirm-CdcvVkbL.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-3wfWTgiM.js";import"./setting-outlined-SXeXtAqu.js";import"./export-CEiW63Ba.js";import"./refresh-CU7cSF-I.js";import"./round-delete-BzcobGsa.js";import"./round-plus-DRNdmgq0.js";import"./Upload-BL3J4I7E.js";import"./Progress-Ehf_r-3i.js";const Ce=V({name:"OperateDrawer",__name:"operate-drawer",props:O({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:O(["submitted"],["update:visible"]),setup(f,{emit:$}){const c=f,y=$,d=q(f,"visible"),{formRef:s,validate:D,restoreValidation:P}=W(),w=te(()=>({add:"新增白名单",edit:"编辑白名单"})[c.operateType]),l=ae(b());function b(){return{ip:"",status:0,sysparam:0,dscb:""}}const N={ip:{required:!0,validator:J,trigger:["input","change","blur","password-input"]}};function M(){Object.assign(l,b()),c.operateType==="edit"&&c.rowData&&Object.assign(l,c.rowData)}function m(){d.value=!1}async function k(){var i,r;if(await D(),c.operateType==="add"){const{data:h,error:_}=await he([l]);_||((i=window.$message)==null||i.success(p("common.addSuccess")),m(),y("submitted"))}else{const{data:h,error:_}=await ge([l]);_||((r=window.$message)==null||r.success(p("common.updateSuccess")),m(),y("submitted"))}}return oe(d,()=>{d.value&&(M(),P())}),(i,r)=>{const h=Q,_=ne,x=se,C=X,T=le,S=Y,t=j,n=ie,u=re,z=B("no-space");return L(),E(u,{show:d.value,"onUpdate:show":r[3]||(r[3]=g=>d.value=g),"display-directive":"show",width:360},{default:a(()=>[e(n,{title:w.value,"native-scrollbar":!1,closable:""},{footer:a(()=>[e(C,{size:16},{default:a(()=>[e(t,{onClick:m},{default:a(()=>[I(F(o(p)("common.cancel")),1)]),_:1}),e(t,{type:"primary",onClick:k},{default:a(()=>[I(F(o(p)("common.confirm")),1)]),_:1})]),_:1})]),default:a(()=>[e(S,{ref_key:"formRef",ref:s,model:l,rules:N,onKeyup:H(k,["enter"])},{default:a(()=>[e(_,{label:"IP",path:"ip"},{default:a(()=>[R(e(h,{clearable:"",value:l.ip,"onUpdate:value":r[0]||(r[0]=g=>l.ip=g),placeholder:"请输入IP"},null,8,["value"]),[[z]])]),_:1}),e(_,{label:"状态"},{default:a(()=>[e(T,{value:l.status,"onUpdate:value":r[1]||(r[1]=g=>l.status=g),name:"radiogroup"},{default:a(()=>[e(C,null,{default:a(()=>[e(x,{value:0},{default:a(()=>[I("启用")]),_:1}),e(x,{value:1},{default:a(()=>[I("禁用")]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),e(_,{label:"描述",path:"dscb"},{default:a(()=>[R(e(h,{clearable:"",value:l.dscb,"onUpdate:value":r[2]||(r[2]=g=>l.dscb=g),placeholder:"请输入描述"},null,8,["value"]),[[z]])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Se=V({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:O(["reset","search"],["update:model"]),setup(f,{emit:$}){const c=$,{formRef:y,restoreValidation:d}=W(),s=q(f,"model"),D={ip:[{validator:J,trigger:["blur","change","input"]}]};function P(){s.value.fuzzy=void 0,s.value.ip=s.value.ip==""?void 0:s.value.ip,c("search")}function w(){s.value.ip=void 0,c("search")}async function l(){await d(),c("reset")}async function b(){c("search")}const N=ke.debounce(b,1e3,{leading:!0,trailing:!1});return(M,m)=>{const k=Q,i=De,r=we,h=j,_=be,x=X,C=Ne,T=Y,S=Z,t=B("no-space");return L(),E(S,{bordered:!1,size:"small",class:"card-wrapper"},{default:a(()=>[e(T,{ref_key:"formRef",ref:y,model:s.value,"label-placement":"left",rules:D,"label-width":80,"show-require-mark":!1,onKeyup:H(o(N),["enter"])},{default:a(()=>[e(C,{responsive:"screen","item-responsive":"","y-gap":12},{default:a(()=>[e(i,{span:"24 s:12 m:8 l:6",label:"名称",path:"fuzzy"},{default:a(()=>[R(e(k,{clearable:"",value:s.value.fuzzy,"onUpdate:value":m[0]||(m[0]=n=>s.value.fuzzy=n),placeholder:"请输入关键字",onClear:P},null,8,["value"]),[[t]])]),_:1}),e(i,{span:"24 s:12 m:8 l:6",label:"IP",path:"ip"},{default:a(()=>[R(e(k,{clearable:"",value:s.value.ip,"onUpdate:value":m[1]||(m[1]=n=>s.value.ip=n),placeholder:"请输入IP",onClear:w},null,8,["value"]),[[t]])]),_:1}),e(i,{span:"24  s:12 m:8 l:6"},{default:a(()=>[e(x,{class:"w-full ml-20px"},{default:a(()=>[e(h,{onClick:l},{icon:a(()=>[e(r,{class:"text-icon"})]),default:a(()=>[I(" "+F(o(p)("common.reset")),1)]),_:1}),e(h,{type:"primary",ghost:"",onClick:o(N)},{icon:a(()=>[e(_,{class:"text-icon"})]),default:a(()=>[I(" "+F(o(p)("common.search")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","onKeyup"])]),_:1})}}}),ze={class:"min-h-500px flex-col-stretch gap-16px overflow-auto lt-sm:overflow-auto"};function K(f){return typeof f=="function"||Object.prototype.toString.call(f)==="[object Object]"&&!de(f)}const He=V({name:"basicconfig_whitelist",__name:"index",setup(f){const $=ue(),{columns:c,columnChecks:y,data:d,getData:s,loading:D,mobilePagination:P,searchParams:w,resetSearchParams:l}=_e({apiFn:ve,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,fuzzy:null,ip:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48,disabled:t=>t.sysparam==0},{key:"ip",title:"IP地址",align:"center",width:240},{key:"dscb",title:"描述",align:"center",width:240},{key:"status",title:"状态",align:"center",render:t=>(t.status===null&&(t.status=0),e(A,{type:{0:"success",1:"error"}[t.status]},{default:()=>[t.status==0?"启用":"禁用"]}))},{key:"sysparam",title:"系统内置",align:"center",width:240,render:t=>{t.sysparam==null&&(t.sysparam=0);const n={0:"success",1:"info"},u=p(ce[t.sysparam]);return e(A,{size:"small",type:n[t.sysparam]},K(u)?u:{default:()=>[u]})}},{key:"operate",title:p("common.operate"),align:"center",width:130,render:t=>{let n;return e("div",{class:"flex-center gap-8px"},[R(e(j,{type:"primary",ghost:!0,size:"small",onClick:()=>T(t.id),disabled:t.sysparam==0},K(n=p("common.edit"))?n:{default:()=>[n]}),[[B("no-auth"),"sys.white.list.update"]]),e(xe,{onPositiveClick:()=>C(t.id)},{default:()=>p("common.confirmDelete"),trigger:()=>{let u;return R(e(j,{type:"error",ghost:!0,size:"small",disabled:t.sysparam==0},K(u=p("common.delete"))?u:{default:()=>[u]}),[[B("no-auth"),"sys.white.list.delete"]])}})])}}]}),{drawerVisible:b,operateType:N,editingData:M,handleAdd:m,handleEdit:k,checkedRowKeys:i,onBatchDeleted:r,onDeleted:h,closeDrawer:_}=fe(d,s);async function x(){console.log(i.value),S(i.value.join(","),t=>{r()})}function C(t){console.log(t),S(t,n=>{h()})}function T(t){k(t)}async function S(t,n){const{data:u,error:z}=await ye(t);if(!z)n&&n(u);else return!1}return(t,n)=>{const u=ee,z=me,g=Z;return L(),pe("div",ze,[e(Se,{model:o(w),"onUpdate:model":n[0]||(n[0]=v=>U(w)?w.value=v:null),onReset:o(l),onSearch:o(s)},null,8,["model","onReset","onSearch"]),e(g,{title:"白名单",bordered:!1,size:"small",class:"sm:flex-1-hidden"},{"header-extra":a(()=>[e(u,{columns:o(y),"onUpdate:columns":n[1]||(n[1]=v=>U(y)?y.value=v:null),"disabled-delete":o(i).length===0,"is-view-add-button":o(G)("sys.white.list.insert"),"is-view-delete-button":o(G)("sys.white.list.delete"),loading:o(D),onAdd:o(m),onDelete:x,onRefresh:o(s)},null,8,["columns","disabled-delete","is-view-add-button","is-view-delete-button","loading","onAdd","onRefresh"])]),default:a(()=>[e(z,{"checked-row-keys":o(i),"onUpdate:checkedRowKeys":n[2]||(n[2]=v=>U(i)?i.value=v:null),columns:o(c),data:o(d),size:"small","flex-height":!o($).isMobile,"scroll-x":962,loading:o(D),remote:"","row-key":v=>v.id,pagination:o(P),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(Ce,{visible:o(b),"onUpdate:visible":n[3]||(n[3]=v=>U(b)?b.value=v:null),"operate-type":o(N),"row-data":o(M),onSubmitted:o(s)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1})])}}});export{He as default};

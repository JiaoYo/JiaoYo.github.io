import{_ as Y}from"./table-header-operation.vue_vue_type_script_setup_true_lang-4uJD7G6W.js";import{d as B,q as O,s as H,v as I,x as J,b as Q,r as X,y as Z,L as ee,o as F,c as L,w as a,g as e,h as C,t as U,i as t,$ as D,V as $,M as te,Y as z,C as ae,A as le,D as P,B as j,E,ab as oe,ac as ne,N as se,aa as K,a0 as ie,an as re,e as me,ad as M,ae as ce}from"./index-Cw03N3Zb.js";import{u as pe,a as de}from"./table-pW7AL8c6.js";import{f as ue}from"./threat-ByKA9iSx.js";import{b as _e,a as q,T as fe}from"./basicconf-S8a_HCTE.js";import{_ as A}from"./DatePicker-Cc0Ehv65.js";import{_ as ve}from"./round-search-CjX6C_4m.js";import{_ as ye}from"./round-refresh-1h-Gpja5.js";import{_ as he}from"./FormItemGridItem-SvsLsq5T.js";import{_ as be}from"./Grid--xFJOl9N.js";import{_ as ge}from"./DataTable-Cl633dKI.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-7Piq3qDV.js";import"./setting-outlined-BCm9xmub.js";import"./round-delete-DyFqyA58.js";import"./refresh-ITAUszw8.js";import"./round-plus-CnpkLCwp.js";import"./Upload-B9graKKF.js";import"./Progress-Bo8SvBah.js";import"./Popconfirm-B2thSO6u.js";import"./TimePicker-yNmPXDUd.js";import"./defineProperty-CoF7QmJA.js";import"./Forward-CjRKdAIx.js";const we=B({name:"OperateDrawer",__name:"operate-drawer",props:O({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:O(["submitted"],["update:visible"]),setup(_,{emit:T}){const u=_,r=H(_,"visible"),{formRef:b,validate:o,restoreValidation:g}=I(),{defaultRequiredRule:w}=J(),f=Q(()=>({add:"新增威胁事件",edit:"编辑威胁事件"})[u.operateType]),l=X(i());function i(){return{ttype:0,tlevel:void 0,edesc:"",recivetime:void 0,alarmtime:void 0}}const N={ttype:w,tlevel:w};function h(){Object.assign(l,i()),u.operateType==="edit"&&u.rowData&&Object.assign(l,u.rowData)}function R(){r.value=!1}async function S(){await o()}return Z(r,()=>{r.value&&(h(),g())}),(v,s)=>{const x=z,y=ae,m=le,n=A,c=P,k=j,V=E,p=oe,G=ne,W=ee("no-space");return F(),L(G,{show:r.value,"onUpdate:show":s[5]||(s[5]=d=>r.value=d),"display-directive":"show",width:360},{default:a(()=>[e(p,{title:f.value,"native-scrollbar":!1,closable:""},{footer:a(()=>[e(V,{size:16},{default:a(()=>[e(k,{onClick:R},{default:a(()=>[C(U(t(D)("common.cancel")),1)]),_:1}),e(k,{type:"primary",onClick:S},{default:a(()=>[C(U(t(D)("common.confirm")),1)]),_:1})]),_:1})]),default:a(()=>[e(c,{ref_key:"formRef",ref:b,model:l,rules:N},{default:a(()=>[e(y,{label:"事件类型",path:"ttype"},{default:a(()=>[e(x,{filterable:"",value:l.ttype,"onUpdate:value":s[0]||(s[0]=d=>l.ttype=d),placeholder:"请选择事件类型",options:t($)(t(_e)),style:{width:"100%"}},null,8,["value","options"])]),_:1}),e(y,{label:"级别",path:"tlevel"},{default:a(()=>[e(x,{filterable:"",value:l.tlevel,"onUpdate:value":s[1]||(s[1]=d=>l.tlevel=d),placeholder:"请选择级别",options:t($)(t(q)),style:{width:"100%"}},null,8,["value","options"])]),_:1}),e(y,{label:"事件描述",path:"edesc"},{default:a(()=>[te(e(m,{type:"textarea",value:l.edesc,"onUpdate:value":s[2]||(s[2]=d=>l.edesc=d),placeholder:"请输入事件描述",clearable:""},null,8,["value"]),[[W]])]),_:1}),e(y,{label:"接收时间",path:"recivetime"},{default:a(()=>[e(n,{placeholder:"请选择接收时间","formatted-value":l.recivetime,"onUpdate:formattedValue":s[3]||(s[3]=d=>l.recivetime=d),"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",clearable:"",style:{width:"100%"}},null,8,["formatted-value"])]),_:1}),e(y,{label:"告警时间",path:"alarmtime"},{default:a(()=>[e(n,{placeholder:"请选择告警时间","formatted-value":l.alarmtime,"onUpdate:formattedValue":s[4]||(s[4]=d=>l.alarmtime=d),"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",clearable:"",style:{width:"100%"}},null,8,["formatted-value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),ke=B({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:O(["reset","search"],["update:model"]),setup(_,{emit:T}){const u=T,{formRef:r,restoreValidation:b}=I(),o=H(_,"model");async function g(l,i){l?(o.value.startTime=l[0],o.value.endTime=l[1]):(o.value.startTime=null,o.value.endTime=null),u("search")}async function w(){await b(),o.value.timeRange=null,u("reset")}async function f(){u("search")}return(l,i)=>{const N=z,h=he,R=A,S=ye,v=j,s=ve,x=E,y=be,m=P,n=K;return F(),L(n,{bordered:!1,size:"small",class:"card-wrapper"},{default:a(()=>[e(m,{ref_key:"formRef",ref:r,model:o.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:se(f,["enter"])},{default:a(()=>[e(y,{responsive:"screen","item-responsive":""},{default:a(()=>[e(h,{span:"24 s:12 m:6",label:"级别",path:"tlevel",class:"pr-24px"},{default:a(()=>[e(N,{filterable:"",clearable:"",value:o.value.tlevel,"onUpdate:value":[i[0]||(i[0]=c=>o.value.tlevel=c),f],placeholder:"请选择级别",options:t($)(t(q))},null,8,["value","options"])]),_:1}),e(h,{span:"24 s:12 m:8",label:"告警时间",path:"timeRange",class:"pr-24px"},{default:a(()=>[e(R,{"start-placeholder":"起始告警时间","end-placeholder":"终止告警时间","formatted-value":o.value.timeRange,"onUpdate:formattedValue":[i[1]||(i[1]=c=>o.value.timeRange=c),g],"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetimerange",clearable:"",style:{width:"100%"}},null,8,["formatted-value"])]),_:1}),e(h,{span:"24 m:6",class:"pr-24px"},{default:a(()=>[e(x,{class:"w-full"},{default:a(()=>[e(v,{onClick:w},{icon:a(()=>[e(S,{class:"text-icon"})]),default:a(()=>[C(" "+U(t(D)("common.reset")),1)]),_:1}),e(v,{type:"primary",ghost:"",onClick:f},{icon:a(()=>[e(s,{class:"text-icon"})]),default:a(()=>[C(" "+U(t(D)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),Ne={class:"min-h-500px flex-col-stretch gap-16px overflow-auto lt-sm:overflow-auto"};function xe(_){return typeof _=="function"||Object.prototype.toString.call(_)==="[object Object]"&&!ce(_)}const Ge=B({name:"intelligence_threatevent",__name:"index",setup(_){const T=ie(),{columns:u,columnChecks:r,data:b,getData:o,loading:g,mobilePagination:w,searchParams:f,resetSearchParams:l}=pe({apiFn:ue,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,tlevel:null,startTime:null,endTime:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48,fixed:"left"},{key:"ttype",title:"事件类型",align:"center",minWidth:200,ellipsis:{tooltip:!0}},{key:"tlevel",title:"事件等级",align:"center",width:120,render:m=>{(m.tlevel===void 0||m.tlevel===null)&&(m.tlevel=0);const n={0:"#8e9dff",1:"#5da8ff",2:"#fedc69",3:"#ff9874",4:"#ff0000"},c=D(fe[m.tlevel]);let k={color:n[m.tlevel],textColor:"#ffffff",borderColor:n[m.tlevel]};return e(re,{size:"small",color:k},xe(c)?c:{default:()=>[c]})}},{key:"edesc",title:"事件描述",align:"center",minWidth:120,ellipsis:{tooltip:!0}},{key:"recivetime",title:"接收时间",align:"center",width:160},{key:"alarmtime",title:"告警时间",align:"center",width:160}]}),{drawerVisible:i,operateType:N,editingData:h,handleAdd:R,handleEdit:S,checkedRowKeys:v,onBatchDeleted:s,onDeleted:x,closeDrawer:y}=de(b,o);return(m,n)=>{const c=Y,k=ge,V=K;return F(),me("div",Ne,[e(ke,{model:t(f),"onUpdate:model":n[0]||(n[0]=p=>M(f)?f.value=p:null),onReset:t(l),onSearch:t(o)},null,8,["model","onReset","onSearch"]),e(V,{title:"威胁事件",bordered:!1,size:"small",class:"sm:flex-1-hidden"},{"header-extra":a(()=>[e(c,{columns:t(r),"onUpdate:columns":n[1]||(n[1]=p=>M(r)?r.value=p:null),"disabled-delete":t(v).length===0,loading:t(g),onRefresh:t(o)},null,8,["columns","disabled-delete","loading","onRefresh"])]),default:a(()=>[e(k,{"checked-row-keys":t(v),"onUpdate:checkedRowKeys":n[2]||(n[2]=p=>M(v)?v.value=p:null),columns:t(u),data:t(b),size:"small","flex-height":!t(T).isMobile,"scroll-x":962,loading:t(g),remote:"","row-key":p=>p.id,pagination:t(w),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(we,{visible:t(i),"onUpdate:visible":n[3]||(n[3]=p=>M(i)?i.value=p:null),"operate-type":t(N),"row-data":t(h),onSubmitted:t(o)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1})])}}});export{Ge as default};

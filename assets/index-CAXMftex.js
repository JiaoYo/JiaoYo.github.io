import{_ as Y}from"./table-header-operation.vue_vue_type_script_setup_true_lang-DCcFtEoA.js";import{d as A,q as F,s as G,v as E,x as Z,b as ee,r as te,y as ne,o as V,c as L,w as n,g as e,h as z,t as U,i as a,$ as g,M as W,av as ae,A as H,C as oe,aq as se,E as J,ap as le,D as Q,B as T,ae as ie,af as re,K,L as O,ad as X,a4 as pe,e as ce,ag as M,ah as de,ai as ue}from"./index-ByfxsQvj.js";import{w as me,x as _e,e as fe,y as ge}from"./asset-BfC2BO85.js";import{u as ve,a as he}from"./table-Ca-5bYro.js";import{_ as ye}from"./round-search-U_wZ0GRt.js";import{_ as we}from"./round-refresh-BRVSTvae.js";import{_ as be}from"./lodash-21GmhknM.js";import{_ as ke}from"./FormItemGridItem-Dtr_7n7z.js";import{_ as De}from"./Grid-B9K_tFX2.js";import{h as j}from"./permission-DpUBsxJs.js";import{_ as Ne}from"./Popconfirm-Bx1fZnQD.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-frQqLk93.js";import"./setting-outlined-C6sNL0co.js";import"./export-CaaNVRvS.js";import"./refresh-DDT70CE0.js";import"./round-delete-BsuQe4MI.js";import"./round-plus--T3dOesv.js";import"./Upload-BPNrVbAn.js";import"./Progress-B01mUdYA.js";const xe=A({name:"OperateDrawer",__name:"operate-drawer",props:F({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:F(["submitted"],["update:visible"]),setup(v,{emit:C}){const p=v,h=C,_=G(v,"visible"),{formRef:d,validate:D,restoreValidation:S}=E(),{defaultRequiredRule:b,formRules:k}=Z(),N=ee(()=>({add:"新增网络配置",edit:"编辑网络配置"})[p.operateType]),t=te(x());function x(){return{nname:"",iptype:0,startip:"",endip:"",ndesc:""}}const I={nname:b,startip:k.ip,endip:k.ip};function R(){Object.assign(t,x()),p.operateType==="edit"&&p.rowData&&Object.assign(t,p.rowData)}function r(){_.value=!1}async function P(){var y,s,u,c;if(await D(),ae(t.startip,t.endip)>0)return(y=window.$message)==null||y.destroyAll(),(s=window.$message)==null||s.error("起始IP不能大于结束IP"),!1;if(p.operateType==="add"){const{data:w,error:m}=await me([{nname:t.nname,iptype:t.iptype,startip:t.startip,endip:t.endip,ndesc:t.ndesc}]);m||((u=window.$message)==null||u.success(g("common.addSuccess")),r(),h("submitted"))}else{const{data:w,error:m}=await _e([{id:p.rowData.id,nname:t.nname,iptype:t.iptype,startip:t.startip,endip:t.endip,ndesc:t.ndesc}]);m||((c=window.$message)==null||c.success(g("common.updateSuccess")),r(),h("submitted"))}}return ne(_,()=>{_.value&&(R(),S())}),(y,s)=>{const u=H,c=oe,w=se,m=J,l=le,i=Q,f=T,$=ie,B=re;return V(),L(B,{show:_.value,"onUpdate:show":s[5]||(s[5]=o=>_.value=o),"display-directive":"show",width:360},{default:n(()=>[e($,{title:N.value,"native-scrollbar":!1,closable:""},{footer:n(()=>[e(m,{size:16},{default:n(()=>[e(f,{onClick:r},{default:n(()=>[z(U(a(g)("common.cancel")),1)]),_:1}),e(f,{type:"primary",onClick:P},{default:n(()=>[z(U(a(g)("common.confirm")),1)]),_:1})]),_:1})]),default:n(()=>[e(i,{ref_key:"formRef",ref:d,model:t,rules:I,onKeyup:W(P,["enter"])},{default:n(()=>[e(c,{label:"网络名称",path:"nname"},{default:n(()=>[e(u,{value:t.nname,"onUpdate:value":s[0]||(s[0]=o=>t.nname=o),placeholder:"请输入网络名称",clearable:""},null,8,["value"])]),_:1}),e(c,{label:"IP类型",path:"iptype"},{default:n(()=>[e(l,{value:t.iptype,"onUpdate:value":s[1]||(s[1]=o=>t.iptype=o)},{default:n(()=>[e(m,null,{default:n(()=>[e(w,{value:0},{default:n(()=>[z("IPv4")]),_:1}),e(w,{value:1},{default:n(()=>[z("IPv6")]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),e(c,{label:"起始IP",path:"startip"},{default:n(()=>[e(u,{value:t.startip,"onUpdate:value":s[2]||(s[2]=o=>t.startip=o),placeholder:"请输入起始IP",clearable:""},null,8,["value"])]),_:1}),e(c,{label:"结束IP",path:"endip"},{default:n(()=>[e(u,{value:t.endip,"onUpdate:value":s[3]||(s[3]=o=>t.endip=o),placeholder:"请输入结束IP",clearable:""},null,8,["value"])]),_:1}),e(c,{label:"描述",path:"ndesc"},{default:n(()=>[e(u,{value:t.ndesc,"onUpdate:value":s[4]||(s[4]=o=>t.ndesc=o),type:"textarea",placeholder:"请输入描述",clearable:""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Ie=A({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:F(["reset","search"],["update:model"]),setup(v,{emit:C}){const p=C,{formRef:h,restoreValidation:_}=E(),d=G(v,"model");function D(){d.value.fuzzy="",p("search")}async function S(){await _(),p("reset")}async function b(){p("search")}const k=be.throttle(b,1e3,{trailing:!1});return(N,t)=>{const x=H,I=ke,R=we,r=T,P=ye,y=J,s=De,u=Q,c=X,w=K("no-space");return V(),L(c,{bordered:!1,size:"small",class:"card-wrapper"},{default:n(()=>[e(u,{ref_key:"formRef",ref:h,model:d.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:W(a(k),["enter"])},{default:n(()=>[e(s,{responsive:"screen","item-responsive":"","x-gap":12,"y-gap":12},{default:n(()=>[e(I,{span:"24 s:12 m:8 l:6",label:"名称",path:"fuzzy",class:"pr-24px"},{default:n(()=>[O(e(x,{value:d.value.fuzzy,"onUpdate:value":t[0]||(t[0]=m=>d.value.fuzzy=m),placeholder:"请输入名称",clearable:"",onClear:D},null,8,["value"]),[[w]])]),_:1}),e(I,{span:"24 s:12 m:8 l:6",class:"pr-24px"},{default:n(()=>[e(y,{class:"w-full"},{default:n(()=>[e(r,{onClick:S},{icon:n(()=>[e(R,{class:"text-icon"})]),default:n(()=>[z(" "+U(a(g)("common.reset")),1)]),_:1}),e(r,{type:"primary",ghost:"",onClick:a(k)},{icon:n(()=>[e(P,{class:"text-icon"})]),default:n(()=>[z(" "+U(a(g)("common.search")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","onKeyup"])]),_:1})}}}),Pe={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function q(v){return typeof v=="function"||Object.prototype.toString.call(v)==="[object Object]"&&!de(v)}const We=A({name:"assetmanagement_network",__name:"index",setup(v){const C=pe(),{columns:p,columnChecks:h,data:_,getData:d,loading:D,mobilePagination:S,searchParams:b,resetSearchParams:k}=ve({apiFn:fe,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,fuzzy:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48},{key:"nname",title:"名称",align:"center",minWidth:160,ellipsis:{tooltip:!0}},{key:"iptype",title:"IP类型",align:"center",width:120,render:l=>e("div",null,[l.iptype==0?"IPv4":"IPv6"])},{key:"startip",title:"IP范围",align:"center",width:260,render:l=>`${l.startip} ~ ${l.endip}`,ellipsis:{tooltip:!0}},{key:"ndesc",title:"描述",align:"center",minWidth:160,ellipsis:{tooltip:!0}},{key:"operate",title:g("common.operate"),align:"center",width:130,render:l=>{let i;return e("div",{class:"flex-center gap-8px"},[O(e(T,{type:"primary",ghost:!0,size:"small",onClick:()=>w(l.id)},q(i=g("common.edit"))?i:{default:()=>[i]}),[[K("no-auth"),"sys.network.mengement.update"]]),e(Ne,{onPositiveClick:()=>c(l.id)},{default:()=>g("common.confirmDelete"),trigger:()=>{let f;return O(e(T,{type:"error",ghost:!0,size:"small"},q(f=g("common.delete"))?f:{default:()=>[f]}),[[K("no-auth"),"sys.network.mengement.delete"]])}})])}}]}),{drawerVisible:N,operateType:t,editingData:x,handleAdd:I,handleEdit:R,checkedRowKeys:r,onBatchDeleted:P,onDeleted:y,closeDrawer:s}=he(_,d);async function u(){console.log(r.value),m(r.value,l=>{P()})}function c(l){console.log(l),m([l],i=>{y()})}function w(l){R(l)}async function m(l,i){const{data:f,error:$}=await ge(l);if(!$)i&&i(f);else return!1}return(l,i)=>{const f=Y,$=ue,B=X;return V(),ce("div",Pe,[e(Ie,{model:a(b),"onUpdate:model":i[0]||(i[0]=o=>M(b)?b.value=o:null),onReset:a(k),onSearch:a(d)},null,8,["model","onReset","onSearch"]),e(B,{title:"网络管理",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":n(()=>[e(f,{columns:a(h),"onUpdate:columns":i[1]||(i[1]=o=>M(h)?h.value=o:null),"disabled-delete":a(r).length===0,"is-view-add-button":a(j)("sys.network.mengement.insert"),"is-view-delete-button":a(j)("sys.network.mengement.delete"),loading:a(D),onAdd:a(I),onDelete:u,onRefresh:a(d)},null,8,["columns","disabled-delete","is-view-add-button","is-view-delete-button","loading","onAdd","onRefresh"])]),default:n(()=>[e($,{"checked-row-keys":a(r),"onUpdate:checkedRowKeys":i[2]||(i[2]=o=>M(r)?r.value=o:null),columns:a(p),data:a(_),size:"small","flex-height":!a(C).isMobile,"scroll-x":962,loading:a(D),remote:"","row-key":o=>o.id,pagination:a(S),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(xe,{visible:a(N),"onUpdate:visible":i[3]||(i[3]=o=>M(N)?N.value=o:null),"operate-type":a(t),"row-data":a(x),onSubmitted:a(d)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1})])}}});export{We as default};

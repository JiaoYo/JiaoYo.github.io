import{_ as P}from"./export-BIqDrrAE.js";import{d as z,o as k,c as D,w as o,g as e,i as t,h as v,t as N,$ as r,B as S,N as U,O,ad as E,a3 as T,j as y,D as V,e as R,E as A,ai as F,aj as G,S as W,ar as H}from"./index-B0Q7N1Kr.js";import{f as J,a as K}from"./system-log-RdRbyqIB.js";import{u as Q}from"./table-BRZYP53q.js";import{_ as X}from"./round-search-C2RlxiH4.js";import{_ as Y}from"./lodash-C0h6KmVK.js";import{_ as Z}from"./FormItemGridItem-CZqu2X36.js";import{_ as ee}from"./Grid-C27KcDTj.js";const te=z({name:"ErrorSearch",__name:"errorlog-search",emits:["search"],setup(l,{expose:x,emit:i}){const _=i;function u(){_("search")}async function C(){const{data:d,error:g}=await J();if(!g){let c=d,f=new Blob([c],{type:"application/vnd.ms-excel"}),h=new Date().getTime()+".xls",p=window.webkitURL.createObjectURL(f),a=document.createElement("a");a.href=p,a.download=h,document.body.appendChild(a),a.click(),a.remove()}}const b=Y.debounce(u,1e3,{leading:!0,trailing:!1});return x({handleExportChange:C}),(d,g)=>{const c=X,f=S,h=U,p=Z,a=ee,w=O,n=E;return k(),D(n,{bordered:!1,size:"small",class:"card-wrapper"},{default:o(()=>[e(w,{"label-placement":"left","label-width":80,"show-feedback":!1},{default:o(()=>[e(a,{responsive:"screen","item-responsive":"","x-gap":12,"y-gap":12},{default:o(()=>[e(p,{span:"24 s:12 m:8 l:6"},{default:o(()=>[e(h,{class:"w-full"},{default:o(()=>[e(f,{type:"primary",ghost:"",onClick:t(b)},{icon:o(()=>[e(c,{class:"text-icon"})]),default:o(()=>[v(" "+N(t(r)("common.search")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),oe={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function re(l){return typeof l=="function"||Object.prototype.toString.call(l)==="[object Object]"&&!F(l)}const _e=z({name:"logmanage_errorlog",__name:"index",setup(l){const x=T(),i=y(!1),_=y({errorInfo:""}),{columns:u,columnChecks:C,data:b,getData:d,loading:g,pagination:c,searchParams:f,resetSearchParams:h}=Q({apiFn:K,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,_t:new Date().getTime()},columns:()=>[{key:"requestUri",title:r("page.systemlog.error.requestUri"),width:160,align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"requestMethod",title:r("page.systemlog.error.requestMethod"),width:100,align:"center",resizable:!0},{key:"requestParams",title:r("page.systemlog.error.requestParams"),width:140,align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"ip",title:r("page.systemlog.error.ip"),width:160,align:"center",resizable:!0},{key:"userAgent",title:r("page.systemlog.error.userAgent"),minWidth:240,align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"createDate",title:r("page.systemlog.error.createDate"),width:160,align:"center",resizable:!0},{key:"operate",title:r("common.operate"),align:"center",width:130,render:n=>{let s;return e("div",{class:"flex-center gap-8px"},[e(S,{type:"primary",ghost:!0,size:"small",onClick:()=>p(n)},re(s=r("page.systemlog.error.errorMsg"))?s:{default:()=>[s]})])}}]});function p(n){_.value.errorInfo=n.errorInfo,i.value=!0}const a=y(),w=()=>{a.value.handleExportChange()};return(n,s)=>{const j=P,B=G,I=E,L=W,$=H,q=V("no-auth");return k(),R("div",oe,[e(te,{onSearch:t(d),ref_key:"searchRef",ref:a},null,8,["onSearch"]),e(I,{title:t(r)("page.systemlog.error.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":o(()=>[A((k(),D(t(S),{type:"info",size:"small",ghost:"",onClick:w},{icon:o(()=>[e(j,{class:"text-icon"})]),default:o(()=>[v(" "+N(t(r)("common.export")),1)]),_:1})),[[q,"sys:log:error.export"]])]),default:o(()=>[e(B,{columns:t(u),data:t(b),size:"small","flex-height":!t(x).isMobile,"scroll-x":t(u).reduce((m,M)=>m+M.width,0),loading:t(g),remote:"","row-key":m=>m.id,pagination:t(c),class:"sm:h-full"},null,8,["columns","data","flex-height","scroll-x","loading","row-key","pagination"])]),_:1},8,["title"]),e($,{show:i.value,"onUpdate:show":s[0]||(s[0]=m=>i.value=m),title:t(r)("page.systemlog.error.errorMsg"),preset:"card",class:"w-800px"},{default:o(()=>[e(L,{class:"h-480px pr-20px"},{default:o(()=>[v(N(_.value.errorInfo),1)]),_:1})]),_:1},8,["show","title"])])}}});export{_e as default};

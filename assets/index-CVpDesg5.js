import{_ as Vt}from"./round-refresh-BGP4Hcqp.js";import{_ as Wt}from"./round-search-vUwoc4so.js";import{_ as On}from"./table-column-setting.vue_vue_type_script_setup_true_lang-hmlrjEU9.js";import{_ as Un}from"./round-delete-DU9T8AXE.js";import{_ as Dn}from"./round-add-_cbc2d0G.js";import{W as Nn,X as Bn,Y as Mn,Z as G,a0 as Ee,a1 as Ce,a2 as ue,a3 as yt,a4 as qn,d as Ie,a5 as p,a6 as Hn,a7 as Vn,a8 as lt,a9 as Wn,aa as rt,ab as Kn,ac as Kt,ad as Gt,ae as it,af as He,ag as Gn,ah as Ot,ai as Jt,aj as Zt,a as we,ak as fe,al as Yt,am as Ut,an as Jn,ao as Zn,ap as Yn,aq as ce,ar as Qn,as as Xn,at as kt,au as Qt,q as Lt,v as Le,r as ae,s as Ct,av as Xt,aw as en,c as D,o as T,w as s,f as n,e as wt,G as _t,ax as ei,z as B,h as f,C as pe,ay as tn,az as St,aA as nn,g as S,B as A,b as at,aB as ti,aC as ln,N as Ft,aD as rn,$ as Q,t as Y,aE as an,aF as tt,aG as sn,aH as qe,aI as ni,aJ as nt,aK as ii,F as li,aL as on,E as dn,U as un,aM as cn,M as ri,aN as ai,i as si,aO as Oe,A as oi,aP as di,aQ as ui,D as te,aR as Xe,y as ne,aS as et,aT as ci,aU as pi}from"./index-g7h47wCD.js";import{u as gt,a as vt}from"./table-B7PoQ1CW.js";import{_ as zt}from"./Grid-Ca5T20R9.js";import{_ as Et}from"./FormItemGridItem-Bm7x-db3.js";import{h as le}from"./permission-DEDJvg_S.js";import{N as Ue}from"./Popconfirm-kfz4J5dj.js";let Dt=!1;function fi(){if(Nn&&window.CSS&&!Dt&&(Dt=!0,"registerProperty"in(window==null?void 0:window.CSS)))try{CSS.registerProperty({name:"--n-color-start",syntax:"<color>",inherits:!1,initialValue:"#0000"}),CSS.registerProperty({name:"--n-color-end",syntax:"<color>",inherits:!1,initialValue:"#0000"})}catch{}}function mi(d){const{textColor3:E,infoColor:F,errorColor:m,successColor:u,warningColor:y,textColor1:e,textColor2:g,railColor:v,fontWeightStrong:x,fontSize:h}=d;return Object.assign(Object.assign({},Mn),{contentFontSize:h,titleFontWeight:x,circleBorder:`2px solid ${E}`,circleBorderInfo:`2px solid ${F}`,circleBorderError:`2px solid ${m}`,circleBorderSuccess:`2px solid ${u}`,circleBorderWarning:`2px solid ${y}`,iconColor:E,iconColorInfo:F,iconColorError:m,iconColorSuccess:u,iconColorWarning:y,titleTextColor:e,contentTextColor:g,metaTextColor:E,lineColor:v})}const yi={common:Bn,self:mi},gi=G("steps",`
 width: 100%;
 display: flex;
`,[G("step",`
 position: relative;
 display: flex;
 flex: 1;
 `,[Ee("disabled","cursor: not-allowed"),Ee("clickable",`
 cursor: pointer;
 `),Ce("&:last-child",[G("step-splitor","display: none;")])]),G("step-splitor",`
 background-color: var(--n-splitor-color);
 margin-top: calc(var(--n-step-header-font-size) / 2);
 height: 1px;
 flex: 1;
 align-self: flex-start;
 margin-left: 12px;
 margin-right: 12px;
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `),G("step-content","flex: 1;",[G("step-content-header",`
 color: var(--n-header-text-color);
 margin-top: calc(var(--n-indicator-size) / 2 - var(--n-step-header-font-size) / 2);
 line-height: var(--n-step-header-font-size);
 font-size: var(--n-step-header-font-size);
 position: relative;
 display: flex;
 font-weight: var(--n-step-header-font-weight);
 margin-left: 9px;
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `,[ue("title",`
 white-space: nowrap;
 flex: 0;
 `)]),ue("description",`
 color: var(--n-description-text-color);
 margin-top: 12px;
 margin-left: 9px;
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `)]),G("step-indicator",`
 background-color: var(--n-indicator-color);
 box-shadow: 0 0 0 1px var(--n-indicator-border-color);
 height: var(--n-indicator-size);
 width: var(--n-indicator-size);
 border-radius: 50%;
 display: flex;
 align-items: center;
 justify-content: center;
 transition:
 background-color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
 `,[G("step-indicator-slot",`
 position: relative;
 width: var(--n-indicator-icon-size);
 height: var(--n-indicator-icon-size);
 font-size: var(--n-indicator-icon-size);
 line-height: var(--n-indicator-icon-size);
 `,[ue("index",`
 display: inline-block;
 text-align: center;
 position: absolute;
 left: 0;
 top: 0;
 white-space: nowrap;
 font-size: var(--n-indicator-index-font-size);
 width: var(--n-indicator-icon-size);
 height: var(--n-indicator-icon-size);
 line-height: var(--n-indicator-icon-size);
 color: var(--n-indicator-text-color);
 transition: color .3s var(--n-bezier);
 `,[yt()]),G("icon",`
 color: var(--n-indicator-text-color);
 transition: color .3s var(--n-bezier);
 `,[yt()]),G("base-icon",`
 color: var(--n-indicator-text-color);
 transition: color .3s var(--n-bezier);
 `,[yt()])])]),Ee("vertical","flex-direction: column;",[qn("show-description",[Ce(">",[G("step","padding-bottom: 8px;")])]),Ce(">",[G("step","margin-bottom: 16px;",[Ce("&:last-child","margin-bottom: 0;"),Ce(">",[G("step-indicator",[Ce(">",[G("step-splitor",`
 position: absolute;
 bottom: -8px;
 width: 1px;
 margin: 0 !important;
 left: calc(var(--n-indicator-size) / 2);
 height: calc(100% - var(--n-indicator-size));
 `)])]),G("step-content",[ue("description","margin-top: 8px;")])])])])])]);function vi(d,E){return typeof d!="object"||d===null||Array.isArray(d)?null:(d.props||(d.props={}),d.props.internalIndex=E+1,d)}function hi(d){return d.map((E,F)=>vi(E,F))}const bi=Object.assign(Object.assign({},rt.props),{current:Number,status:{type:String,default:"process"},size:{type:String,default:"medium"},vertical:Boolean,"onUpdate:current":[Function,Array],onUpdateCurrent:[Function,Array]}),pn=Kt("n-steps"),xi=Ie({name:"Steps",props:bi,slots:Object,setup(d,{slots:E}){const{mergedClsPrefixRef:F,mergedRtlRef:m}=lt(d),u=Wn("Steps",m,F),y=rt("Steps","-steps",gi,Kn,d,F);return Gt(pn,{props:d,mergedThemeRef:y,mergedClsPrefixRef:F,stepsSlots:E}),{mergedClsPrefix:F,rtlEnabled:u}},render(){const{mergedClsPrefix:d}=this;return p("div",{class:[`${d}-steps`,this.rtlEnabled&&`${d}-steps--rtl`,this.vertical&&`${d}-steps--vertical`]},hi(Hn(Vn(this))))}}),ki={status:String,title:String,description:String,disabled:Boolean,internalIndex:{type:Number,default:0}},Li=Ie({name:"Step",props:ki,slots:Object,setup(d){const E=Jt(pn,null);E||Zt("step","`n-step` must be placed inside `n-steps`.");const{inlineThemeDisabled:F}=lt(),{props:m,mergedThemeRef:u,mergedClsPrefixRef:y,stepsSlots:e}=E,g=we(()=>m.vertical),v=we(()=>{const{status:c}=d;if(c)return c;{const{internalIndex:$}=d,{current:P}=m;if(P===void 0)return"process";if($<P)return"finish";if($===P)return m.status||"process";if($>P)return"wait"}return"process"}),x=we(()=>{const{value:c}=v,{size:$}=m,{common:{cubicBezierEaseInOut:P},self:{stepHeaderFontWeight:l,[fe("stepHeaderFontSize",$)]:z,[fe("indicatorIndexFontSize",$)]:_,[fe("indicatorSize",$)]:j,[fe("indicatorIconSize",$)]:C,[fe("indicatorTextColor",c)]:U,[fe("indicatorBorderColor",c)]:q,[fe("headerTextColor",c)]:ye,[fe("splitorColor",c)]:me,[fe("indicatorColor",c)]:R,[fe("descriptionTextColor",c)]:be}}=u.value;return{"--n-bezier":P,"--n-description-text-color":be,"--n-header-text-color":ye,"--n-indicator-border-color":q,"--n-indicator-color":R,"--n-indicator-icon-size":C,"--n-indicator-index-font-size":_,"--n-indicator-size":j,"--n-indicator-text-color":U,"--n-splitor-color":me,"--n-step-header-font-size":z,"--n-step-header-font-weight":l}}),h=F?Yt("step",we(()=>{const{value:c}=v,{size:$}=m;return`${c[0]}${$[0]}`}),x,m):void 0,o=we(()=>{if(d.disabled)return;const{onUpdateCurrent:c,"onUpdate:current":$}=m;return c||$?()=>{c&&Ut(c,d.internalIndex),$&&Ut($,d.internalIndex)}:void 0});return{stepsSlots:e,mergedClsPrefix:y,vertical:g,mergedStatus:v,handleStepClick:o,cssVars:F?void 0:x,themeClass:h==null?void 0:h.themeClass,onRender:h==null?void 0:h.onRender}},render(){const{mergedClsPrefix:d,onRender:E,handleStepClick:F,disabled:m}=this,u=it(this.$slots.default,y=>{const e=y||this.description;return e?p("div",{class:`${d}-step-content__description`},e):null});return E==null||E(),p("div",{class:[`${d}-step`,m&&`${d}-step--disabled`,!m&&F&&`${d}-step--clickable`,this.themeClass,u&&`${d}-step--show-description`,`${d}-step--${this.mergedStatus}-status`],style:this.cssVars,onClick:F},p("div",{class:`${d}-step-indicator`},p("div",{class:`${d}-step-indicator-slot`},p(Gn,null,{default:()=>it(this.$slots.icon,y=>{const{mergedStatus:e,stepsSlots:g}=this;return e==="finish"||e==="error"?e==="finish"?p(Ot,{clsPrefix:d,key:"finish"},{default:()=>He(g["finish-icon"],()=>[p(Jn,null)])}):e==="error"?p(Ot,{clsPrefix:d,key:"error"},{default:()=>He(g["error-icon"],()=>[p(Zn,null)])}):null:y||p("div",{key:this.internalIndex,class:`${d}-step-indicator-slot__index`},this.internalIndex)})})),this.vertical?p("div",{class:`${d}-step-splitor`}):null),p("div",{class:`${d}-step-content`},p("div",{class:`${d}-step-content-header`},p("div",{class:`${d}-step-content-header__title`},He(this.$slots.title,()=>[this.title])),this.vertical?null:p("div",{class:`${d}-step-splitor`})),u))}}),Nt=1.25,Ci=G("timeline",`
 position: relative;
 width: 100%;
 display: flex;
 flex-direction: column;
 line-height: ${Nt};
`,[Ee("horizontal",`
 flex-direction: row;
 `,[Ce(">",[G("timeline-item",`
 flex-shrink: 0;
 padding-right: 40px;
 `,[Ee("dashed-line-type",[Ce(">",[G("timeline-item-timeline",[ue("line",`
 background-image: linear-gradient(90deg, var(--n-color-start), var(--n-color-start) 50%, transparent 50%, transparent 100%);
 background-size: 10px 1px;
 `)])])]),Ce(">",[G("timeline-item-content",`
 margin-top: calc(var(--n-icon-size) + 12px);
 `,[Ce(">",[ue("meta",`
 margin-top: 6px;
 margin-bottom: unset;
 `)])]),G("timeline-item-timeline",`
 width: 100%;
 height: calc(var(--n-icon-size) + 12px);
 `,[ue("line",`
 left: var(--n-icon-size);
 top: calc(var(--n-icon-size) / 2 - 1px);
 right: 0px;
 width: unset;
 height: 2px;
 `)])])])])]),Ee("right-placement",[G("timeline-item",[G("timeline-item-content",`
 text-align: right;
 margin-right: calc(var(--n-icon-size) + 12px);
 `),G("timeline-item-timeline",`
 width: var(--n-icon-size);
 right: 0;
 `)])]),Ee("left-placement",[G("timeline-item",[G("timeline-item-content",`
 margin-left: calc(var(--n-icon-size) + 12px);
 `),G("timeline-item-timeline",`
 left: 0;
 `)])]),G("timeline-item",`
 position: relative;
 `,[Ce("&:last-child",[G("timeline-item-timeline",[ue("line",`
 display: none;
 `)]),G("timeline-item-content",[ue("meta",`
 margin-bottom: 0;
 `)])]),G("timeline-item-content",[ue("title",`
 margin: var(--n-title-margin);
 font-size: var(--n-title-font-size);
 transition: color .3s var(--n-bezier);
 font-weight: var(--n-title-font-weight);
 color: var(--n-title-text-color);
 `),ue("content",`
 transition: color .3s var(--n-bezier);
 font-size: var(--n-content-font-size);
 color: var(--n-content-text-color);
 `),ue("meta",`
 transition: color .3s var(--n-bezier);
 font-size: 12px;
 margin-top: 6px;
 margin-bottom: 20px;
 color: var(--n-meta-text-color);
 `)]),Ee("dashed-line-type",[G("timeline-item-timeline",[ue("line",`
 --n-color-start: var(--n-line-color);
 transition: --n-color-start .3s var(--n-bezier);
 background-color: transparent;
 background-image: linear-gradient(180deg, var(--n-color-start), var(--n-color-start) 50%, transparent 50%, transparent 100%);
 background-size: 1px 10px;
 `)])]),G("timeline-item-timeline",`
 width: calc(var(--n-icon-size) + 12px);
 position: absolute;
 top: calc(var(--n-title-font-size) * ${Nt} / 2 - var(--n-icon-size) / 2);
 height: 100%;
 `,[ue("circle",`
 border: var(--n-circle-border);
 transition:
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 width: var(--n-icon-size);
 height: var(--n-icon-size);
 border-radius: var(--n-icon-size);
 box-sizing: border-box;
 `),ue("icon",`
 color: var(--n-icon-color);
 font-size: var(--n-icon-size);
 height: var(--n-icon-size);
 width: var(--n-icon-size);
 display: flex;
 align-items: center;
 justify-content: center;
 `),ue("line",`
 transition: background-color .3s var(--n-bezier);
 position: absolute;
 top: var(--n-icon-size);
 left: calc(var(--n-icon-size) / 2 - 1px);
 bottom: 0px;
 width: 2px;
 background-color: var(--n-line-color);
 `)])])]),wi=Object.assign(Object.assign({},rt.props),{horizontal:Boolean,itemPlacement:{type:String,default:"left"},size:{type:String,default:"medium"},iconSize:Number}),fn=Kt("n-timeline"),mn=Ie({name:"Timeline",props:wi,setup(d,{slots:E}){const{mergedClsPrefixRef:F}=lt(d),m=rt("Timeline","-timeline",Ci,yi,d,F);return Gt(fn,{props:d,mergedThemeRef:m,mergedClsPrefixRef:F}),()=>{const{value:u}=F;return p("div",{class:[`${u}-timeline`,d.horizontal&&`${u}-timeline--horizontal`,`${u}-timeline--${d.size}-size`,!d.horizontal&&`${u}-timeline--${d.itemPlacement}-placement`]},E)}}}),_i={time:[String,Number],title:String,content:String,color:String,lineType:{type:String,default:"default"},type:{type:String,default:"default"}},M=Ie({name:"TimelineItem",props:_i,slots:Object,setup(d){const E=Jt(fn);E||Zt("timeline-item","`n-timeline-item` must be placed inside `n-timeline`."),fi();const{inlineThemeDisabled:F}=lt(),m=we(()=>{const{props:{size:y,iconSize:e},mergedThemeRef:g}=E,{type:v}=d,{self:{titleTextColor:x,contentTextColor:h,metaTextColor:o,lineColor:c,titleFontWeight:$,contentFontSize:P,[fe("iconSize",y)]:l,[fe("titleMargin",y)]:z,[fe("titleFontSize",y)]:_,[fe("circleBorder",v)]:j,[fe("iconColor",v)]:C},common:{cubicBezierEaseInOut:U}}=g.value;return{"--n-bezier":U,"--n-circle-border":j,"--n-icon-color":C,"--n-content-font-size":P,"--n-content-text-color":h,"--n-line-color":c,"--n-meta-text-color":o,"--n-title-font-size":_,"--n-title-font-weight":$,"--n-title-margin":z,"--n-title-text-color":x,"--n-icon-size":Yn(e)||l}}),u=F?Yt("timeline-item",we(()=>{const{props:{size:y,iconSize:e}}=E,{type:g}=d;return`${y[0]}${e||"a"}${g[0]}`}),m,E.props):void 0;return{mergedClsPrefix:E.mergedClsPrefixRef,cssVars:F?void 0:m,themeClass:u==null?void 0:u.themeClass,onRender:u==null?void 0:u.onRender}},render(){const{mergedClsPrefix:d,color:E,onRender:F,$slots:m}=this;return F==null||F(),p("div",{class:[`${d}-timeline-item`,this.themeClass,`${d}-timeline-item--${this.type}-type`,`${d}-timeline-item--${this.lineType}-line-type`],style:this.cssVars},p("div",{class:`${d}-timeline-item-timeline`},p("div",{class:`${d}-timeline-item-timeline__line`}),it(m.icon,u=>u?p("div",{class:`${d}-timeline-item-timeline__icon`,style:{color:E}},u):p("div",{class:`${d}-timeline-item-timeline__circle`,style:{borderColor:E}}))),p("div",{class:`${d}-timeline-item-content`},it(m.header,u=>u||this.title?p("div",{class:`${d}-timeline-item-content__title`},u||this.title):null),p("div",{class:`${d}-timeline-item-content__content`},He(m.default,()=>[this.content])),p("div",{class:`${d}-timeline-item-content__meta`},He(m.footer,()=>[this.time]))))}});function Si(d){return ce({url:"/aftermarketComp/getPage.do",method:"get",params:function(){console.log("params",d);const E={...d};return Object.prototype.hasOwnProperty.call(E,"checkboxList")&&delete E.checkboxList,E}()})}function Bt(d,E){return ce({url:"/aftermarketComp/insert.do?creater="+d,method:"post",data:E})}function ht(d){return ce({url:"/aftermarketComp/update.do",method:"put",data:d})}function Fi(d){return ce({url:"/aftermarketComp/review.do",method:"put",data:Qn.stringify(d)})}function zi(d,E){return ce({url:"/aftermarketComp/delete.do",method:"delete",params:{arrIds:d.join(","),pwd:E}})}function Ei(d){return ce({url:"/aftermarket/getProjectPage.do",method:"get",params:d})}function ji(d){return ce({url:"/aftermarket/getPage.do",method:"get",params:d})}function $i(d){return ce({url:"/aftermarket/getById.do",method:"get",params:d})}function Mt(d,E){return ce({url:"/aftermarket/insert.do?uid="+E,method:"post",data:d})}function bt(d){return ce({url:"/aftermarket/update.do",method:"put",data:d})}function Pi(d,E){return ce({url:"/aftermarket/delete.do",method:"delete",params:{arrIds:d.join(","),pwd:E}})}function Ii(d){return ce({url:"/aftermarketRes/getPage.do",method:"get",params:d})}function Ai(d){return ce({url:"/aftermarketRes/insert.do",method:"post",data:d})}function Ti(d){return ce({url:"/aftermarketRes/update.do",method:"put",data:d})}function Ri(d){return ce({url:"/aftermarketRes/delete.do",method:"delete",params:{arrIds:d.join(",")}})}function Oi(d){return ce({url:"/aftermarket/selectBySn.do",method:"get",params:{sn:d,_t:new Date().getTime()}})}var xt={exports:{}},qt;function Ui(){return qt||(qt=1,function(d,E){(function(m,u){d.exports=u()})(window,function(){return function(F){var m={};function u(y){if(m[y])return m[y].exports;var e=m[y]={i:y,l:!1,exports:{}};return F[y].call(e.exports,e,e.exports,u),e.l=!0,e.exports}return u.m=F,u.c=m,u.d=function(y,e,g){u.o(y,e)||Object.defineProperty(y,e,{enumerable:!0,get:g})},u.r=function(y){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(y,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(y,"__esModule",{value:!0})},u.t=function(y,e){if(e&1&&(y=u(y)),e&8||e&4&&typeof y=="object"&&y&&y.__esModule)return y;var g=Object.create(null);if(u.r(g),Object.defineProperty(g,"default",{enumerable:!0,value:y}),e&2&&typeof y!="string")for(var v in y)u.d(g,v,(function(x){return y[x]}).bind(null,v));return g},u.n=function(y){var e=y&&y.__esModule?function(){return y.default}:function(){return y};return u.d(e,"a",e),e},u.o=function(y,e){return Object.prototype.hasOwnProperty.call(y,e)},u.p="",u(u.s=0)}({"./src/index.js":function(F,m,u){u.r(m),u("./src/sass/index.scss");var y=u("./src/js/init.js"),e=y.default.init;typeof window<"u"&&(window.printJS=e),m.default=e},"./src/js/browser.js":function(F,m,u){u.r(m);var y={isFirefox:function(){return typeof InstallTrigger<"u"},isIE:function(){return navigator.userAgent.indexOf("MSIE")!==-1||!!document.documentMode},isEdge:function(){return!y.isIE()&&!!window.StyleMedia},isChrome:function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;return!!g.chrome},isSafari:function(){return Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0||navigator.userAgent.toLowerCase().indexOf("safari")!==-1},isIOSChrome:function(){return navigator.userAgent.toLowerCase().indexOf("crios")!==-1}};m.default=y},"./src/js/functions.js":function(F,m,u){u.r(m),u.d(m,"addWrapper",function(){return v}),u.d(m,"capitalizePrint",function(){return x}),u.d(m,"collectStyles",function(){return h}),u.d(m,"addHeader",function(){return c}),u.d(m,"cleanUp",function(){return $}),u.d(m,"isRawHTML",function(){return P});var y=u("./src/js/modal.js"),e=u("./src/js/browser.js");function g(l){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(_){return typeof _}:g=function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},g(l)}function v(l,z){var _="font-family:"+z.font+" !important; font-size: "+z.font_size+" !important; width:100%;";return'<div style="'+_+'">'+l+"</div>"}function x(l){return l.charAt(0).toUpperCase()+l.slice(1)}function h(l,z){for(var _=document.defaultView||window,j="",C=_.getComputedStyle(l,""),U=0;U<C.length;U++)(z.targetStyles.indexOf("*")!==-1||z.targetStyle.indexOf(C[U])!==-1||o(z.targetStyles,C[U]))&&C.getPropertyValue(C[U])&&(j+=C[U]+":"+C.getPropertyValue(C[U])+";");return j+="max-width: "+z.maxWidth+"px !important; font-size: "+z.font_size+" !important;",j}function o(l,z){for(var _=0;_<l.length;_++)if(g(z)==="object"&&z.indexOf(l[_])!==-1)return!0;return!1}function c(l,z){var _=document.createElement("div");if(P(z.header))_.innerHTML=z.header;else{var j=document.createElement("h1"),C=document.createTextNode(z.header);j.appendChild(C),j.setAttribute("style",z.headerStyle),_.appendChild(j)}l.insertBefore(_,l.childNodes[0])}function $(l){l.showModal&&y.default.close(),l.onLoadingEnd&&l.onLoadingEnd(),(l.showModal||l.onLoadingStart)&&window.URL.revokeObjectURL(l.printable);var z="mouseover";(e.default.isChrome()||e.default.isFirefox())&&(z="focus");var _=function j(){window.removeEventListener(z,j),l.onPrintDialogClose();var C=document.getElementById(l.frameId);C&&C.remove()};window.addEventListener(z,_)}function P(l){var z=new RegExp("<([A-Za-z][A-Za-z0-9]*)\\b[^>]*>(.*?)</\\1>");return z.test(l)}},"./src/js/html.js":function(F,m,u){u.r(m);var y=u("./src/js/functions.js"),e=u("./src/js/print.js");function g(h){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(c){return typeof c}:g=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},g(h)}m.default={print:function(o,c){var $=x(o.printable)?o.printable:document.getElementById(o.printable);if(!$){window.console.error("Invalid HTML element id: "+o.printable);return}o.printableElement=v($,o),o.header&&Object(y.addHeader)(o.printableElement,o),e.default.send(o,c)}};function v(h,o){for(var c=h.cloneNode(),$=Array.prototype.slice.call(h.childNodes),P=0;P<$.length;P++)if(o.ignoreElements.indexOf($[P].id)===-1){var l=v($[P],o);c.appendChild(l)}switch(o.scanStyles&&h.nodeType===1&&c.setAttribute("style",Object(y.collectStyles)(h,o)),h.tagName){case"SELECT":c.value=h.value;break;case"CANVAS":c.getContext("2d").drawImage(h,0,0);break}return c}function x(h){return g(h)==="object"&&h&&(h instanceof HTMLElement||h.nodeType===1)}},"./src/js/image.js":function(F,m,u){u.r(m);var y=u("./src/js/functions.js"),e=u("./src/js/print.js"),g=u("./src/js/browser.js");m.default={print:function(x,h){x.printable.constructor!==Array&&(x.printable=[x.printable]),x.printableElement=document.createElement("div"),x.printable.forEach(function(o){var c=document.createElement("img");if(c.setAttribute("style",x.imageStyle),c.src=o,g.default.isFirefox()){var $=c.src;c.src=$}var P=document.createElement("div");P.appendChild(c),x.printableElement.appendChild(P)}),x.header&&Object(y.addHeader)(x.printableElement,x),e.default.send(x,h)}}},"./src/js/init.js":function(F,m,u){u.r(m);var y=u("./src/js/browser.js"),e=u("./src/js/modal.js"),g=u("./src/js/pdf.js"),v=u("./src/js/html.js"),x=u("./src/js/raw-html.js"),h=u("./src/js/image.js"),o=u("./src/js/json.js");function c(P){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?c=function(z){return typeof z}:c=function(z){return z&&typeof Symbol=="function"&&z.constructor===Symbol&&z!==Symbol.prototype?"symbol":typeof z},c(P)}var $=["pdf","html","image","json","raw-html"];m.default={init:function(){var l={printable:null,fallbackPrintable:null,type:"pdf",header:null,headerStyle:"font-weight: 300;",maxWidth:800,properties:null,gridHeaderStyle:"font-weight: bold; padding: 5px; border: 1px solid #dddddd;",gridStyle:"border: 1px solid lightgray; margin-bottom: -1px;",showModal:!1,onError:function(ye){throw ye},onLoadingStart:null,onLoadingEnd:null,onPrintDialogClose:function(){},onIncompatibleBrowser:function(){},modalMessage:"Retrieving Document...",frameId:"printJS",printableElement:null,documentTitle:"Document",targetStyle:["clear","display","width","min-width","height","min-height","max-height"],targetStyles:["border","box","break","text-decoration"],ignoreElements:[],repeatTableHeader:!0,css:null,style:null,scanStyles:!0,base64:!1,onPdfOpen:null,font:"TimesNewRoman",font_size:"12pt",honorMarginPadding:!0,honorColor:!1,imageStyle:"max-width: 100%;"},z=arguments[0];if(z===void 0)throw new Error("printJS expects at least 1 attribute.");switch(c(z)){case"string":l.printable=encodeURI(z),l.fallbackPrintable=l.printable,l.type=arguments[1]||l.type;break;case"object":l.printable=z.printable,l.fallbackPrintable=typeof z.fallbackPrintable<"u"?z.fallbackPrintable:l.printable,l.fallbackPrintable=l.base64?"data:application/pdf;base64,".concat(l.fallbackPrintable):l.fallbackPrintable;for(var _ in l)_==="printable"||_==="fallbackPrintable"||(l[_]=typeof z[_]<"u"?z[_]:l[_]);break;default:throw new Error('Unexpected argument type! Expected "string" or "object", got '+c(z))}if(!l.printable)throw new Error("Missing printable information.");if(!l.type||typeof l.type!="string"||$.indexOf(l.type.toLowerCase())===-1)throw new Error("Invalid print type. Available types are: pdf, html, image and json.");l.showModal&&e.default.show(l),l.onLoadingStart&&l.onLoadingStart();var j=document.getElementById(l.frameId);j&&j.parentNode.removeChild(j);var C=document.createElement("iframe");switch(y.default.isFirefox()?C.setAttribute("style","width: 1px; height: 100px; position: fixed; left: 0; top: 0; opacity: 0; border-width: 0; margin: 0; padding: 0"):C.setAttribute("style","visibility: hidden; height: 0; width: 0; position: absolute; border: 0"),C.setAttribute("id",l.frameId),l.type!=="pdf"&&(C.srcdoc="<html><head><title>"+l.documentTitle+"</title>",l.css&&(Array.isArray(l.css)||(l.css=[l.css]),l.css.forEach(function(q){C.srcdoc+='<link rel="stylesheet" href="'+q+'">'})),C.srcdoc+="</head><body></body></html>"),l.type){case"pdf":if(y.default.isIE())try{console.info("Print.js doesn't support PDF printing in Internet Explorer.");var U=window.open(l.fallbackPrintable,"_blank");U.focus(),l.onIncompatibleBrowser()}catch(q){l.onError(q)}finally{l.showModal&&e.default.close(),l.onLoadingEnd&&l.onLoadingEnd()}else g.default.print(l,C);break;case"image":h.default.print(l,C);break;case"html":v.default.print(l,C);break;case"raw-html":x.default.print(l,C);break;case"json":o.default.print(l,C);break}}}},"./src/js/json.js":function(F,m,u){u.r(m);var y=u("./src/js/functions.js"),e=u("./src/js/print.js");function g(x){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(o){return typeof o}:g=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},g(x)}m.default={print:function(h,o){if(g(h.printable)!=="object")throw new Error("Invalid javascript data object (JSON).");if(typeof h.repeatTableHeader!="boolean")throw new Error("Invalid value for repeatTableHeader attribute (JSON).");if(!h.properties||!Array.isArray(h.properties))throw new Error("Invalid properties array for your JSON data.");h.properties=h.properties.map(function(c){return{field:g(c)==="object"?c.field:c,displayName:g(c)==="object"?c.displayName:c,columnSize:g(c)==="object"&&c.columnSize?c.columnSize+";":100/h.properties.length+"%;"}}),h.printableElement=document.createElement("div"),h.header&&Object(y.addHeader)(h.printableElement,h),h.printableElement.innerHTML+=v(h),e.default.send(h,o)}};function v(x){var h=x.printable,o=x.properties,c='<table style="border-collapse: collapse; width: 100%;">';x.repeatTableHeader&&(c+="<thead>"),c+="<tr>";for(var $=0;$<o.length;$++)c+='<th style="width:'+o[$].columnSize+";"+x.gridHeaderStyle+'">'+Object(y.capitalizePrint)(o[$].displayName)+"</th>";c+="</tr>",x.repeatTableHeader&&(c+="</thead>"),c+="<tbody>";for(var P=0;P<h.length;P++){c+="<tr>";for(var l=0;l<o.length;l++){var z=h[P],_=o[l].field.split(".");if(_.length>1)for(var j=0;j<_.length;j++)z=z[_[j]];else z=z[o[l].field];c+='<td style="width:'+o[l].columnSize+x.gridStyle+'">'+z+"</td>"}c+="</tr>"}return c+="</tbody></table>",c}},"./src/js/modal.js":function(F,m,u){u.r(m);var y={show:function(g){var v="font-family:sans-serif; display:table; text-align:center; font-weight:300; font-size:30px; left:0; top:0;position:fixed; z-index: 9990;color: #0460B5; width: 100%; height: 100%; background-color:rgba(255,255,255,.9);transition: opacity .3s ease;",x=document.createElement("div");x.setAttribute("style",v),x.setAttribute("id","printJS-Modal");var h=document.createElement("div");h.setAttribute("style","display:table-cell; vertical-align:middle; padding-bottom:100px;");var o=document.createElement("div");o.setAttribute("class","printClose"),o.setAttribute("id","printClose"),h.appendChild(o);var c=document.createElement("span");c.setAttribute("class","printSpinner"),h.appendChild(c);var $=document.createTextNode(g.modalMessage);h.appendChild($),x.appendChild(h),document.getElementsByTagName("body")[0].appendChild(x),document.getElementById("printClose").addEventListener("click",function(){y.close()})},close:function(){var g=document.getElementById("printJS-Modal");g&&g.parentNode.removeChild(g)}};m.default=y},"./src/js/pdf.js":function(F,m,u){u.r(m);var y=u("./src/js/print.js"),e=u("./src/js/functions.js");m.default={print:function(x,h){if(x.base64){var o=Uint8Array.from(atob(x.printable),function($){return $.charCodeAt(0)});g(x,h,o);return}x.printable=/^(blob|http|\/\/)/i.test(x.printable)?x.printable:window.location.origin+(x.printable.charAt(0)!=="/"?"/"+x.printable:x.printable);var c=new window.XMLHttpRequest;c.responseType="arraybuffer",c.addEventListener("error",function(){Object(e.cleanUp)(x),x.onError(c.statusText,c)}),c.addEventListener("load",function(){if([200,201].indexOf(c.status)===-1){Object(e.cleanUp)(x),x.onError(c.statusText,c);return}g(x,h,c.response)}),c.open("GET",x.printable,!0),c.send()}};function g(v,x,h){var o=new window.Blob([h],{type:"application/pdf"});o=window.URL.createObjectURL(o),x.setAttribute("src",o),y.default.send(v,x)}},"./src/js/print.js":function(F,m,u){u.r(m);var y=u("./src/js/browser.js"),e=u("./src/js/functions.js"),g={send:function(c,$){document.getElementsByTagName("body")[0].appendChild($);var P=document.getElementById(c.frameId);P.onload=function(){if(c.type==="pdf"){y.default.isFirefox()?setTimeout(function(){return v(P,c)},1e3):v(P,c);return}var l=P.contentWindow||P.contentDocument;if(l.document&&(l=l.document),l.body.appendChild(c.printableElement),c.type!=="pdf"&&c.style){var z=document.createElement("style");z.innerHTML=c.style,l.head.appendChild(z)}var _=l.getElementsByTagName("img");_.length>0?x(Array.from(_)).then(function(){return v(P,c)}):v(P,c)}}};function v(o,c){try{if(o.focus(),y.default.isEdge()||y.default.isIE())try{o.contentWindow.document.execCommand("print",!1,null)}catch{o.contentWindow.print()}else o.contentWindow.print()}catch($){c.onError($)}finally{y.default.isFirefox()&&(o.style.visibility="hidden",o.style.left="-1px"),Object(e.cleanUp)(c)}}function x(o){var c=o.map(function($){if($.src&&$.src!==window.location.href)return h($)});return Promise.all(c)}function h(o){return new Promise(function(c){var $=function P(){!o||typeof o.naturalWidth>"u"||o.naturalWidth===0||!o.complete?setTimeout(P,500):c()};$()})}m.default=g},"./src/js/raw-html.js":function(F,m,u){u.r(m);var y=u("./src/js/print.js");m.default={print:function(g,v){g.printableElement=document.createElement("div"),g.printableElement.setAttribute("style","width:100%"),g.printableElement.innerHTML=g.printable,y.default.send(g,v)}}},"./src/sass/index.scss":function(F,m,u){},0:function(F,m,u){F.exports=u("./src/index.js")}}).default})}(xt)),xt.exports}var Di=Ui();const Ni=Xn(Di),Bi=async(d,E=`${d} 已复制`)=>{var F,m,u,y,e,g;try{if(!d)return;await Mi(d),E===!0?((F=window.$message)==null||F.destroyAll(),(m=window.$message)==null||m.success("已复制")):E&&((u=window.$message)==null||u.destroyAll(),(y=window.$message)==null||y.success(E))}catch{(e=window.$message)==null||e.destroyAll(),(g=window.$message)==null||g.error("复制失败")}},Mi=async d=>{var E,F;if(navigator.clipboard)await navigator.clipboard.writeText(d);else{const m=document.createElement("textarea");m.textContent=d,m.style.position="absolute",m.style.left="-9999px",document.body.appendChild(m),m.select();try{document.execCommand("copy")||((E=window.$message)==null||E.destroyAll(),(F=window.$message)==null||F.error("当前环境无法复制到剪切板"))}catch(u){throw u}finally{document.body.removeChild(m)}}},qi=["src"],Hi=Ie({name:"OperateDrawer",__name:"operate-drawer",props:kt({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:kt(["submitted"],["update:visible"]),setup(d,{emit:E}){const F=E,m=Qt(),u=d,y=Lt(),e=Le(l()),g=ae(100),v=ae(1),x=ae(0),h=Le([{label:"标准双向寄送",value:0},{label:"仅客户寄回",value:1},{label:"我司先寄双向",value:2},{label:"仅我司寄出",value:3}]),o=[{key:"dbtime",title:"创建时间",align:"center",width:160,fixed:"left"},{key:"comp",title:"客户信息",width:200,fixed:"left",align:"center",ellipsis:{tooltip:!0}},{key:"sn",title:"客户设备信息",width:200,titleAlign:"center",ellipsis:{tooltip:!0},render:r=>{const a=r.sn?r.rsn?r.rsn==r.sn||r.rsn.includes("无")?r.sn:r.sn+'(<span style="color: red; font-weight: bold;">更换</span>)':r.sn:"--";return p("div",{class:"flex flex-col items-start justify-start gap-1"},[p("div",{class:"w-full truncate",title:`设备编号：${r.sn||"--"}`,innerHTML:`设备编号：${a}`}),p("div",{class:"w-full truncate",title:`设备型号：${r.model||"--"}`},`设备型号：${r.model||"--"}`)])}},{key:"project",title:"项目名称",align:"center",width:180,ellipsis:{tooltip:!0}},{key:"fault",title:"故障现象",align:"center",width:120,ellipsis:{tooltip:!0}},{key:"duration",title:"处理时长",align:"center",width:180,ellipsis:{tooltip:!0}},{key:"status",align:"center",width:120,fixed:"right",title:()=>p("div",{class:"flex flex-col items-center justify-center"},[p("span","当前状态"),p("span",{style:"font-size: 11px; color: #FF0000; margin-top: 2px;"},"悬浮查看详情")]),render:r=>{const a=()=>{const{mtype:I,status:L}=r;return I===0?[p(M,{type:L>=0?"success":"default",time:r.dbtime},{default:()=>"待处理"}),p(M,{type:L>=1?"success":"default",time:r.redbtime},{default:()=>["分析中",r.receipt&&p("span",{style:{marginLeft:"5px"}},["(寄出单号: ",p("a",{href:`https://www.kuaidi100.com?nu=${encodeURIComponent(r.receipt)}`,target:"_blank",style:{color:"#4169E1",marginLeft:"5px"}},r.receipt),")"])]}),p(M,{type:L>=2?"success":"default"},{default:()=>"处理中"}),p(M,{type:L>=3?"success":"default"},{default:()=>"待寄回"}),p(M,{type:L>=4?"success":"default"},{default:()=>"待客户收件"}),p(M,{type:L>=5?"success":"default",time:r.rdbtime},{default:()=>["完成",r.returnnum&&p("span",{style:{marginLeft:"5px"}},["(寄出单号: ",p("a",{href:`https://www.kuaidi100.com?nu=${encodeURIComponent(r.returnnum)}`,target:"_blank",style:{color:"#4169E1",marginLeft:"5px"}},r.returnnum),")"])]})]:I===1?[p(M,{type:L>=0?"success":"default",time:r.dbtime},{default:()=>"待处理"}),p(M,{type:L>=1?"success":"default",time:r.return_time||r.complete_time},{default:()=>"完成"})]:I===2?[p(M,{type:L>=0?"success":"default",time:r.dbtime},{default:()=>"待处理"}),p(M,{type:L>=1?"success":"default"},{default:()=>"待客户收件"}),p(M,{type:L>=2?"success":"default"},{default:()=>"待我司收件"}),p(M,{type:L>=3?"success":"default",time:r.return_time||r.complete_time},{default:()=>"完成"})]:I===3?[p(M,{type:L>=0?"success":"default",time:r.dbtime},{default:()=>"待处理"}),p(M,{type:L>=1?"success":"default"},{default:()=>"待客户收件"}),p(M,{type:L>=2?"success":"default",time:r.return_time||r.complete_time},{default:()=>"完成"})]:[p(M,{type:L>=0?"success":"default",time:r.dbtime},{default:()=>"待处理"}),p(M,{type:L>=1?"success":"default",time:r.redbtime},{default:()=>["分析中",r.receipt&&p("span",{style:{marginLeft:"5px"}},["(寄出单号: ",p("a",{href:`https://www.kuaidi100.com?nu=${encodeURIComponent(r.receipt)}`,target:"_blank",style:{color:"#4169E1",marginLeft:"5px"}},r.receipt),")"])]}),p(M,{type:L>=2?"success":"default"},{default:()=>"处理中"}),p(M,{type:L>=3?"success":"default"},{default:()=>"待寄回"}),p(M,{type:L>=4?"success":"default"},{default:()=>"待客户收件"}),p(M,{type:L>=5?"success":"default",time:r.rdbtime},{default:()=>["完成",r.returnnum&&p("span",{style:{marginLeft:"5px"}},["(寄出单号: ",p("a",{href:`https://www.kuaidi100.com?nu=${encodeURIComponent(r.returnnum)}`,target:"_blank",style:{color:"#4169E1",marginLeft:"5px"}},r.returnnum),")"])]})]};return p(sn,{placement:"top",style:{maxWidth:"450px"}},{trigger:()=>p(tt,{type:"primary",style:{cursor:"pointer"}},{default:()=>P(r.mtype,r.status)}),default:()=>p("div",{class:"custom-timeline",style:{padding:"12px"}},[p("p",{style:{marginBottom:"12px",fontWeight:"bold"}},[p("strong",null,"当前状态："),P(r.mtype,r.status)]),p(mn,null,{default:()=>a()})])})}}],c=ae([]);async function $(){try{const r=await Ei({page:1,limit:10,_t:new Date().getTime()});c.value=r.data.list}catch(r){console.log("获取客户网关信息",r)}}const P=(r,a)=>r===0?a===0?"待处理":a===1?"分析中":a===2?"处理中":a===3?"待寄回":a===4?"待客户收件":a===5?"完成":"未知":r===1?a===0?"待处理":a===5?"完成":"未知":r===2?a===0?"待处理":a===1?"待客户收件":a===2?"待我司收件":a===5?"完成":"未知":r===3?a===0?"待处理":a===1?"待客户收件":a===5?"完成":"未知":a===0?"待处理":a===1?"分析中":a===2?"处理中":a===3?"待寄回":a===4?"待客户收件":a===5?"完成":"未知";function l(){return{id:0,sn:"",comp:"",contact:"",contactinfo:"",project:"",fault:"",dock:"",address:`收件人：吴越
手机号：19032214987
地址：浙江杭州市钱塘区6号路中自科技园 领祺科技 (13F幢)4楼`,details:0,accessory:"",receipt:"",rcontact:"",rcontactinfo:"",raddress:"",returnnum:"",re1:"",re2:"",re3:"",re4:"",re5:"",re6:"",re7:"",re8:"",re9:"",re10:"",re11:"",re12:"",rsn:"",rdetails:0,raccessory:"",videoSrc:"",fileList:[],sendFileList:[],receiveFileList:[],uploadVideoFileList:[],analyzeFileList:[],mtype:0}}async function z(){if(e.videoSrc="",e.fileList=[],e.sendFileList=[],e.receiveFileList=[],e.uploadVideoFileList=[],e.analyzeFileList=[],v.value=1,Object.assign(e,l()),await $(),u.operateType==="edit"&&u.rowData)me();else{let r=localStorage.getItem("draftData")?JSON.parse(localStorage.getItem("draftData")):{};JSON.stringify(r)!="{}"&&(v.value=r.currentStep||0,e.fileList=r.fileList||[],e.sendFileList=r.sendFileList||[],e.receiveFileList=r.receiveFileList||[],e.uploadVideoFileList=r.uploadVideoFileList||[],e.analyzeFileList=r.analyzeFileList||[],e.videoSrc=r.videoSrc,Object.assign(e,r))}await se()}const{formRef:_,validate:j,restoreValidation:C}=Ct(),U={sn:{validator:(r,a)=>{if(!a||a.trim().length===0)return new Error("请输入设备编号");const I=Se(a);for(const L of I){if(!L||L.trim().length===0)return new Error("存在空的设备编号，请检查输入");if(L==="null"||L==="undefined")return new Error("存在无效的设备编号，请检查输入");if(L.length<9)return new Error("设备编号长度至少 9 位")}return!0},trigger:["input","blur"]},comp:{type:"string",required:!0,trigger:["blur","change"],message:"请输入贵司名称"},contact:{type:"string",required:!0,trigger:["blur","change"],message:"请输入联系人"},contactinfo:{type:"string",required:!0,pattern:/^(?:\d{3}-\d{8}|\d{4}-\d{7,8}|1[3-9]\d{9})$/,trigger:["blur","change"],message:"请输入正确的联系方式"},project:{type:"string",required:!0,trigger:["blur","change"],message:"请输入项目名称"},fault:{type:"string",required:!0,trigger:["blur","change"],message:"请输入故障现象"},dock:[{type:"string",required:!0,trigger:["blur","change"],message:"请输入对接工程师"},{min:2,trigger:["blur","change"],message:"对接工程师至少输入2个字符"}],rcontact:{type:"string",required:!0,trigger:["blur","change"],message:"请输入联系人"},rcontactinfo:{type:"string",required:!0,pattern:/^(?:\d{3}-\d{8}|\d{4}-\d{7,8}|1[3-9]\d{9})$/,trigger:["blur","change"],message:"请输入正确的联系方式"},raddress:{type:"string",required:!0,trigger:["blur","change"],message:"请输入收件地址"},accessory:{type:"string",required:!1,trigger:["blur","change"],message:"请输入客户寄件配件详情"}},q=we(()=>{if(v.value===1)return{sn:U.sn};if(v.value===2){const r={comp:U.comp,contact:U.contact,contactinfo:U.contactinfo,project:U.project,fault:U.fault,dock:U.dock};return e.mtype===0?(e.details===1?r.accessory={...U.accessory,required:!0}:r.accessory={...U.accessory,required:!1},r.rcontact=U.rcontact,r.rcontactinfo=U.rcontactinfo,r.raddress=U.raddress):e.mtype===1?e.details===1?r.accessory={...U.accessory,required:!0}:r.accessory={...U.accessory,required:!1}:(e.mtype===2||e.mtype===3)&&(r.rcontact=U.rcontact,r.rcontactinfo=U.rcontactinfo,r.raddress=U.raddress),r}return{}}),ye=we(()=>({add:"新增",edit:"修改"})[u.operateType]);async function me(){var I;const{data:r,error:a}=await $i({id:(I=u.rowData)==null?void 0:I.id,_t:new Date().getTime()});a||(Object.assign(e,r),r.re1&&e.fileList.push({id:"0",name:"0",url:r.re1,status:"finished"}),r.re2&&e.fileList.push({id:"1",name:"1",url:r.re2,status:"finished"}),r.re3&&e.fileList.push({id:"2",name:"2",url:r.re2,status:"finished"}),r.re4&&(e.videoSrc=r.re4,e.uploadVideoFileList.push({id:"0",name:"0",url:r.re4,status:"finished"})),r.re5&&e.sendFileList.push({id:"0",name:"0",url:r.re5,status:"finished"}),r.re6&&e.sendFileList.push({id:"1",name:"1",url:r.re6,status:"finished"}),r.re7&&e.sendFileList.push({id:"2",name:"2",url:r.re7,status:"finished"}),r.re8&&e.receiveFileList.push({id:"0",name:"0",url:r.re8,status:"finished"}),r.re9&&e.receiveFileList.push({id:"1",name:"1",url:r.re9,status:"finished"}),r.re10&&e.receiveFileList.push({id:"2",name:"2",url:r.re10,status:"finished"}),r.re11&&e.analyzeFileList.push({id:"0",name:"0",url:r.re11,status:"finished"}),r.re12&&e.analyzeFileList.push({id:"1",name:"1",url:r.re12,status:"finished"}))}const R=we(()=>{if(!e.sn)return[];let r=e.sn.trim();return r===""?[]:(r=r.replace(/，|、/g,","),r[r.length-1]===","&&(r=r.substring(0,r.length-1)),r.split(",").map(a=>a.trim().replace(/\u3000/g,"").trim()).filter(a=>a!==""))}),be=Xt(d,"visible");en(be,()=>{be.value&&(z(),C())});function xe(r){let a=r.replace(/，/g,",").replace(/、/g,",").replace(/　/g," ");const I=Se(a),L=a[a.length-1];if(I.length>=g.value&&L===","){qe(()=>{e.sn=r.substring(0,r.length-1)});return}if(I.length>g.value){const N=I.slice(0,g.value).join(", ");qe(()=>{e.sn=N});return}a!==r&&qe(()=>{e.sn=a})}function Se(r){return r?(r=r.trim(),r===""?[]:r.split(",").map(a=>a.trim().replace(/\u3000/g,"").trim()).filter(a=>a!=="")):[]}function De(){v.value--}async function je(){await j(),v.value===1?$e(()=>{qe(()=>{e.sn&&v.value++})}):(e.rcontact||(e.rcontact=e.contact),e.rcontactinfo||(e.rcontactinfo=e.contactinfo),v.value++)}async function $e(r){let a=[...R.value];if(a.length===0)return;async function I(){var V,ee,J;const L=a.shift();if(!L){r();return}const N=R.value;if(!N.includes(L)){I();return}try{const{data:X,error:ie}=await Oi(L);ie?m.warning({title:"提示",content:`编号 [${L}] ${(J=ie==null?void 0:ie.response)==null?void 0:J.data.data}，是否保留？`,positiveText:"保留",negativeText:"删除",maskClosable:!1,onPositiveClick:()=>{I()},onNegativeClick:()=>{const de=N.filter(ve=>ve!==L);e.sn=de.join(","),I()}}):typeof X=="string"?X==="该编号无任何记录"?m.warning({title:"提示",content:`编号 [${L}] 没有任何记录，是否继续？`,positiveText:"继续",negativeText:"删除",maskClosable:!1,onPositiveClick:()=>{I()},onNegativeClick:()=>{const de=N.filter(ve=>ve!==L);e.sn=de.join(","),I()}}):((V=window.$message)==null||V.destroyAll(),(ee=window.$message)==null||ee.info(`编号 [${L}] ${X}`),I()):(e.id||(e.comp=X.username,e.project=X.company),I())}catch(X){console.log("查询SN失败:",X),m.warning({title:"提示",content:`查询编号 [${L}] 失败，是否保留？`,positiveText:"保留",negativeText:"删除",maskClosable:!1,onPositiveClick:()=>{I()},onNegativeClick:()=>{const ie=N.filter(de=>de!==L);e.sn=ie.join(","),I()}})}}I()}async function se(){let r={_t:new Date().getTime()};ni.get("/companyReceiveaddress.json",{params:r}).then(({data:a})=>{a.username&&a.mobile&&a.address?e.address="收件人："+a.username+`
手机号：`+a.mobile+`
地址：`+a.address:e.address=`收件人：吴越
手机号：19032214987
地址：浙江杭州市钱塘区6号路中自科技园 领祺科技 (13F幢)4楼`}).catch(a=>(console.log("error",a),e.address=`收件人：吴越
手机号：19032214987
地址：浙江杭州市钱塘区6号路中自科技园 领祺科技 (13F幢)4楼`,!1))}function oe(r){var N,V,ee,J;const a=["image/jpeg","image/png","image/jpg","image/x-icon"];console.log("data.file.file",r.file.file);const I=a.includes(r.file.file.type),L=r.file.file.size/1024/1024<100;return I||((N=window.$message)==null||N.destroyAll(),(V=window.$message)==null||V.error("只能上传 JPG/PNG/JPEG/ICO 格式的图片")),L||((ee=window.$message)==null||ee.destroyAll(),(J=window.$message)==null||J.error("上传图片大小不能超过 100MB")),I&&L}async function st(r){var V,ee;const{file:a,onFinish:I,onError:L}=r;new FormData().append("multipartFile",a.file);try{const J=await nt(a.file,a.name,"aftermarket/image");J&&(a.url=J,I({...a,url:J}),(V=window.$message)==null||V.destroyAll(),(ee=window.$message)==null||ee.success("上传成功"))}catch(J){L(J)}}function ge(r){var N,V,ee,J;const a=["video/mp4","video/avi","video/mov","video/mpeg"];console.log("data.file.file",r.file.file);const I=a.includes(r.file.file.type),L=r.file.file.size/1024/1024<100;return I||((N=window.$message)==null||N.destroyAll(),(V=window.$message)==null||V.error("格式错误，请上传视频！")),L||((ee=window.$message)==null||ee.destroyAll(),(J=window.$message)==null||J.error("上传视频大小不能超过 100MB！")),I&&L}async function Ae(r){x.value=0;const{file:a,onFinish:I,onError:L}=r;new FormData().append("multipartFile",a.file);try{const V=await nt(a.file,a.name,"aftermarket/image/",ee=>{x.value=ee});V&&(I({...a,url:V}),e.videoSrc=V,x.value=0)}catch(V){L(V)}}async function Ve(r){var V,ee;const{file:a,onFinish:I,onError:L}=r;new FormData().append("multipartFile",a.file);try{const J=await nt(a.file,a.name,"aftermarket/image");J&&(a.url=J,I({...a,url:J}),(V=window.$message)==null||V.destroyAll(),(ee=window.$message)==null||ee.success("上传成功"))}catch(J){L(J)}}function ot(){var r,a;v.value===1?localStorage.setItem("draftData",JSON.stringify({currentStep:v.value,sn:e.sn,comp:e.comp,contact:e.contact,contactinfo:e.contactinfo,project:e.project,fault:e.fault,dock:e.dock,fileList:e.fileList,videoSrc:e.videoSrc,details:e.details,sendFileList:e.sendFileList,accessory:e.accessory,receipt:e.receipt,rcontact:e.rcontact,rcontactinfo:e.rcontactinfo,raddress:e.raddress,returnnum:e.returnnum,rsn:e.rsn,rdetails:e.rdetails,receiveFileList:e.receiveFileList,uploadVideoFileList:e.uploadVideoFileList,raccessory:e.raccessory,analyzeFileList:e.analyzeFileList,mtype:e.mtype})):localStorage.setItem("draftData",JSON.stringify({currentStep:v.value,sn:e.sn,comp:e.comp,contact:e.contact,contactinfo:e.contactinfo,project:e.project,fault:e.fault,dock:e.dock,fileList:e.fileList,videoSrc:e.videoSrc,details:e.details,sendFileList:e.sendFileList,accessory:e.accessory,receipt:e.receipt,rcontact:e.rcontact,rcontactinfo:e.rcontactinfo,raddress:e.raddress,returnnum:e.returnnum,rsn:e.rsn,rdetails:e.rdetails,receiveFileList:e.receiveFileList,uploadVideoFileList:e.uploadVideoFileList,raccessory:e.raccessory,analyzeFileList:e.analyzeFileList,mtype:e.mtype})),(r=window.$message)==null||r.destroyAll(),(a=window.$message)==null||a.success("草稿已保存")}function Ne(){be.value=!1}function ke(r){return new Promise((a,I)=>{Ve({file:r,onFinish:()=>a(!0),onError:L=>I(L)})})}function dt(r){return new Promise((a,I)=>{Ae({file:r,onFinish:()=>a(!0),onError:L=>I(L)})})}async function ut(){var N,V,ee,J;await j();let r=[],a=[];if(e.details==1&&e.sendFileList.length==0)return(N=window.$message)==null||N.destroyAll(),(V=window.$message)==null||V.warning("客户寄出照片不能为空"),!1;if(e.rdetails==1&&e.receiveFileList.length==0)return(ee=window.$message)==null||ee.destroyAll(),(J=window.$message)==null||J.warning("寄出照片不能为空"),!1;await Promise.all([...e.fileList.map(X=>ke(X)),...e.sendFileList.map(X=>ke(X)),...e.receiveFileList.map(X=>ke(X)),...e.uploadVideoFileList.map(X=>dt(X))]),e.mtype===0?r.push({comp:e.comp,contact:e.contact,contactinfo:e.contactinfo,dock:e.dock,project:e.project,raddress:e.raddress,rcontact:e.rcontact,rcontactinfo:e.rcontactinfo,receipt:e.receipt,mtype:e.mtype,re1:e.sendFileList.length>0?e.sendFileList[0].url:null,re2:e.sendFileList.length>1?e.sendFileList[1].url:null,re3:e.sendFileList.length>2?e.sendFileList[2].url:null,re4:e.receiveFileList.length>0?e.receiveFileList[0].url:null,re5:e.receiveFileList.length>1?e.receiveFileList[1].url:null,re6:e.receiveFileList.length>2?e.receiveFileList[2].url:null}):e.mtype===1?r.push({comp:e.comp,contact:e.contact,contactinfo:e.contactinfo,dock:e.dock,project:e.project,receipt:e.receipt,mtype:e.mtype,re1:e.sendFileList.length>0?e.sendFileList[0].url:null,re2:e.sendFileList.length>1?e.sendFileList[1].url:null,re3:e.sendFileList.length>2?e.sendFileList[2].url:null}):e.mtype===2?r.push({comp:e.comp,contact:e.contact,contactinfo:e.contactinfo,dock:e.dock,project:e.project,raddress:e.raddress,rcontact:e.rcontact,rcontactinfo:e.rcontactinfo,receipt:e.receipt,mtype:e.mtype,re1:e.sendFileList.length>0?e.sendFileList[0].url:null,re2:e.sendFileList.length>1?e.sendFileList[1].url:null,re3:e.sendFileList.length>2?e.sendFileList[2].url:null,re4:e.receiveFileList.length>0?e.receiveFileList[0].url:null,re5:e.receiveFileList.length>1?e.receiveFileList[1].url:null,re6:e.receiveFileList.length>2?e.receiveFileList[2].url:null}):e.mtype===3&&r.push({comp:e.comp,contact:e.contact,contactinfo:e.contactinfo,dock:e.dock,project:e.project,raddress:e.raddress,rcontact:e.rcontact,rcontactinfo:e.rcontactinfo,receipt:e.receipt,mtype:e.mtype,re4:e.receiveFileList.length>0?e.receiveFileList[0].url:null,re5:e.receiveFileList.length>1?e.receiveFileList[1].url:null,re6:e.receiveFileList.length>2?e.receiveFileList[2].url:null});let I=R.value;if(e.mtype!=3&&!e.receipt)m.warning({title:"提示",content:"快递单号未填写，是否继续？",positiveText:"确定",negativeText:"取消",maskClosable:!1,onPositiveClick:async()=>{const{data:X,error:ie}=await Bt(y.userInfo.id?Number(y.userInfo.id):0,r);if(!ie){let ve=JSON.parse(X).uuid;for(var de=0;de<I.length;de++)a.push({sn:I[de],details:e.details,accessory:e.accessory,fault:e.fault,re1:e.fileList.length>0?e.fileList[0].url:null,re2:e.fileList.length>1?e.fileList[1].url:null,re3:e.fileList.length>2?e.fileList[2].url:null,re4:e.videoSrc||null});const{data:_e,error:Fe}=await Mt(a,ve);Fe||(localStorage.removeItem("draftData"),Ne(),F("submitted"))}},onNegativeClick:()=>{}});else{const{data:X,error:ie}=await Bt(y.userInfo.id?Number(y.userInfo.id):0,r);if(!ie){let de=JSON.parse(X).uuid;for(var L=0;L<I.length;L++)e.mtype===0?a.push({sn:I[L],details:e.details,accessory:e.accessory,fault:e.fault,re1:e.fileList.length>0?e.fileList[0].url:null,re2:e.fileList.length>1?e.fileList[1].url:null,re3:e.fileList.length>2?e.fileList[2].url:null,re4:e.videoSrc||null}):e.mtype===1?a.push({sn:I[L],details:e.details,accessory:e.accessory,fault:e.fault,re1:e.fileList.length>0?e.fileList[0].url:null,re2:e.fileList.length>1?e.fileList[1].url:null,re3:e.fileList.length>2?e.fileList[2].url:null,re4:e.videoSrc||null}):e.mtype===2?a.push({sn:I[L],details:e.details,accessory:e.accessory,fault:e.fault,re1:e.fileList.length>0?e.fileList[0].url:null,re2:e.fileList.length>1?e.fileList[1].url:null,re3:e.fileList.length>2?e.fileList[2].url:null,re4:e.videoSrc||null}):e.mtype===3&&a.push({sn:I[L],details:e.details,fault:e.fault,returnnum:e.returnnum,rsn:e.rsn,rdetails:e.rdetails,raccessory:e.raccessory,re1:e.fileList.length>0?e.fileList[0].url:null,re2:e.fileList.length>1?e.fileList[1].url:null,re3:e.fileList.length>2?e.fileList[2].url:null,re4:e.videoSrc||null});const{data:ve,error:_e}=await Mt(a,de);_e||(localStorage.removeItem("draftData"),Ne(),F("submitted"))}}}return(r,a)=>{const I=Li,L=xi,N=Et,V=tn,ee=St,J=nn,X=ti,ie=rn,de=Ft,ve=ln,_e=zt,Fe=ei,We=_t,Ke=an;return T(),D(Ke,{show:be.value,"onUpdate:show":a[19]||(a[19]=O=>be.value=O),title:ye.value,preset:"card",class:"w-85%"},{footer:s(()=>[n(de,{justify:"end",size:16,class:"pr-20px"},{default:s(()=>[n(f(A),{onClick:Ne},{default:s(()=>[S(Y(f(Q)("common.cancel")),1)]),_:1}),v.value!==1?(T(),D(f(A),{key:0,type:"primary",onClick:De},{default:s(()=>a[26]||(a[26]=[S(Y("上一步"))])),_:1,__:[26]})):B("",!0),v.value!==1?(T(),D(f(A),{key:1,type:"primary",onClick:ot},{default:s(()=>a[27]||(a[27]=[S(Y("存为草稿"))])),_:1,__:[27]})):B("",!0),v.value===1?(T(),D(f(A),{key:2,type:"primary",onClick:je},{default:s(()=>a[28]||(a[28]=[S(Y("下一步"))])),_:1,__:[28]})):B("",!0),v.value===2?(T(),D(f(A),{key:3,type:"primary",onClick:ut},{default:s(()=>[S(Y(f(Q)("common.confirm")),1)]),_:1})):B("",!0)]),_:1})]),default:s(()=>[n(L,{current:v.value},{default:s(()=>[n(I,{title:"步骤一"}),n(I,{title:"步骤二"})]),_:1},8,["current"]),a[29]||(a[29]=wt("div",{style:{"margin-top":"30px"}},null,-1)),n(We,{ref_key:"formRef",ref:_,model:e,rules:q.value,"label-placement":"left","label-width":140},{default:s(()=>[n(Fe,{style:{"max-height":"600px"},class:"pr-20px"},{default:s(()=>[n(_e,{responsive:"screen","item-responsive":""},{default:s(()=>[v.value===1?(T(),D(N,{key:0,span:"24 m:24 s:24",label:"设备编号",path:"sn"},{default:s(()=>[n(f(pe),{clearable:"",type:"textarea",value:e.sn,"onUpdate:value":a[0]||(a[0]=O=>e.sn=O),placeholder:"请输入设备编号",disabled:r.operateType==="edit",onInput:xe},null,8,["value","disabled"])]),_:1})):B("",!0),v.value===1?(T(),D(N,{key:1,span:"24 m:24 s:24",label:"最近售后记录",path:"comp"},{default:s(()=>[n(V,{columns:o,data:c.value,size:"small",remote:"","max-height":400,"row-key":O=>O.id,class:"sm:h-full",striped:""},null,8,["data","row-key"])]),_:1})):B("",!0),v.value===2?(T(),D(N,{key:2,span:"24 m:12 s:12",label:"贵司名称",path:"comp"},{default:s(()=>[n(f(pe),{value:e.comp,"onUpdate:value":a[1]||(a[1]=O=>e.comp=O),placeholder:"请输入贵司名称"},null,8,["value"])]),_:1})):B("",!0),v.value===2?(T(),D(N,{key:3,span:"24 m:12 s:12",label:"联系人",path:"contact"},{default:s(()=>[n(f(pe),{value:e.contact,"onUpdate:value":a[2]||(a[2]=O=>e.contact=O),placeholder:"请输入联系人",clearable:""},null,8,["value"])]),_:1})):B("",!0),v.value===2?(T(),D(N,{key:4,span:"24 m:12 s:12",label:"联系方式",path:"contactinfo"},{default:s(()=>[n(f(pe),{value:e.contactinfo,"onUpdate:value":a[3]||(a[3]=O=>e.contactinfo=O),placeholder:"请输入联系方式",clearable:""},null,8,["value"])]),_:1})):B("",!0),v.value===2?(T(),D(N,{key:5,span:"24 m:12 s:12",label:"项目名称",path:"project"},{default:s(()=>[n(f(pe),{value:e.project,"onUpdate:value":a[4]||(a[4]=O=>e.project=O),placeholder:"请输入项目名称",clearable:""},null,8,["value"])]),_:1})):B("",!0),v.value===2?(T(),D(N,{key:6,span:"24 m:12 s:12",label:"售后类型",path:"mtype"},{default:s(()=>[n(ee,{filterable:"",value:e.mtype,"onUpdate:value":a[5]||(a[5]=O=>e.mtype=O),placeholder:"请选择售后类型","label-field":"label","value-field":"value",options:h},null,8,["value","options"])]),_:1})):B("",!0),v.value===2?(T(),D(N,{key:7,span:"24 m:24 s:24",label:"故障现象",path:"fault"},{default:s(()=>[n(f(pe),{type:"textarea",value:e.fault,"onUpdate:value":a[6]||(a[6]=O=>e.fault=O),placeholder:"请输入故障现象",clearable:""},null,8,["value"])]),_:1})):B("",!0),v.value===2?(T(),D(N,{key:8,span:"24 m:24 s:24",label:"对接工程师",path:"dock"},{default:s(()=>[n(f(pe),{value:e.dock,"onUpdate:value":a[7]||(a[7]=O=>e.dock=O),placeholder:"请输入对接的厂家工程师, 例如胡工",clearable:""},null,8,["value"])]),_:1})):B("",!0),v.value===2?(T(),D(N,{key:9,span:"24 m:24 s:24",label:"现场照片"},{default:s(()=>[n(J,{multiple:"",max:3,"file-list":e.fileList,"onUpdate:fileList":a[8]||(a[8]=O=>e.fileList=O),"list-type":"image-card","default-upload":!1,onBeforeUpload:oe,"custom-request":st},{default:s(()=>a[20]||(a[20]=[S(" 点击上传 ")])),_:1,__:[20]},8,["file-list"])]),_:1})):B("",!0),v.value===2?(T(),D(N,{key:10,span:"24 m:24 s:24",label:"现场视频"},{default:s(()=>[n(J,{"show-file-list":!e.videoSrc,"file-list":e.uploadVideoFileList,"onUpdate:fileList":a[9]||(a[9]=O=>e.uploadVideoFileList=O),"default-upload":!1,onBeforeUpload:ge,"custom-request":Ae},{default:s(()=>[n(f(A),{type:"primary"},{default:s(()=>a[21]||(a[21]=[S(" 上传视频 ")])),_:1,__:[21]})]),_:1},8,["show-file-list","file-list"])]),_:1})):B("",!0),v.value===2?(T(),D(N,{key:11,span:"24 m:24 s:24",label:"","label-width":"0"},{default:s(()=>[x.value&&!e.videoSrc?(T(),D(X,{key:0,type:"line",percentage:x.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):B("",!0),e.videoSrc?(T(),at("video",{key:1,src:e.videoSrc,autoplay:"",style:{width:"100%"}},null,8,qi)):B("",!0)]),_:1})):B("",!0),v.value===2&&e.mtype!==3?(T(),D(N,{key:12,span:"24 m:24 s:24",label:"客户寄件类型"},{default:s(()=>[n(ve,{value:e.details,"onUpdate:value":a[10]||(a[10]=O=>e.details=O),name:"radiogroup"},{default:s(()=>[n(de,null,{default:s(()=>[n(ie,{value:0},{default:s(()=>a[22]||(a[22]=[S("仅裸机")])),_:1,__:[22]}),n(ie,{value:1},{default:s(()=>a[23]||(a[23]=[S("含配件")])),_:1,__:[23]})]),_:1})]),_:1},8,["value"])]),_:1})):B("",!0),v.value===2&&e.mtype!==3?(T(),D(N,{key:13,span:"24 m:24 s:24",label:"我司收件信息"},{default:s(()=>[n(de,{justify:"space-between",align:"center"},{default:s(()=>[n(f(pe),{clearable:"",type:"textarea",value:e.address,"onUpdate:value":a[11]||(a[11]=O=>e.address=O),placeholder:"请输入我司收件信息",disabled:"",style:{width:"calc(100vw - 600px)"}},null,8,["value"]),n(f(A),{type:"primary",onClick:a[12]||(a[12]=O=>e.address&&f(Bi)(e.address,f(Q)("page.common.copySuccess")))},{default:s(()=>a[24]||(a[24]=[S("复制 ")])),_:1,__:[24]})]),_:1})]),_:1})):B("",!0),v.value===2&&e.mtype!==3?(T(),D(N,{key:14,span:"24 m:24 s:24",label:"客户寄出照片"},{default:s(()=>[n(J,{multiple:"",max:3,"file-list":e.sendFileList,"onUpdate:fileList":a[13]||(a[13]=O=>e.sendFileList=O),"list-type":"image-card","default-upload":!1,onBeforeUpload:oe,"custom-request":Ve},{default:s(()=>a[25]||(a[25]=[S(" 点击上传 ")])),_:1,__:[25]},8,["file-list"])]),_:1})):B("",!0),v.value===2&&e.details==1&&e.mtype!==3?(T(),D(N,{key:15,span:"24 m:24 s:24",label:"客户寄件配件详情",path:"accessory"},{default:s(()=>[n(f(pe),{value:e.accessory,"onUpdate:value":a[14]||(a[14]=O=>e.accessory=O),placeholder:"请输入客户寄件配件详情",clearable:""},null,8,["value"])]),_:1})):B("",!0),v.value===2&&e.mtype!==3?(T(),D(N,{key:16,span:"24 m:24 s:24",label:"客户寄出信息",path:"receipt"},{default:s(()=>[n(f(pe),{value:e.receipt,"onUpdate:value":a[15]||(a[15]=O=>e.receipt=O),placeholder:"请输入客户寄出信息",clearable:""},null,8,["value"])]),_:1})):B("",!0),v.value===2&&e.mtype!==1?(T(),D(N,{key:17,span:"24 m:24 s:24",label:"* 您的收件信息(售后完成时的回寄地址)","label-width":"100%","label-style":"font-size: 1.17em; font-weight: bolder;"})):B("",!0),v.value===2&&e.mtype!==1?(T(),D(N,{key:18,span:"24 m:12 s:12",label:"联系人",path:"rcontact"},{default:s(()=>[n(f(pe),{value:e.rcontact,"onUpdate:value":a[16]||(a[16]=O=>e.rcontact=O),placeholder:"请输入联系人",clearable:""},null,8,["value"])]),_:1})):B("",!0),v.value===2&&e.mtype!==1?(T(),D(N,{key:19,span:"24 m:12 s:12",label:"联系方式",path:"rcontactinfo"},{default:s(()=>[n(f(pe),{value:e.rcontactinfo,"onUpdate:value":a[17]||(a[17]=O=>e.rcontactinfo=O),placeholder:"请输入联系方式",clearable:""},null,8,["value"])]),_:1})):B("",!0),v.value===2&&e.mtype!==1?(T(),D(N,{key:20,span:"24 m:12 s:12",label:"收件地址",path:"raddress"},{default:s(()=>[n(f(pe),{value:e.raddress,"onUpdate:value":a[18]||(a[18]=O=>e.raddress=O),placeholder:"请输入收件地址",clearable:""},null,8,["value"])]),_:1})):B("",!0)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1,__:[29]},8,["show","title"])}}}),Vi={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"};function Wi(d,E){return T(),at("svg",Vi,E[0]||(E[0]=[wt("path",{fill:"currentColor",d:"M8.616 20q-.667 0-1.141-.475T7 18.386V16H5.192q-.666 0-1.14-.475t-.475-1.14v-3.77q0-.85.577-1.424q.577-.576 1.423-.576h12.846q.85 0 1.425.576t.575 1.424v3.77q0 .666-.474 1.14T18.808 16H17v2.385q0 .666-.475 1.14t-1.14.475zm-3.424-5H7q.039-.633.502-1.086q.463-.452 1.114-.452h6.769q.65 0 1.113.453q.463.452.502 1.085h1.808q.269 0 .442-.173t.173-.442v-3.77q0-.424-.287-.712t-.713-.288H5.577q-.425 0-.712.288t-.288.713v3.769q0 .269.173.442t.442.173M16 8.616V6.23q0-.27-.173-.442q-.173-.173-.442-.173h-6.77q-.269 0-.442.173T8 6.23v2.385H7V6.23q0-.666.475-1.141q.474-.475 1.14-.475h6.77q.666 0 1.14.475q.475.475.475 1.14v2.386zm1.616 3.5q.425 0 .712-.288t.288-.712t-.288-.713t-.712-.288t-.713.288t-.287.713t.287.712t.713.288M16 18.384v-3.307q0-.27-.173-.443t-.442-.173h-6.77q-.269 0-.442.173q-.173.174-.173.443v3.308q0 .269.173.442t.443.173h6.769q.269 0 .442-.173t.173-.443M5.192 9.616h-.615h14.846z"},null,-1)]))}const Ki=ii({name:"material-symbols-light-print-outline-rounded",render:Wi}),Gi={key:0,style:{display:"flex",gap:"0 10px"}},Ji=Ie({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:kt(["reset","search","printDataList"],["update:model"]),setup(d,{emit:E}){const F=E,m=Lt(),{formRef:u,restoreValidation:y}=Ct(),e=Xt(d,"model"),g=ae([{label:"待完善",value:0},{label:"待审核",value:1},{label:"审核通过",value:2},{label:"进行中",value:3},{label:"完成",value:4}]),v=Le([{label:"标准双向寄送",value:0},{label:"仅客户寄回",value:1},{label:"我司先寄双向",value:2},{label:"仅我司寄出",value:3}]);function x(){e.value.cname="",P()}function h(){e.value.pname="",P()}function o(_){console.log("val",_),_===0?g.value=[{label:"待完善",value:0},{label:"待审核",value:1},{label:"审核通过",value:2},{label:"进行中",value:3},{label:"完成",value:4}]:_===1?g.value=[{label:"待完善",value:0},{label:"待审核",value:1},{label:"审核通过",value:4}]:_===2?g.value=[{label:"待审核",value:0},{label:"审核通过",value:1},{label:"进行中",value:3},{label:"完成",value:4}]:_===3?g.value=[{label:"待审核",value:0},{label:"审核通过",value:1},{label:"进行中",value:3},{label:"完成",value:4}]:(e.value.status=null,g.value=[{label:"待完善",value:0},{label:"待审核",value:1},{label:"审核通过",value:2},{label:"进行中",value:3},{label:"完成",value:4}]),e.value.status!==null&&g.value.findIndex(C=>{C.value,e.value.status})===-1&&(e.value.status=null),P()}function c(){e.value.sn="",P()}async function $(){await y(),F("reset")}async function P(){var _,j;if(!le("aftermarket:select:permission.do")){(_=window.$message)==null||_.destroyAll(),(j=window.$message)==null||j.warning("暂无查询权限权限，请联系管理员");return}e.value.page=1,F("search")}function l(_,j){console.log("value",_),e.value.uid=null,e.value.dbtime=null,e.value.checkboxList.includes("me")&&(e.value.uid=Number(m.userInfo.id)),e.value.checkboxList.includes("handle")&&(e.value.dbtime=new Date(new Date().getTime()).toISOString().split("T")[0]),P()}async function z(){F("printDataList")}return(_,j)=>{const C=pe,U=Et,q=St,ye=dn,me=Ft,R=on,be=Wt,xe=A,Se=Ki,De=Vt,je=zt,$e=_t,se=un;return T(),D(se,{bordered:!1,size:"small",class:"card-wrapper"},{default:s(()=>[n($e,{ref_key:"formRef",ref:u,model:e.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:li(P,["enter"])},{default:s(()=>[n(je,{responsive:"screen","item-responsive":"","x-gap":16,"y-gap":16},{default:s(()=>[n(U,{span:"24 s:12 m:6",label:"客户名称",path:"cname"},{default:s(()=>[n(C,{clearable:"",value:e.value.cname,"onUpdate:value":j[0]||(j[0]=oe=>e.value.cname=oe),placeholder:"请输入客户名称",onClear:x},null,8,["value"])]),_:1}),n(U,{span:"24 s:12 m:6",label:"项目名称",path:"pname"},{default:s(()=>[n(C,{clearable:"",value:e.value.pname,"onUpdate:value":j[1]||(j[1]=oe=>e.value.pname=oe),placeholder:"请输入项目名称",onClear:h},null,8,["value"])]),_:1}),n(U,{span:"24 s:12 m:6",label:"设备编号",path:"sn"},{default:s(()=>[n(C,{clearable:"",value:e.value.sn,"onUpdate:value":j[2]||(j[2]=oe=>e.value.sn=oe),placeholder:"请输入设备编号",onClear:c},null,8,["value"])]),_:1}),n(U,{span:"24 s:12 m:6",label:"售后类型",path:"mtype"},{default:s(()=>[n(q,{clearable:"",filterable:"",value:e.value.mtype,"onUpdate:value":[j[3]||(j[3]=oe=>e.value.mtype=oe),o],placeholder:"请选择售后类型","label-field":"label","value-field":"value",options:v},null,8,["value","options"])]),_:1}),e.value.mtype!==null?(T(),D(U,{key:0,span:"24 s:12 m:6",label:"状态",path:"status"},{default:s(()=>[n(q,{clearable:"",filterable:"",value:e.value.status,"onUpdate:value":[j[4]||(j[4]=oe=>e.value.status=oe),P],placeholder:"请选择状态","label-field":"label","value-field":"value",options:g.value},null,8,["value","options"])]),_:1})):B("",!0),n(U,{span:e.value.mtype!==null?"24 s:24 m:18":"24 s:24 m:24",label:"快速筛选"},{default:s(()=>[n(me,{class:"w-full",justify:"space-between"},{default:s(()=>[n(R,{value:e.value.checkboxList,"onUpdate:value":[j[5]||(j[5]=oe=>e.value.checkboxList=oe),l]},{default:s(()=>[n(me,{"item-style":"display: flex;"},{default:s(()=>[n(ye,{value:"me",label:"与我相关"}),n(ye,{value:"handle",label:"近7日待处理"})]),_:1})]),_:1},8,["value"]),f(le)("aftermarket:select:permission.do")?(T(),at("div",Gi,[f(le)("aftermarket:select:permission.do")?(T(),D(xe,{key:0,ghost:"",onClick:P},{icon:s(()=>[n(be,{class:"text-icon"})]),default:s(()=>[j[6]||(j[6]=S(" "+Y("查询")))]),_:1,__:[6]})):B("",!0),f(le)("aftermarket:select:permission.do")?(T(),D(xe,{key:1,type:"primary",onClick:z},{icon:s(()=>[n(Se,{class:"text-icon"})]),default:s(()=>[j[7]||(j[7]=S(" "+Y("打印")))]),_:1,__:[7]})):B("",!0),f(le)("aftermarket:select:permission.do")?(T(),D(xe,{key:2,onClick:$},{icon:s(()=>[n(De,{class:"text-icon"})]),default:s(()=>[j[8]||(j[8]=S(" "+Y("刷新")))]),_:1,__:[8]})):B("",!0)])):B("",!0)]),_:1})]),_:1},8,["span"])]),_:1})]),_:1},8,["model"])]),_:1})}}}),Zi=cn(Ji,[["__scopeId","data-v-68931b3e"]]);function Ht(d){const E={SF:/^\d{12}$|^[A-Za-z]\d{12}$/,ZTO:/^\d{12}$/,STO:/^\d{12}$/,YTO:/^\d{10,12}$/,YD:/^\d{13}$/,EMS:/^[A-Z]{2}\d{9}[A-Z]{2}$/,COMMON:/^[A-Za-z0-9]{8,20}$/};d=d.trim();for(let F in E)if(E[F].test(d))return!0;return!1}const Yi={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function Me(d){return typeof d=="function"||Object.prototype.toString.call(d)==="[object Object]"&&!pi(d)}const Qi=Ie({name:"aftersales",__name:"index",setup(d){const E=ri(),F=Lt();Qt();const m=ai(),u=ae(!1),y=ae(0),e=ae([]),{formRef:g}=Ct(),v=Le([{label:"待处理",value:1},{label:"分析中",value:2},{label:"处理中",value:3},{label:"待厂家发出",value:4}]),x=ae(null),h=ae(!1),o=Le({id:0,type:"",returnOrder:"",returnOrderType:1,rsn:"",rdetails:0,raccessory:""}),c={rsn:{required:!1,trigger:["blur","change"],message:"请输入寄出设备编号"},raccessory:{required:!1,trigger:["blur","change"],message:""}},$=we(()=>{const t={};return o.type==="receipt"&&(t.returnOrder={...c.rsn,message:o.type==="receipt"?"请输入客户寄出信息":"请输入寄出信息"}),o.type==="returnnum"?t.rsn=[{...c.rsn,required:!0},{min:9,trigger:["blur","change"],message:"寄出设备编号长度至少 9 位"}]:t.raccessory={...c.raccessory,required:!1},o.rdetails===1?t.raccessory={...c.raccessory,required:!0,message:o.type==="returnnum"?"请输出寄出配件详情":"请输入寄件配件详情"}:t.raccessory={...c.raccessory,required:!1,message:o.type==="returnnum"?"请输出寄出配件详情":"请输入寄件配件详情"},t}),P=ae(!1),l=Le({id:0,type:"",sendFileList:[],receiveFileList:[],analyzeFileList:[]}),z=ae(!1),_=Le({id:0,type:"",notes:""}),j=ae(!1),C=Le({id:[],type:"",password:""}),U=ae(!1),q=Le({cid:0,mtype:0,status:void 0,customername:"",gwsn:"",model:void 0,checkboxList:[]}),ye=ae(!1),me=ae(!1),R=Le({id:0,uid:0,aid:0,type:"add",username:"",sn:"",reason:"",resolution:"",improvement:""}),be=ae(""),xe=ae(!1),Se=Le({aid:null,uid:null,sn:""}),{columns:De,columnChecks:je,data:$e,getData:se,loading:oe,mobilePagination:st,searchParams:ge}=gt({showTotal:!0,immediate:!1,apiFn:Si,apiParams:{page:1,pageSize:20,limit:20,cname:null,pname:null,sn:null,status:null,uid:null,dbtime:null,mtype:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48,fixed:"left"},{key:"dbtime",title:"创建时间",align:"center",width:100,fixed:"left",render:t=>n("div",{class:"flex flex-col items-start justify-start gap-1"},[n("div",{class:"w-full truncate"},[t.dbtime.substring(0,10)]),n("div",{class:"w-full truncate"},[t.dbtime.substr(11)])])},{key:"comp",title:"客户信息",width:200,fixed:"left",titleAlign:"center",ellipsis:{tooltip:!0},render:t=>n("div",{class:"flex flex-col items-start justify-start gap-1"},[n("div",{class:"w-full truncate",title:`公司名称：${t.comp}`},[S("公司名称："),t.comp]),n("div",{class:"w-full truncate",title:`联系人：${t.contact}`},[S("联系人："),t.contact]),n("div",{class:"w-full truncate",title:`联系方式：${t.contactinfo}`},[S("联系方式："),t.contactinfo])])},{key:"receipt",title:"客户寄出信息",align:"center",width:220,titleAlign:"center",ellipsis:{tooltip:!0},render:t=>n("div",{class:"flex flex-col items-start justify-start gap-1"},[t.mtype!==3&&t.receipt&&n("div",{class:"flex items-center gap-4px"},[Ht(t.receipt)?n("a",{href:`https://www.kuaidi100.com?nu=${encodeURIComponent(t.receipt)}`,target:"_blank",style:"color: #4169E1;"},[t.receipt||"--"]):n("span",null,[t.receipt||"--"]),n(Xe,{trigger:"hover",placement:"right"},{trigger:()=>te(n(A,{text:!0,type:"primary",onClick:()=>Ge(t.id,t,"receipt")},{default:()=>[n("span",{class:"akar-icons--edit"},null)]}),[[ne("no-auth"),"aftermarket:update:permission.do"]]),default:()=>Q("common.update")})]),t.mtype!==3&&t.receipt&&n("div",null,[`时间：${t.redbtime||""}`]),t.mtype!==3&&!t.receipt&&te(n(A,{text:!0,type:"primary",onClick:()=>Ge(t.id,null,"receipt")},{default:()=>["填写"]}),[[ne("no-auth"),"aftermarket:update:permission.do"]]),t.mtype===3&&!t.receipt&&n("span",null,["无",S(" ")])])},{key:"afterMarketPojoList",title:"售后信息",align:"center",width:300,titleAlign:"center",ellipsis:{tooltip:!0},render:t=>n("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-around"}},[t.afterMarketPojoList.length>5?n("div",{style:{marginRight:"20px"}},[n(Xe,{placement:"right",trigger:"hover"},{trigger:()=>n("div",null,[n("span",{style:{fontWeight:"bolder"}},[`总数量: ${t.afterMarketPojoList.length}个`]),t.afterMarketPojoList.slice(0,5).map((i,b)=>n("div",{key:b,style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},[n("span",null,[i.sn]),n("span",{style:{marginLeft:"5px"}},[O(t.mtype,i.status)])]))]),default:()=>n("div",{innerHTML:yn(t.mtype,t.afterMarketPojoList)},null)})]):n("div",{style:{marginRight:"20px"}},[n("span",{style:{fontWeight:"bolder"}},[`总数量: ${t.afterMarketPojoList.length}个`]),t.afterMarketPojoList.map((i,b)=>n("div",{key:b,style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},[i.sn?n("span",null,[i.sn]):n("span",{style:{color:"#f00"}},[S("设备信息为空")]),n("span",{style:{marginLeft:"5px"}},[O(t.mtype,i.status)])]))]),t.afterMarketPojoList.length>0?te(n(A,{text:!0,type:"primary",size:"small",onClick:()=>Sn(t)},{default:()=>[S("查看")]}),[[ne("no-auth"),"aftermarket:select:permission.do"]]):null])},{key:"project",title:"项目名称",align:"center",width:180,ellipsis:{tooltip:!0}},{key:"dock",title:"对接工程师",align:"center",width:120},{key:"rcontact",title:"客户收件信息",width:200,titleAlign:"center",ellipsis:{tooltip:!0},render:t=>t.mtype!==1&&n("div",{class:"flex flex-col items-start justify-start gap-1"},[n("div",{class:"w-full truncate",title:`联系人：${t.rcontact}`},[S("联系人："),t.rcontact]),n("div",{class:"w-full truncate",title:`联系方式：${t.rcontactinfo}`},[S("联系方式："),t.rcontactinfo]),n("div",{class:"w-full truncate",title:`地址：${t.raddress}`},[S("地址："),t.raddress])])},{key:"re1",title:"客户寄出照片",align:"center",width:300,render:t=>n("div",{class:"flex items-center justify-center gap-4px"},[t.mtype!==3&&(t.re1||t.re2||t.re3)?n("div",{style:{cursor:"pointer"},onClick:()=>Ye([t.re1,t.re2,t.re3].filter(i=>i),0)},[n(et,{width:70,src:t.re1||t.re2||t.re3,previewDisabled:!0,style:{maxHeight:"70px",cursor:"pointer"}},null)]):null,n("div",null,[t.mtype!==3&&!t.re1&&!t.re2&&!t.re3&&te(n(A,{size:"small",type:"primary",onClick:()=>Te(t,"customer")},{default:()=>[S("点击上传")]}),[[ne("no-auth"),"aftermarket:update:permission.do"]]),t.mtype!==3&&(t.re1||t.re2||t.re3)&&te(n(A,{size:"small",type:"primary",onClick:()=>Te(t,"customer"),style:{marginLeft:"5px"}},{default:()=>[S("编辑图片")]}),[[ne("no-auth"),"aftermarket:update:permission.do"]])])])},{key:"re8",title:"厂家寄出照片",align:"center",width:300,render:t=>n("div",{class:"flex items-center justify-center gap-4px"},[t.mtype!==1&&(t.re8||t.re4||t.re5||t.re6)?n("div",{style:{cursor:"pointer"},onClick:()=>Ye([t.re8,t.re4,t.re5||t.re6].filter(i=>i),0)},[n(et,{width:70,src:t.re8||t.re4||t.re5||t.re6,previewDisabled:!0,style:{maxHeight:"70px",cursor:"pointer"}},null)]):null,n("div",null,[t.mtype!==1&&!t.re8&&!t.re4&&!t.re5&&!t.re6&&te(n(A,{size:"small",type:"primary",onClick:()=>Te(t,"company")},{default:()=>[S("点击上传")]}),[[ne("no-auth"),"aftermarket:update:permission.do"]]),t.mtype!==1&&(t.re8||t.re4||t.re5||t.re6)&&te(n(A,{size:"small",type:"primary",onClick:()=>Te(t,"company"),style:{marginLeft:"5px"}},{default:()=>[S("编辑图片")]}),[[ne("no-auth"),"aftermarket:update:permission.do"]])])])},{key:"notes",title:"备注",align:"center",width:180,ellipsis:{tooltip:!0},render:t=>n("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-around"}},[t.notes?n(ci,null,[n("div",{class:"w-full truncate",title:`${t.notes}`},[t.notes]),n(Xe,{trigger:"hover",placement:"right"},{trigger:()=>te(n(A,{text:!0,type:"primary",onClick:()=>Ze(t.id,t.notes,"comp")},{default:()=>[n("span",{class:"akar-icons--edit"},null)]}),[[ne("no-auth"),"aftermarket:update:permission.do"]]),default:()=>Q("common.update")})]):te(n(A,{text:!0,type:"primary",size:"small",onClick:()=>Ze(t.id,"","comp")},{default:()=>[S("填写")]}),[[ne("no-auth"),"aftermarket:update:permission.do"]])])},{key:"ckusername",title:"审核人",align:"center",width:120,ellipsis:{tooltip:!0}},{key:"ckdbtime",title:"审核时间",align:"center",width:100,ellipsis:{tooltip:!0},render:t=>t.ckdbtime?n("div",{class:"flex flex-col items-start justify-start gap-1"},[n("div",{class:"w-full truncate"},[t.ckdbtime.substring(0,10)]),n("div",{class:"w-full truncate"},[t.ckdbtime.substr(11)])]):null},{key:"mtype",title:"售后类型",align:"center",width:120,fixed:"right",render:t=>{let i;return n(tt,{type:"primary"},Me(i=We(t.mtype))?i:{default:()=>[i]})}},{key:"status",title:"当前状态",align:"center",width:100,fixed:"right",render:t=>{let i;return n(tt,{type:(H=>(t.mtype===0?{0:"default",1:"default",2:"primary",3:"warning",4:"success"}:t.mtype===1?{0:"default",1:"default",4:"success"}:t.mtype===2?{0:"default",1:"primary",3:"warning",4:"success"}:{0:"default",1:"primary",3:"warning",4:"success"})[H]||"default")(t.status)},Me(i=Ke(t.mtype,t.status))?i:{default:()=>[i]})}},{key:"operate",title:Q("common.operate"),align:"center",width:le("aftermarket:update:permission.do")||le("aftermarket:delete:permission.do")?120:0,fixed:"right",render:t=>n("div",{class:"flex-center gap-8px"},[(t.mtype===0||t.mtype===1)&&t.status===1&&n(Ue,{onPositiveClick:()=>jt(t.id)},{default:()=>"确认要审核通过吗？",trigger:()=>te(n(A,{type:"primary",ghost:!0,size:"small"},{default:()=>[S("审核")]}),[[ne("no-auth"),"aftermarket:update:permission.do"]])}),(t.mtype===2||t.mtype===3)&&t.status===0&&n(Ue,{onPositiveClick:()=>jt(t.id)},{default:()=>"确认要审核通过吗？",trigger:()=>n(A,{type:"primary",ghost:!0,size:"small"},{default:()=>[S("审核")]})}),n(Ue,{onPositiveClick:()=>Ln(t.id)},{default:()=>Q("common.confirmDelete"),trigger:()=>{let i;return te(n(A,{type:"error",ghost:!0,size:"small"},Me(i=Q("common.delete"))?i:{default:()=>[i]}),[[ne("no-auth"),"aftermarket:delete:permission.do"]])}})])}]}),{drawerVisible:Ae,operateType:Ve,editingData:ot,handleAdd:Ne,checkedRowKeys:ke,onDeleted:dt}=vt($e,se),{columns:ut,data:r,getData:a,loading:I,mobilePagination:L,searchParams:N}=gt({showTotal:!0,immediate:!1,apiFn:ji,apiParams:{page:1,pageSize:20,limit:20,cid:null,gws:null,sn:null,status:null,uid:null,dbtime:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48,fixed:"left"},{key:"sn",title:"客户设备信息",width:240,titleAlign:"center",ellipsis:{tooltip:!0},render:t=>n("div",{class:"flex flex-col items-start justify-start gap-1"},[n("div",{class:"w-full truncate",title:`设备编号：${t.sn}`},[S("设备编号："),t.sn?t.rsn?t.rsn==t.sn||t.rsn.includes("无")?t.sn:n("span",null,[t.sn,S(" ("),n("span",{style:"color: red; font-weight: bold;"},[S("更换")]),S(")")]):t.sn:"--"]),n("div",{class:"w-full truncate",title:`设备型号：${t.model||"--"}`},[S("设备型号："),t.model||"--"])])},{key:"fault",title:"故障现象",align:"center",width:220,ellipsis:{tooltip:!0}},{key:"re1",title:"现场照片",align:"center",width:300,render:t=>n("div",{class:"flex items-center justify-center gap-4px"},[t.re1||t.re2||t.re3?n("div",{style:{cursor:"pointer"},onClick:()=>Ye([t.re1,t.re2,t.re3].filter(i=>i),0)},[n(et,{width:70,src:t.re1||t.re2||t.re3,previewDisabled:!0,style:{maxHeight:"70px",cursor:"pointer"}},null)]):null])},{key:"re4",title:"现场视频",align:"center",width:300,render:t=>n("div",{class:"flex items-center justify-center gap-4px"},[t.re4?n("video",{src:t.re4,style:{height:"70px",width:"100%",cursor:"pointer",objectFit:"cover"},onClick:()=>En(t.re4)},null):null])},{key:"returnnum",title:"物流信息",align:"center",width:220,titleAlign:"center",ellipsis:{tooltip:!0},render:t=>n("div",{class:"flex flex-col items-start justify-start gap-1"},[t.returnnum&&q.mtype!==1&&n("div",{class:"flex items-center gap-4px"},[Ht(t.returnnum)?n("a",{href:`https://www.kuaidi100.com?nu=${encodeURIComponent(t.returnnum)}`,target:"_blank",style:"color: #4169E1;"},[t.returnnum||"--"]):n("span",null,[t.returnnum||"--"]),n(Xe,{trigger:"hover",placement:"right"},{trigger:()=>te(n(A,{text:!0,type:"primary",onClick:()=>Ge(t.id,t,"returnnum")},{default:()=>[n("span",{class:"akar-icons--edit"},null)]}),[[ne("no-auth"),"aftermarket:update:permission.do"]]),default:()=>Q("common.update")})]),t.returnnum&&n("div",null,[`时间：${t.rdbtime?t.rdbtime:""}`]),t.returnnum&&n("div",null,[`寄件类型：${t.rdetails==0?"仅裸机":t.raccessory?"含配件("+t.raccessory+")":"未知"}`]),!t.returnnum&&te(n(A,{text:!0,type:"primary",onClick:()=>Ge(t.id,null,"returnnum")},{default:()=>["填写"]}),[[ne("no-auth"),"aftermarket:update:permission.do"]])])},{key:"re8",title:"分析照片",align:"center",width:300,render:t=>n("div",{class:"flex items-center justify-center gap-4px"},[t.re5||t.re6||t.re7?n("div",{style:{cursor:"pointer"},onClick:()=>Ye([t.re5||t.re6||t.re7].filter(i=>i),0)},[n(et,{width:70,src:t.re5||t.re6||t.re7,previewDisabled:!0,style:{maxHeight:"70px",cursor:"pointer"}},null)]):null,n("div",null,[!t.re5&&!t.re6&&!t.re7&&te(n(A,{size:"small",type:"primary",onClick:()=>Te(t,"analyze")},{default:()=>[S("点击上传")]}),[[ne("no-auth"),"aftermarket:update:permission.do"]]),(t.re5||t.re6||t.re7)&&te(n(A,{size:"small",type:"primary",onClick:()=>Te(t,"analyze"),style:{marginLeft:"5px"}},{default:()=>[S("编辑图片")]}),[[ne("no-auth"),"aftermarket:update:permission.do"]])])])},{key:"rsn",title:"设备信息",width:200,titleAlign:"center",ellipsis:{tooltip:!0},render:t=>n("div",{class:"flex flex-col items-start justify-start gap-1"},[n("div",{class:"w-full truncate",title:`设备编号：${t.rsn||"--"}`},[S("设备编号："),t.rsn||"--"]),n("div",{class:"w-full truncate",title:`设备型号：${t.rmodel||"--"}`},[S("设备型号："),t.rmodel||"--"])])},{key:"notes",title:"备注",align:"center",width:180,ellipsis:{tooltip:!0},render:t=>n("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-around"}},[t.notes?n("div",{class:"w-full truncate",title:`${t.notes}`},[t.notes]):te(n(A,{text:!0,type:"primary",size:"small",onClick:()=>Ze(t.id,"","sn")},{default:()=>[S("填写")]}),[[ne("no-auth"),"aftermarket:update:permission.do"]])])},{key:"duration",title:"处理时长",align:"center",width:180,ellipsis:{tooltip:!0}},{key:"status",align:"center",width:120,fixed:"right",title:()=>p("div",{class:"flex flex-col items-center justify-center"},[p("span","当前状态"),p("span",{style:"font-size: 11px; color: #FF0000; margin-top: 2px;"},"悬浮查看详情")]),render:t=>{const i=()=>{const{status:b}=t;return q.mtype===0?[p(M,{type:b>=0?"success":"default",time:t.dbtime},{default:()=>"待处理"}),p(M,{type:b>=1?"success":"default",time:t.redbtime},{default:()=>["分析中",t.receipt&&p("span",{style:{marginLeft:"5px"}},["(寄出单号: ",p("a",{href:`https://www.kuaidi100.com?nu=${encodeURIComponent(t.receipt)}`,target:"_blank",style:{color:"#4169E1",marginLeft:"5px"}},t.receipt),")"])]}),p(M,{type:b>=2?"success":"default"},{default:()=>"处理中"}),p(M,{type:b>=3?"success":"default"},{default:()=>"待寄回"}),p(M,{type:b>=4?"success":"default"},{default:()=>"待客户收件"}),p(M,{type:b>=5?"success":"default",time:t.rdbtime},{default:()=>["完成",t.returnnum&&p("span",{style:{marginLeft:"5px"}},["(寄出单号: ",p("a",{href:`https://www.kuaidi100.com?nu=${encodeURIComponent(t.returnnum)}`,target:"_blank",style:{color:"#4169E1",marginLeft:"5px"}},t.returnnum),")"])]})]:q.mtype===1?[p(M,{type:b>=0?"success":"default",time:t.dbtime},{default:()=>"待处理"}),p(M,{type:b>=1?"success":"default",time:t.return_time||t.complete_time},{default:()=>"完成"})]:q.mtype===2?[p(M,{type:b>=0?"success":"default",time:t.dbtime},{default:()=>"待处理"}),p(M,{type:b>=1?"success":"default"},{default:()=>"待客户收件"}),p(M,{type:b>=2?"success":"default"},{default:()=>"待我司收件"}),p(M,{type:b>=3?"success":"default",time:t.return_time||t.complete_time},{default:()=>"完成"})]:q.mtype===3?[p(M,{type:b>=0?"success":"default",time:t.dbtime},{default:()=>"待处理"}),p(M,{type:b>=1?"success":"default"},{default:()=>"待客户收件"}),p(M,{type:b>=2?"success":"default",time:t.return_time||t.complete_time},{default:()=>"完成"})]:[p(M,{type:b>=0?"success":"default",time:t.dbtime},{default:()=>"待处理"}),p(M,{type:b>=1?"success":"default",time:t.redbtime},{default:()=>["分析中",t.receipt&&p("span",{style:{marginLeft:"5px"}},["(寄出单号: ",p("a",{href:`https://www.kuaidi100.com?nu=${encodeURIComponent(t.receipt)}`,target:"_blank",style:{color:"#4169E1",marginLeft:"5px"}},t.receipt),")"])]}),p(M,{type:b>=2?"success":"default"},{default:()=>"处理中"}),p(M,{type:b>=3?"success":"default"},{default:()=>"待寄回"}),p(M,{type:b>=4?"success":"default"},{default:()=>"待客户收件"}),p(M,{type:b>=5?"success":"default",time:t.rdbtime},{default:()=>["完成",t.returnnum&&p("span",{style:{marginLeft:"5px"}},["(寄出单号: ",p("a",{href:`https://www.kuaidi100.com?nu=${encodeURIComponent(t.returnnum)}`,target:"_blank",style:{color:"#4169E1",marginLeft:"5px"}},t.returnnum),")"])]})]};return p(sn,{placement:"top",style:{maxWidth:"450px"}},{trigger:()=>p(tt,{type:"primary",style:{cursor:"pointer"}},{default:()=>O(q.mtype,t.status)}),default:()=>p("div",{class:"custom-timeline",style:{padding:"12px"}},[p("p",{style:{marginBottom:"12px",fontWeight:"bold"}},[p("strong",null,"当前状态："),O(q.mtype,t.status)]),p(mn,null,{default:()=>i()})])})}},{key:"responsibleperson",title:"售后处理",align:"center",width:160,fixed:"right",render:t=>n("div",{class:"flex-center gap-8px"},[te(n(A,{type:"primary",ghost:!0,size:"small",onClick:()=>Fn(t,"option")},{default:()=>["查看"+(t.rescount>0?"("+t.rescount+")":"")]}),[[ne("no-auth"),"aftermarketRes:select:permission.do"]]),te(n(A,{type:"primary",ghost:!0,size:"small",onClick:()=>ft(t,"add")},{default:()=>["添加"]}),[[ne("no-auth"),"aftermarketRes:insert:permission.do"]])])},{key:"operate",title:Q("common.operate"),align:"center",width:160,fixed:"right",render:t=>n("div",{class:"flex-center gap-8px"},[te(n(A,{type:"primary",ghost:!0,size:"small",onClick:()=>Ze(t.id,t.notes,"sn")},{default:()=>["修改备注"]}),[[ne("no-auth"),"aftermarket:update:permission.do"]]),n(Ue,{onPositiveClick:()=>$t(t.id)},{default:()=>Q("common.confirmDelete"),trigger:()=>{let i;return te(n(A,{type:"error",ghost:!0,size:"small"},Me(i=Q("common.delete"))?i:{default:()=>[i]}),[[ne("no-auth"),"aftermarket:delete:permission.do"]])}})])}]}),{checkedRowKeys:V,onDeleted:ee}=vt(r,a),{columns:J,data:X,getData:ie,loading:de,mobilePagination:ve,searchParams:_e}=gt({showTotal:!0,immediate:!1,apiFn:Ii,apiParams:{page:1,pageSize:20,limit:20,aid:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48,fixed:"left"},{key:"username",title:"责任人",width:200,align:"center",ellipsis:{tooltip:!0}},{key:"reason",title:"原因分析",align:"center",width:300,ellipsis:{tooltip:!0}},{key:"resolution",title:"处理意见",align:"center",width:300,ellipsis:{tooltip:!0}},{key:"improvement",title:"改进措施",align:"center",width:300,ellipsis:{tooltip:!0}},{key:"dbtime",title:"创建时间",align:"center",width:160},{key:"operate",title:Q("common.operate"),align:"center",width:160,fixed:"right",render:t=>n("div",{class:"flex-center gap-8px"},[te(n(A,{type:"primary",ghost:!0,size:"small",onClick:()=>ft(t,"edit")},{default:()=>["修改"]}),[[ne("no-auth"),"aftermarketRes:update:permission.do"]]),n(Ue,{onPositiveClick:()=>Pt(t.id)},{default:()=>Q("common.confirmDelete"),trigger:()=>{let i;return te(n(A,{type:"error",ghost:!0,size:"small"},Me(i=Q("common.delete"))?i:{default:()=>[i]}),[[ne("no-auth"),"aftermarketRes:delete:permission.do"]])}})])}]}),{checkedRowKeys:Fe}=vt(X,ie),We=t=>t===0?"标准双向寄送":t===1?"仅客户寄回":t===2?"我司先寄双向":t===3?"仅我司寄出":"未知",Ke=(t,i)=>t===0?i===0?"待完善":i===1?"待审核":i===2?"审核通过":i===3?"进行中":i===4?"完成":"未知":t===1?i===0?"待完善":i===1?"待审核":i===4?"完成":"未知":t===2||t===3?i===0?"待审核":i===1?"审核通过":i===3?"进行中":i===4?"完成":"未知":i===0?"待完善":i===1?"待审核":i===2?"审核通过":i===3?"进行中":i===4?"完成":"未知",O=(t,i)=>t===0?i===0?"待处理":i===1?"分析中":i===2?"处理中":i===3?"待寄回":i===4?"待客户收件":i===5?"完成":"未知":t===1?i===0?"待处理":i===5?"完成":"未知":t===2?i===0?"待处理":i===1?"待客户收件":i===2?"待我司收件":i===5?"完成":"未知":t===3?i===0?"待处理":i===1?"待客户收件":i===5?"完成":"未知":i===0?"待处理":i===1?"分析中":i===2?"处理中":i===3?"待寄回":i===4?"待客户收件":i===5?"完成":"未知",yn=(t,i)=>{let b="",H=i.slice(5);return H.forEach((w,Z)=>{Z!=H.length-1?b+=w.sn+"    "+O(t,w.status)+"<br />":b+=w.sn+"    "+O(t,w.status)}),b};function Ge(t,i,b){o.type=b,o.returnOrder=i?b=="receipt"?i.receipt:i.returnnum:"",o.returnOrderType=i?b=="receipt"?i.receipt.includes("无")?2:1:i.returnnum.includes("无")?2:1:1,o.id=t,o.rsn=i&&i.hasOwnProperty("rsn")?i.rsn:"",o.rdetails=i&&i.hasOwnProperty("rdetails")?Number(i.rdetails):0,o.raccessory=i&&i.hasOwnProperty("raccessory")?i.raccessory:"",h.value=!0}function gn(){h.value=!1,o.id=0,o.type="",o.returnOrder="",o.returnOrderType=1,o.rsn="",o.rdetails=0,o.raccessory=""}async function vn(){var i,b,H,w;await x.value.validate();let t=o.type=="receipt"?o.rdetails===0?[{id:o.id,receipt:o.returnOrder,details:o.rdetails}]:[{id:o.id,receipt:o.returnOrder,details:o.rdetails,accessory:o.raccessory}]:o.rdetails===0?[{id:o.id,returnnum:o.returnOrder,rsn:o.rsn,rdetails:o.rdetails}]:[{id:o.id,returnnum:o.returnOrder,rsn:o.rsn,rdetails:o.rdetails,raccessory:o.raccessory}];if(o.type=="receipt"){const{data:Z,error:W}=await ht(t);W||((i=window.$message)==null||i.destroyAll(),(b=window.$message)==null||b.success(Z.msg||"操作成功"),se(),h.value=!1,o.type="",o.returnOrder="",o.id=0)}else{const{data:Z,error:W}=await bt(t);W||((H=window.$message)==null||H.destroyAll(),(w=window.$message)==null||w.success(Z.msg||"操作成功"),a(),h.value=!1,o.type="",o.returnOrder="",o.id=0)}}function Te(t,i){l.sendFileList=[],l.receiveFileList=[],l.analyzeFileList=[],l.id=t.id,l.type=i,i==="customer"?(t.re1&&l.sendFileList.push({id:"0",name:"0",url:t.re1,status:"finished"}),t.re2&&l.sendFileList.push({id:"1",name:"1",url:t.re2,status:"finished"}),t.re3&&l.sendFileList.push({id:"2",name:"2",url:t.re3,status:"finished"})):i==="company"?(t.re4&&l.receiveFileList.push({id:"0",name:"0",url:t.re4,status:"finished"}),t.re5&&l.receiveFileList.push({id:"1",name:"1",url:t.re5,status:"finished"}),t.re6&&l.receiveFileList.push({id:"2",name:"2",url:t.re6,status:"finished"})):(t.re5&&l.analyzeFileList.push({id:"0",name:"0",url:t.re5,status:"finished"}),t.re6&&l.analyzeFileList.push({id:"1",name:"1",url:t.re6,status:"finished"}),t.re7&&l.analyzeFileList.push({id:"2",name:"2",url:t.re7,status:"finished"})),P.value=!0}function ct(t){var w,Z,W,K;const i=["image/jpeg","image/png","image/jpg","image/x-icon"];console.log("data.file.file",t.file.file);const b=i.includes(t.file.file.type),H=t.file.file.size/1024/1024<100;return b||((w=window.$message)==null||w.destroyAll(),(Z=window.$message)==null||Z.error("只能上传 JPG/PNG/JPEG/ICO 格式的图片")),H||((W=window.$message)==null||W.destroyAll(),(K=window.$message)==null||K.error("上传图片大小不能超过 100MB")),b&&H}async function Je(t){var w,Z;const{file:i,onFinish:b,onError:H}=t;try{const W=await nt(i.file,i.name,"aftermarket/image");W&&(i.url=W,b({...i,url:W}),(w=window.$message)==null||w.destroyAll(),(Z=window.$message)==null||Z.success("上传成功"))}catch(W){H(W)}}function hn(){P.value=!1,l.sendFileList=[],l.receiveFileList=[],l.analyzeFileList=[]}function bn(t){return new Promise((i,b)=>{Je({file:t,onFinish:()=>i(!0),onError:H=>b(H)})})}async function xn(){var w,Z,W,K,he,Be,Qe,ze;let t=[{id:l.id}];const i=l.type==="customer"?l.sendFileList:l.type==="company"?l.receiveFileList:l.analyzeFileList;if(await Promise.all([...i.map(re=>bn(re))]),i.some(re=>re.url&&re.url.startsWith("blob:"))){(w=window.$message)==null||w.destroyAll(),(Z=window.$message)==null||Z.warning("还有文件正在上传或上传失败，请稍后提交");return}if(i.some(re=>!re.url||re.url.trim()==="")){(W=window.$message)==null||W.destroyAll(),(K=window.$message)==null||K.warning("存在上传失败的文件，请重新上传");return}if(l.type==="customer"?(l.sendFileList.length==0&&(t[0].re1="",t[0].re2="",t[0].re3=""),l.sendFileList.length==1&&(t[0].re1=l.sendFileList[0].url,t[0].re2="",t[0].re3=""),l.sendFileList.length==2&&(t[0].re1=l.sendFileList[0].url,t[0].re2=l.sendFileList[1].url,t[0].re3=""),l.sendFileList.length==3&&(t[0].re1=l.sendFileList[0].url,t[0].re2=l.sendFileList[1].url,t[0].re3=l.sendFileList[2].url)):l.type==="company"?(l.receiveFileList.length==0&&(t[0].re4="",t[0].re5="",t[0].re6=""),l.receiveFileList.length==1&&(t[0].re4=l.receiveFileList[0].url,t[0].re5="",t[0].re6=""),l.receiveFileList.length==2&&(t[0].re4=l.receiveFileList[0].url,t[0].re5=l.receiveFileList[1].url,t[0].re6=""),l.receiveFileList.length==3&&(t[0].re4=l.receiveFileList[0].url,t[0].re5=l.receiveFileList[1].url,t[0].re6=l.receiveFileList[2].url)):(l.analyzeFileList.length==0&&(t[0].re5="",t[0].re6="",t[0].re7=""),l.analyzeFileList.length==1&&(t[0].re5=l.analyzeFileList[0].url,t[0].re6="",t[0].re7=""),l.analyzeFileList.length==2&&(t[0].re5=l.analyzeFileList[0].url,t[0].re6=l.analyzeFileList[1].url,t[0].re7=""),l.analyzeFileList.length==3&&(t[0].re5=l.analyzeFileList[0].url,t[0].re6=l.analyzeFileList[1].url,t[0].re7=l.analyzeFileList[2].url)),l.type==="customer"||l.type==="company"){const{data:re,error:Pe}=await ht(t);Pe||((he=window.$message)==null||he.destroyAll(),(Be=window.$message)==null||Be.success(re.msg||"操作成功"),se(),P.value=!1,l.id=0,l.sendFileList=[],l.receiveFileList=[])}else{const{data:re,error:Pe}=await bt(t);Pe||((Qe=window.$message)==null||Qe.destroyAll(),(ze=window.$message)==null||ze.success(re.msg||"操作成功"),a(),P.value=!1,l.id=0,l.analyzeFileList=[])}}function Ze(t,i,b){_.id=t,_.notes=i,_.type=b,z.value=!0}function pt(){z.value=!1,_.id=0,_.notes="",_.type=""}async function kn(){var H,w;if(!_.notes){(H=window.$message)==null||H.destroyAll(),(w=window.$message)==null||w.error("请输入备注");return}const{id:t,notes:i,type:b}=_;if(b==="comp"){const{data:Z,error:W}=await ht([{id:t,notes:i}]);W||(pt(),se())}else{const{data:Z,error:W}=await bt([{id:t,notes:i}]);W||(pt(),a())}}async function jt(t){var H,w;const{data:i,error:b}=await Fi({id:t});b||((H=window.$message)==null||H.destroyAll(),(w=window.$message)==null||w.success("审核通过"),ge.page=1,se(),window.dispatchEvent(new CustomEvent("clearAftersales",{detail:{id:t}})))}async function Ln(t){C.id=[t],C.type="deleteComp",C.password="",j.value=!0}async function Cn(){C.id=ke.value,C.type="deleteComp",C.password="",j.value=!0}function wn(){j.value=!1,C.id=[],C.type="",C.password=""}async function _n(){var t,i;if(!C.password){(t=window.$message)==null||t.destroyAll(),(i=window.$message)==null||i.error("请输入密码");return}if(C.type==="deleteComp"){const{data:b,error:H}=await zi(C.id,C.password);H||(j.value=!1,C.id=[],C.type="",C.password="",dt(),ge.page=1,se())}else if(C.type==="deleteSn"){const{data:b,error:H}=await Pi(C.id,C.password);H||(j.value=!1,C.id=[],C.type="",C.password="",ee(),N.page=1,a())}}function Sn(t){var i,b;if(!le("aftermarket:select:permission.do"))return(i=window.$message)==null||i.destroyAll(),(b=window.$message)==null||b.warning("暂无售后设备查询权限，请联系管理员"),!1;q.cid=t.id,q.mtype=t.mtype,q.status=void 0,q.customername="",q.model=void 0,q.gwsn="",q.checkboxList=[],r.value=[],I.value=!1,q.gwsn=t.rsn||"",U.value=!0,qe(()=>{L.value.page=1,N.cid=q.cid,a()})}function $t(t){C.id=t?[t]:V.value,C.type="deleteSn",C.password="",j.value=!0}function Fn(t,i){be.value=i,Se.aid=t.id,Se.uid="",xe.value=!0,_e.page=1,_e.aid=t.id,ie()}function ft(t,i){console.log("row",t),me.value=!1,R.type=i,i==="edit"?(R.uid=t.uid,R.username=t.username,R.aid=t.aid,R.id=t.id,R.reason=t.reason,R.resolution=t.resolution,R.improvement=t.improvement):(R.uid=Number(F.userInfo.id),R.username=F.userInfo.username,R.aid=t.id,R.id=0,R.reason="",R.resolution="",R.improvement=""),ye.value=!0}function mt(){ye.value=!1,me.value=!1,R.id=0,R.username="",R.reason="",R.resolution="",R.improvement=""}async function zn(){var i,b,H,w;let t=[{aid:R.aid,uid:F.userInfo.id,reason:R.reason,resolution:R.resolution,improvement:R.improvement}];if(me.value=!0,R.id){t[0].id=R.id;const{data:Z,error:W}=await Ti(t);W?me.value=!1:(me.value=!1,(i=window.$message)==null||i.destroyAll(),(b=window.$message)==null||b.success(Z.msg||"操作成功"),mt(),xe.value&&(ve.value.page=1,_e.aid=R.aid,ie()),a())}else{const{data:Z,error:W}=await Ai(t);W?me.value=!1:(me.value=!1,(H=window.$message)==null||H.destroyAll(),(w=window.$message)==null||w.success(Z.msg||"操作成功"),mt(),xe.value&&(ve.value.page=1,_e.aid=R.aid,ie()),a())}}async function Pt(t){var w,Z,W,K;let i={};if(t)i.arrIds=[t];else{if(Fe.value.length===0)return(w=window.$message)==null||w.destroyAll(),(Z=window.$message)==null||Z.error("请选择要删除的数据"),!1;i.arrIds=Fe.value}const{data:b,error:H}=await Ri(i.arrIds);if(!H)(W=window.$message)==null||W.destroyAll(),(K=window.$message)==null||K.success(b.msg||"操作成功"),ve.value.page=1,_e.aid=R.aid,ie(),a();else return!1}function En(t){window.open(t,"_blank")}const Ye=(t,i=0)=>{e.value=t,y.value=i,u.value=!0},jn=t=>{y.value=t},$n=()=>{se()};function Pn(){var b,H;if(ke.value.length===0){(b=window.$message)==null||b.destroyAll(),(H=window.$message)==null||H.warning("请先选择要打印的数据");return}const i=$e.value.filter(w=>ke.value.includes(w.id)).map(w=>{[w.re1,w.re2,w.re3].filter(K=>K);const Z=[w.re5,w.re6,w.re7].filter(K=>K),W=[w.re8,w.re9,w.re10].filter(K=>K);return[w.re11,w.re12].filter(K=>K),{创建时间:w.dbtime||"",客户信息:"公司名称: "+w.comp+`
联系人: `+w.contact+`
联系方式: `+w.contactinfo,客户寄出信息:w.receipt?w.receipt+`
寄出时间: `+(w.redbtime?w.redbtime:""):"",项目名称:w.project||"",对接工程师:w.dock||"",客户收件信息:"联系人: "+w.rcontact+`
联系方式: `+w.rcontactinfo+`
地址: `+w.raddress,客户寄出照片:Z.map(K=>`<img src="${K}" style="width:100px;margin:2px;">`).join(""),厂家寄出照片:W.map(K=>`<img src="${K}" style="width:100px;margin:2px;">`).join(""),备注:w.notes||"",审核人:w.ckusername||"",审核时间:w.ckdbtime||"",售后类型:We(w.mtype),当前状态:Ke(w.mtype,w.status)}});Ni({printable:i,properties:[{field:"创建时间",displayName:"创建时间"},{field:"客户信息",displayName:"客户信息"},{field:"客户寄出信息",displayName:"客户寄出信息"},{field:"项目名称",displayName:"项目名称"},{field:"对接工程师",displayName:"对接工程师"},{field:"客户收件信息",displayName:"客户收件信息"},{field:"客户寄出照片",displayName:"客户寄出照片",type:"html"},{field:"厂家寄出照片",displayName:"厂家寄出照片",type:"html"},{field:"备注",displayName:"备注"},{field:"审核人",displayName:"审核人"},{field:"审核时间",displayName:"审核时间"},{field:"售后类型",displayName:"售后类型"},{field:"当前状态",displayName:"当前状态"}],type:"json",header:"售后管理",style:`
            @media print {
                body { font-size: 12px; }
                table { table-layout: fixed; width: 100%; border-collapse: collapse; }
                th, td {
                    border: 1px solid #ccc;
                    padding: 8px;
                    text-align: center;
                    vertical-align: top;
                    word-wrap: break-word;
                }
                th { background-color: #f0f0f0; font-weight: bold; }
                img, video { max-width: 100%; height: auto; }
                .no-break { page-break-inside: avoid; }
            }
        `,gridHeaderStyle:"font-size: 16px; font-weight: bold; color: #000; padding: 8px;",gridStyle:"font-size: 14px; border: 1px solid #ccc; padding: 8px;"})}return si(()=>{JSON.stringify(m.query)!=="{}"?(ge.cname=decodeURIComponent(m.query.comp),ge.pname=decodeURIComponent(m.query.prjname),le("aftermarket:select:permission.do")&&se()):le("aftermarket:select:permission.do")&&se()}),en(()=>m,(t,i)=>{JSON.stringify(t.query)!=="{}"?(ge.cname=decodeURIComponent(t.query.comp),ge.pname=decodeURIComponent(t.query.prjname),le("aftermarket:select:permission.do")&&se()):(ge.cname=null,ge.pname=null,le("aftermarket:select:permission.do")&&se())},{deep:!0}),(t,i)=>{const b=Ft,H=Dn,w=Un,Z=On,W=tn,K=pe,he=oi,Be=rn,Qe=ln,ze=_t,re=an,Pe=nn,Re=Et,In=St,It=dn,An=on,At=Wt,Tt=Vt,Rt=zt,Tn=un,Rn=ui;return T(),at("div",Yi,[n(Zi,{model:f(ge),"onUpdate:model":i[0]||(i[0]=k=>Oe(ge)?ge.value=k:null),onPrintDataList:Pn,onReset:$n,onSearch:f(se)},null,8,["model","onSearch"]),n(Tn,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper h-full"},{header:s(()=>[n(b,{align:"center",wrap:"",class:"lt-sm:w-200px"},{default:s(()=>i[34]||(i[34]=[wt("div",null,"售后列表",-1)])),_:1,__:[34]})]),"header-extra":s(()=>[n(b,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:s(()=>[n(f(A),{onClick:f(Ne),size:"small",ghost:"",type:"primary"},{icon:s(()=>[n(H,{class:"text-icon"})]),default:s(()=>[i[35]||(i[35]=S(" "+Y("新增")))]),_:1,__:[35]},8,["onClick"]),f(le)("aftermarket:delete:permission.do")?(T(),D(f(Ue),{key:0,onPositiveClick:Cn},{trigger:s(()=>[n(f(A),{size:"small",ghost:"",type:"error",disabled:f(ke).length===0},{icon:s(()=>[n(w,{class:di(["text-icon",{"animate-spin":f(oe)}])},null,8,["class"])]),default:s(()=>[i[36]||(i[36]=S(" "+Y("批量删除")))]),_:1,__:[36]},8,["disabled"])]),default:s(()=>[i[37]||(i[37]=S(" 确定要删除选中的售后吗？ "))]),_:1,__:[37]})):B("",!0),n(Z,{columns:f(je),"onUpdate:columns":i[1]||(i[1]=k=>Oe(je)?je.value=k:null)},null,8,["columns"])]),_:1})]),default:s(()=>[n(W,{"checked-row-keys":f(ke),"onUpdate:checkedRowKeys":i[2]||(i[2]=k=>Oe(ke)?ke.value=k:null),columns:f(De),data:f($e),size:"small",loading:f(oe),remote:"","flex-height":!f(E).isMobile,"scroll-x":3e3,"row-key":k=>k.id,pagination:f(st),class:"sm:h-full",striped:""},null,8,["checked-row-keys","columns","data","loading","flex-height","row-key","pagination"]),n(Hi,{visible:f(Ae),"onUpdate:visible":i[3]||(i[3]=k=>Oe(Ae)?Ae.value=k:null),onSubmitted:f(se),"operate-type":f(Ve),"row-data":f(ot)},null,8,["visible","onSubmitted","operate-type","row-data"]),n(re,{show:h.value,"onUpdate:show":i[8]||(i[8]=k=>h.value=k),title:o.type==="receipt"?"填写客户寄出信息":"填写寄出信息",preset:"card",class:"w-800px"},{footer:s(()=>[n(b,{justify:"end"},{default:s(()=>[n(f(A),{size:"small",class:"mt-16px",onClick:gn},{default:s(()=>[S(Y(f(Q)("common.cancel")),1)]),_:1}),n(f(A),{type:"primary",size:"small",class:"mt-16px",onClick:vn},{default:s(()=>[S(Y(f(Q)("common.confirm")),1)]),_:1})]),_:1})]),default:s(()=>[n(ze,{ref_key:"returnOrderFormRef",ref:x,rules:$.value,model:o,"label-placement":"left"},{default:s(()=>[n(he,{label:o.type==="receipt"?"客户寄出信息":"寄出信息",path:"returnOrder",required:""},{default:s(()=>[n(K,{value:o.returnOrder,"onUpdate:value":i[4]||(i[4]=k=>o.returnOrder=k),placeholder:o.type==="receipt"?"请输入客户寄出信息":"请输入寄出信息",clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"]),o.type==="returnnum"?(T(),D(he,{key:0,label:"寄出设备编号",path:"rsn"},{default:s(()=>[n(K,{value:o.rsn,"onUpdate:value":i[5]||(i[5]=k=>o.rsn=k),placeholder:"请输入寄出设备编号",clearable:""},null,8,["value"])]),_:1})):B("",!0),n(he,{label:(o.type==="returnnum","寄件类型"),path:"rdetails"},{default:s(()=>[n(Qe,{value:o.rdetails,"onUpdate:value":i[6]||(i[6]=k=>o.rdetails=k)},{default:s(()=>[n(b,null,{default:s(()=>[n(Be,{value:0},{default:s(()=>i[38]||(i[38]=[S("仅裸机")])),_:1,__:[38]}),n(Be,{value:1},{default:s(()=>i[39]||(i[39]=[S("含配件")])),_:1,__:[39]})]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),o.rdetails===1?(T(),D(he,{key:1,required:"",label:o.type==="returnnum"?"寄出配件详情":"寄件配件详情",path:"raccessory"},{default:s(()=>[n(K,{value:o.raccessory,"onUpdate:value":i[7]||(i[7]=k=>o.raccessory=k),placeholder:o.type==="returnnum"?"请输出寄出配件详情":"请输入寄件配件详情",clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"])):B("",!0)]),_:1},8,["rules","model"])]),_:1},8,["show","title"]),n(re,{show:P.value,"onUpdate:show":i[12]||(i[12]=k=>P.value=k),title:l.type==="customer"?"客户寄出照片上传":l.type==="company"?"寄出照片上传":"分析照片上传",preset:"card",class:"w-800px"},{footer:s(()=>[n(b,{justify:"end"},{default:s(()=>[n(f(A),{size:"small",class:"mt-16px",onClick:hn},{default:s(()=>[S(Y(f(Q)("common.cancel")),1)]),_:1}),n(f(A),{type:"primary",size:"small",class:"mt-16px",onClick:xn},{default:s(()=>[S(Y(f(Q)("common.confirm")),1)]),_:1})]),_:1})]),default:s(()=>[l.type==="customer"?(T(),D(Pe,{key:0,multiple:"",max:3,"file-list":l.sendFileList,"onUpdate:fileList":i[9]||(i[9]=k=>l.sendFileList=k),"list-type":"image-card","default-upload":!1,onBeforeUpload:ct,"custom-request":Je},{default:s(()=>i[40]||(i[40]=[S(" 点击上传 ")])),_:1,__:[40]},8,["file-list"])):l.type==="company"?(T(),D(Pe,{key:1,multiple:"",max:3,"file-list":l.receiveFileList,"onUpdate:fileList":i[10]||(i[10]=k=>l.receiveFileList=k),"list-type":"image-card","default-upload":!1,onBeforeUpload:ct,"custom-request":Je},{default:s(()=>i[41]||(i[41]=[S(" 点击上传 ")])),_:1,__:[41]},8,["file-list"])):(T(),D(Pe,{key:2,multiple:"",max:3,"file-list":l.analyzeFileList,"onUpdate:fileList":i[11]||(i[11]=k=>l.analyzeFileList=k),"list-type":"image-card",onBeforeUpload:ct,"default-upload":!1,"custom-request":Je},{default:s(()=>i[42]||(i[42]=[S(" 点击上传 ")])),_:1,__:[42]},8,["file-list"]))]),_:1},8,["show","title"]),n(re,{show:z.value,"onUpdate:show":i[14]||(i[14]=k=>z.value=k),title:"备注",preset:"card",class:"w-600px"},{footer:s(()=>[n(b,{justify:"end"},{default:s(()=>[n(f(A),{size:"small",class:"mt-16px",onClick:pt},{default:s(()=>[S(Y(f(Q)("common.cancel")),1)]),_:1}),n(f(A),{type:"primary",size:"small",class:"mt-16px",onClick:kn},{default:s(()=>[S(Y(f(Q)("common.confirm")),1)]),_:1})]),_:1})]),default:s(()=>[n(ze,{ref_key:"formRef",ref:g,model:_,"label-placement":"left"},{default:s(()=>[n(he,{label:"备注",path:"notes",required:""},{default:s(()=>[n(K,{type:"textarea",value:_.notes,"onUpdate:value":i[13]||(i[13]=k=>_.notes=k),placeholder:"请输入备注",clearable:""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"]),n(re,{show:j.value,"onUpdate:show":i[16]||(i[16]=k=>j.value=k),title:"二次确认",preset:"card",class:"w-600px"},{footer:s(()=>[n(b,{justify:"end"},{default:s(()=>[n(f(A),{size:"small",class:"mt-16px",onClick:wn},{default:s(()=>[S(Y(f(Q)("common.cancel")),1)]),_:1}),n(f(A),{type:"primary",size:"small",class:"mt-16px",onClick:_n},{default:s(()=>[S(Y(f(Q)("common.confirm")),1)]),_:1})]),_:1})]),default:s(()=>[n(ze,{ref_key:"formRef",ref:g,model:C,"label-placement":"left"},{default:s(()=>[n(he,{label:"密码",path:"password",required:""},{default:s(()=>[n(K,{type:"password","show-password-on":"mousedown",value:C.password,"onUpdate:value":i[15]||(i[15]=k=>C.password=k),placeholder:"请输入密码",clearable:""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"]),n(re,{show:U.value,"onUpdate:show":i[22]||(i[22]=k=>U.value=k),title:"售后设备信息",preset:"card",class:"w-85%"},{default:s(()=>[n(ze,{ref_key:"formRef",ref:g,model:q,"label-placement":"left","label-width":100,"show-feedback":!1},{default:s(()=>[n(Rt,{responsive:"screen","item-responsive":"","x-gap":16,"y-gap":16},{default:s(()=>[n(Re,{span:"24 s:12 m:5",label:"客户名称",path:"customername"},{default:s(()=>[n(K,{clearable:"",value:q.customername,"onUpdate:value":i[17]||(i[17]=k=>q.customername=k),placeholder:"请输入客户名称"},null,8,["value"])]),_:1}),n(Re,{span:"24 s:12 m:5",label:"设备编号",path:"gwsn"},{default:s(()=>[n(K,{clearable:"",value:q.gwsn,"onUpdate:value":i[18]||(i[18]=k=>q.gwsn=k),placeholder:"请输入设备编号"},null,8,["value"])]),_:1}),n(Re,{span:"24 s:12 m:4",label:"状态",path:"status"},{default:s(()=>[n(In,{clearable:"",filterable:"",value:q.status,"onUpdate:value":i[19]||(i[19]=k=>q.status=k),placeholder:"请选择状态","label-field":"label","value-field":"value",options:v},null,8,["value","options"])]),_:1}),n(Re,{span:"24 s:12 m:5",label:"快速筛选"},{default:s(()=>[n(An,{value:q.checkboxList,"onUpdate:value":i[20]||(i[20]=k=>q.checkboxList=k)},{default:s(()=>[n(b,{"item-style":"display: flex;"},{default:s(()=>[n(It,{value:"me",label:"与我相关"}),n(It,{value:"handle",label:"近7日待处理"})]),_:1})]),_:1},8,["value"])]),_:1}),n(Re,{span:"24 s:12 m:5"},{default:s(()=>[n(b,{class:"w-full"},{default:s(()=>[f(le)("aftermarket:select:permission.do")?(T(),D(f(A),{key:0,ghost:"",onClick:f(a)},{icon:s(()=>[n(At,{class:"text-icon"})]),default:s(()=>[i[43]||(i[43]=S(" "+Y("查询")))]),_:1,__:[43]},8,["onClick"])):B("",!0),f(le)("aftermarket:delete:permission.do")?(T(),D(f(A),{key:1,type:"error",disabled:f(V).length===0,onClick:$t},{icon:s(()=>[n(w,{class:"text-icon"})]),default:s(()=>[i[44]||(i[44]=S(" "+Y("批量删除")))]),_:1,__:[44]},8,["disabled"])):B("",!0),f(le)("aftermarket:select:permission.do")?(T(),D(f(A),{key:2,onClick:f(a)},{icon:s(()=>[n(Tt,{class:"text-icon"})]),default:s(()=>[i[45]||(i[45]=S(" "+Y("刷新")))]),_:1,__:[45]},8,["onClick"])):B("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),n(W,{"checked-row-keys":f(V),"onUpdate:checkedRowKeys":i[21]||(i[21]=k=>Oe(V)?V.value=k:null),columns:f(ut),data:f(r),size:"small",loading:f(I),remote:"",style:{"margin-top":"20px"},"max-height":400,"scroll-x":2600,"row-key":k=>k.id,pagination:f(L),class:"sm:h-full",striped:""},null,8,["checked-row-keys","columns","data","loading","row-key","pagination"])]),_:1},8,["show"]),n(re,{show:xe.value,"onUpdate:show":i[26]||(i[26]=k=>xe.value=k),title:"售后处理",preset:"card",class:"w-85%"},{default:s(()=>[n(ze,{ref_key:"formRef",ref:g,model:Se,"label-placement":"left","label-width":100,"show-feedback":!1},{default:s(()=>[n(Rt,{responsive:"screen","item-responsive":"","x-gap":16,"y-gap":16},{default:s(()=>[n(Re,{span:"24 s:24 m:24"},{default:s(()=>[n(b,{class:"w-full"},{default:s(()=>[f(le)("aftermarketRes:select:permission.do")?(T(),D(f(A),{key:0,ghost:"",onClick:f(ie)},{icon:s(()=>[n(At,{class:"text-icon"})]),default:s(()=>[i[46]||(i[46]=S(" "+Y("查询")))]),_:1,__:[46]},8,["onClick"])):B("",!0),f(le)("aftermarketRes:insert:permission.do")?(T(),D(f(A),{key:1,type:"primary",ghost:"",onClick:i[23]||(i[23]=k=>ft({id:Se.aid||R.aid},"add"))},{icon:s(()=>[n(H,{class:"text-icon"})]),default:s(()=>[i[47]||(i[47]=S(" "+Y("添加")))]),_:1,__:[47]})):B("",!0),f(le)("aftermarketRes:delete:permission.do")?(T(),D(f(A),{key:2,type:"error",disabled:f(V).length===0,onClick:i[24]||(i[24]=k=>Pt(void 0))},{icon:s(()=>[n(w,{class:"text-icon"})]),default:s(()=>[i[48]||(i[48]=S(" "+Y("批量删除")))]),_:1,__:[48]},8,["disabled"])):B("",!0),f(le)("aftermarketRes:select:permission.do")?(T(),D(f(A),{key:3,onClick:f(ie)},{icon:s(()=>[n(Tt,{class:"text-icon"})]),default:s(()=>[i[49]||(i[49]=S(" "+Y("刷新")))]),_:1,__:[49]},8,["onClick"])):B("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),n(W,{"checked-row-keys":f(Fe),"onUpdate:checkedRowKeys":i[25]||(i[25]=k=>Oe(Fe)?Fe.value=k:null),columns:f(J),data:f(X),size:"small",loading:f(de),remote:"",style:{"margin-top":"20px"},"max-height":400,"row-key":k=>k.id,pagination:f(ve),class:"sm:h-full",striped:""},null,8,["checked-row-keys","columns","data","loading","row-key","pagination"])]),_:1},8,["show"]),n(re,{show:ye.value,"onUpdate:show":i[31]||(i[31]=k=>ye.value=k),title:R.type==="add"?"添加责任人":"修改责任人",preset:"card",class:"w-600px"},{footer:s(()=>[n(b,{justify:"end"},{default:s(()=>[n(f(A),{size:"small",class:"mt-16px",onClick:mt},{default:s(()=>[S(Y(f(Q)("common.cancel")),1)]),_:1}),n(f(A),{type:"primary",size:"small",class:"mt-16px",onClick:zn},{default:s(()=>[S(Y(f(Q)("common.confirm")),1)]),_:1})]),_:1})]),default:s(()=>[n(ze,{ref_key:"formRef",ref:g,model:_,"label-placement":"left"},{default:s(()=>[n(he,{label:"责任人",path:"notes",required:""},{default:s(()=>[n(K,{disabled:"",value:R.username,"onUpdate:value":i[27]||(i[27]=k=>R.username=k),placeholder:"请输入责任人",clearable:""},null,8,["value"])]),_:1}),n(he,{label:"原因分析",path:"notes"},{default:s(()=>[n(K,{type:"textarea",value:R.reason,"onUpdate:value":i[28]||(i[28]=k=>R.reason=k),placeholder:"请输入原因分析",clearable:""},null,8,["value"])]),_:1}),n(he,{label:"处理意见",path:"notes"},{default:s(()=>[n(K,{type:"textarea",value:R.resolution,"onUpdate:value":i[29]||(i[29]=k=>R.resolution=k),placeholder:"请输入处理意见",clearable:""},null,8,["value"])]),_:1}),n(he,{label:"改进措施",path:"notes"},{default:s(()=>[n(K,{type:"textarea",value:R.improvement,"onUpdate:value":i[30]||(i[30]=k=>R.improvement=k),placeholder:"请输入改进措施",clearable:""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title"])]),_:1}),n(Rn,{show:u.value,"onUpdate:show":i[32]||(i[32]=k=>u.value=k),current:y.value,"onUpdate:current":[i[33]||(i[33]=k=>y.value=k),jn],"src-list":e.value},null,8,["show","current","src-list"])])}}}),ul=cn(Qi,[["__scopeId","data-v-f4f25c69"]]);export{ul as default};

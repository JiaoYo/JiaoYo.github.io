import{_ as R}from"./export-SR1Whgcp.js";import{d as j,q as $,x as U,o as S,c as B,w as a,g as t,i as e,$ as o,X as M,dj as P,h as z,t as D,G as F,K as G,a0 as I,B as L,O as K,P as A,ad as O,a4 as V,dk as W,av as q,j as X,E as H,e as J,ah as Q,F as Y,ai as Z,aj as ee}from"./index-C5IVBnuT.js";import{b as te,c as oe}from"./system-log-03279F1o.js";import{u as ae}from"./table-CQwo57Cc.js";import{_ as ne}from"./round-search-BDs78GhZ.js";import{_ as le}from"./round-refresh-DiPTY6w8.js";import{_ as se}from"./lodash-Bi0mdSrH.js";import{_ as re}from"./FormItemGridItem-0rbPDrs6.js";import{_ as ie}from"./Grid-BAhwGuO1.js";const ce=j({name:"LoginlogSearch",__name:"loginlog-search",props:{model:{required:!0},modelModifiers:{}},emits:$(["reset","search"],["update:model"]),setup(m,{expose:b,emit:h}){const y=h,s=U(m,"model");function x(c){s.value.creatorName=c.replace(/\s/g,"")}function v(c){return!c.startsWith(" ")&&!c.endsWith(" ")}function _(){y("reset")}function u(){y("search")}async function N(){const{data:c,error:n}=await te({creatorName:s.value.creatorName,status:s.value.status});if(!n){let r=c,l=new Blob([r],{type:"application/vnd.ms-excel"}),d=new Date().getTime()+".xls",f=window.webkitURL.createObjectURL(l),i=document.createElement("a");i.href=f,i.download=d,document.body.appendChild(i),i.click(),i.remove()}}const g=se.throttle(u,1e3,{trailing:!1});return b({handleExportChange:N}),(c,n)=>{const r=G,l=re,d=I,f=le,i=L,w=ne,p=K,k=ie,T=A,E=O;return S(),B(E,{bordered:!1,size:"small",class:"card-wrapper"},{default:a(()=>[t(T,{model:s.value,"label-placement":"left","label-width":80,"show-feedback":!1,onKeyup:F(e(g),["enter"])},{default:a(()=>[t(k,{responsive:"screen","item-responsive":"","x-gap":12,"y-gap":12},{default:a(()=>[t(l,{span:"24 s:12 m:8 l:6",label:e(o)("page.systemlog.login.creatorName"),path:"creatorName"},{default:a(()=>[t(r,{clearable:"",value:s.value.creatorName,"onUpdate:value":n[0]||(n[0]=C=>s.value.creatorName=C),placeholder:e(o)("page.systemlog.login.form.creatorName"),onInput:x,"allow-input":v,onClear:_},null,8,["value","placeholder"])]),_:1},8,["label"]),t(l,{span:"24 s:12 m:8 l:6",label:e(o)("page.systemlog.login.status"),path:"status"},{default:a(()=>[t(d,{filterable:"",clearable:"",value:s.value.status,"onUpdate:value":[n[1]||(n[1]=C=>s.value.status=C),u],placeholder:e(o)("page.systemlog.login.form.status"),options:e(M)(e(P)),onClear:_},null,8,["value","placeholder","options"])]),_:1},8,["label"]),t(l,{span:"24 s:12 m:8 l:6"},{default:a(()=>[t(p,{class:"w-full"},{default:a(()=>[t(i,{onClick:_},{icon:a(()=>[t(f,{class:"text-icon"})]),default:a(()=>[z(" "+D(e(o)("common.reset")),1)]),_:1}),t(i,{type:"primary",ghost:"",onClick:e(g)},{icon:a(()=>[t(w,{class:"text-icon"})]),default:a(()=>[z(" "+D(e(o)("common.search")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","onKeyup"])]),_:1})}}}),pe={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function me(m){return typeof m=="function"||Object.prototype.toString.call(m)==="[object Object]"&&!Z(m)}const ve=j({name:"logmanage_loginlog",__name:"index",setup(m){const b=V(),{columns:h,columnChecks:y,data:s,getData:x,loading:v,pagination:_,searchParams:u,resetSearchParams:N}=ae({apiFn:oe,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,creatorName:null,status:null,_t:new Date().getTime()},columns:()=>[{key:"creatorName",title:o("page.systemlog.login.creatorName"),align:"center",width:160,resizable:!0},{key:"operation",title:o("page.systemlog.login.operation"),width:140,align:"center",render:n=>{const r=n.operation==0?o("page.manage.common.loginStatus.login"):o("page.manage.common.loginStatus.logout");return t("span",null,[r])},resizable:!0},{key:"status",title:o("page.systemlog.login.status"),width:100,align:"center",render:n=>{n.status==null&&(n.status=0);const r={0:"error",1:"success",2:"warning",3:"info",4:"info",5:"error",6:"info",7:"error"},l=o(W[n.status].label);return t(q,{size:"small",type:r[n.status]},me(l)?l:{default:()=>[l]})},resizable:!0},{key:"ip",title:o("page.systemlog.login.ip"),width:160,align:"center",resizable:!0},{key:"userAgent",title:o("page.systemlog.login.userAgent"),minWidth:400,align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"createDate",title:o("page.systemlog.login.createDate"),width:160,align:"center"}]}),g=X(),c=()=>{g.value.handleExportChange()};return(n,r)=>{const l=R,d=L,f=ee,i=O,w=H("no-auth");return S(),J("div",pe,[t(ce,{model:e(u),"onUpdate:model":r[0]||(r[0]=p=>Q(u)?u.value=p:null),onReset:e(N),onSearch:e(x),ref_key:"searchRef",ref:g},null,8,["model","onReset","onSearch"]),t(i,{title:e(o)("page.systemlog.login.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":a(()=>[Y((S(),B(d,{type:"info",size:"small",ghost:"",onClick:c},{icon:a(()=>[t(l,{class:"text-icon"})]),default:a(()=>[z(" "+D(e(o)("common.export")),1)]),_:1})),[[w,"sys:log:login.export"]])]),default:a(()=>[t(f,{columns:e(h),data:e(s),size:"small","flex-height":!e(b).isMobile,"scroll-x":e(h).reduce((p,k)=>p+k.width,0),loading:e(v),remote:"","row-key":p=>p.id,pagination:e(_),class:"sm:h-full"},null,8,["columns","data","flex-height","scroll-x","loading","row-key","pagination"])]),_:1},8,["title"])])}}});export{ve as default};

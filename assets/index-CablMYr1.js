import{_ as q}from"./export-TPyDWd61.js";import{d as z,o as C,c as M,w as t,g as e,h as k,t as v,f as r,$ as o,B as S,R as P,T,a6 as E,a0 as U,m as y,b as R,aJ as V,aL as O,S as $,aH as A}from"./index-BLbkiws9.js";import{f as F,a as G}from"./system-log-C6jfK71p.js";import{u as H}from"./table-BW5u-C8H.js";import{_ as J}from"./round-search-BlwS3mIg.js";import{_ as K}from"./FormItemGridItem-tjRBNsOV.js";import{_ as Q}from"./Grid-BPrFQV4N.js";const W=z({name:"ErrorSearch",__name:"errorlog-search",emits:["search"],setup(s,{expose:h,emit:l}){const p=l;function b(){p("search")}async function N(){const{data:m,error:_}=await F();if(!_){let i=m,c=new Blob([i],{type:"application/vnd.ms-excel"}),u=new Date().getTime()+".xls",d=window.webkitURL.createObjectURL(c),a=document.createElement("a");a.href=d,a.download=u,document.body.appendChild(a),a.click(),a.remove()}}return h({handleExportChange:N}),(m,_)=>{const i=J,c=S,u=P,d=K,a=Q,g=T,w=E;return C(),M(w,{bordered:!1,size:"small",class:"card-wrapper"},{default:t(()=>[e(g,{"label-placement":"left","label-width":80,"show-feedback":!1},{default:t(()=>[e(a,{responsive:"screen","item-responsive":""},{default:t(()=>[e(d,{span:"24 s:12 m:6"},{default:t(()=>[e(u,{class:"w-full"},{default:t(()=>[e(c,{type:"primary",ghost:"",onClick:b},{icon:t(()=>[e(i,{class:"text-icon"})]),default:t(()=>[k(" "+v(r(o)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),X={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function Y(s){return typeof s=="function"||Object.prototype.toString.call(s)==="[object Object]"&&!V(s)}const se=z({name:"logmanage_errorlog",__name:"index",setup(s){const h=U(),l=y(!1),p=y({errorInfo:""}),{columns:b,columnChecks:N,data:m,getData:_,loading:i,pagination:c,searchParams:u,resetSearchParams:d}=H({apiFn:G,apiParams:{page:1,pageSize:20,limit:20,_t:new Date().getTime()},columns:()=>[{key:"requestUri",title:o("page.systemlog.error.requestUri"),width:350,align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"requestMethod",title:o("page.systemlog.error.requestMethod"),width:100,align:"center",resizable:!0},{key:"requestParams",title:o("page.systemlog.error.requestParams"),width:350,align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"ip",title:o("page.systemlog.error.ip"),width:160,align:"center",resizable:!0},{key:"userAgent",title:o("page.systemlog.error.userAgent"),width:240,align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"createDate",title:o("page.systemlog.error.createDate"),width:160,align:"center",resizable:!0},{key:"operate",title:o("common.operate"),align:"center",width:130,render:f=>{let n;return e("div",{class:"flex-center gap-8px"},[e(S,{type:"primary",ghost:!0,size:"small",onClick:()=>a(f)},Y(n=o("page.systemlog.error.errorMsg"))?n:{default:()=>[n]})])}}]});function a(f){p.value.errorInfo=f.errorInfo,l.value=!0}const g=y(),w=()=>{g.value.handleExportChange()};return(f,n)=>{const L=q,B=O,D=E,I=$,j=A;return C(),R("div",X,[e(W,{onSearch:r(_),ref_key:"searchRef",ref:g},null,8,["onSearch"]),e(D,{title:r(o)("page.systemlog.error.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":t(()=>[e(r(S),{type:"info",size:"small",ghost:"",onClick:w},{icon:t(()=>[e(L,{class:"text-icon"})]),default:t(()=>[k(" "+v(r(o)("common.export")),1)]),_:1})]),default:t(()=>[e(B,{columns:r(b),data:r(m),size:"small","flex-height":!r(h).isMobile,"scroll-x":"",loading:r(i),remote:"","row-key":x=>x.id,pagination:r(c),class:"sm:h-full"},null,8,["columns","data","flex-height","loading","row-key","pagination"])]),_:1},8,["title"]),e(j,{show:l.value,"onUpdate:show":n[0]||(n[0]=x=>l.value=x),title:r(o)("page.systemlog.error.errorMsg"),preset:"card",class:"w-800px"},{default:t(()=>[e(I,{class:"h-480px pr-20px"},{default:t(()=>[k(v(p.value.errorInfo),1)]),_:1})]),_:1},8,["show","title"])])}}});export{se as default};

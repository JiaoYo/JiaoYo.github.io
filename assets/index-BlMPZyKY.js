import{d as W,o as g,b as C,e as t,a4 as K,_ as M,m as w,al as ye,a as X,am as ge,f as x,an as ce,p as q,i as U,c as de,w as z,t as _,F as ie,af as Z,ao as ee,ap as ue,g as L,k as xe,z as te,ag as le,ac as Se,h as Q,v as Ce,ab as me,u as $e,r as Fe,aq as ke,ar as ne,as as De,at as Te,au as Le,av as G,aw as Ie,ax as Ae,A as Be,J as Me,ay as re,az as Ne,aA as Ee,aB as We,aC as Oe,ak as He}from"./index-Cb_NZueQ.js";import{u as fe,L as R}from"./echarts-a9elgznP.js";import{G as Pe,h as Re,a as ze,b as Ve}from"./metar-Ce2uMlaX.js";const je={class:"loader-overlay"},Ge=W({__name:"loading",props:{color:{default:"#1890ff"}},setup(d){const e=d;return(i,r)=>(g(),C("div",je,[t("div",{class:"loader",style:K({"--c":`no-repeat linear-gradient(${e.color} 0 0)`})},null,4)]))}}),Je=M(Ge,[["__scopeId","data-v-c4fc24aa"]]),qe=d=>(q("data-v-4ea05f61"),d=d(),U(),d),Ue=["width","height"],Ye=["fill","stroke","d"],Qe=["stroke"],Ke=qe(()=>t("path",{fill:"transparent",stroke:"{mergedColor[1]}",d:"M 5 20 L 5 10 L 12 3  L 60 3 L 68 10"},null,-1)),Xe=["stroke","d"],Ze={class:"dv-border-box-content"},et=W({__name:"border-box-13",props:{color:{type:Array,default:()=>[]},backgroundColor:{type:String,default:"transparent"}},setup(d){const e=d,i=["#6586ec","#2cf7fe"],r=w(null),{width:f,height:p}=ye(r,{width:0,height:0},{box:"border-box"}),y=X(()=>ge(i,e.color));return($,k)=>(g(),C("div",{class:"dv-border-box-13 dv-border-box",ref_key:"domRef",ref:r},[(g(),C("svg",{width:x(f),height:x(p),class:"dv-border-svg-container"},[t("path",{fill:d.backgroundColor,stroke:y.value[0],d:`
            M 5 20 L 5 10 L 12 3  L 60 3 L 68 10
            L ${x(f)-20} 10 L ${x(f)-5} 25
            L ${x(f)-5} ${x(p)-5} L 20 ${x(p)-5}
            L 5 ${x(p)-20} L 5 20
        `},null,8,Ye),t("path",{fill:"transparent","stroke-width":"3","stroke-linecap":"round","stroke-dasharray":"10, 5",stroke:y.value[0],d:"M 16 9 L 61 9"},null,8,Qe),Ke,t("path",{fill:"transparent",stroke:y.value[1],d:`M ${x(f)-5} ${x(p)-30} L ${x(f)-5} ${x(p)-5} L ${x(f)-30} ${x(p)-5}`},null,8,Xe)],8,Ue)),t("div",Ze,[ce($.$slots,"default",{},void 0,!0)])],512))}}),tt=M(et,[["__scopeId","data-v-4ea05f61"]]),pe=d=>(q("data-v-586f7d9f"),d=d(),U(),d),at={key:0,class:"item_title"},ot=pe(()=>t("div",{class:"zuo"},null,-1)),st={class:"title-inner"},lt=pe(()=>t("div",{class:"you"},null,-1)),nt=W({__name:"item-wrap",props:{title:{default:""}},setup(d){return(e,i)=>{const r=tt;return g(),de(r,null,{default:z(()=>[e.title!==""?(g(),C("div",at,[ot,t("span",st,"   "+_(e.title)+"   ",1),lt])):ie("",!0),t("div",{class:Z(e.title!==""?"item_title_content":"item_title_content_def")},[ce(e.$slots,"default",{},void 0,!0)],2)]),_:3})}}}),rt=M(nt,[["__scopeId","data-v-586f7d9f"]]),ct={class:"list"},dt={class:"item_info"},it={class:"title"},ut={class:"value"},mt=W({__name:"left-bottom",props:{data:{type:Object,default:()=>({})}},setup(d){const e=d,i=[{minTemp:-1/0,maxTemp:-20,color:"#00008B",name:"深蓝色"},{minTemp:-20,maxTemp:0,color:"#1E90FF",name:"蓝色"},{minTemp:0,maxTemp:10,color:"#87CEFA",name:"浅蓝色"},{minTemp:10,maxTemp:20,color:"#32CD32",name:"绿色"},{minTemp:20,maxTemp:30,color:"#FFD700",name:"黄色"},{minTemp:30,maxTemp:40,color:"#FF8C00",name:"橙色"},{minTemp:40,maxTemp:1/0,color:"#FF0000",name:"红色"}];function r(o){const s=i.find(a=>o>a.minTemp&&o<=a.maxTemp);return s?s.color:"#CCCCCC"}const f=[{min:-1/0,max:970,level:"极低",color:"#8A2BE2",desc:"强低压系统(如台风)"},{min:970,max:990,level:"低",color:"#9370DB",desc:"低压系统(如气旋)"},{min:990,max:1010,level:"偏低",color:"#4169E1",desc:"弱低压"},{min:1010,max:1030,level:"正常",color:"#3CB371",desc:"正常气压范围"},{min:1030,max:1050,level:"偏高",color:"#FFD700",desc:"高压脊"},{min:1050,max:1/0,level:"高",color:"#FF8C00",desc:"强高压系统"}];function p(o){const s=f.find(a=>o>a.min&&o<=a.max);return s?s.color:"#CCCCCC"}const y=[{max:20,level:"极干燥",color:"#D2B48C"},{max:40,level:"干燥",color:"#F4A460"},{max:55,level:"较干燥",color:"#FFE4B5"},{max:65,level:"理想",color:"#98FB98"},{max:75,level:"较湿润",color:"#AFEEEE"},{max:85,level:"高湿",color:"#6495ED"},{max:95,level:"极高湿",color:"#4169E1"},{max:1/0,level:"饱和",color:"#9370DB"}];function $(o){const s=y.find(a=>o<=a.max);return s?s.color:"#CCCCCC"}const k=[{maxSpeed:.5,level:0,desc:"无风",color:"#FFFFFF"},{maxSpeed:1.5,level:1,desc:"软风",color:"#E6F7FF"},{maxSpeed:3.3,level:2,desc:"轻风",color:"#B3E0FF"},{maxSpeed:5.4,level:3,desc:"微风",color:"#66C2FF"},{maxSpeed:7.9,level:4,desc:"和风",color:"#4CD964"},{maxSpeed:10.7,level:5,desc:"清风",color:"#A3E043"},{maxSpeed:13.8,level:6,desc:"强风",color:"#FFCC00"},{maxSpeed:17.1,level:7,desc:"疾风",color:"#FF9500"},{maxSpeed:20.7,level:8,desc:"大风",color:"#FF6600"},{maxSpeed:24.4,level:9,desc:"烈风",color:"#FF3B30"},{maxSpeed:28.4,level:10,desc:"狂风",color:"#CC0000"},{maxSpeed:32.6,level:11,desc:"暴风",color:"#9900CC"},{maxSpeed:1/0,level:12,desc:"飓风",color:"#660066"}];function F(o){const s=k.find(a=>o<=a.maxSpeed);return s?s.color:"#000000"}const A=[{max:100,level:"极弱",color:"#1A237E"},{max:200,level:"弱",color:"#1976D2"},{max:400,level:"中等",color:"#4CAF50"},{max:600,level:"强",color:"#FFEB3B"},{max:800,level:"很强",color:"#FF9800"},{max:1e3,level:"极强",color:"#F44336"},{max:1/0,level:"危险",color:"#9C27B0"}];function u(o){const s=A.find(a=>o<=a.max);return s?s.color:"#000000"}const n=X(()=>{var o,s,a,l,S,D,B,O,T,N,b;return[{key:"envT",title:"温度",value:((o=e.data)==null?void 0:o.envT)||0,color:r(((s=e.data)==null?void 0:s.envT)||0),unit:"℃",icon:"carbon:temperature-celsius"},{key:"envH",title:"湿度",value:((a=e.data)==null?void 0:a.envH)||0,color:$(((l=e.data)==null?void 0:l.envH)||0),unit:"%",icon:"lets-icons:humidity"},{key:"qy",title:"气压",value:((S=e.data)==null?void 0:S.qy)||0,color:p(((D=e.data)==null?void 0:D.qy)||0),unit:"hPa",icon:"mdi:car-brake-low-pressure"},{key:"windS",title:"风速",value:((B=e.data)==null?void 0:B.windS)||0,color:F(((O=e.data)==null?void 0:O.windS)||0),unit:"m/s",icon:"hugeicons:slow-winds"},{key:"windD",title:"风向",value:((T=e.data)==null?void 0:T.windD)||0,color:"#00FFFF",unit:"°",icon:"mdi:windsock"},{key:"zfsdCount",title:"总辐射",value:((N=e.data)==null?void 0:N.zfsd)||0,color:u(((b=e.data)==null?void 0:b.zfsd)||0),unit:"W/㎡",icon:"material-symbols:clear-day-rounded"}]});return(o,s)=>{const a=xe;return g(),C("div",ct,[(g(!0),C(ee,null,ue(n.value,(l,S)=>(g(),C("div",{class:Z(["item",{brBom:[0,1,2].includes(S),brLeft:[0,1,3,4].includes(S)}]),key:l.key},[L(a,{icon:l.icon,class:"iconx",style:K({color:l.color})},null,8,["icon","style"]),t("div",dt,[t("div",it,_(l.title),1),t("div",ut,_(l.value)+_(l.unit),1)])],2))),128))])}}}),ft=M(mt,[["__scopeId","data-v-457a9dd9"]]),I=d=>(q("data-v-ee7e91f5"),d=d(),U(),d),pt={class:"dashboard"},_t={class:"stats-table"},vt=I(()=>t("td",{class:"label"},"CPU使用率:",-1)),ht={class:"value",colspan:"2"},wt=I(()=>t("td",{class:"label"},"内存使用率:",-1)),bt={class:"value",colspan:"2"},yt=I(()=>t("td",{class:"label"},"运行状态:",-1)),gt={class:"value",colspan:"2"},xt=I(()=>t("td",{class:"label"},"是否限电:",-1)),St={class:"value",colspan:"2"},Ct=I(()=>t("td",{class:"label"},"数据接入:",-1)),$t={class:"value",colspan:"2"},Ft=I(()=>t("td",{class:"label"},"数据上报:",-1)),kt={class:"value",colspan:"2"},Dt=I(()=>t("td",{class:"label"},"有功功率(MW):",-1)),Tt={class:"value",colspan:"2"},Lt=I(()=>t("td",{class:"label"},"无功功率(MVar):",-1)),It={class:"value",colspan:"2"},At=I(()=>t("td",{class:"label"},"更新时间:",-1)),Bt={class:"value",colspan:"2"},Mt=I(()=>t("td",{class:"label"},"功率因数:",-1)),Nt={class:"value"},Et=I(()=>t("td",{class:"label"},"日发电量(MWh):",-1)),Wt={class:"value",colspan:"2"},Ot=I(()=>t("td",{class:"label"},"总发电量(MWh):",-1)),Ht={class:"value",colspan:"2"},Pt=W({__name:"left-top",props:{data:{type:Object,default:()=>({})}},setup(d){const e=d;return(i,r)=>(g(),C("div",pt,[t("table",_t,[t("tbody",null,[t("tr",null,[vt,t("td",ht,_(e.data.cpu?e.data.cpu+"%":""),1),wt,t("td",bt,_(e.data.mem?e.data.mem+"%":""),1)]),t("tr",null,[yt,t("td",gt,_(e.data.stationP&&e.data.stationP>0&&e.data.stationControlled==0?"并网运行":e.data.stationP&&e.data.stationP>0&&e.data.stationControlled==1?"降额运行":e.data.stationP==0?"待机":""),1),xt,t("td",St,_(e.data.stationControlled==1?"是":"否"),1)]),t("tr",null,[Ct,t("td",$t,_(e.data.col=="0"?"🟢":e.data.col=="1"?"🔴":"⚪"),1),Ft,t("td",kt,_(e.data.trs=="0"?"🟢":e.data.trs=="1"?"🔴":"⚪"),1)]),t("tr",null,[Dt,t("td",Tt,_(e.data.stationP??"-"),1),Lt,t("td",It,_(e.data.stationQ??"-"),1)]),t("tr",null,[At,t("td",Bt,_(e.data.dbtime||"-"),1),Mt,t("td",Nt,_(e.data.stationCOS??"-"),1)]),t("tr",null,[Et,t("td",Wt,_(e.data.stationDayE??"-"),1),Ot,t("td",Ht,_(e.data.stationTotalE??"-"),1)])])])]))}}),Rt=M(Pt,[["__scopeId","data-v-ee7e91f5"]]),zt=d=>(q("data-v-dc930ac1"),d=d(),U(),d),Vt={class:"inner_right"},jt=zt(()=>t("div",{class:"dibu"},null,-1)),Gt={class:"info"},Jt={class:"alarmName"},qt={class:"info_bottom"},Ut={class:"alarmLevel"},Yt={class:"time"},Qt=5e3,Kt=3,Xt={__name:"left-center",props:{data:{type:Array,default:()=>[]}},setup(d){const e=d,i=[{label:"一般",color:"#0091FF",value:0},{label:"低级",color:"#ffd600",value:1},{label:"中级",color:"#ffab00",value:2},{label:"高级",color:"#ff6d00",value:3},{label:"严重",color:"#dd2c00",value:4}],r=s=>i.find(a=>a.value===s)||{},f=w(!0),p=X(()=>f.value?[...e.data,...e.data]:e.data),y=w(!1),$=w(),k=w();let F=null;const A=()=>{y.value=!0,f.value=!1,clearInterval(F)},u=()=>{y.value=!1,f.value=!0,le(()=>{n()})},n=()=>{clearInterval(F),F=setInterval(()=>{var B;if(y.value||!f.value)return;const s=$.value,a=k.value;if(!s||!a)return;const l=((B=a.children[0])==null?void 0:B.offsetHeight)||0,S=a.scrollHeight/2,D=s.scrollTop+l*Kt;D>=S?o(D,()=>{s.scrollTop=D-S}):o(D)},Qt)},o=(s,a)=>{const l=$.value,S=800,D=l.scrollTop,B=s-D,O=performance.now(),T=b=>b<.5?2*b*b:-1+(4-2*b)*b,N=b=>{const V=b-O,j=Math.min(V/S,1);l.scrollTop=D+B*T(j),j<1?requestAnimationFrame(N):a&&a()};requestAnimationFrame(N)};return te(()=>{le(()=>{n()})}),Se(()=>{clearInterval(F)}),(s,a)=>(g(),C("div",{class:Z(["left_boottom scroll-view",{"show-scrollbar":y.value}]),ref_key:"scrollViewRef",ref:$,onMouseenter:A,onMouseleave:u},[t("div",{ref_key:"listRef",ref:k,class:"left_boottom_list"},[(g(!0),C(ee,null,ue(p.value,(l,S)=>(g(),C("div",{class:"left_boottom_item",key:S},[t("div",Vt,[jt,t("div",Gt,[t("div",Jt,"告警名称："+_(l.aname),1),t("div",qt,[t("div",Ut,[Q(" 告警等级： "),t("span",{style:K({color:r(l.alevel).color,border:"1px solid "+r(l.alevel).color,padding:"0 5px",borderRadius:"5px"})},_(r(l.alevel).label),5)]),t("div",Yt,"时间："+_(l.dbtime),1)])])])]))),128))],512)],34))}},Zt=M(Xt,[["__scopeId","data-v-dc930ac1"]]),ea=W({name:"LineChart",__name:"power",props:{data:{required:!0},dataModifiers:{}},emits:["update:data"],setup(d){const e=(o,s)=>{const a=o.match(/\d+/g);return a?`rgba(${a[0]}, ${a[1]}, ${a[2]}, ${s})`:""};function i(o,s){return o===0||typeof o=="number"&&!isNaN(o)?o+s:""}const r=["rgb(233, 4, 69)","rgb(0, 150, 136)","rgb(59, 66, 146)","rgb(255, 99, 71)"],f=Ce(d,"data"),p=w(null),y=Date.now(),$=new Date(y).setHours(23,59,59,999),{domRef:k,updateOptions:F,updateOptionsAsync:A}=fe(()=>({tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}},formatter:function(o){return`
      ${o[0].axisValueLabel||""}<br/>
      <span class="round" style="background-color: ${r[0]}"></span> ${o[0].seriesName}: ${i(o[0].value[1]," MW")}<br/>
      <span class="round" style="background-color: ${r[1]}"></span> ${o[1].seriesName}: ${i(o[1].value[1]," MW")}<br/>
      <span class="round" style="background-color: ${r[2]}"></span> ${o[2].seriesName}: ${i(o[2].value[1]," W/m^2")}<br/>
      <span class="round" style="background-color: ${r[3]}"></span> ${o[3].seriesName}: ${i(o[3].value[1]," W/m^2")}<br/>
      `},backgroundColor:"#6a7985",textStyle:{color:"#d3d6dd"}},legend:{data:["实际功率","预测功率","实际辐射","预测辐射"],textStyle:{color:"#d3d6dd"}},grid:{left:"3%",right:"3%",bottom:"0%",containLabel:!0},xAxis:{type:"time",axisLabel:{formatter:"{HH}:{mm}",color:"#d3d6dd"},max:$+60*1e3,data:[]},yAxis:[{name:"功率MW",type:"value",axisLabel:{formatter:"{value} MW",color:"#d3d6dd"},splitLine:{show:!1,lineStyle:{color:"#757575",width:1}},nameTextStyle:{color:"#d3d6dd"}},{name:"辐射W/m²",type:"value",axisLabel:{formatter:"{value} W/m²",color:"#d3d6dd"},nameTextStyle:{color:"#d3d6dd"},splitLine:{show:!0,lineStyle:{color:"#757575",width:1}}}],series:[{color:r[0],name:"实际功率",type:"line",emphasis:{focus:"series"},yAxisIndex:0,lineStyle:{width:1},showSymbol:!1,areaStyle:{color:new R(0,0,0,1,[{offset:0,color:e(r[0],.3)},{offset:1,color:e(r[0],0)}],!1),shadowColor:e(r[0],.9),shadowBlur:20},data:[],connectNulls:!0},{color:r[1],name:"预测功率",type:"line",yAxisIndex:0,emphasis:{focus:"series"},lineStyle:{width:1},showSymbol:!1,areaStyle:{color:new R(0,0,0,1,[{offset:0,color:e(r[1],.3)},{offset:1,color:e(r[1],0)}],!1),shadowColor:e(r[1],.9),shadowBlur:20},data:[],connectNulls:!0},{color:r[2],name:"实际辐射",type:"line",showSymbol:!1,yAxisIndex:1,emphasis:{focus:"series"},lineStyle:{width:1},areaStyle:{color:new R(0,0,0,1,[{offset:0,color:e(r[2],.3)},{offset:1,color:e(r[2],0)}],!1),shadowColor:e(r[2],.7),shadowBlur:20},data:[],connectNulls:!0},{color:r[3],name:"预测辐射",type:"line",yAxisIndex:1,showSymbol:!1,emphasis:{focus:"series"},lineStyle:{width:1},areaStyle:{color:new R(0,0,0,1,[{offset:0,color:e(r[3],.3)},{offset:1,color:e(r[3],0)}],!1),shadowColor:e(r[3],.7),shadowBlur:20},data:[],connectNulls:!0}]}));async function u(){await new Promise(o=>{setTimeout(o,1e3)}),F(o=>{if(f.value){const s=f.value.map(a=>({dbtime:a.dbtime,prePower:a.prePower,power:a.power,zfsd:a.zfsd,ssrd:a.ssrd}));o.xAxis.data=s.map(a=>a.dbtime),o.series[0].data=s.map(a=>[a.dbtime,a.power]),o.series[1].data=s.map(a=>[a.dbtime,a.prePower]),o.series[2].data=s.map(a=>[a.dbtime,a.zfsd]),o.series[3].data=s.map(a=>[a.dbtime,a.ssrd]),console.log(o.series,"seriesseriesseries")}return o})}me(()=>f.value,o=>{A(s=>{if(f.value){const a=f.value.map(l=>({dbtime:l.dbtime,prePower:l.prePower,power:l.power,zfsd:l.zfsd,ssrd:l.ssrd}));s.xAxis.data=a.map(l=>l.dbtime),s.series[0].data=a.map(l=>[l.dbtime,l.power]),s.series[1].data=a.map(l=>[l.dbtime,l.prePower]),s.series[2].data=a.map(l=>[l.dbtime,l.zfsd]),s.series[3].data=a.map(l=>[l.dbtime,l.ssrd])}return s})});async function n(){await u()}return te(()=>{k.value=p.value}),n(),(o,s)=>(g(),C("div",{ref_key:"chartDom",ref:p,class:"chart"},null,512))}}),ta=M(ea,[["__scopeId","data-v-3741cc7e"]]),aa=W({name:"LineChart",__name:"weather-chart",props:{data:{type:Array,default:[]}},setup(d){function e(u,n){return u===0||typeof u=="number"&&!isNaN(u)?u+n:""}const i=d,r=Date.now(),f=new Date(r).setHours(23,59,59,999),{domRef:p,updateOptions:y,showLoading:$,updateOptionsAsync:k}=fe(()=>({tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}},valueFormatter:function(u){return e(u,"°C")},backgroundColor:"#6a7985",textStyle:{color:"#d3d6dd"}},legend:{data:["环境温度","预测温度","组件温度"],textStyle:{color:"#d3d6dd"}},grid:{left:"3%",right:"3%",bottom:"0%",containLabel:!0},xAxis:{type:"time",axisLabel:{formatter:"{HH}:{mm}",color:"#d3d6dd"},max:f+60*1e3,data:[]},yAxis:{name:"温度(°C)",type:"value",axisLabel:{formatter:"{value} °C",color:"#d3d6dd"},splitLine:{show:!0,lineStyle:{color:"#757575",width:1}},nameTextStyle:{color:"#d3d6dd"}},series:[{color:"#27ae60",name:"环境温度",type:"line",lineStyle:{width:1},showSymbol:!1,areaStyle:{color:new R(0,0,0,1,[{offset:0,color:"rgba(39, 174, 96,0.4)"},{offset:1,color:"rgba(39, 174, 96,0)"}],!1),shadowColor:"rgba(39, 174, 96,0.9)",shadowBlur:20},emphasis:{focus:"series"},data:[],connectNulls:!0},{color:"#c0392b",name:"预测温度",type:"line",lineStyle:{width:1},showSymbol:!1,areaStyle:{color:new R(0,0,0,1,[{offset:0,color:"rgba(192, 57, 43,0.3)"},{offset:1,color:"rgba(192, 57, 43,0)"}],!1),shadowColor:"rgba(192, 57, 43,0.9)",shadowBlur:20},emphasis:{focus:"series"},data:[],connectNulls:!0},{color:"#ffa000",name:"组件温度",type:"line",lineStyle:{width:1},showSymbol:!1,areaStyle:{color:new R(0,0,0,1,[{offset:0,color:"rgba(255, 160, 0,0.3)"},{offset:1,color:"rgba(255, 160, 0,0)"}],!1),shadowColor:"rgba(255, 160, 0,0.9)",shadowBlur:20},emphasis:{focus:"series"},data:[],connectNulls:!0}]}));async function F(){await new Promise(u=>{setTimeout(u,1e3)}),y(u=>(i.data&&(u.xAxis.data=i.data.map(n=>n.dbtime),u.series[0].data=i.data.map(n=>[n.dbtime,n.envT]),u.series[1].data=i.data.map(n=>[n.dbtime,n.tt2]),u.series[2].data=i.data.map(n=>[n.dbtime,n.moduleT])),u))}async function A(){F()}return me(()=>i.data,()=>{k(u=>(i.data&&(u.xAxis.data=i.data.map(n=>n.dbtime),u.series[0].data=i.data.map(n=>[n.dbtime,n.envT]),u.series[1].data=i.data.map(n=>[n.dbtime,n.tt2]),u.series[2].data=i.data.map(n=>[n.dbtime,n.moduleT])),u))}),A(),(u,n)=>(g(),C("div",{ref_key:"domRef",ref:p,class:"chart"},null,512))}}),oa=M(aa,[["__scopeId","data-v-ec72b241"]]),sa="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='12'%20height='12'%20viewBox='0%200%2012%2012'%3e%3cpath%20fill='%23fff'%20d='M2.5%2012c-.13%200-.25-.05-.35-.14l-2-1.93A.55.55%200%200%201%200%209.57V2.43c0-.13.06-.26.15-.36l2-1.93c.15-.14.36-.18.55-.1c.18.08.3.26.3.46v11c0%20.2-.12.38-.3.46c-.07.03-.13.04-.2.04m7-3.5c-.06%200-.13-.01-.19-.04A.5.5%200%200%201%209%208l-.01-4.06c0-.2.12-.39.31-.46c.19-.08.4-.03.54.11l1.67%201.7c.38.39.38%201.02-.01%201.41L9.85%208.35a.47.47%200%200%201-.35.15'%20/%3e%3cpath%20fill='none'%20stroke='%23fff'%20stroke-linecap='round'%20d='M2.5%202.5H6c.28%200%20.5.22.5.5v1m-4%205.5H6c.28%200%20.5-.22.5-.5V8M11%206H5'%20stroke-width='1'%20/%3e%3c/svg%3e",la={class:"content_wrap"},na={class:"d-flex jc-center title_wrap"},ra=ke('<div class="zuojuxing" data-v-566dfe32></div><div class="youjuxing" data-v-566dfe32></div><div class="guang" data-v-566dfe32></div><div class="d-flex jc-center" data-v-566dfe32><div class="title" data-v-566dfe32><span class="title-text" data-v-566dfe32>光功率预测系统可视化</span></div></div>',4),ca={class:"top_Info"},da={class:"left"},ia={class:"right"},ua={class:"setting_icon"},ma=["src"],fa={class:"index-box"},pa={class:"content_left"},_a={class:"content_right"},va=W({name:"bigscreen",__name:"index",setup(d){const e=$e(),i=Fe({dateDay:"",dateYear:"",dateWeek:"",timing:null}),r=["周日","周一","周二","周三","周四","周五","周六"];(()=>{i.timing=setInterval(()=>{i.dateDay=ne().format("YYYY-MM-DD hh : mm : ss"),i.dateWeek=r[ne().day()]},1e3)})();const p=w({}),y=async()=>{const{data:c,error:v}=await De();v||Object.assign(p.value,c)},$=async()=>{const{data:c,error:v}=await Te();v||(p.value.cpu=c.cpu,p.value.mem=c.mem)},k=w(),F=async()=>{const{data:c,error:v}=await Le({_t:new Date().getTime()});k.value=c==null?void 0:c.pname},A=w(),u=async()=>{var m;const{data:c,error:v}=await Pe();v||(A.value=c,A.value.length!=0&&(n.value=(m=c[0])==null?void 0:m.id,s()))},n=w(),o=w(),s=async()=>{const{data:c,error:v}=await Re({devId:n.value});v||(o.value=c)},a=c=>{n.value=c,s(),V()},l=Date.now(),S=new Date(l).setHours(0,0,0,0),D=new Date(l).setHours(23,59,59,999),B=w(),O=async()=>{const{data:c,error:v}=await ze({startTime:G(1,S),endTime:G(1,D),page:1,limit:100});v||(B.value=JSON.parse(JSON.stringify(c)).list)},T=w(),N=async()=>{const{data:c,error:v}=await Ie({date:G(0,Date.now())});v||(T.value=c,T.value.forEach(m=>(B.value.forEach(h=>{m.dbtime==h.dbtime&&(m.ssrd=h.ssrd)}),m)),b.value.forEach(m=>{const h=T.value.find(H=>H.dbtime===m.dbtime);h?Object.assign(h,m):T.value.push(m)}),T.value=T.value.sort((m,h)=>new Date(m.dbtime).getTime()-new Date(h.dbtime).getTime()))},b=w(),V=async()=>{if(!n.value)return;const{data:c,error:v}=await Ve({id:n.value,startTime:G(0,Date.now())+" 00:00:00",endTime:G(1,Date.now())});console.log("气象实际数据",c),b.value=c,B.value.forEach(m=>{const h=b.value.find(H=>H.dbtime===m.dbtime);h?Object.assign(h,m):b.value.push(m)}),b.value=b.value.sort((m,h)=>new Date(m.dbtime).getTime()-new Date(h.dbtime).getTime())},j=w([]),ae=async()=>{const{data:c,error:v}=await Ae({page:1,limit:20});v||(j.value=JSON.parse(JSON.stringify(c)).list)},oe=w(null),_e=()=>{var se;(se=oe.value)==null||se.close();const c=new Date().getTime(),v=Be(),m=Me(`${v}${c}getchlstatus`),h=re(m),H=re("getchlstatus"),E=new Ne(Ee+`/ChannelStatusWebsocket/${H}/${h}/${c}/${v}?token=${We()}`,{maxReconnectAttempts:3,heartbeatInterval:1e3*30});oe.value=E,E.connect(),E.onclose(()=>{}),E.onerror(()=>{}),E.onopen(()=>{}),E.onmessage(Y=>{if(console.log(Y,"通道状态websocket接受数据"),!ve(Y.data))return;const P=JSON.parse(Y.data).dataStatus;P&&(p.value.col=P.col+""=="0"||P.col+""=="1"?P.col+"":"",p.value.trs=P.trs+""=="0"||P.trs+""=="1"?P.trs+"":"")})},ve=c=>{try{return JSON.parse(c),!0}catch{return!1}},he=()=>{var c;(c=window.$dialog)==null||c.info({title:"退出登录",content:"确定要退出登录吗?",positiveText:"确定",negativeText:"取消",onPositiveClick:async()=>{const{data:v,error:m}=await Oe();m||(e.clearInfo(),window.location.reload())}})},we=w(null),be=w(null),J=w(!1);return te(async()=>{F(),_e();try{J.value=!0,await u(),await y(),await $(),await O(),await V(),await N(),await ae(),J.value=!1}catch{J.value=!1}we.value=setInterval(async()=>{await y(),await O(),await V(),await N(),await ae(),F()},1e3*60*1),be.value=setInterval(async()=>{await s(),await $()},1e3*5)}),(c,v)=>{const m=He,h=rt,H=Je;return g(),C(ee,null,[t("div",la,[t("div",na,[ra,t("div",ca,[t("div",da,[Q(_(k.value)+" ",1),L(m,{filterable:"",placeholder:"请选择气象站",value:n.value,"onUpdate:value":v[0]||(v[0]=E=>n.value=E),options:A.value,"label-field":"sname",size:"tiny","value-field":"id",style:{width:"140px","margin-left":"10px"},onUpdateValue:a},null,8,["value","options"])]),t("div",ia,[Q(_(i.dateYear)+" "+_(i.dateWeek)+" "+_(i.dateDay)+" ",1),t("div",ua,[t("img",{src:x(sa),alt:"",onClick:he},null,8,ma)])])])]),t("div",fa,[t("div",pa,[L(h,{class:"content_left-top",title:"运行状态"},{default:z(()=>[L(Rt,{data:p.value},null,8,["data"])]),_:1}),L(h,{class:"content_left-center",title:"最近告警"},{default:z(()=>[L(Zt,{data:j.value},null,8,["data"])]),_:1}),L(h,{class:"content_left-bottom",title:"气象信息"},{default:z(()=>[L(ft,{data:o.value},null,8,["data"])]),_:1})]),t("div",_a,[L(h,{class:"content_right-top",title:"今日功率"},{default:z(()=>[L(ta,{data:T.value},null,8,["data"])]),_:1}),L(h,{class:"content_right-bottom",title:"今日气象"},{default:z(()=>[L(oa,{data:b.value},null,8,["data"])]),_:1})])])]),J.value?(g(),de(H,{key:0})):ie("",!0)],64)}}}),ya=M(va,[["__scopeId","data-v-566dfe32"]]);export{ya as default};

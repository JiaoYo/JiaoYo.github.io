import{_ as oe}from"./table-header-operation.vue_vue_type_script_setup_true_lang-sZrXAUWR.js";import{d as E,q as K,v as W,s as H,K as M,o as U,c as q,w as a,g as e,i as t,U as G,af as X,L as I,h as A,t as B,$ as c,M as ne,X as Z,A as J,B as V,E as Q,D as Y,a9 as ee,x as se,b as le,r as ie,y as re,e as te,ag as pe,ah as ce,ai as ue,C as de,aa as me,ab as _e,Z as fe,ak as ye,ar as ve,am as ge,ac as O,ad as he}from"./index-BthjjP8Z.js";import{u as be,a as we}from"./table-DgUtF0JO.js";import{n as ke,o as De,f as Ne,p as Se}from"./asset-QixH9YQO.js";import{_ as xe}from"./round-search-D0y4Bi99.js";import{_ as ze}from"./round-refresh-7YBMJmxM.js";import{_ as Re}from"./FormItemGridItem-Cf_xNcQf.js";import{_ as Ce}from"./Grid-CrjQrgB8.js";import{a as Te,b as $e,_ as Ue}from"./DataTable-DVNKf1bg.js";import{h as L}from"./permission-DgnWzPLf.js";import{_ as Ae}from"./Popconfirm-DUBjdYuJ.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-P1qKwD6q.js";import"./setting-outlined-CB-n0fXZ.js";import"./round-delete-imzaxX0A.js";import"./refresh-516o5uee.js";import"./Upload-CXW3Rb5a.js";import"./Progress-CegqNBwu.js";import"./Forward-B9_DMOnd.js";const Be=E({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:K(["reset","search"],["update:model"]),setup(y,{emit:x}){const p=x,{formRef:h,restoreValidation:_}=W(),r=H(y,"model");function D(){r.value.fuzzy="",p("search")}async function z(){await _(),p("reset")}async function v(){p("search")}return(F,o)=>{const N=Z,w=Re,R=J,k=ze,u=V,b=xe,l=Q,S=Ce,d=Y,C=ee,T=M("no-space");return U(),q(C,{bordered:!1,size:"small",class:"card-wrapper"},{default:a(()=>[e(d,{ref_key:"formRef",ref:h,model:r.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:ne(v,["enter"])},{default:a(()=>[e(S,{responsive:"screen","item-responsive":""},{default:a(()=>[e(w,{span:"24 s:12 m:6",label:"一级资产分类",path:"pid",class:"pr-24px"},{default:a(()=>[e(N,{filterable:"",clearable:"",value:r.value.pid,"onUpdate:value":[o[0]||(o[0]=g=>r.value.pid=g),v],placeholder:"请选择一级资产分类",options:t(G)(t(X)),style:{width:"100%"}},null,8,["value","options"])]),_:1}),e(w,{span:"24 s:12 m:6",label:"名称",path:"fuzzy",class:"pr-24px"},{default:a(()=>[I(e(R,{clearable:"",value:r.value.fuzzy,"onUpdate:value":o[1]||(o[1]=g=>r.value.fuzzy=g),placeholder:"请输入资产二级分类名称",onClear:D},null,8,["value"]),[[T]])]),_:1}),e(w,{span:"24 m:12",class:"pr-24px"},{default:a(()=>[e(l,{class:"w-full"},{default:a(()=>[e(u,{onClick:z},{icon:a(()=>[e(k,{class:"text-icon"})]),default:a(()=>[A(" "+B(t(c)("common.reset")),1)]),_:1}),e(u,{type:"primary",ghost:"",onClick:v},{icon:a(()=>[e(b,{class:"text-icon"})]),default:a(()=>[A(" "+B(t(c)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),Fe=E({name:"OperateDrawer",__name:"operate-drawer",props:K({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:K(["submitted"],["update:visible"]),setup(y,{emit:x}){const p=y,h=x,_=H(y,"visible"),{formRef:r,validate:D,restoreValidation:z}=W(),{defaultRequiredRule:v}=se(),F=le(()=>({add:"新增资产类型",edit:"编辑资产类型"})[p.operateType]),o=ie(N());function N(){return{pid:void 0,aname:"",sysv:1}}const w={pid:{type:"number",required:!0,trigger:["blur","change"],message:"请选择资产一级分类"},aname:v};function R(){Object.assign(o,N()),p.operateType==="edit"&&p.rowData&&Object.assign(o,p.rowData)}function k(){_.value=!1}async function u(){var b,l;if(await D(),p.operateType==="add"){const{data:S,error:d}=await ke([{pid:o.pid,aname:o.aname,sysv:o.sysv}]);d||((b=window.$message)==null||b.success(c("common.addSuccess")),k(),h("submitted"))}else{const{data:S,error:d}=await De([{id:p.rowData.id,pid:o.pid,aname:o.aname,sysv:o.sysv}]);d||((l=window.$message)==null||l.success(c("common.updateSuccess")),k(),h("submitted"))}}return re(_,()=>{_.value&&(R(),z())}),(b,l)=>{const S=Z,d=de,C=J,T=$e,g=Q,s=Te,n=Y,i=V,$=me,P=_e,m=M("no-space");return U(),q(P,{show:_.value,"onUpdate:show":l[3]||(l[3]=f=>_.value=f),"display-directive":"show",width:450},{default:a(()=>[e($,{title:F.value,"native-scrollbar":!1,closable:""},{footer:a(()=>[e(g,{size:16},{default:a(()=>[e(i,{onClick:k},{default:a(()=>[A(B(t(c)("common.cancel")),1)]),_:1}),e(i,{type:"primary",onClick:u},{default:a(()=>[A(B(t(c)("common.confirm")),1)]),_:1})]),_:1})]),default:a(()=>[e(n,{ref_key:"formRef",ref:r,model:o,rules:w},{default:a(()=>[e(d,{label:"资产一级分类",path:"pid"},{default:a(()=>[e(S,{filterable:"",value:o.pid,"onUpdate:value":l[0]||(l[0]=f=>o.pid=f),placeholder:"请选择资产一级分类",options:t(G)(t(X)),style:{width:"100%"}},null,8,["value","options"])]),_:1}),e(d,{label:"资产二级分类",path:"aname"},{default:a(()=>[I(e(C,{value:o.aname,"onUpdate:value":l[1]||(l[1]=f=>o.aname=f),placeholder:"请输入资产二级分类"},null,8,["value"]),[[m]])]),_:1}),e(d,{label:"系统参数",path:"sysv"},{default:a(()=>[e(s,{value:o.sysv,"onUpdate:value":l[2]||(l[2]=f=>o.sysv=f),name:"radiogroup"},{default:a(()=>[e(g,null,{default:a(()=>[(U(!0),te(ue,null,pe(t(G)(t(ce)),(f,ae)=>(U(),q(T,{key:ae,value:f.value},{default:a(()=>[A(B(f.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Oe={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function j(y){return typeof y=="function"||Object.prototype.toString.call(y)==="[object Object]"&&!he(y)}const tt=E({name:"assetmanagement_assetgroup",__name:"index",setup(y){const x=fe(),{columns:p,columnChecks:h,data:_,getData:r,loading:D,mobilePagination:z,searchParams:v,resetSearchParams:F}=be({apiFn:Ne,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,pid:null,fuzzy:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48},{key:"pid",title:"资产一级分类",align:"center",minWidth:160,ellipsis:{tooltip:!0},render:s=>c(ye[s.pid])},{key:"aname",title:"资产二级分类",align:"center",minWidth:160,ellipsis:{tooltip:!0}},{key:"sysv",title:"是否为系统参数",align:"center",width:120,render:s=>{const n={0:"success",1:"error"},i=c(ve[s.sysv]);return e(ge,{size:"small",type:n[s.sysv]},j(i)?i:{default:()=>[i]})}},{key:"operate",title:c("common.operate"),align:"center",width:160,render:s=>{let n;return s.sysv!=0?e("div",{class:"flex-center gap-8px"},[I(e(V,{type:"primary",ghost:!0,size:"small",onClick:()=>C(s.id)},j(n=c("common.edit"))?n:{default:()=>[n]}),[[M("no-auth"),"sys.asset.type.update"]]),e(Ae,{onPositiveClick:()=>T(s.id)},{default:()=>c("common.confirmDelete"),trigger:()=>{let i;return I(e(V,{type:"error",ghost:!0,size:"small"},j(i=c("common.delete"))?i:{default:()=>[i]}),[[M("no-auth"),"sys.asset.type.delete"]])}})]):null}}]}),{drawerVisible:o,operateType:N,editingData:w,handleAdd:R,handleEdit:k,checkedRowKeys:u,onBatchDeleted:b,onDeleted:l,closeDrawer:S}=we(_,r);async function d(){console.log(u.value),g(u.value,s=>{b()})}function C(s){k(s)}function T(s){g([s],n=>{l()})}async function g(s,n){const{data:i,error:$}=await Se(s);if(!$)n&&n(i);else return!1}return(s,n)=>{const i=oe,$=Ue,P=ee;return U(),te("div",Oe,[e(Be,{model:t(v),"onUpdate:model":n[0]||(n[0]=m=>O(v)?v.value=m:null),onReset:t(F),onSearch:t(r)},null,8,["model","onReset","onSearch"]),e(P,{title:"资产类型",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":a(()=>[e(i,{columns:t(h),"onUpdate:columns":n[1]||(n[1]=m=>O(h)?h.value=m:null),"disabled-delete":t(u).length===0,loading:t(D),onAdd:t(R),onDelete:d,onRefresh:t(r),"is-view-add-button":t(L)("sys.asset.type.insert"),"is-view-delete-button":t(L)("sys.asset.type.delete")},null,8,["columns","disabled-delete","loading","onAdd","onRefresh","is-view-add-button","is-view-delete-button"])]),default:a(()=>[e($,{"checked-row-keys":t(u),"onUpdate:checkedRowKeys":n[2]||(n[2]=m=>O(u)?u.value=m:null),columns:t(p),data:t(_),size:"small","flex-height":!t(x).isMobile,"scroll-x":962,loading:t(D),remote:"","row-key":m=>m.id,pagination:t(z),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(Fe,{visible:t(o),"onUpdate:visible":n[3]||(n[3]=m=>O(o)?o.value=m:null),"operate-type":t(N),"row-data":t(w),onSubmitted:t(r)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1})])}}});export{tt as default};

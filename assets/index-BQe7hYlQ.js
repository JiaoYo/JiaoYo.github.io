import{_ as Yt}from"./table-column-setting.vue_vue_type_script_setup_true_lang-fY8m_u01.js";import{_ as ea}from"./round-delete-CDJUW-C5.js";import{_ as ta}from"./round-add-DgWQyj4X.js";import{d as He,at as qe,q as Nt,v as je,r as k,s as Pt,$,a5 as u,C as F,B as g,cy as aa,cq as na,cw as sa,cx as bt,b9 as St,az as ke,cS as la,cT as ia,cO as oa,cP as kt,a as ra,av as lt,aw as Ge,bZ as jt,b as Je,o as H,aT as Ct,f as a,bj as ua,w as i,bh as da,G as $t,F as Tt,c as ue,z as Me,h as s,bi as Ue,e as K,b8 as ca,aX as pa,N as re,g as y,ay as it,t as de,aE as Ut,dK as At,e1 as wt,e2 as ma,e3 as xt,e4 as fa,cE as ga,e5 as va,e6 as ha,dH as Dt,aH as nt,dT as ya,cX as _a,cZ as ba,cz as Sa,cH as ka,aA as Ca,aB as Ft,dG as wa,cW as xa,dS as Da,be as za,U as ot,a$ as zt,cQ as Ia,cD as Na,aF as Ke,aM as Lt,M as Pa,a_ as ja,aN as $a,i as Ta,y as Ve,aO as Be,D as $e,aP as Ua,aC as Aa,e7 as Fa,cr as La,aU as Oa}from"./index-BNVSoAe1.js";import{u as st,a as Ea}from"./table-Bc7IRs7L.js";import{_ as Ra}from"./round-plus-B9TuLq8R.js";import{_ as Ma,a as Va}from"./add2-rounded-B2JYoB5O.js";import{_ as Ba,a as Ja,A as qa}from"./index-Cxg0cKfm.js";import{f as rt,g as Ga,h as Ot,p as Ka,d as Ha}from"./business-F-i28UcY.js";import{u as Wa}from"./usePageData-Qn8L0v7U.js";import{N as Te}from"./Popconfirm-fOVGsQ7s.js";import{_ as Et}from"./Grid-Bnspya2n.js";import{_ as Rt}from"./FormItemGridItem-D8jDEAxR.js";import{_ as Xa}from"./round-search-DN4eVXbo.js";import{_ as Za}from"./round-refresh-BIjbakx1.js";import{N as Qa}from"./DatePicker-ClyBenhv.js";import{N as Ya}from"./RadioButton-4YzKlGfo.js";const en={class:"w-100%"},tn={class:"flex"},an={style:{display:"flex","flex-direction":"column"}},nn={style:{display:"flex","flex-direction":"column"}},sn={style:{display:"flex","flex-direction":"column"}},ln=He({name:"OperateDrawer",__name:"operate-drawer",props:qe({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:qe(["submitted"],["update:visible"]),setup(V,{emit:te}){const _=Nt(),Z=te,L=je({contactList:[],debuggedDevieceList:[]}),r=V,o=je(ae());function ae(){return{proname:"",dispatchIds:[],contractIds:[],proaddr:"",cpdbtime:null,prosite:"",longitude:120.373885,latitude:30.303899,period:void 0,dtype:void 0,dispatch:"",status:1}}const w=k(0),Q=k(void 0);async function se(){Object.assign(o,ae()),Wt(),r.operateType==="edit"&&r.rowData&&(Zt(),Object.assign(o,r.rowData),w.value=o.period,Q.value=o.status,await gt(),ht(o.proaddr||o.prosite),Jt())}const{formRef:z,validate:O,restoreValidation:v}=Pt(),C={proname:{type:"string",required:!0,trigger:["blur","change"],message:"请输入项目名称"},status:{type:"number",required:!0,trigger:["blur","change"],message:"请选择项目状态"},contractIds:{type:"array",required:!0,trigger:["blur","change"],message:"请选择合同"},dtype:{type:"number",required:!0,trigger:["blur","change"],message:"请选择调试类型"},period:{type:"number",required:!0,trigger:["blur","change"],message:"请输入周期"},prosite:{type:"string",required:!0,trigger:["blur","change","focus"],message:"请选择项目地点"},cpdbtime:{type:"string",required:!0,trigger:["blur","change"],message:"请选择时间"}},h=k([]),I=je({page:1,pageSize:20,showSizePicker:!0,fuzzy:"",pageSizes:[20],prefix:()=>`共 ${h.value.length} 条`,onChange:e=>{I.page=e,b()},onUpdatePageSize:e=>{I.pageSize=e,I.page=1,b()}}),U=[{title:"姓名",key:"pname",align:"center",render(e,t){return e.setStatus?u(F,{value:e.pname,placeholder:"请输入姓名",onUpdateValue(n){h.value[t].pname=n}}):u("div",{},e.pname)}},{title:"联系方式",key:"pcontact",align:"center",render(e,t){return e.setStatus?u(F,{value:e.pcontact,placeholder:"请输入联系方式",onUpdateValue(n){h.value[t].pcontact=n}}):u("div",{},e.pcontact)}},{title:"备注",key:"proposition",align:"center",render(e,t){return e.setStatus?u(F,{value:e.proposition,placeholder:"请输入备注",onUpdateValue(n){h.value[t].proposition=n}}):u("div",{},e.proposition)}},{key:"operate",title:$("common.operate"),align:"center",minWidth:120,fixed:"right",render(e,t){return u("div",{class:"flex-center gap-8px"},[e.setStatus?[u(g,{type:"primary",ghost:!0,size:"small",onClick:()=>ce(e)},{default:()=>"保存"}),u(g,{type:"default",ghost:!0,size:"small",onClick:()=>Y(e,t)},{default:()=>"取消"}),u(Te,{onPositiveClick:()=>{r.operateType==="edit"&&e.id?aa(e.id).then(()=>{var n;h.value.splice(t,1),(n=window.$message)==null||n.success("删除成功")}):h.value.splice(t,1)}},{default:()=>$("common.confirmDelete"),trigger:()=>u(g,{type:"error",ghost:!0,size:"small"},{default:()=>$("common.delete")})})]:u(g,{type:"primary",ghost:!0,size:"small",onClick:()=>E(e)},{default:()=>"编辑"})])}}],b=async()=>{var t;const{data:e}=await na({page:I.page,limit:I.pageSize,pid:(t=r.rowData)==null?void 0:t.id});h.value=e==null?void 0:e.list,h.value.forEach(n=>{n.setStatus=!1}),L.contactList=JSON.parse(JSON.stringify(h.value))},E=e=>{h.value.forEach(t=>{t.setStatus=!1}),e.setStatus=!e.setStatus},Y=(e,t)=>{e.setStatus=!e.setStatus,e.id?h.value=JSON.parse(JSON.stringify(L.contactList)):h.value.splice(t,1)},ce=async e=>{var t,n,d,f,x;if(!e.pname){(t=window.$message)==null||t.warning("请输入联系人姓名");return}if(!e.pcontact){(n=window.$message)==null||n.warning("请输入联系方式");return}if(r.operateType==="edit")if(e.id){const{data:T,error:S}=await sa([e]);S||((d=window.$message)==null||d.success("修改成功"),b(),e.setStatus=!e.setStatus)}else{const{data:T,error:S}=await bt([{...e,pid:(f=r.rowData)==null?void 0:f.id}]);S||((x=window.$message)==null||x.success("添加成功"),b(),e.setStatus=!e.setStatus)}else e.setStatus=!e.setStatus};function pe(){var e;((e=h.value[0])!=null&&e.pname||h.value.length==0)&&h.value.unshift({pname:"",pcontact:"",proposition:"",setStatus:!0})}const m=k([]),A=je({page:1,pageSize:20,showSizePicker:!0,fuzzy:"",pageSizes:[20],prefix:()=>`共 ${m.value.length} 条`,onChange:e=>{A.page=e,j()},onUpdatePageSize:e=>{A.pageSize=e,A.page=1,j()}}),ze=[{title:"设备名称",key:"devname",align:"center",render(e,t){return e.setStatus?u(F,{value:e.devname,placeholder:"请输入设备名称",onUpdateValue(n){m.value[t].devname=n}}):u("div",{},e.devname)}},{title:"型号",key:"devmodel",align:"center",render(e,t){return e.setStatus?u(F,{value:e.devmodel,placeholder:"请输入型号",onUpdateValue(n){m.value[t].devmodel=n}}):u("div",{},e.devmodel)}},{title:"数量",key:"devnum",align:"center",render(e,t){return e.setStatus?u(St,{value:e.devnum,placeholder:"请输入数量",onUpdateValue(n){m.value[t].devnum=Number(n)||0}}):u("div",{},e.devnum)}},{title:"是否为我司设备",key:"etype",align:"center",render(e,t){return e.setStatus?u(ke,{value:e.etype,options:[{label:"是",value:0},{label:"否",value:1}],onUpdateValue(n){m.value[t].etype=n}}):u("div",{},e.etype===0?"是":"否")}},{title:"设备厂家",key:"devmanu",align:"center",render(e,t){return e.setStatus?u(F,{value:e.devmanu,placeholder:"请输入设备厂家",onUpdateValue(n){m.value[t].devmanu=n}}):u("div",{},e.devmanu)}},{title:"备注",key:"notes",align:"center",render(e,t){return e.setStatus?u(F,{value:e.notes,placeholder:"请输入备注",onUpdateValue(n){m.value[t].notes=n}}):u("div",{},e.notes)}},{title:"清点状态",key:"status",align:"center",render(e,t){return e.setStatus?u(ke,{value:e.status,options:[{label:"未清点",value:0},{label:"正常",value:1},{label:"增补",value:2},{label:"退货",value:3},{label:"换货",value:4}],onUpdateValue(n){m.value[t].status=n}}):u("div",{},e.status===0?"未清点":e.status===1?"正常":e.status===2?"增补":e.status===3?"退货":"换货")}},{key:"operate",title:$("common.operate"),align:"center",width:180,fixed:"right",render(e,t){return u("div",{class:"flex-center gap-8px"},[e.setStatus?[u(g,{type:"primary",ghost:!0,size:"small",onClick:()=>Xe(e)},{default:()=>"保存"}),u(g,{type:"default",ghost:!0,size:"small",onClick:()=>Ce(e,t)},{default:()=>"取消"}),u(Te,{onPositiveClick:()=>{r.operateType==="edit"&&e.id?la(e.id).then(()=>{var n;m.value.splice(t,1),(n=window.$message)==null||n.success("删除成功")}):m.value.splice(t,1)}},{default:()=>$("common.confirmDelete"),trigger:()=>u(g,{type:"error",ghost:!0,size:"small"},{default:()=>$("common.delete")})})]:u(g,{type:"primary",ghost:!0,size:"small",onClick:()=>We(e)},{default:()=>"编辑"})])}}],j=async()=>{var t;const{data:e}=await ia({page:A.page,limit:A.pageSize,fuzzy:A.fuzzy,pid:(t=r.rowData)==null?void 0:t.id});m.value=e.list,L.debuggedDevieceList=JSON.parse(JSON.stringify(m.value))},We=e=>{m.value.forEach(t=>{t.setStatus=!1}),e.setStatus=!e.setStatus},Ce=(e,t)=>{e.setStatus=!e.setStatus,e.id?m.value=JSON.parse(JSON.stringify(L.debuggedDevieceList)):m.value.splice(t,1)},Xe=async e=>{var n,d,f,x,T,S;if(!e.devname){(n=window.$message)==null||n.warning("设备名称不能为空");return}if(!e.devmodel){(d=window.$message)==null||d.warning("设备型号不能为空");return}if(!e.devnum){(f=window.$message)==null||f.warning("设备数量不能为空");return}const t=e.dcreater*1;if(r.operateType==="edit")if(e.id){const{data:J,error:R}=await oa([{...e,dcreater:t}]);R||((x=window.$message)==null||x.success("修改成功"),j(),e.setStatus=!e.setStatus)}else{const{data:J,error:R}=await kt([{...e,pid:(T=r.rowData)==null?void 0:T.id,dcreater:t}]);R||((S=window.$message)==null||S.success("添加成功"),j(),e.setStatus=!e.setStatus)}else e.setStatus=!e.setStatus};function Ae(){var e;((e=m.value[0])!=null&&e.devname||m.value.length==0)&&m.value.unshift({status:void 0,devmanu:"",etype:0,devname:"",devmodel:"",devnum:0,notes:"",setStatus:!0})}const Fe=k({}),l=k([]);async function c(){var t;l.value=[];const{data:e}=await Da({page:1,limit:100,pid:(t=r.rowData)==null?void 0:t.id});e.list.forEach(n=>{n.sort==1&&l.value.push({id:n.id,name:n.filename,url:n.file,status:"finished",creator:n.username,dbtime:n.dbtime})}),l.value.reverse(),Fe.value=JSON.parse(JSON.stringify(e))}const me=[{title:"文件别名",key:"name",align:"center",width:200,render(e){return e.setStatus?u(F,{value:e.name,onUpdateValue:t=>{e.name=t}}):u("div",{},e.name)}},{title:"文件名称",key:"filename",align:"center",width:200,render(e){return e.setStatus&&!e.url?u("div",{style:"display: flex; justify-content: center; align-items: center;"},[u(Ca,{action:"#",showFileList:!1,customRequest:async({file:n,onFinish:d,onError:f})=>{var x,T;try{e.status=!0;const{data:S,error:J}=await xa(n.file,R=>{e.progress=R});S&&(e.url=S,e.status=!1)}catch(S){console.error(S),(T=(x=window.$message)==null?void 0:x.error)==null||T.call(x,"文件上传出错"),e.status=!1}}},{default:()=>u(g,{type:"info",size:"small",ghost:!0,loading:e.status},{default:()=>"上传文件"})}),e.progress?u(Ft,{type:"line",percentage:e.progress,indicatorPlacement:"inside",processing:!0}):null]):e.setStatus&&e.url&&!e.id?a("span",null,[e.url.split("?")[1],y(" "),a("span",{onClick:()=>e.url="",style:"color: red;cursor: pointer;font-size: 12px;"},[y("删除")])]):u("div",{},e.url.split("?")[1])}},{title:"上传人",key:"creator",align:"center",width:100,render(e){return u("div",{},e.creator)}},{title:"上传时间",key:"dbtime",align:"center",width:200,render(e){return u("div",{},e.dbtime?e.dbtime:"")}},{title:"操作",key:"actions",align:"center",width:180,render(e){return u(re,{justify:"center"},[!e.setStatus&&e.id&&u(g,{type:"info",size:"small",ghost:!0,onClick:()=>{fe(e)}},{default:()=>"下载"}),e.setStatus&&u(g,{type:"info",size:"small",ghost:!0,onClick:()=>{Ze(e)}},{default:()=>"保存"}),e.setStatus&&u(g,{type:"info",size:"small",ghost:!0,onClick:()=>{e.setStatus=!e.setStatus}},{default:()=>"取消"}),!e.setStatus&&u(g,{type:"info",size:"small",ghost:!0,onClick:()=>{e.setStatus=!e.setStatus}},{default:()=>"编辑"})])}}];async function fe(e){if(e!=null&&e.url)try{const n=await(await fetch(e.url.split("?")[0],{mode:"cors"})).blob(),d=URL.createObjectURL(n),f=document.createElement("a");f.href=d,f.download=e.url.split("?")[1],f.style.display="none",document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(d)}catch(t){console.error("下载失败:",t)}}const ge=()=>{l.value.push({id:"",name:"",url:"",status:"uploading",setStatus:!0})},Ze=async e=>{var t,n,d,f,x,T,S,J,R,ye,_e,be;if(!e.name){(n=(t=window.$message)==null?void 0:t.warning)==null||n.call(t,"请输入文件别名");return}if(!e.url){(f=(d=window.$message)==null?void 0:d.warning)==null||f.call(d,"请上传文件");return}if((x=r.rowData)!=null&&x.id){const{data:q,error:Se}=await Dt([{pid:(T=r.rowData)==null?void 0:T.id,filename:e.name,file:e.url,sort:1}]);if(Se)return(S=window.$message)==null?void 0:S.error("保存文件记录失败");(J=window.$message)==null||J.destroyAll(),e.setStatus=!e.setStatus,c(),(R=window.$message)==null||R.success("保存成功")}else if(e.id){const{data:q,error:Se}=await wa([{id:e.id,filename:e.name}]);if(Se)return(ye=window.$message)==null?void 0:ye.error("保存文件记录失败");(_e=window.$message)==null||_e.destroyAll(),e.setStatus=!e.setStatus,(be=window.$message)==null||be.success("编辑成功")}else e.setStatus=!e.setStatus},Qe=ra(()=>({add:"新增项目",edit:"修改项目"})[r.operateType]),ve=lt(V,"visible");Ge(ve,()=>{ve.value&&(se(),setTimeout(()=>{const e=document.querySelector(".n-scrollbar-content");e==null||e.scrollTo(0,0)},300),v())});function Ye(e){e||ee()}function ee(){ve.value=!1}async function Ie(){var e;await O(),(e=window.$dialog)==null||e.info({title:"提示",content:"确定提交吗？",positiveText:"确定",negativeText:"取消",onPositiveClick:async()=>{await N()}})}async function N(){var e,t,n,d,f,x,T,S,J,R,ye,_e,be;if(r.operateType==="edit"){const q=JSON.parse(JSON.stringify(o));w.value==q.period&&delete q.period,Q.value==q.status&&delete q.status;const{data:Se,error:p}=await At([q]);if(!p){let G=function(M,W){const X=M.filter(oe=>!W.includes(oe)),xe=W.filter(oe=>!M.includes(oe));return{toDelete:X,toAdd:xe}};if((e=o.dispatchIds)!=null&&e.length&&((t=o.dispatchIds)==null?void 0:t.length)>0){const{toDelete:M,toAdd:W}=G(mt.value,o.dispatchIds);if(W.length>0){const X=W.map(Re=>({pid:o.id,did:Re})),{data:xe,error:oe}=await wt(X)}if(M.length>0){const{data:X,error:xe}=await ma(M.join(","))}}if((n=o.contractIds)!=null&&n.length&&((d=o.contractIds)==null?void 0:d.length)>0){const{toDelete:M,toAdd:W}=G(yt.value,o.contractIds);if(W.length>0){const X=W.map(Re=>({pid:o.id,did:Re})),{data:xe,error:oe}=await xt(X)}if(M.length>0){const{data:X,error:xe}=await fa(M.join(","))}}ee(),Z("submitted"),(f=window.$message)==null||f.success("修改成功")}}else{const q=ga(),{data:Se,error:p}=await va([{...o,uuid:q}]);if(!p){const{data:G,error:M}=await ha(q);if(G){let W=function(D,De,_t){return D.map(Pe=>({...Pe,pid:De}))};if(o.dispatchIds&&o.dispatchIds.length>0){const D=[];(x=o.dispatchIds)==null||x.forEach(async Pe=>{D.push({pid:G,did:Pe})});const{data:De,error:_t}=await wt(D)}if(o.contractIds&&o.contractIds.length>0){const D=[];(T=o.contractIds)==null||T.forEach(async Pe=>{D.push({proid:G,conid:Pe})});const{data:De,error:_t}=await xt(D)}const X=[];if(h.value.length>0){const D=W(h.value,G);X.push(bt(D))}if(m.value.length>0){const D=W(m.value,G);X.push(kt(D))}if((await Promise.allSettled(X)).forEach((D,De)=>{D.status==="fulfilled"?console.log(`第 ${De+1} 个请求成功`,D.value):console.error(`第 ${De+1} 个请求失败`,D.reason)}),!l.value.length){(S=window.$message)==null||S.destroyAll(),(J=window.$message)==null||J.success("操作成功"),ee(),Z("submitted");return}const oe=[];l.value.forEach(D=>{oe.push({pid:G,filename:D.name,file:D.url,sort:1})});const{data:Re,error:Qt}=await Dt(oe);Qt&&((R=window.$message)==null||R.error("保存文件记录失败")),(ye=window.$message)==null||ye.destroyAll(),(_e=window.$message)==null||_e.success("操作成功"),ee(),Z("submitted")}}ee(),Z("submitted"),(be=window.$message)==null||be.success("添加成功")}}const he=k(!1),et=k();let we=null,ut=null,Le=null,dt=null,le=null;const ne=je({longitude:0,latitude:0});let Ne;const Oe=k(!1),ie=k(""),Ee=k([]);async function Mt(){window._AMapSecurityConfig={securityJsCode:_.userInfo.sdksecret},et.value&&(le=await qa.load({key:_.userInfo.sdkkey,version:"2.0",plugins:["AMap.Scale","AMap.PlaceSearch","AMap.AutoComplete","AMap.Geocoder","AMap.Geolocation"]}),we=new le.Map(et.value,{zoom:18,center:[P.value>0?B.value[P.value-1].longitude:o.longitude,P.value>0?B.value[P.value-1].latitude:o.latitude],viewMode:"3D",resizeEnable:!0}),ut=new le.Geocoder,new le.PlaceSearch({city:"全国",pageSize:50}),dt=new le.AutoComplete({city:"全国"}),tt(le,{lng:P.value>0?B.value[P.value-1].longitude:o.longitude,lat:P.value>0?B.value[P.value-1].latitude:o.latitude}),we.on("click",e=>{const{lng:t,lat:n}=e.lnglat;Ne=2,ne.latitude=n,ne.longitude=t,tt(le,{lng:t,lat:n})}),nt(()=>window.dispatchEvent(new Event("resize"))))}const ct=jt.debounce(async e=>{if(!Oe.value||!e.trim()){Ee.value=[];return}dt.search(e,(t,n)=>{var d;console.log(n,"result"),t=="complete"&&n.info=="OK"&&((d=n==null?void 0:n.tips)!=null&&d.length)?Ee.value=n.tips.map(f=>({label:`${f.name}（${f.district||f.address||"无详细地址"}）`,value:`${f.location.lng}_${f.location.lat}`,raw:f})):Ee.value=[]})},300);Ge(ie,e=>{ct(e)});function Vt(e,t){if(console.log(e,t,"option"),!e)return;const[n,d]=e.split("_").map(Number);!n||!d||(we.setCenter([n,d]),Ne=1,tt(le,{lng:n,lat:d}),ne.longitude=n,ne.latitude=d)}const P=k(0);function pt(e){e?P.value=e:P.value=0,he.value=!0,Oe.value=!1,Ne=void 0,nt(async()=>{await Mt(),setTimeout(()=>{Oe.value=!0;const t=document.querySelector(".n-auto-complete input");t==null||t.blur()},500)})}function tt(e,t){Le&&we.remove(Le),Le=new e.Marker({position:[t.lng,t.lat],map:we}),we.add(Le),ut.getAddress(t,(n,d)=>{n==="complete"&&d.regeocode&&(console.log("result",d),console.log("formattedAddress",d.regeocode.formattedAddress),t.latitude=t.lat,t.longitude=t.lng,Ne==1||(Ne==2?ie.value=d.regeocode.formattedAddress:ie.value=P.value>0?B.value[P.value-1].address||d.regeocode.formattedAddress:o.prosite||d.regeocode.formattedAddress))})}function Bt(e,t){if(!t)return null;const n=t.replace(/省|市|特别行政区|自治区|壮族|回族|维吾尔/g,"").trim(),d=e.find(f=>t.includes(f.name)||f.name.includes(n));return d?d.id:null}const mt=k([]),Jt=async()=>{const{data:e,error:t}=await ya({page:1,limit:100,pid:r.rowData.id});o.dispatchIds=e==null?void 0:e.list.map(n=>n.did),mt.value=JSON.parse(JSON.stringify(o.dispatchIds))},ft=k([]),gt=async()=>{const{data:e,error:t}=await _a();e&&(ft.value=e)},vt=k([]),ht=async e=>{let t=Bt(ft.value,e);const{data:n,error:d}=await ba({page:1,limit:100,province:t});vt.value=n.list},qt=async()=>{P.value==0?(o.latitude=ne.latitude,o.longitude=ne.longitude,o.prosite=ie.value,await gt(),ht(ie.value)):(B.value[P.value-1].address=ie.value,B.value[P.value-1].latitude=ne.latitude,B.value[P.value-1].longitude=ne.longitude),he.value=!1,P.value=0,console.log(o,ne)};function Gt(){he.value=!1}const{pageData:at,getData:Kt,nextPage:Ht}=Wa(Sa),Wt=async()=>{await Kt({limit:100})},Xt=async e=>{const t=e.currentTarget,n=t.scrollTop;t.scrollTop+t.offsetHeight>=t.scrollHeight&&at.data.length<at.total&&(await Ht(),await nt(),setTimeout(()=>{t.scrollTop=n}))},yt=k([]),Zt=async()=>{var n;const{data:e,error:t}=await ka({page:1,limit:100,proid:(n=r.rowData)==null?void 0:n.id});o.contractIds=e==null?void 0:e.list.map(d=>d.conid),yt.value=JSON.parse(JSON.stringify(o.contractIds))},B=k([]);return(e,t)=>{const n=Rt,d=Ba,f=ca,x=Ma,T=Va,S=Ra,J=it,R=Et,ye=$t,_e=da,be=ua,q=Ja,Se=Ut;return H(),Je(Ct,null,[a(be,{show:ve.value,"onUpdate:show":[t[11]||(t[11]=p=>ve.value=p),Ye],"display-directive":"show",width:1100,onMaskClick:ee,onEsc:ee},{default:i(()=>[a(_e,{title:Qe.value,"native-scrollbar":!1,closable:""},{footer:i(()=>[a(s(re),{size:16,justify:"end"},{default:i(()=>[a(s(g),{onClick:ee},{default:i(()=>[y(de(s($)("common.cancel")),1)]),_:1}),a(s(g),{type:"primary",onClick:Ie},{default:i(()=>[y(de(s($)("common.confirm")),1)]),_:1})]),_:1})]),default:i(()=>[a(ye,{ref_key:"formRef",ref:z,model:o,rules:C,onKeyup:Tt(Ie,["enter"])},{default:i(()=>[a(R,{responsive:"screen","item-responsive":"","x-gap":"15"},{default:i(()=>[a(n,{span:"24 s:12 m:12",label:"项目名称",path:"proname"},{default:i(()=>[a(s(F),{clearable:"",value:o.proname,"onUpdate:value":t[0]||(t[0]=p=>o.proname=p),placeholder:"请输入项目名称"},null,8,["value"])]),_:1}),r.operateType==="add"?(H(),ue(n,{key:0,span:"24 s:12 m:12",label:"绑定合同",path:"contractIds"},{default:i(()=>[a(s(ke),{filterable:"",multiple:"",value:o.contractIds,"onUpdate:value":t[1]||(t[1]=p=>o.contractIds=p),placeholder:"请选择合同","label-field":"contractname","value-field":"id",options:s(at).data,onScroll:Xt},null,8,["value","options"])]),_:1})):Me("",!0),r.operateType==="edit"?(H(),ue(n,{key:1,span:"24 s:12 m:12",label:"项目状态",path:"status"},{default:i(()=>[a(s(ke),{filterable:"",value:o.status,"onUpdate:value":t[2]||(t[2]=p=>o.status=p),placeholder:"请选择项目状态",options:s(Ue)(s(_).userInfo.usertype==0||s(_).userInfo.usertype==2?s(rt):s(Ga))},null,8,["value","options"])]),_:1})):Me("",!0),a(n,{span:"24 s:12 m:12",label:"周期（天）",path:"period"},{default:i(()=>[a(s(St),{clearable:"",value:o.period,"onUpdate:value":t[3]||(t[3]=p=>o.period=p),style:{width:"100%"},placeholder:"请输入周期"},null,8,["value"])]),_:1}),a(n,{span:"24 s:12 m:12",label:"调试类型",path:"dtype"},{default:i(()=>[a(s(ke),{filterable:"",value:o.dtype,"onUpdate:value":t[4]||(t[4]=p=>o.dtype=p),placeholder:"请选择调试类型",options:s(Ue)(s(Ot))},null,8,["value","options"])]),_:1}),a(n,{span:"24 s:12 m:12",label:"项目地点",path:"prosite"},{default:i(()=>[K("div",en,[K("div",tn,[a(f,{onClick:t[6]||(t[6]=p=>pt())},{default:i(()=>[a(s(F),{value:o.prosite,"onUpdate:value":t[5]||(t[5]=p=>o.prosite=p),placeholder:"请选择项目地点"},null,8,["value"]),a(s(g),null,{icon:i(()=>[a(d,{class:"text-icon"})]),_:1})]),_:1}),a(s(g),{onClick:t[7]||(t[7]=p=>B.value.push({latitude:30.303899,longitude:120.373885,address:""}))},{icon:i(()=>[a(x,{class:"text-icon"})]),_:1})]),(H(!0),Je(Ct,null,pa(B.value,(p,G)=>(H(),Je("div",{class:"flex items-center mt-10px",key:p.latitude},[a(f,{onClick:M=>pt(G+1)},{default:i(()=>[a(s(F),{value:p.address,"onUpdate:value":M=>p.address=M,placeholder:"请选择项目地点"+G+1},null,8,["value","onUpdate:value","placeholder"]),a(s(g),null,{icon:i(()=>[a(d,{class:"text-icon"})]),_:1})]),_:2},1032,["onClick"]),a(T,{class:"font-size-24px cursor-pointer ml-10px",onClick:M=>B.value.splice(B.value.indexOf(p),1)},null,8,["onClick"])]))),128))])]),_:1}),a(n,{span:"24 s:12 m:12",label:"项目详细地址",path:"proaddr"},{default:i(()=>[a(s(F),{type:"textarea",rows:1,clearable:"",value:o.proaddr,"onUpdate:value":t[8]||(t[8]=p=>o.proaddr=p),placeholder:"请输入项目详细地址"},null,8,["value"])]),_:1}),a(n,{span:"24 s:12 m:12",label:"调度名称",path:"dispatch"},{default:i(()=>[a(s(F),{clearable:"",value:o.dispatch,"onUpdate:value":t[9]||(t[9]=p=>o.dispatch=p),placeholder:"请输入调度名称"},null,8,["value"])]),_:1}),a(n,{span:"24 s:12 m:12",label:"选择调度",path:"dispatchIds"},{default:i(()=>[a(s(ke),{filterable:"",multiple:"",value:o.dispatchIds,"onUpdate:value":t[10]||(t[10]=p=>o.dispatchIds=p),placeholder:"请选择所属项目","label-field":"dname","value-field":"id",options:vt.value},null,8,["value","options"])]),_:1}),a(n,{span:"24 s:12 m:24",path:"contactList"},{default:i(()=>[K("div",an,[a(s(re),{align:"center",style:{"margin-bottom":"10px"}},{default:i(()=>[t[15]||(t[15]=K("span",null,"项目联系人",-1)),a(s(g),{size:"small",ghost:"",type:"primary",onClick:pe},{icon:i(()=>[a(S,{class:"text-icon"})]),default:i(()=>[t[14]||(t[14]=y(" 添加项目联系人 "))]),_:1,__:[14]})]),_:1,__:[15]}),a(J,{columns:U,"paginate-single-page":!1,data:h.value,pagination:I,"max-height":350},null,8,["data","pagination"])])]),_:1}),a(n,{span:"24 s:12 m:24",path:"debuggedDevieceList"},{default:i(()=>[K("div",nn,[a(s(re),{align:"center",style:{"margin-bottom":"10px"}},{default:i(()=>[t[17]||(t[17]=K("span",null,"待调试设备",-1)),a(s(g),{size:"small",ghost:"",type:"primary",onClick:Ae},{icon:i(()=>[a(S,{class:"text-icon"})]),default:i(()=>[t[16]||(t[16]=y(" 添加待调试设备 "))]),_:1,__:[16]})]),_:1,__:[17]}),a(J,{columns:ze,"paginate-single-page":!1,data:m.value,pagination:A,"max-height":350},null,8,["data","pagination"])])]),_:1}),a(n,{span:"24 s:12 m:24"},{default:i(()=>[K("div",sn,[a(s(re),{align:"center",style:{"margin-bottom":"10px"}},{default:i(()=>[t[19]||(t[19]=K("span",null,"图纸",-1)),a(s(g),{size:"small",ghost:"",type:"primary",onClick:ge},{icon:i(()=>[a(S,{class:"text-icon"})]),default:i(()=>[t[18]||(t[18]=y(" 添加图纸 "))]),_:1,__:[18]})]),_:1,__:[19]}),l.value.length>0?(H(),ue(J,{key:0,columns:me,data:l.value,size:"small","scroll-x":702,"row-key":p=>p.id,"max-height":350},null,8,["data","row-key"])):Me("",!0)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"]),a(Se,{show:he.value,"onUpdate:show":t[13]||(t[13]=p=>he.value=p),title:"选择项目位置",preset:"card",class:"w-800px"},{footer:i(()=>[a(s(re),{justify:"end",size:16},{default:i(()=>[a(s(g),{onClick:Gt},{default:i(()=>[y(de(s($)("common.cancel")),1)]),_:1}),a(s(g),{type:"primary",onClick:qt},{default:i(()=>[y(de(s($)("common.confirm")),1)]),_:1})]),_:1})]),default:i(()=>[Oe.value?(H(),ue(q,{key:0,value:ie.value,"onUpdate:value":[t[12]||(t[12]=p=>ie.value=p),s(ct)],options:Ee.value,placeholder:"请输入地点关键字",clearable:"",onSelect:Vt},null,8,["value","options","onUpdate:value"])):Me("",!0),K("div",{ref_key:"domRef",ref:et,class:"h-full w-full",style:{width:"100%",height:"500px","margin-top":"10px"}},null,512)]),_:1},8,["show"])],64)}}}),on=He({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:qe(["reset","search"],["update:model"]),setup(V,{emit:te}){za();const _=te,{formRef:Z,restoreValidation:L}=Pt(),r=lt(V,"model"),o={当日:()=>{const v=new Date().getTime();return[v,v]},本周:()=>{const v=new Date().getTime();return[v-24*60*60*1e3*7,v]},上月:()=>{const v=new Date().getTime();return[v-24*60*60*1e3*30,v]},近一年:()=>{const v=new Date().getTime();return[v-24*60*60*1e3*365,v]},近三年:()=>{const v=new Date().getTime();return[v-24*60*60*1e3*365*3,v]}};function ae(){r.value.fuzzy="",_("search")}async function w(v,C){if(!v){r.value.startTime=void 0,r.value.endTime=void 0,_("search");return}r.value.startTime=String(zt(1,C[0])),r.value.endTime=String(zt(1,C[1])),_("search")}async function Q(){r.value.startTime=void 0,r.value.endTime=void 0,r.value.startAndTimeRange=null,r.value.fuzzy="",r.value.status=null,r.value.ptype=null,r.value.dtype=null,await L(),_("reset")}const se=jt.debounce(v=>{_("search")},1e3,{leading:!0,trailing:!1}),z=v=>{r.value.fuzzy=v,se(v)};async function O(){_("search")}return(v,C)=>{const h=F,I=Rt,U=ke,b=Qa,E=Za,Y=g,ce=Xa,pe=re,m=Et,A=$t,ze=ot;return H(),ue(ze,{bordered:!1,size:"small",class:"card-wrapper"},{default:i(()=>[a(A,{ref_key:"formRef",ref:Z,model:r.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:Tt(O,["enter"])},{default:i(()=>[a(m,{responsive:"screen","item-responsive":"","x-gap":16,"y-gap":16},{default:i(()=>[a(I,{span:"24 s:12 m:6",label:"项目/客户",path:"fuzzy"},{default:i(()=>[a(h,{clearable:"",value:r.value.fuzzy,"onUpdate:value":C[0]||(C[0]=j=>r.value.fuzzy=j),placeholder:"请输入项目名称或客户名称",onClear:ae,onInput:z},null,8,["value"])]),_:1}),a(I,{span:"24 s:12 m:6",label:"项目状态",path:"status"},{default:i(()=>[a(U,{clearable:"",filterable:"",value:r.value.status,"onUpdate:value":[C[1]||(C[1]=j=>r.value.status=j),O],placeholder:"请选择项目状态",options:s(Ue)(s(rt))},null,8,["value","options"])]),_:1}),a(I,{span:"24 s:12 m:6",label:"进度状态",path:"ptype"},{default:i(()=>[a(U,{clearable:"",filterable:"",value:r.value.ptype,"onUpdate:value":[C[2]||(C[2]=j=>r.value.ptype=j),O],placeholder:"请选择进度状态",options:[{label:"正常",value:0},{label:"已延期",value:1}]},null,8,["value"])]),_:1}),a(I,{span:"24 s:12 m:6",label:"调试类型",path:"dtype"},{default:i(()=>[a(U,{clearable:"",filterable:"",value:r.value.dtype,"onUpdate:value":[C[3]||(C[3]=j=>r.value.dtype=j),O],placeholder:"请选择调试类型",options:s(Ue)(s(Ot))},null,8,["value","options"])]),_:1}),a(I,{span:"24 s:12 m:8",label:"起止时间"},{default:i(()=>[a(b,{value:r.value.startAndTimeRange,"onUpdate:value":C[4]||(C[4]=j=>r.value.startAndTimeRange=j),type:"datetimerange",clearable:"",shortcuts:o,"onUpdate:formattedValue":w},null,8,["value"])]),_:1}),a(I,{span:"24  s:12 m:6",class:"pr-24px"},{default:i(()=>[a(pe,{class:"w-full"},{default:i(()=>[a(Y,{onClick:Q},{icon:i(()=>[a(E,{class:"text-icon"})]),default:i(()=>[y(" "+de(s($)("common.reset")),1)]),_:1}),a(Y,{type:"primary",ghost:"",onClick:O},{icon:i(()=>[a(ce,{class:"text-icon"})]),default:i(()=>[y(" "+de(s($)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),rn={class:"min-h-500px flex gap-16px"},un={class:"flex items-center justify-end gap-16px"},dn=He({__name:"relatedContractLook",props:qe({id:{}},{visable:{type:Boolean},visableModifiers:{}}),emits:["update:visable"],setup(V){const te=V,_=lt(V,"visable"),{columns:Z,data:L,getData:r,loading:o,mobilePagination:ae,searchParams:w}=st({apiFn:Ia,immediate:!1,apiParams:{page:1,pageSize:20,limit:20,id:te.id,_t:new Date().getTime()},columns:()=>[{key:"contractname",title:"合同",width:200,render:b=>a("div",{class:h.pids==b.id?"bg-#f1f1f1 cursor-pointer p-5px":"cursor-pointer p-5px",onClick:()=>I(b.id)},[a("div",{class:"flex"},[a("div",{class:"w-60px inline-block"},[y("名称：")]),b.contractname]),a("div",{class:"font-size-12px c-#7d7575 flex"},[a("div",{class:"w-60px inline-block"},[y("编号：")]),y(" "),b.contractnum]),a("div",{class:"font-size-12px c-#7d7575 flex"},[a("div",{class:"w-60px inline-block"},[y("联系人：")]),b.businesscon]),a("div",{class:"font-size-12px c-#7d7575 flex"},[a("div",{class:"w-60px inline-block"},[y("联系方式：")]),b.businessinfo]),a("div",{class:"font-size-12px c-#7d7575 flex"},[a("div",{class:"w-60px inline-block"},[y("注意事项：")]),b.precautions]),a("div",{class:"font-size-12px c-#7d7575 flex"},[a("div",{class:"w-60px inline-block"},[y("备注：")]),b.notes])])}]}),{columns:Q,data:se,getData:z,loading:O,pagination:v,mobilePagination:C,searchParams:h}=st({apiFn:Na,immediate:!1,apiParams:{page:1,pageSize:20,limit:20,pids:te.id,_t:new Date().getTime()},columns:()=>[{key:"devname",title:"设备名称",align:"center",width:200,ellipsis:{tooltip:!0}},{key:"devcount",title:"数量",align:"center",width:120},{key:"devmodel",title:"规格型号",align:"center",width:120,ellipsis:{tooltip:!0}},{key:"devunit",title:"单位",align:"center",width:120},{key:"devtype",title:"是否为我司设备",align:"center",width:120,render:b=>b.devtype==0?a(Ke,{type:"success"},{default:()=>[y("是")]}):a(Ke,{type:"info"},{default:()=>[y("否")]})},{key:"devmanu",title:"设备厂家",align:"center",width:120},{key:"notes",title:"备注",align:"center",width:120},{key:"username",title:"创建人",align:"center",width:120},{key:"dbtime",title:"创建时间",align:"center",width:180}]}),I=b=>{h.pids=b,z()},U=()=>{_.value=!1};return Ge(()=>_.value,async b=>{var E;b&&(w.id=te.id,se.value=[],v.itemCount=0,await r(),h.pids=(E=L.value[0])==null?void 0:E.id,h.pids&&z())}),(b,E)=>{const Y=it,ce=ot,pe=Ut;return H(),ue(pe,{show:_.value,"onUpdate:show":E[0]||(E[0]=m=>_.value=m),preset:"card",class:"w-1400px",title:"项目关联的合同"},{footer:i(()=>[K("div",un,[a(s(g),{type:"primary",size:"small",onClick:U},{default:i(()=>E[1]||(E[1]=[y(" 关闭 ")])),_:1,__:[1]})])]),default:i(()=>[K("div",rn,[a(Y,{class:"left",columns:s(Z),data:s(L),"paginate-single-page":!1,size:"small",remote:"",loading:s(o),pagination:s(ae),"row-key":m=>m.id,"max-height":600},null,8,["columns","data","loading","pagination","row-key"]),a(ce,{bordered:!1,size:"small",title:"设备",class:"w-1100px"},{default:i(()=>[a(Y,{style:{width:"100%"},columns:s(Q),data:s(se),size:"small","max-height":600,loading:s(O),remote:"","scroll-x":s(Q).reduce((m,A)=>m+(A.width||100),0),"paginate-single-page":!1,pagination:s(C),"row-key":m=>m.id},null,8,["columns","data","loading","scroll-x","pagination","row-key"])]),_:1})])]),_:1},8,["show"])}}}),cn=Lt(dn,[["__scopeId","data-v-a53f455a"]]),pn={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function It(V){return typeof V=="function"||Object.prototype.toString.call(V)==="[object Object]"&&!Oa(V)}const mn=He({name:"projectmanagement_projectlist",__name:"index",setup(V){const te=Pa(),_=Nt(),Z=ja(),L=$a(),{columns:r,columnChecks:o,data:ae,getData:w,loading:Q,mobilePagination:se,searchParams:z}=st({showTotal:!0,apiFn:La,apiParams:{page:1,pageSize:20,limit:20,status:null,startAndTimeRange:null,startTime:null,endTime:null,creater:void 0,fuzzy:"",sort:void 0,_t:new Date().getTime()},immediate:!1,columns:()=>[{type:"selection",align:"center",width:48},{key:"proname",title:"项目名称",align:"center",width:240,render:l=>a("div",{class:"cursor-pointer",onClick:()=>Ae(l)},[l.proname])},{key:"progess",title:"项目进度",align:"center",width:140,sorter:!0,render:l=>a(Ft,{type:"line",showIndicator:!0,percentage:l.progess,"indicator-placement":"inside",processing:!0,color:"#1890ff"},null)},{key:"status",title:"项目状态",align:"center",width:120,defaultFilterOptionValue:null,filterOptions:Ue(rt),filter:!0,filterMultiple:!1,render:l=>{if(l.status===null)return null;const c=$(Ka[l.status]);return a("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",color:l.status===0?"#3498db":l.status===1?"#f39c12":l.status===2?"#f1c40f":"#2ecc71",borderRadius:"50%"}},[a("span",{style:{width:"10px",height:"10px",marginRight:"5px",backgroundColor:l.status===0?"#3498db":l.status===1?"#f39c12":l.status===2?"#f1c40f":"#2ecc71",borderRadius:"50%"}},null),a("span",null,[c])])}},{key:"cpdbtime",title:"预计完成日期",align:"center",width:180,ellipsis:{tooltip:!0}},{key:"period",title:"周期",align:"center",width:100,render:l=>a("div",null,[l.period,y("天")])},{key:"ptype",title:"状态",align:"center",width:100,render:l=>a(Ke,{type:l.ptype===0?"success":"error"},{default:()=>[l.ptype===0?"正常":"已延期"]})},{key:"dtype",title:"调试类型",align:"center",width:100,render:l=>{if(l.dtype===null)return null;const c=$(Ha[l.dtype]);return a(Ke,{type:l.dtype==0?"warning":l.dtype==1?"success":"info"},It(c)?c:{default:()=>[c]})}},{key:"username",title:"创建人",align:"center",width:100,ellipsis:{tooltip:!0}},{key:"dbtime",title:"创建时间",align:"center",width:180},{key:"operate",title:$("common.operate"),align:"center",width:320,fixed:"right",render:l=>{let c;return a("div",{class:"flex justify-end gap-8px"},[l.status==0&&(_.userInfo.usertype==0||_.userInfo.usertype==2||_.userInfo.usertype==3)&&a(Te,{onPositiveClick:()=>Y(l,1)},{default:()=>"确定启动项目吗？",trigger:()=>$e(a(g,{type:"success",ghost:!0,size:"small"},{default:()=>["启动"]}),[[Ve("no-auth"),"project:Info:update"]])}),l.status==2&&(_.userInfo.usertype==0||_.userInfo.usertype==2)&&a(Te,{onPositiveClick:()=>Y(l,3)},{default:()=>"是否确认执行审核操作？",trigger:()=>$e(a(g,{type:"warning",ghost:!0,size:"small"},{default:()=>["审核"]}),[[Ve("no-auth"),"project:Info:update"]])}),a(g,{type:"primary",ghost:!0,size:"small",onClick:()=>Ae(l)},{default:()=>["详情"]}),a(g,{type:"primary",ghost:!0,size:"small",onClick:()=>ze(l)},{default:()=>["关联合同"]}),$e(a(g,{type:"primary",ghost:!0,size:"small",onClick:()=>ce(l.id)},It(c=$("common.edit"))?c:{default:()=>[c]}),[[Ve("no-auth"),"project:Info:update"]])])}}]}),{drawerVisible:O,operateType:v,editingData:C,handleAdd:h,handleEdit:I,checkedRowKeys:U,onBatchDeleted:b}=Ea(ae,w);async function E(){console.log(U.value),pe(U.value.join(","),l=>{b()})}const Y=async(l,c)=>{var ge;const{data:me,error:fe}=await At([{id:l.id,status:c}]);fe||((ge=window.$message)==null||ge.success("操作成功"),w(),c==3&&window.dispatchEvent(new CustomEvent("clearReview",{detail:{id:l.pid,type:"prj"}})))};function ce(l){I(l)}async function pe(l,c){const{data:me,error:fe}=await Fa(l);if(!fe)c&&c(me);else return!1}const m=k(!1),A=k(0),ze=l=>{m.value=!0,A.value=l.id},j=l=>{z.status=l.status,w()},We=l=>{console.log(l),l.columnKey=="progess"&&(z.sort=l.order=="ascend"?0:l.order=="descend"?1:void 0,w())},Ce=k(-1),Xe=l=>{l>0?(Ce.value=l,z.creater=JSON.parse(JSON.stringify(l)),w()):(z.creater=void 0,Ce.value=-1,w())},Ae=l=>{Z.push("/projectmanagement/orderdetail?prjId="+l.id),_.setProjectInfo({pid:l.id,pname:l.proname})},Fe=()=>{w()};return Ta(()=>{L.query.pname?(z.fuzzy=L.query.pname,z.status=2,Fe()):w()}),Ge(()=>L.query.pname,l=>{l&&(z.fuzzy=l,w())}),(l,c)=>{const me=Ya,fe=Aa,ge=re,Ze=ta,Qe=ea,ve=Yt,Ye=it,ee=ot,Ie=Ve("no-auth");return H(),Je("div",pn,[a(on,{model:s(z),"onUpdate:model":c[0]||(c[0]=N=>Be(z)?z.value=N:null),onReset:Fe,onSearch:s(w)},null,8,["model","onSearch"]),a(ee,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:i(()=>[a(ge,{align:"center",wrap:"",class:"lt-sm:w-200px"},{default:i(()=>[c[6]||(c[6]=K("div",null,"项目列表",-1)),a(fe,{size:"small",value:Ce.value,"onUpdate:value":[c[1]||(c[1]=N=>Ce.value=N),Xe],name:"radiobuttongroup1"},{default:i(()=>[a(me,{value:-1,label:"默认"}),a(me,{value:s(_).userInfo.id,label:"我创建的"},null,8,["value"])]),_:1},8,["value"])]),_:1,__:[6]})]),"header-extra":i(()=>[a(ge,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:i(()=>[$e((H(),ue(s(g),{onClick:s(h),size:"small",ghost:"",type:"primary"},{icon:i(()=>[a(Ze,{class:"text-icon"})]),default:i(()=>[c[7]||(c[7]=y(" "+de("新增项目")))]),_:1,__:[7]},8,["onClick"])),[[Ie,"project:Info:insert"]]),a(s(Te),{onPositiveClick:E},{trigger:i(()=>[$e((H(),ue(s(g),{size:"small",ghost:"",type:"error",disabled:s(U).length==0},{icon:i(()=>[a(Qe,{class:Ua(["text-icon",{"animate-spin":s(Q)}])},null,8,["class"])]),default:i(()=>[c[8]||(c[8]=y(" "+de("批量删除")))]),_:1,__:[8]},8,["disabled"])),[[Ie,"project:Info:delete"]])]),default:i(()=>[c[9]||(c[9]=y(" 确定要删除选中的合同吗？ "))]),_:1,__:[9]}),a(ve,{columns:s(o),"onUpdate:columns":c[2]||(c[2]=N=>Be(o)?o.value=N:null)},null,8,["columns"])]),_:1})]),default:i(()=>[a(Ye,{"checked-row-keys":s(U),"onUpdate:checkedRowKeys":c[3]||(c[3]=N=>Be(U)?U.value=N:null),columns:s(r),data:s(ae),size:"small","flex-height":!s(te).isMobile,"scroll-x":s(r).reduce((N,he)=>N+(he.width||100),0),loading:s(Q),remote:"","row-key":N=>N.id,"onUpdate:sorter":We,pagination:s(se),class:"sm:h-full","onUpdate:filters":j},null,8,["checked-row-keys","columns","data","flex-height","scroll-x","loading","row-key","pagination"]),a(ln,{visible:s(O),"onUpdate:visible":c[4]||(c[4]=N=>Be(O)?O.value=N:null),onSubmitted:s(w),"operate-type":s(v),"row-data":s(C)},null,8,["visible","onSubmitted","operate-type","row-data"]),a(cn,{visable:m.value,"onUpdate:visable":c[5]||(c[5]=N=>m.value=N),id:A.value},null,8,["visable","id"])]),_:1})])}}}),$n=Lt(mn,[["__scopeId","data-v-a50eee5d"]]);export{$n as default};

import{_ as ea}from"./table-column-setting.vue_vue_type_script_setup_true_lang-BQNbmSUZ.js";import{_ as ta}from"./round-delete-ChpfyTWK.js";import{_ as aa}from"./round-add-BomLsZ_W.js";import{aK as na,b as Ue,o as O,e as C,d as He,at as qe,q as Pt,v as je,r as w,s as jt,$,a5 as u,C as L,B as g,cz as sa,cr as la,cx as ia,cy as bt,b9 as kt,az as Se,cT as oa,cU as ra,cP as ua,cQ as St,a as da,av as lt,aw as Ge,bZ as Tt,aT as wt,f as a,bj as ca,w as l,bh as pa,G as $t,F as Ut,c as se,z as Te,h as s,bi as Fe,b8 as ma,cJ as Ct,g as y,aX as fa,N as de,ay as it,t as le,aE as At,dS as ga,dK as Ft,e4 as xt,e5 as va,e6 as Dt,e7 as ha,cF as ya,e8 as _a,e9 as ba,dH as zt,aH as nt,dT as ka,cY as Sa,c_ as wa,cA as Ca,cI as xa,aA as Da,aB as Lt,dG as za,cX as Ia,be as Na,U as ot,a$ as It,cR as Pa,cE as ja,aF as Ke,aM as Ot,M as Ta,a_ as $a,aN as Ua,i as Aa,y as Ve,aO as Je,D as $e,aP as Fa,aC as La,ea as Oa,cs as Ea,aU as Ma}from"./index-BhBp_qK9.js";import{u as st,a as Ra}from"./table-txCoW33S.js";import{_ as Ba}from"./round-plus-BiV3NtWs.js";import{_ as Va,a as Ja,A as qa}from"./index-C24tYcmP.js";import{g as rt,h as Ga,i as Et,p as Ka,f as Ha}from"./business-PlGaHObb.js";import{u as Xa}from"./usePageData-DDI8WLoO.js";import{N as Ae}from"./Popconfirm-M-SYUm8J.js";import{_ as Mt}from"./Grid-CO09elz5.js";import{_ as Rt}from"./FormItemGridItem-UGN3dIqT.js";import{_ as Za}from"./round-search-B9RiPIED.js";import{_ as Qa}from"./round-refresh-CHq_sj9A.js";import{N as Wa}from"./DatePicker-D7-WF1QQ.js";import{N as Ya}from"./RadioButton-CGixugkd.js";const en={class:"inline-block",viewBox:"0 0 48 48",width:"1em",height:"1em"};function tn(E,G){return O(),Ue("svg",en,G[0]||(G[0]=[C("g",{fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"4"},[C("path",{d:"M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4S4 12.954 4 24s8.954 20 20 20Z"}),C("path",{"stroke-linecap":"round",d:"M16 24h16"})],-1)]))}const an=na({name:"icon-park-outline-reduce-one",render:tn}),nn={class:"w-100%"},sn={class:"flex"},ln={style:{display:"flex","flex-direction":"column",width:"100%"}},on={class:"flex items-center"},rn={class:"w-100%"},un={class:"w-100px"},dn={style:{display:"flex","flex-direction":"column"}},cn={style:{display:"flex","flex-direction":"column"}},pn={style:{display:"flex","flex-direction":"column"}},mn=He({name:"OperateDrawer",__name:"operate-drawer",props:qe({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:qe(["submitted"],["update:visible"]),setup(E,{emit:G}){const b=Pt(),Z=G,M=je({contactList:[],debuggedDevieceList:[]}),r=E,o=je(te());function te(){return{proname:"",dispatchIds:[],contractIds:[],proaddr:"",cpdbtime:null,prosite:"",longitude:120.373885,latitude:30.303899,period:void 0,dtype:void 0,dispatch:"",status:1}}const D=w(0),Q=w(void 0);async function ie(){Object.assign(o,te()),Zt(),r.operateType==="edit"&&r.rowData&&(await Promise.all([Wt(),P(),_(),c()]),Object.assign(o,r.rowData),D.value=o.period,Q.value=o.status,await gt(),ht(o.proaddr||o.prosite),qt())}const{formRef:I,validate:R,restoreValidation:v}=jt(),x={proname:{type:"string",required:!0,trigger:["blur","change"],message:"请输入项目名称"},status:{type:"number",required:!0,trigger:["blur","change"],message:"请选择项目状态"},contractIds:{type:"array",required:!0,trigger:["blur","change"],message:"请选择合同"},dtype:{type:"number",required:!0,trigger:["blur","change"],message:"请选择调试类型"},period:{type:"number",required:!0,trigger:["blur","change"],message:"请输入周期"},prosite:{type:"string",required:!0,trigger:["blur","change","focus"],message:"请选择项目地点"},cpdbtime:{type:"string",required:!0,trigger:["blur","change"],message:"请选择时间"}},h=w([]),N=je({page:1,pageSize:20,showSizePicker:!0,fuzzy:"",pageSizes:[20],prefix:()=>`共 ${h.value.length} 条`,onChange:e=>{N.page=e,_()},onUpdatePageSize:e=>{N.pageSize=e,N.page=1,_()}}),A=[{title:"姓名",key:"pname",align:"center",render(e,t){return e.setStatus?u(L,{value:e.pname,placeholder:"请输入姓名",onUpdateValue(n){h.value[t].pname=n}}):u("div",{},e.pname)}},{title:"联系方式",key:"pcontact",align:"center",render(e,t){return e.setStatus?u(L,{value:e.pcontact,placeholder:"请输入联系方式",onUpdateValue(n){h.value[t].pcontact=n}}):u("div",{},e.pcontact)}},{title:"备注",key:"proposition",align:"center",render(e,t){return e.setStatus?u(L,{value:e.proposition,placeholder:"请输入备注",onUpdateValue(n){h.value[t].proposition=n}}):u("div",{},e.proposition)}},{key:"operate",title:$("common.operate"),align:"center",minWidth:120,fixed:"right",render(e,t){return u("div",{class:"flex-center gap-8px"},[e.setStatus?[u(g,{type:"primary",ghost:!0,size:"small",onClick:()=>ce(e)},{default:()=>"保存"}),u(g,{type:"default",ghost:!0,size:"small",onClick:()=>W(e,t)},{default:()=>"取消"}),u(Ae,{onPositiveClick:()=>{r.operateType==="edit"&&e.id?sa(e.id).then(()=>{var n;h.value.splice(t,1),(n=window.$message)==null||n.success("删除成功")}):h.value.splice(t,1)}},{default:()=>$("common.confirmDelete"),trigger:()=>u(g,{type:"error",ghost:!0,size:"small"},{default:()=>$("common.delete")})})]:u(g,{type:"primary",ghost:!0,size:"small",onClick:()=>B(e)},{default:()=>"编辑"})])}}],_=async()=>{var t;const{data:e}=await la({page:N.page,limit:N.pageSize,pid:(t=r.rowData)==null?void 0:t.id});h.value=e==null?void 0:e.list,h.value.forEach(n=>{n.setStatus=!1}),M.contactList=JSON.parse(JSON.stringify(h.value))},B=e=>{h.value.forEach(t=>{t.setStatus=!1}),e.setStatus=!e.setStatus},W=(e,t)=>{e.setStatus=!e.setStatus,e.id?h.value=JSON.parse(JSON.stringify(M.contactList)):h.value.splice(t,1)},ce=async e=>{var t,n,d,f,k;if(!e.pname){(t=window.$message)==null||t.warning("请输入联系人姓名");return}if(!e.pcontact){(n=window.$message)==null||n.warning("请输入联系方式");return}if(r.operateType==="edit")if(e.id){const{data:U,error:S}=await ia([e]);S||((d=window.$message)==null||d.success("修改成功"),_(),e.setStatus=!e.setStatus)}else{const{data:U,error:S}=await bt([{...e,pid:(f=r.rowData)==null?void 0:f.id}]);S||((k=window.$message)==null||k.success("添加成功"),_(),e.setStatus=!e.setStatus)}else e.setStatus=!e.setStatus};function pe(){var e;((e=h.value[0])!=null&&e.pname||h.value.length==0)&&h.value.unshift({pname:"",pcontact:"",proposition:"",setStatus:!0})}const m=w([]),F=je({page:1,pageSize:20,showSizePicker:!0,fuzzy:"",pageSizes:[20],prefix:()=>`共 ${m.value.length} 条`,onChange:e=>{F.page=e,P()},onUpdatePageSize:e=>{F.pageSize=e,F.page=1,P()}}),ze=[{title:"设备名称",key:"devname",align:"center",render(e,t){return e.setStatus?u(L,{value:e.devname,placeholder:"请输入设备名称",onUpdateValue(n){m.value[t].devname=n}}):u("div",{},e.devname)}},{title:"型号",key:"devmodel",align:"center",render(e,t){return e.setStatus?u(L,{value:e.devmodel,placeholder:"请输入型号",onUpdateValue(n){m.value[t].devmodel=n}}):u("div",{},e.devmodel)}},{title:"数量",key:"devnum",align:"center",render(e,t){return e.setStatus?u(kt,{value:e.devnum,placeholder:"请输入数量",onUpdateValue(n){m.value[t].devnum=Number(n)||0}}):u("div",{},e.devnum)}},{title:"是否为我司设备",key:"etype",align:"center",render(e,t){return e.setStatus?u(Se,{value:e.etype,options:[{label:"是",value:0},{label:"否",value:1}],onUpdateValue(n){m.value[t].etype=n}}):u("div",{},e.etype===0?"是":"否")}},{title:"设备厂家",key:"devmanu",align:"center",render(e,t){return e.setStatus?u(L,{value:e.devmanu,placeholder:"请输入设备厂家",onUpdateValue(n){m.value[t].devmanu=n}}):u("div",{},e.devmanu)}},{title:"备注",key:"notes",align:"center",render(e,t){return e.setStatus?u(L,{value:e.notes,placeholder:"请输入备注",onUpdateValue(n){m.value[t].notes=n}}):u("div",{},e.notes)}},{title:"清点状态",key:"status",align:"center",render(e,t){return e.setStatus?u(Se,{value:e.status,options:[{label:"未清点",value:0},{label:"正常",value:1},{label:"增补",value:2},{label:"退货",value:3},{label:"换货",value:4}],onUpdateValue(n){m.value[t].status=n}}):u("div",{},e.status===0?"未清点":e.status===1?"正常":e.status===2?"增补":e.status===3?"退货":"换货")}},{key:"operate",title:$("common.operate"),align:"center",width:180,fixed:"right",render(e,t){return u("div",{class:"flex-center gap-8px"},[e.setStatus?[u(g,{type:"primary",ghost:!0,size:"small",onClick:()=>Ze(e)},{default:()=>"保存"}),u(g,{type:"default",ghost:!0,size:"small",onClick:()=>we(e,t)},{default:()=>"取消"}),u(Ae,{onPositiveClick:()=>{r.operateType==="edit"&&e.id?oa(e.id).then(()=>{var n;m.value.splice(t,1),(n=window.$message)==null||n.success("删除成功")}):m.value.splice(t,1)}},{default:()=>$("common.confirmDelete"),trigger:()=>u(g,{type:"error",ghost:!0,size:"small"},{default:()=>$("common.delete")})})]:u(g,{type:"primary",ghost:!0,size:"small",onClick:()=>Xe(e)},{default:()=>"编辑"})])}}],P=async()=>{var t;const{data:e}=await ra({page:F.page,limit:F.pageSize,fuzzy:F.fuzzy,pid:(t=r.rowData)==null?void 0:t.id});m.value=e.list,M.debuggedDevieceList=JSON.parse(JSON.stringify(m.value))},Xe=e=>{m.value.forEach(t=>{t.setStatus=!1}),e.setStatus=!e.setStatus},we=(e,t)=>{e.setStatus=!e.setStatus,e.id?m.value=JSON.parse(JSON.stringify(M.debuggedDevieceList)):m.value.splice(t,1)},Ze=async e=>{var n,d,f,k,U,S;if(!e.devname){(n=window.$message)==null||n.warning("设备名称不能为空");return}if(!e.devmodel){(d=window.$message)==null||d.warning("设备型号不能为空");return}if(!e.devnum){(f=window.$message)==null||f.warning("设备数量不能为空");return}const t=e.dcreater*1;if(r.operateType==="edit")if(e.id){const{data:ee,error:J}=await ua([{...e,dcreater:t}]);J||((k=window.$message)==null||k.success("修改成功"),P(),e.setStatus=!e.setStatus)}else{const{data:ee,error:J}=await St([{...e,pid:(U=r.rowData)==null?void 0:U.id,dcreater:t}]);J||((S=window.$message)==null||S.success("添加成功"),P(),e.setStatus=!e.setStatus)}else e.setStatus=!e.setStatus};function Le(){var e;((e=m.value[0])!=null&&e.devname||m.value.length==0)&&m.value.unshift({status:void 0,devmanu:"",etype:0,devname:"",devmodel:"",devnum:0,notes:"",setStatus:!0})}const Oe=w({}),i=w([]);async function c(){var t;i.value=[];const{data:e}=await ga({page:1,limit:100,pid:(t=r.rowData)==null?void 0:t.id});e.list.forEach(n=>{n.sort==1&&i.value.push({id:n.id,name:n.filename,url:n.file,status:"finished",creator:n.username,dbtime:n.dbtime})}),i.value.reverse(),Oe.value=JSON.parse(JSON.stringify(e))}const me=[{title:"文件别名",key:"name",align:"center",width:200,render(e){return e.setStatus?u(L,{value:e.name,onUpdateValue:t=>{e.name=t}}):u("div",{},e.name)}},{title:"文件名称",key:"filename",align:"center",width:200,render(e){return e.setStatus&&!e.url?u("div",{style:"display: flex; justify-content: center; align-items: center;"},[u(Da,{action:"#",showFileList:!1,customRequest:async({file:n,onFinish:d,onError:f})=>{var k,U;try{e.status=!0;const{data:S,error:ee}=await Ia(n.file,J=>{e.progress=J});S&&(e.url=S,e.status=!1)}catch(S){console.error(S),(U=(k=window.$message)==null?void 0:k.error)==null||U.call(k,"文件上传出错"),e.status=!1}}},{default:()=>u(g,{type:"info",size:"small",ghost:!0,loading:e.status},{default:()=>"上传文件"})}),e.progress?u(Lt,{type:"line",percentage:e.progress,indicatorPlacement:"inside",processing:!0}):null]):e.setStatus&&e.url&&!e.id?a("span",null,[e.url.split("?")[1],y(" "),a("span",{onClick:()=>e.url="",style:"color: red;cursor: pointer;font-size: 12px;"},[y("删除")])]):u("div",{},e.url.split("?")[1])}},{title:"上传人",key:"creator",align:"center",width:100,render(e){return u("div",{},e.creator)}},{title:"上传时间",key:"dbtime",align:"center",width:200,render(e){return u("div",{},e.dbtime?e.dbtime:"")}},{title:"操作",key:"actions",align:"center",width:180,render(e){return u(de,{justify:"center"},[!e.setStatus&&e.id&&u(g,{type:"info",size:"small",ghost:!0,onClick:()=>{fe(e)}},{default:()=>"下载"}),e.setStatus&&u(g,{type:"info",size:"small",ghost:!0,onClick:()=>{Qe(e)}},{default:()=>"保存"}),e.setStatus&&u(g,{type:"info",size:"small",ghost:!0,onClick:()=>{e.setStatus=!e.setStatus}},{default:()=>"取消"}),!e.setStatus&&u(g,{type:"info",size:"small",ghost:!0,onClick:()=>{e.setStatus=!e.setStatus}},{default:()=>"编辑"})])}}];async function fe(e){if(e!=null&&e.url)try{const n=await(await fetch(e.url.split("?")[0],{mode:"cors"})).blob(),d=URL.createObjectURL(n),f=document.createElement("a");f.href=d,f.download=e.url.split("?")[1],f.style.display="none",document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(d)}catch(t){console.error("下载失败:",t)}}const ge=()=>{i.value.push({id:"",name:"",url:"",status:"uploading",setStatus:!0})},Qe=async e=>{var t,n,d,f,k,U,S,ee,J,ye,_e,be;if(!e.name){(n=(t=window.$message)==null?void 0:t.warning)==null||n.call(t,"请输入文件别名");return}if(!e.url){(f=(d=window.$message)==null?void 0:d.warning)==null||f.call(d,"请上传文件");return}if((k=r.rowData)!=null&&k.id){const{data:K,error:p}=await zt([{pid:(U=r.rowData)==null?void 0:U.id,filename:e.name,file:e.url,sort:1}]);if(p)return(S=window.$message)==null?void 0:S.error("保存文件记录失败");(ee=window.$message)==null||ee.destroyAll(),e.setStatus=!e.setStatus,c(),(J=window.$message)==null||J.success("保存成功")}else if(e.id){const{data:K,error:p}=await za([{id:e.id,filename:e.name}]);if(p)return(ye=window.$message)==null?void 0:ye.error("保存文件记录失败");(_e=window.$message)==null||_e.destroyAll(),e.setStatus=!e.setStatus,(be=window.$message)==null||be.success("编辑成功")}else e.setStatus=!e.setStatus},We=da(()=>({add:"新增项目",edit:"修改项目"})[r.operateType]),ve=lt(E,"visible");Ge(ve,()=>{ve.value&&(ie(),setTimeout(()=>{const e=document.querySelector(".n-scrollbar-content");e==null||e.scrollTo(0,0)},300),v())});function Ye(e){e||Y()}function Y(){ve.value=!1}async function Ie(){var e;await R(),(e=window.$dialog)==null||e.info({title:"提示",content:"确定提交吗？",positiveText:"确定",negativeText:"取消",onPositiveClick:async()=>{await j()}})}async function j(){var e,t,n,d,f,k,U,S,ee,J,ye,_e,be;if(r.operateType==="edit"){const K=JSON.parse(JSON.stringify(o));D.value==K.period&&delete K.period,Q.value==K.status&&delete K.status;const{data:p,error:ke}=await Ft([K]);if(!ke){let q=function(ne,H){const X=ne.filter(ue=>!H.includes(ue)),xe=H.filter(ue=>!ne.includes(ue));return{toDelete:X,toAdd:xe}};if((e=o.dispatchIds)!=null&&e.length&&((t=o.dispatchIds)==null?void 0:t.length)>0){const{toDelete:ne,toAdd:H}=q(mt.value,o.dispatchIds);if(H.length>0){const X=H.map(Be=>({pid:o.id,did:Be})),{data:xe,error:ue}=await xt(X)}if(ne.length>0){const{data:X,error:xe}=await va(ne.join(","))}}if((n=o.contractIds)!=null&&n.length&&((d=o.contractIds)==null?void 0:d.length)>0){const{toDelete:ne,toAdd:H}=q(yt.value,o.contractIds);if(H.length>0){const X=H.map(Be=>({pid:o.id,did:Be})),{data:xe,error:ue}=await Dt(X)}if(ne.length>0){const{data:X,error:xe}=await ha(ne.join(","))}}Y(),Z("submitted"),(f=window.$message)==null||f.success("修改成功")}}else{const K=ya(),{data:p,error:ke}=await _a([{...o,uuid:K}]);if(!ke){const{data:q,error:ne}=await ba(K);if(q){let H=function(z,De,_t){return z.map(Pe=>({...Pe,pid:De}))};if(o.dispatchIds&&o.dispatchIds.length>0){const z=[];(k=o.dispatchIds)==null||k.forEach(async Pe=>{z.push({pid:q,did:Pe})});const{data:De,error:_t}=await xt(z)}if(o.contractIds&&o.contractIds.length>0){const z=[];(U=o.contractIds)==null||U.forEach(async Pe=>{z.push({proid:q,conid:Pe})});const{data:De,error:_t}=await Dt(z)}const X=[];if(h.value.length>0){const z=H(h.value,q);X.push(bt(z))}if(m.value.length>0){const z=H(m.value,q);X.push(St(z))}if((await Promise.allSettled(X)).forEach((z,De)=>{z.status==="fulfilled"?console.log(`第 ${De+1} 个请求成功`,z.value):console.error(`第 ${De+1} 个请求失败`,z.reason)}),!i.value.length){(S=window.$message)==null||S.destroyAll(),(ee=window.$message)==null||ee.success("操作成功"),Y(),Z("submitted");return}const ue=[];i.value.forEach(z=>{ue.push({pid:q,filename:z.name,file:z.url,sort:1})});const{data:Be,error:Yt}=await zt(ue);Yt&&((J=window.$message)==null||J.error("保存文件记录失败")),(ye=window.$message)==null||ye.destroyAll(),(_e=window.$message)==null||_e.success("操作成功"),Y(),Z("submitted")}}Y(),Z("submitted"),(be=window.$message)==null||be.success("添加成功")}}const he=w(!1),et=w();let Ce=null,ut=null,Ee=null,dt=null,oe=null;const ae=je({longitude:0,latitude:0});let Ne;const Me=w(!1),re=w(""),Re=w([]);async function Bt(){window._AMapSecurityConfig={securityJsCode:b.userInfo.sdksecret},et.value&&(oe=await qa.load({key:b.userInfo.sdkkey,version:"2.0",plugins:["AMap.Scale","AMap.PlaceSearch","AMap.AutoComplete","AMap.Geocoder","AMap.Geolocation"]}),Ce=new oe.Map(et.value,{zoom:18,center:[T.value>0?V.value[T.value-1].longitude:o.longitude,T.value>0?V.value[T.value-1].latitude:o.latitude],viewMode:"3D",resizeEnable:!0}),ut=new oe.Geocoder,new oe.PlaceSearch({city:"全国",pageSize:50}),dt=new oe.AutoComplete({city:"全国"}),tt(oe,{lng:T.value>0?V.value[T.value-1].longitude:o.longitude,lat:T.value>0?V.value[T.value-1].latitude:o.latitude}),Ce.on("click",e=>{const{lng:t,lat:n}=e.lnglat;Ne=2,ae.latitude=n,ae.longitude=t,tt(oe,{lng:t,lat:n})}),nt(()=>window.dispatchEvent(new Event("resize"))))}const ct=Tt.debounce(async e=>{if(!Me.value||!e.trim()){Re.value=[];return}dt.search(e,(t,n)=>{var d;console.log(n,"result"),t=="complete"&&n.info=="OK"&&((d=n==null?void 0:n.tips)!=null&&d.length)?Re.value=n.tips.map(f=>({label:`${f.name}（${f.district||f.address||"无详细地址"}）`,value:`${f.location.lng}_${f.location.lat}`,raw:f})):Re.value=[]})},300);Ge(re,e=>{ct(e)});function Vt(e,t){if(console.log(e,t,"option"),!e)return;const[n,d]=e.split("_").map(Number);!n||!d||(Ce.setCenter([n,d]),Ne=1,tt(oe,{lng:n,lat:d}),ae.longitude=n,ae.latitude=d)}const T=w(0);function pt(e){e?T.value=e:T.value=0,he.value=!0,Me.value=!1,Ne=void 0,nt(async()=>{await Bt(),setTimeout(()=>{Me.value=!0;const t=document.querySelector(".n-auto-complete input");t==null||t.blur()},500)})}function tt(e,t){Ee&&Ce.remove(Ee),Ee=new e.Marker({position:[t.lng,t.lat],map:Ce}),Ce.add(Ee),ut.getAddress(t,(n,d)=>{n==="complete"&&d.regeocode&&(console.log("result",d),console.log("formattedAddress",d.regeocode.formattedAddress),t.latitude=t.lat,t.longitude=t.lng,Ne==1||(Ne==2?re.value=d.regeocode.formattedAddress:re.value=T.value>0?V.value[T.value-1].address||d.regeocode.formattedAddress:o.prosite||d.regeocode.formattedAddress))})}function Jt(e,t){if(!t)return null;const n=t.replace(/省|市|特别行政区|自治区|壮族|回族|维吾尔/g,"").trim(),d=e.find(f=>t.includes(f.name)||f.name.includes(n));return d?d.id:null}const mt=w([]),qt=async()=>{const{data:e,error:t}=await ka({page:1,limit:100,pid:r.rowData.id});o.dispatchIds=e==null?void 0:e.list.map(n=>n.did),mt.value=JSON.parse(JSON.stringify(o.dispatchIds))},ft=w([]),gt=async()=>{const{data:e,error:t}=await Sa();e&&(ft.value=e)},vt=w([]),ht=async e=>{let t=Jt(ft.value,e);const{data:n,error:d}=await wa({page:1,limit:100,province:t});vt.value=n.list},Gt=async()=>{T.value==0?(o.latitude=ae.latitude,o.longitude=ae.longitude,o.prosite=re.value,await gt(),ht(re.value)):(V.value[T.value-1].address=re.value,V.value[T.value-1].latitude=ae.latitude,V.value[T.value-1].longitude=ae.longitude),he.value=!1,T.value=0,console.log(o,ae)};function Kt(){he.value=!1}const{pageData:at,getData:Ht,nextPage:Xt}=Xa(Ca),Zt=async()=>{await Ht({limit:100})},Qt=async e=>{const t=e.currentTarget,n=t.scrollTop;t.scrollTop+t.offsetHeight>=t.scrollHeight&&at.data.length<at.total&&(await Xt(),await nt(),setTimeout(()=>{t.scrollTop=n}))},yt=w([]),Wt=async()=>{var n;const{data:e,error:t}=await xa({page:1,limit:100,proid:(n=r.rowData)==null?void 0:n.id});o.contractIds=e==null?void 0:e.list.map(d=>d.conid),yt.value=JSON.parse(JSON.stringify(o.contractIds))},V=w([{longitude:120.373885,latitude:30.303899,address:""}]);return(e,t)=>{const n=Rt,d=Va,f=ma,k=Ba,U=an,S=it,ee=Mt,J=$t,ye=pa,_e=ca,be=Ja,K=At;return O(),Ue(wt,null,[a(_e,{show:ve.value,"onUpdate:show":[t[13]||(t[13]=p=>ve.value=p),Ye],"display-directive":"show",width:1100,onMaskClick:Y,onEsc:Y},{default:l(()=>[a(ye,{title:We.value,"native-scrollbar":!1,closable:""},{footer:l(()=>[a(s(de),{size:16,justify:"end"},{default:l(()=>[a(s(g),{onClick:Y},{default:l(()=>[y(le(s($)("common.cancel")),1)]),_:1}),a(s(g),{type:"primary",onClick:Ie},{default:l(()=>[y(le(s($)("common.confirm")),1)]),_:1})]),_:1})]),default:l(()=>[a(J,{ref_key:"formRef",ref:I,model:o,rules:x,onKeyup:Ut(Ie,["enter"])},{default:l(()=>[a(ee,{responsive:"screen","item-responsive":"","x-gap":"15"},{default:l(()=>[a(n,{span:"24 s:12 m:12",label:"项目名称",path:"proname"},{default:l(()=>[a(s(L),{clearable:"",value:o.proname,"onUpdate:value":t[0]||(t[0]=p=>o.proname=p),placeholder:"请输入项目名称"},null,8,["value"])]),_:1}),r.operateType==="add"?(O(),se(n,{key:0,span:"24 s:12 m:12",label:"绑定合同",path:"contractIds"},{default:l(()=>[a(s(Se),{filterable:"",multiple:"",value:o.contractIds,"onUpdate:value":t[1]||(t[1]=p=>o.contractIds=p),placeholder:"请选择合同","label-field":"contractname","value-field":"id",options:s(at).data,onScroll:Qt},null,8,["value","options"])]),_:1})):Te("",!0),r.operateType==="edit"?(O(),se(n,{key:1,span:"24 s:12 m:12",label:"项目状态",path:"status"},{default:l(()=>[a(s(Se),{filterable:"",value:o.status,"onUpdate:value":t[2]||(t[2]=p=>o.status=p),placeholder:"请选择项目状态",options:s(Fe)(s(b).userInfo.usertype==0||s(b).userInfo.usertype==2?s(rt):s(Ga))},null,8,["value","options"])]),_:1})):Te("",!0),a(n,{span:"24 s:12 m:12",label:"周期（天）",path:"period"},{default:l(()=>[a(s(kt),{clearable:"",value:o.period,"onUpdate:value":t[3]||(t[3]=p=>o.period=p),style:{width:"100%"},placeholder:"请输入周期"},null,8,["value"])]),_:1}),a(n,{span:"24 s:12 m:12",label:"调试类型",path:"dtype"},{default:l(()=>[a(s(Se),{filterable:"",value:o.dtype,"onUpdate:value":t[4]||(t[4]=p=>o.dtype=p),placeholder:"请选择调试类型",options:s(Fe)(s(Et))},null,8,["value","options"])]),_:1}),a(n,{span:"24 s:12 m:12",label:"项目默认地点",path:"prosite"},{default:l(()=>[C("div",nn,[C("div",sn,[a(f,{onClick:t[6]||(t[6]=p=>pt())},{default:l(()=>[a(s(L),{value:o.prosite,"onUpdate:value":t[5]||(t[5]=p=>o.prosite=p),placeholder:"请选择项目地点"},null,8,["value"]),a(s(g),null,{icon:l(()=>[a(d,{class:"text-icon"})]),_:1})]),_:1})])])]),_:1}),a(n,{span:"24 s:12 m:12",label:"项目详细地址",path:"proaddr"},{default:l(()=>[a(s(L),{type:"textarea",rows:1,clearable:"",value:o.proaddr,"onUpdate:value":t[7]||(t[7]=p=>o.proaddr=p),placeholder:"请输入项目详细地址"},null,8,["value"])]),_:1}),V.value.length?(O(),se(n,{key:2,span:"24 s:12 m:24",label:"",path:""},{default:l(()=>[C("div",ln,[C("div",on,[C("span",{class:"mr-10px",onClick:t[8]||(t[8]=Ct(()=>{},["stop"]))},"其他地址"),a(s(g),{size:"small",ghost:"",type:"primary",onMousedown:t[9]||(t[9]=Ct(()=>{},["stop"])),onClick:t[10]||(t[10]=p=>V.value.push({latitude:30.303899,longitude:120.373885,address:""}))},{icon:l(()=>[a(k,{class:"text-icon"})]),default:l(()=>[t[16]||(t[16]=y(" 添加 "))]),_:1,__:[16]})]),C("div",rn,[(O(!0),Ue(wt,null,fa(V.value,(p,ke)=>(O(),Ue("div",{class:"flex px-50px items-center mt-10px w-100%",key:p.latitude},[C("span",un,"项目地址"+le(ke+1),1),a(f,{onClick:q=>pt(ke+1)},{default:l(()=>[a(s(L),{value:p.address,"onUpdate:value":q=>p.address=q,placeholder:"请选择项目地址"+(ke+1)},null,8,["value","onUpdate:value","placeholder"]),a(s(g),null,{icon:l(()=>[a(d,{class:"text-icon"})]),_:1})]),_:2},1032,["onClick"]),a(U,{class:"c-#f5222d font-size-24px cursor-pointer ml-10px",onClick:q=>V.value.splice(V.value.indexOf(p),1)},null,8,["onClick"])]))),128))])])]),_:1})):Te("",!0),a(n,{span:"24 s:12 m:12",label:"调度名称",path:"dispatch"},{default:l(()=>[a(s(L),{clearable:"",value:o.dispatch,"onUpdate:value":t[11]||(t[11]=p=>o.dispatch=p),placeholder:"请输入调度名称"},null,8,["value"])]),_:1}),a(n,{span:"24 s:12 m:12",label:"选择调度",path:"dispatchIds"},{default:l(()=>[a(s(Se),{filterable:"",multiple:"",value:o.dispatchIds,"onUpdate:value":t[12]||(t[12]=p=>o.dispatchIds=p),placeholder:"请选择调度","label-field":"dname","value-field":"id",options:vt.value},null,8,["value","options"])]),_:1}),a(n,{span:"24 s:12 m:24",path:"contactList"},{default:l(()=>[C("div",dn,[a(s(de),{align:"center",style:{"margin-bottom":"10px"}},{default:l(()=>[t[18]||(t[18]=C("span",null,"项目联系人",-1)),a(s(g),{size:"small",ghost:"",type:"primary",onClick:pe},{icon:l(()=>[a(k,{class:"text-icon"})]),default:l(()=>[t[17]||(t[17]=y(" 添加项目联系人 "))]),_:1,__:[17]})]),_:1,__:[18]}),a(S,{columns:A,"paginate-single-page":!1,data:h.value,pagination:N,"max-height":350},null,8,["data","pagination"])])]),_:1}),a(n,{span:"24 s:12 m:24",path:"debuggedDevieceList"},{default:l(()=>[C("div",cn,[a(s(de),{align:"center",style:{"margin-bottom":"10px"}},{default:l(()=>[t[20]||(t[20]=C("span",null,"待调试设备",-1)),a(s(g),{size:"small",ghost:"",type:"primary",onClick:Le},{icon:l(()=>[a(k,{class:"text-icon"})]),default:l(()=>[t[19]||(t[19]=y(" 添加待调试设备 "))]),_:1,__:[19]})]),_:1,__:[20]}),a(S,{columns:ze,"paginate-single-page":!1,data:m.value,pagination:F,"max-height":350},null,8,["data","pagination"])])]),_:1}),a(n,{span:"24 s:12 m:24"},{default:l(()=>[C("div",pn,[a(s(de),{align:"center",style:{"margin-bottom":"10px"}},{default:l(()=>[t[22]||(t[22]=C("span",null,"图纸",-1)),a(s(g),{size:"small",ghost:"",type:"primary",onClick:ge},{icon:l(()=>[a(k,{class:"text-icon"})]),default:l(()=>[t[21]||(t[21]=y(" 添加图纸 "))]),_:1,__:[21]})]),_:1,__:[22]}),i.value.length>0?(O(),se(S,{key:0,columns:me,data:i.value,size:"small","scroll-x":702,"row-key":p=>p.id,"max-height":350},null,8,["data","row-key"])):Te("",!0)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"]),a(K,{show:he.value,"onUpdate:show":t[15]||(t[15]=p=>he.value=p),title:"选择项目位置",preset:"card",class:"w-800px"},{footer:l(()=>[a(s(de),{justify:"end",size:16},{default:l(()=>[a(s(g),{onClick:Kt},{default:l(()=>[y(le(s($)("common.cancel")),1)]),_:1}),a(s(g),{type:"primary",onClick:Gt},{default:l(()=>[y(le(s($)("common.confirm")),1)]),_:1})]),_:1})]),default:l(()=>[Me.value?(O(),se(be,{key:0,value:re.value,"onUpdate:value":[t[14]||(t[14]=p=>re.value=p),s(ct)],options:Re.value,placeholder:"请输入地点关键字",clearable:"",onSelect:Vt},null,8,["value","options","onUpdate:value"])):Te("",!0),C("div",{ref_key:"domRef",ref:et,class:"h-full w-full",style:{width:"100%",height:"500px","margin-top":"10px"}},null,512)]),_:1},8,["show"])],64)}}}),fn=He({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:qe(["reset","search"],["update:model"]),setup(E,{emit:G}){Na();const b=G,{formRef:Z,restoreValidation:M}=jt(),r=lt(E,"model"),o={当日:()=>{const v=new Date().getTime();return[v,v]},本周:()=>{const v=new Date().getTime();return[v-24*60*60*1e3*7,v]},上月:()=>{const v=new Date().getTime();return[v-24*60*60*1e3*30,v]},近一年:()=>{const v=new Date().getTime();return[v-24*60*60*1e3*365,v]},近三年:()=>{const v=new Date().getTime();return[v-24*60*60*1e3*365*3,v]}};function te(){r.value.fuzzy="",b("search")}async function D(v,x){if(!v){r.value.startTime=void 0,r.value.endTime=void 0,b("search");return}r.value.startTime=String(It(1,x[0])),r.value.endTime=String(It(1,x[1])),b("search")}async function Q(){r.value.startTime=void 0,r.value.endTime=void 0,r.value.startAndTimeRange=null,r.value.fuzzy="",r.value.status=null,r.value.ptype=null,r.value.dtype=null,await M(),b("reset")}const ie=Tt.debounce(v=>{b("search")},1e3,{leading:!0,trailing:!1}),I=v=>{r.value.fuzzy=v,ie(v)};async function R(){b("search")}return(v,x)=>{const h=L,N=Rt,A=Se,_=Wa,B=Qa,W=g,ce=Za,pe=de,m=Mt,F=$t,ze=ot;return O(),se(ze,{bordered:!1,size:"small",class:"card-wrapper"},{default:l(()=>[a(F,{ref_key:"formRef",ref:Z,model:r.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:Ut(R,["enter"])},{default:l(()=>[a(m,{responsive:"screen","item-responsive":"","x-gap":16,"y-gap":16},{default:l(()=>[a(N,{span:"24 s:12 m:6",label:"项目/客户",path:"fuzzy"},{default:l(()=>[a(h,{clearable:"",value:r.value.fuzzy,"onUpdate:value":x[0]||(x[0]=P=>r.value.fuzzy=P),placeholder:"请输入项目名称或客户名称",onClear:te,onInput:I},null,8,["value"])]),_:1}),a(N,{span:"24 s:12 m:6",label:"项目状态",path:"status"},{default:l(()=>[a(A,{clearable:"",filterable:"",value:r.value.status,"onUpdate:value":[x[1]||(x[1]=P=>r.value.status=P),R],placeholder:"请选择项目状态",options:s(Fe)(s(rt))},null,8,["value","options"])]),_:1}),a(N,{span:"24 s:12 m:6",label:"进度状态",path:"ptype"},{default:l(()=>[a(A,{clearable:"",filterable:"",value:r.value.ptype,"onUpdate:value":[x[2]||(x[2]=P=>r.value.ptype=P),R],placeholder:"请选择进度状态",options:[{label:"正常",value:0},{label:"已延期",value:1}]},null,8,["value"])]),_:1}),a(N,{span:"24 s:12 m:6",label:"调试类型",path:"dtype"},{default:l(()=>[a(A,{clearable:"",filterable:"",value:r.value.dtype,"onUpdate:value":[x[3]||(x[3]=P=>r.value.dtype=P),R],placeholder:"请选择调试类型",options:s(Fe)(s(Et))},null,8,["value","options"])]),_:1}),a(N,{span:"24 s:12 m:8",label:"起止时间"},{default:l(()=>[a(_,{value:r.value.startAndTimeRange,"onUpdate:value":x[4]||(x[4]=P=>r.value.startAndTimeRange=P),type:"datetimerange",clearable:"",shortcuts:o,"onUpdate:formattedValue":D},null,8,["value"])]),_:1}),a(N,{span:"24  s:12 m:6",class:"pr-24px"},{default:l(()=>[a(pe,{class:"w-full"},{default:l(()=>[a(W,{onClick:Q},{icon:l(()=>[a(B,{class:"text-icon"})]),default:l(()=>[y(" "+le(s($)("common.reset")),1)]),_:1}),a(W,{type:"primary",ghost:"",onClick:R},{icon:l(()=>[a(ce,{class:"text-icon"})]),default:l(()=>[y(" "+le(s($)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),gn={class:"min-h-500px flex gap-16px"},vn={class:"flex items-center justify-end gap-16px"},hn=He({__name:"relatedContractLook",props:qe({id:{}},{visable:{type:Boolean},visableModifiers:{}}),emits:["update:visable"],setup(E){const G=E,b=lt(E,"visable"),{columns:Z,data:M,getData:r,loading:o,mobilePagination:te,searchParams:D}=st({apiFn:Pa,immediate:!1,apiParams:{page:1,pageSize:20,limit:20,id:G.id,_t:new Date().getTime()},columns:()=>[{key:"contractname",title:"合同",width:200,render:_=>a("div",{class:h.pids==_.id?"bg-#f1f1f1 cursor-pointer p-5px":"cursor-pointer p-5px",onClick:()=>N(_.id)},[a("div",{class:"flex"},[a("div",{class:"w-60px inline-block"},[y("名称：")]),_.contractname]),a("div",{class:"font-size-12px c-#7d7575 flex"},[a("div",{class:"w-60px inline-block"},[y("编号：")]),y(" "),_.contractnum]),a("div",{class:"font-size-12px c-#7d7575 flex"},[a("div",{class:"w-60px inline-block"},[y("联系人：")]),_.businesscon]),a("div",{class:"font-size-12px c-#7d7575 flex"},[a("div",{class:"w-60px inline-block"},[y("联系方式：")]),_.businessinfo]),a("div",{class:"font-size-12px c-#7d7575 flex"},[a("div",{class:"w-60px inline-block"},[y("注意事项：")]),_.precautions]),a("div",{class:"font-size-12px c-#7d7575 flex"},[a("div",{class:"w-60px inline-block"},[y("备注：")]),_.notes])])}]}),{columns:Q,data:ie,getData:I,loading:R,pagination:v,mobilePagination:x,searchParams:h}=st({apiFn:ja,immediate:!1,apiParams:{page:1,pageSize:20,limit:20,pids:G.id,_t:new Date().getTime()},columns:()=>[{key:"devname",title:"设备名称",align:"center",width:200,ellipsis:{tooltip:!0}},{key:"devcount",title:"数量",align:"center",width:120},{key:"devmodel",title:"规格型号",align:"center",width:120,ellipsis:{tooltip:!0}},{key:"devunit",title:"单位",align:"center",width:120},{key:"devtype",title:"是否为我司设备",align:"center",width:120,render:_=>_.devtype==0?a(Ke,{type:"success"},{default:()=>[y("是")]}):a(Ke,{type:"info"},{default:()=>[y("否")]})},{key:"devmanu",title:"设备厂家",align:"center",width:120},{key:"notes",title:"备注",align:"center",width:120},{key:"username",title:"创建人",align:"center",width:120},{key:"dbtime",title:"创建时间",align:"center",width:180}]}),N=_=>{h.pids=_,I()},A=()=>{b.value=!1};return Ge(()=>b.value,async _=>{var B;_&&(D.id=G.id,ie.value=[],v.itemCount=0,await r(),h.pids=(B=M.value[0])==null?void 0:B.id,h.pids&&I())}),(_,B)=>{const W=it,ce=ot,pe=At;return O(),se(pe,{show:b.value,"onUpdate:show":B[0]||(B[0]=m=>b.value=m),preset:"card",class:"w-1400px",title:"项目关联的合同"},{footer:l(()=>[C("div",vn,[a(s(g),{type:"primary",size:"small",onClick:A},{default:l(()=>B[1]||(B[1]=[y(" 关闭 ")])),_:1,__:[1]})])]),default:l(()=>[C("div",gn,[a(W,{class:"left",columns:s(Z),data:s(M),"paginate-single-page":!1,size:"small",remote:"",loading:s(o),pagination:s(te),"row-key":m=>m.id,"max-height":600},null,8,["columns","data","loading","pagination","row-key"]),a(ce,{bordered:!1,size:"small",title:"设备",class:"w-1100px"},{default:l(()=>[a(W,{style:{width:"100%"},columns:s(Q),data:s(ie),size:"small","max-height":600,loading:s(R),remote:"","scroll-x":s(Q).reduce((m,F)=>m+(F.width||100),0),"paginate-single-page":!1,pagination:s(x),"row-key":m=>m.id},null,8,["columns","data","loading","scroll-x","pagination","row-key"])]),_:1})])]),_:1},8,["show"])}}}),yn=Ot(hn,[["__scopeId","data-v-a53f455a"]]),_n={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function Nt(E){return typeof E=="function"||Object.prototype.toString.call(E)==="[object Object]"&&!Ma(E)}const bn=He({name:"projectmanagement_projectlist",__name:"index",setup(E){const G=Ta(),b=Pt(),Z=$a(),M=Ua(),{columns:r,columnChecks:o,data:te,getData:D,loading:Q,mobilePagination:ie,searchParams:I}=st({showTotal:!0,apiFn:Ea,apiParams:{page:1,pageSize:20,limit:20,status:null,startAndTimeRange:null,startTime:null,endTime:null,creater:void 0,fuzzy:"",sort:void 0,_t:new Date().getTime()},immediate:!1,columns:()=>[{type:"selection",align:"center",width:48},{key:"proname",title:"项目名称",align:"center",width:240,render:i=>a("div",{class:"cursor-pointer",onClick:()=>Le(i)},[i.proname])},{key:"progess",title:"项目进度",align:"center",width:140,sorter:!0,render:i=>a(Lt,{type:"line",showIndicator:!0,percentage:i.progess,"indicator-placement":"inside",processing:!0,color:"#1890ff"},null)},{key:"status",title:"项目状态",align:"center",width:120,defaultFilterOptionValue:null,filterOptions:Fe(rt),filter:!0,filterMultiple:!1,render:i=>{if(i.status===null)return null;const c=$(Ka[i.status]);return a("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",color:i.status===0?"#3498db":i.status===1?"#f39c12":i.status===2?"#f1c40f":"#2ecc71",borderRadius:"50%"}},[a("span",{style:{width:"10px",height:"10px",marginRight:"5px",backgroundColor:i.status===0?"#3498db":i.status===1?"#f39c12":i.status===2?"#f1c40f":"#2ecc71",borderRadius:"50%"}},null),a("span",null,[c])])}},{key:"cpdbtime",title:"预计完成日期",align:"center",width:180,ellipsis:{tooltip:!0}},{key:"period",title:"周期",align:"center",width:100,render:i=>a("div",null,[i.period,y("天")])},{key:"ptype",title:"状态",align:"center",width:100,render:i=>a(Ke,{type:i.ptype===0?"success":"error"},{default:()=>[i.ptype===0?"正常":"已延期"]})},{key:"dtype",title:"调试类型",align:"center",width:100,render:i=>{if(i.dtype===null)return null;const c=$(Ha[i.dtype]);return a(Ke,{type:i.dtype==0?"warning":i.dtype==1?"success":"info"},Nt(c)?c:{default:()=>[c]})}},{key:"username",title:"创建人",align:"center",width:100,ellipsis:{tooltip:!0}},{key:"dbtime",title:"创建时间",align:"center",width:180},{key:"operate",title:$("common.operate"),align:"center",width:320,fixed:"right",render:i=>{let c;return a("div",{class:"flex justify-end gap-8px"},[i.status==0&&(b.userInfo.usertype==0||b.userInfo.usertype==2||b.userInfo.usertype==3)&&a(Ae,{onPositiveClick:()=>W(i,1)},{default:()=>"确定启动项目吗？",trigger:()=>$e(a(g,{type:"success",ghost:!0,size:"small"},{default:()=>["启动"]}),[[Ve("no-auth"),"project:Info:update"]])}),i.status==2&&(b.userInfo.usertype==0||b.userInfo.usertype==2)&&a(Ae,{onPositiveClick:()=>W(i,3)},{default:()=>"是否确认执行审核操作？",trigger:()=>$e(a(g,{type:"warning",ghost:!0,size:"small"},{default:()=>["审核"]}),[[Ve("no-auth"),"project:Info:update"]])}),a(g,{type:"primary",ghost:!0,size:"small",onClick:()=>Le(i)},{default:()=>["详情"]}),a(g,{type:"primary",ghost:!0,size:"small",onClick:()=>ze(i)},{default:()=>["关联合同"]}),$e(a(g,{type:"primary",ghost:!0,size:"small",onClick:()=>ce(i.id)},Nt(c=$("common.edit"))?c:{default:()=>[c]}),[[Ve("no-auth"),"project:Info:update"]])])}}]}),{drawerVisible:R,operateType:v,editingData:x,handleAdd:h,handleEdit:N,checkedRowKeys:A,onBatchDeleted:_}=Ra(te,D);async function B(){console.log(A.value),pe(A.value.join(","),i=>{_()})}const W=async(i,c)=>{var ge;const{data:me,error:fe}=await Ft([{id:i.id,status:c}]);fe||((ge=window.$message)==null||ge.success("操作成功"),D(),c==3&&window.dispatchEvent(new CustomEvent("clearReview",{detail:{id:i.pid,type:"prj"}})))};function ce(i){N(i)}async function pe(i,c){const{data:me,error:fe}=await Oa(i);if(!fe)c&&c(me);else return!1}const m=w(!1),F=w(0),ze=i=>{m.value=!0,F.value=i.id},P=i=>{I.status=i.status,D()},Xe=i=>{console.log(i),i.columnKey=="progess"&&(I.sort=i.order=="ascend"?0:i.order=="descend"?1:void 0,D())},we=w(-1),Ze=i=>{i>0?(we.value=i,I.creater=JSON.parse(JSON.stringify(i)),D()):(I.creater=void 0,we.value=-1,D())},Le=i=>{Z.push("/projectmanagement/orderdetail?prjId="+i.id),b.setProjectInfo({pid:i.id,pname:i.proname})},Oe=()=>{D()};return Aa(()=>{M.query.pname?(I.fuzzy=M.query.pname,I.status=2,Oe()):D()}),Ge(()=>M.query.pname,i=>{i&&(I.fuzzy=i,D())}),(i,c)=>{const me=Ya,fe=La,ge=de,Qe=aa,We=ta,ve=ea,Ye=it,Y=ot,Ie=Ve("no-auth");return O(),Ue("div",_n,[a(fn,{model:s(I),"onUpdate:model":c[0]||(c[0]=j=>Je(I)?I.value=j:null),onReset:Oe,onSearch:s(D)},null,8,["model","onSearch"]),a(Y,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:l(()=>[a(ge,{align:"center",wrap:"",class:"lt-sm:w-200px"},{default:l(()=>[c[6]||(c[6]=C("div",null,"项目列表",-1)),a(fe,{size:"small",value:we.value,"onUpdate:value":[c[1]||(c[1]=j=>we.value=j),Ze],name:"radiobuttongroup1"},{default:l(()=>[a(me,{value:-1,label:"默认"}),a(me,{value:s(b).userInfo.id,label:"我创建的"},null,8,["value"])]),_:1},8,["value"])]),_:1,__:[6]})]),"header-extra":l(()=>[a(ge,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:l(()=>[$e((O(),se(s(g),{onClick:s(h),size:"small",ghost:"",type:"primary"},{icon:l(()=>[a(Qe,{class:"text-icon"})]),default:l(()=>[c[7]||(c[7]=y(" "+le("新增项目")))]),_:1,__:[7]},8,["onClick"])),[[Ie,"project:Info:insert"]]),a(s(Ae),{onPositiveClick:B},{trigger:l(()=>[$e((O(),se(s(g),{size:"small",ghost:"",type:"error",disabled:s(A).length==0},{icon:l(()=>[a(We,{class:Fa(["text-icon",{"animate-spin":s(Q)}])},null,8,["class"])]),default:l(()=>[c[8]||(c[8]=y(" "+le("批量删除")))]),_:1,__:[8]},8,["disabled"])),[[Ie,"project:Info:delete"]])]),default:l(()=>[c[9]||(c[9]=y(" 确定要删除选中的合同吗？ "))]),_:1,__:[9]}),a(ve,{columns:s(o),"onUpdate:columns":c[2]||(c[2]=j=>Je(o)?o.value=j:null)},null,8,["columns"])]),_:1})]),default:l(()=>[a(Ye,{"checked-row-keys":s(A),"onUpdate:checkedRowKeys":c[3]||(c[3]=j=>Je(A)?A.value=j:null),columns:s(r),data:s(te),size:"small","flex-height":!s(G).isMobile,"scroll-x":s(r).reduce((j,he)=>j+(he.width||100),0),loading:s(Q),remote:"","row-key":j=>j.id,"onUpdate:sorter":Xe,pagination:s(ie),class:"sm:h-full","onUpdate:filters":P},null,8,["checked-row-keys","columns","data","flex-height","scroll-x","loading","row-key","pagination"]),a(mn,{visible:s(R),"onUpdate:visible":c[4]||(c[4]=j=>Je(R)?R.value=j:null),onSubmitted:s(D),"operate-type":s(v),"row-data":s(x)},null,8,["visible","onSubmitted","operate-type","row-data"]),a(yn,{visable:m.value,"onUpdate:visable":c[5]||(c[5]=j=>m.value=j),id:F.value},null,8,["visable","id"])]),_:1})])}}}),On=Ot(bn,[["__scopeId","data-v-a50eee5d"]]);export{On as default};

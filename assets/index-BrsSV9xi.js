import{_ as F}from"./export-BC516o7C.js";import{d as $,n as I,s as M,o as C,c as E,w as o,g as t,i as a,$ as n,W as O,dr as S,h as D,t as z,F as P,J as W,Z as A,B as R,N as G,O as K,ad as T,a3 as V,av as B,L as q,j as J,D as Z,e as H,ah as Q,E as X,aj as Y}from"./index-DsBlqHIZ.js";import{b as ee,c as te}from"./system-log-4OS-JPor.js";import{u as ae}from"./table-DoWm6cq9.js";import{_ as ne}from"./round-search-WKsxqVLg.js";import{_ as oe}from"./round-refresh-Ck-gzDyX.js";import{_ as se}from"./lodash-BKkYyAYu.js";import{_ as le}from"./FormItemGridItem-C6y586sw.js";import{_ as re}from"./Grid-Bcvow_UB.js";const ie=$({name:"LoginlogSearch",__name:"loginlog-search",props:{model:{required:!0},modelModifiers:{}},emits:I(["reset","search"],["update:model"]),setup(L,{expose:h,emit:f}){const b=f,l=M(L,"model");function y(i){l.value.creatorName=i.replace(/\s/g,"")}function x(i){return!i.startsWith(" ")&&!i.endsWith(" ")}function m(){b("reset")}function p(){b("search")}async function v(){const{data:i,error:e}=await ee({creatorName:l.value.creatorName,status:l.value.status});if(!e){let s=i,c=new Blob([s],{type:"application/vnd.ms-excel"}),g=new Date().getTime()+".xls",d=window.webkitURL.createObjectURL(c),r=document.createElement("a");r.href=d,r.download=g,document.body.appendChild(r),r.click(),r.remove()}}const _=se.debounce(p,1e3,{leading:!0,trailing:!1});return h({handleExportChange:v}),(i,e)=>{const s=W,c=le,g=A,d=oe,r=R,N=ne,u=G,k=re,U=K,j=T;return C(),E(j,{bordered:!1,size:"small",class:"card-wrapper"},{default:o(()=>[t(U,{model:l.value,"label-placement":"left","label-width":80,"show-feedback":!1,onKeyup:P(a(_),["enter"])},{default:o(()=>[t(k,{responsive:"screen","item-responsive":"","x-gap":12,"y-gap":12},{default:o(()=>[t(c,{span:"24 s:12 m:8 l:6",label:a(n)("page.systemlog.login.creatorName"),path:"creatorName"},{default:o(()=>[t(s,{clearable:"",value:l.value.creatorName,"onUpdate:value":e[0]||(e[0]=w=>l.value.creatorName=w),placeholder:a(n)("page.systemlog.login.form.creatorName"),onInput:y,"allow-input":x,onClear:m},null,8,["value","placeholder"])]),_:1},8,["label"]),t(c,{span:"24 s:12 m:8 l:6",label:a(n)("page.systemlog.login.statusDesc"),path:"status"},{default:o(()=>[t(g,{filterable:"",clearable:"",value:l.value.status,"onUpdate:value":[e[1]||(e[1]=w=>l.value.status=w),p],placeholder:a(n)("page.systemlog.login.form.status"),options:a(O)(a(S)),onClear:m},null,8,["value","placeholder","options"])]),_:1},8,["label"]),t(c,{span:"24 s:12 m:8 l:6"},{default:o(()=>[t(u,{class:"w-full"},{default:o(()=>[t(r,{onClick:m},{icon:o(()=>[t(d,{class:"text-icon"})]),default:o(()=>[D(" "+z(a(n)("common.reset")),1)]),_:1}),t(r,{type:"primary",ghost:"",onClick:a(_)},{icon:o(()=>[t(N,{class:"text-icon"})]),default:o(()=>[D(" "+z(a(n)("common.search")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","onKeyup"])]),_:1})}}}),ce={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},ye=$({name:"logmanage_loginlog",__name:"index",setup(L){const h=V(),{columns:f,columnChecks:b,data:l,getData:y,loading:x,pagination:m,searchParams:p,resetSearchParams:v}=ae({apiFn:te,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,creatorName:null,status:null,_t:new Date().getTime()},columns:()=>[{key:"creatorName",title:n("page.systemlog.login.creatorName"),align:"center",width:160,resizable:!0},{key:"operation",title:n("page.systemlog.login.operation"),width:140,align:"center",render:e=>{const s=e.operation==0?n("page.manage.common.loginStatus.login"):n("page.manage.common.loginStatus.logout");return t("span",null,[s])},resizable:!0},{key:"status",title:n("page.systemlog.login.status"),width:100,align:"center",render:e=>{e.status==null&&(e.status=0);const s=n(S[e.status].label);return e.status==1?t(B,{size:"small",type:e.status==1?"success":"error"},{default:()=>[e.status==1?"成功":"失败"]}):t(q,null,{trigger:()=>t(B,{size:"small",type:e.status==1?"success":"error"},{default:()=>[e.status==1?"成功":"失败"]}),default:()=>t("span",null,[s])})},resizable:!0},{key:"statusDesc",title:n("page.systemlog.login.statusDesc"),width:140,align:"center",render:e=>{e.status==null&&(e.status=0);const s=n(S[e.status].label);return e.status==1?e.operation==0?"登录成功":"退出成功":t("span",null,[s])},resizable:!0},{key:"ip",title:n("page.systemlog.login.ip"),width:160,align:"center",resizable:!0},{key:"userAgent",title:n("page.systemlog.login.userAgent"),minWidth:400,align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"createDate",title:n("page.systemlog.login.createDate"),width:160,align:"center"}]}),_=J(),i=()=>{_.value.handleExportChange()};return(e,s)=>{const c=F,g=R,d=Y,r=T,N=Z("no-auth");return C(),H("div",ce,[t(ie,{model:a(p),"onUpdate:model":s[0]||(s[0]=u=>Q(p)?p.value=u:null),onReset:a(v),onSearch:a(y),ref_key:"searchRef",ref:_},null,8,["model","onReset","onSearch"]),t(r,{title:a(n)("page.systemlog.login.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":o(()=>[X((C(),E(g,{type:"info",size:"small",ghost:"",onClick:i},{icon:o(()=>[t(c,{class:"text-icon"})]),default:o(()=>[D(" "+z(a(n)("common.export")),1)]),_:1})),[[N,"sys:log:login.export"]])]),default:o(()=>[t(d,{columns:a(f),data:a(l),size:"small","flex-height":!a(h).isMobile,"scroll-x":a(f).reduce((u,k)=>u+k.width,0),loading:a(x),remote:"","row-key":u=>u.id,pagination:a(m),class:"sm:h-full"},null,8,["columns","data","flex-height","scroll-x","loading","row-key","pagination"])]),_:1},8,["title"])])}}});export{ye as default};

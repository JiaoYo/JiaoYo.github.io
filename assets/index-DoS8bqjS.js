import{_ as X}from"./refresh-CC9wQokF.js";import{cS as Y,dH as O,d as Z,a5 as ee,g as e,$ as c,B as d,j as te,F as ae,o as D,e as ne,w as l,i as t,h as u,G as le,c as oe,bn as se,t as h,aj as A,H as re,ak as ie,P as ce,al as de,af as ue,a1 as pe,M as me,Q as _e,ah as fe,ai as ge}from"./index-uWl0lIER.js";import{u as ve,a as he}from"./table-Dyr_phsm.js";import{h as ye,i as we,j as be,k as ke}from"./common-CHTsvAd3.js";import{_ as S}from"./Popconfirm-BWtR0oNy.js";const Ce={0:"page.manage.alarm.statusObj.open",1:"page.manage.alarm.statusObj.close"};Y(Ce);const N={1:"外设（USB）",2:"网络连接",3:"进程启停",4:"软件安装与卸载",5:"登陆异常",6:"系统解锁",7:"达到阈值",8:"Licnse过期"},xe=O(N),j={0:"一般",1:"低级",2:"中级",3:"高级",4:"严重"},De=O(j),Ae={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function T(m){return typeof m=="function"||Object.prototype.toString.call(m)==="[object Object]"&&!ie(m)}const Be=Z({name:"platformalarm_alarmlevelconfig",__name:"index",setup(m){const z=ee(),{columns:R,columnChecks:Se,data:y,getData:_,loading:w,mobilePagination:L,searchParams:Te,resetSearchParams:Oe}=ve({apiFn:ye,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48},{key:"atype",title:"告警类型",align:"center",width:240,render:n=>e("span",null,[N[n.atype]])},{key:"alevel",title:"告警级别",align:"center",width:240,render:n=>e("span",null,[j[n.alevel]])},{key:"operate",title:c("common.operate"),align:"center",width:130,render:n=>{let a;return e("div",{class:"flex-center gap-8px"},[e(d,{type:"primary",ghost:!0,size:"small",onClick:()=>V(n.id)},T(a=c("common.edit"))?a:{default:()=>[a]}),e(S,{onPositiveClick:()=>K(n.id)},{default:()=>c("common.confirmDelete"),trigger:()=>{let r;return e(d,{type:"error",ghost:!0,size:"small"},T(r=c("common.delete"))?r:{default:()=>[r]})}})])}}]}),{drawerVisible:f,operateType:g,editingData:B,handleAdd:P,handleEdit:$,checkedRowKeys:p,onBatchDeleted:U,onDeleted:F,closeDrawer:v}=he(y,_);function K(n){console.log(n),b(n,a=>{F()})}function V(n){$(n),Object.assign(s.value,B.value)}async function b(n,a){const{data:r,error:i}=await we({ids:n});if(!i)a&&a(r);else return!1}const M=()=>{b(p.value.join(","),n=>{U()})},s=te({atype:void 0,alevel:void 0}),q=()=>{s.value={atype:void 0,alevel:void 0},P()},E={atype:[{type:"number",required:!0,message:"请选择告警类型",trigger:"blur"}],alevel:[{type:"number",required:!0,message:"请选择告警等级",trigger:"blur"}]},k=async()=>{var n,a;if(g.value==="add"){const{data:r,error:i}=await be([s.value]);i||(v(),_())}else{const{data:r,error:i}=await ke([s.value]);i||(v(),_())}f.value=!1,(n=window.$message)==null||n.destroyAll(),(a=window.$message)==null||a.success(g.value==="add"?"添加成功":"编辑成功")};return(n,a)=>{const r=X,i=ce,G=de,H=ue,C=pe,x=me,I=_e,Q=fe,J=ge,W=ae("no-auth");return D(),ne("div",Ae,[e(H,{title:"告警级别配置",bordered:!1,size:"small",class:"sm:flex-1-hidden"},{"header-extra":l(()=>[e(i,null,{default:l(()=>[e(t(d),{size:"small",ghost:"",type:"primary",onClick:q},{default:l(()=>[u(" 添加 ")]),_:1}),e(t(S),{onPositiveClick:M},{trigger:l(()=>[le((D(),oe(t(d),{size:"small",ghost:"",type:"error",disabled:t(p).length===0},{default:l(()=>[u(" 批量删除 ")]),_:1},8,["disabled"])),[[W,"sys.system.alarm.delete"]])]),default:l(()=>[u(" 确定要删除选中的数据吗？ ")]),_:1}),e(t(d),{size:"small",onClick:a[0]||(a[0]=o=>t(_)())},{icon:l(()=>[e(r,{class:se(["text-icon",{"animate-spin":t(w)}])},null,8,["class"])]),default:l(()=>[u(" "+h(t(c)("common.refresh")),1)]),_:1})]),_:1})]),default:l(()=>[e(G,{"checked-row-keys":t(p),"onUpdate:checkedRowKeys":a[1]||(a[1]=o=>A(p)?p.value=o:null),columns:t(R),data:t(y),size:"small","flex-height":!t(z).isMobile,"scroll-x":962,loading:t(w),remote:"","row-key":o=>o.id,pagination:t(L),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1}),e(J,{show:t(f),"onUpdate:show":a[4]||(a[4]=o=>A(f)?f.value=o:null),"display-directive":"show",width:360},{default:l(()=>[e(Q,{title:t(g)==="add"?"添加":"编辑","native-scrollbar":!1,closable:""},{footer:l(()=>[e(i,{size:16},{default:l(()=>[e(t(d),{onClick:t(v)},{default:l(()=>[u(h(t(c)("common.cancel")),1)]),_:1},8,["onClick"]),e(t(d),{type:"primary",onClick:k},{default:l(()=>[u(h(t(c)("common.confirm")),1)]),_:1})]),_:1})]),default:l(()=>[e(I,{ref:"formRef",model:s.value,rules:E,onKeyup:re(k,["enter"])},{default:l(()=>[e(x,{label:"告警类型",path:"atype"},{default:l(()=>[e(C,{value:s.value.atype,"onUpdate:value":a[2]||(a[2]=o=>s.value.atype=o),placeholder:"请选择告警类型",clearable:"",filterable:"",options:t(xe),"reset-menu-on-options-change":!1},null,8,["value","options"])]),_:1}),e(x,{label:"告警级别",path:"alevel"},{default:l(()=>[e(C,{value:s.value.alevel,"onUpdate:value":a[3]||(a[3]=o=>s.value.alevel=o),placeholder:"请选择告警级别",clearable:"",filterable:"",options:t(De),"reset-menu-on-options-change":!1},null,8,["value","options"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])])}}});export{Be as default};

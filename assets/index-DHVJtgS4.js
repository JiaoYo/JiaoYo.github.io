import{_ as W}from"./table-header-operation.vue_vue_type_script_setup_true_lang-C4VRQsxL.js";import{d as V,q as j,s as L,v as q,x as X,b as Y,r as ee,y as oe,K as F,o as A,c as E,w as t,g as e,h as M,t as P,i as o,$ as m,L as O,A as G,C as te,D as H,B as U,E as Z,aa as ne,ab as ae,M as se,a9 as J,Z as le,e as re,ac as B,ad as ie}from"./index-CsSYpLym.js";import{u as ce,a as ue}from"./table-DCxpav6d.js";import{o as me,p as de,q as pe,r as _e}from"./log-s9UnMBlk.js";import{_ as fe}from"./round-search-Dtp7E9Hm.js";import{_ as ge}from"./round-refresh-DOrEb6Qo.js";import{_ as he}from"./FormItemGridItem-Bdm6h163.js";import{_ as ve}from"./Grid-C4cZ6WxQ.js";import{h as I}from"./permission-CTF5Ee2q.js";import{_ as ye}from"./Popconfirm-DEvmG-Lq.js";import{_ as we}from"./DataTable-aZh4mZz2.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-DA9Hc1O-.js";import"./setting-outlined-D6k74DJG.js";import"./round-delete-CGs2xQbQ.js";import"./refresh-C8V4ZZfl.js";import"./round-plus-BCWcqFXE.js";import"./Upload-Dto-1aHs.js";import"./Progress-6NqKhq42.js";import"./Forward-C9tKHKQU.js";const be=V({name:"OperateDrawer",__name:"operate-drawer",props:j({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:j(["submitted"],["update:visible"]),setup(d,{emit:N}){const l=d,g=N,c=L(d,"visible"),{formRef:r,validate:b,restoreValidation:z}=q(),{defaultRequiredRule:h}=X(),T=Y(()=>({add:"新增日志源类别",edit:"编辑日志源类别"})[l.operateType]),a=ee(D());function D(){return{id:void 0,cname:"",sysparam:0}}const k={cname:h};function C(){Object.assign(a,D()),l.operateType==="edit"&&l.rowData&&Object.assign(a,l.rowData)}function v(){c.value=!1}async function u(){var y,i;if(await b(),l.operateType==="add"){const{data:x,error:p}=await me([a]);p||((y=window.$message)==null||y.success(m("common.addSuccess")),v(),g("submitted"))}else{const{data:x,error:p}=await de([a]);p||((i=window.$message)==null||i.success(m("common.updateSuccess")),v(),g("submitted"))}}return oe(c,()=>{c.value&&(C(),z())}),(y,i)=>{const x=G,p=te,R=H,S=U,$=Z,s=ne,n=ae,_=F("no-space");return A(),E(n,{show:c.value,"onUpdate:show":i[1]||(i[1]=w=>c.value=w),"display-directive":"show",width:360},{default:t(()=>[e(s,{title:T.value,"native-scrollbar":!1,closable:""},{footer:t(()=>[e($,{size:16},{default:t(()=>[e(S,{onClick:v},{default:t(()=>[M(P(o(m)("common.cancel")),1)]),_:1}),e(S,{type:"primary",onClick:u},{default:t(()=>[M(P(o(m)("common.confirm")),1)]),_:1})]),_:1})]),default:t(()=>[e(R,{ref_key:"formRef",ref:r,model:a,rules:k},{default:t(()=>[e(p,{label:"名称",path:"cname"},{default:t(()=>[O(e(x,{clearable:"",value:a.cname,"onUpdate:value":i[0]||(i[0]=w=>a.cname=w),placeholder:"请输入名称"},null,8,["value"]),[[_]])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),De=V({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:j(["reset","search"],["update:model"]),setup(d,{emit:N}){const l=N,{formRef:g,restoreValidation:c}=q(),r=L(d,"model");function b(){r.value.fuzzy=void 0,l("search")}async function z(){await c(),l("reset")}async function h(){l("search")}return(T,a)=>{const D=G,k=he,C=ge,v=U,u=fe,y=Z,i=ve,x=H,p=J,R=F("no-space");return A(),E(p,{bordered:!1,size:"small",class:"card-wrapper"},{default:t(()=>[e(x,{ref_key:"formRef",ref:g,model:r.value,"label-placement":"left","label-width":80,"show-feedback":!1,onKeyup:se(h,["enter"])},{default:t(()=>[e(i,{responsive:"screen","item-responsive":""},{default:t(()=>[e(k,{span:"24 s:12 m:6",label:"名称",path:"fuzzy",class:"pr-24px"},{default:t(()=>[O(e(D,{clearable:"",value:r.value.fuzzy,"onUpdate:value":a[0]||(a[0]=S=>r.value.fuzzy=S),placeholder:"请输入名称关键字",onClear:b},null,8,["value"]),[[R]])]),_:1}),e(k,{span:"24  s:12 m:6",class:"pr-24px"},{default:t(()=>[e(y,{class:"w-full"},{default:t(()=>[e(v,{onClick:z},{icon:t(()=>[e(C,{class:"text-icon"})]),default:t(()=>[M(" "+P(o(m)("common.reset")),1)]),_:1}),e(v,{type:"primary",ghost:"",onClick:h},{icon:t(()=>[e(u,{class:"text-icon"})]),default:t(()=>[M(" "+P(o(m)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),ke={class:"min-h-500px flex-col-stretch gap-16px overflow-auto lt-sm:overflow-auto"};function K(d){return typeof d=="function"||Object.prototype.toString.call(d)==="[object Object]"&&!ie(d)}const Le=V({name:"logretrieval_logsourcecategory",__name:"index",setup(d){const N=le(),{columns:l,columnChecks:g,data:c,getData:r,loading:b,mobilePagination:z,searchParams:h,resetSearchParams:T}=ce({apiFn:pe,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,fuzzy:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48},{key:"cname",title:"名称",align:"center",width:240},{key:"operate",title:m("common.operate"),align:"center",width:130,render:s=>{let n;return s.sysparam!=0?e("div",{class:"flex-center gap-8px"},[O(e(U,{type:"primary",ghost:!0,size:"small",onClick:()=>S(s.id)},K(n=m("common.edit"))?n:{default:()=>[n]}),[[F("no-auth"),"log.source.category.update"]]),e(ye,{onPositiveClick:()=>R(s.id)},{default:()=>m("common.confirmDelete"),trigger:()=>{let _;return O(e(U,{type:"error",ghost:!0,size:"small"},K(_=m("common.delete"))?_:{default:()=>[_]}),[[F("no-auth"),"log.source.category.delete"]])}})]):null}}]}),{drawerVisible:a,operateType:D,editingData:k,handleAdd:C,handleEdit:v,checkedRowKeys:u,onBatchDeleted:y,onDeleted:i,closeDrawer:x}=ue(c,r);async function p(){console.log(u.value),$(u.value.join(","),s=>{y()})}function R(s){console.log(s),$(s,n=>{i()})}function S(s){v(s)}async function $(s,n){const{data:_,error:w}=await _e(s);if(!w)n&&n(_);else return!1}return(s,n)=>{const _=W,w=we,Q=J;return A(),re("div",ke,[e(De,{model:o(h),"onUpdate:model":n[0]||(n[0]=f=>B(h)?h.value=f:null),onReset:o(T),onSearch:o(r)},null,8,["model","onReset","onSearch"]),e(Q,{title:"日志源类别",bordered:!1,size:"small",class:"sm:flex-1-hidden"},{"header-extra":t(()=>[e(_,{columns:o(g),"onUpdate:columns":n[1]||(n[1]=f=>B(g)?g.value=f:null),"disabled-delete":o(u).length===0,"is-view-add-button":o(I)("log.source.category.insert"),"is-view-delete-button":o(I)("log.source.category.delete"),loading:o(b),onAdd:o(C),onDelete:p,onRefresh:o(r)},null,8,["columns","disabled-delete","is-view-add-button","is-view-delete-button","loading","onAdd","onRefresh"])]),default:t(()=>[e(w,{"checked-row-keys":o(u),"onUpdate:checkedRowKeys":n[2]||(n[2]=f=>B(u)?u.value=f:null),columns:o(l),data:o(c),size:"small","flex-height":!o(N).isMobile,"scroll-x":962,loading:o(b),remote:"","row-key":f=>f.id,pagination:o(z),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(be,{visible:o(a),"onUpdate:visible":n[3]||(n[3]=f=>B(a)?a.value=f:null),"operate-type":o(D),"row-data":o(k),onSubmitted:o(r)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1})])}}});export{Le as default};

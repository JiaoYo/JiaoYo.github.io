import{_ as le}from"./table-column-setting.vue_vue_type_script_setup_true_lang-BP0NONcX.js";import{_ as oe}from"./round-delete-C0sdMwec.js";import{_ as ie}from"./round-add-CbiPWPpG.js";import{d as Y,n as K,p as se,r as re,aU as S,q as de,s as ue,a6 as E,j as pe,ap as me,b as ce,$ as d,o as $,c as L,w as n,g as t,h as b,t as T,i,f as _e,ea as ve,eb as fe,G as ge,aj as be,I as he,J as q,K as ye,B as w,ak as we,ec as ke,z as j,y as R,ed as W,e as xe,aa as H,al as F,am as Ne,a1 as De}from"./index-QmClEG7y.js";import{u as Ue,a as Ce}from"./table-x0Q0wLac.js";import{_ as je}from"./FormItemGridItem-Bi831RuM.js";import{_ as Se}from"./Cascader-Cr-9l616.js";import{_ as $e,a as Te}from"./RadioGroup-BI3HroPe.js";import{_ as ze}from"./DatePicker-C6kltwlQ.js";import{_ as Pe}from"./Grid-D9ukfblt.js";import{N as Q}from"./Popconfirm-DT1axVu5.js";import{_ as Oe}from"./DataTable-BOogGWCD.js";import"./TimePicker-CT1GZhA6.js";import"./Forward-Bl4P6wDi.js";const Be=_e("span",null,"匹配前缀",-1),Ie=Y({__name:"inverter-model",props:K({operateType:{},rowData:{},Pagination:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:K(["submitted"],["update:visible"]),setup(v,{emit:z}){const p=se(v,"visible"),k=z,u=v,a=re(h());function h(){return{iname:"",model:"",manu:"",dbtime:S(0,new Date),isrep:0,ratpower:void 0,transformer:void 0,collline:void 0,pvmodule:void 0,pvcount:void 0,devid:void 0,prename:"",pre:1,unum:""}}function P(){Object.assign(a,h()),u.operateType==="edit"&&u.rowData&&(Object.assign(a,u.rowData),a.dbtime=S(0,a.dbtime))}const{formRef:G,validate:y,restoreValidation:O}=de();ue(),E(()=>u.rowData,()=>{P()}),E(p,()=>{p.value&&(_(),P(),O())});const x=()=>{p.value=!1},B=async()=>{var e;await y();const o=JSON.parse(JSON.stringify(a));if(o.dbtime=S(1,o.dbtime),u.operateType==="add"){const{data:s,error:r}=await ve([o]);if(r)return}else{const{data:s,error:r}=await fe([o]);if(r)return}(e=window.$message)==null||e.success(u.operateType==="add"?"添加成功":"修改成功"),x(),k("submitted")},N=pe(),_=async()=>{const{data:o,error:e}=await me({type:0});function s(r){return r.map(m=>{var f;return{label:m.chlName,value:m.chlName,children:(f=m.devicePojoList)!=null&&f.length?m.devicePojoList.map(g=>({label:g.devName,value:g.id})):[]}})}N.value=s(o)},A=(o,e)=>{o&&(a.devid=o,a.prename=e==null?void 0:e.label)},I={type:"string",required:!0,message:"不能为空",trigger:["input","blur"]},D={type:"number",required:!0,message:"不能为空",trigger:["input","blur"]},M={iname:I,ratpower:D,devid:D},V=ce(()=>({add:d("common.add"),edit:d("common.edit")})[u.operateType]);return(o,e)=>{const s=ge,r=je,m=be,f=Se,g=he,U=$e,C=q,c=Te,Z=ze,ee=Pe,te=ye,J=w,ae=q,ne=we;return $(),L(ne,{show:p.value,"onUpdate:show":e[14]||(e[14]=l=>p.value=l),title:V.value,preset:"card",class:"w-50%"},{footer:n(()=>[t(ae,{size:16,justify:"center"},{default:n(()=>[t(J,{onClick:x,class:"w-100px"},{default:n(()=>[b(T(i(d)("common.cancel")),1)]),_:1}),t(J,{type:"primary",class:"w-100px",onClick:B},{default:n(()=>[b(T(i(d)("common.confirm")),1)]),_:1})]),_:1})]),default:n(()=>[t(te,{ref_key:"formRef",ref:G,model:a,rules:M,"label-placement":"left","label-width":140,"require-mark-placement":"left"},{default:n(()=>[t(ee,{responsive:"screen","item-responsive":""},{default:n(()=>[t(r,{span:"24 m:12",label:"名称",path:"iname"},{default:n(()=>[t(s,{clearable:"",value:a.iname,"onUpdate:value":e[0]||(e[0]=l=>a.iname=l),placeholder:"请输入",maxlength:"64"},null,8,["value"])]),_:1}),t(r,{span:"24 m:12",label:"额定功率(kW)",path:"ratpower"},{default:n(()=>[t(m,{clearable:"",value:a.ratpower,"onUpdate:value":e[1]||(e[1]=l=>a.ratpower=l),placeholder:"请输入",precision:3,style:{width:"100%"}},null,8,["value"])]),_:1}),t(r,{span:"24 m:12",label:"所属设备",path:"devid"},{default:n(()=>[t(f,{value:a.devid,"onUpdate:value":[e[2]||(e[2]=l=>a.devid=l),A],placeholder:"请选择所属设备","expand-trigger":"click",options:N.value,"check-strategy":"child","show-path":!1},null,8,["value","options"])]),_:1}),t(r,{span:"24 m:12",label:"匹配前缀"},{label:n(()=>[t(g,{checked:a.pre,"onUpdate:checked":e[3]||(e[3]=l=>a.pre=l),"checked-value":0,"unchecked-value":1,class:"mr-5px"},null,8,["checked"]),Be]),default:n(()=>[t(s,{clearable:"",value:a.prename,"onUpdate:value":e[4]||(e[4]=l=>a.prename=l),maxlength:"16",disabled:a.pre==1,placeholder:"请输入匹配前缀"},null,8,["value","disabled"])]),_:1}),t(r,{span:"24 m:12",label:"型号",path:"model"},{default:n(()=>[t(s,{clearable:"",value:a.model,"onUpdate:value":e[5]||(e[5]=l=>a.model=l),placeholder:"请输入",maxlength:"64",style:{width:"100%"}},null,8,["value"])]),_:1}),t(r,{span:"24 m:12",label:"样板逆变器 ",path:"isrep"},{default:n(()=>[t(c,{value:a.isrep,"onUpdate:value":e[6]||(e[6]=l=>a.isrep=l),name:"radiogroup"},{default:n(()=>[t(C,null,{default:n(()=>[t(U,{label:i(d)("common.yesOrNo.yes"),value:1},null,8,["label"]),t(U,{label:i(d)("common.yesOrNo.no"),value:0},null,8,["label"])]),_:1})]),_:1},8,["value"])]),_:1}),t(r,{span:"24 m:12",label:"安装时间",path:"dbtime"},{default:n(()=>[t(Z,{"formatted-value":a.dbtime,"onUpdate:formattedValue":e[7]||(e[7]=l=>a.dbtime=l),"value-format":"yyyy-MM-dd",type:"date",style:{width:"100%"}},null,8,["formatted-value"])]),_:1}),t(r,{span:"24 m:12",label:"生产商",path:"manu"},{default:n(()=>[t(s,{clearable:"",value:a.manu,"onUpdate:value":e[8]||(e[8]=l=>a.manu=l),placeholder:"请输入",maxlength:"64",style:{width:"100%"}},null,8,["value"])]),_:1}),t(r,{span:"24 m:12",label:"箱式变压器",path:"transformer"},{default:n(()=>[t(s,{value:a.transformer,"onUpdate:value":e[9]||(e[9]=l=>a.transformer=l),placeholder:"请输入",precision:0,style:{width:"100%"}},null,8,["value"])]),_:1}),t(r,{span:"24 m:12",label:"集电线路",path:"collline"},{default:n(()=>[t(s,{clearable:"",value:a.collline,"onUpdate:value":e[10]||(e[10]=l=>a.collline=l),placeholder:"请输入",precision:0,style:{width:"100%"}},null,8,["value"])]),_:1}),t(r,{span:"24 m:12",label:"机组编号",path:"unum"},{default:n(()=>[t(s,{clearable:"",value:a.unum,"onUpdate:value":e[11]||(e[11]=l=>a.unum=l),placeholder:"请输入",precision:0,style:{width:"100%"}},null,8,["value"])]),_:1}),t(r,{span:"24 m:12",label:"光组型号",path:"pvmodule"},{default:n(()=>[t(s,{clearable:"",value:a.pvmodule,"onUpdate:value":e[12]||(e[12]=l=>a.pvmodule=l),placeholder:"请输入",precision:0,style:{width:"100%"}},null,8,["value"])]),_:1}),t(r,{span:"24 m:12",label:"光组个数",path:"pvcount"},{default:n(()=>[t(m,{clearable:"",value:a.pvcount,"onUpdate:value":e[13]||(e[13]=l=>a.pvcount=l),placeholder:"请输入",precision:0,style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title"])}}}),Me={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function X(v){return typeof v=="function"||Object.prototype.toString.call(v)==="[object Object]"&&!Ne(v)}const Ye=Y({name:"stationmanagement_inverterinformation",__name:"index",setup(v){const{columns:z,columnChecks:p,data:k,getData:u,loading:a,mobilePagination:h,searchParams:P,resetSearchParams:G}=Ue({apiFn:ke,apiParams:{page:1,pageSize:20,limit:20,fuzzy:null,_t:new Date().getTime()},immediate:!0,showTotal:!0,columns:()=>[{type:"selection",align:"center",width:48},{key:"iname",title:"名称",align:"center",width:140},{key:"model",title:"型号",align:"center",width:100},{key:"devName",title:"设备名称",align:"center",width:100},{key:"ratpower",title:"额定功率(MW)",align:"center",width:140},{key:"manu",title:"生产商",align:"center",width:140},{key:"dbtime",title:"安装时间",align:"center",width:140,render:o=>t("span",null,[S(0,o.dbtime)])},{key:"isrep",title:"样板逆变器",align:"center",width:100,render:o=>t("span",null,[o.isrep==1?"是":"否"])},{key:"transformer",title:"箱式变压器",align:"center",width:100},{key:"collline",title:"集电线路",align:"center",width:100},{key:"unum",title:"机组编号",align:"center",width:180},{key:"pvmodule",title:"光组型号",align:"center",width:100},{key:"pvcount",title:"光组数量",align:"center",width:100},{key:"operate",title:d("common.operate"),align:"center",width:200,fixed:"right",render:o=>{let e;return t("div",{class:"flex-center gap-8px"},[j(t(w,{type:"primary",ghost:!0,size:"small",onClick:()=>V(o.id)},X(e=d("common.edit"))?e:{default:()=>[e]}),[[R("no-auth"),"inverter:update"]]),j(t(Q,{onPositiveClick:()=>M(o.id)},{default:()=>d("common.confirmDelete"),trigger:()=>{let s;return t(w,{type:"error",ghost:!0,size:"small"},X(s=d("common.delete"))?s:{default:()=>[s]})}}),[[R("no-auth"),"inverter:delete"]])])}}]}),{drawerVisible:y,operateType:O,editingData:x,handleAdd:B,handleEdit:N,checkedRowKeys:_,onBatchDeleted:A,onDeleted:I}=Ce(k,u),D=async()=>{const o=_.value.join(","),{data:e,error:s}=await W({ids:o});s||(_.value=[])},M=async o=>{const{data:e,error:s}=await W({ids:o});s||I()},V=o=>{N(o)};return(o,e)=>{const s=q,r=ie,m=oe,f=le,g=Oe,U=De,C=R("no-auth");return $(),xe("div",Me,[t(U,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:n(()=>[t(s,{align:"center",wrap:"",justify:"start",class:"lt-sm:w-200px"},{default:n(()=>[b(" 逆变器设置 ")]),_:1})]),"header-extra":n(()=>[t(s,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:n(()=>[j(($(),L(i(w),{onClick:i(B),size:"small",ghost:"",type:"primary"},{icon:n(()=>[t(r,{class:H(["text-icon",{"animate-spin":i(a)}])},null,8,["class"])]),default:n(()=>[b(" "+T(i(d)("common.add")),1)]),_:1},8,["onClick"])),[[C,"inverter:insert"]]),j(($(),L(i(Q),{onPositiveClick:D},{trigger:n(()=>[t(i(w),{size:"small",ghost:"",type:"error",disabled:i(_).length==0},{icon:n(()=>[t(m,{class:H(["text-icon",{"animate-spin":i(a)}])},null,8,["class"])]),default:n(()=>[b(" "+T(i(d)("common.batchDelete")),1)]),_:1},8,["disabled"])]),default:n(()=>[b(" 确认删除选中的项吗？ ")]),_:1})),[[C,"inverter:delete"]]),t(f,{columns:i(p),"onUpdate:columns":e[0]||(e[0]=c=>F(p)?p.value=c:null)},null,8,["columns"])]),_:1})]),default:n(()=>[t(g,{"checked-row-keys":i(_),"onUpdate:checkedRowKeys":e[1]||(e[1]=c=>F(_)?_.value=c:null),columns:i(z),data:i(k),size:"small",loading:i(a),remote:"","row-key":c=>c.id,pagination:i(h),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","loading","row-key","pagination"]),t(Ie,{visible:i(y),"onUpdate:visible":e[2]||(e[2]=c=>F(y)?y.value=c:null),onSubmitted:i(u),"operate-type":i(O),"row-data":i(x),Pagination:i(h)},null,8,["visible","onSubmitted","operate-type","row-data","Pagination"])]),_:1})])}}});export{Ye as default};

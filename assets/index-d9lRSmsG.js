import{_ as I}from"./table-column-setting.vue_vue_type_script_setup_true_lang-DOAdG1kn.js";import{_ as q}from"./export-DypquEvk.js";import{_ as V}from"./round-search-BOCawFnh.js";import{d as W,j as v,v as j,e9 as G,aV as m,g as n,o as R,e as A,w as i,i as l,B as w,aa as H,h as S,t as k,$ as D,al as x,bA as K,L,K as Q,a1 as J,O as X}from"./index-CqzOHcIS.js";import{u as Y,a as Z}from"./table-rbqxuxT2.js";import{e as tt}from"./exportExcel-Bv4G4H50.js";import{_ as et}from"./DatePicker-O1E_UvUw.js";import{_ as nt}from"./FormItemGridItem-BivQWFD-.js";import{_ as at}from"./Grid--OF1Knvj.js";import{_ as ot}from"./DataTable-BdHa8wrw.js";import"./TimePicker-DG80wuP4.js";import"./Forward-DTSMmYEU.js";import"./RadioGroup-DbJqgTyK.js";const lt={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},it=W({name:"realtimequery_sitehistoryquery",__name:"index",setup(st){const a=v(),b=async()=>{const{data:t,error:e}=await K();e||(a.value=t)};j(()=>{b(),p.value.forEach(t=>{typeof t.title=="function"&&(t.title=t.title().children[0])})});const{columns:h,columnChecks:p,data:d,getData:_,loading:g,mobilePagination:C,searchParams:f,resetSearchParams:rt}=Y({apiFn:G,apiParams:{page:1,limit:20,pageSize:20,startTime:m(1,Date.now()-864e5*3)||null,endTime:m(1,Date.now())||null,_t:new Date().getTime()},immediate:!0,showTotal:!0,columns:()=>[{type:"selection",width:50},{key:"dbtime",title:"更新时间",align:"center",width:160},{key:"stationP",title:()=>{var t;return n("span",null,[`总有功功率${(t=a.value)!=null&&t.StationP?"("+a.value.StationP+")":"(MW)"}`])},align:"center",width:120},{key:"stationQ",title:()=>{var t;return n("span",null,[`总无功功率${(t=a.value)!=null&&t.StationQ?"("+a.value.StationQ+")":"(MW)"}`])},align:"center",width:120},{key:"stationS",title:()=>{var t;return n("span",null,[`总视在功率${(t=a.value)!=null&&t.StationS?"("+a.value.StationS+")":"(MW)"}`])},align:"center",width:120},{key:"stationCOS",title:()=>{var t,e;return n("span",null,[`总功率因数${((t=a.value)==null?void 0:t.StationCOS)=="-"?"":"("+((e=a.value)==null?void 0:e.StationCOS)+")"}`])},align:"center",width:120},{key:"stationU",title:()=>{var t,e;return n("span",null,[`总电压${(t=a.value)!=null&&t.StationI?"("+((e=a.value)==null?void 0:e.StationU)+")":"(MV)"}`])},align:"center",width:120},{key:"stationI",title:()=>{var t,e;return n("span",null,[`总电流${(t=a.value)!=null&&t.StationI?"("+((e=a.value)==null?void 0:e.StationI)+")":"(A)"}`])},align:"center",width:120},{key:"stationFreq",title:()=>{var t;return n("span",null,[`频率${(t=a.value)!=null&&t.StationFreq?"("+a.value.StationFreq+")":"(Hz)"}`])},align:"center",width:100},{key:"stationDayE",title:()=>{var t;return n("span",null,[`日发电量${(t=a.value)!=null&&t.StationDayE?"("+a.value.StationDayE+")":"(MWh)"}`])},align:"center",width:120},{key:"stationTotalE",title:()=>{var t;return n("span",null,[`总发电量${(t=a.value)!=null&&t.StationTotalE?"("+a.value.StationTotalE+")":"(MWh)"}`])},align:"center",width:140},{key:"stationControlled",title:"是否限电",align:"center",width:140,render:t=>n("span",null,[t.stationControlled?t.stationControlled==1?"是":"否":""])}]}),{drawerVisible:ct,operateType:ut,editingData:pt,handleAdd:dt,handleEdit:mt,checkedRowKeys:u,onBatchDeleted:_t,onDeleted:ft}=Z(d,_),T=()=>{_()},y=v([Date.now()-864e5*3,Date.now()]);async function $(t,e){f.startTime=m(1,e[0]),f.endTime=m(1,e[1]),_()}const E=()=>{const t={};h.value.forEach(o=>{o.key!="index"&&o.key!="operation"&&o.type!=="selection"&&(t[o.key]=typeof o.title=="string"?o.title:o.title().children[0])});const e=[];d.value.forEach(o=>{if(u.value.includes(o.id)){const r=JSON.parse(JSON.stringify(t));for(const s in r)o.hasOwnProperty(s)?s=="stationControlled"?r[s]=o[s]==1?"是":"否":r[s]=o[s]:r[s]="";e.push(r)}}),tt(e,t,"站点历史数据")},N={近一天:[Date.now()-864e5*1,Date.now()],近三天:[Date.now()-864e5*3,Date.now()],近七天:[Date.now()-864e5*7,Date.now()]};return(t,e)=>{const o=et,r=V,s=nt,M=at,O=L,P=q,U=I,B=Q,z=ot,F=J;return R(),A("div",lt,[n(F,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:i(()=>[n(O,{ref:"formRef",model:l(f),"label-placement":"left","show-feedback":!1},{default:i(()=>[n(M,{"y-gap":16,responsive:"screen","item-responsive":""},{default:i(()=>[n(s,{span:"24 s:12 m:12",label:"起止时间",path:"startTime"},{default:i(()=>[n(o,{value:y.value,"onUpdate:value":e[0]||(e[0]=c=>y.value=c),type:"datetimerange","value-format":"yyyy-MM-dd hh:mm:ss","onUpdate:formattedValue":$,shortcuts:N,"default-time":["00:00:00","23:59:59"]},null,8,["value"]),n(l(w),{type:"primary",ghost:"",onClick:T,class:"ml-20px"},{icon:i(()=>[n(r,{class:H(["text-icon",{"animate-spin":l(g)}])},null,8,["class"])]),default:i(()=>[S(" "+k(l(D)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),"header-extra":i(()=>[n(B,{justify:"end",class:"lt-sm:w-200px"},{default:i(()=>[n(l(w),{onClick:E,size:"small",disabled:l(u).length==0},{icon:i(()=>[n(P,{class:"text-icon"})]),default:i(()=>[S(" "+k(l(D)("common.export")),1)]),_:1},8,["disabled"]),n(U,{columns:l(p),"onUpdate:columns":e[1]||(e[1]=c=>x(p)?p.value=c:null)},null,8,["columns"])]),_:1})]),default:i(()=>[n(z,{"checked-row-keys":l(u),"onUpdate:checkedRowKeys":e[2]||(e[2]=c=>x(u)?u.value=c:null),columns:l(h),data:l(d),size:"small",loading:l(g),remote:"","row-key":c=>c.id,pagination:l(d).length?l(C):void 0,class:"sm:h-full","flex-height":!0,"scroll-x":""},null,8,["checked-row-keys","columns","data","loading","row-key","pagination"])]),_:1})])}}}),Et=X(it,[["__scopeId","data-v-1e450e1f"]]);export{Et as default};

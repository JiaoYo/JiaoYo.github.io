import{_ as O}from"./export-CXWoj5Fq.js";import{e as Q}from"./exportExcel-DNhOb6yd.js";import{d as X,s,D as Y,aU as N,i as Z,b as z,o as i,f as a,w as l,e as C,J as ee,N as te,aM as ae,h as ne,c as p,G as S,aI as oe,aA as le,b1 as se,B as re,g as f,t as D,aD as ue,en as ie,a2 as ce,fu as pe,aG as de,aF as j,b9 as me,W as ge}from"./index-CMHgEXMh.js";import{u as _e}from"./usePageData-Dn3H-SiY.js";import{_ as fe}from"./RadioButton-V32cT3aM.js";import{_ as ve}from"./DatePicker-BXJxaIxz.js";const ye={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},he={style:{"margin-top":"20px"}},be={style:{"margin-top":"20px",display:"flex","justify-content":"flex-end"}},xe=X({name:"reportmanagement_debug",__name:"index",setup(ke){const r=s("year"),U=s([{label:"月",value:"month"},{label:"年",value:"year"}]),B=s([{label:"1 每页",value:1},{label:"50 每页",value:50},{label:"100 每页",value:100},{label:"500 每页",value:500}]),c=s(1),m=s(500),v=s(0),o=Y({monthTime:String(N(3,null)),yearTime:String(N(4,null)),creater:null}),P=e=>{r.value=e,c.value=1,u()},d=s([]),u=async()=>{let e={page:c.value,limit:m.value,dates:r.value=="month"?o.monthTime:o.yearTime};o.creater&&(e.userid=o.creater);const{data:t}=await pe(e);d.value=t.list,v.value=Number(t.total)},{pageData:g,getData:I,nextPage:V}=_e(me),L=async e=>{const t=e.currentTarget,_=t.scrollTop;t.scrollTop+t.offsetHeight>=t.scrollHeight&&g.data.length<g.total&&(await V(),await de(),setTimeout(()=>{t.scrollTop=_}))},F=s(1),G=async e=>{o.creater=e,e||setTimeout(()=>{F.value++},500),u()};async function y(e){c.value=1,u()}Z(()=>{I({usertypes:"2,3"}),u()});const H=[{key:"proname",title:"项目名称",align:"center",render(e){return a("div",{class:" "},[a("span",null,[e.proname||"未知"])])}},{key:"progess",title:"项目进度",align:"center",width:140,sorter:(e,t)=>e.progess-t.progess,render:e=>a(j,{type:"line",showIndicator:!0,percentage:e.progess,"indicator-placement":"inside",processing:!0,color:"#1890ff"},null)},{key:"projectdebugcount",title:"项目调试任务数",align:"center",sorter:(e,t)=>e.projectdebugcount-t.projectdebugcount,width:180},{key:"debugcount",title:"调试数量",align:"center",sorter:(e,t)=>e.debugcount-t.debugcount,width:180},{key:"debugpercent",title:"调试占比",align:"center",width:180,render(e){return a("div",{style:{}},[e.debugpercent])}}],M=[{key:"proname",title:"项目名称",align:"center",render(e){return a("div",{class:" "},[a("span",null,[e.proname||"未知"])])}},{key:"progess",title:"项目进度",align:"center",width:140,sorter:(e,t)=>e.progess-t.progess,render:e=>a(j,{type:"line",showIndicator:!0,percentage:e.progess,"indicator-placement":"inside",processing:!0,color:"#1890ff"},null)},{key:"projectdebugcount",title:"项目调试任务数",align:"center",sorter:(e,t)=>e.projectdebugcount-t.projectdebugcount,width:180},{key:"userstat",title:"调试占比",align:"center",render(e){return a("div",{style:{whiteSpace:"pre-line"}},[e.userstat?e.userstat.replaceAll("，",`
`):""])}}],R=e=>{u()},$=e=>{c.value=1,u()},h=s(window.innerHeight-325),q=()=>{Q(d.value,o.creater?{proname:"项目名称",projectdebugcount:"项目调试任务数",debugcount:"调试数量",debugpercent:"调试占比"}:{proname:"项目名称",projectdebugcount:"项目调试任务数",userstat:"调试占比"},`调试报表_${r.value=="month"?o.monthTime:o.yearTime}`)};return(e,t)=>{const _=ae,b=te,A=fe,E=oe,x=ve,k=ee,w=re,J=O,T=ue,W=ie,K=ce;return i(),z("div",ye,[a(K,{bordered:"",style:{height:"100%"}},{default:l(()=>[a(k,{align:"center"},{default:l(()=>[a(b,{label:"用户",path:"creater","label-placement":"left","show-feedback":!1},{default:l(()=>[a(_,{clearable:"",filterable:"",value:o.creater,"onUpdate:value":[t[0]||(t[0]=n=>o.creater=n),G],placeholder:"请选择","label-field":"username",size:"small","value-field":"id",options:ne(g).data,onScroll:L},null,8,["value","options"])]),_:1}),a(b,{label:"查询日期","label-placement":"left","show-feedback":!1},{default:l(()=>[a(k,null,{default:l(()=>[a(E,{value:r.value,"onUpdate:value":[t[1]||(t[1]=n=>r.value=n),P],size:"small"},{default:l(()=>[(i(!0),z(le,null,se(U.value,n=>(i(),p(A,{key:n.value,value:n.value,label:n.label},null,8,["value","label"]))),128))]),_:1},8,["value"]),r.value==="year"?(i(),p(x,{key:0,size:"small","formatted-value":o.yearTime,"onUpdate:formattedValue":[t[2]||(t[2]=n=>o.yearTime=n),y],type:"year","value-format":"yyyy",style:{width:"120px"}},null,8,["formatted-value"])):S("",!0),r.value=="month"?(i(),p(x,{key:1,size:"small","formatted-value":o.monthTime,"onUpdate:formattedValue":[t[3]||(t[3]=n=>o.monthTime=n),y],type:"month","value-format":"yyyy-MM",style:{width:"120px"}},null,8,["formatted-value"])):S("",!0)]),_:1}),a(w,{type:"primary",size:"small",ghost:"",style:{"margin-left":"20px"},onClick:u},{default:l(()=>t[6]||(t[6]=[f("查询")])),_:1,__:[6]}),a(w,{style:{"margin-left":"20px"},size:"small",onClick:q},{icon:l(()=>[a(J,{class:"text-icon"})]),default:l(()=>[t[7]||(t[7]=f(" "+D("导出")))]),_:1,__:[7]})]),_:1})]),_:1}),C("div",he,[o.creater?(i(),p(T,{key:0,columns:H,data:d.value,"max-height":h.value},null,8,["data","max-height"])):(i(),p(T,{key:1,columns:M,data:d.value,"max-height":h.value},null,8,["data","max-height"]))]),C("div",be,[a(W,{page:c.value,"onUpdate:page":[t[4]||(t[4]=n=>c.value=n),R],"page-size":m.value,"onUpdate:pageSize":[t[5]||(t[5]=n=>m.value=n),$],"item-count":v.value,"show-size-picker":"","show-quick-jumper":"","page-sizes":B.value},{prefix:l(({itemCount:n})=>[f(" 共 "+D(n)+" 项 ",1)]),_:1},8,["page","page-size","item-count","page-sizes"])])]),_:1})])}}}),De=ge(xe,[["__scopeId","data-v-5122f2dc"]]);export{De as default};

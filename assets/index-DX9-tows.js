import{_ as Yl}from"./table-column-setting.vue_vue_type_script_setup_true_lang-C1xlHjp4.js";import{_ as Zl,F as et}from"./FileSaver.min-DH-JAza2.js";import{_ as lt}from"./round-delete-DlIoPaUp.js";import{_ as tt}from"./round-search-C1L9tT6c.js";import{d as Pe,s as z,z as at,D as K,aL as _e,i as nt,b as st,o as F,f as t,w as n,M as it,h as s,c as T,G as E,aM as L,H as I,J as rt,B as v,g as p,t as U,a2 as ot,aD as ut,aO as sl,e as il,aC as dt,aF as ct,$ as C,a4 as pt,N as ft,aI as mt,aH as vt,aE as gt,aG as ee,aU as rl,aK as ol,n as i,a5 as q,_ as y,I as S,aA as ul,aS as ke,F as D,aT as dl,aJ as Re,ax as yt,aR as ht,aV as xt,W as bt}from"./index-CMHgEXMh.js";import{x as oe}from"./xlsx.min-DW-mI4dd.js";import{l as zt,g as Ce,d as _t,e as kt,i as Ct,m as wt,j as Ft,n as Lt}from"./aftersale-BYFUx93N.js";import{u as Ut,a as St}from"./table-CJiCbcco.js";import{h as cl}from"./permission-BKFCtFdB.js";import{u as qe}from"./usePageData-Dn3H-SiY.js";import{_ as Dt}from"./Grid-C5178DSn.js";import{_ as jt}from"./FormItemGridItem-Dqi8bF12.js";import{_ as Bt}from"./DatePicker-BXJxaIxz.js";import{N as $t}from"./Popconfirm-B5UVwpKW.js";const Tt={class:"gap-16px overflow-auto lt-sm:overflow-auto"};function Nt(ue){return typeof ue=="function"||Object.prototype.toString.call(ue)==="[object Object]"&&!xt(ue)}const It=Pe({name:"aftersales_aftersalesdevice",__name:"index",setup(ue){const we=z(!1),de=z(0),Ge=z([]),ce=at(),pe=K([{label:"质保维修返回",value:0},{label:"整体置换返回",value:1},{label:"报废",value:2},{label:"付费维修返回",value:3},{label:"原件返回",value:4},{label:"其他",value:9}]),pl={当日:()=>{const e=new Date().getTime();return[e,e]},本周:()=>{const e=new Date().getTime();return[e-24*60*60*1e3*7,e]},上月:()=>{const e=new Date().getTime();return[e-24*60*60*1e3*30,e]},近一年:()=>{const e=new Date().getTime();return[e-24*60*60*1e3*365,e]},近三年:()=>{const e=new Date().getTime();return[e-24*60*60*1e3*365*3,e]}},G=z([]),{pageData:O,getData:fe,nextPage:fl}=qe(Ct),Oe=async e=>{const l=e.currentTarget,o=l.scrollTop;l.scrollTop+l.offsetHeight>=l.scrollHeight&&O.data.length<O.total&&(await fl(),G.value=O.data,await ee(),setTimeout(()=>{l.scrollTop=o}))},ml=async()=>{await fe({page:1,limit:100,_t:new Date().getTime()}),G.value=O.data},H=z([]),{pageData:Q,getData:Fe,nextPage:vl}=qe(wt),gl=async()=>{await Fe(),H.value=Q.data.map(e=>({label:e,value:e}))},Le=async e=>{const l=e.currentTarget,o=l.scrollTop;l.scrollTop+l.offsetHeight>=l.scrollHeight&&Q.data.length<Q.total&&(await vl(),await ee(),H.value=Q.data.map(d=>({label:d,value:d})),setTimeout(()=>{l.scrollTop=o}))},yl=_e.debounce(async e=>{await Fe({fuzzy:e,page:1}),H.value=Q.data.map(l=>({label:l,value:l}))},300),Ue=e=>{if(c.gws=null,X.value=!0,ve.value=!1,!e){me();return}yl(e)},me=()=>{c.gws=null},Se=_e.debounce(e=>{var l;c.gws1=e||void 0,c.gws=((l=c.gws1)==null?void 0:l.join(","))||void 0,x()},300),le=async()=>{X.value&&!ve.value&&(await Fe({page:1}),H.value=Q.data.map(e=>({label:e,value:e})),X.value=!1)},hl=_e.debounce(async e=>{await fe({fuzzy:e,page:1}),G.value=O.data},300),X=z(!1),ve=z(!1),He=e=>{if(c.cid=null,X.value=!0,ve.value=!1,!e){De();return}hl(e)},Me=async()=>{X.value&&!ve.value&&(await fe({page:1}),G.value=O.data,X.value=!1)},De=async()=>{await fe({page:1}),G.value=O.data},We=async e=>{c.cid=e,x()};async function xl(e,l){if(!e){c.startTime=void 0,c.endTime=void 0,x();return}c.startTime=String(rl(1,l[0])),c.endTime=String(rl(1,l[1])),x()}const je=()=>{c.sn=null,x()},Be=_e.debounce(e=>{c.sn=e||void 0,x()},300);nt(async()=>{ce.userInfo.usertype!==7&&await ml(),await x(),await gl()});const P=Pe({props:{value:[String,Number],onUpdateValue:Function,row:Object},setup(e){const l=z(!1),o=z(null),d=z(null),h=z(String(e.value)),f=z(!1),a=()=>{ee(()=>{const b=d.value;b&&(f.value=b.scrollHeight>b.clientHeight)})};yt(()=>e.value,()=>a(),{immediate:!0});const m=()=>{h.value=String(e.value??""),l.value=!0,ee(()=>{var b;return(b=o.value)==null?void 0:b.focus()})},_=()=>{var b;h.value!==String(e.value??"")&&((b=e.onUpdateValue)==null||b.call(e,h.value)),l.value=!1};return()=>{if(l.value)return i(I,{ref:o,value:h.value,type:"textarea",rows:2,autofocus:!0,onUpdateValue:B=>h.value=B,onBlur:_});const b=i("div",{ref:d,class:"flex items-center justify-center whitespace-break-spaces",style:{minHeight:"30px",cursor:"pointer",minWidth:"60px",width:"100%",display:"-webkit-box",overflow:"hidden",textOverflow:"ellipsis",WebkitBoxOrient:"vertical",WebkitLineClamp:3},onClick:m},e.value||"--");return f.value?i(ke,{trigger:"hover",style:{maxWidth:"500px"}},{trigger:()=>b,default:()=>e.value||"--"}):b}}}),Je=Pe({props:{value:[String,Number],options:{type:Array,required:!0},onUpdateValue:Function},setup(e){const l=z(!1),o=z(null),d=z(e.value),h=()=>{d.value=e.value,l.value=!0,ee(()=>{var a,m;(m=(a=o.value)==null?void 0:a.focus)==null||m.call(a)})},f=a=>{var m;d.value=a,(a!==void 0||a!==null)&&a!==e.value&&((m=e.onUpdateValue)==null||m.call(e,a)),l.value=!1};return()=>{var a,m;return i("div",{style:"height:100%;cursor:pointer;width:100%",class:"flex items-center justify-center",onClick:h},l.value?i(L,{ref:o,value:d.value,options:e.options,size:"small",style:"width:150px","onUpdate:value":f,placeholder:"请选择",onBlur:()=>l.value=!1}):(m=(a=e.options)==null?void 0:a.find(_=>_.value==e.value))!=null&&m.label?t(ht,{type:"info"},{default:()=>{var _,b;return[(b=(_=e.options)==null?void 0:_.find(B=>B.value==e.value))==null?void 0:b.label]}}):"--")}}}),Y=z(!1),k=K({id:[],type:"",password:""});async function bl(e){k.id=[e],k.type="deleteComp",k.password="",Y.value=!0}async function zl(){k.id=W.value,k.type="deleteComp",k.password="",Y.value=!0}function _l(){Y.value=!1,k.id=[],k.type="",k.password=""}async function kl(){var o,d;if(!k.password){(o=window.$message)==null||o.destroyAll(),(d=window.$message)==null||d.error("请输入密码");return}const{data:e,error:l}=await zt(k.id,k.password);l||(Y.value=!1,k.id=[],k.type="",k.password="",Pl(),c.page=1,x())}const N=async(e,l,o)=>{var f;const{data:d,error:h}=await Ce([{id:e.id,[o]:l}]);h||((f=window.$message)==null||f.success("设置成功"),x())},ge=z(!1),g=K({id:0,type:"",value:"",accessory:"",raccessory:""});function ye(e,l,o){g.id=e,o=="rdetails"?(g.value=l.rdetails,g.raccessory=l.raccessory):o=="details"?(g.value=l.details,g.accessory=l.accessory):g.value=l,g.type=o,ge.value=!0}const Cl=e=>{window.open(e,"_blank")};function Ke(){ge.value=!1,g.id=0,g.value="",g.type=""}async function wl(){var m,_,b,B,J,$,Z;if(!g.value){(m=window.$message)==null||m.destroyAll(),(_=window.$message)==null||_.error("请选择类型");return}if(g.value==1&&g.type=="details"&&!g.accessory){(b=window.$message)==null||b.destroyAll(),(B=window.$message)==null||B.error("请输入配件详情");return}if(g.value==1&&g.type=="rdetails"&&!g.raccessory){(J=window.$message)==null||J.destroyAll(),($=window.$message)==null||$.error("请输入配件详情");return}const{id:e,value:l,type:o,accessory:d,raccessory:h}=g,{data:f,error:a}=await Ce([{id:e,[o]:l,accessory:o=="details"&&l==1?d:void 0,raccessory:o=="rdetails"&&l==1?h:void 0}]);a||(Ke(),(Z=window.$message)==null||Z.success("设置成功"),x())}const{pageData:V,getData:M,nextPage:Fl}=qe(Ft),he=async e=>{const l=e.currentTarget,o=l.scrollTop;l.scrollTop+l.offsetHeight>=l.scrollHeight&&V.data.length<V.total&&(await Fl(),await ee(),setTimeout(()=>{l.scrollTop=o}))};M();const Qe=async()=>{await M({page:1}),Xe()},Ll=async e=>{if(!e){Qe();return}Ul.value=e,await M({fuzzy:e,page:1}),Xe()},te=K(new Map),Ul=z("");function Xe(){const e=[];V.data.forEach(l=>{te.has(l.id)||e.push(l)}),te.forEach(l=>{e.push(l)}),V.data=e}const Ye=e=>{V.data.forEach(l=>{e.includes(l.id)&&te.set(l.id,l)}),Array.from(te.keys()).forEach(l=>{e.includes(l)||te.delete(l)})},$e=e=>{c.reid=e,x()},Te=async()=>{await M({page:1}),c.reid=null,x()},Ne=e=>{if(!e){M({page:1});return}M({fuzzy:e,page:1})},Ze=e=>{c.conc=e,x()},el=async()=>{c.conc=null,x()},Sl=async()=>{c.pending=null,x()},Dl=e=>{c.pending=e==1?1:void 0,x()},jl=e=>{c.conc=e.conc,c.page=1,x()},xe=z(!1),w=K({id:0,reidList:[],copyList:[]}),Bl=async e=>{await M(),xe.value=!0,w.id=e.id,w.reidList=e.list.map(l=>l.reid),w.copyList=JSON.parse(JSON.stringify(e.list)),Ye(w.reidList)},ll=()=>{xe.value=!1,w.id=0,w.reidList=[]},ae=z(!1),$l=async()=>{var e;if(!ae.value)try{const l=w.reidList||[],o=w.copyList.map(f=>f.reid)||[],d=l.filter(f=>!o.includes(f)),h=o.filter(f=>!l.includes(f)).map(f=>{var a;return(a=w.copyList.find(m=>m.reid===f))==null?void 0:a.id}).filter(Boolean);if(ae.value=!0,d.length>0){const{data:f,error:a}=await _t(d.map(m=>({afid:w.id,reid:m})))}if(h.length>0){const{data:f,error:a}=await kt({arrIds:h.join(",")})}(e=window.$message)==null||e.success("设置成功"),ll(),x()}catch{}finally{ae.value=!1}},{columns:tl,columnChecks:Ie,data:Ve,getData:x,loading:Tl,mobilePagination:Nl,searchParams:c}=Ut({showTotal:!0,immediate:!1,apiFn:Lt,apiParams:{page:1,pageSize:20,limit:20,cid:null,gws:void 0,gws1:[],sn:null,reid:null,conc:null,pending:null,dbtime:null,startAndTimeRange:null,startTime:null,endTime:null,_t:new Date().getTime()},columns:()=>ce.userInfo.usertype!=7?[{type:"selection",align:"center",width:48,fixed:"left",resizable:!0},{key:"comp",width:160,fixed:"left",resizable:!0,titleName:"公司名称",title:()=>i("div",{class:"flex items-center justify-center gap-6px"},[i("span",null,"公司名称"),i(q,{trigger:"click",placement:"bottom"},{trigger:()=>i("span",{class:"cursor-pointer text-primary hover:opacity-80"},t(y,{"local-icon":"search",class:"font-size-18px ml-5px"},null)),default:()=>i("div",{class:"flex items-center gap-4px p-6px"},[i(L,{size:"small",placeholder:"请选择公司名称",value:c.cid,style:"width:200px",clearable:!0,filterable:!0,labelField:"comp",valueField:"id",options:G.value,onSearch:He,onBlur:Me,onScroll:Oe,onClear:De,onUpdateValue:We}),i(v,{size:"small",type:"primary",onClick:x},{default:()=>"搜索"})])})]),render(e){return e.comp}},{key:"project",width:160,title:"项目名称",resizable:!0},{titleName:"网关编号",title:()=>i("div",{class:"flex items-center justify-center gap-6px"},[i("span",null,"网关编号"),i(q,{trigger:"click",placement:"bottom"},{trigger:()=>i("span",{class:"cursor-pointer text-primary hover:opacity-80"},t(y,{"local-icon":"search",class:"font-size-18px ml-5px"},null)),default:()=>i("div",{class:"flex items-center gap-4px p-6px"},[i(I,{size:"small",placeholder:"输入网关编号",value:c.sn,style:"width:160px",clearable:!0,onClear:je,onUpdateValue:Be}),i(v,{size:"small",type:"primary",onClick:x},{default:()=>"搜索"})])})]),key:"sn",align:"center",width:180,fixed:"left",resizable:!0},{titleName:"网关型号",title:()=>i("div",{class:"flex items-center justify-center gap-6px"},[i("span",null,"网关型号"),i(q,{trigger:"click",placement:"bottom"},{trigger:()=>i("span",{class:"cursor-pointer text-primary hover:opacity-80"},t(y,{"local-icon":"search",class:"font-size-18px ml-5px"},null)),default:()=>i("div",{class:"flex items-center gap-4px p-6px"},[i(L,{size:"small",placeholder:"请选择网关型号",value:c.gws1,style:"width:200px",clearable:!0,filterable:!0,multiple:!0,options:H.value,onSearch:Ue,onBlur:le,onScroll:Le,onClear:me,onUpdateValue:Se}),i(v,{size:"small",type:"primary",onClick:x},{default:()=>"搜索"})])})]),align:"center",key:"model",width:120,resizable:!0},{title:()=>t("div",{class:"flex items-center justify-center"},[t("div",null,[p("是否推送厂家")]),t(y,{"local-icon":"edit",class:"font-size-16px ml-5px"},null)]),align:"center",key:"manu",width:200,resizable:!0,render(e){return e.id&&i(Je,{value:e.manu??0,options:[{value:0,label:"否"},{value:1,label:"是"}],onUpdateValue(l){N(e,l,"manu")}})}},{title:()=>t("div",{class:"flex items-center justify-center"},[t("div",null,[p("寄回类型")]),t(y,{"local-icon":"edit",class:"font-size-16px ml-5px"},null)]),align:"center",key:"details",width:200,resizable:!0,render:e=>t("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-around"}},[e.details==0||e.details==1?t(ul,null,[t("div",{class:"w-full",title:`${e.details}`},[t("div",null,[p("类型："),e.details==0?"裸机":"包含配件"]),e.details==1&&t("div",null,[p("配件详情："),e.accessory])]),t(ke,{trigger:"hover",placement:"right"},{trigger:()=>S(t(v,{text:!0,type:"primary",onClick:()=>ye(e.id,e,"details")},{default:()=>[t(y,{"local-icon":"edit",class:"font-size-26px ml-5px c-#000"},null)]}),[[D("no-auth"),"aftermarket:update:permission.do"]]),default:()=>C("common.update")})]):e.id&&S(t(v,{text:!0,type:"primary",size:"small",onClick:()=>ye(e.id,"","details")},{default:()=>[p("填写")]}),[[D("no-auth"),"aftermarket:update:permission.do"]])])},{key:"devre1",title:()=>t("div",{class:"flex items-center justify-center"},[t("div",null,[p("现场照片")]),t(y,{"local-icon":"edit",class:"font-size-16px ml-5px"},null)]),align:"center",width:300,resizable:!0,render:e=>t("div",{class:"flex items-center justify-center gap-4px"},[e.devre1||e.devre2||e.devre3?t(dl,{value:e.devre1&&e.devre2&&e.devre3?3:e.devre1&&e.devre2?2:void 0,color:"#1890ff"},{default:()=>[t("div",{style:{cursor:"pointer"},onClick:()=>Ae([e.devre1,e.devre2,e.devre3].filter(l=>l),0)},[t(Re,{width:70,src:e.devre1||e.devre2||e.devre3,previewDisabled:!0,style:{maxHeight:"70px",cursor:"pointer"}},null)])]}):null,e.id&&t("div",null,[!e.devre1&&!e.devre2&&!e.devre3&&e.id&&S(t(v,{text:!0,size:"small",type:"primary",onClick:()=>R(e,"sceneImg")},{default:()=>[t(y,{"local-icon":"upload",class:"font-size-26px ml-5px c-#000"},null)]}),[[D("no-auth"),"aftermarket:update:permission.do"]]),(e.devre1||e.devre2||e.devre3)&&S(t(v,{text:!0,size:"small",type:"primary",onClick:()=>R(e,"sceneImg"),style:{marginLeft:"5px"}},{default:()=>[t(y,{"local-icon":"edit",class:"font-size-26px ml-5px c-#000"},null)]}),[[D("no-auth"),"aftermarket:update:permission.do"]])])])},{key:"devre4",title:()=>t("div",{class:"flex items-center justify-center"},[t("div",null,[p("现场视频")]),t(y,{"local-icon":"edit",class:"font-size-16px ml-5px"},null)]),align:"center",width:300,resizable:!0,render:e=>t("div",{class:"flex items-center justify-center gap-4px"},[e.devre4?t("video",{src:e.devre4,style:{height:"70px",width:"100%",cursor:"pointer",objectFit:"cover"},onClick:()=>Cl(e.devre4)},null):null,t("div",null,[!e.devre4&&e.id&&S(t(v,{text:!0,size:"small",type:"primary",onClick:()=>R(e,"video")},{default:()=>[t(y,{"local-icon":"upload",class:"font-size-26px ml-5px c-#000"},null)]}),[[D("no-auth"),"aftermarket:update:permission.do"]]),e.devre4&&S(t(v,{text:!0,size:"small",type:"primary",onClick:()=>R(e,"video"),style:{marginLeft:"5px"}},{default:()=>[t(y,{"local-icon":"edit",class:"font-size-26px ml-5px c-#000"},null)]}),[[D("no-auth"),"aftermarket:update:permission.do"]])])])},{key:"devre5",title:()=>t("div",{class:"flex items-center justify-center"},[t("div",null,[p("分析照片")]),t(y,{"local-icon":"edit",class:"font-size-16px ml-5px"},null)]),align:"center",width:300,resizable:!0,render:e=>t("div",{class:"flex items-center justify-center gap-4px"},[e.devre5||e.devre6||e.devre7?t(dl,{value:e.devre5&&e.devre6&&e.devre7?3:e.devre5&&e.devre6?2:void 0,color:"#1890ff"},{default:()=>[t("div",{style:{cursor:"pointer"},onClick:()=>Ae([e.devre5,e.devre6,e.devre7].filter(l=>l),0)},[t(Re,{width:70,src:e.devre5||e.devre6||e.devre7,previewDisabled:!0,style:{maxHeight:"70px",cursor:"pointer"}},null)])]}):null,t("div",null,[!e.devre5&&!e.devre6&&!e.devre7&&e.id&&S(t(v,{size:"small",text:!0,type:"primary",onClick:()=>R(e,"analyze")},{default:()=>[t(y,{"local-icon":"upload",class:"font-size-26px ml-5px c-#000"},null)]}),[[D("no-auth"),"aftermarket:update:permission.do"]]),(e.devre5||e.devre6||e.devre7)&&S(t(v,{size:"small",text:!0,type:"primary",onClick:()=>R(e,"analyze"),style:{marginLeft:"5px"}},{default:()=>[t(y,{"local-icon":"edit",class:"font-size-26px ml-5px c-#000"},null)]}),[[D("no-auth"),"aftermarket:update:permission.do"]])])])},{title:()=>t("div",{class:"flex items-center justify-center"},[t("div",null,[p("网关二维码")]),t(y,{"local-icon":"edit",class:"font-size-16px ml-5px"},null)]),align:"center",key:"qrcode",width:300,resizable:!0,ellipsis:{tooltip:!0},render:e=>t("div",{class:"flex items-center justify-center gap-4px"},[e.qrcode?t("div",{style:{cursor:"pointer"},onClick:()=>Ae([e.qrcode].filter(l=>l),0)},[t(Re,{width:70,src:e.qrcode,previewDisabled:!0,style:{maxHeight:"70px",cursor:"pointer"}},null)]):null,t("div",null,[!e.qrcode&&e.id&&S(t(v,{size:"small",text:!0,type:"primary",onClick:()=>R(e,"qrcode")},{default:()=>[t(y,{"local-icon":"upload",class:"font-size-26px ml-5px c-#000"},null)]}),[[D("no-auth"),"aftermarket:update:permission.do"]]),e.qrcode&&S(t(v,{size:"small",text:!0,type:"primary",onClick:()=>R(e,"qrcode"),style:{marginLeft:"5px"}},{default:()=>[t(y,{"local-icon":"edit",class:"font-size-26px ml-5px c-#000"},null)]}),[[D("no-auth"),"aftermarket:update:permission.do"]])])])},{title:()=>t("div",{class:"flex items-center justify-center"},[t("div",null,[p("故障现象")]),t(y,{"local-icon":"edit",class:"font-size-16px ml-5px"},null)]),key:"fault",width:200,resizable:!0,render(e){return e.id&&i(P,{value:e.fault||"",onUpdateValue(l){N(e,l,"fault")}})}},{titleName:"售后原因",title:()=>i("div",{class:"flex items-center justify-center gap-6px"},[i("span",null,"售后原因"),i(q,{trigger:"click",placement:"bottom"},{trigger:()=>i("span",{class:"cursor-pointer text-primary hover:opacity-80"},t(y,{"local-icon":"search",class:"font-size-18px ml-5px"},null)),default:()=>i("div",{class:"flex items-center gap-4px p-6px"},[i(L,{size:"small",placeholder:"请选择售后原因",value:c.reid,style:"width:200px",clearable:!0,filterable:!0,labelField:"rs",valueField:"id",options:V.data,onSearch:Ne,onBlur:le,onScroll:he,onClear:Te,onUpdateValue:$e}),i(v,{size:"small",type:"primary",onClick:x},{default:()=>"搜索"})])})]),align:"center",key:"list",width:200,resizable:!0,render:e=>{var l;return t("div",{class:"flex items-center justify-center"},[t(ke,{trigger:"hover",style:"maxWidth:500px"},{trigger:()=>{var o;return t("div",{class:"text-left",style:{display:"-webkit-box",overflow:"hidden",textOverflow:"ellipsis",WebkitBoxOrient:"vertical",WebkitLineClamp:3}},[((o=e.list)==null?void 0:o.length)&&e.list.map((d,h)=>d.rs).join("、")])},default:()=>{var o;return((o=e.list)==null?void 0:o.length)&&e.list.map((d,h)=>d.rs).join("、")}}),e.id&&t("div",{onClick:()=>Bl(e)},[t(y,{"local-icon":"setup",class:"font-size-20px ml-5px",style:{cursor:"pointer",color:((l=e.list)==null?void 0:l.length)>0?"#1890ff":""}},null)])])}},{title:()=>t("div",{class:"flex items-center justify-center"},[t("div",null,[p("诊断结论")]),t(y,{"local-icon":"edit",class:"font-size-16px ml-5px"},null)]),width:200,resizable:!0,key:"diagnosis",render(e){return e.id&&i(P,{value:e.diagnosis||"",onUpdateValue(l){N(e,l,"diagnosis")}})}},{title:()=>t("div",{class:"flex items-center justify-center"},[t("div",null,[p("临时处理")]),t(y,{"local-icon":"edit",class:"font-size-16px ml-5px"},null)]),key:"tphand",width:200,resizable:!0,render(e){return e.id&&i(P,{value:e.tphand||"",onUpdateValue(l){N(e,l,"tphand")}})}},{title:()=>t("div",{class:"flex items-center justify-center"},[t("div",null,[p("长期改善")]),t(y,{"local-icon":"edit",class:"font-size-16px ml-5px"},null)]),key:"impv",width:200,resizable:!0,render(e){return e.id&&i(P,{value:e.impv||"",onUpdateValue(l){N(e,l,"impv")}})}},{titleName:"处理结论",title:()=>i("div",{class:"flex items-center justify-center gap-6px"},[i("span",null,"处理结论"),i(q,{trigger:"click",placement:"bottom"},{trigger:()=>i("span",{class:"cursor-pointer text-primary hover:opacity-80"},t(y,{"local-icon":"search",class:"font-size-18px ml-5px"},null)),default:()=>i("div",{class:"flex items-center gap-4px p-6px"},[i(L,{size:"small",placeholder:"请选择处理结论",value:c.conc,style:"width:200px",clearable:!0,options:pe,onClear:el,onUpdateValue:Ze}),i(v,{size:"small",type:"primary",onClick:x},{default:()=>"搜索"})])})]),key:"conc",width:200,resizable:!0,render(e){return e.id&&i(Je,{value:e.conc??null,options:pe,onUpdateValue(l){N(e,l,"conc")}})}},{title:"处理时长",key:"duration",width:120,resizable:!0,align:"center",render:e=>e.duration&&e.id?t("div",null,[e.conc!==null&&e.conc!==void 0?"总耗时":"已历时",p(" "),e.duration?e.duration+" 天":"--"]):""},{title:()=>t("div",{class:"flex items-center justify-center"},[t("div",null,[p("备注")]),t(y,{"local-icon":"edit",class:"font-size-16px ml-5px"},null)]),key:"devnotes",width:200,resizable:!0,render(e){return e.id&&i(P,{value:e.devnotes||"",onUpdateValue(l){N(e,l,"devnotes")}})}},{title:()=>t("div",{class:"flex items-center justify-center"},[t("div",null,[p("发货信息")]),t(y,{"local-icon":"edit",class:"font-size-16px ml-5px"},null)]),key:"returnnum",width:200,resizable:!0,render(e){return e.id&&i(P,{value:e.returnnum||"",onUpdateValue(l){N(e,l,"returnnum")}})}},{title:()=>t("div",{class:"flex items-center justify-center"},[t("div",null,[p("发货网关编号")]),t(y,{"local-icon":"edit",class:"font-size-16px ml-5px"},null)]),key:"rsn",width:200,resizable:!0,render(e){return e.id&&i(P,{value:e.rsn||"",onUpdateValue(l){N(e,l,"rsn")}})}},{title:()=>t("div",{class:"flex items-center justify-center"},[t("div",null,[p("发货网关型号")]),t(y,{"local-icon":"edit",class:"font-size-16px ml-5px"},null)]),key:"rmodel",width:200,resizable:!0,render(e){return e.id&&i(P,{value:e.rmodel||"",onUpdateValue(l){N(e,l,"rmodel")}})}},{title:()=>t("div",{class:"flex items-center justify-center"},[t("div",null,[p("发货寄件类型")]),t(y,{"local-icon":"edit",class:"font-size-16px ml-5px"},null)]),key:"rdetails",align:"center",width:200,resizable:!0,render:e=>t("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-around"}},[e.rdetails==0||e.rdetails==1?t(ul,null,[t("div",{class:"w-full",title:`${e.rdetails}`},[t("div",null,[p("类型："),e.rdetails==0?"裸机":"包含配件"]),e.rdetails==1&&t("div",null,[p("配件详情："),e.raccessory])]),t(ke,{trigger:"hover",placement:"right"},{trigger:()=>S(t(v,{text:!0,type:"primary",onClick:()=>ye(e.id,e,"rdetails")},{default:()=>[t(y,{"local-icon":"edit",class:"font-size-26px ml-5px c-#000"},null)]}),[[D("no-auth"),"aftermarket:update:permission.do"]]),default:()=>C("common.update")})]):e.id&&S(t(v,{text:!0,type:"primary",size:"small",onClick:()=>ye(e.id,"","rdetails")},{default:()=>[p("填写")]}),[[D("no-auth"),"aftermarket:update:permission.do"]])])},{title:"发货时间",key:"rdbtime",align:"center",width:180,resizable:!0,render:e=>t("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-around"}},[t("div",{class:"w-full",title:`${e.rdbtime}`},[e.rdbtime])])},{title:"发货人",key:"rusername",align:"center",width:100,resizable:!0,render:e=>t("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-around"}},[t("div",{class:"w-full",title:`${e.rusername}`},[e.rusername])])},{key:"operate",title:C("common.operate"),align:"center",width:120,fixed:"right",render:e=>t("div",{class:"flex-center gap-8px"},[t($t,{onPositiveClick:()=>bl(e.id)},{default:()=>C("common.confirmDelete"),trigger:()=>{let l;return S(t(v,{type:"error",ghost:!0,size:"small"},Nt(l=C("common.delete"))?l:{default:()=>[l]}),[[D("no-auth"),"aftermarket:delete:permission.do"]])}})])}]:[{type:"selection",align:"center",width:48,fixed:"left",resizable:!0},{titleName:"网关编号",title:()=>i("div",{class:"flex items-center justify-center gap-6px"},[i("span",null,"网关编号"),i(q,{trigger:"click",placement:"bottom"},{trigger:()=>i("span",{class:"cursor-pointer text-primary hover:opacity-80"},t(y,{"local-icon":"search",class:"font-size-18px ml-5px"},null)),default:()=>i("div",{class:"flex items-center gap-4px p-6px"},[i(I,{size:"small",placeholder:"输入网关编号",value:c.sn,style:"width:160px",clearable:!0,onClear:je,onUpdateValue:Be}),i(v,{size:"small",type:"primary",onClick:x},{default:()=>"搜索"})])})]),key:"sn",align:"center",width:180,fixed:"left",resizable:!0},{titleName:"网关型号",title:()=>i("div",{class:"flex items-center justify-center gap-6px"},[i("span",null,"网关型号"),i(q,{trigger:"click",placement:"bottom"},{trigger:()=>i("span",{class:"cursor-pointer text-primary hover:opacity-80"},t(y,{"local-icon":"search",class:"font-size-18px ml-5px"},null)),default:()=>i("div",{class:"flex items-center gap-4px p-6px"},[i(L,{size:"small",placeholder:"请选择网关型号",value:c.gws1,style:"width:200px",clearable:!0,filterable:!0,multiple:!0,options:H.value,onSearch:Ue,onBlur:le,onScroll:Le,onClear:me,onUpdateValue:Se}),i(v,{size:"small",type:"primary",onClick:x},{default:()=>"搜索"})])})]),align:"center",key:"model",width:120,resizable:!0},{titleName:"售后原因",title:()=>i("div",{class:"flex items-center justify-center gap-6px"},[i("span",null,"售后原因"),i(q,{trigger:"click",placement:"bottom"},{trigger:()=>i("span",{class:"cursor-pointer text-primary hover:opacity-80"},t(y,{"local-icon":"search",class:"font-size-18px ml-5px"},null)),default:()=>i("div",{class:"flex items-center gap-4px p-6px"},[i(L,{size:"small",placeholder:"请选择售后原因",value:c.reid,style:"width:200px",clearable:!0,filterable:!0,labelField:"rs",valueField:"id",options:V.data,onSearch:Ne,onBlur:le,onScroll:he,onClear:Te,onUpdateValue:$e}),i(v,{size:"small",type:"primary",onClick:x},{default:()=>"搜索"})])})]),align:"center",key:"list",width:200,resizable:!0,render:e=>{var l;return t("div",{class:"flex items-center justify-center"},[t("div",{class:"text-left"},[((l=e.list)==null?void 0:l.length)&&e.list.map((o,d)=>o.rs).join("、")])])}},{title:"诊断结论",align:"center",width:200,resizable:!0,key:"diagnosis",ellipsis:{tooltip:!0}},{title:"临时处理",align:"center",key:"tphand",width:200,resizable:!0,ellipsis:{tooltip:!0}},{title:"长期改善",align:"center",key:"impv",width:200,resizable:!0,ellipsis:{tooltip:!0}},{key:"operate",title:C("common.operate"),align:"center",width:120,fixed:"right",render:e=>t("div",{class:"flex-center gap-8px"},[t(v,{type:"primary",ghost:!0,size:"small",onClick:()=>Vl(e)},{default:()=>["修改"]})])}]}),ne=z(!1),be=z(null),j=K({id:"",diagnosis:"",tphand:"",impv:""}),Il={diagnosis:[{required:!0,message:"请输入诊断结论",trigger:"blur"}],tphand:[{required:!0,message:"请输入临时处理",trigger:"blur"}],impv:[{required:!0,message:"请输入长期改善",trigger:"blur"}]},Vl=e=>{Object.assign(j,e),ne.value=!0},Al=()=>{ne.value=!1,be.value.resetFields()},El=()=>{be.value.validate(async e=>{var l;if(!e){const{data:o,error:d}=await Ce([j]);d||((l=window.$message)==null||l.success("修改成功"),ne.value=!1,be.value.resetFields(),x())}})},{checkedRowKeys:W,onDeleted:Pl}=St(Ve,x),Ae=(e,l=0)=>{Ge.value=e,de.value=l,we.value=!0},Rl=e=>{de.value=e},se=z(!1),u=K({id:0,type:"",analyzeFileList:[]});function R(e,l){console.log(e,u,"row"),u.analyzeFileList=[],u.id=e.id,u.type=l,l==="qrcode"?e.qrcode&&u.analyzeFileList.push({id:"0",name:"0",url:e.qrcode,status:"finished"}):l==="sceneImg"?(e.devre1&&u.analyzeFileList.push({id:"0",name:"0",url:e.devre1,status:"finished"}),e.devre2&&u.analyzeFileList.push({id:"1",name:"1",url:e.devre2,status:"finished"}),e.devre3&&u.analyzeFileList.push({id:"2",name:"2",url:e.devre3,status:"finished"})):l==="video"?e.devre4&&u.analyzeFileList.push({id:"0",name:e.devre4.split("?")[1],url:e.devre4,status:"finished"}):(e.devre5&&u.analyzeFileList.push({id:"0",name:"0",url:e.devre5,status:"finished"}),e.devre6&&u.analyzeFileList.push({id:"1",name:"1",url:e.devre6,status:"finished"}),e.devre7&&u.analyzeFileList.push({id:"2",name:"2",url:e.devre7,status:"finished"})),se.value=!0}function al(e){var h,f,a,m;const l=["image/jpeg","image/png","image/jpg","image/x-icon"];console.log("data.file.file",e.file.file);const o=l.includes(e.file.file.type),d=e.file.file.size/1024/1024<100;return o||((h=window.$message)==null||h.destroyAll(),(f=window.$message)==null||f.error("只能上传 JPG/PNG/JPEG/ICO 格式的图片")),d||((a=window.$message)==null||a.destroyAll(),(m=window.$message)==null||m.error("上传图片大小不能超过 100MB")),o&&d}const ie=z(0);async function Ee(e){var h,f;ie.value=0;const{file:l,onFinish:o,onError:d}=e;if(!l.file)return o({...l});try{const a=await ol(l.file,l.name,"aftermarket/image",m=>{ie.value=m});a&&(l.url=a,o({...l,url:a}),(h=window.$message)==null||h.destroyAll(),(f=window.$message)==null||f.success("上传成功"),ie.value=0)}catch(a){d(a)}}function ql(){se.value=!1,u.analyzeFileList=[]}function Gl(e){return new Promise((l,o)=>{Ee({file:e,onFinish:()=>l(!0),onError:d=>o(d)})})}async function Ol(){var a,m,_,b,B,J;console.log(u,"uploadImgForm");let e=[{id:u.id}];const l=u.analyzeFileList;if(await Promise.all([...l.map($=>Gl($))]),l.some($=>$.url&&$.url.startsWith("blob:"))){(a=window.$message)==null||a.destroyAll(),(m=window.$message)==null||m.warning("还有文件正在上传或上传失败，请稍后提交");return}if(l.some($=>!$.url||$.url.trim()==="")){(_=window.$message)==null||_.destroyAll(),(b=window.$message)==null||b.warning("存在上传失败的文件，请重新上传");return}u.type==="qrcode"?u.analyzeFileList.length==0?e[0].qrcode="":e[0].qrcode=u.analyzeFileList[0].url:u.type==="video"?u.analyzeFileList.length==0?e[0].devre4="":e[0].devre4=u.analyzeFileList[0].url:u.type==="sceneImg"?(u.analyzeFileList.length==0&&(e[0].devre1="",e[0].devre2="",e[0].devre3=""),u.analyzeFileList.length==1&&(e[0].devre1=u.analyzeFileList[0].url,e[0].devre2="",e[0].devre3=""),u.analyzeFileList.length==2&&(e[0].devre1=u.analyzeFileList[0].url,e[0].devre2=u.analyzeFileList[1].url,e[0].devre3=""),u.analyzeFileList.length==3&&(e[0].devre1=u.analyzeFileList[0].url,e[0].devre2=u.analyzeFileList[1].url,e[0].devre3=u.analyzeFileList[2].url)):(u.analyzeFileList.length==0&&(e[0].devre5="",e[0].devre6="",e[0].devre7=""),u.analyzeFileList.length==1&&(e[0].devre5=u.analyzeFileList[0].url,e[0].devre6="",e[0].devre7=""),u.analyzeFileList.length==2&&(e[0].devre5=u.analyzeFileList[0].url,e[0].devre6=u.analyzeFileList[1].url,e[0].devre7=""),u.analyzeFileList.length==3&&(e[0].devre5=u.analyzeFileList[0].url,e[0].devre6=u.analyzeFileList[1].url,e[0].devre7=u.analyzeFileList[2].url));const{data:h,error:f}=await Ce(e);f||((B=window.$message)==null||B.destroyAll(),(J=window.$message)==null||J.success(h.msg||"操作成功"),x(),se.value=!1,u.id=0,u.analyzeFileList=[])}function Hl(e){var h,f,a,m;const o=["video/mp4","video/avi","video/mov","video/mpeg"].includes(e.file.file.type),d=e.file.file.size/1024/1024<100;return o||((h=window.$message)==null||h.destroyAll(),(f=window.$message)==null||f.error("格式错误，请上传视频！")),d||((a=window.$message)==null||a.destroyAll(),(m=window.$message)==null||m.error("上传视频大小不能超过 100MB！")),o&&d}async function Ml(e){const{file:l,onFinish:o,onError:d}=e;new FormData().append("multipartFile",l.file);try{const f=await ol(l.file,l.name,"aftermarket/image/",a=>{});f&&(o({...l,url:f}),u.analyzeFileList[0].url=f)}catch(f){d(f)}}const Wl=z(window.innerHeight-390);function Jl(e){const l=[];l.push(["客户信息","网关编号","型号","是否推送厂家","寄回类型","故障现象","售后原因","诊断结论","临时处理","长期改善","处理结论","处理时长","备注","发货信息"]),e.filter(a=>W.value.includes(a.id)).forEach(a=>{var m,_;l.push([a.comp,a.sn||"",a.model||"",a.manu==1?"是":"否",`类型：${a.details==0?"仅裸机":"含配件"}
${a.details==1?" 配件详情："+a.accessory:""}`,a.fault||"",((m=a.list)==null?void 0:m.length)&&a.list.map((b,B)=>b.rs).join("、"),a.diagnosis,a.tphand,a.impv,((_=pe.find(b=>b.value==a.status))==null?void 0:_.label)||"",a.conc!=null&&a.duration!=null?`总耗时：${a.duration||"--"} 天`:`已历时：${a.duration||"--"} 天`,a.devnotes,`发货信息：${a.returnnum||""}
发货时间：${a.rdbtime||""}
发货人：${a.rusername||""}
发货网关编号：${a.rsn||""}
发货网关型号：${a.rmodel||""}
发货类型：${a.rdetails==0?"仅裸机":a.rdetails==1?"含配件":""}
${a.rdetails==1?" 配件详情："+a.raccessory:""}`])});const d=oe.utils.aoa_to_sheet(l);d["!cols"]=[{wch:30},{wch:25},{wch:20},{wch:15},{wch:30},{wch:30},{wch:30},{wch:30},{wch:30},{wch:30},{wch:15},{wch:20},{wch:20},{wch:40}],Object.keys(d).forEach(a=>{a.startsWith("!")||(d[a].s={alignment:{vertical:"center",horizontal:"center",wrapText:!0}})});for(let a=0;a<11;a++){const m=oe.utils.encode_cell({r:0,c:a});d[m]&&(d[m].s={font:{bold:!0},alignment:{vertical:"center",horizontal:"center"}})}const h=oe.utils.book_new();oe.utils.book_append_sheet(h,d,"售后列表");const f=oe.write(h,{bookType:"xlsx",type:"array"});et.saveAs(new Blob([f]),"售后列表.xlsx")}return(e,l)=>{const o=jt,d=Bt,h=tt,f=lt,a=rt,m=Dt,_=it,b=ot,B=Zl,J=Yl,$=ut,Z=dt,Kl=ct,re=pt,ze=vt,nl=mt,A=ft,Ql=gt;return F(),st("div",Tt,[t(b,{bordered:!1,size:"small",class:"card-wrapper"},{default:n(()=>[t(_,{ref:"formRef",model:s(c),"label-placement":"left","label-width":100,"show-feedback":!1},{default:n(()=>[t(m,{responsive:"screen","item-responsive":"","x-gap":16,"y-gap":16},{default:n(()=>[s(ce).userInfo.usertype!==7?(F(),T(o,{key:0,span:"24 s:12 m:6",label:"公司名称",path:"cid"},{default:n(()=>[t(s(L),{filterable:"",clearable:"",value:s(c).cid,"onUpdate:value":[l[0]||(l[0]=r=>s(c).cid=r),We],placeholder:"请选择公司名称","label-field":"comp","value-field":"id",onClear:De,onSearch:He,onBlur:Me,options:G.value,onScroll:Oe},null,8,["value","options"])]),_:1})):E("",!0),t(o,{span:"24 s:12 m:6",label:"网关编号",path:"sn"},{default:n(()=>[t(s(I),{clearable:"",value:s(c).sn,"onUpdate:value":[l[1]||(l[1]=r=>s(c).sn=r),s(Be)],onClear:je,placeholder:"请输入网关编号"},null,8,["value","onUpdate:value"])]),_:1}),t(o,{span:"24 s:12 m:6",label:"网关型号",path:"gws"},{default:n(()=>[t(s(L),{clearable:"",filterable:"",multiple:"",value:s(c).gws1,"onUpdate:value":[l[2]||(l[2]=r=>s(c).gws1=r),s(Se)],placeholder:"请选择网关型号","label-field":"label","value-field":"value",options:H.value,onSearch:Ue,onBlur:le,onScroll:Le,onClear:me},null,8,["value","options","onUpdate:value"])]),_:1}),t(o,{span:"24 s:12 m:6",label:"售后原因",path:"reid"},{default:n(()=>[t(s(L),{value:s(c).reid,"onUpdate:value":[l[3]||(l[3]=r=>s(c).reid=r),$e],clearable:"",filterable:"","label-field":"rs","value-field":"id",options:s(V).data,onScroll:he,onClear:Te,onSearch:Ne,placeholder:"请选择售后原因"},null,8,["value","options"])]),_:1}),s(ce).userInfo.usertype!==7?(F(),T(o,{key:1,span:"24 s:12 m:6",label:"处理结论",path:"conc"},{default:n(()=>[t(s(L),{value:s(c).conc,"onUpdate:value":[l[4]||(l[4]=r=>s(c).conc=r),Ze],clearable:"",options:pe,onClear:el,placeholder:"请选择处理结论"},null,8,["value","options"])]),_:1})):E("",!0),t(o,{span:"24 s:12 m:4",label:"待厂家处理",path:"pending"},{default:n(()=>[t(s(L),{value:s(c).pending,"onUpdate:value":[l[5]||(l[5]=r=>s(c).pending=r),Dl],clearable:"",options:[{label:"待处理",value:1},{label:"全部",value:0}],onClear:Sl,placeholder:"请选择"},null,8,["value"])]),_:1}),t(o,{span:"24 s:12 m:8",label:"起止时间"},{default:n(()=>[t(d,{value:s(c).startAndTimeRange,"onUpdate:value":l[6]||(l[6]=r=>s(c).startAndTimeRange=r),type:"datetimerange",clearable:"",shortcuts:pl,"onUpdate:formattedValue":xl},null,8,["value"])]),_:1}),t(o,{span:"24 s:12 m:5"},{default:n(()=>[t(a,{class:"w-full"},{default:n(()=>[s(cl)("aftermarket:select:permission.do")?(F(),T(s(v),{key:0,ghost:"",onClick:s(x)},{icon:n(()=>[t(h,{class:"text-icon"})]),default:n(()=>[l[32]||(l[32]=p(" "+U("查询")))]),_:1,__:[32]},8,["onClick"])):E("",!0),s(cl)("aftermarket:delete:permission.do")?(F(),T(s(v),{key:1,type:"error",disabled:s(W).length===0,onClick:zl},{icon:n(()=>[t(f,{class:"text-icon"})]),default:n(()=>[l[33]||(l[33]=p(" "+U("批量删除")))]),_:1,__:[33]},8,["disabled"])):E("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(b,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:n(()=>[t(a,{align:"center",wrap:"",class:"lt-sm:w-200px"},{default:n(()=>l[34]||(l[34]=[il("div",null,"售后设备",-1)])),_:1,__:[34]})]),"header-extra":n(()=>[t(a,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:n(()=>[t(s(v),{onClick:l[7]||(l[7]=r=>Jl(s(Ve))),size:"small",ghost:"",type:"primary",disabled:s(W).length==0},{icon:n(()=>[t(B,{class:"text-icon"})]),default:n(()=>[l[35]||(l[35]=p(" "+U("导出")))]),_:1,__:[35]},8,["disabled"]),t(J,{columns:s(Ie),"onUpdate:columns":l[8]||(l[8]=r=>sl(Ie)?Ie.value=r:null),ctype:4},null,8,["columns"])]),_:1})]),default:n(()=>[t($,{"checked-row-keys":s(W),"onUpdate:checkedRowKeys":l[9]||(l[9]=r=>sl(W)?W.value=r:null),columns:s(tl),data:s(Ve),size:"small",loading:s(Tl),remote:"","max-height":Wl.value,"scroll-x":s(tl).reduce((r,Xl)=>r+(Xl.width||100),0),"row-key":r=>r.id,pagination:s(Nl),class:"sm:h-full",striped:"","onUpdate:filters":jl},null,8,["checked-row-keys","columns","data","loading","max-height","scroll-x","row-key","pagination"])]),_:1}),t(re,{show:se.value,"onUpdate:show":l[13]||(l[13]=r=>se.value=r),title:u.type==="qrcode"?"二维码上传":u.type==="sceneImg"?"现场照片上传":u.type==="video"?"现场视频上传":"分析照片上传",preset:"card",class:"w-800px"},{footer:n(()=>[t(a,{justify:"end"},{default:n(()=>[t(s(v),{size:"small",class:"mt-16px",onClick:ql},{default:n(()=>[p(U(s(C)("common.cancel")),1)]),_:1}),t(s(v),{type:"primary",size:"small",class:"mt-16px",onClick:Ol},{default:n(()=>[p(U(s(C)("common.confirm")),1)]),_:1})]),_:1})]),default:n(()=>[u.type==="qrcode"?(F(),T(Z,{key:0,multiple:"",max:1,"file-list":u.analyzeFileList,"onUpdate:fileList":l[10]||(l[10]=r=>u.analyzeFileList=r),"list-type":"image-card","default-upload":!1,onBeforeUpload:al,"custom-request":Ee},{default:n(()=>l[36]||(l[36]=[p(" 点击上传 ")])),_:1,__:[36]},8,["file-list"])):u.type==="video"?(F(),T(Z,{key:1,"file-list":u.analyzeFileList,"onUpdate:fileList":l[11]||(l[11]=r=>u.analyzeFileList=r),"default-upload":!1,onBeforeUpload:Hl,max:1,"custom-request":Ml},{default:n(()=>[t(s(v),{type:"primary"},{default:n(()=>l[37]||(l[37]=[p(" 上传视频 ")])),_:1,__:[37]})]),_:1},8,["file-list"])):(F(),T(Z,{key:2,multiple:"",max:3,"file-list":u.analyzeFileList,"onUpdate:fileList":l[12]||(l[12]=r=>u.analyzeFileList=r),"list-type":"image-card",onBeforeUpload:al,"default-upload":!1,"custom-request":Ee},{default:n(()=>l[38]||(l[38]=[p(" 点击上传 ")])),_:1,__:[38]},8,["file-list"])),il("div",null,[ie.value?(F(),T(Kl,{key:0,type:"line",percentage:ie.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):E("",!0)])]),_:1},8,["show","title"]),t(re,{show:ge.value,"onUpdate:show":l[18]||(l[18]=r=>ge.value=r),title:g.type=="rdetails"?"设备发货网关寄回类型":g.type=="details"?"寄回类型":"",preset:"card",class:"w-600px"},{footer:n(()=>[t(a,{justify:"end"},{default:n(()=>[t(s(v),{size:"small",class:"mt-16px",onClick:Ke},{default:n(()=>[p(U(s(C)("common.cancel")),1)]),_:1}),t(s(v),{type:"primary",size:"small",class:"mt-16px",onClick:wl},{default:n(()=>[p(U(s(C)("common.confirm")),1)]),_:1})]),_:1})]),default:n(()=>[g.type==="details"?(F(),T(_,{key:0,ref:"formRef",model:g,"label-placement":"left"},{default:n(()=>[t(A,{label:"设备寄回类型",path:"value"},{default:n(()=>[t(nl,{value:g.value,"onUpdate:value":l[14]||(l[14]=r=>g.value=r),name:"radiogroup"},{default:n(()=>[t(a,null,{default:n(()=>[t(ze,{value:0},{default:n(()=>l[39]||(l[39]=[p("仅裸机")])),_:1,__:[39]}),t(ze,{value:1},{default:n(()=>l[40]||(l[40]=[p("含配件")])),_:1,__:[40]})]),_:1})]),_:1},8,["value"])]),_:1}),g.value==1?(F(),T(A,{key:0,label:"配件详情",path:"accessory"},{default:n(()=>[t(s(I),{value:g.accessory,"onUpdate:value":l[15]||(l[15]=r=>g.accessory=r),placeholder:"请输入配件详情",clearable:""},null,8,["value"])]),_:1})):E("",!0)]),_:1},8,["model"])):E("",!0),g.type==="rdetails"?(F(),T(_,{key:1,ref:"formRef",model:g,"label-placement":"left"},{default:n(()=>[t(A,{label:"设备发货网关寄回类型",path:"value"},{default:n(()=>[t(nl,{value:g.value,"onUpdate:value":l[16]||(l[16]=r=>g.value=r),name:"radiogroup"},{default:n(()=>[t(a,null,{default:n(()=>[t(ze,{value:0},{default:n(()=>l[41]||(l[41]=[p("仅裸机")])),_:1,__:[41]}),t(ze,{value:1},{default:n(()=>l[42]||(l[42]=[p("含配件")])),_:1,__:[42]})]),_:1})]),_:1},8,["value"])]),_:1}),g.value==1?(F(),T(A,{key:0,label:"发货配件详情",path:"raccessory"},{default:n(()=>[t(s(I),{value:g.raccessory,"onUpdate:value":l[17]||(l[17]=r=>g.raccessory=r),placeholder:"请输入发货配件详情",clearable:""},null,8,["value"])]),_:1})):E("",!0)]),_:1},8,["model"])):E("",!0)]),_:1},8,["show","title"]),t(re,{show:Y.value,"onUpdate:show":l[20]||(l[20]=r=>Y.value=r),title:"二次确认",preset:"card",class:"w-600px"},{footer:n(()=>[t(a,{justify:"end"},{default:n(()=>[t(s(v),{size:"small",class:"mt-16px",onClick:_l},{default:n(()=>[p(U(s(C)("common.cancel")),1)]),_:1}),t(s(v),{type:"primary",size:"small",class:"mt-16px",onClick:kl},{default:n(()=>[p(U(s(C)("common.confirm")),1)]),_:1})]),_:1})]),default:n(()=>[t(_,{ref:"formRef",model:k,"label-placement":"left"},{default:n(()=>[t(A,{label:"密码",path:"password",required:""},{default:n(()=>[t(s(I),{type:"password","show-password-on":"mousedown",value:k.password,"onUpdate:value":l[19]||(l[19]=r=>k.password=r),placeholder:"请输入密码",clearable:""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"]),t(re,{show:xe.value,"onUpdate:show":l[22]||(l[22]=r=>xe.value=r),title:"设置售后原因",preset:"card",class:"w-600px"},{footer:n(()=>[t(a,{justify:"end"},{default:n(()=>[t(s(v),{size:"small",class:"mt-16px",onClick:ll},{default:n(()=>[p(U(s(C)("common.cancel")),1)]),_:1}),t(s(v),{type:"primary",size:"small",class:"mt-16px",loading:ae.value,onClick:$l},{default:n(()=>[p(U(s(C)("common.confirm")),1)]),_:1},8,["loading"])]),_:1})]),default:n(()=>[t(_,{ref:"formRef",model:w,"label-placement":"left"},{default:n(()=>[t(A,{label:"售后原因",path:"value",required:""},{default:n(()=>[t(s(L),{value:w.reidList,"onUpdate:value":[l[21]||(l[21]=r=>w.reidList=r),Ye],multiple:"",clearable:"",filterable:"","label-field":"rs","value-field":"id",options:s(V).data,onScroll:he,onClear:Qe,onSearch:Ll,placeholder:"请选择售后原因"},null,8,["value","options"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"]),t(re,{show:ne.value,"onUpdate:show":l[29]||(l[29]=r=>ne.value=r),title:"修改",preset:"card",class:"w-600px"},{footer:n(()=>[t(a,{justify:"end"},{default:n(()=>[t(s(v),{size:"small",class:"mt-16px",onClick:Al},{default:n(()=>[p(U(s(C)("common.cancel")),1)]),_:1}),t(s(v),{type:"primary",size:"small",class:"mt-16px",loading:ae.value,onClick:El},{default:n(()=>[p(U(s(C)("common.confirm")),1)]),_:1},8,["loading"])]),_:1})]),default:n(()=>[t(_,{ref_key:"editformRef",ref:be,model:j,"label-placement":"left",rules:Il},{default:n(()=>[t(A,{label:"诊断结论",path:"diagnosis",required:""},{default:n(()=>[t(s(I),{type:"textarea",value:j.diagnosis,"onUpdate:value":[l[23]||(l[23]=r=>j.diagnosis=r),l[24]||(l[24]=r=>j.diagnosis=r.trim())],placeholder:"请输入诊断结论",clearable:""},null,8,["value"])]),_:1}),t(A,{label:"临时处理",path:"tphand",required:""},{default:n(()=>[t(s(I),{type:"textarea",value:j.tphand,"onUpdate:value":[l[25]||(l[25]=r=>j.tphand=r),l[26]||(l[26]=r=>j.tphand=r.trim())],placeholder:"请输入临时处理",clearable:""},null,8,["value"])]),_:1}),t(A,{label:"长期改善",path:"impv",required:""},{default:n(()=>[t(s(I),{type:"textarea",value:j.impv,"onUpdate:value":[l[27]||(l[27]=r=>j.impv=r),l[28]||(l[28]=r=>j.impv=r.trim())],placeholder:"请输入长期改善",clearable:""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"]),t(Ql,{show:we.value,"onUpdate:show":l[30]||(l[30]=r=>we.value=r),current:de.value,"onUpdate:current":[l[31]||(l[31]=r=>de.value=r),Rl],"src-list":Ge.value},null,8,["show","current","src-list"])])}}}),Xt=bt(It,[["__scopeId","data-v-d9e59798"]]);export{Xt as default};

import{dq as ce,dr as _e,ct as le,d as R,b_ as he,j as w,b as re,K as D,aJ as ve,o as _,e as S,f as c,y as C,a0 as B,cg as G,aw as F,a7 as ue,ca as ye,c as O,w as d,g as o,t as ge,an as xe,aa as be,_ as we,Y as Le,E as ke,az as Se,aA as Te}from"./index-hw7QOW1T.js";import{u as V}from"./echarts-fIqYwgrc.js";import{L as Ae}from"./installCanvasRenderer-iCPGNWhM.js";import{f as Ce,a as Ie,b as Ne,c as ze,d as Oe}from"./home-tH2-NBg0.js";import{a as Re,_ as De}from"./Grid-Cw6tbggG.js";import{_ as $e}from"./Progress-76kDcVby.js";import{_ as je}from"./DataTable-qeqEjtEf.js";import"./Forward-iJK0D6Xc.js";var ie=1/0,Fe=17976931348623157e292;function He(e){if(!e)return e===0?e:0;if(e=ce(e),e===ie||e===-ie){var t=e<0?-1:1;return t*Fe}return e===e?e:0}function Me(e){var t=He(e),i=t%1;return t===t?i?t-i:t:0}var Pe=_e.isFinite,Be=Math.min;function Ge(e){var t=Math[e];return function(i,a){if(i=ce(i),a=a==null?0:Be(Me(a),292),a&&Pe(i)){var u=(le(i)+"e").split("e"),m=t(u[0]+"e"+(+u[1]+a));return u=(le(m)+"e").split("e"),+(u[0]+"e"+(+u[1]-a))}return t(i)}}var Ve=Ge("round");const Ee=e=>1-Math.pow(1-e,5);function Ue(e){const{from:t,to:i,duration:a,onUpdate:u,onFinish:m}=e,p=()=>{const f=performance.now(),n=Math.min(f-b,a),s=t+(i-t)*Ee(n/a);if(n===a){m();return}u(s),requestAnimationFrame(p)},b=performance.now();p()}const We={to:{type:Number,default:0},precision:{type:Number,default:0},showSeparator:Boolean,locale:String,from:{type:Number,default:0},active:{type:Boolean,default:!0},duration:{type:Number,default:2e3},onFinish:Function},qe=R({name:"NumberAnimation",props:We,setup(e){const{localeRef:t}=he("name"),{duration:i}=e,a=w(e.from),u=re(()=>{const{locale:l}=e;return l!==void 0?l:t.value});let m=!1;const p=l=>{a.value=l},b=()=>{var l;a.value=e.to,m=!1,(l=e.onFinish)===null||l===void 0||l.call(e)},f=(l=e.from,h=e.to)=>{m=!0,a.value=e.from,l!==h&&Ue({from:l,to:h,duration:i,onUpdate:p,onFinish:b})},n=re(()=>{var l;const v=Ve(a.value,e.precision).toFixed(e.precision).split("."),I=new Intl.NumberFormat(u.value),E=(l=I.formatToParts(.5).find(y=>y.type==="decimal"))===null||l===void 0?void 0:l.value,U=e.showSeparator?I.format(Number(v[0])):v[0],g=v[1];return{integer:U,decimal:g,decimalSeparator:E}});function s(){m||f()}return D(()=>{ve(()=>{e.active&&f()})}),Object.assign({formattedValue:n},{play:s})},render(){const{formattedValue:{integer:e,decimal:t,decimalSeparator:i}}=this;return[e,t?i:null,t]}}),Ye={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"},Je=c("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 0 1 1-1h16a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1zm0 9h18M8 21h8m-6-4l-.5 4m4.5-4l.5 4"},null,-1),Ke=[Je];function Xe(e,t){return _(),S("svg",Ye,[...Ke])}const Qe={name:"tabler-device-imac",render:Xe},Ze={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"},et=c("path",{fill:"currentColor",d:"M4 20V9h4v11zM4 8V4h4v4zm6 12v-8h4v8zm0-9V7h4v4zm6 9v-5h4v5zm0-6v-4h4v4z"},null,-1),tt=[et];function at(e,t){return _(),S("svg",Ze,[...tt])}const nt={name:"material-symbols-stacked-bar-chart",render:at},st=R({name:"LineChart",__name:"collectTrends",props:{collectTrendsList:{type:Object,default:()=>({})}},setup(e){const t=e;C(()=>t.collectTrendsList,async r=>{f()});const i=B(),a=w(null),{domRef:u,updateOptions:m,updateOptionsAsync:p,hideLoading:b}=V(()=>({tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}},backgroundColor:"#6a7985",textStyle:{color:"rgb(224, 224, 224)"},valueFormatter:function(r){return(r+""!="undefined"?r:"--")+"条"}},grid:{left:"10%",right:"10%",bottom:"10%",top:"5%"},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value",axisLabel:{formatter:"{value}"}},series:[{color:"#1890ff",type:"line",name:"",smooth:!0,emphasis:{focus:"series"},lineStyle:{width:1},areaStyle:{color:new Ae(0,0,0,1,[{offset:0,color:"rgba(24, 144, 255,0.3)"},{offset:1,color:"rgba(24, 144, 255,0)"}],!1),shadowColor:"rgba(24, 144, 255,0.9)",shadowBlur:20},data:[],connectNulls:!0}]}));async function f(){await new Promise(r=>{setTimeout(r,1e3)}),p(r=>{var l,h;return b(),r.xAxis.data=(l=t.collectTrendsList)==null?void 0:l.map(v=>v.date),r.series[0].data=(h=t.collectTrendsList)==null?void 0:h.map(v=>v.dailycount),r})}function n(){m((r,l)=>{const h=l();return r.series[0].name=h.series[0].name,r})}async function s(){f()}return C(()=>i.locale,()=>{n()}),s(),D(()=>{a.value=window.setInterval(()=>{console.log("mainHomeLineChart timer")},1e3*60*5)}),G(()=>{a.value!==null&&(clearInterval(a.value),a.value=null)}),(r,l)=>(_(),S("div",{ref_key:"domRef",ref:u,class:"h-220px overflow-hidden"},null,512))}}),ot=F(st,[["__scopeId","data-v-56bd9afb"]]),lt=R({name:"LineChart",__name:"assetsType",props:{data:{type:Object,default:()=>({})}},setup(e){const t=e;C(()=>t.data,async r=>{f()});const i=B(),a=w(null),{domRef:u,updateOptionsAsync:m,hideLoading:p,updateOptions:b}=V(()=>({tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{show:!1},grid:{left:"5%",right:"5%",bottom:"2%",top:"5%",containLabel:!0},series:[{type:"pie",selectedMode:"single",radius:[0,"30%"],label:{position:"inner",fontSize:10},labelLine:{show:!1},data:[]},{type:"pie",radius:["45%","60%"],labelLine:{length:30},label:{rich:{a:{color:"#6E7079",lineHeight:22,align:"center"},hr:{borderColor:"#8C8D8E",width:"100%",borderWidth:1,height:0},b:{color:"#4C5058",fontSize:14,fontWeight:"bold",lineHeight:33},per:{color:"#fff",backgroundColor:"#4C5058",padding:[3,4],borderRadius:4}}},data:[]}]}));async function f(){await new Promise(r=>{setTimeout(r,1e3)}),m(r=>{p(),r.series[0].data=Object.keys(t.data).map(h=>({name:h,value:Object.values(t.data[h]).reduce((v,I)=>v+I,0)}));const l=[];return Object.keys(t.data).map(h=>t.data[h]).forEach(h=>{for(let v in h)h.hasOwnProperty(v)&&l.push({name:v,value:h[v]})}),r.series[1].data=l,r})}function n(){b((r,l)=>(l(),r))}async function s(){f()}return C(()=>i.locale,()=>{n()}),s(),D(()=>{a.value=window.setInterval(()=>{console.log("mainHomeLineChart timer")},1e3*60*5)}),G(()=>{a.value!==null&&(clearInterval(a.value),a.value=null)}),(r,l)=>(_(),S("div",{ref_key:"domRef",ref:u,class:"h-220px overflow-hidden"},null,512))}}),rt=F(lt,[["__scopeId","data-v-e4f27268"]]),it=R({name:"LineChart",__name:"LogNums",props:{data:{type:Object,default:()=>({})}},setup(e){const t=e;C(()=>t.data,async n=>{p()});const i=B(),a=w(null),{domRef:u,updateOptions:m}=V(()=>({tooltip:{trigger:"item",formatter:"{b}: {c}条"},xAxis:{type:"value",show:!1},yAxis:{type:"category",data:[]},grid:{left:"3%",right:"10%",bottom:"3%",top:"5%",containLabel:!0},series:[{data:[],type:"bar",label:{show:!0,position:"right"},barWidth:30}]}));async function p(){await new Promise(n=>{setTimeout(n,1e3)}),m(n=>(n.yAxis.data=t.data.map(s=>s.logname),n.series[0].data=t.data.map(s=>s.count),n))}function b(){m((n,s)=>n)}async function f(){p()}return C(()=>i.locale,()=>{b()}),f(),D(()=>{a.value=window.setInterval(()=>{console.log("mainHomeLineChart timer")},1e3*60*5)}),G(()=>{a.value!==null&&(clearInterval(a.value),a.value=null)}),(n,s)=>(_(),S("div",{ref_key:"domRef",ref:u,class:"overflow-hidden",style:ue({height:t.data.length>4?`${t.data.length*50}px`:"200px"})},null,4))}}),ct=F(it,[["__scopeId","data-v-8a011224"]]),ut=R({name:"LineChart",__name:"alarmNums",props:{auditAlertList:{type:Object,default:()=>({})}},setup(e){const t=e;C(()=>t.auditAlertList,async n=>{p()});const i=B(),a=w(null),{domRef:u,updateOptions:m}=V(()=>({tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}},backgroundColor:"#6a7985",textStyle:{color:"rgb(224, 224, 224)"},valueFormatter:function(n){return(n+""!="undefined"?n:"--")+"条"}},xAxis:{type:"category",data:[]},yAxis:{type:"value"},grid:{left:"10%",right:"10%",bottom:"10%",top:"5%"},series:[{data:[],type:"line",smooth:!0}]}));async function p(){await new Promise(n=>{setTimeout(n,1e3)}),m(n=>(n.xAxis.data=t.auditAlertList.map(s=>s.logname),n.series[0].data=t.auditAlertList.map(s=>s.count),n))}function b(){m((n,s)=>(s(),n))}async function f(){p()}return C(()=>i.locale,()=>{b()}),f(),D(()=>{a.value=window.setInterval(()=>{console.log("mainHomeLineChart timer")},1e3*60*5)}),G(()=>{a.value!==null&&(clearInterval(a.value),a.value=null)}),(n,s)=>(_(),S("div",{ref_key:"domRef",ref:u,class:"h-220px overflow-hidden"},null,512))}}),dt=F(ut,[["__scopeId","data-v-bf106832"]]),mt=R({name:"LineChart",__name:"securityNums",props:{data:{type:Object,default:()=>({})}},setup(e){const t=e;C(()=>t.data,async n=>{p()});const i=B(),a=w(null),{domRef:u,updateOptions:m}=V(()=>({tooltip:{trigger:"item",formatter:"{b}: {c}条"},xAxis:{type:"value",show:!1},yAxis:{type:"category",data:[]},grid:{left:"3%",right:"10%",bottom:"3%",top:"5%",containLabel:!0},series:[{data:[],type:"bar",label:{show:!0,position:"right"},barWidth:30}]}));async function p(){await new Promise(n=>{setTimeout(n,1e3)}),m(n=>(n.yAxis.data=t.data.map(s=>s.logname),n.series[0].data=t.data.map(s=>s.count),n))}function b(){m((n,s)=>n)}async function f(){p()}return C(()=>i.locale,()=>{b()}),f(),D(()=>{a.value=window.setInterval(()=>{console.log("mainHomeLineChart timer")},1e3*60*5)}),G(()=>{a.value!==null&&(clearInterval(a.value),a.value=null)}),(n,s)=>(_(),S("div",{ref_key:"domRef",ref:u,class:"overflow-hidden",style:ue({height:t.data.length>4?`${t.data.length*50}px`:"200px"})},null,4))}}),pt=F(mt,[["__scopeId","data-v-f13dc3d1"]]),$=e=>(Se("data-v-48b10a12"),e=e(),Te(),e),ft={class:"mb-10px"},_t=$(()=>c("span",{class:"font-size-18px"},"磁盘占用率：",-1)),ht={style:{"font-family":"dsdigits","font-size":"2rem","margin-left":"1rem"}},vt=$(()=>c("span",{class:"ml-5px font-size-20px"},"%",-1)),yt={class:"mb-10px"},gt=$(()=>c("span",{class:"font-size-18px"},"内存占用率：",-1)),xt={style:{"font-family":"dsdigits","font-size":"2rem","margin-left":"1rem"}},bt=$(()=>c("span",{class:"ml-5px font-size-20px"},"%",-1)),wt={class:"mb-10px"},Lt=$(()=>c("span",{class:"font-size-18px"},"CPU占用率：",-1)),kt={style:{"font-family":"dsdigits","font-size":"2rem","margin-left":"1rem"}},St=$(()=>c("span",{class:"ml-5px font-size-20px"},"%",-1)),Tt={style:{display:"flex","align-items":"center"}},At={class:"iconClass bg-#faad14"},Ct={class:"w-80% ml-15px"},It={style:{"font-family":"dsdigits","font-size":"2rem","margin-left":"1rem"}},Nt=$(()=>c("span",{class:"ml-10px font-size-20px"},"条",-1)),zt={style:{display:"flex","align-items":"center"}},Ot={class:"iconClass bg-#3f8fff"},Rt={class:"w-80% ml-15px"},Dt={style:{"font-family":"dsdigits","font-size":"2rem","margin-left":"1rem"}},$t={class:"ml-15px"},jt={key:1,class:"w-100% h-100% flex justify-center"},Ft={key:1,class:"w-100% h-100% flex justify-center"},Ht={key:1,class:"w-100% h-100% flex justify-center",style:{"min-height":"220px"}},Mt={key:1,class:"w-100% h-100% flex justify-center",style:{"min-height":"220px"}},Pt={key:1,class:"w-100% h-100% flex justify-center",style:{"min-height":"220px"}},Bt={key:1,class:"w-100% h-100% flex justify-center",style:{"min-height":"220px"}},Gt=R({name:"home",__name:"index",setup(e){const t=[{label:"近一天",value:0},{label:"近一周",value:1},{label:"近一月",value:2},{label:"近半年",value:3},{label:"近一年",value:4}],i=[{title:"日志源名称",key:"cname"},{title:"状态",key:"enable",width:120,render:g=>o(xe,{type:g.enable==0?"success":"error"},{default:()=>[g.enable==0?"启用":"禁用"]})}],a=w(),u=w(2),m=async()=>{const{data:g,error:y}=await Ce({dateType:u.value});y||(a.value=g)},p=w(),b=w(),f=w(2),n=async()=>{const{data:g,error:y}=await Ie({dateType:f.value});y||(b.value=Number(g.total),f.value==3||f.value==4?p.value=g.data.map(L=>(L.date=L.dateStr,L)).sort((L,N)=>{let k=new Date(L.date),T=new Date(N.date);return k-T}):p.value=g.data.sort((L,N)=>{let k=new Date(L.date),T=new Date(N.date);return k-T}))},s=w(),r=async()=>{const{data:g,error:y}=await Ne();y||(s.value=g)},l=w(),h=async()=>{const{data:g,error:y}=await ze();y||(l.value=g)},v=w(2),I=w(),E=async()=>{const{data:g,error:y}=await Oe({dateType:v.value});y||(I.value=g)},U=w();return D(()=>{m(),n(),r(),h(),E(),U.value=setInterval(()=>{r(),n()},1e3*5)}),ye(()=>{clearInterval(U.value)}),(g,y)=>{const L=qe,N=$e,k=be,T=Re,de=nt,me=Qe,j=we,pe=je,W=De,q=Le,fe=ke;return _(),O(fe,{vertical:"",size:16},{default:d(()=>[o(W,{"x-gap":16,"y-gap":16,responsive:"screen","item-responsive":""},{default:d(()=>[o(T,{span:"24 s:24 xl:5 m:12"},{default:d(()=>[o(k,{title:"🟢🔴 系统信息",bordered:!0,class:"card-wrapper h-100%","content-style":{padding:"10px 30px"}},{default:d(()=>{var x,A,z,H,M,P,Y,J,K,X,Q,Z,ee,te,ae,ne,se,oe;return[c("div",ft,[_t,c("span",ht,[o(L,{ref:"numberAnimationInstRef",from:0,precision:2,to:(z=(A=(x=s.value)==null?void 0:x.systemStatus)==null?void 0:A.disk)==null?void 0:z.replace("%","")},null,8,["to"])]),vt,o(N,{type:"line",percentage:Number((P=(M=(H=s.value)==null?void 0:H.systemStatus)==null?void 0:M.disk)==null?void 0:P.replace("%","")),processing:"","show-indicator":!1},null,8,["percentage"])]),c("div",yt,[gt,c("span",xt,[o(L,{ref:"numberAnimationInstRef",from:0,precision:2,to:(K=(J=(Y=s.value)==null?void 0:Y.systemStatus)==null?void 0:J.mem)==null?void 0:K.replace("%","")},null,8,["to"])]),bt,o(N,{type:"line",percentage:Number((Z=(Q=(X=s.value)==null?void 0:X.systemStatus)==null?void 0:Q.mem)==null?void 0:Z.replace("%","")),processing:"","show-indicator":!1},null,8,["percentage"])]),c("div",wt,[Lt,c("span",kt,[o(L,{ref:"numberAnimationInstRef",from:0,precision:2,to:(ae=(te=(ee=s.value)==null?void 0:ee.systemStatus)==null?void 0:te.cpu)==null?void 0:ae.replace("%","")},null,8,["to"])]),St,o(N,{type:"line",percentage:Number((oe=(se=(ne=s.value)==null?void 0:ne.systemStatus)==null?void 0:se.cpu)==null?void 0:oe.replace("%","")),processing:"","show-indicator":!1},null,8,["percentage"])])]}),_:1})]),_:1}),o(T,{span:"24 s:24 xl:5 m:12"},{default:d(()=>[o(k,{title:"📖 日志接收总数",bordered:!0,class:"card-wrapper h-150px"},{default:d(()=>[c("div",Tt,[c("div",At,[o(de,{style:{"font-size":"38px"}})]),c("div",Ct,[c("div",null,[c("span",It,[o(L,{ref:"numberAnimationInstRef",from:0,to:b.value||0},null,8,["to"])]),Nt])])])]),_:1}),o(k,{title:"📖 日志源资产数",bordered:!0,class:"card-wrapper h-150px mt-16px"},{default:d(()=>{var x,A,z,H,M,P;return[c("div",zt,[c("div",Ot,[o(me,{style:{"font-size":"32px"}})]),c("div",Rt,[c("div",null,[c("span",Dt,[o(L,{ref:"numberAnimationInstRef",from:0,to:(A=(x=s.value)==null?void 0:x.logSourceDevAsset)==null?void 0:A.aunum},null,8,["to"])]),c("span",$t,"占授权总数"+ge(((H=(z=s.value)==null?void 0:z.logSourceDevAsset)==null?void 0:H.cmnum)||0)+"%",1)]),o(N,{type:"line",percentage:(P=(M=s.value)==null?void 0:M.logSourceDevAsset)==null?void 0:P.cmnum,processing:"","show-indicator":!1},null,8,["percentage"])])])]}),_:1})]),_:1}),o(T,{span:"24 s:24 xl:7 m:12"},{default:d(()=>[o(k,{title:"📖 日志源资产类型",bordered:!0,class:"card-wrapper h-100%"},{default:d(()=>{var x,A;return[s.value&&Object.keys((x=s.value)==null?void 0:x.logSoursceAssetType).length>0?(_(),O(rt,{key:0,data:(A=s.value)==null?void 0:A.logSoursceAssetType},null,8,["data"])):(_(),S("div",jt,[o(j,{icon:"empty","local-icon":"empty",class:"font-size-24 mt-30px"})]))]}),_:1})]),_:1}),o(T,{span:"24 s:24 xl:7 m:12"},{default:d(()=>[o(k,{title:"📖 日志源接收状态",bordered:!0,class:"card-wrapper h-100%",style:{"min-height":"220px"}},{default:d(()=>{var x,A;return[((x=s.value)==null?void 0:x.logSoursceList.length)>0?(_(),O(pe,{key:0,columns:i,data:(A=s.value)==null?void 0:A.logSoursceList,size:"small","flex-height":"",bordered:!1,remote:"","row-key":z=>z.id,class:"sm:h-full"},null,8,["data","row-key"])):(_(),S("div",Ft,[o(j,{icon:"empty","local-icon":"empty",class:"font-size-24 mt-30px"})]))]}),_:1})]),_:1})]),_:1}),o(W,{"x-gap":16,"y-gap":16,responsive:"screen","item-responsive":""},{default:d(()=>[o(T,{span:"24 s:24 m:12"},{default:d(()=>[o(k,{title:"📈 日志采集趋势",bordered:!0,class:"card-wrapper h-100%"},{"header-extra":d(()=>[o(q,{value:f.value,"onUpdate:value":[y[0]||(y[0]=x=>f.value=x),n],options:t,style:{width:"120px"}},null,8,["value"])]),default:d(()=>[p.value&&p.value.length>0?(_(),O(ot,{key:f.value,collectTrendsList:p.value},null,8,["collectTrendsList"])):(_(),S("div",Ht,[o(j,{icon:"empty","local-icon":"empty",class:"font-size-24 mt-30px"})]))]),_:1})]),_:1}),o(T,{span:"24 s:24 m:12"},{default:d(()=>[o(k,{title:"📈 审计告警数量趋势",bordered:!0,class:"card-wrapper h-100%","content-style":{padding:"10px"}},{"header-extra":d(()=>[o(q,{value:u.value,"onUpdate:value":[y[1]||(y[1]=x=>u.value=x),m],options:t,style:{width:"120px"}},null,8,["value"])]),default:d(()=>[a.value&&a.value.length>0?(_(),O(dt,{key:u.value,auditAlertList:a.value},null,8,["auditAlertList"])):(_(),S("div",Mt,[o(j,{icon:"empty","local-icon":"empty",class:"font-size-24 mt-30px"})]))]),_:1})]),_:1})]),_:1}),o(W,{"x-gap":16,"y-gap":16,responsive:"screen","item-responsive":""},{default:d(()=>[o(T,{span:"24 s:24 m:12"},{default:d(()=>[o(k,{title:"📊 日志源日志数量TOP10",bordered:!0,class:"card-wrapper h-100%","content-style":{padding:"10px"}},{default:d(()=>[l.value&&l.value.length>0?(_(),O(ct,{key:0,data:l.value},null,8,["data"])):(_(),S("div",Pt,[o(j,{icon:"empty","local-icon":"empty",class:"font-size-24 mt-30px"})]))]),_:1})]),_:1}),o(T,{span:"24 s:24 m:12"},{default:d(()=>[o(k,{title:"📊 安全事件类别数量Top10",bordered:!0,class:"card-wrapper h-100%","content-style":{padding:"10px"}},{"header-extra":d(()=>[o(q,{value:v.value,"onUpdate:value":[y[2]||(y[2]=x=>v.value=x),E],options:t,style:{width:"120px"}},null,8,["value"])]),default:d(()=>[I.value&&I.value.length>0?(_(),O(pt,{key:v.value,data:I.value},null,8,["data"])):(_(),S("div",Bt,[o(j,{icon:"empty","local-icon":"empty",class:"font-size-24 mt-30px"})]))]),_:1})]),_:1})]),_:1})]),_:1})}}}),Xt=F(Gt,[["__scopeId","data-v-48b10a12"]]);export{Xt as default};

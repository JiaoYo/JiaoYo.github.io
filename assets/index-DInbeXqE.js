import{_ as H}from"./table-column-setting.vue_vue_type_script_setup_true_lang-BrhtV_wc.js";import{_ as X}from"./round-delete-BlTgKDBu.js";import{_ as Y}from"./round-add-ocPMFwdA.js";import{d as W,p as I,q as Z,r as ee,s as te,ab as E,b as ae,$ as d,o as N,c as R,w as l,g as e,h as f,t as M,i,aE as le,eJ as oe,eK as ne,L as ie,b1 as se,ak as re,Q as de,B as g,P as Q,aJ as ue,eL as pe,A as D,z as B,eM as G,e as ce,af as K,aN as O,aO as me,aT as _e,a6 as fe}from"./index-ABy-DYGK.js";import{u as ve,a as ge}from"./table-BIfW3tlR.js";import{f as we,b as be}from"./station-VXIdi1dL.js";import{_ as he}from"./lodash-D3AcHrqE.js";import{_ as ye}from"./FormItemGridItem-nzI_lkEE.js";import{_ as ke}from"./Grid-BWAKd0f-.js";import{N as J}from"./Popconfirm-DIbkKv0Y.js";const xe=W({name:"PhotovoltaicModel",__name:"pvmodule_model",props:I({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:I(["submitted"],["update:visible"]),setup(m,{emit:U}){const c=Z(m,"visible"),w=U,u=m,t=ee(b());function b(){return{model:"",capacity:void 0,maxvol:void 0,maxcru:void 0,openvol:void 0,shortcur:void 0,workeff:void 0,rttmed:0,inclination:void 0,area:void 0,solarpanel:void 0}}function C(){Object.assign(t,b()),u.operateType==="edit"&&u.rowData&&Object.assign(t,u.rowData)}const{formRef:q,validate:v,restoreValidation:T}=te();E(()=>u.rowData,()=>{C()}),E(c,()=>{c.value&&(C(),T())});const h=()=>{c.value=!1},z=async()=>{var _;if(await v(),u.operateType==="add"){const{data:o,error:r}=await oe([t]);if(r)return}else{const{data:o,error:r}=await ne([t]);if(r)return}(_=window.$message)==null||_.success(u.operateType==="add"?"添加成功":"修改成功"),h(),w("submitted")},S={type:"string",required:!0,message:"不能为空",trigger:["input","blur"]},p={type:"number",required:!0,message:"不能为空",trigger:["input","blur"]},F={model:S,maxvol:p,maxcru:p,inclination:p},y=ae(()=>({add:d("common.add"),edit:d("common.edit")})[u.operateType]),j=he.debounce(z,1e3,{leading:!0,trailing:!1});return(_,o)=>{const r=ie,n=ye,s=se,A=re,P=ke,V=de,k=g,$=Q,x=ue;return N(),R(x,{show:c.value,"onUpdate:show":o[11]||(o[11]=a=>c.value=a),title:y.value,preset:"card",class:"w-50%"},{footer:l(()=>[e($,{size:16,justify:"center"},{default:l(()=>[e(k,{onClick:h,class:"w-100px"},{default:l(()=>[f(M(i(d)("common.cancel")),1)]),_:1}),e(k,{type:"primary",class:"w-100px",onClick:i(j)},{default:l(()=>[f(M(i(d)("common.confirm")),1)]),_:1},8,["onClick"])]),_:1})]),default:l(()=>[e(V,{ref_key:"formRef",ref:q,model:t,rules:F,"label-placement":"left","label-width":180,"require-mark-placement":"left"},{default:l(()=>[e(P,{responsive:"screen","item-responsive":""},{default:l(()=>[e(n,{span:"24 m:12",label:"组件型号",path:"model"},{default:l(()=>[e(r,{clearable:"",value:t.model,"onUpdate:value":o[0]||(o[0]=a=>t.model=a),maxlength:"64",placeholder:"请输入"},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"组件容量（MW）",path:"capacity"},{default:l(()=>[e(s,{clearable:"",value:t.capacity,"onUpdate:value":o[1]||(o[1]=a=>t.capacity=a),placeholder:"请输入",precision:0,style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"最大工作电压（V）",path:"maxvol"},{default:l(()=>[e(s,{clearable:"",value:t.maxvol,"onUpdate:value":o[2]||(o[2]=a=>t.maxvol=a),placeholder:"请输入",precision:2,style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"最大工作电流（A）",path:"maxcru"},{default:l(()=>[e(s,{clearable:"",value:t.maxcru,"onUpdate:value":o[3]||(o[3]=a=>t.maxcru=a),placeholder:"请输入",precision:2,style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"开路电压（V）",path:"openvol"},{default:l(()=>[e(s,{clearable:"",value:t.openvol,"onUpdate:value":o[4]||(o[4]=a=>t.openvol=a),placeholder:"请输入",precision:2,style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"短路电流（A）",path:"shortcur"},{default:l(()=>[e(s,{clearable:"",value:t.shortcur,"onUpdate:value":o[5]||(o[5]=a=>t.shortcur=a),placeholder:"请输入",precision:2,style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"工作效率",path:"workeff"},{default:l(()=>[e(s,{clearable:"",value:t.workeff,"onUpdate:value":o[6]||(o[6]=a=>t.workeff=a),precision:0,placeholder:"请输入",style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"固定角度",path:"rttmed"},{default:l(()=>[e(A,{filterable:"",placeholder:"选择",value:t.rttmed,"onUpdate:value":o[7]||(o[7]=a=>t.rttmed=a),options:i(le)(i(we))},null,8,["value","options"])]),_:1}),e(n,{span:"24 m:12",label:"安装倾斜度",path:"inclination"},{default:l(()=>[e(s,{clearable:"",value:t.inclination,"onUpdate:value":o[8]||(o[8]=a=>t.inclination=a),placeholder:"请输入",style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"组件面积",path:"area"},{default:l(()=>[e(s,{clearable:"",value:t.area,"onUpdate:value":o[9]||(o[9]=a=>t.area=a),precision:2,placeholder:"请输入",style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"电池板个数",path:"solarpanel"},{default:l(()=>[e(s,{clearable:"",value:t.solarpanel,"onUpdate:value":o[10]||(o[10]=a=>t.solarpanel=a),precision:0,placeholder:"请输入",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title"])}}}),De={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function L(m){return typeof m=="function"||Object.prototype.toString.call(m)==="[object Object]"&&!me(m)}const Ve=W({name:"stationmanagement_pvmodulesetup",__name:"index",setup(m){const{columns:U,columnChecks:c,data:w,getData:u,loading:t,mobilePagination:b,searchParams:C,resetSearchParams:q}=ve({apiFn:pe,apiParams:{page:1,pageSize:20,limit:20,fuzzy:null,_t:new Date().getTime()},immediate:!0,showTotal:!0,columns:()=>[{type:"selection",align:"center",width:48},{key:"model",title:"组件型号",align:"center",width:140},{key:"capacity",title:"组件容量（MW）",align:"center",width:100},{key:"maxvol",title:"最大工作电压（V）",align:"center",width:140},{key:"maxcru",title:"最大工作电流（A）",align:"center",width:140},{key:"openvol",title:"开路电压（V）",align:"center",width:100},{key:"shortcur",title:"短路电流（A）",align:"center",width:100},{key:"workeff",title:"工作效率",align:"center",width:100},{key:"rttmed",title:"固定角度",align:"center",width:100,render:r=>e("span",null,[d(be[r.rttmed])])},{key:"inclination",title:"安装倾斜度",align:"center",width:100},{key:"area",title:"组件面积",align:"center",width:100},{key:"solarpanel",title:"电池板数量",align:"center",width:100},{key:"operate",title:d("common.operate"),align:"center",width:200,fixed:"right",render:r=>{let n;return e("div",{class:"flex-center gap-8px"},[D(e(g,{type:"primary",ghost:!0,size:"small",onClick:()=>o(r.id)},L(n=d("common.edit"))?n:{default:()=>[n]}),[[B("no-auth"),"pvModule:update"]]),D(e(J,{onPositiveClick:()=>_(r.id)},{default:()=>d("common.confirmDelete"),trigger:()=>{let s;return e(g,{type:"error",ghost:!0,size:"small"},L(s=d("common.delete"))?s:{default:()=>[s]})}}),[[B("no-auth"),"pvModule:delete"]])])}}]}),{drawerVisible:v,operateType:T,editingData:h,handleAdd:z,handleEdit:S,checkedRowKeys:p,onBatchDeleted:F,onDeleted:y}=ge(w,u),j=async()=>{const r=p.value.join(","),{data:n,error:s}=await G({ids:r});s||(y(),p.value=[])},_=async r=>{const{data:n,error:s}=await G({ids:r});s||y()},o=r=>{S(r)};return(r,n)=>{const s=Q,A=Y,P=X,V=H,k=_e,$=fe,x=B("no-auth");return N(),ce("div",De,[e($,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:l(()=>[e(s,{align:"center",wrap:"",justify:"start",class:"lt-sm:w-200px"},{default:l(()=>[f(" 光伏组件设置 ")]),_:1})]),"header-extra":l(()=>[e(s,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:l(()=>[D((N(),R(i(g),{onClick:i(z),size:"small",ghost:"",type:"primary"},{icon:l(()=>[e(A,{class:K(["text-icon",{"animate-spin":i(t)}])},null,8,["class"])]),default:l(()=>[f(" "+M(i(d)("common.add")),1)]),_:1},8,["onClick"])),[[x,"pvModule:insert"]]),D((N(),R(i(J),{onPositiveClick:j},{trigger:l(()=>[e(i(g),{size:"small",ghost:"",type:"error",disabled:i(p).length==0},{icon:l(()=>[e(P,{class:K(["text-icon",{"animate-spin":i(t)}])},null,8,["class"])]),default:l(()=>[f(" "+M(i(d)("common.batchDelete")),1)]),_:1},8,["disabled"])]),default:l(()=>[f(" 确认删除选中的项吗？ ")]),_:1})),[[x,"pvModule:delete"]]),e(V,{columns:i(c),"onUpdate:columns":n[0]||(n[0]=a=>O(c)?c.value=a:null)},null,8,["columns"])]),_:1})]),default:l(()=>[e(k,{"checked-row-keys":i(p),"onUpdate:checkedRowKeys":n[1]||(n[1]=a=>O(p)?p.value=a:null),columns:i(U),data:i(w),size:"small",loading:i(t),remote:"","row-key":a=>a.id,pagination:i(b),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","loading","row-key","pagination"]),e(xe,{visible:i(v),"onUpdate:visible":n[2]||(n[2]=a=>O(v)?v.value=a:null),onSubmitted:i(u),"operate-type":i(T),"row-data":i(h)},null,8,["visible","onSubmitted","operate-type","row-data"])]),_:1})])}}});export{Ve as default};

import{_ as R}from"./export-CRAVcHUz.js";import{d as z,q as $,x as E,o as j,c as U,w as a,g as t,i as e,$ as o,X as M,dj as P,h as C,t as S,G,K as I,a0 as K,B,O as A,P as F,ad as D,a4 as V,dk as W,av as q,j as X,e as H,ah as J,ai as Q,aj as Y}from"./index-EW2EHvBZ.js";import{b as Z,c as ee}from"./system-log-Bpi6obMY.js";import{u as te}from"./table-BM2Nndfm.js";import{_ as oe}from"./round-search-BClnDkrh.js";import{_ as ae}from"./round-refresh-CSNTDgt0.js";import{_ as ne}from"./lodash-Tk07mST8.js";import{_ as le}from"./FormItemGridItem-ChlUwwC5.js";import{_ as se}from"./Grid-BSYdqYIk.js";const re=z({name:"LoginlogSearch",__name:"loginlog-search",props:{model:{required:!0},modelModifiers:{}},emits:$(["reset","search"],["update:model"]),setup(m,{expose:b,emit:h}){const y=h,s=E(m,"model");function x(c){s.value.creatorName=c.replace(/\s/g,"")}function N(c){return!c.startsWith(" ")&&!c.endsWith(" ")}function _(){y("reset")}function u(){y("search")}async function w(){const{data:c,error:n}=await Z({creatorName:s.value.creatorName,status:s.value.status});if(!n){let r=c,l=new Blob([r],{type:"application/vnd.ms-excel"}),d=new Date().getTime()+".xls",f=window.webkitURL.createObjectURL(l),i=document.createElement("a");i.href=f,i.download=d,document.body.appendChild(i),i.click(),i.remove()}}const g=ne.throttle(u,1e3,{trailing:!1});return b({handleExportChange:w}),(c,n)=>{const r=I,l=le,d=K,f=ae,i=B,p=oe,v=A,L=se,O=F,T=D;return j(),U(T,{bordered:!1,size:"small",class:"card-wrapper"},{default:a(()=>[t(O,{model:s.value,"label-placement":"left","label-width":80,"show-feedback":!1,onKeyup:G(e(g),["enter"])},{default:a(()=>[t(L,{responsive:"screen","item-responsive":"","x-gap":12,"y-gap":12},{default:a(()=>[t(l,{span:"24 s:12 m:8 l:6",label:e(o)("page.systemlog.login.creatorName"),path:"creatorName"},{default:a(()=>[t(r,{clearable:"",value:s.value.creatorName,"onUpdate:value":n[0]||(n[0]=k=>s.value.creatorName=k),placeholder:e(o)("page.systemlog.login.form.creatorName"),onInput:x,"allow-input":N,onClear:_},null,8,["value","placeholder"])]),_:1},8,["label"]),t(l,{span:"24 s:12 m:8 l:6",label:e(o)("page.systemlog.login.status"),path:"status"},{default:a(()=>[t(d,{filterable:"",clearable:"",value:s.value.status,"onUpdate:value":[n[1]||(n[1]=k=>s.value.status=k),u],placeholder:e(o)("page.systemlog.login.form.status"),options:e(M)(e(P)),onClear:_},null,8,["value","placeholder","options"])]),_:1},8,["label"]),t(l,{span:"24 s:12 m:8 l:6"},{default:a(()=>[t(v,{class:"w-full"},{default:a(()=>[t(i,{onClick:_},{icon:a(()=>[t(f,{class:"text-icon"})]),default:a(()=>[C(" "+S(e(o)("common.reset")),1)]),_:1}),t(i,{type:"primary",ghost:"",onClick:e(g)},{icon:a(()=>[t(p,{class:"text-icon"})]),default:a(()=>[C(" "+S(e(o)("common.search")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","onKeyup"])]),_:1})}}}),ie={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function ce(m){return typeof m=="function"||Object.prototype.toString.call(m)==="[object Object]"&&!Q(m)}const ye=z({name:"logmanage_loginlog",__name:"index",setup(m){const b=V(),{columns:h,columnChecks:y,data:s,getData:x,loading:N,pagination:_,searchParams:u,resetSearchParams:w}=te({apiFn:ee,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,creatorName:null,status:null,_t:new Date().getTime()},columns:()=>[{key:"creatorName",title:o("page.systemlog.login.creatorName"),align:"center",width:160,resizable:!0},{key:"operation",title:o("page.systemlog.login.operation"),width:140,align:"center",render:n=>{const r=n.operation==0?o("page.manage.common.loginStatus.login"):o("page.manage.common.loginStatus.logout");return t("span",null,[r])},resizable:!0},{key:"status",title:o("page.systemlog.login.status"),width:100,align:"center",render:n=>{n.status==null&&(n.status=0);const r={0:"error",1:"success",2:"warning",3:"info",4:"info",5:"error",6:"info",7:"error"},l=o(W[n.status].label);return t(q,{size:"small",type:r[n.status]},ce(l)?l:{default:()=>[l]})},resizable:!0},{key:"ip",title:o("page.systemlog.login.ip"),width:160,align:"center",resizable:!0},{key:"userAgent",title:o("page.systemlog.login.userAgent"),minWidth:400,align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"createDate",title:o("page.systemlog.login.createDate"),width:160,align:"center"}]}),g=X(),c=()=>{g.value.handleExportChange()};return(n,r)=>{const l=R,d=B,f=Y,i=D;return j(),H("div",ie,[t(re,{model:e(u),"onUpdate:model":r[0]||(r[0]=p=>J(u)?u.value=p:null),onReset:e(w),onSearch:e(x),ref_key:"searchRef",ref:g},null,8,["model","onReset","onSearch"]),t(i,{title:e(o)("page.systemlog.login.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":a(()=>[t(d,{type:"info",size:"small",ghost:"",onClick:c},{icon:a(()=>[t(l,{class:"text-icon"})]),default:a(()=>[C(" "+S(e(o)("common.export")),1)]),_:1})]),default:a(()=>[t(f,{columns:e(h),data:e(s),size:"small","flex-height":!e(b).isMobile,"scroll-x":e(h).reduce((p,v)=>p+v.width,0),loading:e(N),remote:"","row-key":p=>p.id,pagination:e(_),class:"sm:h-full"},null,8,["columns","data","flex-height","scroll-x","loading","row-key","pagination"])]),_:1},8,["title"])])}}});export{ye as default};

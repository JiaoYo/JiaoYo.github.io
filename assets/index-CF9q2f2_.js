import{dq as ie,dr as fe,cI as oe,d as R,bX as _e,j as b,b as le,K as j,aI as he,o as f,e as L,f as i,y as T,a0 as B,cx as G,av as F,a7 as ce,c as z,w as m,g as o,t as ve,an as ye,aa as ge,_ as xe,Y as be,E as we,ay as Le,az as ke}from"./index-DU0tn_QU.js";import{u as V}from"./echarts-C7DhkH9N.js";import{L as Se}from"./installCanvasRenderer-iCPGNWhM.js";import{f as Te,a as Ae,b as Ce,c as Ne,d as Ie}from"./home-CbH9h8LN.js";import{a as ze,_ as Re}from"./Grid-CL01GhEs.js";import{_ as Oe}from"./Progress-BdF_wjuc.js";import{_ as De}from"./DataTable-kUpLPqEf.js";import"./Forward-oJtYo3di.js";var re=1/0,$e=17976931348623157e292;function je(t){if(!t)return t===0?t:0;if(t=ie(t),t===re||t===-re){var a=t<0?-1:1;return a*$e}return t===t?t:0}function Fe(t){var a=je(t),r=a%1;return a===a?r?a-r:a:0}var He=fe.isFinite,Me=Math.min;function Pe(t){var a=Math[t];return function(r,s){if(r=ie(r),s=s==null?0:Me(Fe(s),292),s&&He(r)){var d=(oe(r)+"e").split("e"),c=a(d[0]+"e"+(+d[1]+s));return d=(oe(c)+"e").split("e"),+(d[0]+"e"+(+d[1]-s))}return a(r)}}var Be=Pe("round");const Ge=t=>1-Math.pow(1-t,5);function Ve(t){const{from:a,to:r,duration:s,onUpdate:d,onFinish:c}=t,u=()=>{const p=performance.now(),e=Math.min(p-y,s),n=a+(r-a)*Ge(e/s);if(e===s){c();return}d(n),requestAnimationFrame(u)},y=performance.now();u()}const Ee={to:{type:Number,default:0},precision:{type:Number,default:0},showSeparator:Boolean,locale:String,from:{type:Number,default:0},active:{type:Boolean,default:!0},duration:{type:Number,default:2e3},onFinish:Function},Ue=R({name:"NumberAnimation",props:Ee,setup(t){const{localeRef:a}=_e("name"),{duration:r}=t,s=b(t.from),d=le(()=>{const{locale:l}=t;return l!==void 0?l:a.value});let c=!1;const u=l=>{s.value=l},y=()=>{var l;s.value=t.to,c=!1,(l=t.onFinish)===null||l===void 0||l.call(t)},p=(l=t.from,D=t.to)=>{c=!0,s.value=t.from,l!==D&&Ve({from:l,to:D,duration:r,onUpdate:u,onFinish:y})},e=le(()=>{var l;const A=Be(s.value,t.precision).toFixed(t.precision).split("."),N=new Intl.NumberFormat(d.value),E=(l=N.formatToParts(.5).find(x=>x.type==="decimal"))===null||l===void 0?void 0:l.value,h=t.showSeparator?N.format(Number(A[0])):A[0],_=A[1];return{integer:h,decimal:_,decimalSeparator:E}});function n(){c||p()}return j(()=>{he(()=>{t.active&&p()})}),Object.assign({formattedValue:e},{play:n})},render(){const{formattedValue:{integer:t,decimal:a,decimalSeparator:r}}=this;return[t,a?r:null,a]}}),We={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"},qe=i("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 0 1 1-1h16a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1zm0 9h18M8 21h8m-6-4l-.5 4m4.5-4l.5 4"},null,-1),Xe=[qe];function Ye(t,a){return f(),L("svg",We,[...Xe])}const Ke={name:"tabler-device-imac",render:Ye},Je={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"},Qe=i("path",{fill:"currentColor",d:"M4 20V9h4v11zM4 8V4h4v4zm6 12v-8h4v8zm0-9V7h4v4zm6 9v-5h4v5zm0-6v-4h4v4z"},null,-1),Ze=[Qe];function et(t,a){return f(),L("svg",Je,[...Ze])}const tt={name:"material-symbols-stacked-bar-chart",render:et},at=R({name:"LineChart",__name:"collectTrends",props:{collectTrendsList:{type:Object,default:()=>({})}},setup(t){const a=t;T(()=>a.collectTrendsList,async e=>{u()});const r=B(),s=b(null),{domRef:d,updateOptions:c}=V(()=>({tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}},backgroundColor:"#6a7985",textStyle:{color:"rgb(224, 224, 224)"},valueFormatter:function(e){return(e+""!="undefined"?e:"--")+"条"}},grid:{left:"10%",right:"10%",bottom:"10%",top:"5%"},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value",axisLabel:{formatter:"{value}"}},series:[{color:"#1890ff",type:"line",name:"",smooth:!0,emphasis:{focus:"series"},lineStyle:{width:1},areaStyle:{color:new Se(0,0,0,1,[{offset:0,color:"rgba(24, 144, 255,0.3)"},{offset:1,color:"rgba(24, 144, 255,0)"}],!1),shadowColor:"rgba(24, 144, 255,0.9)",shadowBlur:20},data:[],connectNulls:!0}]}));async function u(){await new Promise(e=>{setTimeout(e,1e3)}),c(e=>{var n,g;return e.xAxis.data=(n=a.collectTrendsList)==null?void 0:n.map(l=>l.date),e.series[0].data=(g=a.collectTrendsList)==null?void 0:g.map(l=>l.dailycount),e})}function y(){c((e,n)=>{const g=n();return e.series[0].name=g.series[0].name,e})}async function p(){u()}return T(()=>r.locale,()=>{y()}),p(),j(()=>{s.value=window.setInterval(()=>{console.log("mainHomeLineChart timer")},1e3*60*5)}),G(()=>{s.value!==null&&(clearInterval(s.value),s.value=null)}),(e,n)=>(f(),L("div",{ref_key:"domRef",ref:d,class:"h-220px overflow-hidden"},null,512))}}),nt=F(at,[["__scopeId","data-v-e24412c2"]]),st=R({name:"LineChart",__name:"assetsType",props:{data:{type:Object,default:()=>({})}},setup(t){const a=t;T(()=>a.data,async e=>{u()});const r=B(),s=b(null),{domRef:d,updateOptions:c}=V(()=>({tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{show:!1},grid:{left:"5%",right:"5%",bottom:"2%",top:"5%",containLabel:!0},series:[{type:"pie",selectedMode:"single",radius:[0,"30%"],label:{position:"inner",fontSize:10},labelLine:{show:!1},data:[]},{type:"pie",radius:["45%","60%"],labelLine:{length:30},label:{rich:{a:{color:"#6E7079",lineHeight:22,align:"center"},hr:{borderColor:"#8C8D8E",width:"100%",borderWidth:1,height:0},b:{color:"#4C5058",fontSize:14,fontWeight:"bold",lineHeight:33},per:{color:"#fff",backgroundColor:"#4C5058",padding:[3,4],borderRadius:4}}},data:[]}]}));async function u(){await new Promise(e=>{setTimeout(e,1e3)}),c(e=>{e.series[0].data=Object.keys(a.data).map(g=>({name:g,value:Object.values(a.data[g]).reduce((l,D)=>l+D,0)}));const n=[];return Object.keys(a.data).map(g=>a.data[g]).forEach(g=>{for(let l in g)g.hasOwnProperty(l)&&n.push({name:l,value:g[l]})}),e.series[1].data=n,e})}function y(){c((e,n)=>(n(),e))}async function p(){u()}return T(()=>r.locale,()=>{y()}),p(),j(()=>{s.value=window.setInterval(()=>{console.log("mainHomeLineChart timer")},1e3*60*5)}),G(()=>{s.value!==null&&(clearInterval(s.value),s.value=null)}),(e,n)=>(f(),L("div",{ref_key:"domRef",ref:d,class:"h-220px overflow-hidden"},null,512))}}),ot=F(st,[["__scopeId","data-v-af811bcc"]]),lt=R({name:"LineChart",__name:"LogNums",props:{data:{type:Object,default:()=>({})}},setup(t){const a=t;T(()=>a.data,async e=>{u()});const r=B(),s=b(null),{domRef:d,updateOptions:c}=V(()=>({tooltip:{trigger:"item",formatter:"{b}: {c}条"},xAxis:{type:"value",show:!1},yAxis:{type:"category",data:[]},grid:{left:"3%",right:"10%",bottom:"3%",top:"5%",containLabel:!0},series:[{data:[],type:"bar",label:{show:!0,position:"right"},barWidth:30}]}));async function u(){await new Promise(e=>{setTimeout(e,1e3)}),c(e=>(e.yAxis.data=a.data.map(n=>n.logname),e.series[0].data=a.data.map(n=>n.count),e))}function y(){c((e,n)=>e)}async function p(){u()}return T(()=>r.locale,()=>{y()}),p(),j(()=>{s.value=window.setInterval(()=>{console.log("mainHomeLineChart timer")},1e3*60*5)}),G(()=>{s.value!==null&&(clearInterval(s.value),s.value=null)}),(e,n)=>(f(),L("div",{ref_key:"domRef",ref:d,class:"overflow-hidden",style:ce({height:a.data.length>4?`${a.data.length*50}px`:"200px"})},null,4))}}),rt=F(lt,[["__scopeId","data-v-8a011224"]]),it=R({name:"LineChart",__name:"alarmNums",props:{auditAlertList:{type:Object,default:()=>({})}},setup(t){const a=t;T(()=>a.auditAlertList,async e=>{u()});const r=B(),s=b(null),{domRef:d,updateOptions:c}=V(()=>({tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}},backgroundColor:"#6a7985",textStyle:{color:"rgb(224, 224, 224)"},valueFormatter:function(e){return(e+""!="undefined"?e:"--")+"条"}},xAxis:{type:"category",data:[]},yAxis:{type:"value"},grid:{left:"10%",right:"10%",bottom:"10%",top:"5%"},series:[{data:[],type:"line",smooth:!0}]}));async function u(){await new Promise(e=>{setTimeout(e,1e3)}),c(e=>(e.xAxis.data=a.auditAlertList.map(n=>n.logname),e.series[0].data=a.auditAlertList.map(n=>n.count),e))}function y(){c((e,n)=>(n(),e))}async function p(){u()}return T(()=>r.locale,()=>{y()}),p(),j(()=>{s.value=window.setInterval(()=>{console.log("mainHomeLineChart timer")},1e3*60*5)}),G(()=>{s.value!==null&&(clearInterval(s.value),s.value=null)}),(e,n)=>(f(),L("div",{ref_key:"domRef",ref:d,class:"h-220px overflow-hidden"},null,512))}}),ct=F(it,[["__scopeId","data-v-bf106832"]]),ut=R({name:"LineChart",__name:"securityNums",props:{data:{type:Object,default:()=>({})}},setup(t){const a=t;T(()=>a.data,async e=>{u()});const r=B(),s=b(null),{domRef:d,updateOptions:c}=V(()=>({tooltip:{trigger:"item",formatter:"{b}: {c}条"},xAxis:{type:"value",show:!1},yAxis:{type:"category",data:[]},grid:{left:"3%",right:"10%",bottom:"3%",top:"5%",containLabel:!0},series:[{data:[],type:"bar",label:{show:!0,position:"right"},barWidth:30}]}));async function u(){await new Promise(e=>{setTimeout(e,1e3)}),c(e=>(e.yAxis.data=a.data.map(n=>n.logname),e.series[0].data=a.data.map(n=>n.count),e))}function y(){c((e,n)=>e)}async function p(){u()}return T(()=>r.locale,()=>{y()}),p(),j(()=>{s.value=window.setInterval(()=>{console.log("mainHomeLineChart timer")},1e3*60*5)}),G(()=>{s.value!==null&&(clearInterval(s.value),s.value=null)}),(e,n)=>(f(),L("div",{ref_key:"domRef",ref:d,class:"overflow-hidden",style:ce({height:a.data.length>4?`${a.data.length*50}px`:"200px"})},null,4))}}),dt=F(ut,[["__scopeId","data-v-f13dc3d1"]]),O=t=>(Le("data-v-2eb3ea86"),t=t(),ke(),t),mt={class:"mb-10px"},pt=O(()=>i("span",{class:"font-size-18px"},"磁盘占用率：",-1)),ft={style:{"font-family":"dsdigits","font-size":"2rem","margin-left":"1rem"}},_t=O(()=>i("span",{class:"ml-5px font-size-20px"},"%",-1)),ht={class:"mb-10px"},vt=O(()=>i("span",{class:"font-size-18px"},"内存占用率：",-1)),yt={style:{"font-family":"dsdigits","font-size":"2rem","margin-left":"1rem"}},gt=O(()=>i("span",{class:"ml-5px font-size-20px"},"%",-1)),xt={class:"mb-10px"},bt=O(()=>i("span",{class:"font-size-18px"},"CPU占用率：",-1)),wt={style:{"font-family":"dsdigits","font-size":"2rem","margin-left":"1rem"}},Lt=O(()=>i("span",{class:"ml-5px font-size-20px"},"%",-1)),kt={style:{display:"flex","align-items":"center"}},St={class:"iconClass bg-#faad14"},Tt={class:"w-80% ml-15px"},At={style:{"font-family":"dsdigits","font-size":"2rem","margin-left":"1rem"}},Ct=O(()=>i("span",{class:"ml-10px font-size-20px"},"条",-1)),Nt={style:{display:"flex","align-items":"center"}},It={class:"iconClass bg-#3f8fff"},zt={class:"w-80% ml-15px"},Rt={style:{"font-family":"dsdigits","font-size":"2rem","margin-left":"1rem"}},Ot={class:"ml-15px"},Dt={key:1,class:"w-100% h-100% flex justify-center"},$t={key:1,class:"w-100% h-100% flex justify-center"},jt={key:1,class:"w-100% h-100% flex justify-center",style:{"min-height":"220px"}},Ft={key:1,class:"w-100% h-100% flex justify-center",style:{"min-height":"220px"}},Ht={key:1,class:"w-100% h-100% flex justify-center",style:{"min-height":"220px"}},Mt={key:1,class:"w-100% h-100% flex justify-center",style:{"min-height":"220px"}},Pt=R({name:"home",__name:"index",setup(t){const a=[{label:"近一天",value:0},{label:"近一周",value:1},{label:"近一月",value:2},{label:"近半年",value:3},{label:"近一年",value:4}],r=[{title:"日志源名称",key:"cname"},{title:"状态",key:"enable",width:120,render:h=>o(ye,{type:h.enable==0?"success":"error"},{default:()=>[h.enable==0?"启用":"禁用"]})}],s=b(),d=b(2),c=async()=>{const{data:h,error:_}=await Te({dateType:d.value});_||(s.value=h)};c();const u=b(),y=b(),p=b(2),e=async()=>{const{data:h,error:_}=await Ae({dateType:p.value});_||(y.value=Number(h.total),p.value==3||p.value==4?u.value=h.data.map(x=>(x.date=x.dateStr,x)).sort((x,C)=>{let w=new Date(x.date),k=new Date(C.date);return w-k}):u.value=h.data.sort((x,C)=>{let w=new Date(x.date),k=new Date(C.date);return w-k}))};e();const n=b();(async()=>{const{data:h,error:_}=await Ce();_||(n.value=h)})();const l=b();(async()=>{const{data:h,error:_}=await Ne();_||(l.value=h)})();const A=b(2),N=b(),E=async()=>{const{data:h,error:_}=await Ie({dateType:A.value});_||(N.value=h)};return E(),(h,_)=>{const x=Ue,C=Oe,w=ge,k=ze,ue=tt,de=Ke,$=xe,me=De,U=Re,W=be,pe=we;return f(),z(pe,{vertical:"",size:16},{default:m(()=>[o(U,{"x-gap":16,"y-gap":16,responsive:"screen","item-responsive":""},{default:m(()=>[o(k,{span:"24 s:24 xl:5 m:12"},{default:m(()=>[o(w,{title:"🟢🔴 系统信息",bordered:!0,class:"card-wrapper h-100%","content-style":{padding:"10px 30px"}},{default:m(()=>{var v,S,I,H,M,P,q,X,Y,K,J,Q,Z,ee,te,ae,ne,se;return[i("div",mt,[pt,i("span",ft,[o(x,{ref:"numberAnimationInstRef",from:0,precision:2,to:(I=(S=(v=n.value)==null?void 0:v.systemStatus)==null?void 0:S.disk)==null?void 0:I.replace("%","")},null,8,["to"])]),_t,o(C,{type:"line",percentage:Number((P=(M=(H=n.value)==null?void 0:H.systemStatus)==null?void 0:M.disk)==null?void 0:P.replace("%","")),processing:"","show-indicator":!1},null,8,["percentage"])]),i("div",ht,[vt,i("span",yt,[o(x,{ref:"numberAnimationInstRef",from:0,precision:2,to:(Y=(X=(q=n.value)==null?void 0:q.systemStatus)==null?void 0:X.mem)==null?void 0:Y.replace("%","")},null,8,["to"])]),gt,o(C,{type:"line",percentage:Number((Q=(J=(K=n.value)==null?void 0:K.systemStatus)==null?void 0:J.mem)==null?void 0:Q.replace("%","")),processing:"","show-indicator":!1},null,8,["percentage"])]),i("div",xt,[bt,i("span",wt,[o(x,{ref:"numberAnimationInstRef",from:0,precision:2,to:(te=(ee=(Z=n.value)==null?void 0:Z.systemStatus)==null?void 0:ee.cpu)==null?void 0:te.replace("%","")},null,8,["to"])]),Lt,o(C,{type:"line",percentage:Number((se=(ne=(ae=n.value)==null?void 0:ae.systemStatus)==null?void 0:ne.cpu)==null?void 0:se.replace("%","")),processing:"","show-indicator":!1},null,8,["percentage"])])]}),_:1})]),_:1}),o(k,{span:"24 s:24 xl:5 m:12"},{default:m(()=>[o(w,{title:"📖 日志接收总数",bordered:!0,class:"card-wrapper h-150px"},{default:m(()=>[i("div",kt,[i("div",St,[o(ue,{style:{"font-size":"38px"}})]),i("div",Tt,[i("div",null,[i("span",At,[o(x,{ref:"numberAnimationInstRef",from:0,to:y.value||0},null,8,["to"])]),Ct])])])]),_:1}),o(w,{title:"📖 日志源资产数",bordered:!0,class:"card-wrapper h-150px mt-16px"},{default:m(()=>{var v,S,I,H,M,P;return[i("div",Nt,[i("div",It,[o(de,{style:{"font-size":"32px"}})]),i("div",zt,[i("div",null,[i("span",Rt,[o(x,{ref:"numberAnimationInstRef",from:0,to:(S=(v=n.value)==null?void 0:v.logSourceDevAsset)==null?void 0:S.aunum},null,8,["to"])]),i("span",Ot,"占授权总数"+ve(((H=(I=n.value)==null?void 0:I.logSourceDevAsset)==null?void 0:H.cmnum)||0)+"%",1)]),o(C,{type:"line",percentage:(P=(M=n.value)==null?void 0:M.logSourceDevAsset)==null?void 0:P.cmnum,processing:"","show-indicator":!1},null,8,["percentage"])])])]}),_:1})]),_:1}),o(k,{span:"24 s:24 xl:7 m:12"},{default:m(()=>[o(w,{title:"📖 日志源资产类型",bordered:!0,class:"card-wrapper h-100%"},{default:m(()=>{var v,S;return[n.value&&Object.keys((v=n.value)==null?void 0:v.logSoursceAssetType).length>0?(f(),z(ot,{key:0,data:(S=n.value)==null?void 0:S.logSoursceAssetType},null,8,["data"])):(f(),L("div",Dt,[o($,{icon:"empty","local-icon":"empty",class:"font-size-24 mt-30px"})]))]}),_:1})]),_:1}),o(k,{span:"24 s:24 xl:7 m:12"},{default:m(()=>[o(w,{title:"📖 日志源接收状态",bordered:!0,class:"card-wrapper h-100%",style:{"min-height":"220px"}},{default:m(()=>{var v,S;return[((v=n.value)==null?void 0:v.logSoursceList.length)>0?(f(),z(me,{key:0,columns:r,data:(S=n.value)==null?void 0:S.logSoursceList,size:"small","flex-height":"",bordered:!1,remote:"","row-key":I=>I.id,class:"sm:h-full"},null,8,["data","row-key"])):(f(),L("div",$t,[o($,{icon:"empty","local-icon":"empty",class:"font-size-24 mt-30px"})]))]}),_:1})]),_:1})]),_:1}),o(U,{"x-gap":16,"y-gap":16,responsive:"screen","item-responsive":""},{default:m(()=>[o(k,{span:"24 s:24 m:12"},{default:m(()=>[o(w,{title:"📈 日志采集趋势",bordered:!0,class:"card-wrapper h-100%"},{"header-extra":m(()=>[o(W,{value:p.value,"onUpdate:value":[_[0]||(_[0]=v=>p.value=v),e],options:a,style:{width:"120px"}},null,8,["value"])]),default:m(()=>[u.value&&u.value.length>0?(f(),z(nt,{key:p.value,collectTrendsList:u.value},null,8,["collectTrendsList"])):(f(),L("div",jt,[o($,{icon:"empty","local-icon":"empty",class:"font-size-24 mt-30px"})]))]),_:1})]),_:1}),o(k,{span:"24 s:24 m:12"},{default:m(()=>[o(w,{title:"📈 审计告警数量趋势",bordered:!0,class:"card-wrapper h-100%","content-style":{padding:"10px"}},{"header-extra":m(()=>[o(W,{value:d.value,"onUpdate:value":[_[1]||(_[1]=v=>d.value=v),c],options:a,style:{width:"120px"}},null,8,["value"])]),default:m(()=>[s.value&&s.value.length>0?(f(),z(ct,{key:d.value,auditAlertList:s.value},null,8,["auditAlertList"])):(f(),L("div",Ft,[o($,{icon:"empty","local-icon":"empty",class:"font-size-24 mt-30px"})]))]),_:1})]),_:1})]),_:1}),o(U,{"x-gap":16,"y-gap":16,responsive:"screen","item-responsive":""},{default:m(()=>[o(k,{span:"24 s:24 m:12"},{default:m(()=>[o(w,{title:"📊 日志源日志数量TOP10",bordered:!0,class:"card-wrapper h-100%","content-style":{padding:"10px"}},{default:m(()=>[l.value&&l.value.length>0?(f(),z(rt,{key:0,data:l.value},null,8,["data"])):(f(),L("div",Ht,[o($,{icon:"empty","local-icon":"empty",class:"font-size-24 mt-30px"})]))]),_:1})]),_:1}),o(k,{span:"24 s:24 m:12"},{default:m(()=>[o(w,{title:"📊 安全事件类别数量Top10",bordered:!0,class:"card-wrapper h-100%","content-style":{padding:"10px"}},{"header-extra":m(()=>[o(W,{value:A.value,"onUpdate:value":[_[2]||(_[2]=v=>A.value=v),E],options:a,style:{width:"120px"}},null,8,["value"])]),default:m(()=>[N.value&&N.value.length>0?(f(),z(dt,{key:A.value,data:N.value},null,8,["data"])):(f(),L("div",Mt,[o($,{icon:"empty","local-icon":"empty",class:"font-size-24 mt-30px"})]))]),_:1})]),_:1})]),_:1})]),_:1})}}}),Yt=F(Pt,[["__scopeId","data-v-2eb3ea86"]]);export{Yt as default};

import{_ as J}from"./table-header-operation.vue_vue_type_script_setup_true_lang--4IFtosA.js";import{d as P,q as Q,j as W,v as X,s as Z,L as ee,o as C,c as M,w as e,g as l,M as O,h as a,t as c,i as o,$ as N,f as G,e as K,V as le,aj as ne,O as te,N as ae,A as oe,B as A,E as se,Y as re,D as ie,aa as q,a0 as ce,r as de,an as L,ad as B,ae as ue,S as pe,F as me}from"./index-CsnqqYix.js";import{u as fe,a as _e}from"./table-DKXGjFaF.js";import{f as ve,a as he}from"./vulnerability-W7rsen0S.js";import{_ as ge,a as ye}from"./arrow-open-up-DZwwj0Fs.js";import{_ as be}from"./round-search-Bu5YIN53.js";import{_ as xe}from"./round-refresh-CVNXUoG9.js";import{a as ke,T as j}from"./basicconf-DjOR-3Sx.js";import{_ as we}from"./FormItemGridItem-BZ0daFl2.js";import{_ as Ce}from"./DatePicker-BwPn1mfn.js";import{_ as Ne}from"./Grid-CIi8gyXK.js";import{_ as De}from"./DataTable-Ccx-rOeY.js";import{_ as ze,a as Se}from"./DescriptionsItem-B1gOle2Z.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-B4wbXLYm.js";import"./setting-outlined-1FBO1fGN.js";import"./round-delete-CZv1t4Jg.js";import"./refresh-C3MJ6S6n.js";import"./round-plus-5j-iy1P2.js";import"./Upload-Bxg_YPuN.js";import"./Progress-Dj8cs8I9.js";import"./Popconfirm-CcFzF_n5.js";import"./TimePicker-Uv3oaiPd.js";import"./defineProperty-CbgZ-yqQ.js";import"./Forward-CBubG-vu.js";const Te=P({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:Q(["reset","search"],["update:model"]),setup(v,{emit:z}){const p=z,n=W(!1),{formRef:S,restoreValidation:g}=X(),s=Z(v,"model");function y(){s.value.cnvdnum=void 0,p("search")}function D(){s.value.fuzzy=void 0,p("search")}async function T(k,d){k?(s.value.releStartTime=k[0],s.value.releEndTime=k[1]):(s.value.releStartTime=null,s.value.releEndTime=null),p("search")}async function b(){await g(),s.value.timeRange=null,p("reset")}async function x(){p("search")}return(k,d)=>{const V=oe,h=we,F=xe,_=A,U=be,E=ge,I=ye,R=se,i=Ce,t=re,m=Ne,w=ie,$=q,r=ee("no-space");return C(),M($,{bordered:!1,size:"small",class:"card-wrapper"},{default:e(()=>[l(w,{ref_key:"formRef",ref:S,model:s.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:ae(x,["enter"])},{default:e(()=>[l(m,{responsive:"screen","item-responsive":"","y-gap":20},{default:e(()=>[l(h,{span:"24 s:12 m:8",label:"漏洞编号",path:"cnvdnum",class:"pr-24px"},{default:e(()=>[O(l(V,{clearable:"",value:s.value.cnvdnum,"onUpdate:value":d[0]||(d[0]=u=>s.value.cnvdnum=u),placeholder:"请输入漏洞编号",onClear:y},null,8,["value"]),[[r]])]),_:1}),l(h,{span:"24 s:12 m:8",label:"漏洞名称",path:"fuzzy",class:"pr-24px"},{default:e(()=>[O(l(V,{clearable:"",value:s.value.fuzzy,"onUpdate:value":d[1]||(d[1]=u=>s.value.fuzzy=u),placeholder:"请输入漏洞名称",onClear:D},null,8,["value"]),[[r]])]),_:1}),l(h,{span:"24 m:8",class:"pr-24px"},{default:e(()=>[l(R,{class:"w-full",align:"center"},{default:e(()=>[l(_,{onClick:b},{icon:e(()=>[l(F,{class:"text-icon"})]),default:e(()=>[a(" "+c(o(N)("common.reset")),1)]),_:1}),l(_,{type:"primary",ghost:"",onClick:x},{icon:e(()=>[l(U,{class:"text-icon"})]),default:e(()=>[a(" "+c(o(N)("common.search")),1)]),_:1}),G("div",{class:"cursor-pointer",title:"精准查询",onClick:d[2]||(d[2]=u=>n.value=!n.value)},[n.value?(C(),M(E,{key:0,class:"text-icon"})):(C(),M(I,{key:1,class:"text-icon"}))])]),_:1})]),_:1}),n.value?(C(),K(ne,{key:0},[l(h,{span:"24 s:12 m:8",label:"发布日期",path:"fuzzy",class:"pr-24px"},{default:e(()=>[l(i,{"start-placeholder":"发布开始时间","end-placeholder":"发布结束时间","formatted-value":s.value.timeRange,"onUpdate:formattedValue":[d[3]||(d[3]=u=>s.value.timeRange=u),T],"value-format":"yyyy-MM-dd",type:"daterange",clearable:"",style:{width:"100%"}},null,8,["formatted-value"])]),_:1}),l(h,{span:"24 s:12 m:8",label:"漏洞等级",path:"cnvdlevel",class:"pr-24px"},{default:e(()=>[l(t,{filterable:"",clearable:"",value:s.value.cnvdlevel,"onUpdate:value":[d[4]||(d[4]=u=>s.value.cnvdlevel=u),x],placeholder:"请选择漏洞等级",options:o(le)(o(ke))},null,8,["value","options"])]),_:1})],64)):te("",!0)]),_:1})]),_:1},8,["model"])]),_:1})}}}),Ve={class:"min-h-500px flex-col-stretch gap-16px overflow-auto lt-sm:overflow-auto"},Re=G("hr",{style:{"border-color":"#ccc","margin-bottom":"20px"}},null,-1);function $e(v){return typeof v=="function"||Object.prototype.toString.call(v)==="[object Object]"&&!ue(v)}const tl=P({name:"knowledgebase_cnvdvulnerabilitylibrary",__name:"index",setup(v){const z=ce(),p=W(!1),n=de({cnvdnum:"",cnvdname:"",cnvdlevel:0,identiy:"",releasedate:"",relthreats:"",affectedproducts:"",cnvddesc:"",refer:"",authinfo:"",solution:""}),{columns:S,columnChecks:g,data:s,getData:y,loading:D,mobilePagination:T,searchParams:b,resetSearchParams:x}=fe({apiFn:ve,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,cnvdnum:null,cnvdlevel:null,releStartTime:null,releEndTime:null,fuzzy:null,_t:new Date().getTime()},columns:()=>[{key:"cnvdnum",title:"漏洞编号",align:"center",minWidth:180,fixed:"left",ellipsis:{tooltip:!0}},{key:"cnvdname",title:"漏洞名称",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"cnvdlevel",title:"漏洞等级",align:"center",width:100,render:i=>{(i.cnvdlevel===null||i.cnvdlevel===void 0)&&(i.cnvdlevel=0);const t={0:"#8e9dff",1:"#5da8ff",2:"#fedc69",3:"#ff9874",4:"#ff0000"},m=N(j[i.cnvdlevel]);let w={color:t[i.cnvdlevel],textColor:"#ffffff",borderColor:t[i.cnvdlevel]};return l(L,{size:"small",color:w},$e(m)?m:{default:()=>[m]})}},{key:"affectedproducts",title:"受影响产品",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"releasedate",title:"发布日期",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"cnvddesc",title:"描述",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"operate",title:N("common.operate"),align:"center",width:80,fixed:"right",render:i=>l("div",{class:"flex-center gap-8px"},[l(A,{type:"primary",ghost:!0,size:"small",onClick:()=>R(i)},{default:()=>[a("详情")]})])}]}),{drawerVisible:k,operateType:d,editingData:V,handleAdd:h,handleEdit:F,checkedRowKeys:_,onBatchDeleted:U,onDeleted:E,closeDrawer:I}=_e(s,y);async function R(i){const{data:t,error:m}=await he({id:i.id});m||(n.cnvdnum=t.cnvdnum,n.cnvdname=t.cnvdname,n.cnvdlevel=t.cnvdlevel||0,n.identiy=t.identiy,n.releasedate=t.releasedate,n.relthreats=t.relthreats,n.affectedproducts=t.affectedproducts,n.cnvddesc=t.cnvddesc,n.refer=t.refer,n.authinfo=t.authinfo,n.solution=t.solution,p.value=!0)}return(i,t)=>{const m=J,w=De,$=q,r=ze,u=Se,H=pe,Y=me;return C(),K("div",Ve,[l(Te,{model:o(b),"onUpdate:model":t[0]||(t[0]=f=>B(b)?b.value=f:null),onReset:o(x),onSearch:o(y)},null,8,["model","onReset","onSearch"]),l($,{title:"CNVD漏洞库",bordered:!1,size:"small",class:"sm:flex-1-hidden"},{"header-extra":e(()=>[l(m,{columns:o(g),"onUpdate:columns":t[1]||(t[1]=f=>B(g)?g.value=f:null),"disabled-delete":o(_).length===0,loading:o(D),onRefresh:o(y)},null,8,["columns","disabled-delete","loading","onRefresh"])]),default:e(()=>[l(w,{"checked-row-keys":o(_),"onUpdate:checkedRowKeys":t[2]||(t[2]=f=>B(_)?_.value=f:null),columns:o(S),data:o(s),size:"small","flex-height":!o(z).isMobile,"scroll-x":962,loading:o(D),remote:"","row-key":f=>f.id,pagination:o(T),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1}),l(Y,{show:p.value,"onUpdate:show":t[3]||(t[3]=f=>p.value=f),title:"CNVD漏洞库详情",preset:"card",class:"w-800px"},{default:e(()=>[Re,l(H,{class:"h-480px pr-20px"},{default:e(()=>[l(u,{"label-placement":"left",bordered:"",column:1},{default:e(()=>[l(r,null,{label:e(()=>[a(" 漏洞编号 ")]),default:e(()=>[a(" "+c(n.cnvdnum),1)]),_:1}),l(r,null,{label:e(()=>[a(" 漏洞名称 ")]),default:e(()=>[a(" "+c(n.cnvdname),1)]),_:1}),l(r,null,{label:e(()=>[a(" 漏洞等级 ")]),default:e(()=>[l(o(L),{color:{textColor:"#ffffff",borderColor:n.cnvdlevel===0?"#8e9dff":n.cnvdlevel===1?"#5da8ff":n.cnvdlevel===2?"#fedc69":n.cnvdlevel===3?"#ff9874":n.cnvdlevel===4?"#ff0000":"#5da8ff",color:n.cnvdlevel===0?"#8e9dff":n.cnvdlevel===1?"#5da8ff":n.cnvdlevel===2?"#fedc69":n.cnvdlevel===3?"#ff9874":n.cnvdlevel===4?"#ff0000":"#5da8ff"}},{default:e(()=>[a(c(o(N)(o(j)[n.cnvdlevel])),1)]),_:1},8,["color"])]),_:1}),l(r,null,{label:e(()=>[a(" 相关标识 ")]),default:e(()=>[a(" "+c(n.identiy),1)]),_:1}),l(r,null,{label:e(()=>[a(" 发布日期 ")]),default:e(()=>[a(" "+c(n.releasedate),1)]),_:1}),l(r,null,{label:e(()=>[a(" 相关威胁 ")]),default:e(()=>[a(" "+c(n.relthreats),1)]),_:1}),l(r,null,{label:e(()=>[a(" 受影响产品 ")]),default:e(()=>[a(" "+c(n.affectedproducts),1)]),_:1}),l(r,null,{label:e(()=>[a(" 描述 ")]),default:e(()=>[a(" "+c(n.cnvddesc),1)]),_:1}),l(r,null,{label:e(()=>[a(" 参考 ")]),default:e(()=>[a(" "+c(n.refer),1)]),_:1}),l(r,null,{label:e(()=>[a(" 认证信息 ")]),default:e(()=>[a(" "+c(n.authinfo),1)]),_:1}),l(r,null,{label:e(()=>[a(" 解决方案 ")]),default:e(()=>[a(" "+c(n.solution),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])])}}});export{tl as default};

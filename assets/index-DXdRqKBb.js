import{_ as Ge}from"./table-column-setting.vue_vue_type_script_setup_true_lang-uXm8mfun.js";import{_ as Je}from"./round-delete-BINue5nP.js";import{_ as Ke}from"./round-add-qbOrVMgk.js";import{d as Ce,au as Te,q as De,v as We,r as G,s as ze,a as Ze,av as Ue,Z as Pe,c as D,o as f,w as t,f as e,aa as Qe,G as qe,z as C,h as o,aw as le,C as O,b as I,g as p,e as _,t as c,bt as Xe,B as S,ae as Ye,N as xe,$ as J,ax as Re,c4 as et,a0 as ye,c5 as tt,c3 as at,c6 as Ie,c7 as $e,c8 as lt,a6 as Le,c9 as Be,F as nt,U as Me,M as st,i as ot,y as Z,aB as _e,ac as rt,D as H,ab as it,a9 as ut,aE as ge,ca as Se,cb as dt,aF as pt}from"./index-BvFB2cuj.js";import{u as ct,a as ft}from"./table-BGg3LzBr.js";import{u as be}from"./usePageData-CTXHmZzP.js";import{u as mt}from"./upload-CT8RYFR7.js";import{_ as Oe}from"./Grid-Y7np-iXa.js";import{_ as Fe}from"./FormItemGridItem-hipcXcB6.js";import{N as gt}from"./DatePicker-DpVzl5o9.js";import{_ as vt}from"./round-search-Nrgthioa.js";import{_ as yt}from"./round-refresh-BjvpCeMo.js";import{_ as bt,a as _t}from"./DescriptionsItem-CiP4xV4S.js";import{N as ve}from"./Popconfirm-1kDZsQG6.js";import{N as ht}from"./RadioButton-BdB-fRS6.js";import"./v4-FuVw324d.js";const kt={key:0,style:{"margin-left":"20px"}},wt={key:0,style:{"margin-left":"20px"}},Tt={key:0,style:{"margin-left":"20px"}},Ct={key:0,style:{"margin-left":"20px"}},Dt=Ce({name:"OperateDrawer",__name:"operate-drawer",props:Te({operateType:{},rowData:{},pid:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:Te(["submitted"],["update:visible"]),setup(L,{emit:ne}){const z=ne,x=De(),y=L,a=We(F());function F(){return{pid:void 0,id:"",debugname:"",docker:void 0,dockcharge:"",dockcontact:"",status:0,notes:"",debugresult:0,dtype:void 0,starttime:null,endtime:null,dbcreater:void 0,startAndTimeRange:void 0,re1:"",re2:"",re3:"",re4:"",fl1:"",fl2:"",fl3:"",fl4:""}}const{pageData:B,getData:m,nextPage:U}=be(et),$=async()=>{await m({usertypes:"2,3"})},K=async r=>{const l=r.currentTarget,s=l.scrollTop;l.scrollTop+l.offsetHeight>=l.scrollHeight&&B.data.length<B.total&&(await U(),await ye(),setTimeout(()=>{l.scrollTop=s}))},{pageData:k,getData:W,nextPage:se}=be(tt),oe=async r=>{const l=r.currentTarget,s=l.scrollTop;l.scrollTop+l.offsetHeight>=l.scrollHeight&&k.data.length<k.total&&(await se(),await ye(),setTimeout(()=>{l.scrollTop=s}))},re=async()=>{await W({pid:a.pid})},ie=async r=>{if(a.docker=r,a.docker){const l=k.data.find(s=>s.docker===a.docker);l?(a.dockcharge=l.pname,a.dockcontact=l.pcontact):(a.dockcharge="",a.dockcontact="")}},{pageData:P,getData:Q,nextPage:ue}=be(at),de=async r=>{const l=r.currentTarget,s=l.scrollTop;l.scrollTop+l.offsetHeight>=l.scrollHeight&&P.data.length<P.total&&(await ue(),await ye(),setTimeout(()=>{l.scrollTop=s}))},X=async()=>{await Q()},b=G([]),{pageData:g,getData:q,nextPage:A}=be(Ie),E=async r=>{const l=r.currentTarget,s=l.scrollTop;l.scrollTop+l.offsetHeight>=l.scrollHeight&&g.data.length<g.total&&(await A(),b.value=g.data,await ye(),setTimeout(()=>{l.scrollTop=s}))},Y=async()=>{await q({fuzzy:x.userInfo.pname,page:1}),b.value=g.data},ee=async()=>{await q({page:1}),b.value=g.data},pe=async r=>{a.pid=r},ce=G(void 0);async function fe(){var r;Y(),X(),$(),Object.assign(a,F()),y.operateType==="add"&&(a.pid=Number(y.pid)),y.operateType==="edit"&&y.rowData&&(Object.assign(a,y.rowData),ce.value=a.status,a.docker=(r=a.docker)==null?void 0:r.split("&id=")[0],y.rowData.starttime&&y.rowData.endtime?a.startAndTimeRange=[y.rowData.starttime,y.rowData.endtime]:a.startAndTimeRange=null),re()}const{formRef:d,validate:V,restoreValidation:M}=ze(),i={pid:{type:"number",required:!0,trigger:["blur","change"],message:"请选择"},dtype:{type:"number",required:!0,trigger:["blur","change"],message:"请选择"},dbcreater:{type:"string",required:!0,trigger:["blur","change"],message:"请选择"},debugname:{type:"string",required:!0,trigger:["blur","change"],message:"请输入"},docker:{type:"string",required:!0,trigger:["blur","change"],message:"请输入"},dockcharge:{type:"string",required:!0,trigger:["blur","change"],message:"请输入"},dockcontact:{type:"string",required:!0,trigger:["blur","change"],message:"请输入"},status:{type:"number",required:!0,trigger:["blur","change"],message:"请选择"}},n=Ze(()=>({add:"新增待调试业务",edit:"修改待调试业务"})[y.operateType]),T=Ue(L,"visible");Pe(T,()=>{T.value&&(fe(),setTimeout(()=>{const r=document.querySelector(".n-scrollbar-content");r==null||r.scrollTo(0,0)},300),M())});const v=G(0),h=G("");async function te({file:r},l){v.value=0,h.value=l;const s=await mt(r.file,r.name,"",j=>{v.value=j});s&&(a[l]=s,v.value=0)}function me(){T.value=!1}async function ae(r){if(r)try{const s=await(await fetch(r==null?void 0:r.split("?")[0],{mode:"cors"})).blob(),j=URL.createObjectURL(s),R=document.createElement("a");R.href=j,R.download=r==null?void 0:r.split("?")[1],R.style.display="none",document.body.appendChild(R),R.click(),document.body.removeChild(R),URL.revokeObjectURL(j)}catch(l){console.error("下载失败:",l)}}async function he(){var r;await V(),(r=window.$dialog)==null||r.info({title:"提示",content:"确定提交吗？",positiveText:"确定",negativeText:"取消",onPositiveClick:async()=>{await ke()}})}async function ke(){var r,l;if(await V(),y.operateType==="edit"){const s=JSON.parse(JSON.stringify(a)),{data:j,error:R}=await $e([s]);R||(me(),z("submitted"),(r=window.$message)==null||r.success("修改成功"))}else{const{data:s,error:j}=await lt([{...a}]);j||(me(),z("submitted"),(l=window.$message)==null||l.success("添加成功"))}}const w=r=>{var l;a.debugname=(l=P.data.find(s=>s.id==r))==null?void 0:l.tname,a.dtype=r};async function we(r,l){a.startAndTimeRange=r,a.starttime=r==null?void 0:r[0],a.endtime=r==null?void 0:r[1]}return(r,l)=>{const s=Fe,j=Xe,R=Ye,Ne=Oe,Ae=qe,Ee=Qe,Ve=xe,He=Re;return f(),D(He,{show:T.value,"onUpdate:show":l[22]||(l[22]=u=>T.value=u),title:n.value,preset:"card",class:"w-800px"},{footer:t(()=>[e(Ve,{justify:"end",size:16},{default:t(()=>[e(o(S),{onClick:me},{default:t(()=>[p(c(o(J)("common.cancel")),1)]),_:1}),e(o(S),{type:"primary",onClick:he},{default:t(()=>[p(c(o(J)("common.confirm")),1)]),_:1})]),_:1})]),default:t(()=>[e(Ee,{class:"pr-20px"},{default:t(()=>[e(Ae,{ref_key:"formRef",ref:d,model:a,rules:i,"label-placement":"left","label-width":120},{default:t(()=>[e(Ne,{responsive:"screen","item-responsive":""},{default:t(()=>[e(s,{span:"24 m:12",label:"项目列表",path:"pid"},{default:t(()=>[e(o(le),{filterable:"",clearable:"",value:a.pid,"onUpdate:value":[l[0]||(l[0]=u=>a.pid=u),pe],placeholder:"请选择项目","label-field":"proname","value-field":"id",onClear:ee,options:b.value,onScroll:E},null,8,["value","options"])]),_:1}),e(s,{span:"24 m:12",label:"权重",path:"dtype"},{default:t(()=>[e(o(le),{filterable:"",value:a.dtype,"onUpdate:value":[l[1]||(l[1]=u=>a.dtype=u),w],tag:"",placeholder:"请选择权重","label-field":"tname","value-field":"id",options:o(P).data,onScroll:de},null,8,["value","options"])]),_:1}),e(s,{span:"24 m:12",label:"业务名称",path:"debugname"},{default:t(()=>[e(o(O),{value:a.debugname,"onUpdate:value":l[2]||(l[2]=u=>a.debugname=u),placeholder:"请输入"},null,8,["value"])]),_:1}),e(s,{span:"24 m:12",label:"调试人",path:"dbcreater"},{default:t(()=>[e(o(le),{filterable:"",value:a.dbcreater,"onUpdate:value":l[3]||(l[3]=u=>a.dbcreater=u),placeholder:"请选择调试人","label-field":"username","value-field":"id",options:o(B).data,onScroll:K},null,8,["value","options"])]),_:1}),e(s,{span:"24 m:24",label:"起止时间",path:"startAndTimeRange"},{default:t(()=>[e(o(gt),{clearable:"",value:a.startAndTimeRange,"onUpdate:value":l[4]||(l[4]=u=>a.startAndTimeRange=u),type:"daterange","value-format":"yyyy-MM-dd",style:{width:"100%"},"onUpdate:formattedValue":we},null,8,["value"])]),_:1}),e(s,{span:"24 m:12",label:"对接方",path:"docker"},{default:t(()=>[e(o(le),{filterable:"",value:a.docker,"onUpdate:value":[l[5]||(l[5]=u=>a.docker=u),ie],clearable:"",tag:"",placeholder:"请选择或输入对接方","label-field":"docker","value-field":"docker",options:o(k).data,onScroll:oe},null,8,["value","options"])]),_:1}),e(s,{span:"24 m:12",label:"对接方负责人",path:"dockcharge"},{default:t(()=>[e(o(O),{value:a.dockcharge,"onUpdate:value":l[6]||(l[6]=u=>a.dockcharge=u),placeholder:"请输入",style:{width:"100%"}},null,8,["value"])]),_:1}),e(s,{span:"24 m:12",label:"联系方式",path:"dockcontact"},{default:t(()=>[e(o(O),{value:a.dockcontact,"onUpdate:value":l[7]||(l[7]=u=>a.dockcontact=u),placeholder:"请输入",style:{width:"100%"}},null,8,["value"])]),_:1}),y.operateType=="edit"?(f(),D(s,{key:0,span:"24 m:12",label:"状态",path:"status"},{default:t(()=>[e(o(le),{clearable:"",value:a.status,"onUpdate:value":l[8]||(l[8]=u=>a.status=u),placeholder:"请选择",options:o(x).userInfo.usertype==0||o(x).userInfo.usertype==2?[{label:"待调试",value:0},{label:"开始调试",value:1},{label:"完成调试",value:2},{label:"审核完成",value:3}]:[{label:"待调试",value:0},{label:"开始调试",value:1},{label:"完成调试",value:2}]},null,8,["value","options"])]),_:1})):C("",!0),e(s,{span:"24 m:12",label:"备注",path:"notes"},{default:t(()=>[e(o(O),{value:a.notes,"onUpdate:value":l[9]||(l[9]=u=>a.notes=u),placeholder:"请输入"},null,8,["value"])]),_:1}),e(s,{span:"24 m:24",label:"",path:"notes","show-feedback":!1},{default:t(()=>[e(Ne,{responsive:"screen","item-responsive":""},{default:t(()=>[e(s,{span:"24 m:12",label:"附件1",path:"notes"},{default:t(()=>[e(o(O),{value:a.re1,"onUpdate:value":l[10]||(l[10]=u=>a.re1=u),placeholder:"请输入",style:{width:"250px"}},null,8,["value"])]),_:1}),e(s,{span:"24 m:12",label:"",path:"notes"},{default:t(()=>{var u;return[a.fl1?(f(),I("span",kt,[p(c((u=a.fl1)==null?void 0:u.split("?")[1])+" ",1),_("span",{class:"cursor-pointer c-#c92a2a",onClick:l[11]||(l[11]=N=>a.fl1="")},"删除"),_("span",{class:"cursor-pointer c-#1890ff ml-5px inline-block",onClick:l[12]||(l[12]=N=>ae(a.fl1))},"下载")])):(f(),D(j,{key:1,style:{width:"auto","margin-left":"20px"},ref:"uploadRef",action:"#","custom-request":N=>te(N,"fl1"),"show-file-list":!1},{default:t(()=>[e(o(S),{loading:v.value>0&&!a.fl1&&h.value=="fl1",size:"small",ghost:"",type:"primary"},{default:t(()=>[p(c(v.value>0&&!a.fl1&&h.value=="fl1"?"上传中":"选择文件"),1)]),_:1},8,["loading"])]),_:1},8,["custom-request"])),v.value&&!a.fl1&&h.value=="fl1"?(f(),D(R,{key:2,type:"line",percentage:v.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):C("",!0)]}),_:1})]),_:1})]),_:1}),e(s,{span:"24 m:12",label:"附件2",path:"notes"},{default:t(()=>[e(o(O),{value:a.re2,"onUpdate:value":l[13]||(l[13]=u=>a.re2=u),placeholder:"请输入",style:{width:"250px"}},null,8,["value"])]),_:1}),e(s,{span:"24 m:12",label:"",path:"notes"},{default:t(()=>{var u;return[a.fl2?(f(),I("span",wt,[p(c((u=a.fl2)==null?void 0:u.split("?")[1])+" ",1),_("span",{class:"cursor-pointer c-#c92a2a",onClick:l[14]||(l[14]=N=>a.fl2="")},"删除"),_("span",{class:"cursor-pointer c-#1890ff ml-5px inline-block",onClick:l[15]||(l[15]=N=>ae(a.fl2))},"下载")])):(f(),D(j,{key:1,style:{width:"auto","margin-left":"20px"},ref:"uploadRef",action:"#","custom-request":N=>te(N,"fl2"),"show-file-list":!1},{default:t(()=>[e(o(S),{loading:v.value>0&&!a.fl2&&h.value=="fl2",size:"small",ghost:"",type:"primary"},{default:t(()=>[p(c(v.value>0&&!a.fl2&&h.value=="fl2"?"上传中":"选择文件"),1)]),_:1},8,["loading"])]),_:1},8,["custom-request"])),v.value&&!a.fl2&&h.value=="fl2"?(f(),D(R,{key:2,type:"line",percentage:v.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):C("",!0)]}),_:1}),e(s,{span:"24 m:12",label:"附件3",path:"notes"},{default:t(()=>[e(o(O),{value:a.re3,"onUpdate:value":l[16]||(l[16]=u=>a.re3=u),placeholder:"请输入",style:{width:"250px"}},null,8,["value"])]),_:1}),e(s,{span:"24 m:12",label:"",path:"notes"},{default:t(()=>{var u;return[a.fl3?(f(),I("span",Tt,[p(c((u=a.fl3)==null?void 0:u.split("?")[1])+" ",1),_("span",{class:"cursor-pointer c-#c92a2a",onClick:l[17]||(l[17]=N=>a.fl3="")},"删除"),_("span",{class:"cursor-pointer c-#1890ff ml-5px inline-block",onClick:l[18]||(l[18]=N=>ae(a.fl3))},"下载")])):(f(),D(j,{key:1,style:{width:"auto","margin-left":"20px"},ref:"uploadRef",action:"#","custom-request":N=>te(N,"fl3"),"show-file-list":!1},{default:t(()=>[e(o(S),{loading:v.value>0&&!a.fl3&&h.value=="fl3",size:"small",ghost:"",type:"primary"},{default:t(()=>[p(c(v.value>0&&!a.fl3&&h.value=="fl3"?"上传中":"选择文件"),1)]),_:1},8,["loading"])]),_:1},8,["custom-request"])),v.value&&!a.fl3&&h.value=="fl3"?(f(),D(R,{key:2,type:"line",percentage:v.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):C("",!0)]}),_:1}),e(s,{span:"24 m:12",label:"附件4",path:"notes"},{default:t(()=>[e(o(O),{value:a.re4,"onUpdate:value":l[19]||(l[19]=u=>a.re4=u),placeholder:"请输入",style:{width:"250px"}},null,8,["value"])]),_:1}),e(s,{span:"24 m:12",label:"",path:"notes"},{default:t(()=>{var u;return[a.fl4?(f(),I("span",Ct,[p(c((u=a.fl2)==null?void 0:u.split("?")[1])+" ",1),_("span",{class:"cursor-pointer c-#c92a2a",onClick:l[20]||(l[20]=N=>a.fl4="")},"删除"),_("span",{class:"cursor-pointer c-#1890ff ml-5px inline-block",onClick:l[21]||(l[21]=N=>ae(a.fl4))},"下载")])):(f(),D(j,{key:1,style:{width:"auto","margin-left":"20px"},ref:"uploadRef",action:"#","custom-request":N=>te(N,"fl4"),"show-file-list":!1},{default:t(()=>[e(o(S),{loading:v.value>0&&!a.fl4&&h.value=="fl4",size:"small",ghost:"",type:"primary"},{default:t(()=>[p(c(v.value>0&&!a.fl4&&h.value=="fl4"?"上传中":"选择文件"),1)]),_:1},8,["loading"])]),_:1},8,["custom-request"])),v.value&&!a.fl4&&h.value=="fl4"?(f(),D(R,{key:2,type:"line",percentage:v.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):C("",!0)]}),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show","title"])}}}),xt=Ce({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:Te(["reset","search","search1","clear"],["update:model"]),setup(L,{emit:ne}){const z=Le(),x=Be(),y=ne,a=De(),{formRef:F,restoreValidation:B}=ze(),m=Ue(L,"model"),U=G([]),{pageData:$,getData:K,nextPage:k}=be(Ie),W=async b=>{const g=b.currentTarget,q=g.scrollTop;g.scrollTop+g.offsetHeight>=g.scrollHeight&&$.data.length<$.total&&(await k(),U.value=$.data,await ye(),setTimeout(()=>{g.scrollTop=q}))},se=async b=>{var g;b?(m.value.pid=b,y("search1"),a.setProjectInfo({pname:(g=U.value.find(q=>q.id==b))==null?void 0:g.proname,pid:b})):y("clear")},oe=async b=>{await K({fuzzy:b,page:1}),U.value=$.data},re=async()=>{await K({page:1}),U.value=$.data,y("search1")},ie=async b=>{m.value.status=b,y("search1")},P=async()=>{m.value.status=null},Q=async()=>{var b,g;await K({fuzzy:x.query.pname?x.query.pname:a.userInfo.pname}),U.value=$.data,m.value.pid=x.query.prjId?Number(x.query.prjId):a.userInfo.pid?a.userInfo.pid:(b=U.value[0])==null?void 0:b.id,a.setProjectInfo({pid:m.value.pid,pname:(g=U.value.find(q=>q.id==m.value.pid))==null?void 0:g.proname}),y("search"),setTimeout(()=>{z.replace({path:x.path,query:{}})},1e3)};Q();async function ue(){await B(),m.value.fuzzy="",m.value.pid=null,m.value.status=null,y("reset")}const de=()=>{m.value.fuzzy="",y("search")};async function X(){y("search")}return Pe(()=>x.query,b=>{b.pname&&Q()}),(b,g)=>{const q=le,A=Fe,E=O,Y=yt,ee=S,pe=vt,ce=xe,fe=Oe,d=qe,V=Me;return f(),D(V,{bordered:!1,size:"small",class:"card-wrapper"},{default:t(()=>[e(d,{ref_key:"formRef",ref:F,model:m.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:nt(X,["enter"])},{default:t(()=>[e(fe,{responsive:"screen","item-responsive":"","x-gap":16,"y-gap":16},{default:t(()=>[e(A,{span:"24 s:12 m:6",label:"项目列表",path:"pid"},{default:t(()=>[e(q,{filterable:"",clearable:"",value:m.value.pid,"onUpdate:value":[g[0]||(g[0]=M=>m.value.pid=M),se],placeholder:"请选择项目","label-field":"proname","value-field":"id",onClear:re,onSearch:oe,options:U.value,onScroll:W},null,8,["value","options"])]),_:1}),e(A,{span:"24 s:12 m:6",label:"状态",path:"status"},{default:t(()=>[e(q,{clearable:"",filterable:"",value:m.value.status,"onUpdate:value":[g[1]||(g[1]=M=>m.value.status=M),ie],placeholder:"请选择状态",onClear:P,options:[{label:"待调试",value:0},{label:"开始调试",value:1},{label:"完成调试(待审核)",value:2},{label:"审核完成",value:3}]},null,8,["value"])]),_:1}),e(A,{span:"24 s:12 m:6",label:"业务名称",path:"fuzzy"},{default:t(()=>[e(E,{value:m.value.fuzzy,"onUpdate:value":g[2]||(g[2]=M=>m.value.fuzzy=M),placeholder:"请输入",clearable:"",onClear:de},null,8,["value"])]),_:1}),e(A,{span:"24  s:12 m:6",class:"pr-24px"},{default:t(()=>[e(ce,{class:"w-full"},{default:t(()=>[e(ee,{onClick:ue},{icon:t(()=>[e(Y,{class:"text-icon"})]),default:t(()=>[p(" "+c(o(J)("common.reset")),1)]),_:1}),e(ee,{type:"primary",ghost:"",onClick:X},{icon:t(()=>[e(pe,{class:"text-icon"})]),default:t(()=>[p(" "+c(o(J)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),Nt={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},St={key:0},jt={key:1},zt={key:0},Ut={key:1},Pt={key:0},qt={key:1},Rt={key:0},It={key:1};function je(L){return typeof L=="function"||Object.prototype.toString.call(L)==="[object Object]"&&!pt(L)}const Xt=Ce({name:"projectmanagement_business",__name:"index",setup(L){const ne=st(),z=De(),x=Be(),y=Le(),{columns:a,columnChecks:F,data:B,getData:m,loading:U,pagination:$,mobilePagination:K,searchParams:k}=ct({showTotal:!0,immediate:!1,apiFn:dt,apiParams:{page:1,pageSize:20,limit:20,fuzzy:"",status:null,dbcreater:void 0,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48},{key:"debugname",title:"业务名称",align:"center",width:180},{key:"proname",title:"所属项目",align:"center",width:180,render(i){return e("span",{class:"cursor-pointer",onClick:()=>de(i)},[i.proname])}},{key:"docker",title:"对接方",align:"center",width:120,render:i=>{var n;return e("span",null,[(n=i.docker)==null?void 0:n.split("&id=")[0]])}},{key:"dockcharge",title:"对接方负责人",align:"center",width:120},{key:"dockcontact",title:"联系方式",align:"center",width:120},{key:"status",title:"状态",align:"center",width:120,render(i){return e(ge,{type:i.status==0?"info":i.status==1||i.status==2?"warning":"success"},{default:()=>[i.status==0?"待调试":i.status==1?"开始调试":i.status==2?"完成调试":"审核完成"]})}},{key:"dbusername",title:"调试人",align:"center",width:120},{key:"notes",title:"备注",align:"center",width:120},{key:"ckusername",title:"审核人",align:"center",width:120},{key:"ckdbtime",title:"审核时间",align:"center",width:180},{key:"dbusername",title:"调试人",align:"center",width:120},{key:"dbdbtime",title:"调试时间",align:"center",width:180},{key:"username",title:"创建人",align:"center",width:120},{key:"dbtime",title:"创建时间",align:"center",width:180},{key:"operate",title:J("common.operate"),align:"center",width:280,fixed:"right",render:i=>{let n;return e("div",{class:"flex-center gap-8px"},[i.status==0&&i.dbcreater==z.userInfo.id&&e(ve,{onPositiveClick:()=>g(i,1)},{default:()=>"确定开始调试吗？",trigger:()=>H(e(S,{type:"success",ghost:!0,size:"small"},{default:()=>["开始"]}),[[Z("no-auth"),"project:Debug:update"]])}),i.status==1&&i.dbcreater==z.userInfo.id&&e(ve,{onPositiveClick:()=>g(i,2)},{default:()=>"确定完成调试？",trigger:()=>H(e(S,{type:"success",ghost:!0,size:"small"},{default:()=>["完成"]}),[[Z("no-auth"),"project:Debug:update"]])}),i.status==2&&(z.userInfo.usertype==0||z.userInfo.usertype==2)&&e(ve,{onPositiveClick:()=>g(i,3)},{default:()=>"是否确认执行审核操作？",trigger:()=>H(e(S,{type:"warning",ghost:!0,size:"small"},{default:()=>["审核"]}),[[Z("no-auth"),"project:Debug:update"]])}),H(e(S,{type:"primary",ghost:!0,size:"small",onClick:()=>M(i)},{default:()=>[p("详情")]}),[[Z("no-auth"),"project:Debug:select"]]),H(e(S,{type:"primary",ghost:!0,size:"small",onClick:()=>q(i.id)},je(n=J("common.edit"))?n:{default:()=>[n]}),[[Z("no-auth"),"project:Debug:update"]]),e(ve,{onPositiveClick:()=>b(i.id)},{default:()=>J("common.confirmDelete"),trigger:()=>{let T;return H(e(S,{type:"error",ghost:!0,size:"small"},je(T=J("common.delete"))?T:{default:()=>[T]}),[[Z("no-auth"),"project:Debug:delete"]])}})])}}]}),{drawerVisible:W,operateType:se,editingData:oe,handleAdd:re,handleEdit:ie,checkedRowKeys:P,onBatchDeleted:Q,onDeleted:ue}=ft(B,m);ot(async()=>{});const de=i=>{z.setProjectInfo({pid:i.pid,pname:i.proname}),y.push("/projectmanagement/orderdetail?prjId="+i.pid+`&pname=${i.proname}&IsScroll=1`)};async function X(){console.log(P.value),A(P.value.join(","),i=>{Q()})}async function b(i){const{data:n,error:T}=await Se(i,k.pid);T||ue()}const g=async(i,n)=>{var h;const{data:T,error:v}=await $e([{id:i.id,status:n,pid:i.pid}]);v||((h=window.$message)==null||h.success("操作成功"),m(),n==3?window.dispatchEvent(new CustomEvent("clearReview")):window.dispatchEvent(new CustomEvent("refreshTodo")))};function q(i){ie(i)}async function A(i,n){const{data:T,error:v}=await Se(i,k.pid);if(!v)n&&n(T);else return!1}const E=G(-1),Y=i=>{i>0?(E.value=i,k.dbcreater=JSON.parse(JSON.stringify(i)),m()):(k.dbcreater=void 0,E.value=-1,m())},ee=i=>{m()},pe=()=>{if(console.log(x.query.prjId,"route.query.prjId"),x.query.debug){k.status=Number(x.query.debug),k.dbcreater=z.userInfo.id,Y(z.userInfo.id);return}x.query.review&&(k.status=2),m()},ce=()=>{m()},fe=()=>{B.value=[],$.itemCount=0},d=G(null),V=G(!1),M=i=>{d.value=i,V.value=!0};return(i,n)=>{const T=ht,v=ut,h=xe,te=Ke,me=Je,ae=Ge,he=rt,ke=Me,w=_t,we=bt,r=Re,l=Z("no-auth");return f(),I("div",Nt,[e(xt,{model:o(k),"onUpdate:model":n[0]||(n[0]=s=>_e(k)?k.value=s:null),onReset:ce,onSearch:pe,onSearch1:o(m),onClear:fe},null,8,["model","onSearch1"]),e(ke,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:t(()=>[e(h,{align:"center",wrap:"",class:"lt-sm:w-200px"},{default:t(()=>[n[6]||(n[6]=_("div",null,"待调试业务",-1)),e(v,{size:"small",value:E.value,"onUpdate:value":[n[1]||(n[1]=s=>E.value=s),Y],name:"radiobuttongroup1"},{default:t(()=>[e(T,{value:-1,label:"默认"}),e(T,{value:o(z).userInfo.id,label:"我的调试"},null,8,["value"])]),_:1},8,["value"])]),_:1,__:[6]})]),"header-extra":t(()=>[e(h,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:t(()=>[H((f(),D(o(S),{onClick:o(re),size:"small",ghost:"",type:"primary"},{icon:t(()=>[e(te,{class:"text-icon"})]),default:t(()=>[n[7]||(n[7]=p(" "+c("新增")))]),_:1,__:[7]},8,["onClick"])),[[l,"project:Debug:insert"]]),e(o(ve),{onPositiveClick:X},{trigger:t(()=>[H((f(),D(o(S),{size:"small",ghost:"",type:"error",disabled:o(P).length==0},{icon:t(()=>[e(me,{class:it(["text-icon",{"animate-spin":o(U)}])},null,8,["class"])]),default:t(()=>[n[8]||(n[8]=p(" "+c("批量删除")))]),_:1,__:[8]},8,["disabled"])),[[l,"project:Debug:delete"]])]),default:t(()=>[n[9]||(n[9]=p(" 确定要删除选中的吗？ "))]),_:1,__:[9]}),e(ae,{columns:o(F),"onUpdate:columns":n[2]||(n[2]=s=>_e(F)?F.value=s:null)},null,8,["columns"])]),_:1})]),default:t(()=>[e(he,{"checked-row-keys":o(P),"onUpdate:checkedRowKeys":n[3]||(n[3]=s=>_e(P)?P.value=s:null),columns:o(a),data:o(B),size:"small","flex-height":!o(ne).isMobile,loading:o(U),remote:"","row-key":s=>s.id,"scroll-x":o(a).reduce((s,j)=>s+(j.width||100),0),pagination:o(K),class:"sm:h-full","onUpdate:filters":ee},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","scroll-x","pagination"]),e(Dt,{visible:o(W),"onUpdate:visible":n[4]||(n[4]=s=>_e(W)?W.value=s:null),onSubmitted:o(m),"operate-type":o(se),pid:o(k).pid,"row-data":o(oe)},null,8,["visible","onSubmitted","operate-type","pid","row-data"])]),_:1}),e(r,{show:V.value,"onUpdate:show":n[5]||(n[5]=s=>V.value=s),title:"查看详情",preset:"card",class:"w-1200px"},{default:t(()=>[e(we,{bordered:"","label-placement":"left","label-align":"center",columns:2,"label-style":{width:"160px"}},{default:t(()=>[e(w,null,{label:t(()=>n[10]||(n[10]=[p(" 权重 ")])),default:t(()=>[_("span",null,c(d.value.tname),1)]),_:1}),e(w,null,{label:t(()=>n[11]||(n[11]=[p(" 业务名称 ")])),default:t(()=>[_("span",null,c(d.value.debugname),1)]),_:1}),e(w,null,{label:t(()=>n[12]||(n[12]=[p(" 计划起止时间 ")])),default:t(()=>[_("span",null,c(d.value.starttime)+"--"+c(d.value.endtime),1)]),_:1}),e(w,null,{label:t(()=>n[13]||(n[13]=[p(" 对接方 ")])),default:t(()=>[_("span",null,c(d.value.docker.split("&id=")[0]),1)]),_:1}),e(w,null,{label:t(()=>n[14]||(n[14]=[p(" 对接方负责人 ")])),default:t(()=>[_("span",null,c(d.value.dockcharge),1)]),_:1}),e(w,null,{label:t(()=>n[15]||(n[15]=[p(" 联系方式 ")])),default:t(()=>[_("span",null,c(d.value.dockcontact),1)]),_:1}),e(w,null,{label:t(()=>n[16]||(n[16]=[p(" 状态 ")])),default:t(()=>[d.value.status==0?(f(),D(o(ge),{key:0,type:"default"},{default:t(()=>n[17]||(n[17]=[p("未调试")])),_:1,__:[17]})):C("",!0),d.value.status==1?(f(),D(o(ge),{key:1,type:"info"},{default:t(()=>n[18]||(n[18]=[p("开始调试")])),_:1,__:[18]})):C("",!0),d.value.status==2?(f(),D(o(ge),{key:2,type:"success"},{default:t(()=>n[19]||(n[19]=[p("完成调试")])),_:1,__:[19]})):C("",!0),d.value.status==3?(f(),D(o(ge),{key:3,type:"success"},{default:t(()=>n[20]||(n[20]=[p("审核完成")])),_:1,__:[20]})):C("",!0)]),_:1}),e(w,null,{label:t(()=>n[21]||(n[21]=[p(" 备注 ")])),default:t(()=>[_("span",null,c(d.value.notes),1)]),_:1}),e(w,null,{label:t(()=>n[22]||(n[22]=[p(" 调试人 ")])),default:t(()=>[_("span",null,c(d.value.dbusername),1)]),_:1}),e(w,null,{label:t(()=>n[23]||(n[23]=[p(" 调试时间 ")])),default:t(()=>[_("span",null,c(d.value.dbdbtime),1)]),_:1}),e(w,null,{label:t(()=>n[24]||(n[24]=[p(" 审核人 ")])),default:t(()=>[_("span",null,c(d.value.ckusername),1)]),_:1}),e(w,null,{label:t(()=>n[25]||(n[25]=[p(" 审核时间 ")])),default:t(()=>[_("span",null,c(d.value.ckdbtime),1)]),_:1}),e(w,null,{label:t(()=>n[26]||(n[26]=[p(" 附件1 ")])),default:t(()=>{var s;return[d.value.re1?(f(),I("span",St,"文件别名"+c(d.value.re1),1)):C("",!0),d.value.fl1?(f(),I("span",jt,c((s=d.value.fl1)==null?void 0:s.split("?")[1]),1)):C("",!0)]}),_:1}),e(w,null,{label:t(()=>n[27]||(n[27]=[p(" 附件2 ")])),default:t(()=>{var s;return[d.value.re2?(f(),I("span",zt,"文件别名"+c(d.value.re2),1)):C("",!0),d.value.fl2?(f(),I("span",Ut,c((s=d.value.fl2)==null?void 0:s.split("?")[1]),1)):C("",!0)]}),_:1}),e(w,null,{label:t(()=>n[28]||(n[28]=[p(" 附件3 ")])),default:t(()=>{var s;return[d.value.re3?(f(),I("span",Pt,"文件别名"+c(d.value.re3),1)):C("",!0),d.value.fl3?(f(),I("span",qt,c((s=d.value.fl3)==null?void 0:s.split("?")[1]),1)):C("",!0)]}),_:1}),e(w,null,{label:t(()=>n[29]||(n[29]=[p(" 附件4 ")])),default:t(()=>{var s;return[d.value.re4?(f(),I("span",Rt,"文件别名"+c(d.value.re4),1)):C("",!0),d.value.fl4?(f(),I("span",It,c((s=d.value.fl4)==null?void 0:s.split("?")[1]),1)):C("",!0)]}),_:1})]),_:1})]),_:1},8,["show"])])}}});export{Xt as default};

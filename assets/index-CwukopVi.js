import{_ as ke,a as xe}from"./close-small-rounded-DFhdcIeE.js";import{d as j,s as X,r as G,D as Ce,E as A,o as w,c as T,w as t,f as U,g as e,h as f,i as N,F as V,M as $e,b0 as ee,L as M,B as R,ap as Y,bc as te,O as B,P as L,S as K,Q as Se,R as Te,T as ne,j as D,t as F,ad as J,v as Ue,e as H,ao as ae,bd as Ne,be as Ie,aD as De,a2 as z,K as W,ar as Ee,aZ as Ve,H as q,bf as se,bg as le,aB as Pe,bh as oe,bi as ie,as as qe,aq as Re,a0 as Q,aj as re,av as Be,ae as Me,bj as je,bk as Oe,N as Fe,I as Ae,ay as Ge,az as ze}from"./index-C5IVBnuT.js";import{h as He,i as Le,j as Je,k as We,l as Ke,m as Qe,n as Ze,o as Xe,p as Ye,q as et,r as tt,s as nt,t as at,u as st,v as lt,w as ot,x as it,y as rt,z as ut,A as ct,B as dt,C as mt,D as pt}from"./basic-config-CSbGEqUt.js";import{M as _t}from"./shield-question-outline-rounded-BUNwOShd.js";import{_ as ft}from"./Table-BgZayYbr.js";import{f as ue}from"./reportForm-H7OrfI89.js";import{f as ce}from"./scheduleTask-CN6ABgkF.js";import{_ as gt}from"./DatePicker-BILi7KHr.js";import{_ as de}from"./TimePicker-Dx4geqmp.js";import{u as me}from"./table-CQwo57Cc.js";import{_ as vt}from"./Popconfirm-8Mt3zkJO.js";import{u as yt}from"./usePageData-B-2UX2DD.js";import{a as bt}from"./events-CBEXM-sY.js";import{_ as ht}from"./Progress-CG76YBZ6.js";import{_ as wt}from"./Upload-BuS47aQS.js";import"./defineProperty-BYqLBAK_.js";const pe=P=>(Se("data-v-8912ff50"),P=P(),Te(),P),kt={class:"flex justify-center"},xt=pe(()=>U("span",{class:"font-bold"},"提示：",-1)),Ct=pe(()=>U("span",{style:{"text-decoration":"underline"}},"被锁定的账号会在设定的时间周期后自动解锁",-1)),$t=j({name:"basicConfig",__name:"basicConfig",setup(P){const{formRef:m,validate:k,restoreValidation:l}=X(),o=G($());function $(){return{enablelock:1,locktime:5,lockcount:3,unlockeanble:1,unlocktime:5,aceffective:1,pwdexpire:1,expiretime:1,whiteenable:1,cputhreshold:80,memthreshold:80,captcha:1,tokentime:30}}const r={type:"number",required:!0,message:"不能为空",trigger:["blur","change"]},S={locktime:r,lockcount:r,unlocktime:r,expiretime:r,cputhreshold:r,memthreshold:r,tokentime:r},b=async()=>{const{data:i,error:a}=await He();a||(Object.assign(o,i),o.locktime=i.locktime/60,o.unlocktime=i.unlocktime/60/24)};Ce(()=>{b()});const n=async()=>{var g;const i=o.locktime*60,a=o.unlocktime*60*24;await k();const{error:h}=await Le({...o,locktime:i,unlocktime:a});h||(g=window.$message)==null||g.success("设置成功")};return(i,a)=>{const h=$e,g=ee,c=M,u=R,y=Y,x=te,v=B,s=L,p=K,d=A("no-auth");return w(),T(p,{style:{"max-height":"calc(100vh - 245px)"}},{default:t(()=>[U("div",kt,[e(s,{ref_key:"formRef",ref:m,"label-width":180,"label-placement":"left",model:o,rules:S},{default:t(()=>[e(c,{label:"是否开启自动解锁",path:"unlockeanble"},{label:t(()=>[f(" 是否开启自动解锁 "),e(h,{trigger:"hover",placement:"top","content-style":"padding: 5px;"},{trigger:t(()=>[e(N(_t),{class:"text-xl cursor-pointer c-#7a7b78"})]),default:t(()=>[xt,Ct]),_:1})]),default:t(()=>[e(g,{value:o.unlockeanble,"onUpdate:value":a[0]||(a[0]=_=>o.unlockeanble=_),disabled:"","checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),e(c,{label:"解锁时间",path:"unlocktime"},{default:t(()=>[e(x,{class:"flex items-center"},{default:t(()=>[e(u,{onClick:a[1]||(a[1]=_=>o.unlocktime--),disabled:o.unlocktime==1},{default:t(()=>[f(" − ")]),_:1},8,["disabled"]),e(y,{"show-button":!1,value:o.unlocktime,"onUpdate:value":a[2]||(a[2]=_=>o.unlocktime=_),placeholder:"",min:1,max:3},null,8,["value"]),e(u,{onClick:a[3]||(a[3]=_=>o.unlocktime++),class:"mr-5px",disabled:o.unlocktime==3},{default:t(()=>[f(" + ")]),_:1},8,["disabled"]),f(" 天 ")]),_:1})]),_:1}),e(c,{label:"是否开启验证码",path:"captcha"},{default:t(()=>[e(g,{value:o.captcha,"onUpdate:value":a[4]||(a[4]=_=>o.captcha=_),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),e(c,{label:"是否开启白名单",path:"whiteenable"},{default:t(()=>[e(g,{value:o.whiteenable,"onUpdate:value":a[5]||(a[5]=_=>o.whiteenable=_),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),e(c,{label:"密码过期时间",path:"expiretime"},{default:t(()=>[e(x,{class:"flex items-center"},{default:t(()=>[e(u,{onClick:a[6]||(a[6]=_=>o.expiretime--),disabled:o.expiretime==1},{default:t(()=>[f(" − ")]),_:1},8,["disabled"]),e(y,{"show-button":!1,value:o.expiretime,"onUpdate:value":a[7]||(a[7]=_=>o.expiretime=_),placeholder:"",min:1,max:90},null,8,["value"]),e(u,{onClick:a[8]||(a[8]=_=>o.expiretime++),class:"mr-5px",disabled:o.expiretime==90},{default:t(()=>[f(" + ")]),_:1},8,["disabled"]),f(" 天 ")]),_:1})]),_:1}),e(c,{label:"CPU阈值",path:"cputhreshold"},{default:t(()=>[e(x,{class:"flex items-center"},{default:t(()=>[e(u,{onClick:a[9]||(a[9]=_=>o.cputhreshold--),disabled:o.cputhreshold==0},{default:t(()=>[f(" − ")]),_:1},8,["disabled"]),e(y,{"show-button":!1,value:o.cputhreshold,"onUpdate:value":a[10]||(a[10]=_=>o.cputhreshold=_),placeholder:"",min:0,precision:0,max:100},null,8,["value"]),e(u,{onClick:a[11]||(a[11]=_=>o.cputhreshold++),disabled:o.cputhreshold==100,class:"mr-5px"},{default:t(()=>[f(" + ")]),_:1},8,["disabled"]),f(" % ")]),_:1})]),_:1}),e(c,{label:"MEM阈值",path:"memthreshold"},{default:t(()=>[e(x,{class:"flex items-center"},{default:t(()=>[e(u,{onClick:a[12]||(a[12]=_=>o.memthreshold--),disabled:o.memthreshold==0},{default:t(()=>[f(" − ")]),_:1},8,["disabled"]),e(y,{"show-button":!1,value:o.memthreshold,"onUpdate:value":a[13]||(a[13]=_=>o.memthreshold=_),placeholder:"",min:0,precision:0,max:100},null,8,["value"]),e(u,{onClick:a[14]||(a[14]=_=>o.memthreshold++),disabled:o.memthreshold==100,class:"mr-5px"},{default:t(()=>[f(" + ")]),_:1},8,["disabled"]),f(" % ")]),_:1})]),_:1}),e(c,{label:"token过期时间",path:"tokentime"},{default:t(()=>[e(x,{class:"flex items-center"},{default:t(()=>[e(u,{onClick:a[15]||(a[15]=_=>o.tokentime--),disabled:o.tokentime==1},{default:t(()=>[f(" − ")]),_:1},8,["disabled"]),e(y,{"show-button":!1,value:o.tokentime,"onUpdate:value":a[16]||(a[16]=_=>o.tokentime=_),placeholder:"",min:1},null,8,["value"]),e(u,{onClick:a[17]||(a[17]=_=>o.tokentime++),class:"mr-5px"},{default:t(()=>[f(" + ")]),_:1}),f(" 小时 ")]),_:1})]),_:1}),e(c,{label:" "},{default:t(()=>[e(v,null,{default:t(()=>[V((w(),T(u,{type:"default",ghost:"",onClick:b},{default:t(()=>[f(" 刷新 ")]),_:1})),[[d,"system.conf.select"]]),V((w(),T(u,{type:"info",ghost:"",onClick:n},{default:t(()=>[f(" 保存 ")]),_:1})),[[d,"system.conf.update"]])]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1})}}}),St=ne($t,[["__scopeId","data-v-8912ff50"]]),Tt=U("td",null,"产品名称",-1),Ut=U("td",null,"产品版本",-1),Nt=U("td",null,"build号",-1),It=U("td",null,"产品型号",-1),Dt=j({name:"basicInfo",__name:"basicInfo",setup(P){const m=D({id:1,pname:"",pversion:"",pbuild:"",pmodel:""});(async()=>{const{data:$,error:r}=await Je();r||(m.value=$)})(),D(0);const l=async()=>{var S,b;const{data:$,error:r}=await We();r||($==="重启失败"?(S=window.$message)==null||S.error($):(b=window.$message)==null||b.success($))},o=async()=>{var S,b;const{data:$,error:r}=await Ke();r||($==="关机失败"?(S=window.$message)==null||S.error($):(b=window.$message)==null||b.success($))};return($,r)=>{const S=ft,b=R,n=B,i=J,a=A("no-auth");return w(),T(i,{class:"w-600px text-center m-auto mt-20px"},{default:t(()=>[e(S,{bordered:!0,"single-line":!1},{default:t(()=>[U("tbody",null,[U("tr",null,[Tt,U("td",null,F(m.value.pname||""),1)]),U("tr",null,[Ut,U("td",null,F(m.value.pversion),1)]),U("tr",null,[Nt,U("td",null,F(m.value.pbuild),1)]),U("tr",null,[It,U("td",null,F(m.value.pmodel),1)])])]),_:1}),e(n,{justify:"center",class:"mt-50px"},{default:t(()=>[V((w(),T(b,{type:"info",ghost:"",onClick:l},{default:t(()=>[f("重启")]),_:1})),[[a,"sysmanger.basicInfo.restart"]]),V((w(),T(b,{type:"info",ghost:"",onClick:o},{default:t(()=>[f("关机")]),_:1})),[[a,"sysmanger.basicInfo.shutdown"]])]),_:1})]),_:1})}}}),Et=j({name:"emailService",__name:"emailSever",setup(P){const{createConfirmPwdRule:m,defaultRequiredRule:k,patternRules:l}=Ue(),{formRef:o,validate:$}=X(),r=D({port:void 0,pwd:"",sendserver:"",essl:0,uname:""}),S={sendserver:[{required:!0,validator:(v,s,p)=>s?Ne(s)?p():p(new Error("请输入正确的IP地址或域名")):new Error("请输入服务器地址"),trigger:["blur","input"]}],port:{type:"number",required:!0,trigger:["blur","input"],validator:(v,s,p)=>s==null||s==null?new Error("请输入端口号"):Ie(s)?!0:new Error("请输入在0-65535之间的数字")},uname:[{required:!0,message:"请输入账号",trigger:"blur"}],pwd:[{required:!0,message:"请输入密码",trigger:"blur"}],sendaddr:[{required:!0,message:"请输入发件邮箱",trigger:["blur","input"]},{validator:De,trigger:["blur","input"]}]},b=D(!1),n=G({pwd:""}),i={pwd:[{required:!0,message:"请输入密码",trigger:"blur"},l.passwordL]},a=()=>{n.pwd="",b.value=!0},h=D(),g=async()=>{var d,_;await((d=h.value)==null?void 0:d.validate());const v=z(n.pwd),{data:s,error:p}=await Qe({pwd:v});p||(s!=null&&s.id||(_=window.$message)==null||_.warning("查询到系统未设置邮件服务,请先添加邮件服务"),r.value.sendserver=(s==null?void 0:s.sendserver)??r.value.sendserver,r.value.port=(s==null?void 0:s.port)??r.value.port,r.value.pwd=(s==null?void 0:s.pwd)??r.value.pwd,r.value.essl=(s==null?void 0:s.essl)??r.value.essl,r.value.uname=(s==null?void 0:s.uname)??r.value.uname,r.value.id=(s==null?void 0:s.id)??r.value.id,b.value=!1)},c=async()=>{var p,d,_,E;await $();const v=z(r.value.pwd),s=z(r.value.uname);if(r.value.id){const{data:O,error:C}=await Ze({...r.value,pwd:v,uname:s});C||((p=window.$message)==null||p.destroyAll(),(d=window.$message)==null||d.success("保存成功"))}else{const{data:O,error:C}=await Xe({...r.value,pwd:v,uname:s});C||((_=window.$message)==null||_.destroyAll(),(E=window.$message)==null||E.success("保存成功"))}},u=async()=>{var p,d;const{data:v,error:s}=await Ye();s||((p=window.$message)==null||p.destroyAll(),(d=window.$message)==null||d.success("重置成功"),g())},y=D(!1),x=async()=>{var p,d;const v=z(r.value.pwd),s=z(r.value.uname);y.value=!0,await $();try{const{data:_,error:E}=await et({...r.value,pwd:v,uname:s});E||((p=window.$message)==null||p.destroyAll(),(d=window.$message)==null||d.success("测试成功"))}finally{y.value=!1}};return(v,s)=>{const p=W,d=M,_=Y,E=ee,O=L,C=R,_e=B,fe=W,ge=M,ve=L,ye=K,be=R,he=B,we=Ee,Z=A("no-auth");return w(),H(ae,null,[e(O,{ref_key:"formRef",ref:o,"label-width":150,model:r.value,rules:S,"label-placement":"left",class:"w-400px",style:{margin:"50px auto"}},{default:t(()=>[e(d,{label:"发送邮件服务器",path:"sendserver"},{default:t(()=>[e(p,{value:r.value.sendserver,"onUpdate:value":s[0]||(s[0]=I=>r.value.sendserver=I),placeholder:"输入服务器或IP地址"},null,8,["value"])]),_:1}),e(d,{label:"端口",path:"port"},{default:t(()=>[e(_,{value:r.value.port,"onUpdate:value":s[1]||(s[1]=I=>r.value.port=I),placeholder:"输入端口",style:{width:"100%"}},null,8,["value"])]),_:1}),e(d,{label:"用户名",path:"uname"},{default:t(()=>[e(p,{value:r.value.uname,"onUpdate:value":s[2]||(s[2]=I=>r.value.uname=I),placeholder:"用户名"},null,8,["value"])]),_:1}),e(d,{label:"密码",path:"pwd"},{default:t(()=>[e(p,{type:"password",value:r.value.pwd,"onUpdate:value":s[3]||(s[3]=I=>r.value.pwd=I),placeholder:"密码","show-password-on":"click"},null,8,["value"])]),_:1}),e(d,{label:"ssl",path:"essl"},{default:t(()=>[e(E,{value:r.value.essl,"onUpdate:value":s[4]||(s[4]=I=>r.value.essl=I),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1})]),_:1},8,["model"]),e(_e,{justify:"center"},{default:t(()=>[e(C,{type:"info",ghost:"",onClick:a},{default:t(()=>[f("查询")]),_:1}),V((w(),T(C,{type:"info",ghost:"",onClick:x},{default:t(()=>[f("测试")]),_:1})),[[Z,"sysmanger.basicInfo.test.mailInfo"]]),V((w(),T(C,{type:"info",ghost:"",onClick:c},{default:t(()=>[f("保存")]),_:1})),[[Z,"sysmanger.mailInfo.update"]]),V((w(),T(C,{type:"info",ghost:"",onClick:u},{default:t(()=>[f("重置")]),_:1})),[[Z,"sysmanger.mailInfo.delete"]])]),_:1}),e(we,{show:b.value,"onUpdate:show":s[6]||(s[6]=I=>b.value=I),title:"查询邮件地址",preset:"card",class:"w-420px"},{footer:t(()=>[e(he,{justify:"center",size:16},{default:t(()=>[e(be,{type:"primary",onClick:g},{default:t(()=>[f(F(v.$t("common.confirm")),1)]),_:1})]),_:1})]),default:t(()=>[e(ye,{class:"max-h-480px pr-20px"},{default:t(()=>[e(ve,{ref_key:"checkformRef",ref:h,model:n,"label-placement":"left",rules:i,"label-width":80,"require-mark-placement":"left"},{default:t(()=>[e(ge,{label:v.$t("page.login.common.password"),path:"pwd"},{default:t(()=>[e(fe,{type:"password","show-password-on":"click",class:"eipaddrCss",clearable:"",value:n.pwd,"onUpdate:value":s[5]||(s[5]=I=>n.pwd=I),placeholder:"请输入当前登录账号密码"},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1})]),_:1},8,["show"])],64)}}}),Vt=j({name:"TimingConfig",__name:"timingConfig",setup(P){const{formRef:m,validate:k}=X(),l=G({automatic:1,time:Ve(1,new Date),ip:"",taskId:"",showCron:!1,setting:{settingCycle:void 0,settingCycleValue:void 0,settingTime:void 0}}),o={time:{required:!0,message:"请选择时间",trigger:"blur"},ip:[{required:!0,message:"请输入IP",trigger:"blur"},{validator:Pe,trigger:"blur"}],task:{required:!0,message:"请设置表达式",trigger:"blur"},setting:{settingCycle:{type:"number",required:!0,message:"请选择设置周期",trigger:"blur"},settingCycleValue:{type:"number",required:!0,message:"请选择设置周期值",trigger:"blur"},settingTime:{required:!0,message:"请选择设置时间",trigger:"blur"}}},$=async()=>{const{data:b,error:n}=await tt();n||(l.time=b)};$(),(async()=>{const{data:b,error:n}=await nt();if(n)return;const{id:i,params:a}=b;try{if(a){const{cron:h,ip:g}=JSON.parse(a),c=oe(h);l.setting.settingCycle=c==null?void 0:c.settingCycle,l.setting.settingTime=c==null?void 0:c.settingTime,l.setting.settingCycleValue=c==null?void 0:c.settingCycleValue,l.ip=g,l.taskId=i}}catch(h){console.error("Error parsing params:",h)}})();const S=async()=>{var b,n;if(await k(),l.automatic){const{data:i,error:a}=await at({dtime:l.time});a||(b=window.$message)==null||b.success(i)}else{const i=ie(l.setting.settingCycle==1?{dayOfWeek:l.setting.settingCycleValue,time:l.setting.settingTime}:null,l.setting.settingCycle==2?{dayOfMonth:l.setting.settingCycleValue,time:l.setting.settingTime}:null,l.setting.settingCycle==3?{time:l.setting.settingTime}:null);l.taskId?await ce({id:l.taskId,beanName:"NtpTask",cronExpression:i,remark:"",status:1,params:JSON.stringify({ip:l.ip,cron:i})}):await ue({beanName:"NtpTask",cronExpression:i,remark:"",status:1,params:JSON.stringify({ip:l.ip,cron:i})});const{data:a,error:h}=await st({ip:l.ip});h||(n=window.$message)==null||n.success(a)}};return(b,n)=>{const i=qe,a=B,h=Re,g=M,c=gt,u=W,y=Q,x=de,v=R,s=L,p=A("no-auth");return w(),T(s,{ref_key:"formRef",ref:m,"label-width":180,"label-placement":"left",model:l,class:"m-auto w-600px mt-20px",rules:o},{default:t(()=>[e(g,{label:"校时",path:"enablelock"},{default:t(()=>[e(h,{value:l.automatic,"onUpdate:value":n[0]||(n[0]=d=>l.automatic=d),name:"radiogroup"},{default:t(()=>[e(a,null,{default:t(()=>[e(i,{value:1},{default:t(()=>[f("手动校时")]),_:1}),e(i,{value:0},{default:t(()=>[f("自动校时")]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),l.automatic?(w(),T(g,{key:0,label:"设置中心服务器时间",path:"time"},{default:t(()=>[e(c,{"formatted-value":l.time,"onUpdate:formattedValue":n[1]||(n[1]=d=>l.time=d),format:"yyyy-MM-dd HH:mm:ss",type:"datetime",clearable:""},null,8,["formatted-value"])]),_:1})):q("",!0),l.automatic?q("",!0):(w(),H(ae,{key:1},[e(g,{label:"NTP服务器设置",path:"ip"},{default:t(()=>[e(u,{value:l.ip,"onUpdate:value":n[2]||(n[2]=d=>l.ip=d),placeholder:"输入NTP服务器设置",style:{width:"200px"}},null,8,["value"])]),_:1}),e(g,{label:"设置周期",path:"setting.settingCycle"},{default:t(()=>[e(a,{justify:"space-between"},{default:t(()=>[e(y,{value:l.setting.settingCycle,"onUpdate:value":[n[3]||(n[3]=d=>l.setting.settingCycle=d),n[4]||(n[4]=d=>l.setting.settingCycleValue=1)],options:[{label:"每周",value:1},{label:"每月",value:2},{label:"每日",value:3}],style:{width:"200px"}},null,8,["value"]),e(g,{label:"",path:"setting.settingCycleValue","show-feedback":!1},{default:t(()=>[e(a,null,{default:t(()=>[l.setting.settingCycle==1?(w(),T(y,{key:0,value:l.setting.settingCycleValue,"onUpdate:value":n[5]||(n[5]=d=>l.setting.settingCycleValue=d),options:N(se)(),style:{width:"200px"}},null,8,["value","options"])):q("",!0),l.setting.settingCycle==2?(w(),T(y,{key:1,value:l.setting.settingCycleValue,"onUpdate:value":n[6]||(n[6]=d=>l.setting.settingCycleValue=d),options:N(le)(),style:{width:"200px"}},null,8,["value","options"])):q("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),e(g,{label:"设置时间",path:"setting.settingTime"},{default:t(()=>[e(x,{"formatted-value":l.setting.settingTime,"onUpdate:formattedValue":n[7]||(n[7]=d=>l.setting.settingTime=d)},null,8,["formatted-value"])]),_:1})],64)),e(g,null,{label:t(()=>[l.automatic?V((w(),T(v,{key:0,type:"info",ghost:"",onClick:$},{default:t(()=>[f(" 查看服务器时间 ")]),_:1})),[[p,"sysmanger.basicInfo.gettiming"]]):q("",!0)]),default:t(()=>[e(a,null,{default:t(()=>[V((w(),T(v,{type:"info",ghost:"",onClick:S},{default:t(()=>[f(" 保存 ")]),_:1})),[[p,"sysmanger.basicInfo.manu.timing"]])]),_:1})]),_:1})]),_:1},8,["model"])}}}),Pt=j({name:"dataBase",__name:"dataBase",setup(P){const m=()=>[...Array(12).keys()].map(g=>({label:`${g+1}个月`,value:g+1})),k=G({space:80,retention:void 0,id:void 0}),{columns:l,columnChecks:o,data:$,getData:r,loading:S,mobilePagination:b,searchParams:n,resetSearchParams:i}=me({apiFn:lt,immediate:!0,apiParams:{page:1,limit:20},columns:()=>[{title:"时间",key:"dbtime",align:"center"},{title:"描述",key:"dmsg",align:"center"},{title:"结果",key:"resultmsg",align:"center"}]});(async()=>{const{data:g,error:c}=await ot();c||(k.space=g.space,k.retention=g.retention,k.id=g.id)})();const h=async()=>{var u;const{data:g,error:c}=await it({space:k.space,retention:k.retention,id:k.id});c||(u=window.$message)==null||u.success("保存成功")};return(g,c)=>{const u=R,y=Y,x=te,v=M,s=Q,p=B,d=J,_=re,E=K,O=A("no-auth");return w(),T(E,{class:"h-full flex-col",style:{maxHeight:"calc(100vh - 220px)"}},{default:t(()=>[e(d,{title:"数据库维护配置",bordered:!1,class:"mb-20px","content-style":{padding:"0"},"header-style":{paddingTop:"0"}},{default:t(()=>[e(p,{class:"ml-50px"},{default:t(()=>[e(v,{label:"已用空间超过","label-placement":"left"},{default:t(()=>[e(x,{class:"flex items-center"},{default:t(()=>[e(u,{onClick:c[0]||(c[0]=C=>k.space--),disabled:k.space==1},{default:t(()=>[f(" − ")]),_:1},8,["disabled"]),e(y,{"show-button":!1,value:k.space,"onUpdate:value":c[1]||(c[1]=C=>k.space=C),placeholder:"",min:1,max:100,style:{width:"100px","text-align":"center"}},null,8,["value"]),e(u,{onClick:c[2]||(c[2]=C=>k.space++),disabled:k.space==100,class:"mr-5px"},{default:t(()=>[f(" + ")]),_:1},8,["disabled"]),f(" % 时自动维护 ")]),_:1})]),_:1}),e(v,{label:"数据保留时间","label-placement":"left",class:"mx-20px"},{default:t(()=>[e(s,{value:k.retention,"onUpdate:value":c[3]||(c[3]=C=>k.retention=C),placeholder:"请选择",options:m(),style:{width:"150px"}},null,8,["value","options"])]),_:1}),e(v,{label:" ","label-placement":"left"},{default:t(()=>[V((w(),T(u,{type:"info",ghost:"",onClick:h},{default:t(()=>[f("保存")]),_:1})),[[O,"sysmanger.basicInfo.insert.dataBaseMaintenance"]])]),_:1})]),_:1})]),_:1}),e(d,{title:"数据库维护列表",bordered:!1,class:"flex-1","content-style":{padding:"0"},"header-style":{paddingTop:"0"}},{default:t(()=>[e(_,{columns:N(l),data:N($),size:"small","scroll-x":462,"max-height":420,loading:N(S),remote:"","row-key":C=>C.id,pagination:N(b),class:"sm:h-full"},null,8,["columns","data","loading","row-key","pagination"])]),_:1})]),_:1})}}}),qt=j({name:"systemSnapshot",__name:"systemSnapshot",setup(P){const{columns:m,columnChecks:k,data:l,getData:o,loading:$,mobilePagination:r,searchParams:S,resetSearchParams:b}=me({apiFn:rt,immediate:!0,apiParams:{page:1,limit:20},columns:()=>[{title:"时间",key:"dbtime",align:"center"},{title:"描述",key:"dmsg",align:"center"},{title:"结果",key:"resultmsg",align:"center",render:u=>e(Be,{type:u.resultmsg==1?"error":"success"},{default:()=>[u.resultmsg==1?"失败":"成功"]})},{title:"操作",key:"operate",align:"center",width:100,fixed:"right",render:u=>e(vt,{onPositiveClick:()=>c(u.id)},{default:()=>"确定恢复吗?恢复后将重启系统",trigger:()=>e(R,{type:"info",ghost:!0,size:"small"},{default:()=>[f("恢复")]})})}]}),n=G({id:"",setting:{settingCycle:void 0,settingCycleValue:void 0,settingTime:void 0}}),i=D(n),a={setting:{settingCycle:{type:"number",required:!0,message:"请选择设置周期",trigger:["blur","change"]},settingCycleValue:{type:"number",required:!1,message:"请选择设置周期值",trigger:["blur","change"]},settingTime:{required:!0,message:"请选择设置时间",trigger:["blur","change"]}}};(async()=>{const{data:u,error:y}=await ut();if(y)return;console.log(u,"asdas");const x=oe(u.cronExpression);Object.assign(n,{id:u.id,setting:x})})();const g=async()=>{var y,x,v;await((y=i.value)==null?void 0:y.validate());const u=ie(n.setting.settingCycle==1?{dayOfWeek:n.setting.settingCycleValue,time:n.setting.settingTime}:null,n.setting.settingCycle==2?{dayOfMonth:n.setting.settingCycleValue,time:n.setting.settingTime}:null,n.setting.settingCycle==3?{time:n.setting.settingTime}:null);if(n.id){const{data:s,error:p}=await ce({id:n.id,beanName:"SnapshotTask",cronExpression:u,status:1,params:JSON.stringify({corn:u})});p||(x=window.$message)==null||x.success("设置成功")}else{const{data:s,error:p}=await ue({beanName:"SnapshotTask",cronExpression:u,remark:"",status:1,params:JSON.stringify({corn:u})});p||(v=window.$message)==null||v.success("设置成功")}},c=async u=>{var v;const{data:y,error:x}=await ct({id:u});x||(v=window.$message)==null||v.success("恢复成功")};return(u,y)=>{const x=Q,v=M,s=B,p=de,d=L,_=J,E=re,O=K;return w(),T(O,{class:"h-full flex-col",style:{maxHeight:"calc(100vh - 220px)"}},{default:t(()=>[e(_,{title:"应用配置设置",bordered:!1,"content-style":{padding:"0"},"header-style":{paddingTop:"0"}},{default:t(()=>[e(s,{class:"ml-50px"},{default:t(()=>[e(d,{"label-placement":"left",inline:"",model:n,rules:a,ref_key:"formRef",ref:i,"label-width":150,class:"px-100px"},{default:t(()=>[e(v,{label:"设置周期",path:"setting.settingCycle"},{default:t(()=>[e(s,{justify:"space-between"},{default:t(()=>[e(x,{value:n.setting.settingCycle,"onUpdate:value":[y[0]||(y[0]=C=>n.setting.settingCycle=C),y[1]||(y[1]=C=>n.setting.settingCycleValue=1)],options:[{label:"每周",value:1},{label:"每月",value:2},{label:"每日",value:3}],style:{width:"140px"}},null,8,["value"]),e(v,{label:"",path:"","show-feedback":!1},{default:t(()=>[n.setting.settingCycle==1?(w(),T(x,{key:0,value:n.setting.settingCycleValue,"onUpdate:value":y[2]||(y[2]=C=>n.setting.settingCycleValue=C),options:N(se)(),style:{width:"140px"}},null,8,["value","options"])):q("",!0),n.setting.settingCycle==2?(w(),T(x,{key:1,value:n.setting.settingCycleValue,"onUpdate:value":y[3]||(y[3]=C=>n.setting.settingCycleValue=C),options:N(le)(),style:{width:"140px"}},null,8,["value","options"])):q("",!0)]),_:1})]),_:1})]),_:1}),e(v,{label:"设置时间",path:"setting.settingTime"},{default:t(()=>[e(p,{"formatted-value":n.setting.settingTime,"onUpdate:formattedValue":y[4]||(y[4]=C=>n.setting.settingTime=C)},null,8,["formatted-value"])]),_:1}),e(v,{label:" ","label-placement":"left"},{default:t(()=>[e(N(R),{type:"info",ghost:"",onClick:g},{default:t(()=>[f("保存")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),e(_,{title:"应用配置列表",bordered:!1,"content-style":{padding:"0"},"header-style":{paddingTop:"0"},class:"flex-1"},{default:t(()=>[e(E,{columns:N(m),data:N(l),size:"small","scroll-x":462,"max-height":420,loading:N($),remote:"","row-key":C=>C.id,pagination:N(r),class:"sm:h-full"},null,8,["columns","data","loading","row-key","pagination"])]),_:1})]),_:1})}}}),Rt=j({__name:"sysStatus",setup(P){const m=G({mailaddr:"",snmpaddr:void 0,stype:0,tmail:0,tsnmp:0});(async()=>{const{data:n,error:i}=await dt();i||(m.mailaddr=(n==null?void 0:n.mailaddr)??m.mailaddr,m.snmpaddr=(n==null?void 0:n.snmpaddr)??m.snmpaddr,m.stype=(n==null?void 0:n.stype)??m.stype,m.tmail=(n==null?void 0:n.tmail)??m.tmail,m.tsnmp=(n==null?void 0:n.tsnmp)??m.tsnmp)})();const l=async()=>{var a;const{data:n,error:i}=await mt(m);i||(a=window.$message)==null||a.success("保存成功")},{pageData:o,getData:$,nextPage:r}=yt(bt),S=async n=>{const i=n.currentTarget;i.scrollTop+i.offsetHeight>=i.scrollHeight&&o.data.length<o.total&&r()},b=D();return Me(()=>o.data,n=>{n&&(b.value=n.filter(i=>i.ftype===1))}),$(),(n,i)=>{const a=Oe,h=Fe,g=W,c=M,u=Q,y=R,x=B,v=J,s=A("no-auth");return w(),T(x,{justify:"center"},{default:t(()=>[e(v,{title:"通知方式",class:"w-600px"},{default:t(()=>[e(a),e(h,{checked:m.tmail,"onUpdate:checked":i[0]||(i[0]=p=>m.tmail=p),"checked-value":1,"unchecked-value":0},{default:t(()=>[f(" 邮件 ")]),_:1},8,["checked"]),m.tmail?(w(),T(c,{key:0,label:"邮件地址","label-placement":"left","label-width":"120",class:"mt-30px",rule:{required:!0,validator:()=>{if(!m.mailaddr)return new Error("请输入邮件地址");if(!N(je)(m.mailaddr))return new Error("请输入正确的邮件地址")},trigger:["blur","input"]}},{default:t(()=>[e(g,{value:m.mailaddr,"onUpdate:value":i[1]||(i[1]=p=>m.mailaddr=p)},null,8,["value"])]),_:1},8,["rule"])):q("",!0),e(a),e(h,{checked:m.tsnmp,"onUpdate:checked":i[2]||(i[2]=p=>m.tsnmp=p),"checked-value":1,"unchecked-value":0},{default:t(()=>[f(" snmp trap ")]),_:1},8,["checked"]),m.tsnmp?(w(),T(c,{key:1,label:"通知服务器","label-placement":"left","label-width":"120",class:"mt-30px"},{default:t(()=>[e(u,{value:m.snmpaddr,"onUpdate:value":i[3]||(i[3]=p=>m.snmpaddr=p),options:b.value,"label-field":"ipaddr","value-field":"ipaddr",onScroll:S},null,8,["value","options"])]),_:1})):q("",!0),e(a),e(x,{justify:"end"},{default:t(()=>[V((w(),T(y,{type:"info",ghost:"",onClick:l},{default:t(()=>[f("保存")]),_:1})),[[s,"sysmanger.basicInfo.alarmNotification"]])]),_:1})]),_:1})]),_:1})}}}),Bt={class:"h-full"},Mt={class:"flex flex-col justify-center items-center"},jt={key:0,style:{width:"300px"}},Ot=j({name:"basicconfig_system-config",__name:"index",setup(P){const m=D("基本信息"),k=D(""),l=D(null),o=({file:i})=>{l.value=i.file,k.value=i.name},$=i=>{i.stopPropagation(),k.value="",l.value=null},r=D(0),S=D(!1),b=i=>{S.value=!0,r.value=i},n=async()=>{var i;try{const a=new FormData;a.append("file",l.value);const{data:h,error:g}=await pt(a,b);if(g)return;(i=window.$message)==null||i.success(h),k.value="",l.value=null,S.value=!1}catch{S.value=!1}finally{S.value=!1}};return(i,a)=>{const h=Ge,g=ke,c=xe,u=R,y=wt,x=M,v=ht,s=B,p=ze,d=J,_=A("no-auth");return w(),H("div",Bt,[e(d,{style:{"margin-bottom":"16px"},class:"h-full","content-style":{height:"100%"}},{default:t(()=>[e(p,{type:"card",animated:"",class:"h-100%",value:m.value,"onUpdate:value":a[1]||(a[1]=E=>m.value=E)},{default:t(()=>[e(h,{name:"基本信息",tab:"基本信息"},{default:t(()=>[e(Dt)]),_:1}),e(h,{name:"安全设置",tab:"安全设置"},{default:t(()=>[e(St)]),_:1}),e(h,{name:"邮件服务",tab:"邮件服务"},{default:t(()=>[e(Et)]),_:1}),e(h,{name:"校时配置",tab:"校时配置"},{default:t(()=>[e(Vt)]),_:1}),e(h,{name:"数据库维护",tab:"数据库维护",class:"h-100%"},{default:t(()=>[e(Pt)]),_:1}),e(h,{name:"应用配置备份",tab:"应用配置备份",class:"h-100%"},{default:t(()=>[e(qt)]),_:1}),e(h,{name:"漏洞信息库",tab:"漏洞信息库"},{default:t(()=>[e(s,{justify:"center",class:"pt-20px important-flex-col items-center"},{default:t(()=>[e(x,{label:"上传漏洞信息文件:","label-placement":"left"},{default:t(()=>[e(y,{action:"","custom-request":o,"show-file-list":!1,accept:".xlsx"},{default:t(()=>[k.value?(w(),H("div",{key:0,onClick:a[0]||(a[0]=Ae(()=>{},["stop"]))},[f(F(k.value)+" ",1),e(g,{class:"font-size-30px cursor-pointer",onClick:$})])):(w(),T(u,{key:1},{icon:t(()=>[e(c,{class:"text-icon"})]),default:t(()=>[f(" 选择文件")]),_:1}))]),_:1})]),_:1}),e(x,{label:"","label-placement":"left",class:"ml-20px"},{default:t(()=>[U("div",Mt,[S.value?(w(),H("div",jt,[e(v,{"indicator-placement":"inside",type:"line",percentage:r.value},null,8,["percentage"])])):q("",!0),V((w(),T(u,{type:"info",loading:S.value,style:{width:"140px","margin-top":"10px"},ghost:"",disabled:!k.value,onClick:n},{default:t(()=>[f(F(S.value?"上传中":"上传"),1)]),_:1},8,["loading","disabled"])),[[_,"cnnvd.import"]])])]),_:1})]),_:1})]),_:1}),e(h,{name:"系统告警通知",tab:"系统告警通知"},{default:t(()=>[e(Rt)]),_:1})]),_:1},8,["value"])]),_:1})])}}}),an=ne(Ot,[["__scopeId","data-v-b42832d4"]]);export{an as default};

import{_ as X}from"./table-header-operation.vue_vue_type_script_setup_true_lang-LQXhcny6.js";import{d as I,q as j,s as q,v as K,x as Y,b as Z,r as ee,y as te,L as M,o as A,c as E,w as a,g as e,h as F,t as P,i as t,$ as m,M as O,A as G,C as oe,D as H,B as U,E as J,ab as ae,ac as ne,N as se,aa as Q,a0 as le,as as re,an as ie,e as ce,ad as B,ae as me}from"./index-BAVDbSG0.js";import{u as ue,a as de}from"./table-KJ4OXJa6.js";import{o as pe,p as _e,q as fe,r as ge}from"./log-BD6lhcvB.js";import{_ as he}from"./round-search-Bcb0t4Jv.js";import{_ as ye}from"./round-refresh-yP8uig6G.js";import{_ as ve}from"./FormItemGridItem-xXViKYEE.js";import{_ as we}from"./Grid-BDOf_ubP.js";import{h as L}from"./permission-CLrEu3_U.js";import{_ as be}from"./Popconfirm-CUDFKPM8.js";import{_ as De}from"./DataTable-BDYCfsCN.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-C9U6osR4.js";import"./setting-outlined-D3n2FZ9Z.js";import"./round-delete-DS0ILC9q.js";import"./refresh-C3aYfWsn.js";import"./round-plus-BaLKVTfF.js";import"./Upload-B9yETaen.js";import"./Progress-CaLEcM5E.js";import"./Forward-edmZhOxW.js";const ke=I({name:"OperateDrawer",__name:"operate-drawer",props:j({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:j(["submitted"],["update:visible"]),setup(p,{emit:N}){const r=p,g=N,u=q(p,"visible"),{formRef:i,validate:b,restoreValidation:z}=K(),{defaultRequiredRule:h}=Y(),T=Z(()=>({add:"新增日志源类别",edit:"编辑日志源类别"})[r.operateType]),s=ee(D());function D(){return{id:void 0,cname:"",sysparam:0}}const k={cname:h};function C(){Object.assign(s,D()),r.operateType==="edit"&&r.rowData&&Object.assign(s,r.rowData)}function y(){u.value=!1}async function d(){var v,c;if(await b(),r.operateType==="add"){const{data:S,error:_}=await pe([s]);_||((v=window.$message)==null||v.success(m("common.addSuccess")),y(),g("submitted"))}else{const{data:S,error:_}=await _e([s]);_||((c=window.$message)==null||c.success(m("common.updateSuccess")),y(),g("submitted"))}}return te(u,()=>{u.value&&(C(),z())}),(v,c)=>{const S=G,_=oe,R=H,x=U,$=J,n=ae,o=ne,l=M("no-space");return A(),E(o,{show:u.value,"onUpdate:show":c[1]||(c[1]=w=>u.value=w),"display-directive":"show",width:360},{default:a(()=>[e(n,{title:T.value,"native-scrollbar":!1,closable:""},{footer:a(()=>[e($,{size:16},{default:a(()=>[e(x,{onClick:y},{default:a(()=>[F(P(t(m)("common.cancel")),1)]),_:1}),e(x,{type:"primary",onClick:d},{default:a(()=>[F(P(t(m)("common.confirm")),1)]),_:1})]),_:1})]),default:a(()=>[e(R,{ref_key:"formRef",ref:i,model:s,rules:k},{default:a(()=>[e(_,{label:"名称",path:"cname"},{default:a(()=>[O(e(S,{clearable:"",value:s.cname,"onUpdate:value":c[0]||(c[0]=w=>s.cname=w),placeholder:"请输入名称"},null,8,["value"]),[[l]])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Se=I({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:j(["reset","search"],["update:model"]),setup(p,{emit:N}){const r=N,{formRef:g,restoreValidation:u}=K(),i=q(p,"model");function b(){i.value.fuzzy=void 0,r("search")}async function z(){await u(),r("reset")}async function h(){r("search")}return(T,s)=>{const D=G,k=ve,C=ye,y=U,d=he,v=J,c=we,S=H,_=Q,R=M("no-space");return A(),E(_,{bordered:!1,size:"small",class:"card-wrapper"},{default:a(()=>[e(S,{ref_key:"formRef",ref:g,model:i.value,"label-placement":"left","label-width":80,"show-feedback":!1,onKeyup:se(h,["enter"])},{default:a(()=>[e(c,{responsive:"screen","item-responsive":""},{default:a(()=>[e(k,{span:"24 s:12 m:6",label:"名称",path:"fuzzy",class:"pr-24px"},{default:a(()=>[O(e(D,{clearable:"",value:i.value.fuzzy,"onUpdate:value":s[0]||(s[0]=x=>i.value.fuzzy=x),placeholder:"请输入名称关键字",onClear:b},null,8,["value"]),[[R]])]),_:1}),e(k,{span:"24  s:12 m:6",class:"pr-24px"},{default:a(()=>[e(v,{class:"w-full"},{default:a(()=>[e(y,{onClick:z},{icon:a(()=>[e(C,{class:"text-icon"})]),default:a(()=>[F(" "+P(t(m)("common.reset")),1)]),_:1}),e(y,{type:"primary",ghost:"",onClick:h},{icon:a(()=>[e(d,{class:"text-icon"})]),default:a(()=>[F(" "+P(t(m)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),xe={class:"min-h-500px flex-col-stretch gap-16px overflow-auto lt-sm:overflow-auto"};function V(p){return typeof p=="function"||Object.prototype.toString.call(p)==="[object Object]"&&!me(p)}const Ee=I({name:"logretrieval_logsourcecategory",__name:"index",setup(p){const N=le(),{columns:r,columnChecks:g,data:u,getData:i,loading:b,mobilePagination:z,searchParams:h,resetSearchParams:T}=ue({apiFn:fe,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,fuzzy:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48},{key:"cname",title:"名称",align:"center",width:240},{key:"sysparam",title:"系统内置",align:"center",width:240,render:n=>{n.sysparam==null&&(n.sysparam=0);const o={0:"success",1:"info"},l=m(re[n.sysparam]);return e(ie,{size:"small",type:o[n.sysparam]},V(l)?l:{default:()=>[l]})}},{key:"operate",title:m("common.operate"),align:"center",width:130,render:n=>{let o;return n.sysparam!=0?e("div",{class:"flex-center gap-8px"},[O(e(U,{type:"primary",ghost:!0,size:"small",onClick:()=>x(n.id)},V(o=m("common.edit"))?o:{default:()=>[o]}),[[M("no-auth"),"log.source.category.update"]]),e(be,{onPositiveClick:()=>R(n.id)},{default:()=>m("common.confirmDelete"),trigger:()=>{let l;return O(e(U,{type:"error",ghost:!0,size:"small"},V(l=m("common.delete"))?l:{default:()=>[l]}),[[M("no-auth"),"log.source.category.delete"]])}})]):null}}]}),{drawerVisible:s,operateType:D,editingData:k,handleAdd:C,handleEdit:y,checkedRowKeys:d,onBatchDeleted:v,onDeleted:c,closeDrawer:S}=de(u,i);async function _(){console.log(d.value),$(d.value.join(","),n=>{v()})}function R(n){console.log(n),$(n,o=>{c()})}function x(n){y(n)}async function $(n,o){const{data:l,error:w}=await ge(n);if(!w)o&&o(l);else return!1}return(n,o)=>{const l=X,w=De,W=Q;return A(),ce("div",xe,[e(Se,{model:t(h),"onUpdate:model":o[0]||(o[0]=f=>B(h)?h.value=f:null),onReset:t(T),onSearch:t(i)},null,8,["model","onReset","onSearch"]),e(W,{title:"日志源类别",bordered:!1,size:"small",class:"sm:flex-1-hidden"},{"header-extra":a(()=>[e(l,{columns:t(g),"onUpdate:columns":o[1]||(o[1]=f=>B(g)?g.value=f:null),"disabled-delete":t(d).length===0,"is-view-add-button":t(L)("log.source.category.insert"),"is-view-delete-button":t(L)("log.source.category.delete"),loading:t(b),onAdd:t(C),onDelete:_,onRefresh:t(i)},null,8,["columns","disabled-delete","is-view-add-button","is-view-delete-button","loading","onAdd","onRefresh"])]),default:a(()=>[e(w,{"checked-row-keys":t(d),"onUpdate:checkedRowKeys":o[2]||(o[2]=f=>B(d)?d.value=f:null),columns:t(r),data:t(u),size:"small","flex-height":!t(N).isMobile,"scroll-x":962,loading:t(b),remote:"","row-key":f=>f.id,pagination:t(z),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(ke,{visible:t(s),"onUpdate:visible":o[3]||(o[3]=f=>B(s)?s.value=f:null),"operate-type":t(D),"row-data":t(k),onSubmitted:t(i)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1})])}}});export{Ee as default};

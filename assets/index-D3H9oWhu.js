import{_ as ne}from"./table-column-setting.vue_vue_type_script_setup_true_lang-Cd5KE_J6.js";import{_ as le}from"./round-delete-Bhw-FsUz.js";import{_ as oe}from"./round-add-C4JFjxMT.js";import{d as Y,n as E,p as ie,r as se,aT as j,q as re,s as de,a5 as K,j as pe,ao as ue,b as me,$ as d,o as S,c as L,w as n,g as e,h as b,t as T,i,f as ce,e4 as _e,e5 as ve,F as fe,ai as ge,H as be,I as q,J as he,B as w,aj as ye,e6 as we,z as $,y as F,e7 as H,e as ke,a9 as W,ak as R,al as Ne,a0 as xe}from"./index-odpIOa9D.js";import{u as De,a as Ue}from"./table-C1XmBycW.js";import{_ as Ce}from"./FormItemGridItem-CgDGNqgG.js";import{_ as $e}from"./Cascader-BGSk_DcO.js";import{_ as je,a as Se}from"./RadioGroup-DN5hCKz_.js";import{_ as Te}from"./DatePicker-pBfmJvE9.js";import{_ as Pe}from"./Grid-DWwU4KsZ.js";import{N as Q}from"./Popconfirm-O65dRAP5.js";import{_ as ze}from"./DataTable-Wz0nH3gM.js";import"./TimePicker-BW_j6-Te.js";import"./Forward-CKxk1mVh.js";const Be=ce("span",null,"匹配前缀",-1),Oe=Y({__name:"inverter-model",props:E({operateType:{},rowData:{},Pagination:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:E(["submitted"],["update:visible"]),setup(v,{emit:P}){const m=ie(v,"visible"),k=P,p=v,a=se(h());function h(){return{iname:"",model:"",manu:"",dbtime:j(0,new Date),isrep:0,ratpower:void 0,transformer:void 0,collline:void 0,pvmodule:void 0,pvcount:void 0,devid:void 0,prename:`逆变器_NB${p.Pagination.itemCount+1}`,pre:0}}function z(){Object.assign(a,h()),p.operateType==="edit"&&p.rowData&&(Object.assign(a,p.rowData),a.dbtime=j(0,a.dbtime))}const{formRef:A,validate:y,restoreValidation:B}=re();de(),K(()=>p.rowData,()=>{z()}),K(m,()=>{m.value&&(_(),z(),B())});const N=()=>{m.value=!1},O=async()=>{var t;await y();const u=JSON.parse(JSON.stringify(a));if(u.dbtime=j(1,u.dbtime),p.operateType==="add"){const{data:s,error:l}=await _e([u]);if(l)return}else{const{data:s,error:l}=await ve([u]);if(l)return}(t=window.$message)==null||t.success(p.operateType==="add"?"添加成功":"修改成功"),N(),k("submitted")},x=pe(),_=async()=>{const{data:u,error:t}=await ue({type:0});function s(l){return l.map(r=>{var f;return{label:r.chlName,value:r.chlName,children:(f=r.devicePojoList)!=null&&f.length?r.devicePojoList.map(g=>({label:g.devName,value:g.id})):[]}})}x.value=s(u)},G={type:"string",required:!0,message:"不能为空",trigger:["input","blur"]},D={type:"number",required:!0,message:"不能为空",trigger:["input","blur"]},I={iname:G,ratpower:D,devid:D},M=me(()=>({add:d("common.add"),edit:d("common.edit")})[p.operateType]);return(u,t)=>{const s=fe,l=Ce,r=ge,f=$e,g=be,U=je,V=q,C=Se,c=Te,Z=Pe,ee=he,J=w,te=q,ae=ye;return S(),L(ae,{show:m.value,"onUpdate:show":t[13]||(t[13]=o=>m.value=o),title:M.value,preset:"card",class:"w-50%"},{footer:n(()=>[e(te,{size:16,justify:"center"},{default:n(()=>[e(J,{onClick:N,class:"w-100px"},{default:n(()=>[b(T(i(d)("common.cancel")),1)]),_:1}),e(J,{type:"primary",class:"w-100px",onClick:O},{default:n(()=>[b(T(i(d)("common.confirm")),1)]),_:1})]),_:1})]),default:n(()=>[e(ee,{ref_key:"formRef",ref:A,model:a,rules:I,"label-placement":"left","label-width":140,"require-mark-placement":"left"},{default:n(()=>[e(Z,{responsive:"screen","item-responsive":""},{default:n(()=>[e(l,{span:"24 m:12",label:"名称",path:"iname"},{default:n(()=>[e(s,{clearable:"",value:a.iname,"onUpdate:value":t[0]||(t[0]=o=>a.iname=o),placeholder:"请输入",maxlength:"64"},null,8,["value"])]),_:1}),e(l,{span:"24 m:12",label:"额定功率(kW)",path:"ratpower"},{default:n(()=>[e(r,{clearable:"",value:a.ratpower,"onUpdate:value":t[1]||(t[1]=o=>a.ratpower=o),placeholder:"请输入",precision:2,style:{width:"100%"}},null,8,["value"])]),_:1}),e(l,{span:"24 m:12",label:"所属设备",path:"devid"},{default:n(()=>[e(f,{value:a.devid,"onUpdate:value":t[2]||(t[2]=o=>a.devid=o),placeholder:"请选择所属设备","expand-trigger":"click",options:x.value,"check-strategy":"child","show-path":!1},null,8,["value","options"])]),_:1}),e(l,{span:"24 m:12",label:"匹配前缀"},{label:n(()=>[e(g,{checked:a.pre,"onUpdate:checked":t[3]||(t[3]=o=>a.pre=o),"checked-value":0,"unchecked-value":1,class:"mr-5px"},null,8,["checked"]),Be]),default:n(()=>[e(s,{clearable:"",value:a.prename,"onUpdate:value":t[4]||(t[4]=o=>a.prename=o),maxlength:"16",disabled:a.pre==1,placeholder:"请输入匹配前缀"},null,8,["value","disabled"])]),_:1}),e(l,{span:"24 m:12",label:"型号",path:"model"},{default:n(()=>[e(s,{clearable:"",value:a.model,"onUpdate:value":t[5]||(t[5]=o=>a.model=o),placeholder:"请输入",maxlength:"64",style:{width:"100%"}},null,8,["value"])]),_:1}),e(l,{span:"24 m:12",label:"样板逆变器 ",path:"isrep"},{default:n(()=>[e(C,{value:a.isrep,"onUpdate:value":t[6]||(t[6]=o=>a.isrep=o),name:"radiogroup"},{default:n(()=>[e(V,null,{default:n(()=>[e(U,{label:i(d)("common.yesOrNo.yes"),value:1},null,8,["label"]),e(U,{label:i(d)("common.yesOrNo.no"),value:0},null,8,["label"])]),_:1})]),_:1},8,["value"])]),_:1}),e(l,{span:"24 m:12",label:"安装时间",path:"dbtime"},{default:n(()=>[e(c,{"formatted-value":a.dbtime,"onUpdate:formattedValue":t[7]||(t[7]=o=>a.dbtime=o),"value-format":"yyyy-MM-dd",type:"date",style:{width:"100%"}},null,8,["formatted-value"])]),_:1}),e(l,{span:"24 m:12",label:"生产商",path:"manu"},{default:n(()=>[e(s,{clearable:"",value:a.manu,"onUpdate:value":t[8]||(t[8]=o=>a.manu=o),placeholder:"请输入",maxlength:"64",style:{width:"100%"}},null,8,["value"])]),_:1}),e(l,{span:"24 m:12",label:"箱变变压器",path:"transformer"},{default:n(()=>[e(r,{value:a.transformer,"onUpdate:value":t[9]||(t[9]=o=>a.transformer=o),placeholder:"请输入",precision:0,style:{width:"100%"}},null,8,["value"])]),_:1}),e(l,{span:"24 m:12",label:"集电线路",path:"collline"},{default:n(()=>[e(r,{clearable:"",value:a.collline,"onUpdate:value":t[10]||(t[10]=o=>a.collline=o),placeholder:"请输入",precision:0,style:{width:"100%"}},null,8,["value"])]),_:1}),e(l,{span:"24 m:12",label:"光组型号",path:"pvmodule"},{default:n(()=>[e(r,{clearable:"",value:a.pvmodule,"onUpdate:value":t[11]||(t[11]=o=>a.pvmodule=o),placeholder:"请输入",precision:0,style:{width:"100%"}},null,8,["value"])]),_:1}),e(l,{span:"24 m:12",label:"光组个数",path:"pvcount"},{default:n(()=>[e(r,{clearable:"",value:a.pvcount,"onUpdate:value":t[12]||(t[12]=o=>a.pvcount=o),placeholder:"请输入",precision:0,style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title"])}}}),Ie={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function X(v){return typeof v=="function"||Object.prototype.toString.call(v)==="[object Object]"&&!Ne(v)}const Xe=Y({name:"stationmanagement_inverterinformation",__name:"index",setup(v){const{columns:P,columnChecks:m,data:k,getData:p,loading:a,mobilePagination:h,searchParams:z,resetSearchParams:A}=De({apiFn:we,apiParams:{page:1,pageSize:20,limit:20,fuzzy:null,_t:new Date().getTime()},immediate:!0,showTotal:!0,columns:()=>[{type:"selection",align:"center",width:48},{key:"iname",title:"名称",align:"center",width:140},{key:"model",title:"型号",align:"center",width:100},{key:"devName",title:"设备名称",align:"center",width:100},{key:"ratpower",title:"额定功率",align:"center",width:100},{key:"manu",title:"生产商",align:"center",width:140},{key:"dbtime",title:"安装时间",align:"center",width:140,render:t=>e("span",null,[j(0,t.dbtime)])},{key:"isrep",title:"是否上报",align:"center",width:100,render:t=>e("span",null,[t.isrep==0?"是":"否"])},{key:"transformer",title:"箱式变压器",align:"center",width:100},{key:"collline",title:"集电线路",align:"center",width:100},{key:"pvmodule",title:"光组型号",align:"center",width:100},{key:"pvcount",title:"光组数量",align:"center",width:100},{key:"operate",title:d("common.operate"),align:"center",width:200,fixed:"right",render:t=>{let s;return e("div",{class:"flex-center gap-8px"},[$(e(w,{type:"primary",ghost:!0,size:"small",onClick:()=>u(t.id)},X(s=d("common.edit"))?s:{default:()=>[s]}),[[F("no-auth"),"inverter:update"]]),$(e(Q,{onPositiveClick:()=>M(t.id)},{default:()=>d("common.confirmDelete"),trigger:()=>{let l;return e(w,{type:"error",ghost:!0,size:"small"},X(l=d("common.delete"))?l:{default:()=>[l]})}}),[[F("no-auth"),"inverter:delete"]])])}}]}),{drawerVisible:y,operateType:B,editingData:N,handleAdd:O,handleEdit:x,checkedRowKeys:_,onBatchDeleted:G,onDeleted:D}=Ue(k,p),I=async()=>{const t=_.value.join(","),{data:s,error:l}=await H({ids:t});l||(_.value=[])},M=async t=>{const{data:s,error:l}=await H({ids:t});l||D()},u=t=>{x(t)};return(t,s)=>{const l=q,r=oe,f=le,g=ne,U=ze,V=xe,C=F("no-auth");return S(),ke("div",Ie,[e(V,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:n(()=>[e(l,{align:"center",wrap:"",justify:"start",class:"lt-sm:w-200px"},{default:n(()=>[b(" 逆变器设置 ")]),_:1})]),"header-extra":n(()=>[e(l,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:n(()=>[$((S(),L(i(w),{onClick:i(O),size:"small",ghost:"",type:"primary"},{icon:n(()=>[e(r,{class:W(["text-icon",{"animate-spin":i(a)}])},null,8,["class"])]),default:n(()=>[b(" "+T(i(d)("common.add")),1)]),_:1},8,["onClick"])),[[C,"inverter:insert"]]),$((S(),L(i(Q),{onPositiveClick:I},{trigger:n(()=>[e(i(w),{size:"small",ghost:"",type:"error",disabled:i(_).length==0},{icon:n(()=>[e(f,{class:W(["text-icon",{"animate-spin":i(a)}])},null,8,["class"])]),default:n(()=>[b(" "+T(i(d)("common.batchDelete")),1)]),_:1},8,["disabled"])]),default:n(()=>[b(" 确认删除选中的项吗？ ")]),_:1})),[[C,"inverter:delete"]]),e(g,{columns:i(m),"onUpdate:columns":s[0]||(s[0]=c=>R(m)?m.value=c:null)},null,8,["columns"])]),_:1})]),default:n(()=>[e(U,{"checked-row-keys":i(_),"onUpdate:checkedRowKeys":s[1]||(s[1]=c=>R(_)?_.value=c:null),columns:i(P),data:i(k),size:"small",loading:i(a),remote:"","row-key":c=>c.id,pagination:i(h),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","loading","row-key","pagination"]),e(Oe,{visible:i(y),"onUpdate:visible":s[2]||(s[2]=c=>R(y)?y.value=c:null),onSubmitted:i(p),"operate-type":i(B),"row-data":i(N),Pagination:i(h)},null,8,["visible","onSubmitted","operate-type","row-data","Pagination"])]),_:1})])}}});export{Xe as default};

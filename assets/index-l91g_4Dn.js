import{_ as X}from"./table-column-setting.vue_vue_type_script_setup_true_lang-B88JK01T.js";import{_ as Y}from"./refresh-4XfYp-vl.js";import{d as q,n as Z,V as L,q as ee,p as te,y as S,o as N,c as M,w as a,g as e,z as b,i as t,$ as p,aj as ae,h as c,t as T,A as se,J as ne,ag as le,B as g,L as W,M as oe,a2 as J,c3 as re,aQ as G,c4 as ie,c5 as ce,e as me,am as B,ab as ue,an as de,ap as pe}from"./index-CQx2Ff8S.js";import{u as _e,a as fe}from"./table-DuoXvLRN.js";import{_ as ge}from"./round-search-LdwHnU1M.js";import{_ as he}from"./round-refresh-BmORLM_E.js";import{C as ye,a as ve}from"./common-BDhfbtg6.js";import{_ as be}from"./FormItemGridItem-CAzxroJb.js";import{_ as we}from"./Grid-Nz05qrRN.js";import{N as C}from"./Popconfirm-Cyyoenj2.js";const ke=q({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:Z(["reset","search"],["update:model"]),setup(_,{emit:D}){const h=D,A=L(),{formRef:y,restoreValidation:w}=ee(),n=te(_,"model");function k(){n.value.fuzzy=void 0,h("search")}async function $(){await w(),h("reset")}async function m(){h("search")}return(U,v)=>{const j=ne,x=be,F=le,O=he,o=g,V=ge,I=W,K=we,P=oe,z=J,R=S("no-space");return N(),M(z,{bordered:!1,size:"small",class:"card-wrapper"},{default:a(()=>[e(P,{ref_key:"formRef",ref:y,model:n.value,"label-placement":"left","label-width":t(A).locale=="en-US"?120:100,"show-feedback":!1,onKeyup:se(m,["enter"])},{default:a(()=>[e(K,{responsive:"screen","item-responsive":""},{default:a(()=>[e(x,{span:"24 s:12 m:6",label:"告警名称",path:"fuzzy",class:"pr-24px"},{default:a(()=>[b(e(j,{autofocus:"",value:n.value.fuzzy,"onUpdate:value":v[0]||(v[0]=f=>n.value.fuzzy=f),placeholder:"请输入告警名称",clearable:"",onClear:k},null,8,["value"]),[[R]])]),_:1}),e(x,{span:"24 s:12 m:6",label:"告警状态",path:"status",class:"pr-24px"},{default:a(()=>[e(F,{filterable:"",clearable:"",placeholder:t(p)("page.manage.alarm.form.status"),value:n.value.status,"onUpdate:value":[v[1]||(v[1]=f=>n.value.status=f),m],options:t(ae)(t(ye))},null,8,["placeholder","value","options"])]),_:1}),e(x,{span:"24 s:12 m:6",class:"pr-24px"},{default:a(()=>[e(I,{class:"w-full flex items-center"},{default:a(()=>[e(o,{onClick:$},{icon:a(()=>[e(O,{class:"text-icon"})]),default:a(()=>[c(" "+T(t(p)("common.reset")),1)]),_:1}),e(o,{type:"primary",ghost:"",onClick:m},{icon:a(()=>[e(V,{class:"text-icon"})]),default:a(()=>[c(" "+T(t(p)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","label-width"])]),_:1})}}}),xe={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function ze(_){return typeof _=="function"||Object.prototype.toString.call(_)==="[object Object]"&&!de(_)}const Te=q({name:"manage_systemalarm",__name:"index",setup(_){const D=L(),h=[{label:"一般",value:0},{label:"低级",value:1},{label:"中级",value:2},{label:"高级",value:3},{label:"严重",value:4}],{columns:A,columnChecks:y,data:w,getData:n,loading:k,mobilePagination:$,searchParams:m,resetSearchParams:U}=_e({apiFn:re,immediate:!0,apiParams:{page:1,limit:20,status:null,fuzzy:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48,fixed:"left"},{key:"aname",title:"告警名称",align:"center",minWidth:120,ellipsis:{tooltip:!0}},{key:"uname",title:"用户",align:"center",width:100},{key:"alevel",title:"告警等级",align:"center",width:100,render:s=>e(G,{size:"small",type:{0:"warning",1:"warning",2:"warning",3:"error",4:"error"}[s.alevel]},{default:()=>{var l;return[(l=h.find(i=>i.value===s.alevel))==null?void 0:l.label]}})},{key:"status",title:p("page.manage.alarm.status"),align:"center",width:120,render:s=>{(s.status===void 0||s.status===null)&&(s.status=0);const r={0:"error",1:"success"},l=p(ve[s.status]);return e(G,{size:"small",type:r[s.status]},ze(l)?l:{default:()=>[l]})}},{key:"dbtime",title:"发生时间",align:"center",width:180},{key:"adec",title:"告警描述",align:"center",minWidth:160,ellipsis:{tooltip:!0}},{key:"operate",title:p("common.operate"),align:"center",width:130,fixed:"right",render:s=>e("div",{class:"flex-center gap-8px"},[s.status==0&&e(C,{onPositiveClick:()=>z(s.id+"")},{default:()=>"确定要确认该告警数据吗？",trigger:()=>b(e(g,{type:"primary",ghost:!0,size:"small"},{default:()=>[c("确认")]}),[[S("no-auth"),"sys.system.alarm.update"]])}),e(C,{onPositiveClick:()=>f(s.id+"")},{default:()=>"确定要删除该告警数据吗？",trigger:()=>b(e(g,{type:"error",ghost:!0,size:"small"},{default:()=>[c("删除")]}),[[S("no-auth"),"sys.system.alarm.delete"]])})])}]}),{drawerVisible:v,operateType:j,editingData:x,handleAdd:F,handleEdit:O,checkedRowKeys:o,onBatchDeleted:V,onDeleted:I,closeDrawer:K}=fe(w,n),P=()=>{z(o.value.join(","))},z=async s=>{var i,u;const{data:r,error:l}=await ie({ids:s});l||(n(),(i=window.$message)==null||i.destroyAll(),(u=window.$message)==null||u.success("确认成功"),o.value=[])},R=()=>{f(o.value.join(","))},f=async s=>{var i,u;const{data:r,error:l}=await ce({ids:s});l||(n(),(i=window.$message)==null||i.destroyAll(),(u=window.$message)==null||u.success("删除成功"))};return(s,r)=>{const l=Y,i=X,u=W,Q=pe,H=J,E=S("no-auth");return N(),me("div",xe,[e(ke,{model:t(m),"onUpdate:model":r[0]||(r[0]=d=>B(m)?m.value=d:null),onReset:t(U),onSearch:t(n)},null,8,["model","onReset","onSearch"]),e(H,{title:"系统告警",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":a(()=>[e(u,null,{default:a(()=>[e(t(C),{onPositiveClick:P},{trigger:a(()=>[b((N(),M(t(g),{size:"small",ghost:"",type:"primary",disabled:t(o).length===0},{default:a(()=>[c(" 批量确认 ")]),_:1},8,["disabled"])),[[E,"sys.system.alarm.update"]])]),default:a(()=>[c(" 确定要确认选中的数据吗？ ")]),_:1}),e(t(C),{onPositiveClick:R},{trigger:a(()=>[b((N(),M(t(g),{size:"small",ghost:"",type:"error",disabled:t(o).length===0},{default:a(()=>[c(" 批量删除 ")]),_:1},8,["disabled"])),[[E,"sys.system.alarm.delete"]])]),default:a(()=>[c(" 确定要删除选中的数据吗？ ")]),_:1}),e(t(g),{size:"small",onClick:t(n)},{icon:a(()=>[e(l,{class:ue(["text-icon",{"animate-spin":t(k)}])},null,8,["class"])]),default:a(()=>[c(" "+T(t(p)("common.refresh")),1)]),_:1},8,["onClick"]),e(i,{columns:t(y),"onUpdate:columns":r[1]||(r[1]=d=>B(y)?y.value=d:null)},null,8,["columns"])]),_:1})]),default:a(()=>[e(Q,{"checked-row-keys":t(o),"onUpdate:checkedRowKeys":r[2]||(r[2]=d=>B(o)?o.value=d:null),columns:t(A),data:t(w),size:"small","flex-height":!t(D).isMobile,"scroll-x":702,loading:t(k),remote:"","row-key":d=>d.id,pagination:t($),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1})])}}});export{Te as default};

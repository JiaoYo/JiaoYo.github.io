import{_ as Y}from"./table-header-operation.vue_vue_type_script_setup_true_lang-DblglBez.js";import{d as K,q as V,s as A,v as q,x as Z,b as ee,r as te,y as oe,K as B,o as P,c as E,w as n,g as e,h as F,t as I,i as t,$ as p,M as L,L as U,A as H,C as ae,D as W,B as G,E as J,ae as ne,af as se,ad as Q,a4 as le,av as re,aq as ie,e as ce,ag as $,ah as me}from"./index-7Q9xZuwa.js";import{a as pe,b as ue,f as de,c as _e}from"./multipe-yIOM3_rv.js";import{u as fe,a as he}from"./table-G6_8Abm0.js";import{_ as ye}from"./round-search-BQOA9W6m.js";import{_ as ge}from"./round-refresh-DJiiF7wv.js";import{_ as ve}from"./FormItemGridItem-DYTXkfwP.js";import{_ as we}from"./Grid-CRtcNhSF.js";import{h as j}from"./permission-BYoerBbx.js";import{_ as be}from"./Popconfirm-BEMrdOuM.js";import{_ as De}from"./DataTable-n3fP4Loy.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-D8fMBsYv.js";import"./setting-outlined-V9qGIWHT.js";import"./export-oh2-I3ZA.js";import"./refresh-av0Mcmzj.js";import"./round-delete-BZFRn3Yp.js";import"./round-plus-Cy8c1zzO.js";import"./Upload-CwzIyBrH.js";import"./Progress-DAZ1S5w7.js";import"./Forward-BzUEeUAa.js";const ke=K({name:"OperateDrawer",__name:"operate-drawer",props:V({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:V(["submitted"],["update:visible"]),setup(d,{emit:z}){const r=d,h=z,u=A(d,"visible"),{formRef:i,validate:b,restoreValidation:S}=q(),{defaultRequiredRule:y}=Z(),M=ee(()=>({add:"添加多元组",edit:"编辑多元组"})[r.operateType]),s=te(D());function D(){return{tname:"",sysparam:1}}const k={tname:y};function C(){Object.assign(s,D()),r.operateType==="edit"&&r.rowData&&Object.assign(s,r.rowData)}function g(){u.value=!1}async function c(){var v,m;if(await b(),r.operateType==="add"){const{data:x,error:_}=await pe([{tname:s.tname,sysparam:s.sysparam}]);_||((v=window.$message)==null||v.success(p("common.addSuccess")),g(),h("submitted"))}else{const{data:x,error:_}=await ue([{id:r.rowData.id,tname:s.tname,sysparam:s.sysparam}]);_||((m=window.$message)==null||m.success(p("common.updateSuccess")),g(),h("submitted"))}}return oe(u,()=>{u.value&&(C(),S())}),(v,m)=>{const x=H,_=ae,R=W,N=G,T=J,o=ne,a=se,l=B("no-space");return P(),E(a,{show:u.value,"onUpdate:show":m[1]||(m[1]=w=>u.value=w),"display-directive":"show",width:360},{default:n(()=>[e(o,{title:M.value,"native-scrollbar":!1,closable:""},{footer:n(()=>[e(T,{size:16},{default:n(()=>[e(N,{onClick:g},{default:n(()=>[F(I(t(p)("common.cancel")),1)]),_:1}),e(N,{type:"primary",onClick:c},{default:n(()=>[F(I(t(p)("common.confirm")),1)]),_:1})]),_:1})]),default:n(()=>[e(R,{ref_key:"formRef",ref:i,model:s,rules:k,onKeyup:L(c,["enter"])},{default:n(()=>[e(_,{label:"名称",path:"tname"},{default:n(()=>[U(e(x,{value:s.tname,"onUpdate:value":m[0]||(m[0]=w=>s.tname=w),placeholder:"请输入名称",clearable:""},null,8,["value"]),[[l]])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),xe=K({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:V(["reset","search"],["update:model"]),setup(d,{emit:z}){const r=z,{formRef:h,restoreValidation:u}=q(),i=A(d,"model");function b(){i.value.fuzzy="",r("search")}async function S(){await u(),r("reset")}async function y(){r("search")}return(M,s)=>{const D=H,k=ve,C=ge,g=G,c=ye,v=J,m=we,x=W,_=Q,R=B("no-space");return P(),E(_,{bordered:!1,size:"small",class:"card-wrapper"},{default:n(()=>[e(x,{ref_key:"formRef",ref:h,model:i.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:L(y,["enter"])},{default:n(()=>[e(m,{responsive:"screen","item-responsive":""},{default:n(()=>[e(k,{span:"24 s:12 m:6",label:"名称",path:"fuzzy",class:"pr-24px"},{default:n(()=>[U(e(D,{clearable:"",value:i.value.fuzzy,"onUpdate:value":s[0]||(s[0]=N=>i.value.fuzzy=N),placeholder:"请输入名称",onClear:b},null,8,["value"]),[[R]])]),_:1}),e(k,{span:"24 m:12",class:"pr-24px"},{default:n(()=>[e(v,{class:"w-full"},{default:n(()=>[e(g,{onClick:S},{icon:n(()=>[e(C,{class:"text-icon"})]),default:n(()=>[F(" "+I(t(p)("common.reset")),1)]),_:1}),e(g,{type:"primary",ghost:"",onClick:y},{icon:n(()=>[e(c,{class:"text-icon"})]),default:n(()=>[F(" "+I(t(p)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),Ne={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function O(d){return typeof d=="function"||Object.prototype.toString.call(d)==="[object Object]"&&!me(d)}const Le=K({name:"manage_multipegroup",__name:"index",setup(d){const z=le(),{columns:r,columnChecks:h,data:u,getData:i,loading:b,mobilePagination:S,searchParams:y,resetSearchParams:M}=fe({apiFn:de,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,fuzzy:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48,disabled:o=>o.sysparam==0},{key:"tname",title:"名称",align:"center",minWidth:160,ellipsis:{tooltip:!0}},{key:"sysparam",title:"系统内置",align:"center",width:140,render:o=>{o.sysparam==null&&(o.sysparam=0);const a={0:"success",1:"info"},l=p(re[o.sysparam]);return e(ie,{size:"small",type:a[o.sysparam]},O(l)?l:{default:()=>[l]})}},{key:"operate",title:p("common.operate"),align:"center",width:160,render:o=>{let a;return o.sysparam!=0?e("div",{class:"flex-center gap-8px"},[U(e(G,{type:"primary",ghost:!0,size:"small",onClick:()=>N(o.id)},O(a=p("common.edit"))?a:{default:()=>[a]}),[[B("no-auth"),"sys.multiple.update"]]),e(be,{onPositiveClick:()=>R(o.id)},{default:()=>p("common.confirmDelete"),trigger:()=>{let l;return U(e(G,{type:"error",ghost:!0,size:"small"},O(l=p("common.delete"))?l:{default:()=>[l]}),[[B("no-auth"),"sys.multiple.delete"]])}})]):null}}]}),{drawerVisible:s,operateType:D,editingData:k,handleAdd:C,handleEdit:g,checkedRowKeys:c,onBatchDeleted:v,onDeleted:m,closeDrawer:x}=he(u,i);async function _(){console.log(c.value),T(c.value,o=>{v()})}function R(o){console.log(o),T([o],a=>{m()})}function N(o){g(o)}async function T(o,a){const{data:l,error:w}=await _e(o);if(!w)a&&a(l);else return!1}return(o,a)=>{const l=Y,w=De,X=Q;return P(),ce("div",Ne,[e(xe,{model:t(y),"onUpdate:model":a[0]||(a[0]=f=>$(y)?y.value=f:null),onReset:t(M),onSearch:t(i)},null,8,["model","onReset","onSearch"]),e(X,{title:"多元组列表",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":n(()=>[e(l,{columns:t(h),"onUpdate:columns":a[1]||(a[1]=f=>$(h)?h.value=f:null),"disabled-delete":t(c).length===0,loading:t(b),onAdd:t(C),onDelete:_,onRefresh:t(i),"is-view-add-button":t(j)("sys.multiple.insert"),"is-view-delete-button":t(j)("sys.multiple.delete")},null,8,["columns","disabled-delete","loading","onAdd","onRefresh","is-view-add-button","is-view-delete-button"])]),default:n(()=>[e(w,{"checked-row-keys":t(c),"onUpdate:checkedRowKeys":a[2]||(a[2]=f=>$(c)?c.value=f:null),columns:t(r),data:t(u),size:"small","flex-height":!t(z).isMobile,"scroll-x":962,loading:t(b),remote:"","row-key":f=>f.id,pagination:t(S),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(ke,{visible:t(s),"onUpdate:visible":a[3]||(a[3]=f=>$(s)?s.value=f:null),"operate-type":t(D),"row-data":t(k),onSubmitted:t(i)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1})])}}});export{Le as default};

import{_ as Y}from"./export-B7kCC9mw.js";import{e as K}from"./exportExcel-DNhOb6yd.js";import{d as O,s,D as Q,aR as N,i as X,b as z,o as i,f as n,w as o,e as C,J as Z,N as ee,aH as te,h as ae,c as p,G as S,aE as ne,ax as le,aY as oe,B as se,g as v,t as j,az as re,ei as ue,a2 as ie,fq as ce,aC as pe,b4 as me,W as de}from"./index-BctnL3sF.js";import{u as ge}from"./usePageData-CCvYFzq4.js";import{_ as _e}from"./RadioButton-2NOTGrvq.js";import{_ as ve}from"./DatePicker-BdrH3DIX.js";const fe={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},ye={style:{"margin-top":"20px"}},he={style:{"margin-top":"20px",display:"flex","justify-content":"flex-end"}},be=O({name:"reportmanagement_debug",__name:"index",setup(xe){const r=s("year"),D=s([{label:"月",value:"month"},{label:"年",value:"year"}]),U=s([{label:"1 每页",value:1},{label:"10 每页",value:10},{label:"20 每页",value:20},{label:"50 每页",value:50},{label:"100 每页",value:100}]),c=s(1),d=s(100),f=s(0),l=Q({monthTime:String(N(3,null)),yearTime:String(N(4,null)),creater:null}),B=t=>{r.value=t,c.value=1,u()},m=s([]),u=async()=>{let t={page:c.value,limit:d.value,dates:r.value=="month"?l.monthTime:l.yearTime};l.creater&&(t.userid=l.creater);const{data:e}=await ce(t);m.value=e.list,f.value=Number(e.total)},{pageData:g,getData:P,nextPage:V}=ge(me),H=async t=>{const e=t.currentTarget,_=e.scrollTop;e.scrollTop+e.offsetHeight>=e.scrollHeight&&g.data.length<g.total&&(await V(),await pe(),setTimeout(()=>{e.scrollTop=_}))},L=s(1),R=async t=>{l.creater=t,t||setTimeout(()=>{L.value++},500),u()};async function y(t){c.value=1,u()}X(()=>{P({usertypes:"2,3"}),u()});const $=[{key:"proname",title:"项目名称",align:"center",render(t){return n("div",{class:" "},[n("span",null,[t.proname||"未知"])])}},{key:"projectdebugcount",title:"项目调试任务数",align:"center",sorter:(t,e)=>t.projectdebugcount-e.projectdebugcount,width:180},{key:"debugcount",title:"调试数量",align:"center",sorter:(t,e)=>t.debugcount-e.debugcount,width:180},{key:"debugpercent",title:"调试占比",align:"center",width:180,render(t){return n("div",{style:{}},[t.debugpercent])}}],q=[{key:"proname",title:"项目名称",align:"center",render(t){return n("div",{class:" "},[n("span",null,[t.proname||"未知"])])}},{key:"projectdebugcount",title:"项目调试任务数",align:"center",sorter:(t,e)=>t.projectdebugcount-e.projectdebugcount,width:180},{key:"userstat",title:"调试占比",align:"center",render(t){return n("div",{style:{whiteSpace:"pre-line"}},[t.userstat?t.userstat.replaceAll("，",`
`):""])}}],E=t=>{u()},F=t=>{c.value=1,u()},h=s(window.innerHeight-325),G=()=>{K(m.value,l.creater?{proname:"项目名称",projectdebugcount:"项目调试任务数",debugcount:"调试数量",debugpercent:"调试占比"}:{proname:"项目名称",projectdebugcount:"项目调试任务数",userstat:"调试占比"},`调试报表_${r.value=="month"?l.monthTime:l.yearTime}`)};return(t,e)=>{const _=te,b=ee,I=_e,M=ne,x=ve,k=Z,T=se,A=Y,w=re,J=ue,W=ie;return i(),z("div",fe,[n(W,{bordered:"",style:{height:"100%"}},{default:o(()=>[n(k,{align:"center"},{default:o(()=>[n(b,{label:"用户",path:"creater","label-placement":"left","show-feedback":!1},{default:o(()=>[n(_,{clearable:"",filterable:"",value:l.creater,"onUpdate:value":[e[0]||(e[0]=a=>l.creater=a),R],placeholder:"请选择","label-field":"username",size:"small","value-field":"id",options:ae(g).data,onScroll:H},null,8,["value","options"])]),_:1}),n(b,{label:"查询日期","label-placement":"left","show-feedback":!1},{default:o(()=>[n(k,null,{default:o(()=>[n(M,{value:r.value,"onUpdate:value":[e[1]||(e[1]=a=>r.value=a),B],size:"small"},{default:o(()=>[(i(!0),z(le,null,oe(D.value,a=>(i(),p(I,{key:a.value,value:a.value,label:a.label},null,8,["value","label"]))),128))]),_:1},8,["value"]),r.value==="year"?(i(),p(x,{key:0,size:"small","formatted-value":l.yearTime,"onUpdate:formattedValue":[e[2]||(e[2]=a=>l.yearTime=a),y],type:"year","value-format":"yyyy",style:{width:"120px"}},null,8,["formatted-value"])):S("",!0),r.value=="month"?(i(),p(x,{key:1,size:"small","formatted-value":l.monthTime,"onUpdate:formattedValue":[e[3]||(e[3]=a=>l.monthTime=a),y],type:"month","value-format":"yyyy-MM",style:{width:"120px"}},null,8,["formatted-value"])):S("",!0)]),_:1}),n(T,{type:"primary",size:"small",ghost:"",style:{"margin-left":"20px"},onClick:u},{default:o(()=>e[6]||(e[6]=[v("查询")])),_:1,__:[6]}),n(T,{style:{"margin-left":"20px"},size:"small",onClick:G},{icon:o(()=>[n(A,{class:"text-icon"})]),default:o(()=>[e[7]||(e[7]=v(" "+j("导出")))]),_:1,__:[7]})]),_:1})]),_:1}),C("div",ye,[l.creater?(i(),p(w,{key:0,columns:$,data:m.value,"max-height":h.value},null,8,["data","max-height"])):(i(),p(w,{key:1,columns:q,data:m.value,"max-height":h.value},null,8,["data","max-height"]))]),C("div",he,[n(J,{page:c.value,"onUpdate:page":[e[4]||(e[4]=a=>c.value=a),E],"page-size":d.value,"onUpdate:pageSize":[e[5]||(e[5]=a=>d.value=a),F],"item-count":f.value,"show-size-picker":"","show-quick-jumper":"","page-sizes":U.value},{prefix:o(({itemCount:a})=>[v(" 共 "+j(a)+" 项 ",1)]),_:1},8,["page","page-size","item-count","page-sizes"])])]),_:1})])}}}),Se=de(be,[["__scopeId","data-v-8e8246b4"]]);export{Se as default};

import{_ as X}from"./table-header-operation.vue_vue_type_script_setup_true_lang-sZrXAUWR.js";import{d as P,q as K,s as q,v as E,x as Y,b as ee,r as te,y as ae,K as F,o as j,c as L,w as o,g as e,h as U,t as I,i as t,$ as u,M as H,L as V,A as W,C as oe,aV as ne,D as Z,B as G,E as J,aa as se,ab as le,a9 as Q,Z as re,ar as ie,am as ce,e as me,ac as B,ad as ue}from"./index-BthjjP8Z.js";import{a as pe,b as de,f as _e,c as fe}from"./multipe-BSvqUfdo.js";import{u as he,a as ye}from"./table-DgUtF0JO.js";import{_ as ve}from"./round-search-D0y4Bi99.js";import{_ as ge}from"./round-refresh-7YBMJmxM.js";import{_ as we}from"./FormItemGridItem-Cf_xNcQf.js";import{_ as be}from"./Grid-CrjQrgB8.js";import{h as A}from"./permission-DgnWzPLf.js";import{_ as De}from"./Popconfirm-DUBjdYuJ.js";import{_ as ke}from"./DataTable-DVNKf1bg.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-P1qKwD6q.js";import"./setting-outlined-CB-n0fXZ.js";import"./round-delete-imzaxX0A.js";import"./refresh-516o5uee.js";import"./Upload-CXW3Rb5a.js";import"./Progress-CegqNBwu.js";import"./Forward-B9_DMOnd.js";const Ne=P({name:"OperateDrawer",__name:"operate-drawer",props:K({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:K(["submitted"],["update:visible"]),setup(_,{emit:x}){const i=_,h=x,p=q(_,"visible"),{formRef:c,validate:b,restoreValidation:S}=E(),{defaultRequiredRule:y}=Y(),$=ee(()=>({add:"添加多元组",edit:"编辑多元组"})[i.operateType]),s=te(D());function D(){return{tname:"",sysparam:1}}const k={tname:y};function z(){Object.assign(s,D()),i.operateType==="edit"&&i.rowData&&Object.assign(s,i.rowData)}function v(){p.value=!1}async function m(){var g,l;if(await b(),i.operateType==="add"){const{data:N,error:d}=await pe([{tname:s.tname,sysparam:s.sysparam}]);d||((g=window.$message)==null||g.success(u("common.addSuccess")),v(),h("submitted"))}else{const{data:N,error:d}=await de([{id:i.rowData.id,tname:s.tname,sysparam:s.sysparam}]);d||((l=window.$message)==null||l.success(u("common.updateSuccess")),v(),h("submitted"))}}return ae(p,()=>{p.value&&(z(),S())}),(g,l)=>{const N=W,d=oe,C=ne,R=Z,M=G,a=J,n=se,r=le,T=F("no-space");return j(),L(r,{show:p.value,"onUpdate:show":l[2]||(l[2]=w=>p.value=w),"display-directive":"show",width:360},{default:o(()=>[e(n,{title:$.value,"native-scrollbar":!1,closable:""},{footer:o(()=>[e(a,{size:16},{default:o(()=>[e(M,{onClick:v},{default:o(()=>[U(I(t(u)("common.cancel")),1)]),_:1}),e(M,{type:"primary",onClick:m},{default:o(()=>[U(I(t(u)("common.confirm")),1)]),_:1})]),_:1})]),default:o(()=>[e(R,{ref_key:"formRef",ref:c,model:s,rules:k,onKeyup:H(m,["enter"])},{default:o(()=>[e(d,{label:"名称",path:"tname"},{default:o(()=>[V(e(N,{value:s.tname,"onUpdate:value":l[0]||(l[0]=w=>s.tname=w),placeholder:"请输入名称",clearable:""},null,8,["value"]),[[T]])]),_:1}),e(d,{label:"是否为系统参数",path:"sysparam"},{default:o(()=>[e(C,{value:s.sysparam,"onUpdate:value":l[1]||(l[1]=w=>s.sysparam=w),"checked-value":0,"unchecked-value":1},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),xe=P({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:K(["reset","search"],["update:model"]),setup(_,{emit:x}){const i=x,{formRef:h,restoreValidation:p}=E(),c=q(_,"model");function b(){c.value.fuzzy="",i("search")}async function S(){await p(),i("reset")}async function y(){i("search")}return($,s)=>{const D=W,k=we,z=ge,v=G,m=ve,g=J,l=be,N=Z,d=Q,C=F("no-space");return j(),L(d,{bordered:!1,size:"small",class:"card-wrapper"},{default:o(()=>[e(N,{ref_key:"formRef",ref:h,model:c.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:H(y,["enter"])},{default:o(()=>[e(l,{responsive:"screen","item-responsive":""},{default:o(()=>[e(k,{span:"24 s:12 m:6",label:"名称",path:"fuzzy",class:"pr-24px"},{default:o(()=>[V(e(D,{clearable:"",value:c.value.fuzzy,"onUpdate:value":s[0]||(s[0]=R=>c.value.fuzzy=R),placeholder:"请输入名称",onClear:b},null,8,["value"]),[[C]])]),_:1}),e(k,{span:"24 m:12",class:"pr-24px"},{default:o(()=>[e(g,{class:"w-full"},{default:o(()=>[e(v,{onClick:S},{icon:o(()=>[e(z,{class:"text-icon"})]),default:o(()=>[U(" "+I(t(u)("common.reset")),1)]),_:1}),e(v,{type:"primary",ghost:"",onClick:y},{icon:o(()=>[e(m,{class:"text-icon"})]),default:o(()=>[U(" "+I(t(u)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),Se={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function O(_){return typeof _=="function"||Object.prototype.toString.call(_)==="[object Object]"&&!ue(_)}const Ee=P({name:"manage_multipegroup",__name:"index",setup(_){const x=re(),{columns:i,columnChecks:h,data:p,getData:c,loading:b,mobilePagination:S,searchParams:y,resetSearchParams:$}=he({apiFn:_e,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,fuzzy:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48,disabled:a=>a.sysparam==0},{key:"tname",title:"名称",align:"center",minWidth:160,ellipsis:{tooltip:!0}},{key:"sysparam",title:"是否为系统参数",align:"center",width:140,render:a=>{a.sysparam==null&&(a.sysparam=0);const n={0:"success",1:"error"},r=u(ie[a.sysparam]);return e(ce,{size:"small",type:n[a.sysparam]},O(r)?r:{default:()=>[r]})}},{key:"operate",title:u("common.operate"),align:"center",width:160,render:a=>{let n;return a.sysparam!=0?e("div",{class:"flex-center gap-8px"},[V(e(G,{type:"primary",ghost:!0,size:"small",onClick:()=>R(a.id)},O(n=u("common.edit"))?n:{default:()=>[n]}),[[F("no-auth"),"sys.multiple.update"]]),e(De,{onPositiveClick:()=>C(a.id)},{default:()=>u("common.confirmDelete"),trigger:()=>{let r;return V(e(G,{type:"error",ghost:!0,size:"small"},O(r=u("common.delete"))?r:{default:()=>[r]}),[[F("no-auth"),"sys.multiple.delete"]])}})]):null}}]}),{drawerVisible:s,operateType:D,editingData:k,handleAdd:z,handleEdit:v,checkedRowKeys:m,onBatchDeleted:g,onDeleted:l,closeDrawer:N}=ye(p,c);async function d(){console.log(m.value),M(m.value,a=>{g()})}function C(a){console.log(a),M([a],n=>{l()})}function R(a){v(a)}async function M(a,n){const{data:r,error:T}=await fe(a);if(!T)n&&n(r);else return!1}return(a,n)=>{const r=X,T=ke,w=Q;return j(),me("div",Se,[e(xe,{model:t(y),"onUpdate:model":n[0]||(n[0]=f=>B(y)?y.value=f:null),onReset:t($),onSearch:t(c)},null,8,["model","onReset","onSearch"]),e(w,{title:"多元组列表",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":o(()=>[e(r,{columns:t(h),"onUpdate:columns":n[1]||(n[1]=f=>B(h)?h.value=f:null),"disabled-delete":t(m).length===0,loading:t(b),onAdd:t(z),onDelete:d,onRefresh:t(c),"is-view-add-button":t(A)("sys.multiple.insert"),"is-view-delete-button":t(A)("sys.multiple.delete")},null,8,["columns","disabled-delete","loading","onAdd","onRefresh","is-view-add-button","is-view-delete-button"])]),default:o(()=>[e(T,{"checked-row-keys":t(m),"onUpdate:checkedRowKeys":n[2]||(n[2]=f=>B(m)?m.value=f:null),columns:t(i),data:t(p),size:"small","flex-height":!t(x).isMobile,"scroll-x":962,loading:t(b),remote:"","row-key":f=>f.id,pagination:t(S),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(Ne,{visible:t(s),"onUpdate:visible":n[3]||(n[3]=f=>B(s)?s.value=f:null),"operate-type":t(D),"row-data":t(k),onSubmitted:t(c)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1})])}}});export{Ee as default};

import{b$ as ie,c0 as fe,c1 as se,d as I,bU as _e,j as x,b as re,J as D,aG as he,o as _,e as z,f as i,y as T,Z as B,c2 as V,ax as $,a6 as ce,c as S,w as m,g as s,t as ve,am as ge,a9 as ye,aX as be,X as xe,E as we,av as Le,aw as Se}from"./index-DvMCw3Rq.js";import{u as E}from"./echarts-zI3DYWN6.js";import{L as ke}from"./installCanvasRenderer-iCPGNWhM.js";import{f as Te,a as Ae,b as Ce,c as Ne,d as Ie}from"./home-C5yZlt_V.js";import{a as ze,_ as Re}from"./Grid-BUt7FBa5.js";import{_ as Oe}from"./Progress-CRnql7vs.js";import{_ as De}from"./DataTable-BnT_71C1.js";import"./Forward-Cwgm3-FY.js";var le=1/0,$e=17976931348623157e292;function Fe(t){if(!t)return t===0?t:0;if(t=ie(t),t===le||t===-le){var a=t<0?-1:1;return a*$e}return t===t?t:0}function He(t){var a=Fe(t),l=a%1;return a===a?l?a-l:a:0}var Me=fe.isFinite,Pe=Math.min;function Ge(t){var a=Math[t];return function(l,o){if(l=ie(l),o=o==null?0:Pe(He(o),292),o&&Me(l)){var d=(se(l)+"e").split("e"),c=a(d[0]+"e"+(+d[1]+o));return d=(se(c)+"e").split("e"),+(d[0]+"e"+(+d[1]-o))}return a(l)}}var Be=Ge("round");const Ve=t=>1-Math.pow(1-t,5);function Ee(t){const{from:a,to:l,duration:o,onUpdate:d,onFinish:c}=t,u=()=>{const p=performance.now(),e=Math.min(p-g,o),n=a+(l-a)*Ve(e/o);if(e===o){c();return}d(n),requestAnimationFrame(u)},g=performance.now();u()}const je={to:{type:Number,default:0},precision:{type:Number,default:0},showSeparator:Boolean,locale:String,from:{type:Number,default:0},active:{type:Boolean,default:!0},duration:{type:Number,default:2e3},onFinish:Function},Ue=I({name:"NumberAnimation",props:je,setup(t){const{localeRef:a}=_e("name"),{duration:l}=t,o=x(t.from),d=re(()=>{const{locale:r}=t;return r!==void 0?r:a.value});let c=!1;const u=r=>{o.value=r},g=()=>{var r;o.value=t.to,c=!1,(r=t.onFinish)===null||r===void 0||r.call(t)},p=(r=t.from,O=t.to)=>{c=!0,o.value=t.from,r!==O&&Ee({from:r,to:O,duration:l,onUpdate:u,onFinish:g})},e=re(()=>{var r;const A=Be(o.value,t.precision).toFixed(t.precision).split("."),N=new Intl.NumberFormat(d.value),j=(r=N.formatToParts(.5).find(b=>b.type==="decimal"))===null||r===void 0?void 0:r.value,h=t.showSeparator?N.format(Number(A[0])):A[0],f=A[1];return{integer:h,decimal:f,decimalSeparator:j}});function n(){c||p()}return D(()=>{he(()=>{t.active&&p()})}),Object.assign({formattedValue:e},{play:n})},render(){const{formattedValue:{integer:t,decimal:a,decimalSeparator:l}}=this;return[t,a?l:null,a]}}),We={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"},Xe=i("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 0 1 1-1h16a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1zm0 9h18M8 21h8m-6-4l-.5 4m4.5-4l.5 4"},null,-1),qe=[Xe];function Je(t,a){return _(),z("svg",We,[...qe])}const Ye={name:"tabler-device-imac",render:Je},Ze={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"},Ke=i("path",{fill:"currentColor",d:"M4 20V9h4v11zM4 8V4h4v4zm6 12v-8h4v8zm0-9V7h4v4zm6 9v-5h4v5zm0-6v-4h4v4z"},null,-1),Qe=[Ke];function et(t,a){return _(),z("svg",Ze,[...Qe])}const tt={name:"material-symbols-stacked-bar-chart",render:et},at=I({name:"LineChart",__name:"collectTrends",props:{collectTrendsList:{type:Object,default:()=>({})}},setup(t){const a=t;T(()=>a.collectTrendsList,async e=>{u()});const l=B(),o=x(null),{domRef:d,updateOptions:c}=E(()=>({tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}},backgroundColor:"#6a7985",textStyle:{color:"rgb(224, 224, 224)"},valueFormatter:function(e){return(e+""!="undefined"?e:"--")+"条"}},grid:{left:"10%",right:"10%",bottom:"10%",top:"5%"},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value",axisLabel:{formatter:"{value}"}},series:[{color:"#1890ff",type:"line",name:"",smooth:!0,emphasis:{focus:"series"},lineStyle:{width:1},areaStyle:{color:new ke(0,0,0,1,[{offset:0,color:"rgba(24, 144, 255,0.3)"},{offset:1,color:"rgba(24, 144, 255,0)"}],!1),shadowColor:"rgba(24, 144, 255,0.9)",shadowBlur:20},data:[],connectNulls:!0}]}));async function u(){await new Promise(e=>{setTimeout(e,1e3)}),c(e=>{var n,y;return e.xAxis.data=(n=a.collectTrendsList)==null?void 0:n.map(r=>r.date),e.series[0].data=(y=a.collectTrendsList)==null?void 0:y.map(r=>r.dailycount),e})}function g(){c((e,n)=>{const y=n();return e.series[0].name=y.series[0].name,e})}async function p(){u()}return T(()=>l.locale,()=>{g()}),p(),D(()=>{o.value=window.setInterval(()=>{console.log("mainHomeLineChart timer")},1e3*60*5)}),V(()=>{o.value!==null&&(clearInterval(o.value),o.value=null)}),(e,n)=>(_(),z("div",{ref_key:"domRef",ref:d,class:"h-220px overflow-hidden"},null,512))}}),nt=$(at,[["__scopeId","data-v-e24412c2"]]),ot=I({name:"LineChart",__name:"assetsType",props:{data:{type:Object,default:()=>({})}},setup(t){const a=t;T(()=>a.data,async e=>{u()});const l=B(),o=x(null),{domRef:d,updateOptions:c}=E(()=>({tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{show:!1},grid:{left:"5%",right:"5%",bottom:"2%",top:"5%",containLabel:!0},series:[{type:"pie",selectedMode:"single",radius:[0,"30%"],label:{position:"inner",fontSize:10},labelLine:{show:!1},data:[]},{type:"pie",radius:["45%","60%"],labelLine:{length:30},label:{rich:{a:{color:"#6E7079",lineHeight:22,align:"center"},hr:{borderColor:"#8C8D8E",width:"100%",borderWidth:1,height:0},b:{color:"#4C5058",fontSize:14,fontWeight:"bold",lineHeight:33},per:{color:"#fff",backgroundColor:"#4C5058",padding:[3,4],borderRadius:4}}},data:[]}]}));async function u(){await new Promise(e=>{setTimeout(e,1e3)}),c(e=>{e.series[0].data=Object.keys(a.data).map(y=>({name:y,value:Object.values(a.data[y]).reduce((r,O)=>r+O,0)}));const n=[];return Object.keys(a.data).map(y=>a.data[y]).forEach(y=>{for(let r in y)y.hasOwnProperty(r)&&n.push({name:r,value:y[r]})}),e.series[1].data=n,e})}function g(){c((e,n)=>(n(),e))}async function p(){u()}return T(()=>l.locale,()=>{g()}),p(),D(()=>{o.value=window.setInterval(()=>{console.log("mainHomeLineChart timer")},1e3*60*5)}),V(()=>{o.value!==null&&(clearInterval(o.value),o.value=null)}),(e,n)=>(_(),z("div",{ref_key:"domRef",ref:d,class:"h-220px overflow-hidden"},null,512))}}),st=$(ot,[["__scopeId","data-v-af811bcc"]]),rt=I({name:"LineChart",__name:"LogNums",props:{data:{type:Object,default:()=>({})}},setup(t){const a=t;T(()=>a.data,async e=>{u()});const l=B(),o=x(null),{domRef:d,updateOptions:c}=E(()=>({tooltip:{trigger:"item",formatter:"{b}: {c}条"},xAxis:{type:"value",show:!1},yAxis:{type:"category",data:[]},grid:{left:"3%",right:"10%",bottom:"3%",top:"5%",containLabel:!0},series:[{data:[],type:"bar",label:{show:!0,position:"right"},barWidth:30}]}));async function u(){await new Promise(e=>{setTimeout(e,1e3)}),c(e=>(e.yAxis.data=a.data.map(n=>n.logname),e.series[0].data=a.data.map(n=>n.count),e))}function g(){c((e,n)=>e)}async function p(){u()}return T(()=>l.locale,()=>{g()}),p(),D(()=>{o.value=window.setInterval(()=>{console.log("mainHomeLineChart timer")},1e3*60*5)}),V(()=>{o.value!==null&&(clearInterval(o.value),o.value=null)}),(e,n)=>(_(),z("div",{ref_key:"domRef",ref:d,class:"overflow-hidden",style:ce({height:a.data.length>4?`${a.data.length*50}px`:"200px"})},null,4))}}),lt=$(rt,[["__scopeId","data-v-8a011224"]]),it=I({name:"LineChart",__name:"alarmNums",props:{auditAlertList:{type:Object,default:()=>({})}},setup(t){const a=t;T(()=>a.auditAlertList,async e=>{u()});const l=B(),o=x(null),{domRef:d,updateOptions:c}=E(()=>({tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}},backgroundColor:"#6a7985",textStyle:{color:"rgb(224, 224, 224)"},valueFormatter:function(e){return(e+""!="undefined"?e:"--")+"条"}},xAxis:{type:"category",data:[]},yAxis:{type:"value"},grid:{left:"10%",right:"10%",bottom:"10%",top:"5%"},series:[{data:[],type:"line",smooth:!0}]}));async function u(){await new Promise(e=>{setTimeout(e,1e3)}),c(e=>(e.xAxis.data=a.auditAlertList.map(n=>n.logname),e.series[0].data=a.auditAlertList.map(n=>n.count),e))}function g(){c((e,n)=>(n(),e))}async function p(){u()}return T(()=>l.locale,()=>{g()}),p(),D(()=>{o.value=window.setInterval(()=>{console.log("mainHomeLineChart timer")},1e3*60*5)}),V(()=>{o.value!==null&&(clearInterval(o.value),o.value=null)}),(e,n)=>(_(),z("div",{ref_key:"domRef",ref:d,class:"h-220px overflow-hidden"},null,512))}}),ct=$(it,[["__scopeId","data-v-bf106832"]]),ut=I({name:"LineChart",__name:"securityNums",props:{data:{type:Object,default:()=>({})}},setup(t){const a=t;T(()=>a.data,async e=>{u()});const l=B(),o=x(null),{domRef:d,updateOptions:c}=E(()=>({tooltip:{trigger:"item",formatter:"{b}: {c}条"},xAxis:{type:"value",show:!1},yAxis:{type:"category",data:[]},grid:{left:"3%",right:"10%",bottom:"3%",top:"5%",containLabel:!0},series:[{data:[],type:"bar",label:{show:!0,position:"right"},barWidth:30}]}));async function u(){await new Promise(e=>{setTimeout(e,1e3)}),c(e=>(e.yAxis.data=a.data.map(n=>n.logname),e.series[0].data=a.data.map(n=>n.count),e))}function g(){c((e,n)=>e)}async function p(){u()}return T(()=>l.locale,()=>{g()}),p(),D(()=>{o.value=window.setInterval(()=>{console.log("mainHomeLineChart timer")},1e3*60*5)}),V(()=>{o.value!==null&&(clearInterval(o.value),o.value=null)}),(e,n)=>(_(),z("div",{ref_key:"domRef",ref:d,class:"overflow-hidden",style:ce({height:a.data.length>4?`${a.data.length*50}px`:"200px"})},null,4))}}),dt=$(ut,[["__scopeId","data-v-f13dc3d1"]]),R=t=>(Le("data-v-632d9d84"),t=t(),Se(),t),mt={class:"mb-10px"},pt=R(()=>i("span",{class:"font-size-18px"},"磁盘占用率：",-1)),ft={style:{"font-family":"dsdigits","font-size":"2rem","margin-left":"1rem"}},_t=R(()=>i("span",{class:"ml-5px font-size-20px"},"%",-1)),ht={class:"mb-10px"},vt=R(()=>i("span",{class:"font-size-18px"},"内存占用率：",-1)),gt={style:{"font-family":"dsdigits","font-size":"2rem","margin-left":"1rem"}},yt=R(()=>i("span",{class:"ml-5px font-size-20px"},"%",-1)),bt={class:"mb-10px"},xt=R(()=>i("span",{class:"font-size-18px"},"CPU占用率：",-1)),wt={style:{"font-family":"dsdigits","font-size":"2rem","margin-left":"1rem"}},Lt=R(()=>i("span",{class:"ml-5px font-size-20px"},"%",-1)),St={style:{display:"flex","align-items":"center"}},kt={class:"iconClass bg-#faad14"},Tt={class:"w-80% ml-15px"},At={style:{"font-family":"dsdigits","font-size":"2rem","margin-left":"1rem"}},Ct=R(()=>i("span",{class:"ml-10px font-size-20px"},"条",-1)),Nt={style:{display:"flex","align-items":"center"}},It={class:"iconClass bg-#3f8fff"},zt={class:"w-80% ml-15px"},Rt={style:{"font-family":"dsdigits","font-size":"2rem","margin-left":"1rem"}},Ot={class:"ml-15px"},Dt=I({name:"home",__name:"index",setup(t){const a=[{label:"近一天",value:0},{label:"近一周",value:1},{label:"近一月",value:2},{label:"近半年",value:3},{label:"近一年",value:4}],l=[{title:"日志源名称",key:"cname"},{title:"状态",key:"enable",width:120,render:h=>s(ge,{type:h.enable==0?"success":"error"},{default:()=>[h.enable==0?"启用":"禁用"]})}],o=x(),d=x(2),c=async()=>{const{data:h,error:f}=await Te({dateType:d.value});f||(o.value=h)};c();const u=x(),g=x(),p=x(2),e=async()=>{const{data:h,error:f}=await Ae({dateType:p.value});f||(g.value=Number(h.total),p.value==3||p.value==4?u.value=h.data.map(b=>(b.date=b.dateStr,b)).sort((b,C)=>{let w=new Date(b.date),L=new Date(C.date);return w-L}):u.value=h.data.sort((b,C)=>{let w=new Date(b.date),L=new Date(C.date);return w-L}))};e();const n=x();(async()=>{const{data:h,error:f}=await Ce();f||(n.value=h)})();const r=x();(async()=>{const{data:h,error:f}=await Ne();f||(r.value=h)})();const A=x(2),N=x(),j=async()=>{const{data:h,error:f}=await Ie({dateType:A.value});f||(N.value=h)};return j(),(h,f)=>{const b=Ue,C=Oe,w=ye,L=ze,ue=tt,de=Ye,F=be,me=De,U=Re,W=xe,pe=we;return _(),S(pe,{vertical:"",size:16},{default:m(()=>[s(U,{"x-gap":16,"y-gap":16,responsive:"screen","item-responsive":""},{default:m(()=>[s(L,{span:"24 s:24 xl:5 m:12"},{default:m(()=>[s(w,{title:"🟢🔴 系统信息",bordered:!0,class:"card-wrapper h-100%","content-style":{padding:"10px 30px"}},{default:m(()=>{var v,k,H,M,P,G,X,q,J,Y,Z,K,Q,ee,te,ae,ne,oe;return[i("div",mt,[pt,i("span",ft,[s(b,{ref:"numberAnimationInstRef",from:0,precision:2,to:(H=(k=(v=n.value)==null?void 0:v.systemStatus)==null?void 0:k.disk)==null?void 0:H.replace("%","")},null,8,["to"])]),_t,s(C,{type:"line",percentage:Number((G=(P=(M=n.value)==null?void 0:M.systemStatus)==null?void 0:P.disk)==null?void 0:G.replace("%","")),processing:"","show-indicator":!1},null,8,["percentage"])]),i("div",ht,[vt,i("span",gt,[s(b,{ref:"numberAnimationInstRef",from:0,precision:2,to:(J=(q=(X=n.value)==null?void 0:X.systemStatus)==null?void 0:q.mem)==null?void 0:J.replace("%","")},null,8,["to"])]),yt,s(C,{type:"line",percentage:Number((K=(Z=(Y=n.value)==null?void 0:Y.systemStatus)==null?void 0:Z.mem)==null?void 0:K.replace("%","")),processing:"","show-indicator":!1},null,8,["percentage"])]),i("div",bt,[xt,i("span",wt,[s(b,{ref:"numberAnimationInstRef",from:0,precision:2,to:(te=(ee=(Q=n.value)==null?void 0:Q.systemStatus)==null?void 0:ee.cpu)==null?void 0:te.replace("%","")},null,8,["to"])]),Lt,s(C,{type:"line",percentage:Number((oe=(ne=(ae=n.value)==null?void 0:ae.systemStatus)==null?void 0:ne.cpu)==null?void 0:oe.replace("%","")),processing:"","show-indicator":!1},null,8,["percentage"])])]}),_:1})]),_:1}),s(L,{span:"24 s:24 xl:5 m:12"},{default:m(()=>[s(w,{title:"📖 日志接收总数",bordered:!0,class:"card-wrapper h-150px"},{default:m(()=>[i("div",St,[i("div",kt,[s(ue,{style:{"font-size":"38px"}})]),i("div",Tt,[i("div",null,[i("span",At,[s(b,{ref:"numberAnimationInstRef",from:0,to:g.value||0},null,8,["to"])]),Ct])])])]),_:1}),s(w,{title:"📖 日志源资产数",bordered:!0,class:"card-wrapper h-150px mt-16px"},{default:m(()=>{var v,k,H,M,P,G;return[i("div",Nt,[i("div",It,[s(de,{style:{"font-size":"32px"}})]),i("div",zt,[i("div",null,[i("span",Rt,[s(b,{ref:"numberAnimationInstRef",from:0,to:(k=(v=n.value)==null?void 0:v.logSourceDevAsset)==null?void 0:k.aunum},null,8,["to"])]),i("span",Ot,"占授权总数"+ve(((M=(H=n.value)==null?void 0:H.logSourceDevAsset)==null?void 0:M.cmnum)||0)+"%",1)]),s(C,{type:"line",percentage:(G=(P=n.value)==null?void 0:P.logSourceDevAsset)==null?void 0:G.cmnum,processing:"","show-indicator":!1},null,8,["percentage"])])])]}),_:1})]),_:1}),s(L,{span:"24 s:24 xl:7 m:12"},{default:m(()=>[s(w,{title:"📖 日志源资产类型",bordered:!0,class:"card-wrapper h-100%"},{default:m(()=>{var v,k;return[((v=n.value)==null?void 0:v.logSoursceAssetType.length)>0?(_(),S(st,{key:0,data:(k=n.value)==null?void 0:k.logSoursceAssetType},null,8,["data"])):(_(),S(F,{key:1,description:"无数据",class:"h-220px"}))]}),_:1})]),_:1}),s(L,{span:"24 s:24 xl:7 m:12"},{default:m(()=>[s(w,{title:"📖 日志源接收状态",bordered:!0,class:"card-wrapper h-100%",style:{"min-height":"220px"}},{default:m(()=>{var v;return[s(me,{columns:l,data:(v=n.value)==null?void 0:v.logSoursceList,size:"small","flex-height":"",bordered:!1,remote:"","row-key":k=>k.id,class:"sm:h-full"},null,8,["data","row-key"])]}),_:1})]),_:1})]),_:1}),s(U,{"x-gap":16,"y-gap":16,responsive:"screen","item-responsive":""},{default:m(()=>[s(L,{span:"24 s:24 m:12"},{default:m(()=>[s(w,{title:"📈 日志采集趋势",bordered:!0,class:"card-wrapper h-100%"},{"header-extra":m(()=>[s(W,{value:p.value,"onUpdate:value":[f[0]||(f[0]=v=>p.value=v),e],options:a,style:{width:"120px"}},null,8,["value"])]),default:m(()=>[u.value&&u.value.length>0?(_(),S(nt,{key:p.value,collectTrendsList:u.value},null,8,["collectTrendsList"])):(_(),S(F,{key:1,description:"无数据",class:"h-220px"}))]),_:1})]),_:1}),s(L,{span:"24 s:24 m:12"},{default:m(()=>[s(w,{title:"📈 审计告警数量趋势",bordered:!0,class:"card-wrapper h-100%","content-style":{padding:"10px"}},{"header-extra":m(()=>[s(W,{value:d.value,"onUpdate:value":[f[1]||(f[1]=v=>d.value=v),c],options:a,style:{width:"120px"}},null,8,["value"])]),default:m(()=>[o.value&&o.value.length>0?(_(),S(ct,{key:d.value,auditAlertList:o.value},null,8,["auditAlertList"])):(_(),S(F,{key:1,description:"无数据",class:"h-220px"}))]),_:1})]),_:1})]),_:1}),s(U,{"x-gap":16,"y-gap":16,responsive:"screen","item-responsive":""},{default:m(()=>[s(L,{span:"24 s:24 m:12"},{default:m(()=>[s(w,{title:"📊 日志源日志数量TOP10",bordered:!0,class:"card-wrapper h-100%","content-style":{padding:"10px"}},{default:m(()=>[r.value&&r.value.length>0?(_(),S(lt,{key:0,data:r.value},null,8,["data"])):(_(),S(F,{key:1,description:"无数据",class:"h-220px"}))]),_:1})]),_:1}),s(L,{span:"24 s:24 m:12"},{default:m(()=>[s(w,{title:"📊 安全事件类别数量Top10",bordered:!0,class:"card-wrapper h-100%","content-style":{padding:"10px"}},{"header-extra":m(()=>[s(W,{value:A.value,"onUpdate:value":[f[2]||(f[2]=v=>A.value=v),j],options:a,style:{width:"120px"}},null,8,["value"])]),default:m(()=>[N.value&&N.value.length>0?(_(),S(dt,{key:A.value,data:N.value},null,8,["data"])):(_(),S(F,{key:1,description:"无数据",class:"h-220px"}))]),_:1})]),_:1})]),_:1})]),_:1})}}}),Et=$(Dt,[["__scopeId","data-v-632d9d84"]]);export{Et as default};

import{_ as oe}from"./table-column-setting.vue_vue_type_script_setup_true_lang-CM2xdBkx.js";import{_ as ie}from"./round-delete-DpzqcVJg.js";import{_ as se}from"./round-add-CQHbe8sA.js";import{d as Y,p as W,q as re,r as de,aw as S,s as ue,v as pe,ab as E,k as me,aN as ce,b as _e,$ as u,o as $,c as q,w as n,g as e,h,t as P,i as o,f as ve,ep as fe,eq as ge,L as be,aG as he,O as we,aW as ye,P as F,aX as ke,Q as Ne,B as N,aH as xe,er as De,A as C,z as V,es as K,e as Ue,af as H,aI as R,aJ as Ce,aL as Se,a6 as $e}from"./index-CT5lpOF1.js";import{u as Pe,a as Te}from"./table-C535fDDg.js";import{_ as je}from"./lodash-BxmCOPnE.js";import{_ as ze}from"./FormItemGridItem-DbRFmkCS.js";import{_ as Oe}from"./Cascader-j4hOM9Gf.js";import{_ as Me}from"./DatePicker-CivW7jaV.js";import{_ as Be}from"./Grid-Bb-_oBzE.js";import{N as Q}from"./Popconfirm-B-j7rzwN.js";const Ie=ve("span",null,"匹配前缀",-1),Le=Y({__name:"inverter-model",props:W({operateType:{},rowData:{},Pagination:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:W(["submitted"],["update:visible"]),setup(f,{emit:T}){const m=re(f,"visible"),x=T,p=f,a=de(w());function w(){return{iname:"",model:"",manu:"",dbtime:S(0,new Date),isrep:0,ratpower:void 0,transformer:void 0,collline:void 0,pvmodule:void 0,pvcount:void 0,devid:void 0,prename:"",pre:1,unum:""}}function j(){Object.assign(a,w()),p.operateType==="edit"&&p.rowData&&(Object.assign(a,p.rowData),a.dbtime=S(0,a.dbtime))}const{formRef:A,validate:y,restoreValidation:z}=ue();pe(),E(()=>p.rowData,()=>{j()}),E(m,()=>{m.value&&(G(),j(),z())});const D=()=>{m.value=!1},O=async()=>{var t;await y();const i=JSON.parse(JSON.stringify(a));if(i.dbtime=S(1,i.dbtime),p.operateType==="add"){const{data:d,error:s}=await fe([i]);if(s)return}else{const{data:d,error:s}=await ge([i]);if(s)return}(t=window.$message)==null||t.success(p.operateType==="add"?"添加成功":"修改成功"),D(),x("submitted")},M=je.debounce(O,1e3,{leading:!0,trailing:!1}),c=me(),G=async()=>{const{data:i,error:t}=await ce({type:0});function d(s){return s.map(_=>{var g;return{label:_.chlName,value:_.chlName,children:(g=_.devicePojoList)!=null&&g.length?_.devicePojoList.map(b=>({label:b.devName,value:b.id})):[]}})}c.value=d(i)},B=(i,t)=>{i&&(a.devid=i,a.prename=t==null?void 0:t.label)},I={type:"string",required:!0,message:"不能为空",trigger:["input","blur"]},U={type:"number",required:!0,message:"不能为空",trigger:["input","blur"]},L={iname:I,ratpower:U,devid:U},r=_e(()=>({add:u("common.add"),edit:u("common.edit")})[p.operateType]);return(i,t)=>{const d=be,s=ze,_=he,g=Oe,b=we,k=ye,v=F,Z=ke,ee=Me,te=Be,ae=Ne,J=N,ne=F,le=xe;return $(),q(le,{show:m.value,"onUpdate:show":t[14]||(t[14]=l=>m.value=l),title:r.value,preset:"card",class:"w-50%"},{footer:n(()=>[e(ne,{size:16,justify:"center"},{default:n(()=>[e(J,{onClick:D,class:"w-100px"},{default:n(()=>[h(P(o(u)("common.cancel")),1)]),_:1}),e(J,{type:"primary",class:"w-100px",onClick:o(M)},{default:n(()=>[h(P(o(u)("common.confirm")),1)]),_:1},8,["onClick"])]),_:1})]),default:n(()=>[e(ae,{ref_key:"formRef",ref:A,model:a,rules:L,"label-placement":"left","label-width":140,"require-mark-placement":"left"},{default:n(()=>[e(te,{responsive:"screen","item-responsive":""},{default:n(()=>[e(s,{span:"24 m:12",label:"名称",path:"iname"},{default:n(()=>[e(d,{clearable:"",value:a.iname,"onUpdate:value":t[0]||(t[0]=l=>a.iname=l),placeholder:"请输入",maxlength:"64"},null,8,["value"])]),_:1}),e(s,{span:"24 m:12",label:"额定功率(MW)",path:"ratpower"},{default:n(()=>[e(_,{clearable:"",value:a.ratpower,"onUpdate:value":t[1]||(t[1]=l=>a.ratpower=l),placeholder:"请输入",precision:3,style:{width:"100%"}},null,8,["value"])]),_:1}),e(s,{span:"24 m:12",label:"所属设备",path:"devid"},{default:n(()=>[e(g,{value:a.devid,"onUpdate:value":[t[2]||(t[2]=l=>a.devid=l),B],placeholder:"请选择所属设备","expand-trigger":"click",options:c.value,"check-strategy":"child","show-path":!1},null,8,["value","options"])]),_:1}),e(s,{span:"24 m:12",label:"匹配前缀"},{label:n(()=>[e(b,{checked:a.pre,"onUpdate:checked":t[3]||(t[3]=l=>a.pre=l),"checked-value":0,"unchecked-value":1,class:"mr-5px"},null,8,["checked"]),Ie]),default:n(()=>[e(d,{clearable:"",value:a.prename,"onUpdate:value":t[4]||(t[4]=l=>a.prename=l),maxlength:"16",disabled:a.pre==1,placeholder:"请输入匹配前缀"},null,8,["value","disabled"])]),_:1}),e(s,{span:"24 m:12",label:"型号",path:"model"},{default:n(()=>[e(d,{clearable:"",value:a.model,"onUpdate:value":t[5]||(t[5]=l=>a.model=l),placeholder:"请输入",maxlength:"64",style:{width:"100%"}},null,8,["value"])]),_:1}),e(s,{span:"24 m:12",label:"样板逆变器 ",path:"isrep"},{default:n(()=>[e(Z,{value:a.isrep,"onUpdate:value":t[6]||(t[6]=l=>a.isrep=l),name:"radiogroup"},{default:n(()=>[e(v,null,{default:n(()=>[e(k,{label:o(u)("common.yesOrNo.yes"),value:1},null,8,["label"]),e(k,{label:o(u)("common.yesOrNo.no"),value:0},null,8,["label"])]),_:1})]),_:1},8,["value"])]),_:1}),e(s,{span:"24 m:12",label:"安装时间",path:"dbtime"},{default:n(()=>[e(ee,{"formatted-value":a.dbtime,"onUpdate:formattedValue":t[7]||(t[7]=l=>a.dbtime=l),"value-format":"yyyy-MM-dd",type:"date",style:{width:"100%"}},null,8,["formatted-value"])]),_:1}),e(s,{span:"24 m:12",label:"生产商",path:"manu"},{default:n(()=>[e(d,{clearable:"",value:a.manu,"onUpdate:value":t[8]||(t[8]=l=>a.manu=l),placeholder:"请输入",maxlength:"64",style:{width:"100%"}},null,8,["value"])]),_:1}),e(s,{span:"24 m:12",label:"箱式变压器",path:"transformer"},{default:n(()=>[e(d,{value:a.transformer,"onUpdate:value":t[9]||(t[9]=l=>a.transformer=l),placeholder:"请输入",precision:0,style:{width:"100%"}},null,8,["value"])]),_:1}),e(s,{span:"24 m:12",label:"集电线路",path:"collline"},{default:n(()=>[e(d,{clearable:"",value:a.collline,"onUpdate:value":t[10]||(t[10]=l=>a.collline=l),placeholder:"请输入",precision:0,style:{width:"100%"}},null,8,["value"])]),_:1}),e(s,{span:"24 m:12",label:"机组编号",path:"unum"},{default:n(()=>[e(d,{clearable:"",value:a.unum,"onUpdate:value":t[11]||(t[11]=l=>a.unum=l),placeholder:"请输入",precision:0,style:{width:"100%"}},null,8,["value"])]),_:1}),e(s,{span:"24 m:12",label:"光组型号",path:"pvmodule"},{default:n(()=>[e(d,{clearable:"",value:a.pvmodule,"onUpdate:value":t[12]||(t[12]=l=>a.pvmodule=l),placeholder:"请输入",precision:0,style:{width:"100%"}},null,8,["value"])]),_:1}),e(s,{span:"24 m:12",label:"光组个数",path:"pvcount"},{default:n(()=>[e(_,{clearable:"",value:a.pvcount,"onUpdate:value":t[13]||(t[13]=l=>a.pvcount=l),placeholder:"请输入",precision:0,style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title"])}}}),Ve={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function X(f){return typeof f=="function"||Object.prototype.toString.call(f)==="[object Object]"&&!Ce(f)}const Xe=Y({name:"stationmanagement_inverterinformation",__name:"index",setup(f){const{columns:T,columnChecks:m,data:x,getData:p,loading:a,mobilePagination:w,searchParams:j,resetSearchParams:A}=Pe({apiFn:De,apiParams:{page:1,pageSize:20,limit:20,fuzzy:null,_t:new Date().getTime()},immediate:!0,showTotal:!0,columns:()=>[{type:"selection",align:"center",width:48},{key:"iname",title:"名称",align:"center",width:140},{key:"model",title:"型号",align:"center",width:100},{key:"devName",title:"设备名称",align:"center",width:100},{key:"ratpower",title:"额定功率(MW)",align:"center",width:140},{key:"manu",title:"生产商",align:"center",width:140},{key:"dbtime",title:"安装时间",align:"center",width:140,render:r=>e("span",null,[S(0,r.dbtime)])},{key:"isrep",title:"样板逆变器",align:"center",width:100,render:r=>e("span",null,[r.isrep==1?"是":"否"])},{key:"transformer",title:"箱式变压器",align:"center",width:100},{key:"collline",title:"集电线路",align:"center",width:100},{key:"unum",title:"机组编号",align:"center",width:180},{key:"pvmodule",title:"光组型号",align:"center",width:100},{key:"pvcount",title:"光组数量",align:"center",width:100},{key:"operate",title:u("common.operate"),align:"center",width:200,fixed:"right",render:r=>{let i;return e("div",{class:"flex-center gap-8px"},[C(e(N,{type:"primary",ghost:!0,size:"small",onClick:()=>L(r.id)},X(i=u("common.edit"))?i:{default:()=>[i]}),[[V("no-auth"),"inverter:update"]]),C(e(Q,{onPositiveClick:()=>U(r.id)},{default:()=>u("common.confirmDelete"),trigger:()=>{let t;return e(N,{type:"error",ghost:!0,size:"small"},X(t=u("common.delete"))?t:{default:()=>[t]})}}),[[V("no-auth"),"inverter:delete"]])])}}]}),{drawerVisible:y,operateType:z,editingData:D,handleAdd:O,handleEdit:M,checkedRowKeys:c,onBatchDeleted:G,onDeleted:B}=Te(x,p),I=async()=>{const r=c.value.join(","),{data:i,error:t}=await K({ids:r});t||(c.value=[])},U=async r=>{const{data:i,error:t}=await K({ids:r});t||B()},L=r=>{M(r)};return(r,i)=>{const t=F,d=se,s=ie,_=oe,g=Se,b=$e,k=V("no-auth");return $(),Ue("div",Ve,[e(b,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:n(()=>[e(t,{align:"center",wrap:"",justify:"start",class:"lt-sm:w-200px"},{default:n(()=>[h(" 逆变器设置 ")]),_:1})]),"header-extra":n(()=>[e(t,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:n(()=>[C(($(),q(o(N),{onClick:o(O),size:"small",ghost:"",type:"primary"},{icon:n(()=>[e(d,{class:H(["text-icon",{"animate-spin":o(a)}])},null,8,["class"])]),default:n(()=>[h(" "+P(o(u)("common.add")),1)]),_:1},8,["onClick"])),[[k,"inverter:insert"]]),C(($(),q(o(Q),{onPositiveClick:I},{trigger:n(()=>[e(o(N),{size:"small",ghost:"",type:"error",disabled:o(c).length==0},{icon:n(()=>[e(s,{class:H(["text-icon",{"animate-spin":o(a)}])},null,8,["class"])]),default:n(()=>[h(" "+P(o(u)("common.batchDelete")),1)]),_:1},8,["disabled"])]),default:n(()=>[h(" 确认删除选中的项吗？ ")]),_:1})),[[k,"inverter:delete"]]),e(_,{columns:o(m),"onUpdate:columns":i[0]||(i[0]=v=>R(m)?m.value=v:null)},null,8,["columns"])]),_:1})]),default:n(()=>[e(g,{"checked-row-keys":o(c),"onUpdate:checkedRowKeys":i[1]||(i[1]=v=>R(c)?c.value=v:null),columns:o(T),data:o(x),size:"small",loading:o(a),remote:"","row-key":v=>v.id,pagination:o(w),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","loading","row-key","pagination"]),e(Le,{visible:o(y),"onUpdate:visible":i[2]||(i[2]=v=>R(y)?y.value=v:null),onSubmitted:o(p),"operate-type":o(z),"row-data":o(D),Pagination:o(w)},null,8,["visible","onSubmitted","operate-type","row-data","Pagination"])]),_:1})])}}});export{Xe as default};

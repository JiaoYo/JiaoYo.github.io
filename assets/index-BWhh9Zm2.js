import{_ as X}from"./table-header-operation.vue_vue_type_script_setup_true_lang-CoKhvjWF.js";import{d as I,n as j,s as A,p as E,q as Y,b as Z,r as ee,ae as te,D as F,o as K,c as L,w as a,g as e,h as M,t as O,i as t,$ as m,E as P,J as G,K as oe,O as H,B as U,N as J,ah as ae,ai as ne,F as se,ad as Q,a3 as le,aE as re,az as ie,e as ce,al as B,am as ue,an as me}from"./index-CPo--K2z.js";import{u as de,a as pe}from"./table-LW222zAQ.js";import{p as _e,q as fe,r as ge,s as he}from"./log-DEfQS7Hr.js";import{_ as ye}from"./round-search-C9foa4Fb.js";import{_ as ve}from"./round-refresh-OSot4Wia.js";import{_ as we}from"./lodash-Btl-Lpgv.js";import{_ as be}from"./FormItemGridItem-D7sgA0LY.js";import{_ as De}from"./Grid-BKcUr_na.js";import{h as q}from"./permission-9qOQaUIE.js";import{_ as ke}from"./Popconfirm-B2uCCKAi.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-Bz40TOlU.js";import"./setting-outlined-Dge4M2aI.js";import"./export-062aMd-k.js";import"./refresh-DUUol91f.js";import"./round-delete-BusdVuEw.js";import"./round-plus-CdXc2KSH.js";import"./Upload-t9zrUxE_.js";import"./Progress-DPO-N_MM.js";const Se=I({name:"OperateDrawer",__name:"operate-drawer",props:j({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:j(["submitted"],["update:visible"]),setup(p,{emit:C}){const r=p,g=C,d=A(p,"visible"),{formRef:i,validate:D,restoreValidation:R}=E(),{defaultRequiredRule:y}=Y(),k=Z(()=>({add:"新增日志源类别",edit:"编辑日志源类别"})[r.operateType]),l=ee(v());function v(){return{id:void 0,cname:"",sysparam:0}}const T={cname:y};function S(){Object.assign(l,v()),r.operateType==="edit"&&r.rowData&&Object.assign(l,r.rowData)}function w(){d.value=!1}async function c(){var h,u;if(await D(),r.operateType==="add"){const{data:N,error:_}=await _e([l]);_||((h=window.$message)==null||h.success(m("common.addSuccess")),w(),g("submitted"))}else{const{data:N,error:_}=await fe([l]);_||((u=window.$message)==null||u.success(m("common.updateSuccess")),w(),g("submitted"))}}return te(d,()=>{d.value&&(S(),R())}),(h,u)=>{const N=G,_=oe,$=H,x=U,z=J,n=ae,o=ne,s=F("no-space");return K(),L(o,{show:d.value,"onUpdate:show":u[1]||(u[1]=b=>d.value=b),"display-directive":"show",width:360},{default:a(()=>[e(n,{title:k.value,"native-scrollbar":!1,closable:""},{footer:a(()=>[e(z,{size:16},{default:a(()=>[e(x,{onClick:w},{default:a(()=>[M(O(t(m)("common.cancel")),1)]),_:1}),e(x,{type:"primary",onClick:c},{default:a(()=>[M(O(t(m)("common.confirm")),1)]),_:1})]),_:1})]),default:a(()=>[e($,{ref_key:"formRef",ref:i,model:l,rules:T},{default:a(()=>[e(_,{label:"名称",path:"cname"},{default:a(()=>[P(e(N,{clearable:"",value:l.cname,"onUpdate:value":u[0]||(u[0]=b=>l.cname=b),placeholder:"请输入名称"},null,8,["value"]),[[s]])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Ne=I({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:j(["reset","search"],["update:model"]),setup(p,{emit:C}){const r=C,{formRef:g,restoreValidation:d}=E(),i=A(p,"model");function D(){i.value.fuzzy=void 0,r("search")}async function R(){await d(),r("reset")}async function y(){r("search")}const k=we.debounce(y,1e3,{leading:!0,trailing:!1});return(l,v)=>{const T=G,S=be,w=ve,c=U,h=ye,u=J,N=De,_=H,$=Q,x=F("no-space");return K(),L($,{bordered:!1,size:"small",class:"card-wrapper"},{default:a(()=>[e(_,{ref_key:"formRef",ref:g,model:i.value,"label-placement":"left","label-width":80,"show-feedback":!1,onKeyup:se(t(k),["enter"])},{default:a(()=>[e(N,{responsive:"screen","item-responsive":"","x-gap":12,"y-gap":12},{default:a(()=>[e(S,{span:"24 s:12 m:8 l:6",label:"名称",path:"fuzzy"},{default:a(()=>[P(e(T,{clearable:"",value:i.value.fuzzy,"onUpdate:value":v[0]||(v[0]=z=>i.value.fuzzy=z),placeholder:"请输入名称关键字",onClear:D},null,8,["value"]),[[x]])]),_:1}),e(S,{span:"24 s:12 m:8 l:6"},{default:a(()=>[e(u,{class:"w-full"},{default:a(()=>[e(c,{onClick:R},{icon:a(()=>[e(w,{class:"text-icon"})]),default:a(()=>[M(" "+O(t(m)("common.reset")),1)]),_:1}),e(c,{type:"primary",ghost:"",onClick:t(k)},{icon:a(()=>[e(h,{class:"text-icon"})]),default:a(()=>[M(" "+O(t(m)("common.search")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","onKeyup"])]),_:1})}}}),xe={class:"min-h-500px flex-col-stretch gap-16px overflow-auto lt-sm:overflow-auto"};function V(p){return typeof p=="function"||Object.prototype.toString.call(p)==="[object Object]"&&!ue(p)}const Ge=I({name:"logretrieval_logsourcecategory",__name:"index",setup(p){const C=le(),{columns:r,columnChecks:g,data:d,getData:i,loading:D,mobilePagination:R,searchParams:y,resetSearchParams:k}=de({apiFn:ge,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,fuzzy:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48},{key:"cname",title:"名称",align:"center",width:240},{key:"sysparam",title:"系统内置",align:"center",width:240,render:n=>{n.sysparam==null&&(n.sysparam=0);const o={0:"success",1:"info"},s=m(re[n.sysparam]);return e(ie,{size:"small",type:o[n.sysparam]},V(s)?s:{default:()=>[s]})}},{key:"operate",title:m("common.operate"),align:"center",width:130,render:n=>{let o;return n.sysparam!=0?e("div",{class:"flex-center gap-8px"},[P(e(U,{type:"primary",ghost:!0,size:"small",onClick:()=>x(n.id)},V(o=m("common.edit"))?o:{default:()=>[o]}),[[F("no-auth"),"log.source.category.update"]]),e(ke,{onPositiveClick:()=>$(n.id)},{default:()=>m("common.confirmDelete"),trigger:()=>{let s;return P(e(U,{type:"error",ghost:!0,size:"small"},V(s=m("common.delete"))?s:{default:()=>[s]}),[[F("no-auth"),"log.source.category.delete"]])}})]):null}}]}),{drawerVisible:l,operateType:v,editingData:T,handleAdd:S,handleEdit:w,checkedRowKeys:c,onBatchDeleted:h,onDeleted:u,closeDrawer:N}=pe(d,i);async function _(){console.log(c.value),z(c.value.join(","),n=>{h()})}function $(n){console.log(n),z(n,o=>{u()})}function x(n){w(n)}async function z(n,o){const{data:s,error:b}=await he(n);if(!b)o&&o(s);else return!1}return(n,o)=>{const s=X,b=me,W=Q;return K(),ce("div",xe,[e(Ne,{model:t(y),"onUpdate:model":o[0]||(o[0]=f=>B(y)?y.value=f:null),onReset:t(k),onSearch:t(i)},null,8,["model","onReset","onSearch"]),e(W,{title:"日志源类别",bordered:!1,size:"small",class:"sm:flex-1-hidden"},{"header-extra":a(()=>[e(s,{columns:t(g),"onUpdate:columns":o[1]||(o[1]=f=>B(g)?g.value=f:null),"disabled-delete":t(c).length===0,"is-view-add-button":t(q)("log.source.category.insert"),"is-view-delete-button":t(q)("log.source.category.delete"),loading:t(D),onAdd:t(S),onDelete:_,onRefresh:t(i)},null,8,["columns","disabled-delete","is-view-add-button","is-view-delete-button","loading","onAdd","onRefresh"])]),default:a(()=>[e(b,{"checked-row-keys":t(c),"onUpdate:checkedRowKeys":o[2]||(o[2]=f=>B(c)?c.value=f:null),columns:t(r),data:t(d),size:"small","flex-height":!t(C).isMobile,"scroll-x":962,loading:t(D),remote:"","row-key":f=>f.id,pagination:t(R),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(Se,{visible:t(l),"onUpdate:visible":o[3]||(o[3]=f=>B(l)?l.value=f:null),"operate-type":t(v),"row-data":t(T),onSubmitted:t(i)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1})])}}});export{Ge as default};

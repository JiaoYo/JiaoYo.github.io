import{o as b,e as V,f as h,d as B,q as A,r as X,v as Y,y as N,c as k,w as a,g as l,h as s,i as T,t as Z,C as M,z as q,aV as y,bV as J,bW as R,I as j,B as H,aj as P,an as ee,H as F,K as O,L as G,ag as te,M as le,N as ae,O as K,j as z,aB as ne,bX as se,bY as oe,bZ as ue,bT as ie,bU as de,a1 as re}from"./index-CqzOHcIS.js";import{f as me,a as pe,b as ce,c as ve,d as fe,e as _e,g as be}from"./basic_config-dmFBavSZ.js";import{_ as ke}from"./TimePicker-DG80wuP4.js";const he={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"},ge=h("path",{fill:"currentColor",d:"M12 22q-3.475-.875-5.738-3.988T4 11.1V5l8-3l8 3v6.1q0 3.8-2.262 6.913T12 22m0-2.1q2.6-.825 4.3-3.3t1.7-5.5V6.375l-6-2.25l-6 2.25V11.1q0 3.025 1.7 5.5t4.3 3.3m0-2.9q.425 0 .738-.312t.312-.738t-.312-.737T12 14.9t-.737.313t-.313.737t.313.738T12 17m.025-3.1q.3 0 .538-.225t.237-.525q.025-.175.075-.337t.15-.313q.175-.25.388-.45t.412-.4q.425-.425.738-.95t.312-1.15q0-1.125-.862-1.838T12 7q-.8 0-1.475.375T9.45 8.425q-.15.275-.037.55t.412.4q.275.125.55-.012T10.85 9q.225-.275.513-.412T12 8.45q.55 0 .963.325t.412.825q0 .425-.262.788t-.588.662q-.275.275-.55.538t-.475.587q-.125.2-.175.45t-.05.5q0 .325.212.55t.538.225"},null,-1),we=[ge];function xe(g,w){return b(),V("svg",he,[...we])}const I={name:"material-symbols-shield-question-outline-rounded",render:xe},S=g=>(le("data-v-ad42f4a1"),g=g(),ae(),g),ye={class:"flex justify-center"},$e=S(()=>h("span",{class:"font-bold"},"提示：",-1)),Ce={style:{"text-decoration":"underline"}},Ue=S(()=>h("span",{class:"font-bold"},"提示：",-1)),qe=S(()=>h("span",{style:{"text-decoration":"underline"}},"被锁定的账号会在设定的时间周期后自动解锁",-1)),Se=S(()=>h("span",{class:"font-bold"},"提示：",-1)),Ee=S(()=>h("span",{style:{"text-decoration":"underline"}},"建议根据电站所在位置的日出日落时间设置统计周期，以确保数据准确性。",-1)),Te=B({name:"basicConfig",__name:"basicConfig",setup(g){const{formRef:w,validate:$,restoreValidation:u}=A(),e=X(x());function x(){return{enablelock:1,locktime:5,lockcount:3,unlockeanble:1,unlocktime:5,aceffective:1,pwdexpire:1,expiretime:1,cputhreshold:80,memthreshold:80,passrate:20,captcha:1,tokentime:30,whiteenable:1,statistics:1,sstarttime:void 0,sendtime:void 0,hisintervel:1,emaileanble:1,eipaddr:""}}const p={type:"number",required:!0,message:"不能为空",trigger:["blur","change"]},C={locktime:p,lockcount:p,unlocktime:p,expiretime:p,cputhreshold:p,memthreshold:p,tokentime:p,sstarttime:p,sendtime:p,passrate:p,hisintervel:p,eipaddr:{type:"string",required:!0,message:"不能为空",trigger:["blur","change"]}},E=async()=>{const{data:o,error:t}=await me();t||(Object.assign(e,o),e.locktime=o.locktime/60,e.unlocktime=o.unlocktime/60,e.sstarttime=y(5,y(0,new Date)+" "+e.sstarttime),e.sendtime=y(5,y(0,new Date)+" "+e.sendtime))};Y(()=>{E()});const d=async()=>{var r;const o=y(7,e.sstarttime),t=y(7,e.sendtime),m=e.locktime*60,c=e.unlocktime*60;await $();const{error:i}=await pe({...e,sstarttime:o,sendtime:t,locktime:m,unlocktime:c});i||(r=window.$message)==null||r.success("设置成功")};return(o,t)=>{const m=J,c=R,i=j,r=H,v=P,_=ee,U=F,f=ke,L=O,Q=G,W=te,D=N("no-auth");return b(),k(W,{style:{"max-height":"calc(100vh - 245px)"}},{default:a(()=>[h("div",ye,[l(Q,{ref_key:"formRef",ref:w,"label-width":200,"label-placement":"left",model:e,rules:C},{default:a(()=>[l(i,{label:"是否开启账号锁定",path:"enablelock"},{label:a(()=>[s(" 是否开启账号锁定 "),l(m,{trigger:"hover",placement:"top","content-style":"padding: 5px;"},{trigger:a(()=>[l(T(I),{class:"text-xl cursor-pointer c-#7a7b78"})]),default:a(()=>[$e,h("span",Ce,"当锁定监听周期设置为 "+Z(e.locktime)+" 小时，系统会从首次登录失败开始计时。如果在此期间内，错误登录次数达到设定的锁定次数，账号将被锁定。",1)]),_:1})]),default:a(()=>[l(c,{value:e.enablelock,"onUpdate:value":t[0]||(t[0]=n=>e.enablelock=n),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),l(i,{label:"锁定监听周期",path:"locktime"},{default:a(()=>[l(_,{class:"flex items-center"},{default:a(()=>[l(r,{onClick:t[1]||(t[1]=n=>e.locktime--),disabled:e.locktime==1||e.enablelock==0},{default:a(()=>[s(" − ")]),_:1},8,["disabled"]),l(v,{"show-button":!1,value:e.locktime,"onUpdate:value":t[2]||(t[2]=n=>e.locktime=n),placeholder:"",disabled:e.enablelock==0,min:1,max:24},null,8,["value","disabled"]),l(r,{onClick:t[3]||(t[3]=n=>e.locktime++),disabled:e.locktime==24||e.enablelock==0,class:"mr-5px"},{default:a(()=>[s(" + ")]),_:1},8,["disabled"]),s(" 小时 ")]),_:1})]),_:1}),l(i,{label:"锁定监听次数",path:"lockcount"},{default:a(()=>[l(_,{class:"flex items-center"},{default:a(()=>[l(r,{onClick:t[4]||(t[4]=n=>e.lockcount--),disabled:e.lockcount==2||e.enablelock==0},{default:a(()=>[s(" − ")]),_:1},8,["disabled"]),l(v,{"show-button":!1,value:e.lockcount,"onUpdate:value":t[5]||(t[5]=n=>e.lockcount=n),disabled:e.enablelock==0,placeholder:"",min:2,max:5},null,8,["value","disabled"]),l(r,{onClick:t[6]||(t[6]=n=>e.lockcount++),disabled:e.lockcount==5||e.enablelock==0,class:"mr-5px"},{default:a(()=>[s(" + ")]),_:1},8,["disabled"]),s(" 次 ")]),_:1})]),_:1}),l(i,{label:"是否开启自动解锁",path:"unlockeanble"},{label:a(()=>[s(" 是否开启自动解锁 "),l(m,{trigger:"hover",placement:"top","content-style":"padding: 5px;"},{trigger:a(()=>[l(T(I),{class:"text-xl cursor-pointer c-#7a7b78"})]),default:a(()=>[Ue,qe]),_:1})]),default:a(()=>[l(c,{value:e.unlockeanble,"onUpdate:value":t[7]||(t[7]=n=>e.unlockeanble=n),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),l(i,{label:"解锁时间",path:"unlocktime"},{default:a(()=>[l(_,{class:"flex items-center"},{default:a(()=>[l(r,{onClick:t[8]||(t[8]=n=>e.unlocktime--),disabled:e.unlocktime==e.locktime||e.unlockeanble==0},{default:a(()=>[s(" − ")]),_:1},8,["disabled"]),l(v,{"show-button":!1,value:e.unlocktime,"onUpdate:value":t[9]||(t[9]=n=>e.unlocktime=n),placeholder:"",min:e.locktime,disabled:e.unlockeanble==0},null,8,["value","min","disabled"]),l(r,{onClick:t[10]||(t[10]=n=>e.unlocktime++),class:"mr-5px",disabled:e.unlockeanble==0},{default:a(()=>[s(" + ")]),_:1},8,["disabled"]),s(" 小时 ")]),_:1})]),_:1}),l(i,{label:"是否开启密码过期",path:"pwdexpire"},{default:a(()=>[l(c,{value:e.pwdexpire,"onUpdate:value":t[11]||(t[11]=n=>e.pwdexpire=n),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),l(i,{label:"密码过期时间",path:"expiretime"},{default:a(()=>[l(_,{class:"flex items-center"},{default:a(()=>[l(r,{onClick:t[12]||(t[12]=n=>e.expiretime--),disabled:e.expiretime==1},{default:a(()=>[s(" − ")]),_:1},8,["disabled"]),l(v,{"show-button":!1,value:e.expiretime,"onUpdate:value":t[13]||(t[13]=n=>e.expiretime=n),placeholder:"",min:1},null,8,["value"]),l(r,{onClick:t[14]||(t[14]=n=>e.expiretime++),class:"mr-5px"},{default:a(()=>[s(" + ")]),_:1}),s(" 天 ")]),_:1})]),_:1}),l(i,{label:"是否开启账号有效期登录",path:"aceffective"},{default:a(()=>[l(c,{value:e.aceffective,"onUpdate:value":t[15]||(t[15]=n=>e.aceffective=n),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),l(i,{label:"是否开启白名单",path:"whiteenable"},{default:a(()=>[l(c,{value:e.whiteenable,"onUpdate:value":t[16]||(t[16]=n=>e.whiteenable=n),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),l(i,{label:"是否开启验证码",path:"captcha"},{default:a(()=>[l(c,{value:e.captcha,"onUpdate:value":t[17]||(t[17]=n=>e.captcha=n),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),l(i,{label:"是否开启发送邮件",path:"emaileanble"},{default:a(()=>[l(c,{value:e.emaileanble,"onUpdate:value":t[18]||(t[18]=n=>e.emaileanble=n),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),l(i,{label:"邮件地址",path:"eipaddr"},{default:a(()=>[l(U,{value:e.eipaddr,"onUpdate:value":t[19]||(t[19]=n=>e.eipaddr=n),placeholder:"请输入邮件地址"},null,8,["value"])]),_:1}),l(i,{label:"CPU阈值",path:"cputhreshold"},{default:a(()=>[l(_,{class:"flex items-center"},{default:a(()=>[l(r,{onClick:t[20]||(t[20]=n=>e.cputhreshold--),disabled:e.cputhreshold==0},{default:a(()=>[s(" − ")]),_:1},8,["disabled"]),l(v,{"show-button":!1,value:e.cputhreshold,"onUpdate:value":t[21]||(t[21]=n=>e.cputhreshold=n),precision:0,placeholder:"",min:0,max:100},null,8,["value"]),l(r,{onClick:t[22]||(t[22]=n=>e.cputhreshold++),disabled:e.cputhreshold==100,class:"mr-5px"},{default:a(()=>[s(" + ")]),_:1},8,["disabled"]),s(" % ")]),_:1})]),_:1}),l(i,{label:"MEM阈值",path:"memthreshold"},{default:a(()=>[l(_,{class:"flex items-center"},{default:a(()=>[l(r,{onClick:t[23]||(t[23]=n=>e.memthreshold--),disabled:e.memthreshold==0},{default:a(()=>[s(" − ")]),_:1},8,["disabled"]),l(v,{"show-button":!1,value:e.memthreshold,"onUpdate:value":t[24]||(t[24]=n=>e.memthreshold=n),precision:0,placeholder:"",min:0,max:100},null,8,["value"]),l(r,{onClick:t[25]||(t[25]=n=>e.memthreshold++),disabled:e.memthreshold==100,class:"mr-5px"},{default:a(()=>[s(" + ")]),_:1},8,["disabled"]),s(" % ")]),_:1})]),_:1}),l(i,{label:"合规率阈值",path:"passrate"},{default:a(()=>[l(_,{class:"flex items-center"},{default:a(()=>[l(r,{onClick:t[26]||(t[26]=n=>e.passrate--),disabled:e.passrate==0},{default:a(()=>[s(" − ")]),_:1},8,["disabled"]),l(v,{"show-button":!1,value:e.passrate,"onUpdate:value":t[27]||(t[27]=n=>e.passrate=n),placeholder:"",min:0,max:100},null,8,["value"]),l(r,{onClick:t[28]||(t[28]=n=>e.passrate++),disabled:e.passrate==100,class:"mr-5px"},{default:a(()=>[s(" + ")]),_:1},8,["disabled"])]),_:1})]),_:1}),l(i,{label:"token过期时间",path:"tokentime"},{default:a(()=>[l(_,{class:"flex items-center"},{default:a(()=>[l(r,{onClick:t[29]||(t[29]=n=>e.tokentime--),disabled:e.tokentime==1},{default:a(()=>[s(" − ")]),_:1},8,["disabled"]),l(v,{"show-button":!1,value:e.tokentime,"onUpdate:value":t[30]||(t[30]=n=>e.tokentime=n),placeholder:"",min:1},null,8,["value"]),l(r,{onClick:t[31]||(t[31]=n=>e.tokentime++),class:"mr-5px"},{default:a(()=>[s(" + ")]),_:1}),s(" 小时 ")]),_:1})]),_:1}),l(i,{label:"是否开启统计",path:"statistics"},{label:a(()=>[s(" 是否开启统计 "),l(m,{trigger:"hover",placement:"top","content-style":"padding: 5px;"},{trigger:a(()=>[l(T(I),{class:"text-xl cursor-pointer c-#7a7b78"})]),default:a(()=>[Se,Ee]),_:1})]),default:a(()=>[l(c,{value:e.statistics,"onUpdate:value":t[32]||(t[32]=n=>e.statistics=n),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),e.statistics==1?(b(),k(i,{key:0,label:"统计开始时间",path:"sstarttime"},{default:a(()=>[l(f,{value:e.sstarttime,"onUpdate:value":t[33]||(t[33]=n=>e.sstarttime=n),format:"HH:mm",class:"w-150px"},null,8,["value"])]),_:1})):M("",!0),e.statistics==1?(b(),k(i,{key:1,label:"统计结束时间",path:"sendtime"},{default:a(()=>[l(f,{value:e.sendtime,"onUpdate:value":t[34]||(t[34]=n=>e.sendtime=n),format:"HH:mm",class:"w-150px"},null,8,["value"])]),_:1})):M("",!0),l(i,{label:"历史数据存储误差允许间隔",path:"hisintervel"},{default:a(()=>[l(_,{class:"flex items-center"},{default:a(()=>[l(r,{onClick:t[35]||(t[35]=n=>e.hisintervel--),disabled:e.hisintervel==0},{default:a(()=>[s(" − ")]),_:1},8,["disabled"]),l(v,{"show-button":!1,value:e.hisintervel,"onUpdate:value":t[36]||(t[36]=n=>e.hisintervel=n),precision:0,placeholder:"",min:1,max:5},null,8,["value"]),l(r,{onClick:t[37]||(t[37]=n=>e.hisintervel++),disabled:e.hisintervel==5,class:"mr-5px"},{default:a(()=>[s(" + ")]),_:1},8,["disabled"]),s(" 分钟 ")]),_:1})]),_:1}),l(i,{label:" "},{default:a(()=>[l(L,null,{default:a(()=>[q((b(),k(r,{type:"default",ghost:"",onClick:E},{default:a(()=>[s(" 刷新 ")]),_:1})),[[D,"system.conf.select"]]),q((b(),k(r,{type:"info",ghost:"",onClick:d},{default:a(()=>[s(" 保存 ")]),_:1})),[[D,"system.conf.update"]])]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1})}}}),Ie=K(Te,[["__scopeId","data-v-ad42f4a1"]]),Ve=B({name:"emailService",__name:"emailSever",setup(g){const{formRef:w,validate:$}=A(),u=z({port:void 0,pwd:"",sendserver:"",essl:0,uname:""}),e={sendserver:[{required:!0,validator:(d,o,t)=>o?se(o)?t():t(new Error("请输入正确的IP地址或域名")):new Error("请输入服务器地址"),trigger:["blur","input"]}],port:{type:"number",required:!0,trigger:["blur","input"],validator:(d,o,t)=>o==null||o==null?new Error("请输入端口号"):oe(o)?!0:new Error("请输入在0-65535之间的数字")},uname:[{required:!0,message:"请输入账号",trigger:"blur"}],pwd:[{required:!0,message:"请输入密码",trigger:"blur"}],sendaddr:[{required:!0,message:"请输入发件邮箱",trigger:["blur","input"]},{validator:ue,trigger:["blur","input"]}]},x=async()=>{const{data:d,error:o}=await ce();o||(u.value.sendserver=(d==null?void 0:d.sendserver)??u.value.sendserver,u.value.port=(d==null?void 0:d.port)??u.value.port,u.value.pwd=(d==null?void 0:d.pwd)??u.value.pwd,u.value.essl=(d==null?void 0:d.essl)??u.value.essl,u.value.uname=(d==null?void 0:d.uname)??u.value.uname,u.value.id=(d==null?void 0:d.id)??u.value.id)};x();const p=async()=>{var d,o,t,m;if(await $(),u.value.id){const{data:c,error:i}=await ve(u.value);i||((d=window.$message)==null||d.destroyAll(),(o=window.$message)==null||o.success("保存成功"))}else{const{data:c,error:i}=await fe(u.value);i||((t=window.$message)==null||t.destroyAll(),(m=window.$message)==null||m.success("保存成功"))}},C=async()=>{var t,m;const{data:d,error:o}=await _e();o||((t=window.$message)==null||t.destroyAll(),(m=window.$message)==null||m.success("重置成功"),x())},E=async()=>{var t,m;await $();const{data:d,error:o}=await be(u.value);o||((t=window.$message)==null||t.destroyAll(),(m=window.$message)==null||m.success("测试成功"))};return(d,o)=>{const t=F,m=j,c=P,i=R,r=G,v=H,_=O,U=N("no-auth");return b(),V(ne,null,[l(r,{ref_key:"formRef",ref:w,"label-width":150,model:u.value,rules:e,"label-placement":"left",class:"w-400px",style:{margin:"50px auto"}},{default:a(()=>[l(m,{label:"发送邮件服务器",path:"sendserver"},{default:a(()=>[l(t,{value:u.value.sendserver,"onUpdate:value":o[0]||(o[0]=f=>u.value.sendserver=f),placeholder:"输入服务器或IP地址"},null,8,["value"])]),_:1}),l(m,{label:"端口",path:"port"},{default:a(()=>[l(c,{value:u.value.port,"onUpdate:value":o[1]||(o[1]=f=>u.value.port=f),placeholder:"输入端口",style:{width:"100%"}},null,8,["value"])]),_:1}),l(m,{label:"用户名",path:"uname"},{default:a(()=>[l(t,{value:u.value.uname,"onUpdate:value":o[2]||(o[2]=f=>u.value.uname=f),placeholder:"用户名"},null,8,["value"])]),_:1}),l(m,{label:"密码",path:"pwd"},{default:a(()=>[l(t,{type:"password",value:u.value.pwd,"onUpdate:value":o[3]||(o[3]=f=>u.value.pwd=f),placeholder:"密码","show-password-on":"click"},null,8,["value"])]),_:1}),l(m,{label:"ssl",path:"essl"},{default:a(()=>[l(i,{value:u.value.essl,"onUpdate:value":o[4]||(o[4]=f=>u.value.essl=f),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1})]),_:1},8,["model"]),l(_,{justify:"center"},{default:a(()=>[q((b(),k(v,{type:"info",ghost:"",onClick:E},{default:a(()=>[s("测试")]),_:1})),[[U,"sysmanger.basicInfo.test.mailInfo"]]),q((b(),k(v,{type:"info",ghost:"",onClick:p},{default:a(()=>[s("保存")]),_:1})),[[U,"sysmanger.mailInfo.update"]]),q((b(),k(v,{type:"info",ghost:"",onClick:C},{default:a(()=>[s("重置")]),_:1})),[[U,"sysmanger.mailInfo.delete"]])]),_:1})],64)}}}),Be={class:"h-full"},De=B({name:"manage_systemconfig",__name:"index",setup(g){const w=z("基础配置");return($,u)=>{const e=ie,x=de,p=re;return b(),V("div",Be,[l(p,{style:{"margin-bottom":"16px"},class:"h-full","content-style":{height:"100%"}},{default:a(()=>[l(x,{type:"card",animated:"",class:"h-100%",value:w.value,"onUpdate:value":u[0]||(u[0]=C=>w.value=C)},{default:a(()=>[l(e,{name:"基础配置",tab:"基础配置"},{default:a(()=>[l(Ie)]),_:1}),l(e,{name:"邮件服务",tab:"邮件服务"},{default:a(()=>[l(Ve)]),_:1})]),_:1},8,["value"])]),_:1})])}}}),Re=K(De,[["__scopeId","data-v-e2de8ea3"]]);export{Re as default};

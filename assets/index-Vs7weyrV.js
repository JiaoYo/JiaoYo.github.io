import{_ as q}from"./table-header-operation.vue_vue_type_script_setup_true_lang-Dg7D9vNa.js";import{d as E,q as L,v as O,s as j,K as H,o as F,c as Z,w as e,g as t,L as N,h as a,t as i,i as n,$ as S,M as J,A as Q,B as M,E as X,D as Y,a9 as I,Z as ee,j as te,r as le,e as ae,ac as z,f as oe,S as ne,F as se}from"./index-CgBW4LHb.js";import{u as re,a as ue}from"./table-DdnUnYxl.js";import{b as ie,c as ce}from"./vulnerability-CckUnHGf.js";import{_ as pe}from"./round-search-B740Obor.js";import{_ as me}from"./round-refresh-ClNZToOK.js";import{_ as de}from"./FormItemGridItem-CF5kxDU2.js";import{_ as _e}from"./Grid-BJTb7xc8.js";import{_ as fe}from"./DataTable-B4Q1nmAe.js";import{_ as ve,a as he}from"./DescriptionsItem-CGv_FQ4x.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-t30EQidp.js";import"./setting-outlined-DQdTyAZO.js";import"./round-delete-i2CHYcPt.js";import"./refresh-2QxpuXMy.js";import"./Upload-CNoAMoGr.js";import"./Progress-CtXeBj-o.js";import"./Popconfirm-Cg4vHf8x.js";import"./Forward-Dc9d9gZ-.js";const ge=E({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:L(["reset","search"],["update:model"]),setup(V,{emit:y}){const r=y,{formRef:o,restoreValidation:w}=O(),s=j(V,"model");function h(){s.value.fuzzy="",r("search")}function f(){s.value.vulstage=void 0,r("search")}function g(){s.value.vulstatus=void 0,r("search")}async function x(){await w(),r("reset")}async function d(){r("search")}return(B,p)=>{const b=Q,v=de,R=me,k=M,_=pe,$=X,T=_e,U=Y,C=I,c=H("no-space");return F(),Z(C,{bordered:!1,size:"small",class:"card-wrapper"},{default:e(()=>[t(U,{ref_key:"formRef",ref:o,model:s.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:J(d,["enter"])},{default:e(()=>[t(T,{responsive:"screen","item-responsive":""},{default:e(()=>[t(v,{span:"24 s:12 m:6",label:"漏洞编号",path:"fuzzy",class:"pr-24px"},{default:e(()=>[N(t(b,{clearable:"",value:s.value.fuzzy,"onUpdate:value":p[0]||(p[0]=l=>s.value.fuzzy=l),placeholder:"请输入漏洞编号",onClear:h},null,8,["value"]),[[c]])]),_:1}),t(v,{span:"24 s:12 m:6",label:"漏洞阶段",path:"vulstage",class:"pr-24px"},{default:e(()=>[N(t(b,{clearable:"",value:s.value.vulstage,"onUpdate:value":p[1]||(p[1]=l=>s.value.vulstage=l),placeholder:"请输入漏洞阶段",onClear:f},null,8,["value"]),[[c]])]),_:1}),t(v,{span:"24 s:12 m:6",label:"漏洞状态",path:"vulstatus",class:"pr-24px"},{default:e(()=>[N(t(b,{clearable:"",value:s.value.vulstatus,"onUpdate:value":p[2]||(p[2]=l=>s.value.vulstatus=l),placeholder:"请输入漏洞状态",onClear:g},null,8,["value"]),[[c]])]),_:1}),t(v,{span:"24 m:6",class:"pr-24px"},{default:e(()=>[t($,{class:"w-full"},{default:e(()=>[t(k,{onClick:x},{icon:e(()=>[t(R,{class:"text-icon"})]),default:e(()=>[a(" "+i(n(S)("common.reset")),1)]),_:1}),t(k,{type:"primary",ghost:"",onClick:d},{icon:e(()=>[t(_,{class:"text-icon"})]),default:e(()=>[a(" "+i(n(S)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),be={class:"min-h-500px flex-col-stretch gap-16px overflow-auto lt-sm:overflow-auto"},ye=oe("hr",{style:{"border-color":"#ccc","margin-bottom":"20px"}},null,-1),Ke=E({name:"knowledgebase_cvevulnerabilitydatabase",__name:"index",setup(V){const y=ee(),r=te(!1),o=le({vulnum:"",vulstatus:"",vulstage:"",vuldesc:"",refer:"",vote:"",notes:""}),{columns:w,columnChecks:s,data:h,getData:f,loading:g,mobilePagination:x,searchParams:d,resetSearchParams:B}=re({apiFn:ie,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,vulstatus:null,fuzzy:null,_t:new Date().getTime()},columns:()=>[{key:"vulnum",title:"漏洞编号",align:"center",minWidth:180,fixed:"left",ellipsis:{tooltip:!0}},{key:"vulstatus",title:"漏洞状态",align:"center",width:120},{key:"vulstage",title:"漏洞阶段",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"vuldesc",title:"漏洞描述",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"operate",title:S("common.operate"),align:"center",width:80,fixed:"right",render:c=>t("div",{class:"flex-center gap-8px"},[t(M,{type:"primary",ghost:!0,size:"small",onClick:()=>C(c)},{default:()=>[a("详情")]})])}]}),{drawerVisible:p,operateType:b,editingData:v,handleAdd:R,handleEdit:k,checkedRowKeys:_,onBatchDeleted:$,onDeleted:T,closeDrawer:U}=ue(h,f);async function C(c){const{data:l,error:D}=await ce({id:c.id});D||(o.vulnum=l.vulnum,o.vulstatus=l.vulstatus,o.vulstage=l.vulstage,o.vuldesc=l.vuldesc,o.refer=l.refer,o.vote=l.vote,o.notes=l.notes,r.value=!0)}return(c,l)=>{const D=q,K=fe,G=I,m=ve,P=he,A=ne,W=se;return F(),ae("div",be,[t(ge,{model:n(d),"onUpdate:model":l[0]||(l[0]=u=>z(d)?d.value=u:null),onReset:n(B),onSearch:n(f)},null,8,["model","onReset","onSearch"]),t(G,{title:"CVE漏洞库",bordered:!1,size:"small",class:"sm:flex-1-hidden"},{"header-extra":e(()=>[t(D,{columns:n(s),"onUpdate:columns":l[1]||(l[1]=u=>z(s)?s.value=u:null),"disabled-delete":n(_).length===0,loading:n(g),onRefresh:n(f)},null,8,["columns","disabled-delete","loading","onRefresh"])]),default:e(()=>[t(K,{"checked-row-keys":n(_),"onUpdate:checkedRowKeys":l[2]||(l[2]=u=>z(_)?_.value=u:null),columns:n(w),data:n(h),size:"small","flex-height":!n(y).isMobile,"scroll-x":962,loading:n(g),remote:"","row-key":u=>u.id,pagination:n(x),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1}),t(W,{show:r.value,"onUpdate:show":l[3]||(l[3]=u=>r.value=u),title:"CVE漏洞库详情",preset:"card",class:"w-800px"},{default:e(()=>[ye,t(A,{class:"h-480px pr-20px"},{default:e(()=>[t(P,{"label-placement":"left",bordered:"",column:1},{default:e(()=>[t(m,null,{label:e(()=>[a(" 漏洞编号 ")]),default:e(()=>[a(" "+i(o.vulnum),1)]),_:1}),t(m,null,{label:e(()=>[a(" 漏洞状态 ")]),default:e(()=>[a(" "+i(o.vulstatus),1)]),_:1}),t(m,null,{label:e(()=>[a(" 漏洞阶段 ")]),default:e(()=>[a(" "+i(o.vulstage),1)]),_:1}),t(m,null,{label:e(()=>[a(" 漏洞描述 ")]),default:e(()=>[a(" "+i(o.vuldesc),1)]),_:1}),t(m,null,{label:e(()=>[a(" 参考 ")]),default:e(()=>[a(" "+i(o.refer),1)]),_:1}),t(m,null,{label:e(()=>[a(" 表决 ")]),default:e(()=>[a(" "+i(o.vote),1)]),_:1}),t(m,null,{label:e(()=>[a(" 备注 ")]),default:e(()=>[a(" "+i(o.notes),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])])}}});export{Ke as default};

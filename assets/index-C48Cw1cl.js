import{_ as J}from"./table-header-operation.vue_vue_type_script_setup_true_lang-DQ2Pwvgi.js";import{d as K,n as L,j as $,p as Z,s as Q,D as X,o as P,c as Y,w as e,g as l,E as j,h as a,t as u,i as s,$ as E,F as ee,J as le,Z as ne,B as W,N as te,O as ae,ad as G,a3 as oe,r as se,av as I,e as ie,ah as U,f as ue,ai as re,aj as ce,S as de,ar as me}from"./index-BcwJAI2q.js";import{u as pe,a as fe}from"./table-D33xm8uu.js";import{f as _e,a as ve}from"./vulnerability-Bfdbpktd.js";import{_ as he}from"./round-search-A0B-hsZK.js";import{_ as be}from"./round-refresh-BT4eYGbi.js";import{_ as ge}from"./lodash-DfU1tBZO.js";import{_ as ye}from"./FormItemGridItem-D5iCQy7z.js";import{_ as Ce}from"./DatePicker-B8hVhRWy.js";import{_ as Ne}from"./Grid-CMuoBycw.js";import{_ as we,a as ke}from"./DescriptionsItem-D6FLX8xt.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-B5_PnLN6.js";import"./setting-outlined-CbkMSlAj.js";import"./export-Dag_eicx.js";import"./refresh-BeWxBXlv.js";import"./round-delete-C_yyfWSE.js";import"./round-plus-C0Sj_6Y9.js";import"./Upload-Ca09Vwkf.js";import"./Progress-BnzXG0Bo.js";import"./Popconfirm-MBwapZUM.js";import"./TimePicker-DZMjYXNR.js";import"./defineProperty-Xv3OJ_hQ.js";const xe=K({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:L(["reset","search"],["update:model"]),setup(v,{emit:z}){const g=[{label:"未定义",value:0},{label:"超危",value:1},{label:"高危",value:2},{label:"中级",value:3},{label:"低级",value:4}],n=z;$(!1);const{formRef:C,restoreValidation:S}=Z(),o=Q(v,"model");$(null);function N(){o.value.cnnvdnum=void 0,n("search")}function w(){o.value.cnenum=void 0,n("search")}function k(){o.value.fuzzy=void 0,n("search")}async function T(y,r){y?(o.value.startTime=y[0],o.value.endTime=y[1]):(o.value.startTime=null,o.value.endTime=null),n("search")}async function m(){await S(),o.value.timeRange=null,n("reset")}async function x(){n("search")}const M=ge.debounce(x,1e3,{leading:!0,trailing:!1});return(y,r)=>{const D=le,_=ye,h=Ce,F=ne,O=be,R=W,B=he,V=te,i=Ne,t=ae,p=G,b=X("no-space");return P(),Y(p,{bordered:!1,size:"small",class:"card-wrapper"},{default:e(()=>[l(t,{ref_key:"formRef",ref:C,model:o.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:ee(s(M),["enter"])},{default:e(()=>[l(i,{responsive:"screen","item-responsive":"","y-gap":20},{default:e(()=>[l(_,{span:"24 s:12 m:8 l:8",label:"CNNVD编号",path:"cnnvdnum"},{default:e(()=>[j(l(D,{clearable:"",value:o.value.cnnvdnum,"onUpdate:value":r[0]||(r[0]=c=>o.value.cnnvdnum=c),placeholder:"请输入CNNVD编号",onClear:N},null,8,["value"]),[[b]])]),_:1}),l(_,{span:"24 s:12 m:8 l:8",label:"漏洞名称",path:"fuzzy"},{default:e(()=>[l(D,{clearable:"",value:o.value.fuzzy,"onUpdate:value":r[1]||(r[1]=c=>o.value.fuzzy=c),placeholder:"请输入漏洞名称",onClear:k},null,8,["value"])]),_:1}),l(_,{span:"24 s:12 m:8 l:8",label:"CVE编号",path:"cnenum"},{default:e(()=>[j(l(D,{clearable:"",value:o.value.cnenum,"onUpdate:value":r[2]||(r[2]=c=>o.value.cnenum=c),placeholder:"请输入CVE编号",onClear:w},null,8,["value"]),[[b]])]),_:1}),l(_,{span:"24 s:12 m:8 l:8",label:"收录时间"},{default:e(()=>[l(h,{"start-placeholder":"收录开始时间","end-placeholder":"收录结束时间","formatted-value":o.value.timeRange,"onUpdate:formattedValue":[r[3]||(r[3]=c=>o.value.timeRange=c),T],"value-format":"yyyy-MM-dd",type:"daterange",clearable:"",style:{width:"100%"}},null,8,["formatted-value"])]),_:1}),l(_,{span:"24 s:12 m:8 l:8",label:"危害等级",path:"level"},{default:e(()=>[l(F,{filterable:"",clearable:"",value:o.value.level,"onUpdate:value":[r[4]||(r[4]=c=>o.value.level=c),x],placeholder:"请选择漏洞等级",options:g},null,8,["value"])]),_:1}),l(_,{span:"24 m:8 l:6",label:" "},{default:e(()=>[l(V,{align:"center"},{default:e(()=>[l(R,{onClick:m},{icon:e(()=>[l(O,{class:"text-icon"})]),default:e(()=>[a(" "+u(s(E)("common.reset")),1)]),_:1}),l(R,{type:"primary",ghost:"",onClick:s(M)},{icon:e(()=>[l(B,{class:"text-icon"})]),default:e(()=>[a(" "+u(s(E)("common.search")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","onKeyup"])]),_:1})}}}),De={class:"min-h-500px flex-col-stretch gap-16px overflow-auto lt-sm:overflow-auto"},Ve=ue("hr",{style:{"border-color":"#ccc","margin-bottom":"20px"}},null,-1);function ze(v){return typeof v=="function"||Object.prototype.toString.call(v)==="[object Object]"&&!re(v)}const Qe=K({name:"knowledgebase_cnnvd",__name:"index",setup(v){const z=oe(),g=$(!1),n=se({cname:"",cnnvdnum:"",cnenum:"",manu:"",level:0,ctype:"",cdbtime:"",udbtime:"",snapshot:"",refwedsite:"",patch:""}),C={0:"未定义",1:"超危",2:"高危",3:"中级",4:"低级"},{columns:S,columnChecks:o,data:N,getData:w,loading:k,mobilePagination:T,searchParams:m,resetSearchParams:x}=pe({apiFn:_e,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,fuzzy:null,cnnvdnum:null,cnenum:null,level:null,startTime:null,endTime:null,_t:new Date().getTime()},columns:()=>[{key:"cnnvdnum",title:"CNNVD编号编号",align:"center",minWidth:180,fixed:"left",ellipsis:{tooltip:!0}},{key:"cname",title:"漏洞名称",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"level",title:"危害等级",align:"center",width:100,render:i=>{(i.level===null||i.level===void 0)&&(i.level=0);const t={0:"#8e9dff",4:"#5da8ff",3:"#fedc69",2:"#ff9874",1:"#ff0000"},p=C[i.level];let b={color:t[i.level],textColor:"#ffffff",borderColor:t[i.level]};return l(I,{size:"small",color:b},ze(p)?p:{default:()=>[p]})}},{key:"cnenum",title:"CVE编号",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"manu",title:"厂商",align:"center",minWidth:180,ellipsis:{tooltip:!0}},{key:"cdbtime",title:"收录时间",align:"center",minWidth:180,ellipsis:{tooltip:!0},render:i=>l("span",null,[i.cdbtime.substring(0,10)])},{key:"operate",title:E("common.operate"),align:"center",width:80,fixed:"right",render:i=>l("div",{class:"flex-center gap-8px"},[l(W,{type:"primary",ghost:!0,size:"small",onClick:()=>B(i)},{default:()=>[a("详情")]})])}]}),{drawerVisible:M,operateType:y,editingData:r,handleAdd:D,handleEdit:_,checkedRowKeys:h,onBatchDeleted:F,onDeleted:O,closeDrawer:R}=fe(N,w);async function B(i){const{data:t,error:p}=await ve({id:i.id});p||(n.cnnvdnum=t.cnnvdnum,n.cname=t.cname,n.cnenum=t.cnenum,n.manu=t.manu,n.level=t.level,n.ctype=t.ctype,n.cdbtime=t.cdbtime,n.udbtime=t.udbtime,n.snapshot=t.snapshot,n.refwedsite=t.refwedsite,n.patch=t.patch,g.value=!0)}const V=()=>{m.cnnvdnum==""&&(m.cnnvdnum=null),m.cnenum==""&&(m.cnenum=null),w()};return(i,t)=>{const p=J,b=ce,c=G,d=we,A=ke,q=de,H=me;return P(),ie("div",De,[l(xe,{model:s(m),"onUpdate:model":t[0]||(t[0]=f=>U(m)?m.value=f:null),onReset:s(x),onSearch:V},null,8,["model","onReset"]),l(c,{title:"CNNVD漏洞信息",bordered:!1,size:"small",class:"sm:flex-1-hidden"},{"header-extra":e(()=>[l(p,{columns:s(o),"onUpdate:columns":t[1]||(t[1]=f=>U(o)?o.value=f:null),"disabled-delete":s(h).length===0,loading:s(k),onRefresh:V},null,8,["columns","disabled-delete","loading"])]),default:e(()=>[l(b,{"checked-row-keys":s(h),"onUpdate:checkedRowKeys":t[2]||(t[2]=f=>U(h)?h.value=f:null),columns:s(S),data:s(N),size:"small","flex-height":!s(z).isMobile,"scroll-x":962,loading:s(k),remote:"","row-key":f=>f.id,pagination:s(T),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1}),l(H,{show:g.value,"onUpdate:show":t[3]||(t[3]=f=>g.value=f),title:"CNNVD漏洞信息详情",preset:"card",class:"w-800px"},{default:e(()=>[Ve,l(q,{class:"h-480px pr-20px"},{default:e(()=>[l(A,{"label-placement":"left",bordered:"",column:1,"label-style":{width:"120px"}},{default:e(()=>[l(d,null,{label:e(()=>[a(" CNNVD编号 ")]),default:e(()=>[a(" "+u(n.cnnvdnum),1)]),_:1}),l(d,null,{label:e(()=>[a(" 漏洞名称 ")]),default:e(()=>[a(" "+u(n.cname),1)]),_:1}),l(d,null,{label:e(()=>[a(" 危害等级 ")]),default:e(()=>[l(s(I),{color:{textColor:"#ffffff",borderColor:n.level===0?"#8e9dff":n.level===4?"#5da8ff":n.level===3?"#fedc69":n.level===2?"#ff9874":n.level===1?"#ff0000":"#5da8ff",color:n.level===0?"#8e9dff":n.level===4?"#5da8ff":n.level===3?"#fedc69":n.level===2?"#ff9874":n.level===1?"#ff0000":"#5da8ff"}},{default:e(()=>[a(u(C[n.level]),1)]),_:1},8,["color"])]),_:1}),l(d,null,{label:e(()=>[a(" CVE编号 ")]),default:e(()=>[a(" "+u(n.cnenum),1)]),_:1}),l(d,null,{label:e(()=>[a(" 厂商 ")]),default:e(()=>[a(" "+u(n.manu),1)]),_:1}),l(d,null,{label:e(()=>[a(" 漏洞类型 ")]),default:e(()=>[a(" "+u(n.ctype),1)]),_:1}),l(d,null,{label:e(()=>[a(" 收录时间 ")]),default:e(()=>[a(" "+u(n.cdbtime),1)]),_:1}),l(d,null,{label:e(()=>[a(" 更新时间 ")]),default:e(()=>[a(" "+u(n.udbtime),1)]),_:1}),l(d,null,{label:e(()=>[a(" 简介 ")]),default:e(()=>[a(" "+u(n.snapshot),1)]),_:1}),l(d,null,{label:e(()=>[a(" 参考网址 ")]),default:e(()=>[a(" "+u(n.refwedsite),1)]),_:1}),l(d,null,{label:e(()=>[a(" 补丁 ")]),default:e(()=>[a(" "+u(n.patch),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])])}}});export{Qe as default};

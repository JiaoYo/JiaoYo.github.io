import{_ as Y}from"./table-header-operation.vue_vue_type_script_setup_true_lang-CQRJ3Aex.js";import{bg as P,d as A,q as K,s as G,v as L,x as ee,b as te,r as ae,y as oe,K as M,o as q,c as H,w as o,g as e,h as U,t as I,i as t,$ as p,M as W,L as V,A as Z,C as ne,aV as se,D as J,B as O,E as Q,aa as le,ab as re,a9 as X,Z as ie,ar as ce,am as me,e as ue,ac as F,ad as pe}from"./index-CIkMAdTj.js";import{u as de,a as _e}from"./table-DYjxKyYT.js";import{_ as fe}from"./round-search-DolOrREp.js";import{_ as he}from"./round-refresh-Cw_OacQi.js";import{_ as ye}from"./FormItemGridItem-B-PuJtjX.js";import{_ as ge}from"./Grid-BbZ5ihyN.js";import{h as E}from"./permission-9-vwFfOY.js";import{_ as ve}from"./Popconfirm-uRFGs8ok.js";import{_ as we}from"./DataTable-DUhJ-ag2.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-DyTGTkTN.js";import"./setting-outlined-BjNyCKNK.js";import"./round-delete-5y7n-Q4W.js";import"./refresh-CQAxWQOp.js";import"./Upload-D11BssPZ.js";import"./Progress-DCQkG3_f.js";import"./Forward-BV1I61Y9.js";function be(l){return P({url:"/manu/selectPage.do",method:"get",params:l})}function De(l){return P({url:"/manu/insert.do",method:"post",data:l})}function ke(l){return P({url:"/manu/update.do",method:"post",data:l})}function Ne(l){return P({url:"/manu/delete.do",method:"get",params:{ids:l.join(",")}})}const xe=A({name:"OperateDrawer",__name:"operate-drawer",props:K({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:K(["submitted"],["update:visible"]),setup(l,{emit:x}){const c=l,h=x,d=G(l,"visible"),{formRef:m,validate:b,restoreValidation:S}=L(),{defaultRequiredRule:y}=ee(),B=te(()=>({add:"新增厂商",edit:"编辑厂商"})[c.operateType]),s=ae(D());function D(){return{mname:"",sysparam:1}}const k={mname:y};function C(){Object.assign(s,D()),c.operateType==="edit"&&c.rowData&&Object.assign(s,c.rowData)}function g(){d.value=!1}async function u(){var v,r;if(await b(),c.operateType==="add"){const{data:N,error:_}=await De([{mname:s.mname,sysparam:s.sysparam}]);_||((v=window.$message)==null||v.success(p("common.addSuccess")),g(),h("submitted"))}else{const{data:N,error:_}=await ke([{id:c.rowData.id,mname:s.mname,sysparam:s.sysparam}]);_||((r=window.$message)==null||r.success(p("common.updateSuccess")),g(),h("submitted"))}}return oe(d,()=>{d.value&&(C(),S())}),(v,r)=>{const N=Z,_=ne,z=se,R=J,T=O,a=Q,n=le,i=re,$=M("no-space");return q(),H(i,{show:d.value,"onUpdate:show":r[2]||(r[2]=w=>d.value=w),"display-directive":"show",width:360},{default:o(()=>[e(n,{title:B.value,"native-scrollbar":!1,closable:""},{footer:o(()=>[e(a,{size:16},{default:o(()=>[e(T,{onClick:g},{default:o(()=>[U(I(t(p)("common.cancel")),1)]),_:1}),e(T,{type:"primary",onClick:u},{default:o(()=>[U(I(t(p)("common.confirm")),1)]),_:1})]),_:1})]),default:o(()=>[e(R,{ref_key:"formRef",ref:m,model:s,rules:k,onKeyup:W(u,["enter"])},{default:o(()=>[e(_,{label:"名称",path:"mname"},{default:o(()=>[V(e(N,{value:s.mname,"onUpdate:value":r[0]||(r[0]=w=>s.mname=w),placeholder:"请输入名称",clearable:""},null,8,["value"]),[[$]])]),_:1}),e(_,{label:"是否为系统参数",path:"sysparam"},{default:o(()=>[e(z,{value:s.sysparam,"onUpdate:value":r[1]||(r[1]=w=>s.sysparam=w),"checked-value":0,"unchecked-value":1},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Se=A({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:K(["reset","search"],["update:model"]),setup(l,{emit:x}){const c=x,{formRef:h,restoreValidation:d}=L(),m=G(l,"model");function b(){m.value.fuzzy="",c("search")}async function S(){await d(),c("reset")}async function y(){c("search")}return(B,s)=>{const D=Z,k=ye,C=he,g=O,u=fe,v=Q,r=ge,N=J,_=X,z=M("no-space");return q(),H(_,{bordered:!1,size:"small",class:"card-wrapper"},{default:o(()=>[e(N,{ref_key:"formRef",ref:h,model:m.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:W(y,["enter"])},{default:o(()=>[e(r,{responsive:"screen","item-responsive":""},{default:o(()=>[e(k,{span:"24 s:12 m:6",label:"名称",path:"fuzzy",class:"pr-24px"},{default:o(()=>[V(e(D,{clearable:"",value:m.value.fuzzy,"onUpdate:value":s[0]||(s[0]=R=>m.value.fuzzy=R),placeholder:"请输入名称",onClear:b},null,8,["value"]),[[z]])]),_:1}),e(k,{span:"24 m:12",class:"pr-24px"},{default:o(()=>[e(v,{class:"w-full"},{default:o(()=>[e(g,{onClick:S},{icon:o(()=>[e(C,{class:"text-icon"})]),default:o(()=>[U(" "+I(t(p)("common.reset")),1)]),_:1}),e(g,{type:"primary",ghost:"",onClick:y},{icon:o(()=>[e(u,{class:"text-icon"})]),default:o(()=>[U(" "+I(t(p)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}}),Ce={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function j(l){return typeof l=="function"||Object.prototype.toString.call(l)==="[object Object]"&&!pe(l)}const Ge=A({name:"manage_company",__name:"index",setup(l){const x=ie(),{columns:c,columnChecks:h,data:d,getData:m,loading:b,mobilePagination:S,searchParams:y,resetSearchParams:B}=de({apiFn:be,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,fuzzy:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48,disabled:a=>a.sysparam==0},{key:"mname",title:"名称",align:"center",minWidth:160,ellipsis:{tooltip:!0}},{key:"sysparam",title:"是否为系统参数",align:"center",width:140,render:a=>{a.sysparam==null&&(a.sysparam=0);const n={0:"success",1:"error"},i=p(ce[a.sysparam]);return e(me,{size:"small",type:n[a.sysparam]},j(i)?i:{default:()=>[i]})}},{key:"operate",title:p("common.operate"),align:"center",width:160,render:a=>{let n;return a.sysparam!=0?e("div",{class:"flex-center gap-8px"},[V(e(O,{type:"primary",ghost:!0,size:"small",onClick:()=>R(a.id)},j(n=p("common.edit"))?n:{default:()=>[n]}),[[M("no-auth"),"manu.source.update"]]),e(ve,{onPositiveClick:()=>z(a.id)},{default:()=>p("common.confirmDelete"),trigger:()=>{let i;return V(e(O,{type:"error",ghost:!0,size:"small"},j(i=p("common.delete"))?i:{default:()=>[i]}),[[M("no-auth"),"manu.source.delete"]])}})]):null}}]}),{drawerVisible:s,operateType:D,editingData:k,handleAdd:C,handleEdit:g,checkedRowKeys:u,onBatchDeleted:v,onDeleted:r,closeDrawer:N}=_e(d,m);async function _(){console.log(u.value),T(u.value,a=>{v()})}function z(a){console.log(a),T([a],n=>{r()})}function R(a){g(a)}async function T(a,n){const{data:i,error:$}=await Ne(a);if(!$)n&&n(i);else return!1}return(a,n)=>{const i=Y,$=we,w=X;return q(),ue("div",Ce,[e(Se,{model:t(y),"onUpdate:model":n[0]||(n[0]=f=>F(y)?y.value=f:null),onReset:t(B),onSearch:t(m)},null,8,["model","onReset","onSearch"]),e(w,{title:"厂商列表",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":o(()=>[e(i,{columns:t(h),"onUpdate:columns":n[1]||(n[1]=f=>F(h)?h.value=f:null),"disabled-delete":t(u).length===0,loading:t(b),onAdd:t(C),onDelete:_,onRefresh:t(m),"is-view-add-button":t(E)("manu.source.insert"),"is-view-delete-button":t(E)("manu.source.delete")},null,8,["columns","disabled-delete","loading","onAdd","onRefresh","is-view-add-button","is-view-delete-button"])]),default:o(()=>[e($,{"checked-row-keys":t(u),"onUpdate:checkedRowKeys":n[2]||(n[2]=f=>F(u)?u.value=f:null),columns:t(c),data:t(d),size:"small","flex-height":!t(x).isMobile,"scroll-x":962,loading:t(b),remote:"","row-key":f=>f.id,pagination:t(S),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(xe,{visible:t(s),"onUpdate:visible":n[3]||(n[3]=f=>F(s)?s.value=f:null),"operate-type":t(D),"row-data":t(k),onSubmitted:t(m)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1})])}}});export{Ge as default};

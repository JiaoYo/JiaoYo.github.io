import{d as j,p as X,r as G,A as xe,D as F,o as y,c as k,w as t,f as N,g as e,h as _,i as U,E as q,L as Ce,b1 as te,K as A,B as R,ap as Y,bb as ne,N as O,O as J,S as K,P as Se,Q as $e,R as ae,j as I,t as H,ad as L,q as Te,e as ee,G as D,ao as se,bc as Ne,bd as Ue,aD as Ie,a1 as z,J as W,ar as Ee,a_ as Ve,be as le,bf as oe,aB as De,bg as ie,bh as re,as as Pe,aq as qe,Z as Q,aj as ue,av as Be,ae as Re,bi as Me,bj as Oe,M as je,ay as Ae,az as Ge}from"./index-DCJMGCjU.js";import{h as Fe,i as ze,j as He,k as Je,l as Le,m as We,n as Ke,o as Qe,p as Ze,q as Xe,r as Ye,s as et,t as tt,u as nt,v as at,w as st,x as lt,y as ot,z as it,A as rt,B as ut,C as dt}from"./basic-config-Dm40MOce.js";import{M as ct}from"./shield-question-outline-rounded-B0xahjMv.js";import{_ as mt}from"./Table-D0NrBicU.js";import{f as de}from"./reportForm-fvgaV3m1.js";import{f as ce}from"./scheduleTask-DWrbVHON.js";import{_ as pt}from"./DatePicker-vb97YeKK.js";import{_ as me}from"./TimePicker-BhqRnlN6.js";import{u as pe}from"./table-BbJ_mIRf.js";import{_ as _t}from"./Popconfirm-hoFMQo4c.js";import{u as ft}from"./usePageData-Bn2m6ygs.js";import{a as gt}from"./events-DhSaSLGQ.js";import"./defineProperty-DAPPGCWD.js";const _e=P=>(Se("data-v-8912ff50"),P=P(),$e(),P),vt={class:"flex justify-center"},yt=_e(()=>N("span",{class:"font-bold"},"提示：",-1)),bt=_e(()=>N("span",{style:{"text-decoration":"underline"}},"被锁定的账号会在设定的时间周期后自动解锁",-1)),ht=j({name:"basicConfig",__name:"basicConfig",setup(P){const{formRef:m,validate:x,restoreValidation:o}=X(),l=G(b());function b(){return{enablelock:1,locktime:5,lockcount:3,unlockeanble:1,unlocktime:5,aceffective:1,pwdexpire:1,expiretime:1,whiteenable:1,cputhreshold:80,memthreshold:80,captcha:1,tokentime:30}}const i={type:"number",required:!0,message:"不能为空",trigger:["blur","change"]},$={locktime:i,lockcount:i,unlocktime:i,expiretime:i,cputhreshold:i,memthreshold:i,tokentime:i},v=async()=>{const{data:u,error:s}=await Fe();s||(Object.assign(l,u),l.locktime=u.locktime/60,l.unlocktime=u.unlocktime/60/24)};xe(()=>{v()});const n=async()=>{var f;const u=l.locktime*60,s=l.unlocktime*60*24;await x();const{error:T}=await ze({...l,locktime:u,unlocktime:s});T||(f=window.$message)==null||f.success("设置成功")};return(u,s)=>{const T=Ce,f=te,d=A,c=R,g=Y,h=ne,C=O,w=J,a=K,p=F("no-auth");return y(),k(a,{style:{"max-height":"calc(100vh - 245px)"}},{default:t(()=>[N("div",vt,[e(w,{ref_key:"formRef",ref:m,"label-width":180,"label-placement":"left",model:l,rules:$},{default:t(()=>[e(d,{label:"是否开启自动解锁",path:"unlockeanble"},{label:t(()=>[_(" 是否开启自动解锁 "),e(T,{trigger:"hover",placement:"top","content-style":"padding: 5px;"},{trigger:t(()=>[e(U(ct),{class:"text-xl cursor-pointer c-#7a7b78"})]),default:t(()=>[yt,bt]),_:1})]),default:t(()=>[e(f,{value:l.unlockeanble,"onUpdate:value":s[0]||(s[0]=r=>l.unlockeanble=r),disabled:"","checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),e(d,{label:"解锁时间",path:"unlocktime"},{default:t(()=>[e(h,{class:"flex items-center"},{default:t(()=>[e(c,{onClick:s[1]||(s[1]=r=>l.unlocktime--),disabled:l.unlocktime==1},{default:t(()=>[_(" − ")]),_:1},8,["disabled"]),e(g,{"show-button":!1,value:l.unlocktime,"onUpdate:value":s[2]||(s[2]=r=>l.unlocktime=r),placeholder:"",min:1,max:3},null,8,["value"]),e(c,{onClick:s[3]||(s[3]=r=>l.unlocktime++),class:"mr-5px",disabled:l.unlocktime==3},{default:t(()=>[_(" + ")]),_:1},8,["disabled"]),_(" 天 ")]),_:1})]),_:1}),e(d,{label:"是否开启验证码",path:"captcha"},{default:t(()=>[e(f,{value:l.captcha,"onUpdate:value":s[4]||(s[4]=r=>l.captcha=r),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),e(d,{label:"是否开启白名单",path:"whiteenable"},{default:t(()=>[e(f,{value:l.whiteenable,"onUpdate:value":s[5]||(s[5]=r=>l.whiteenable=r),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1}),e(d,{label:"密码过期时间",path:"expiretime"},{default:t(()=>[e(h,{class:"flex items-center"},{default:t(()=>[e(c,{onClick:s[6]||(s[6]=r=>l.expiretime--),disabled:l.expiretime==1},{default:t(()=>[_(" − ")]),_:1},8,["disabled"]),e(g,{"show-button":!1,value:l.expiretime,"onUpdate:value":s[7]||(s[7]=r=>l.expiretime=r),placeholder:"",min:1,max:90},null,8,["value"]),e(c,{onClick:s[8]||(s[8]=r=>l.expiretime++),class:"mr-5px",disabled:l.expiretime==90},{default:t(()=>[_(" + ")]),_:1},8,["disabled"]),_(" 天 ")]),_:1})]),_:1}),e(d,{label:"CPU阈值",path:"cputhreshold"},{default:t(()=>[e(h,{class:"flex items-center"},{default:t(()=>[e(c,{onClick:s[9]||(s[9]=r=>l.cputhreshold--),disabled:l.cputhreshold==0},{default:t(()=>[_(" − ")]),_:1},8,["disabled"]),e(g,{"show-button":!1,value:l.cputhreshold,"onUpdate:value":s[10]||(s[10]=r=>l.cputhreshold=r),placeholder:"",min:0,precision:0,max:100},null,8,["value"]),e(c,{onClick:s[11]||(s[11]=r=>l.cputhreshold++),disabled:l.cputhreshold==100,class:"mr-5px"},{default:t(()=>[_(" + ")]),_:1},8,["disabled"]),_(" % ")]),_:1})]),_:1}),e(d,{label:"MEM阈值",path:"memthreshold"},{default:t(()=>[e(h,{class:"flex items-center"},{default:t(()=>[e(c,{onClick:s[12]||(s[12]=r=>l.memthreshold--),disabled:l.memthreshold==0},{default:t(()=>[_(" − ")]),_:1},8,["disabled"]),e(g,{"show-button":!1,value:l.memthreshold,"onUpdate:value":s[13]||(s[13]=r=>l.memthreshold=r),placeholder:"",min:0,precision:0,max:100},null,8,["value"]),e(c,{onClick:s[14]||(s[14]=r=>l.memthreshold++),disabled:l.memthreshold==100,class:"mr-5px"},{default:t(()=>[_(" + ")]),_:1},8,["disabled"]),_(" % ")]),_:1})]),_:1}),e(d,{label:"token过期时间",path:"tokentime"},{default:t(()=>[e(h,{class:"flex items-center"},{default:t(()=>[e(c,{onClick:s[15]||(s[15]=r=>l.tokentime--),disabled:l.tokentime==1},{default:t(()=>[_(" − ")]),_:1},8,["disabled"]),e(g,{"show-button":!1,value:l.tokentime,"onUpdate:value":s[16]||(s[16]=r=>l.tokentime=r),placeholder:"",min:1},null,8,["value"]),e(c,{onClick:s[17]||(s[17]=r=>l.tokentime++),class:"mr-5px"},{default:t(()=>[_(" + ")]),_:1}),_(" 小时 ")]),_:1})]),_:1}),e(d,{label:" "},{default:t(()=>[e(C,null,{default:t(()=>[q((y(),k(c,{type:"default",ghost:"",onClick:v},{default:t(()=>[_(" 刷新 ")]),_:1})),[[p,"system.conf.select"]]),q((y(),k(c,{type:"info",ghost:"",onClick:n},{default:t(()=>[_(" 保存 ")]),_:1})),[[p,"system.conf.update"]])]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1})}}}),wt=ae(ht,[["__scopeId","data-v-8912ff50"]]),kt=N("td",null,"产品名称",-1),xt=N("td",null,"产品版本",-1),Ct=N("td",null,"build号",-1),St=N("td",null,"产品型号",-1),$t=j({name:"basicInfo",__name:"basicInfo",setup(P){const m=I({id:1,pname:"",pversion:"",pbuild:"",pmodel:""});(async()=>{const{data:b,error:i}=await He();i||(m.value=b)})(),I(0);const o=async()=>{var $,v;const{data:b,error:i}=await Je();i||(b==="重启失败"?($=window.$message)==null||$.error(b):(v=window.$message)==null||v.success(b))},l=async()=>{var $,v;const{data:b,error:i}=await Le();i||(b==="关机失败"?($=window.$message)==null||$.error(b):(v=window.$message)==null||v.success(b))};return(b,i)=>{const $=mt,v=R,n=O,u=L,s=F("no-auth");return y(),k(u,{class:"w-600px text-center m-auto mt-20px"},{default:t(()=>[e($,{bordered:!0,"single-line":!1},{default:t(()=>[N("tbody",null,[N("tr",null,[kt,N("td",null,H(m.value.pname||""),1)]),N("tr",null,[xt,N("td",null,H(m.value.pversion),1)]),N("tr",null,[Ct,N("td",null,H(m.value.pbuild),1)]),N("tr",null,[St,N("td",null,H(m.value.pmodel),1)])])]),_:1}),e(n,{justify:"center",class:"mt-50px"},{default:t(()=>[q((y(),k(v,{type:"info",ghost:"",onClick:o},{default:t(()=>[_("重启")]),_:1})),[[s,"sysmanger.basicInfo.restart"]]),q((y(),k(v,{type:"info",ghost:"",onClick:l},{default:t(()=>[_("关机")]),_:1})),[[s,"sysmanger.basicInfo.shutdown"]])]),_:1})]),_:1})}}}),Tt=j({name:"emailService",__name:"emailSever",setup(P){const{createConfirmPwdRule:m,defaultRequiredRule:x,patternRules:o}=Te(),{formRef:l,validate:b}=X(),i=I({port:null,pwd:"",sendserver:"",essl:0,uname:""}),$={sendserver:[{required:!0,validator:(w,a,p)=>a?Ne(a)?p():p(new Error("请输入正确的IP地址或域名")):new Error("请输入服务器地址"),trigger:["blur","input"]}],port:{type:"number",required:!0,trigger:["blur","input"],validator:(w,a,p)=>a==null||a==null?new Error("请输入端口号"):Ue(a)?!0:new Error("请输入在0-65535之间的数字")},uname:[{required:!0,message:"请输入账号",trigger:"blur"}],pwd:[{required:!0,message:"请输入密码",trigger:"blur"}],sendaddr:[{required:!0,message:"请输入发件邮箱",trigger:["blur","input"]},{validator:Ie,trigger:["blur","input"]}]},v=I(!1),n=G({pwd:""}),u={pwd:[{required:!0,message:"请输入密码",trigger:"blur"},o.passwordL]},s=()=>{n.pwd="",v.value=!0},T=I(),f=I(!1),d=async()=>{var r,V;await((r=T.value)==null?void 0:r.validate());const w=z(n.pwd),{data:a,error:p}=await We({pwd:w});p||(a!=null&&a.id||(V=window.$message)==null||V.warning("未查询到邮件服务,请先添加邮件服务"),i.value.sendserver=(a==null?void 0:a.sendserver)??i.value.sendserver,i.value.port=(a==null?void 0:a.port)??i.value.port,i.value.pwd=(a==null?void 0:a.pwd)??i.value.pwd,i.value.essl=(a==null?void 0:a.essl)??i.value.essl,i.value.uname=(a==null?void 0:a.uname)??i.value.uname,i.value.id=(a==null?void 0:a.id)??i.value.id,f.value=!0,v.value=!1)},c=async()=>{var p,r,V,B;await b();const w=z(i.value.pwd),a=z(i.value.uname);if(i.value.id){const{data:S,error:M}=await Ke({...i.value,pwd:w,uname:a});M||((p=window.$message)==null||p.destroyAll(),(r=window.$message)==null||r.success("保存成功"),d())}else{const{data:S,error:M}=await Qe({...i.value,pwd:w,uname:a});M||((V=window.$message)==null||V.destroyAll(),(B=window.$message)==null||B.success("保存成功"),d())}},g=async()=>{var p,r;const{data:w,error:a}=await Ze();a||((p=window.$message)==null||p.destroyAll(),(r=window.$message)==null||r.success("重置成功"),i.value={port:null,pwd:"",sendserver:"",essl:0,uname:"",id:void 0})},h=I(!1),C=async()=>{var p,r;const w=z(i.value.pwd),a=z(i.value.uname);await b();try{h.value=!0;const{data:V,error:B}=await Xe({...i.value,pwd:w,uname:a});B||((p=window.$message)==null||p.destroyAll(),(r=window.$message)==null||r.success("测试成功"))}finally{h.value=!1}};return(w,a)=>{const p=W,r=A,V=Y,B=te,S=J,M=R,fe=O,ge=W,ve=A,ye=J,be=K,he=R,we=O,ke=Ee,Z=F("no-auth");return y(),ee(se,null,[e(S,{ref_key:"formRef",ref:l,"label-width":150,model:i.value,rules:$,"label-placement":"left",class:"w-400px",style:{margin:"50px auto"}},{default:t(()=>[e(r,{label:"发送邮件服务器",path:"sendserver"},{default:t(()=>[e(p,{value:i.value.sendserver,"onUpdate:value":a[0]||(a[0]=E=>i.value.sendserver=E),placeholder:"输入服务器或IP地址"},null,8,["value"])]),_:1}),e(r,{label:"端口",path:"port"},{default:t(()=>[e(V,{value:i.value.port,"onUpdate:value":a[1]||(a[1]=E=>i.value.port=E),placeholder:"输入端口",style:{width:"100%"}},null,8,["value"])]),_:1}),e(r,{label:"用户名",path:"uname"},{default:t(()=>[e(p,{value:i.value.uname,"onUpdate:value":a[2]||(a[2]=E=>i.value.uname=E),placeholder:"用户名"},null,8,["value"])]),_:1}),e(r,{label:"密码",path:"pwd"},{default:t(()=>[e(p,{type:"password",value:i.value.pwd,"onUpdate:value":a[3]||(a[3]=E=>i.value.pwd=E),placeholder:"密码","show-password-on":"click"},null,8,["value"])]),_:1}),e(r,{label:"ssl",path:"essl"},{default:t(()=>[e(B,{value:i.value.essl,"onUpdate:value":a[4]||(a[4]=E=>i.value.essl=E),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1})]),_:1},8,["model"]),e(fe,{justify:"center"},{default:t(()=>[e(M,{type:"info",ghost:"",onClick:s},{default:t(()=>[_("查询")]),_:1}),f.value?q((y(),k(M,{key:0,type:"info",ghost:"",onClick:C},{default:t(()=>[_("测试")]),_:1})),[[Z,"sysmanger.basicInfo.test.mailInfo"]]):D("",!0),f.value?q((y(),k(M,{key:1,type:"info",ghost:"",onClick:c},{default:t(()=>[_("保存")]),_:1})),[[Z,"sysmanger.mailInfo.update"]]):D("",!0),f.value?q((y(),k(M,{key:2,type:"info",ghost:"",onClick:g},{default:t(()=>[_("重置")]),_:1})),[[Z,"sysmanger.mailInfo.delete"]]):D("",!0)]),_:1}),e(ke,{show:v.value,"onUpdate:show":a[6]||(a[6]=E=>v.value=E),title:"查询邮件地址",preset:"card",class:"w-420px"},{footer:t(()=>[e(we,{justify:"center",size:16},{default:t(()=>[e(he,{type:"primary",onClick:d},{default:t(()=>[_(H(w.$t("common.confirm")),1)]),_:1})]),_:1})]),default:t(()=>[e(be,{class:"max-h-480px pr-20px"},{default:t(()=>[e(ye,{ref_key:"checkformRef",ref:T,model:n,"label-placement":"left",rules:u,"label-width":80,"require-mark-placement":"left"},{default:t(()=>[e(ve,{label:w.$t("page.login.common.password"),path:"pwd"},{default:t(()=>[e(ge,{type:"password","show-password-on":"click",class:"eipaddrCss",clearable:"",value:n.pwd,"onUpdate:value":a[5]||(a[5]=E=>n.pwd=E),placeholder:"请输入当前登录账号密码"},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1})]),_:1},8,["show"])],64)}}}),Nt=j({name:"TimingConfig",__name:"timingConfig",setup(P){const{formRef:m,validate:x}=X(),o=G({automatic:1,time:Ve(1,new Date),ip:"",taskId:"",showCron:!1,setting:{settingCycle:void 0,settingCycleValue:void 0,settingTime:void 0}}),l={time:{required:!0,message:"请选择时间",trigger:"blur"},ip:[{required:!0,message:"请输入IP",trigger:"blur"},{validator:De,trigger:"blur"}],task:{required:!0,message:"请设置表达式",trigger:"blur"},setting:{settingCycle:{type:"number",required:!0,message:"请选择设置周期",trigger:"blur"},settingCycleValue:{type:"number",required:!0,message:"请选择设置周期值",trigger:"blur"},settingTime:{required:!0,message:"请选择设置时间",trigger:"blur"}}},b=async()=>{const{data:v,error:n}=await Ye();n||(o.time=v)};b(),(async()=>{const{data:v,error:n}=await et();if(n)return;const{id:u,params:s}=v;try{if(s){const{cron:T,ip:f}=JSON.parse(s),d=ie(T);o.setting.settingCycle=d==null?void 0:d.settingCycle,o.setting.settingTime=d==null?void 0:d.settingTime,o.setting.settingCycleValue=d==null?void 0:d.settingCycleValue,o.ip=f,o.taskId=u}}catch(T){console.error("Error parsing params:",T)}})();const $=async()=>{var v,n;if(await x(),o.automatic){const{data:u,error:s}=await tt({dtime:o.time});s||(v=window.$message)==null||v.success(u)}else{const u=re(o.setting.settingCycle==1?{dayOfWeek:o.setting.settingCycleValue,time:o.setting.settingTime}:null,o.setting.settingCycle==2?{dayOfMonth:o.setting.settingCycleValue,time:o.setting.settingTime}:null,o.setting.settingCycle==3?{time:o.setting.settingTime}:null);o.taskId?await ce({id:o.taskId,beanName:"NtpTask",cronExpression:u,remark:"",status:1,params:JSON.stringify({ip:o.ip,cron:u})}):await de({beanName:"NtpTask",cronExpression:u,remark:"",status:1,params:JSON.stringify({ip:o.ip,cron:u})});const{data:s,error:T}=await nt({ip:o.ip});T||(n=window.$message)==null||n.success(s)}};return(v,n)=>{const u=Pe,s=O,T=qe,f=A,d=pt,c=W,g=Q,h=me,C=R,w=J,a=F("no-auth");return y(),k(w,{ref_key:"formRef",ref:m,"label-width":180,"label-placement":"left",model:o,class:"m-auto w-600px mt-20px",rules:l},{default:t(()=>[e(f,{label:"校时",path:"enablelock"},{default:t(()=>[e(T,{value:o.automatic,"onUpdate:value":n[0]||(n[0]=p=>o.automatic=p),name:"radiogroup"},{default:t(()=>[e(s,null,{default:t(()=>[e(u,{value:1},{default:t(()=>[_("手动校时")]),_:1}),e(u,{value:0},{default:t(()=>[_("自动校时")]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),o.automatic?(y(),k(f,{key:0,label:"设置中心服务器时间",path:"time"},{default:t(()=>[e(d,{"formatted-value":o.time,"onUpdate:formattedValue":n[1]||(n[1]=p=>o.time=p),format:"yyyy-MM-dd HH:mm:ss",type:"datetime",clearable:""},null,8,["formatted-value"])]),_:1})):D("",!0),o.automatic?D("",!0):(y(),ee(se,{key:1},[e(f,{label:"NTP服务器设置",path:"ip"},{default:t(()=>[e(c,{value:o.ip,"onUpdate:value":n[2]||(n[2]=p=>o.ip=p),placeholder:"输入NTP服务器设置",style:{width:"200px"}},null,8,["value"])]),_:1}),e(f,{label:"设置周期",path:"setting.settingCycle"},{default:t(()=>[e(s,{justify:"space-between"},{default:t(()=>[e(g,{value:o.setting.settingCycle,"onUpdate:value":[n[3]||(n[3]=p=>o.setting.settingCycle=p),n[4]||(n[4]=p=>o.setting.settingCycleValue=1)],options:[{label:"每周",value:1},{label:"每月",value:2},{label:"每日",value:3}],style:{width:"200px"}},null,8,["value"]),e(f,{label:"",path:"setting.settingCycleValue","show-feedback":!1},{default:t(()=>[e(s,null,{default:t(()=>[o.setting.settingCycle==1?(y(),k(g,{key:0,value:o.setting.settingCycleValue,"onUpdate:value":n[5]||(n[5]=p=>o.setting.settingCycleValue=p),options:U(le)(),style:{width:"200px"}},null,8,["value","options"])):D("",!0),o.setting.settingCycle==2?(y(),k(g,{key:1,value:o.setting.settingCycleValue,"onUpdate:value":n[6]||(n[6]=p=>o.setting.settingCycleValue=p),options:U(oe)(),style:{width:"200px"}},null,8,["value","options"])):D("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),e(f,{label:"设置时间",path:"setting.settingTime"},{default:t(()=>[e(h,{"formatted-value":o.setting.settingTime,"onUpdate:formattedValue":n[7]||(n[7]=p=>o.setting.settingTime=p)},null,8,["formatted-value"])]),_:1})],64)),e(f,null,{label:t(()=>[o.automatic?q((y(),k(C,{key:0,type:"info",ghost:"",onClick:b},{default:t(()=>[_(" 查看服务器时间 ")]),_:1})),[[a,"sysmanger.basicInfo.gettiming"]]):D("",!0)]),default:t(()=>[e(s,null,{default:t(()=>[q((y(),k(C,{type:"info",ghost:"",onClick:$},{default:t(()=>[_(" 保存 ")]),_:1})),[[a,"sysmanger.basicInfo.manu.timing"]])]),_:1})]),_:1})]),_:1},8,["model"])}}}),Ut=j({name:"dataBase",__name:"dataBase",setup(P){const m=()=>[...Array(12).keys()].map(f=>({label:`${f+1}个月`,value:f+1})),x=G({space:80,retention:void 0,id:void 0}),{columns:o,columnChecks:l,data:b,getData:i,loading:$,mobilePagination:v,searchParams:n,resetSearchParams:u}=pe({apiFn:at,immediate:!0,apiParams:{page:1,limit:20},columns:()=>[{title:"时间",key:"dbtime",align:"center"},{title:"描述",key:"dmsg",align:"center"},{title:"结果",key:"resultmsg",align:"center"}]});(async()=>{const{data:f,error:d}=await st();d||(x.space=f.space,x.retention=f.retention,x.id=f.id)})();const T=async()=>{var c;const{data:f,error:d}=await lt({space:x.space,retention:x.retention,id:x.id});d||(c=window.$message)==null||c.success("保存成功")};return(f,d)=>{const c=R,g=Y,h=ne,C=A,w=Q,a=O,p=L,r=ue,V=K,B=F("no-auth");return y(),k(V,{class:"h-full flex-col",style:{maxHeight:"calc(100vh - 220px)"}},{default:t(()=>[e(p,{title:"数据库维护配置",bordered:!1,class:"mb-20px","content-style":{padding:"0"},"header-style":{paddingTop:"0"}},{default:t(()=>[e(a,{class:"ml-50px"},{default:t(()=>[e(C,{label:"已用空间超过","label-placement":"left"},{default:t(()=>[e(h,{class:"flex items-center"},{default:t(()=>[e(c,{onClick:d[0]||(d[0]=S=>x.space--),disabled:x.space==1},{default:t(()=>[_(" − ")]),_:1},8,["disabled"]),e(g,{"show-button":!1,value:x.space,"onUpdate:value":d[1]||(d[1]=S=>x.space=S),placeholder:"",min:1,max:100,style:{width:"100px","text-align":"center"}},null,8,["value"]),e(c,{onClick:d[2]||(d[2]=S=>x.space++),disabled:x.space==100,class:"mr-5px"},{default:t(()=>[_(" + ")]),_:1},8,["disabled"]),_(" % 时自动维护 ")]),_:1})]),_:1}),e(C,{label:"数据保留时间","label-placement":"left",class:"mx-20px"},{default:t(()=>[e(w,{value:x.retention,"onUpdate:value":d[3]||(d[3]=S=>x.retention=S),placeholder:"请选择",options:m(),style:{width:"150px"}},null,8,["value","options"])]),_:1}),e(C,{label:" ","label-placement":"left"},{default:t(()=>[q((y(),k(c,{type:"info",ghost:"",onClick:T},{default:t(()=>[_("保存")]),_:1})),[[B,"sysmanger.basicInfo.insert.dataBaseMaintenance"]])]),_:1})]),_:1})]),_:1}),e(p,{title:"数据库维护列表",bordered:!1,class:"flex-1","content-style":{padding:"0"},"header-style":{paddingTop:"0"}},{default:t(()=>[e(r,{columns:U(o),data:U(b),size:"small","scroll-x":462,"max-height":420,loading:U($),remote:"","row-key":S=>S.id,pagination:U(v),class:"sm:h-full"},null,8,["columns","data","loading","row-key","pagination"])]),_:1})]),_:1})}}}),It=j({name:"systemSnapshot",__name:"systemSnapshot",setup(P){const{columns:m,columnChecks:x,data:o,getData:l,loading:b,mobilePagination:i,searchParams:$,resetSearchParams:v}=pe({apiFn:ot,immediate:!0,apiParams:{page:1,limit:20},columns:()=>[{title:"时间",key:"dbtime",align:"center"},{title:"描述",key:"dmsg",align:"center"},{title:"结果",key:"resultmsg",align:"center",render:c=>e(Be,{type:c.resultmsg==1?"error":"success"},{default:()=>[c.resultmsg==1?"失败":"成功"]})},{title:"操作",key:"operate",align:"center",width:100,fixed:"right",render:c=>e(_t,{onPositiveClick:()=>d(c.id)},{default:()=>"确定恢复吗?恢复后将重启系统",trigger:()=>e(R,{type:"info",ghost:!0,size:"small"},{default:()=>[_("恢复")]})})}]}),n=G({id:"",setting:{settingCycle:void 0,settingCycleValue:void 0,settingTime:void 0}}),u=I(n),s={setting:{settingCycle:{type:"number",required:!0,message:"请选择设置周期",trigger:["blur","change"]},settingCycleValue:{type:"number",required:!1,message:"请选择设置周期值",trigger:["blur","change"]},settingTime:{required:!0,message:"请选择设置时间",trigger:["blur","change"]}}};(async()=>{const{data:c,error:g}=await it();if(g)return;console.log(c,"asdas");const h=ie(c.cronExpression);Object.assign(n,{id:c.id,setting:h})})();const f=async()=>{var g,h,C;await((g=u.value)==null?void 0:g.validate());const c=re(n.setting.settingCycle==1?{dayOfWeek:n.setting.settingCycleValue,time:n.setting.settingTime}:null,n.setting.settingCycle==2?{dayOfMonth:n.setting.settingCycleValue,time:n.setting.settingTime}:null,n.setting.settingCycle==3?{time:n.setting.settingTime}:null);if(n.id){const{data:w,error:a}=await ce({id:n.id,beanName:"SnapshotTask",cronExpression:c,status:1,params:JSON.stringify({corn:c})});a||(h=window.$message)==null||h.success("设置成功")}else{const{data:w,error:a}=await de({beanName:"SnapshotTask",cronExpression:c,remark:"",status:1,params:JSON.stringify({corn:c})});a||(C=window.$message)==null||C.success("设置成功")}},d=async c=>{var C;const{data:g,error:h}=await rt({id:c});h||(C=window.$message)==null||C.success("恢复成功")};return(c,g)=>{const h=Q,C=A,w=O,a=me,p=J,r=L,V=ue,B=K;return y(),k(B,{class:"h-full flex-col",style:{maxHeight:"calc(100vh - 220px)"}},{default:t(()=>[e(r,{title:"应用配置设置",bordered:!1,"content-style":{padding:"0"},"header-style":{paddingTop:"0"}},{default:t(()=>[e(w,{class:"ml-50px"},{default:t(()=>[e(p,{"label-placement":"left",inline:"",model:n,rules:s,ref_key:"formRef",ref:u,"label-width":150,class:"px-100px"},{default:t(()=>[e(C,{label:"设置周期",path:"setting.settingCycle"},{default:t(()=>[e(w,{justify:"space-between"},{default:t(()=>[e(h,{value:n.setting.settingCycle,"onUpdate:value":[g[0]||(g[0]=S=>n.setting.settingCycle=S),g[1]||(g[1]=S=>n.setting.settingCycleValue=1)],options:[{label:"每周",value:1},{label:"每月",value:2},{label:"每日",value:3}],style:{width:"140px"}},null,8,["value"]),e(C,{label:"",path:"","show-feedback":!1},{default:t(()=>[n.setting.settingCycle==1?(y(),k(h,{key:0,value:n.setting.settingCycleValue,"onUpdate:value":g[2]||(g[2]=S=>n.setting.settingCycleValue=S),options:U(le)(),style:{width:"140px"}},null,8,["value","options"])):D("",!0),n.setting.settingCycle==2?(y(),k(h,{key:1,value:n.setting.settingCycleValue,"onUpdate:value":g[3]||(g[3]=S=>n.setting.settingCycleValue=S),options:U(oe)(),style:{width:"140px"}},null,8,["value","options"])):D("",!0)]),_:1})]),_:1})]),_:1}),e(C,{label:"设置时间",path:"setting.settingTime"},{default:t(()=>[e(a,{"formatted-value":n.setting.settingTime,"onUpdate:formattedValue":g[4]||(g[4]=S=>n.setting.settingTime=S)},null,8,["formatted-value"])]),_:1}),e(C,{label:" ","label-placement":"left"},{default:t(()=>[e(U(R),{type:"info",ghost:"",onClick:f},{default:t(()=>[_("保存")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),e(r,{title:"应用配置列表",bordered:!1,"content-style":{padding:"0"},"header-style":{paddingTop:"0"},class:"flex-1"},{default:t(()=>[e(V,{columns:U(m),data:U(o),size:"small","scroll-x":462,"max-height":420,loading:U(b),remote:"","row-key":S=>S.id,pagination:U(i),class:"sm:h-full"},null,8,["columns","data","loading","row-key","pagination"])]),_:1})]),_:1})}}}),Et=j({__name:"sysStatus",setup(P){const m=G({mailaddr:"",snmpaddr:void 0,stype:0,tmail:0,tsnmp:0});(async()=>{const{data:n,error:u}=await ut();u||(m.mailaddr=(n==null?void 0:n.mailaddr)??m.mailaddr,m.snmpaddr=(n==null?void 0:n.snmpaddr)??m.snmpaddr,m.stype=(n==null?void 0:n.stype)??m.stype,m.tmail=(n==null?void 0:n.tmail)??m.tmail,m.tsnmp=(n==null?void 0:n.tsnmp)??m.tsnmp)})();const o=async()=>{var s;const{data:n,error:u}=await dt(m);u||(s=window.$message)==null||s.success("保存成功")},{pageData:l,getData:b,nextPage:i}=ft(gt),$=async n=>{const u=n.currentTarget;u.scrollTop+u.offsetHeight>=u.scrollHeight&&l.data.length<l.total&&i()},v=I();return Re(()=>l.data,n=>{n&&(v.value=n.filter(u=>u.ftype===1))}),b(),(n,u)=>{const s=Oe,T=je,f=W,d=A,c=Q,g=R,h=O,C=L,w=F("no-auth");return y(),k(h,{justify:"center"},{default:t(()=>[e(C,{title:"通知方式",class:"w-600px"},{default:t(()=>[e(s),e(T,{checked:m.tmail,"onUpdate:checked":u[0]||(u[0]=a=>m.tmail=a),"checked-value":1,"unchecked-value":0},{default:t(()=>[_(" 邮件 ")]),_:1},8,["checked"]),m.tmail?(y(),k(d,{key:0,label:"邮件地址","label-placement":"left","label-width":"120",class:"mt-30px",rule:{required:!0,validator:()=>{if(!m.mailaddr)return new Error("请输入邮件地址");if(!U(Me)(m.mailaddr))return new Error("请输入正确的邮件地址")},trigger:["blur","input"]}},{default:t(()=>[e(f,{value:m.mailaddr,"onUpdate:value":u[1]||(u[1]=a=>m.mailaddr=a)},null,8,["value"])]),_:1},8,["rule"])):D("",!0),e(s),e(T,{checked:m.tsnmp,"onUpdate:checked":u[2]||(u[2]=a=>m.tsnmp=a),"checked-value":1,"unchecked-value":0},{default:t(()=>[_(" snmp trap ")]),_:1},8,["checked"]),m.tsnmp?(y(),k(d,{key:1,label:"通知服务器","label-placement":"left","label-width":"120",class:"mt-30px"},{default:t(()=>[e(c,{value:m.snmpaddr,"onUpdate:value":u[3]||(u[3]=a=>m.snmpaddr=a),options:v.value,"label-field":"ipaddr","value-field":"ipaddr",onScroll:$},null,8,["value","options"])]),_:1})):D("",!0),e(s),e(h,{justify:"end"},{default:t(()=>[q((y(),k(g,{type:"info",ghost:"",onClick:o},{default:t(()=>[_("保存")]),_:1})),[[w,"sysmanger.basicInfo.alarmNotification"]])]),_:1})]),_:1})]),_:1})}}}),Vt={class:"h-full"},Dt=j({name:"basicconfig_system-config",__name:"index",setup(P){const m=I("基本信息");return I(""),I(null),I(0),I(!1),(x,o)=>{const l=Ae,b=Ge,i=L;return y(),ee("div",Vt,[e(i,{style:{"margin-bottom":"16px"},class:"h-full","content-style":{height:"100%"}},{default:t(()=>[e(b,{type:"card",animated:"",class:"h-100%",value:m.value,"onUpdate:value":o[0]||(o[0]=$=>m.value=$)},{default:t(()=>[e(l,{name:"基本信息",tab:"基本信息"},{default:t(()=>[e($t)]),_:1}),e(l,{name:"安全设置",tab:"安全设置"},{default:t(()=>[e(wt)]),_:1}),e(l,{name:"邮件服务",tab:"邮件服务"},{default:t(()=>[e(Tt)]),_:1}),e(l,{name:"校时配置",tab:"校时配置"},{default:t(()=>[e(Nt)]),_:1}),e(l,{name:"数据库维护",tab:"数据库维护",class:"h-100%"},{default:t(()=>[e(Ut)]),_:1}),e(l,{name:"应用配置备份",tab:"应用配置备份",class:"h-100%"},{default:t(()=>[e(It)]),_:1}),e(l,{name:"系统告警通知",tab:"系统告警通知"},{default:t(()=>[e(Et)]),_:1})]),_:1},8,["value"])]),_:1})])}}}),Lt=ae(Dt,[["__scopeId","data-v-c240cf25"]]);export{Lt as default};

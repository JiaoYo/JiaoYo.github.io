import{_ as Y}from"./table-header-operation.vue_vue_type_script_setup_true_lang-CvYtnbqB.js";import{d as P,n as K,s as E,p as G,q as Z,b as ee,r as te,ae,D as F,o as V,c as W,w as a,g as e,h as O,t as j,i as t,$ as g,E as h,J as H,K as oe,O as J,B as M,N as L,af as ne,ag as le,F as se,ad as Q,a3 as re,e as ie,ah as A,ai as ue,aj as ce}from"./index-DqR-s4w3.js";import{u as de,a as me}from"./table-h8GqLGXE.js";import{f as pe,a as _e,b as fe,c as he}from"./basic-config-D3jaxLM3.js";import{_ as ge}from"./round-search-CArtNxgy.js";import{_ as ve}from"./round-refresh-BmRTRhVY.js";import{_ as be}from"./lodash-DG9XUo6B.js";import{_ as we}from"./FormItemGridItem-CYoIviRb.js";import{_ as ye}from"./Grid-ELDx_WAZ.js";import{h as I}from"./permission-TbEHYvJY.js";import{_ as ke}from"./Popconfirm-9MCMyHQG.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-E_oryi12.js";import"./setting-outlined-CTeedqNY.js";import"./export-BSP7dOrb.js";import"./refresh-BTsHfxAU.js";import"./round-delete-BDwNXc1C.js";import"./round-plus-ZPv0S9Lb.js";import"./Upload-B3BDZY5E.js";import"./Progress-BQv5MD9E.js";const De=P({name:"OperateDrawer",__name:"operate-drawer",props:K({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:K(["submitted"],["update:visible"]),setup(v,{emit:R}){const d=v,w=R,f=E(v,"visible"),{formRef:m,validate:N,restoreValidation:U}=G(),{defaultRequiredRule:k,patternRules:D}=Z(),C=ee(()=>({add:"新增区域",edit:"编辑区域"})[d.operateType]),o=te(z());function z(){return{id:void 0,rname:"",refer:"",ophone:"",email:"",func:"",addr:"",rdesc:""}}const S={rname:k,email:D.email,ophone:D.mobile};function T(){Object.assign(o,z()),d.operateType==="edit"&&d.rowData&&Object.assign(o,d.rowData)}function i(){f.value=!1}async function $(){var y,n;if(await N(),d.operateType==="add"){const{data:u,error:r}=await pe([o]);r||((y=window.$message)==null||y.success(g("common.addSuccess")),i(),w("submitted"))}else{const{data:u,error:r}=await _e([o]);r||((n=window.$message)==null||n.success(g("common.updateSuccess")),i(),w("submitted"))}}return ae(f,()=>{f.value&&(T(),U())}),(y,n)=>{const u=H,r=oe,B=J,x=M,c=L,l=ne,b=le,p=F("no-space");return V(),W(b,{show:f.value,"onUpdate:show":n[7]||(n[7]=s=>f.value=s),"display-directive":"show",width:360},{default:a(()=>[e(l,{title:C.value,"native-scrollbar":!1,closable:""},{footer:a(()=>[e(c,{size:16},{default:a(()=>[e(x,{onClick:i},{default:a(()=>[O(j(t(g)("common.cancel")),1)]),_:1}),e(x,{type:"primary",onClick:$},{default:a(()=>[O(j(t(g)("common.confirm")),1)]),_:1})]),_:1})]),default:a(()=>[e(B,{ref_key:"formRef",ref:m,model:o,rules:S},{default:a(()=>[e(r,{label:"区域名称",path:"rname"},{default:a(()=>[h(e(u,{value:o.rname,"onUpdate:value":n[0]||(n[0]=s=>o.rname=s),placeholder:"请输入区域名称",clearable:""},null,8,["value"]),[[p]])]),_:1}),e(r,{label:"简称",path:"refer"},{default:a(()=>[h(e(u,{value:o.refer,"onUpdate:value":n[1]||(n[1]=s=>o.refer=s),placeholder:"请输入简称",clearable:""},null,8,["value"]),[[p]])]),_:1}),e(r,{label:"办公电话",path:"ophone"},{default:a(()=>[h(e(u,{value:o.ophone,"onUpdate:value":n[2]||(n[2]=s=>o.ophone=s),placeholder:"请输入办公电话",clearable:""},null,8,["value"]),[[p]])]),_:1}),e(r,{label:"电子邮箱",path:"email"},{default:a(()=>[h(e(u,{value:o.email,"onUpdate:value":n[3]||(n[3]=s=>o.email=s),placeholder:"请输入电子邮箱",clearable:""},null,8,["value"]),[[p]])]),_:1}),e(r,{label:"职能",path:"func"},{default:a(()=>[h(e(u,{value:o.func,"onUpdate:value":n[4]||(n[4]=s=>o.func=s),placeholder:"请输入职能",clearable:""},null,8,["value"]),[[p]])]),_:1}),e(r,{label:"地址",path:"addr"},{default:a(()=>[h(e(u,{value:o.addr,"onUpdate:value":n[5]||(n[5]=s=>o.addr=s),placeholder:"请输入地址",clearable:""},null,8,["value"]),[[p]])]),_:1}),e(r,{label:"备注",path:"rdesc"},{default:a(()=>[h(e(u,{type:"textarea",value:o.rdesc,"onUpdate:value":n[6]||(n[6]=s=>o.rdesc=s),placeholder:"请输入备注",clearable:""},null,8,["value"]),[[p]])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),xe=P({name:"FormSearch",__name:"form-search",props:{model:{required:!0},modelModifiers:{}},emits:K(["reset","search"],["update:model"]),setup(v,{emit:R}){const d=R,{formRef:w,restoreValidation:f}=G(),m=E(v,"model");function N(){m.value.fuzzy="",d("search")}async function U(){await f(),d("reset")}async function k(){d("search")}const D=be.debounce(k,1e3,{leading:!0,trailing:!1});return(C,o)=>{const z=H,S=we,T=ve,i=M,$=ge,y=L,n=ye,u=J,r=Q,B=F("no-space");return V(),W(r,{bordered:!1,size:"small",class:"card-wrapper"},{default:a(()=>[e(u,{ref_key:"formRef",ref:w,model:m.value,"label-placement":"left","label-width":100,"show-feedback":!1,onKeyup:se(t(D),["enter"])},{default:a(()=>[e(n,{responsive:"screen","item-responsive":"","x-gap":12,"y-gap":12},{default:a(()=>[e(S,{span:"24 s:12 m:10 l:6",label:"区域名称",path:"fuzzy"},{default:a(()=>[h(e(z,{clearable:"",value:m.value.fuzzy,"onUpdate:value":o[0]||(o[0]=x=>m.value.fuzzy=x),placeholder:"请输入区域名称",onClear:N},null,8,["value"]),[[B]])]),_:1}),e(S,{span:"24 s:12 m:10 l:6"},{default:a(()=>[e(y,{class:"w-full"},{default:a(()=>[e(i,{onClick:U},{icon:a(()=>[e(T,{class:"text-icon"})]),default:a(()=>[O(" "+j(t(g)("common.reset")),1)]),_:1}),e(i,{type:"primary",ghost:"",onClick:t(D)},{icon:a(()=>[e($,{class:"text-icon"})]),default:a(()=>[O(" "+j(t(g)("common.search")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","onKeyup"])]),_:1})}}}),Ne={class:"min-h-500px flex-col-stretch gap-16px overflow-auto lt-sm:overflow-auto"};function q(v){return typeof v=="function"||Object.prototype.toString.call(v)==="[object Object]"&&!ue(v)}const Ge=P({name:"assetmanagement_area",__name:"index",setup(v){const R=re(),{columns:d,columnChecks:w,data:f,getData:m,loading:N,mobilePagination:U,searchParams:k,resetSearchParams:D}=de({apiFn:fe,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,fuzzy:null,_t:new Date().getTime()},columns:()=>[{type:"selection",align:"center",width:48},{key:"rname",title:"区域名称",align:"center",minWidth:200,ellipsis:!0},{key:"refer",title:"简称",align:"center",width:160,ellipsis:!0},{key:"ophone",title:"办公电话",align:"center",width:160,ellipsis:!0},{key:"email",title:"电子邮箱",align:"center",width:160,ellipsis:!0},{key:"func",title:"职能",align:"center",width:160,ellipsis:!0},{key:"addr",title:"地址",align:"center",width:160,ellipsis:!0},{key:"rdesc",title:"备注",align:"center",minWidth:200,ellipsis:!0},{key:"operate",title:g("common.operate"),align:"center",width:130,fixed:"right",render:c=>{let l;return e("div",{class:"flex-center gap-8px"},[h(e(M,{type:"primary",ghost:!0,size:"small",onClick:()=>B(c.id)},q(l=g("common.edit"))?l:{default:()=>[l]}),[[F("no-auth"),"sys.region.mengement.update"]]),e(ke,{onPositiveClick:()=>r(c.id)},{default:()=>g("common.confirmDelete"),trigger:()=>{let b;return h(e(M,{type:"error",ghost:!0,size:"small"},q(b=g("common.delete"))?b:{default:()=>[b]}),[[F("no-auth"),"sys.region.mengement.delete"]])}})])}}]}),{drawerVisible:C,operateType:o,editingData:z,handleAdd:S,handleEdit:T,checkedRowKeys:i,onBatchDeleted:$,onDeleted:y,closeDrawer:n}=me(f,m);async function u(){console.log(i.value),x(i.value.join(","),c=>{$()})}function r(c){console.log(c),x(c,l=>{y()})}function B(c){T(c)}async function x(c,l){const{data:b,error:p}=await he(c);if(!p)l&&l(b);else return!1}return(c,l)=>{const b=Y,p=ce,s=Q;return V(),ie("div",Ne,[e(xe,{model:t(k),"onUpdate:model":l[0]||(l[0]=_=>A(k)?k.value=_:null),onReset:t(D),onSearch:t(m)},null,8,["model","onReset","onSearch"]),e(s,{title:"区域列表",bordered:!1,size:"small",class:"sm:flex-1-hidden"},{"header-extra":a(()=>[e(b,{columns:t(w),"onUpdate:columns":l[1]||(l[1]=_=>A(w)?w.value=_:null),"disabled-delete":t(i).length===0,"is-view-add-button":t(I)("sys.region.mengement.insert"),"is-view-delete-button":t(I)("sys.region.mengement.delete"),loading:t(N),onAdd:t(S),onDelete:u,onRefresh:t(m)},null,8,["columns","disabled-delete","is-view-add-button","is-view-delete-button","loading","onAdd","onRefresh"])]),default:a(()=>[e(p,{"checked-row-keys":t(i),"onUpdate:checkedRowKeys":l[2]||(l[2]=_=>A(i)?i.value=_:null),columns:t(d),data:t(f),size:"small","flex-height":!t(R).isMobile,"scroll-x":t(d).reduce((_,X)=>_+X.width,0),loading:t(N),remote:"","row-key":_=>_.id,pagination:t(U),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","scroll-x","loading","row-key","pagination"]),e(De,{visible:t(C),"onUpdate:visible":l[3]||(l[3]=_=>A(C)?C.value=_:null),"operate-type":t(o),"row-data":t(z),onSubmitted:t(m)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1})])}}});export{Ge as default};

import{_ as q}from"./export-oh2-I3ZA.js";import{d as z,o as C,c as M,w as t,g as e,h as k,t as v,i as o,$ as r,B as S,E as P,D as U,ad as E,a4 as T,j as y,e as V,ah as F,S as O,F as R}from"./index-7Q9xZuwa.js";import{f as A,a as G}from"./system-log-Di2MRGoN.js";import{u as W}from"./table-G6_8Abm0.js";import{_ as H}from"./round-search-BQOA9W6m.js";import{_ as J}from"./FormItemGridItem-DYTXkfwP.js";import{_ as K}from"./Grid-CRtcNhSF.js";import{_ as Q}from"./DataTable-n3fP4Loy.js";import"./Forward-BzUEeUAa.js";const X=z({name:"ErrorSearch",__name:"errorlog-search",emits:["search"],setup(s,{expose:x,emit:l}){const m=l;function _(){m("search")}async function N(){const{data:u,error:d}=await A();if(!d){let i=u,c=new Blob([i],{type:"application/vnd.ms-excel"}),g=new Date().getTime()+".xls",f=window.webkitURL.createObjectURL(c),a=document.createElement("a");a.href=f,a.download=g,document.body.appendChild(a),a.click(),a.remove()}}return x({handleExportChange:N}),(u,d)=>{const i=H,c=S,g=P,f=J,a=K,h=U,b=E;return C(),M(b,{bordered:!1,size:"small",class:"card-wrapper"},{default:t(()=>[e(h,{"label-placement":"left","label-width":80,"show-feedback":!1},{default:t(()=>[e(a,{responsive:"screen","item-responsive":""},{default:t(()=>[e(f,{span:"24 s:12 m:6"},{default:t(()=>[e(g,{class:"w-full"},{default:t(()=>[e(c,{type:"primary",ghost:"",onClick:_},{icon:t(()=>[e(i,{class:"text-icon"})]),default:t(()=>[k(" "+v(o(r)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),Y={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function Z(s){return typeof s=="function"||Object.prototype.toString.call(s)==="[object Object]"&&!F(s)}const ce=z({name:"logmanage_errorlog",__name:"index",setup(s){const x=T(),l=y(!1),m=y({errorInfo:""}),{columns:_,columnChecks:N,data:u,getData:d,loading:i,pagination:c,searchParams:g,resetSearchParams:f}=W({apiFn:G,immediate:!0,apiParams:{page:1,pageSize:20,limit:20,_t:new Date().getTime()},columns:()=>[{key:"requestUri",title:r("page.systemlog.error.requestUri"),width:160,align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"requestMethod",title:r("page.systemlog.error.requestMethod"),width:100,align:"center",resizable:!0},{key:"requestParams",title:r("page.systemlog.error.requestParams"),width:140,align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"ip",title:r("page.systemlog.error.ip"),width:160,align:"center",resizable:!0},{key:"userAgent",title:r("page.systemlog.error.userAgent"),minWidth:240,align:"center",ellipsis:{tooltip:!0},resizable:!0},{key:"createDate",title:r("page.systemlog.error.createDate"),width:160,align:"center",resizable:!0},{key:"operate",title:r("common.operate"),align:"center",width:130,render:w=>{let n;return e("div",{class:"flex-center gap-8px"},[e(S,{type:"primary",ghost:!0,size:"small",onClick:()=>a(w)},Z(n=r("page.systemlog.error.errorMsg"))?n:{default:()=>[n]})])}}]});function a(w){m.value.errorInfo=w.errorInfo,l.value=!0}const h=y(),b=()=>{h.value.handleExportChange()};return(w,n)=>{const D=q,j=Q,B=E,I=O,L=R;return C(),V("div",Y,[e(X,{onSearch:o(d),ref_key:"searchRef",ref:h},null,8,["onSearch"]),e(B,{title:o(r)("page.systemlog.error.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":t(()=>[e(o(S),{type:"info",size:"small",ghost:"",onClick:b},{icon:t(()=>[e(D,{class:"text-icon"})]),default:t(()=>[k(" "+v(o(r)("common.export")),1)]),_:1})]),default:t(()=>[e(j,{columns:o(_),data:o(u),size:"small","flex-height":!o(x).isMobile,"scroll-x":o(_).reduce((p,$)=>p+$.width,0),loading:o(i),remote:"","row-key":p=>p.id,pagination:o(c),class:"sm:h-full"},null,8,["columns","data","flex-height","scroll-x","loading","row-key","pagination"])]),_:1},8,["title"]),e(L,{show:l.value,"onUpdate:show":n[0]||(n[0]=p=>l.value=p),title:o(r)("page.systemlog.error.errorMsg"),preset:"card",class:"w-800px"},{default:t(()=>[e(I,{class:"h-480px pr-20px"},{default:t(()=>[k(v(m.value.errorInfo),1)]),_:1})]),_:1},8,["show","title"])])}}});export{ce as default};

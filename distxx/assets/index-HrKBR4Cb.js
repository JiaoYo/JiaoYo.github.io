import{o as r,b as u,e as m,d as z,b_ as S,f as e,aD as Z,c as B,w as t,t as w,h as c,E as F,X as L,I as D,i as v,b$ as E,g as k,B as q,S as H,c0 as R,C as W,F as G}from"./index-oTaiMRbd.js";import{u as Q}from"./table-DnBh5Pte.js";import{_ as U}from"./DataTable-hPvPlJa5.js";import{_ as X,a as j}from"./Upload-XcdJ5guq.js";import{a as A,_ as J}from"./Grid-ChzUNHMV.js";import"./RadioGroup-Bh3O6RRN.js";import"./Forward-BcvJs4Ge.js";const K={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"},O=m("path",{fill:"currentColor",d:"M16 18v2H8v-2zM11 7.99V16h2V7.99h3L12 4L8 7.99z"},null,-1),Y=[O];function ee(d,n){return r(),u("svg",K,[...Y])}const te={name:"ic-twotone-upgrade",render:ee},ne={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"},oe=m("path",{fill:"currentColor",d:"M11 17h2v-4.2l1.6 1.6L16 13l-4-4l-4 4l1.4 1.4l1.6-1.6V17Zm-9 3V4h8l2 2h10v14H2Zm2-2h16V8h-8.825l-2-2H4v12Zm0 0V6v12Z"},null,-1),ae=[oe];function se(d,n){return r(),u("svg",ne,[...ae])}const le={name:"material-symbols-drive-folder-upload-outline-sharp",render:se},ce={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"},re=m("path",{fill:"currentColor",d:"m12 13.4l-2.917 2.925q-.277.275-.704.275t-.704-.275q-.275-.275-.275-.7t.275-.7L10.6 12L7.675 9.108Q7.4 8.831 7.4 8.404t.275-.704q.275-.275.7-.275t.7.275L12 10.625L14.892 7.7q.277-.275.704-.275t.704.275q.3.3.3.713t-.3.687L13.375 12l2.925 2.917q.275.277.275.704t-.275.704q-.3.3-.712.3t-.688-.3z"},null,-1),ie=[re];function _e(d,n){return r(),u("svg",ce,[...ie])}const ue={name:"material-symbols-close-small-rounded",render:_e},de={class:"version"},pe=z({__name:"table",props:{type:{type:Number,default:0}},setup(d){const n=d,{columns:p,data:f,getData:b,loading:l,mobilePagination:y,searchParams:C}=Q({apiFn:S,apiParams:{page:1,pageSize:50,limit:50,type:n.type,_t:new Date().getTime()},showTotal:!0,columns:()=>[{key:"ver",title:"版本号",align:"center",minWidth:160},{key:"dbtime",title:"升级时间",align:"center",minWidth:160,render:i=>e("span",null,[i.dbtime.substring(10,0)])},{key:"status",title:"升级状态",align:"center",render:i=>e(Z,{type:i.status===0?"success":"error"},{default:()=>[i.status===0?"成功":"失败"]})}]});return(i,o)=>{const a=U,_=L;return r(),B(_,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:t(()=>[e(c(F),null,{default:t(()=>{var s;return[m("div",null,w(n.type===0?"后台服务":n.type===1?"web服务":"预测服务"),1),m("div",de,"当前版本："+w((s=c(f).find(h=>h.curver===0))==null?void 0:s.ver),1)]}),_:1})]),default:t(()=>[e(a,{columns:c(p),data:c(f),size:"small",loading:c(l),remote:"","row-key":s=>s.id,pagination:c(y),class:"sm:h-full","flex-height":!0,"scroll-x":""},null,8,["columns","data","loading","row-key","pagination"])]),_:1})}}}),$=D(pe,[["__scopeId","data-v-519e5a0e"]]),me={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},fe={key:0,style:{width:"300px"}},he=z({name:"manage_upgrade",__name:"index",setup(d){const n=v(""),p=v(null),f=({file:o,data:a,headers:_,withCredentials:s,action:h,onFinish:g,onError:N,onProgress:V})=>{p.value=o.file,n.value=o.name},b=v(0),l=v(!1),y=o=>{l.value=!0,b.value=o},C=async()=>{var o;try{const a=new FormData;a.append("fi",p.value);const{data:_,error:s}=await R({fname:n.value},a,y);if(s)return;(o=window.$message)==null||o.success(_),l.value=!1}catch{l.value=!1}},i=o=>{o.stopPropagation(),n.value="",p.value=null};return(o,a)=>{const _=ue,s=le,h=X,g=W,N=te,V=F,P=j,T=G,I=L,x=A,M=J;return r(),u("div",me,[e(I,{bordered:!1,size:"small",class:"card-wrapper"},{default:t(()=>[e(T,{ref:"formRef",inline:"","label-placement":"left","label-width":100,"show-feedback":!1},{default:t(()=>[e(g,{label:"升级包选择",path:"fi"},{default:t(()=>[e(h,{action:"","custom-request":f,"show-file-list":!1,accept:".gz"},{default:t(()=>[n.value?(r(),u("div",{key:0,onClick:a[0]||(a[0]=E(()=>{},["stop"]))},[k(w(n.value)+" ",1),e(_,{class:"font-size-30px cursor-pointer",onClick:i})])):(r(),B(c(q),{key:1},{icon:t(()=>[e(s,{class:"text-icon"})]),default:t(()=>[k(" 上传文件")]),_:1}))]),_:1})]),_:1}),e(g,null,{default:t(()=>[e(V,{class:"w-full"},{default:t(()=>[e(c(q),{onClick:C,loading:l.value,disabled:!n.value,type:"primary",ghost:""},{icon:t(()=>[e(N,{class:"text-icon"})]),default:t(()=>[k(" "+w(l.value?"正在升级中":"升级"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1}),e(g,null,{default:t(()=>[l.value?(r(),u("div",fe,[e(P,{type:"line",percentage:b.value},null,8,["percentage"])])):H("",!0)]),_:1})]),_:1},512)]),_:1}),e(M,{"x-gap":"16",cols:3,class:"h-100%"},{default:t(()=>[e(x,null,{default:t(()=>[e($,{type:0,class:"h-100%"})]),_:1}),e(x,null,{default:t(()=>[e($,{type:1,class:"h-100%"})]),_:1}),e(x,null,{default:t(()=>[e($,{type:2,class:"h-100%"})]),_:1})]),_:1})])}}}),$e=D(he,[["__scopeId","data-v-8c2ecb9e"]]);export{$e as default};

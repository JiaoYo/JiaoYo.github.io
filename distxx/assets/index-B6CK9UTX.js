import{i as Y,a as P,j as se,k as ne,d as z,m as E,o as k,b as x,e as N,n as te,u as V,p as O,r as L,q as T,s as ae,v as le,c as F,w as p,f as s,x as X,h as n,$ as c,y as J,g as S,t as C,z as re,A as W,C as q,D as ie,B as A,E as K,F as G,G as de,H as ce,I as Z,J as pe,K as ue,R as me,L as fe,M as ge,N as _e,O as we,P as he,T as ve,Q as ye,S as Q,U as ke,V as M,W as B,X as xe}from"./index-CGiaWMMy.js";function Ce(r){const l=Y(0),y=P(()=>Math.ceil(l.value/60)),a=P(()=>l.value>0),{pause:f,resume:u}=se(()=>{l.value>0?l.value-=1:f()},{immediate:!1});function _(h=r){l.value=60*h,u()}function e(){l.value=0,f()}return ne(()=>{f()}),{count:y,isCounting:a,start:_,stop:e}}const be="/assets/bg-B34Vl8rr.jpg",Pe={class:"absolute-lt z-1 size-full overflow-hidden"},Ne=N("img",{src:be,alt:"",class:"h-100% w-100%"},null,-1),Se=[Ne],Ie=z({name:"WaveBg",__name:"wave-bg",props:{themeColor:{}},setup(r){const g=r;return P(()=>E(g.themeColor,200)),P(()=>E(g.themeColor,500)),(l,y)=>(k(),x("div",Pe,Se))}});/*! js-cookie v3.0.5 | MIT */function $(r){for(var g=1;g<arguments.length;g++){var l=arguments[g];for(var y in l)r[y]=l[y]}return r}var Re={read:function(r){return r[0]==='"'&&(r=r.slice(1,-1)),r.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(r){return encodeURIComponent(r).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function j(r,g){function l(a,f,u){if(!(typeof document>"u")){u=$({},g,u),typeof u.expires=="number"&&(u.expires=new Date(Date.now()+u.expires*864e5)),u.expires&&(u.expires=u.expires.toUTCString()),a=encodeURIComponent(a).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var _="";for(var e in u)u[e]&&(_+="; "+e,u[e]!==!0&&(_+="="+u[e].split(";")[0]));return document.cookie=a+"="+r.write(f,a)+_}}function y(a){if(!(typeof document>"u"||arguments.length&&!a)){for(var f=document.cookie?document.cookie.split("; "):[],u={},_=0;_<f.length;_++){var e=f[_].split("="),h=e.slice(1).join("=");try{var w=decodeURIComponent(e[0]);if(u[w]=r.read(h,w),a===w)break}catch{}}return a?u[a]:u}}return Object.create({set:l,get:y,remove:function(a,f){l(a,"",$({},f,{expires:-1}))},withAttributes:function(a){return j(this.converter,$({},this.attributes,a))},withConverter:function(a){return j($({},this.converter,a),this.attributes)}},{attributes:{value:Object.freeze(g)},converter:{value:Object.freeze(r)}})}var ee=j(Re,{path:"/"});const D=(r,g,l)=>{ee.set(r,g)},U=r=>ee.get(r),ze=r=>(de("data-v-3923ec68"),r=r(),ce(),r),$e={class:"flex-y-center justify-between"},Ue=ze(()=>N("div",{style:{display:"flex","justify-content":"right","align-items":"center"}},null,-1)),Le=z({name:"PwdLogin",__name:"pwd-login",setup(r){const g=te();V();const{formRef:l,validate:y}=O(),a=L({username:"",password:""}),f=L({uuid:"",checked:!1}),u=P(()=>{const{formRules:t}=T();return{username:t.username,password:t.password}});async function _(){await y(),f.checked?e(a.username,a.password,f.checked):w(),f.uuid=re(),await g.login(a.username.trim(),a.password.trim(),f.uuid)}function e(t,o,i){D("energy_storage_user",t),D("energy_storage_pwd",o),D("energy_storage_check",String(i))}function h(){a.username=U("energy_storage_user")||"",a.password=U("energy_storage_pwd")||"",f.checked=U("energy_storage_check")?U("energy_storage_check")=="true":!1}function w(){e("","",!1)}return ae(()=>{h()}),(t,o)=>{const i=W,d=q,v=ie,b=A,I=K,m=G,H=le("no-space");return k(),F(m,{ref_key:"formRef",ref:l,model:a,rules:u.value,size:"large","show-label":!1},{default:p(()=>[s(d,{path:"userName"},{default:p(()=>[X(s(i,{autofocus:"",value:a.username,"onUpdate:value":o[0]||(o[0]=R=>a.username=R),placeholder:n(c)("page.login.common.userNamePlaceholder"),onKeyup:J(_,["enter"])},null,8,["value","placeholder"]),[[H]])]),_:1}),s(d,{path:"password"},{default:p(()=>[X(s(i,{value:a.password,"onUpdate:value":o[1]||(o[1]=R=>a.password=R),type:"password","show-password-on":"click",minlength:6,maxlength:18,placeholder:n(c)("page.login.common.passwordPlaceholder"),onKeyup:J(_,["enter"])},null,8,["value","placeholder"]),[[H]])]),_:1}),s(I,{vertical:"",size:24},{default:p(()=>[N("div",$e,[s(v,{checked:f.checked,"onUpdate:checked":o[2]||(o[2]=R=>f.checked=R)},{default:p(()=>[S(C(n(c)("page.login.pwdLogin.rememberMe")),1)]),_:1},8,["checked"])]),s(b,{type:"primary",size:"large",round:"",block:"",loading:n(g).loginLoading,onClick:_},{default:p(()=>[S(C(n(c)("common.confirm")),1)]),_:1},8,["loading"]),Ue]),_:1})]),_:1},8,["model","rules"])}}}),Fe=Z(Le,[["__scopeId","data-v-3923ec68"]]);function oe(){const{loading:r,startLoading:g,endLoading:l}=pe(),{count:y,start:a,stop:f,isCounting:u}=Ce(60),_=P(()=>{let w=c("page.login.codeLogin.getCode");const t=c("page.login.codeLogin.reGetCode",{time:y.value});return r.value&&(w=""),u.value&&(w=t),w});function e(w){var t,o,i,d;return w.trim()===""?((o=(t=window.$message)==null?void 0:t.error)==null||o.call(t,c("form.mobile.required")),!1):me.test(w)?!0:((d=(i=window.$message)==null?void 0:i.error)==null||d.call(i,c("form.mobile.invalid")),!1)}async function h(w,t){!e(w)||r.value||(g(),await new Promise(i=>{ue(w,t).then(d=>{var v,b;console.log("response",d),d.error||(setTimeout(i,500),(b=(v=window.$message)==null?void 0:v.success)==null||b.call(v,c("page.login.codeLogin.sendCodeSuccess")),a(),l())}).catch(d=>{var v,b;return console.log("error",d),(b=(v=window.$message)==null?void 0:v.error)==null||b.call(v,c("page.login.codeLogin.sendCodeFailed")),!1})}))}return{label:_,start:a,stop:f,isCounting:u,loading:r,getCaptcha:h}}const Me={class:"w-full flex-y-center gap-16px"},Be=z({name:"CodeLogin",__name:"register",setup(r){const{toggleLoginModule:g}=V(),{formRef:l,validate:y}=O(),{label:a,isCounting:f,loading:u,getCaptcha:_}=oe(),e=L({deptName:"",username:"",email:"",mobile:"",code:"",password:"",confirmPassword:"",status:1,deptId:0,pid:0,roleIdList:["1147694289157566466"]}),h=P(()=>{const{formRules:t,createConfirmPwdRule:o}=T();return{deptName:t.deptName,username:t.username,email:t.email,mobile:t.mobile,code:t.code,password:t.password,confirmPassword:o(e.password),status:t.status,deptId:t.deptId,pid:t.pid,roleIdList:t.roleIdList}});async function w(){var i,d;await y();const{data:t,error:o}=await fe(e.username,e.username,e.deptName,e.email,e.mobile,e.code,e.password,e.confirmPassword,e.status,e.deptId,e.pid,e.roleIdList);console.log("data",t),o?(d=window.$message)==null||d.error(c("page.login.common.validateFail")):((i=window.$message)==null||i.success(c("page.login.common.validateSuccess")),g("pwd-login"))}return(t,o)=>{const i=W,d=q,v=A,b=K,I=G;return k(),F(I,{ref_key:"formRef",ref:l,model:e,rules:h.value,size:"large","show-label":!1},{default:p(()=>[s(d,{path:"deptName"},{default:p(()=>[s(i,{value:e.deptName,"onUpdate:value":o[0]||(o[0]=m=>e.deptName=m),placeholder:n(c)("page.login.common.deptNamePlaceholder")},null,8,["value","placeholder"])]),_:1}),s(d,{path:"username"},{default:p(()=>[s(i,{value:e.username,"onUpdate:value":o[1]||(o[1]=m=>e.username=m),placeholder:n(c)("page.login.common.userNamePlaceholder")},null,8,["value","placeholder"])]),_:1}),s(d,null,{default:p(()=>[s(i,{value:e.email,"onUpdate:value":o[2]||(o[2]=m=>e.email=m),placeholder:n(c)("page.login.common.emailPlaceholder")},null,8,["value","placeholder"])]),_:1}),s(d,{path:"mobile"},{default:p(()=>[s(i,{value:e.mobile,"onUpdate:value":o[3]||(o[3]=m=>e.mobile=m),placeholder:n(c)("page.login.common.mobilePlaceholder"),maxlength:11},null,8,["value","placeholder"])]),_:1}),s(d,{path:"code"},{default:p(()=>[N("div",Me,[s(i,{value:e.code,"onUpdate:value":o[4]||(o[4]=m=>e.code=m),placeholder:n(c)("page.login.common.codePlaceholder")},null,8,["value","placeholder"]),s(v,{size:"large",disabled:n(f),loading:n(u),onClick:o[5]||(o[5]=m=>n(_)(e.mobile,0))},{default:p(()=>[S(C(n(a)),1)]),_:1},8,["disabled","loading"])])]),_:1}),s(d,{path:"password"},{default:p(()=>[s(i,{value:e.password,"onUpdate:value":o[6]||(o[6]=m=>e.password=m),type:"password","show-password-on":"click",placeholder:n(c)("page.login.common.passwordPlaceholder")},null,8,["value","placeholder"])]),_:1}),s(d,{path:"confirmPassword"},{default:p(()=>[s(i,{value:e.confirmPassword,"onUpdate:value":o[7]||(o[7]=m=>e.confirmPassword=m),type:"password","show-password-on":"click",placeholder:n(c)("page.login.common.confirmPasswordPlaceholder")},null,8,["value","placeholder"])]),_:1}),s(b,{vertical:"",size:18,class:"w-full"},{default:p(()=>[s(v,{type:"primary",size:"large",round:"",block:"",onClick:w},{default:p(()=>[S(C(n(c)("common.confirm")),1)]),_:1}),s(v,{size:"large",round:"",block:"",onClick:o[8]||(o[8]=m=>n(g)("pwd-login"))},{default:p(()=>[S(C(n(c)("page.login.common.back")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])}}}),De={class:"w-full flex-y-center gap-16px"},Ee=z({name:"ResetPwd",__name:"reset-pwd",setup(r){const{toggleLoginModule:g}=V(),{formRef:l,validate:y}=O(),{label:a,isCounting:f,loading:u,getCaptcha:_}=oe(),e=L({username:"",mobile:"",code:"",password:"",confirmPassword:""}),h=P(()=>{const{formRules:t,createConfirmPwdRule:o}=T();return{username:t.username,mobile:t.mobile,password:t.password,code:t.code,confirmPassword:o(e.password)}});async function w(){var i,d;await y();const{data:t,error:o}=await ge(e.username,e.mobile,e.code,e.password,e.confirmPassword);console.log("data",t),o?(d=window.$message)==null||d.error(c("page.login.common.validateFail")):((i=window.$message)==null||i.success(c("page.login.common.validateSuccess")),g("pwd-login"))}return(t,o)=>{const i=W,d=q,v=A,b=K,I=G;return k(),F(I,{ref_key:"formRef",ref:l,model:e,rules:h.value,size:"large","show-label":!1},{default:p(()=>[s(d,{path:"username"},{default:p(()=>[s(i,{value:e.username,"onUpdate:value":o[0]||(o[0]=m=>e.username=m),placeholder:n(c)("page.login.common.userNamePlaceholder")},null,8,["value","placeholder"])]),_:1}),s(d,{path:"mobile"},{default:p(()=>[s(i,{value:e.mobile,"onUpdate:value":o[1]||(o[1]=m=>e.mobile=m),placeholder:n(c)("page.login.common.mobilePlaceholder")},null,8,["value","placeholder"])]),_:1}),s(d,{path:"code"},{default:p(()=>[N("div",De,[s(i,{value:e.code,"onUpdate:value":o[2]||(o[2]=m=>e.code=m),placeholder:n(c)("page.login.common.codePlaceholder")},null,8,["value","placeholder"]),s(v,{size:"large",disabled:n(f),loading:n(u),onClick:o[3]||(o[3]=m=>n(_)(e.mobile,1))},{default:p(()=>[S(C(n(a)),1)]),_:1},8,["disabled","loading"])])]),_:1}),s(d,{path:"password"},{default:p(()=>[s(i,{value:e.password,"onUpdate:value":o[4]||(o[4]=m=>e.password=m),type:"password","show-password-on":"click",placeholder:n(c)("page.login.common.passwordPlaceholder")},null,8,["value","placeholder"])]),_:1}),s(d,{path:"confirmPassword"},{default:p(()=>[s(i,{value:e.confirmPassword,"onUpdate:value":o[5]||(o[5]=m=>e.confirmPassword=m),type:"password","show-password-on":"click",placeholder:n(c)("page.login.common.confirmPasswordPlaceholder")},null,8,["value","placeholder"])]),_:1}),s(b,{vertical:"",size:18,class:"w-full"},{default:p(()=>[s(v,{type:"primary",size:"large",round:"",block:"",onClick:w},{default:p(()=>[S(C(n(c)("common.confirm")),1)]),_:1}),s(v,{size:"large",round:"",block:"",onClick:o[6]||(o[6]=m=>n(g)("pwd-login"))},{default:p(()=>[S(C(n(c)("page.login.common.back")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])}}}),je={class:"w-400px lt-sm:w-300px"},Ve={class:"flex-y-center justify-center"},Oe={key:0,src:M,alt:"Linkqi",style:{width:"64px",position:"absolute",left:"20px"}},Te={key:1,src:M,alt:"Linkqi",style:{width:"64px",position:"absolute",left:"20px"}},We={key:2,class:"text-28px text-primary font-500 lt-sm:text-22px",style:{color:"#fff","text-align":"center"}},qe={key:3,class:"text-28px text-primary font-500 lt-sm:text-22px",style:{color:"#fff","text-align":"center"}},Ae={class:"pt-24px"},Ke={class:"pt-24px"},Ge={class:"flex justify-center items-center",style:{position:"fixed",top:"20px",right:"20px","z-index":"999"}},He={key:0,src:M,alt:"Linkqi",class:"w-100px pr-10px"},Xe={key:1,src:M,alt:"Linkqi",class:"w-100px pr-10px"},Je={key:2,style:{color:"#fff","font-size":"1.2rem","font-weight":"500"}},Qe={key:3,style:{color:"#fff","font-size":"1.2rem","font-weight":"500"}},Ye={key:0,style:{color:"#fff",position:"fixed",left:"50%",bottom:"5%",transform:"translateX(-50%)","font-size":"1rem","z-index":"999"}},Ze={key:1,style:{color:"#fff",position:"fixed",left:"50%",bottom:"5%",transform:"translateX(-50%)","font-size":"1rem","z-index":"999"}},eo=z({name:"login",__name:"index",props:{module:{}},setup(r){const g=r;_e();const l=we(),y={"pwd-login":{label:B["pwd-login"],component:Fe},register:{label:B.register,component:Be},"reset-pwd":{label:B["reset-pwd"],component:Ee}},a=P(()=>y[g.module||"pwd-login"]),f=P(()=>l.darkMode?E(l.themeColor,600):l.themeColor),u=P(()=>{const h="#ffffff",w=l.darkMode?.5:.2;return he(h,l.themeColor,w)}),_=Y();return(async()=>{fetch("/version.json").then(h=>h.json()).then(h=>{_.value=h}).catch(h=>{console.error("Error fetching version.json:",h)})})(),(h,w)=>{var i,d;const t=Ie,o=xe;return k(),x("div",{class:"relative size-full flex-center overflow-hidden login",style:ke({backgroundColor:u.value})},[s(t,{"theme-color":f.value},null,8,["theme-color"]),s(o,{bordered:!1,class:"relative z-4 w-auto rd-12px loginClass"},{default:p(()=>[N("div",je,[N("header",Ve,[n(l).darkMode?(k(),x("img",Te)):(k(),x("img",Oe)),n(l).darkMode?(k(),x("h3",We,C(n(c)("system.title")),1)):(k(),x("h3",qe,C(n(c)("system.title")),1))]),N("main",Ae,[N("div",Ke,[s(ve,{name:n(l).page.animateMode,mode:"out-in",appear:""},{default:p(()=>[(k(),F(ye(a.value.component)))]),_:1},8,["name"])])])])]),_:1}),N("div",Ge,[n(l).darkMode?(k(),x("img",Xe)):(k(),x("img",He)),n(l).darkMode?(k(),x("span",Je,C(((i=_.value)==null?void 0:i.ver)||"V1.1.6"),1)):(k(),x("span",Qe,C(((d=_.value)==null?void 0:d.ver)||"V1.1.6"),1))]),n(l).darkMode?Q("",!0):(k(),x("div",Ye," Copyright (c) 2024 · 杭州领祺科技有限公司")),n(l).darkMode?(k(),x("div",Ze," Copyright (c) 2024 · 杭州领祺科技有限公司")):Q("",!0)],4)}}}),so=Z(eo,[["__scopeId","data-v-dd125955"]]);export{so as default};

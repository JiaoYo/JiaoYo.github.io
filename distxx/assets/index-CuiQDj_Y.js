import{_ as P}from"./save-outline-CfmZpZwL.js";import{_ as $}from"./round-search-C_gAF5H8.js";import{d as N,r as E,bq as g,i as f,o as v,b as M,f as l,w as s,g as V,h as y,B as x,a8 as h,t as k,c as S,aA as u,a5 as o,ab as j,E as z,X as G}from"./index-HZqiqJ25.js";import{G as q,h as A}from"./control_management-CKO6n_1_.js";import{_ as O}from"./DatePicker-D8jXcua0.js";import{_ as X}from"./DataTable-BUWIQkps.js";import"./Forward-BjHo1o6m.js";import"./RadioGroup-BNp-M84I.js";const F={class:"min-h-500px flex-col-stretch gap-16px lt-sm:overflow-auto"},Z=N({name:"stationmanagement_reportingdatarestrictions",__name:"index",setup(H){const m=E({dateTime:g(0,Date.now()),type:1}),r=f(!1);let d=f([]);const c=async()=>{r.value=!0,d.value=[];const{data:e,error:t}=await q({date:m.dateTime});if(!t){e.forEach(a=>{a.manuPower=a.manuPower?a.manuPower:null,a.maxValue=a.maxValue?a.maxValue:null,a.minValue=a.minValue?a.minValue:null});for(let a=0;a<e.length;a+=3)d.value.push(e.slice(a,a+3));r.value=!1}};c();const b=f(0),w=e=>{m.dateTime=g(0,e),c()},U=async()=>{var n,p;let e=d.value.flat();if(e=e.filter(i=>i.maxValue!=null||i.minValue!=null),e.length==0)return(n=window.$message)==null?void 0:n.warning("请填写数据");const{data:t,error:a}=await A(e);a||((p=window.$message)==null||p.success("设置成功"),c())},D=[{title:"时间",key:"dbtime",render:e=>{var t;return l("span",null,[(t=e[0])==null?void 0:t.dbtime])}},{title:"上限值",key:"maxValue",render(e){var t,a;return((t=e[0])==null?void 0:t.dbtime)&&u(o,{value:(a=e[0])==null?void 0:a.maxValue,onUpdateValue(n){e[0].maxValue=n}})}},{title:"下限值",key:"minValue",render(e){var t,a;return((t=e[0])==null?void 0:t.dbtime)&&u(o,{value:(a=e[0])==null?void 0:a.minValue,onUpdateValue(n){e[0].minValue=n}})}},{title:"时间",key:"key",render:e=>{var t;return l("span",null,[(t=e[1])==null?void 0:t.dbtime])}},{title:"上限值",key:"value",render(e){var t,a;return((t=e[1])==null?void 0:t.dbtime)&&u(o,{value:(a=e[1])==null?void 0:a.maxValue,onUpdateValue(n){e[1].maxValue=n}})}},{title:"下限值",key:"value",render(e){var t,a;return((t=e[1])==null?void 0:t.dbtime)&&u(o,{value:(a=e[1])==null?void 0:a.minValue,onUpdateValue(n){e[1].minValue=n}})}},{title:"时间",key:"key",render:e=>{var t;return l("span",null,[(t=e[2])==null?void 0:t.dbtime])}},{title:"上限值",key:"maxValue",render(e){var t;return((t=e[2])==null?void 0:t.dbtime)&&u(o,{value:e[2].maxValue,onUpdateValue(a){e[2].maxValue=a}})}},{title:"下限值",key:"minValue",render(e){var t,a;return((t=e[2])==null?void 0:t.dbtime)&&u(o,{value:(a=e[2])==null?void 0:a.minValue,onUpdateValue(n){e[2].minValue=n}})}}];return(e,t)=>{const a=O,n=$,p=j,i=z,C=P,T=X,B=G;return v(),M("div",F,[l(B,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:s(()=>[l(i,{align:"center",wrap:"",justify:"start",class:"lt-sm:w-200px"},{default:s(()=>[V(" 上报数据限制 "),l(p,null,{default:s(()=>[l(a,{"formatted-value":m.dateTime,"onUpdate:formattedValue":t[0]||(t[0]=_=>m.dateTime=_),"value-format":"yyyy-MM-dd",type:"date","onUpdate:value":w,style:{width:"200px"}},null,8,["formatted-value"]),l(y(x),{type:"primary",ghost:"",onClick:c},{icon:s(()=>[l(n,{class:h(["text-icon",{"animate-spin":r.value}])},null,8,["class"])]),default:s(()=>[V(" "+k(e.$t("common.search")),1)]),_:1})]),_:1})]),_:1})]),"header-extra":s(()=>[l(i,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:s(()=>[l(y(x),{onClick:U,ghost:"",type:"primary"},{icon:s(()=>[l(C,{class:h(["text-icon",{"animate-spin":r.value}])},null,8,["class"])]),default:s(()=>[V(" "+k(e.$t("common.save")),1)]),_:1})]),_:1})]),default:s(()=>[(v(),S(T,{columns:D,data:y(d),bordered:!1,"flex-height":!0,class:"sm:h-full","row-key":_=>_.id,key:b.value,loading:r.value},null,8,["data","row-key","loading"]))]),_:1})])}}});export{Z as default};

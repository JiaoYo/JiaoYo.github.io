import{d as I,Z as O,a1 as B,N as P,p as A,a0 as G,i as z,bq as i,o as h,c as v,w as n,f as o,h as a,$ as S,a3 as q,S as N,g as W,t as C,y as L,a4 as j,B as X,E as Z,F as H,X as K,l as J,s as Q,bj as Y,b as ee,a9 as E,e as te}from"./index-BfAsC10q.js";import{f as ae}from"./data_report-uqL7ArkM.js";import{u as oe,a as ne}from"./table-DlIAyHtY.js";import{_ as le}from"./export-BLR5fApd.js";import{_ as re}from"./round-search-Bax3PIKr.js";import{_ as se}from"./DatePicker-BI-GK2N9.js";import{_ as ie}from"./FormItemGridItem-CM5zeY-x.js";import{_ as me}from"./Grid-C5N5wDNZ.js";import{_ as pe}from"./DataTable-DAbQR8IX.js";import"./Forward-Cz-tjaGb.js";import"./RadioGroup-BmSMxSTA.js";const de=I({name:"AlarmSearch",__name:"search",props:{model:{required:!0},modelModifiers:{}},emits:O(["reset","search","exportData"],["update:model"]),setup($,{emit:T}){B({1:"电场1",2:"电场2",3:"电场3"});const l=B({day:"日报",month:"月报",year:"年报"}),f=T,g=P(),{formRef:x,restoreValidation:F}=A(),t=G($,"model");t.value.time=z([Number(i(5,Date.now()-864e5*6)),Number(i(5,Date.now()+864e5))]),t.value.startTime=i(0,Date.now()-864e5*6),t.value.endTime=i(0,Date.now()+864e5),t.value.reportType="day";async function r(m,s){t.value.startTime=m[0],t.value.endTime=m[1]}async function k(){var m;if(!t.value.electricFieId){(m=window.$message)==null||m.warning("请选择电场后在进行查询");return}f("search")}const U=()=>{f("exportData")},V=m=>{t.value.reportType=m,f("search")};return(m,s)=>{const R=j,d=ie,w=se,M=re,_=X,D=le,u=Z,e=me,c=H,b=K;return h(),v(b,{bordered:!1,size:"small",class:"card-wrapper"},{default:n(()=>[o(c,{ref_key:"formRef",ref:x,model:t.value,"label-placement":"left","label-width":a(g).locale=="en-US"?120:80,"show-feedback":!1,onKeyup:L(k,["enter"])},{default:n(()=>[o(e,{"y-gap":16,responsive:"screen","item-responsive":""},{default:n(()=>[o(d,{span:"24 s:12 m:4",label:a(S)("page.datareport.reportType"),path:"reportType",class:"pr-24px"},{default:n(()=>[o(R,{filterable:"",placeholder:"请选择报表类型",value:t.value.reportType,"onUpdate:value":s[0]||(s[0]=p=>t.value.reportType=p),options:a(q)(a(l)),onUpdateValue:V},null,8,["value","options"])]),_:1},8,["label"]),o(d,{span:"24 s:12 m:6",label:"时间",path:"time",class:"pr-24px"},{default:n(()=>[t.value.reportType=="day"?(h(),v(w,{key:0,value:t.value.time,"onUpdate:value":s[1]||(s[1]=p=>t.value.time=p),type:"daterange","value-format":"yyyy-MM-dd","onUpdate:formattedValue":r},null,8,["value"])):N("",!0),t.value.reportType=="month"?(h(),v(w,{key:1,value:t.value.time,"onUpdate:value":s[2]||(s[2]=p=>t.value.time=p),type:"monthrange","value-format":"yyyy-MM",style:{width:"100%"},"onUpdate:formattedValue":r},null,8,["value"])):N("",!0),t.value.reportType=="year"?(h(),v(w,{key:2,value:t.value.time,"onUpdate:value":s[3]||(s[3]=p=>t.value.time=p),type:"yearrange","value-format":"yyyy",style:{width:"100%"},"onUpdate:formattedValue":r},null,8,["value"])):N("",!0)]),_:1}),o(d,{span:"24 s:12 m:6",class:"pr-24px"},{default:n(()=>[o(u,{class:"w-full"},{default:n(()=>[o(_,{type:"primary",ghost:"",onClick:k},{icon:n(()=>[o(M,{class:"text-icon"})]),default:n(()=>[W(" "+C(a(S)("common.search")),1)]),_:1}),o(_,{onClick:U},{icon:n(()=>[o(D,{class:"text-icon"})]),default:n(()=>[W(" "+C(a(S)("common.export")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","label-width"])]),_:1})}}}),ue={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},De=I({name:"datareport_cumulativereport",__name:"index",setup($){const T=P(),{columns:l,columnChecks:f,data:g,getData:x,loading:F,mobilePagination:t,searchParams:r,resetSearchParams:k}=oe({apiFn:ae,apiParams:{page:1,pageSize:20,limit:20,startTime:i(0,Date.now()-864e5*6),endTime:i(0,Date.now()+864e5),electricFieId:J.get("powerStationId"),reportType:"day",_t:new Date().getTime()},immediate:!1,showTotal:!0,columns:()=>[{key:"timeFrame",title:"时间",align:"center",width:160},{key:"k001",title:"日平均风速(米/秒)",align:"center",minWidth:180},{key:"k002",title:"日平均辐射度(W/㎡)",align:"center",width:160},{key:"k003",title:"日最大辐射度(W/㎡)",align:"center",minWidth:180},{key:"k004",title:"日有效利用时间(小时)",align:"center",width:160},{key:"k005",title:"日累计发电量(兆瓦)",align:"center",width:160},{key:"k006",title:"日最大功率(兆瓦)",align:"center",width:160},{key:"k007",title:"日最大功率时间",align:"center",minWidth:200}]}),{drawerVisible:U,operateType:V,editingData:m,handleAdd:s,handleEdit:R,checkedRowKeys:d,onBatchDeleted:w,onDeleted:M}=ne(g,x),_=e=>{e.detail.key};Q(()=>{window.addEventListener("localStorageChanged",_)}),Y(()=>{window.removeEventListener("localStorageChanged",_)});const D=(e=r.reportType)=>{l.value[1].title=`${e=="day"?"日":e=="month"?"月":"年"}平均风速(米/秒)`,l.value[2].title=`${e=="day"?"日":e=="month"?"月":"年"}平均辐射度(W/㎡)`,l.value[3].title=`${e=="day"?"日":e=="month"?"月":"年"}最大辐射度(W/㎡)`,l.value[4].title=`${e=="day"?"日":e=="month"?"月":"年"}有效利用时间(小时)`,l.value[5].title=`${e=="day"?"日":e=="month"?"月":"年"}累计发电量(兆瓦)`,l.value[6].title=`${e=="day"?"日":e=="month"?"月":"年"}最大功率(兆瓦)`,l.value[7].title=`${e=="day"?"日":e=="month"?"月":"年"}最大功率时间`,u.value[0].timeFrame=i(e=="day"?0:e=="month"?3:4,Date.now()-864e5*5),u.value[1].timeFrame=i(e=="day"?0:e=="month"?3:4,Date.now()-864e5*6)};let u=z([]);return u.value=[{id:"1",timeFrame:i(0,Date.now()-864e5*5),k001:"2.36",k002:"821",k003:"850",k004:"3.5",k005:"240",k006:"260",k007:"14:00"},{id:"2",timeFrame:i(0,Date.now()-864e5*6),k001:"3.54",k002:"670.02",k003:"720.8",k004:"5",k005:"265",k006:"300",k007:"13:37"}],(e,c)=>{const b=pe,p=K;return h(),ee("div",ue,[o(de,{model:a(r),"onUpdate:model":c[0]||(c[0]=y=>E(r)?r.value=y:null),onReset:a(k),onSearch:D},null,8,["model","onReset"]),o(p,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:n(()=>[te("span",null," 光伏电厂累计"+C(a(r).reportType=="day"?"日":a(r).reportType=="month"?"月报":"年报"),1)]),default:n(()=>[o(b,{"checked-row-keys":a(d),"onUpdate:checkedRowKeys":c[1]||(c[1]=y=>E(d)?d.value=y:null),columns:a(l),data:a(u),size:"small","flex-height":!a(T).isMobile,"scroll-x":702,loading:a(F),remote:"","row-key":y=>y.id,class:"sm:h-full",pagination:a(g).length?a(t):void 0},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1})])}}});export{De as default};

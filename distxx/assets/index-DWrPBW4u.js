import{_ as X}from"./table-column-setting.vue_vue_type_script_setup_true_lang-C5rtfvJ5.js";import{_ as Z}from"./round-delete-BfqkMPxe.js";import{_ as H}from"./round-add-DUJXnBlA.js";import{d as E,Z as A,a0 as J,r as L,p as Q,a2 as F,a as W,$ as p,o as G,c as Y,w as l,f as e,g as v,t as N,h as i,a3 as ee,A as te,a5 as ae,a4 as le,F as oe,B as w,E as K,a6 as ne,b as ie,a8 as R,a9 as B,aa as se,X as re}from"./index-BfAsC10q.js";import{j as de,k as pe,l as ue,m as V}from"./control_management-BbojwRFH.js";import{u as ce,a as me}from"./table-DlIAyHtY.js";import{f as _e,b as fe}from"./station-kkDH44NI.js";import{_ as ve}from"./FormItemGridItem-CM5zeY-x.js";import{_ as ge}from"./Grid-C5N5wDNZ.js";import{N as I}from"./Popconfirm-DB_vq6iQ.js";import{_ as we}from"./DataTable-DAbQR8IX.js";import"./RadioGroup-BmSMxSTA.js";import"./Forward-Cz-tjaGb.js";const ye=E({name:"PhotovoltaicModel",__name:"pvmodule_model",props:A({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:A(["submitted"],["update:visible"]),setup(m,{emit:D}){const c=J(m,"visible"),y=D,u=m,t=L(b());function b(){return{model:"",capacity:void 0,maxvol:void 0,maxcru:void 0,openvol:void 0,shortcur:void 0,workeff:void 0,rttmed:0,inclination:void 0,area:void 0,solarpanel:void 0}}function U(){Object.assign(t,b()),u.operateType==="edit"&&u.rowData&&Object.assign(t,u.rowData)}const{formRef:P,validate:g,restoreValidation:C}=Q();F(()=>u.rowData,()=>{U()}),F(c,()=>{c.value&&(U(),C())});const h=()=>{c.value=!1},T=async()=>{var f;if(await g(),u.operateType==="add"){const{data:o,error:_}=await de([t]);if(_)return}else{const{data:o,error:_}=await pe([t]);if(_)return}(f=window.$message)==null||f.success(u.operateType==="add"?"添加成功":"修改成功"),h(),y("submitted")},M={type:"string",required:!0,message:"不能为空",trigger:["input","blur"]},r={type:"number",required:!0,message:"不能为空",trigger:["input","blur"]},O={model:M,capacity:r,maxvol:r,maxcru:r,openvol:r,shortcur:r,workeff:r,rttmed:r,inclination:r,area:r,solarpanel:r},k=W(()=>({add:p("common.add"),edit:p("common.edit")})[u.operateType]);return(f,o)=>{const _=te,n=ve,s=ae,d=le,S=ge,z=oe,x=w,j=K,$=ne;return G(),Y($,{show:c.value,"onUpdate:show":o[11]||(o[11]=a=>c.value=a),title:k.value,preset:"card",class:"w-50%"},{footer:l(()=>[e(j,{size:16,justify:"center"},{default:l(()=>[e(x,{onClick:h,class:"w-100px"},{default:l(()=>[v(N(i(p)("common.cancel")),1)]),_:1}),e(x,{type:"primary",class:"w-100px",onClick:T},{default:l(()=>[v(N(i(p)("common.confirm")),1)]),_:1})]),_:1})]),default:l(()=>[e(z,{ref_key:"formRef",ref:P,model:t,rules:O,"label-placement":"left","label-width":180,"require-mark-placement":"left"},{default:l(()=>[e(S,{responsive:"screen","item-responsive":""},{default:l(()=>[e(n,{span:"24 m:12",label:"组件型号",path:"model"},{default:l(()=>[e(_,{clearable:"",value:t.model,"onUpdate:value":o[0]||(o[0]=a=>t.model=a),placeholder:"请输入"},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"组件容量",path:"capacity"},{default:l(()=>[e(s,{clearable:"",value:t.capacity,"onUpdate:value":o[1]||(o[1]=a=>t.capacity=a),placeholder:"请输入",style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"最大工作电压",path:"maxvol"},{default:l(()=>[e(s,{clearable:"",value:t.maxvol,"onUpdate:value":o[2]||(o[2]=a=>t.maxvol=a),placeholder:"请输入",style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"最大工作电流",path:"maxcru"},{default:l(()=>[e(s,{clearable:"",value:t.maxcru,"onUpdate:value":o[3]||(o[3]=a=>t.maxcru=a),placeholder:"请输入",style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"开路电压",path:"openvol"},{default:l(()=>[e(s,{clearable:"",value:t.openvol,"onUpdate:value":o[4]||(o[4]=a=>t.openvol=a),placeholder:"请输入",style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"短路电流",path:"shortcur"},{default:l(()=>[e(s,{clearable:"",value:t.shortcur,"onUpdate:value":o[5]||(o[5]=a=>t.shortcur=a),placeholder:"请输入",style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"工作效率",path:"workeff"},{default:l(()=>[e(s,{clearable:"",value:t.workeff,"onUpdate:value":o[6]||(o[6]=a=>t.workeff=a),placeholder:"请输入",style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"固定角度",path:"rttmed"},{default:l(()=>[e(d,{filterable:"",placeholder:"选择",value:t.rttmed,"onUpdate:value":o[7]||(o[7]=a=>t.rttmed=a),options:i(ee)(i(_e))},null,8,["value","options"])]),_:1}),e(n,{span:"24 m:12",label:"安装倾斜度",path:"inclination"},{default:l(()=>[e(s,{clearable:"",value:t.inclination,"onUpdate:value":o[8]||(o[8]=a=>t.inclination=a),placeholder:"请输入",style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"组件面积",path:"area"},{default:l(()=>[e(s,{clearable:"",value:t.area,"onUpdate:value":o[9]||(o[9]=a=>t.area=a),placeholder:"请输入",style:{width:"100%"}},null,8,["value"])]),_:1}),e(n,{span:"24 m:12",label:"电池板个数",path:"solarpanel"},{default:l(()=>[e(s,{clearable:"",value:t.solarpanel,"onUpdate:value":o[10]||(o[10]=a=>t.solarpanel=a),placeholder:"请输入",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title"])}}}),be={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function q(m){return typeof m=="function"||Object.prototype.toString.call(m)==="[object Object]"&&!se(m)}const Be=E({name:"stationmanagement_pvmodulesetup",__name:"index",setup(m){const{columns:D,columnChecks:c,data:y,getData:u,loading:t,mobilePagination:b,searchParams:U,resetSearchParams:P}=ce({apiFn:ue,apiParams:{page:1,pageSize:20,limit:20,fuzzy:null,_t:new Date().getTime()},immediate:!0,showTotal:!0,columns:()=>[{type:"selection",align:"center",width:48},{key:"model",title:"组件型号",align:"center",width:140},{key:"capacity",title:"组件容量",align:"center",width:100},{key:"maxvol",title:"最大工作电压",align:"center",width:140},{key:"maxcru",title:"最大工作电流",align:"center",width:140},{key:"openvol",title:"开路电压",align:"center",width:100},{key:"shortcur",title:"短路电流",align:"center",width:100},{key:"workeff",title:"工作效率",align:"center",width:100},{key:"rttmed",title:"固定角度",align:"center",width:100,render:n=>e("span",null,[p(fe[n.rttmed])])},{key:"inclination",title:"安装倾斜度",align:"center",width:100},{key:"area",title:"组件面积",align:"center",width:100},{key:"solarpanel",title:"电池板数量",align:"center",width:100},{key:"operate",title:p("common.operate"),align:"center",width:200,fixed:"right",render:n=>{let s;return e("div",{class:"flex-center gap-8px"},[e(w,{type:"primary",ghost:!0,size:"small",onClick:()=>_(n.id)},q(s=p("common.edit"))?s:{default:()=>[s]}),e(I,{onPositiveClick:()=>o(n.id)},{default:()=>p("common.confirmDelete"),trigger:()=>{let d;return e(w,{type:"error",ghost:!0,size:"small"},q(d=p("common.delete"))?d:{default:()=>[d]})}})])}}]}),{drawerVisible:g,operateType:C,editingData:h,handleAdd:T,handleEdit:M,checkedRowKeys:r,onBatchDeleted:O,onDeleted:k}=me(y,u),f=async()=>{const n=r.value.join(","),{data:s,error:d}=await V({ids:n});d||(k(),r.value=[])},o=async n=>{const{data:s,error:d}=await V({ids:n});d||k()},_=n=>{M(n)};return(n,s)=>{const d=K,S=H,z=Z,x=X,j=we,$=re;return G(),ie("div",be,[e($,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{header:l(()=>[e(d,{align:"center",wrap:"",justify:"start",class:"lt-sm:w-200px"},{default:l(()=>[v(" 光伏组件设置 ")]),_:1})]),"header-extra":l(()=>[e(d,{align:"center",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:l(()=>[e(i(w),{onClick:i(T),size:"small",ghost:"",type:"primary"},{icon:l(()=>[e(S,{class:R(["text-icon",{"animate-spin":i(t)}])},null,8,["class"])]),default:l(()=>[v(" "+N(i(p)("common.add")),1)]),_:1},8,["onClick"]),e(i(I),{onPositiveClick:f},{trigger:l(()=>[e(i(w),{size:"small",ghost:"",type:"error",disabled:i(r).length==0},{icon:l(()=>[e(z,{class:R(["text-icon",{"animate-spin":i(t)}])},null,8,["class"])]),default:l(()=>[v(" "+N(i(p)("common.batchDelete")),1)]),_:1},8,["disabled"])]),default:l(()=>[v(" 确认删除选中的项吗？ ")]),_:1}),e(x,{columns:i(c),"onUpdate:columns":s[0]||(s[0]=a=>B(c)?c.value=a:null)},null,8,["columns"])]),_:1})]),default:l(()=>[e(j,{"checked-row-keys":i(r),"onUpdate:checkedRowKeys":s[1]||(s[1]=a=>B(r)?r.value=a:null),columns:i(D),data:i(y),size:"small",loading:i(t),remote:"","row-key":a=>a.id,pagination:i(b),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","loading","row-key","pagination"]),e(ye,{visible:i(g),"onUpdate:visible":s[2]||(s[2]=a=>B(g)?g.value=a:null),onSubmitted:i(u),"operate-type":i(C),"row-data":i(h)},null,8,["visible","onSubmitted","operate-type","row-data"])]),_:1})])}}});export{Be as default};

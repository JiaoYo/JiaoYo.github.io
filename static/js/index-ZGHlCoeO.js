import{u as e,_ as a}from"./useMyTable-Rwg0yCQy.js";import{_ as l}from"./AddUserModal.vue_vue_type_script_setup_true_lang-CzlcgUyN.js";import{u as t}from"./useDept-CFsazGNG.js";import{I as n,d as s,b as d,e as i,gc as r,o,f as u,h as c,w as p,g as m,H as g,B as y,c as f,i as b,Y as x,Q as h,G as w}from"./index-BCJ5rRXW.js";import{d as _,g as v}from"./user-BaRkQ_zf.js";import{u as k}from"./useDict-4oZ_IBDY.js";import"./vue-draggable-plus-DpVyg3hs.js";import"./regexp-D-rE1x7-.js";import"./role-BhpvTorU.js";import"./useForm-CKQ1L_Tz.js";import"./dict-CpA6Uc0s.js";const I={class:"gi_page user-manage"},j=s({name:"SystemUser",__name:"index",setup(s){const{data:j}=k({code:"status"}),S=d(),{deptList:C,getDeptList:D}=t({onSuccess:()=>{h((()=>{var e;null==(e=S.value)||e.expandAll(!0)}))}});D();const{tableData:V,getData:A,columns:U,searchParams:K,pagination:T,select:P,selectedKeys:z,selectAll:L,rowKey:M,loading:B,visible:E,handleEdit:F,handleAdd:R,closeVisible:G,successsDelete:H,operateType:N,editData:O,resetSearchParams:Q,columnChecks:Y}=e({apiFn:v,apiParams:{page:1,size:10,status:null,username:"",deptId:null},rowKey:"id",showtotal:!0,columns:[{title:"序号",dataIndex:"index",render:({rowIndex:e})=>c("span",null,[e+1])},{title:"用户名",dataIndex:"username"},{title:"头像",dataIndex:"avatar",align:"center",render:({record:e})=>c("img",{style:{width:"40px",height:"40px","border-radius":"50%"},src:e.avatar||"https://p1-arco.byteimg.com/tos-cn-i-uwbnlip3yd/a8c8cdb109cb051163646151a4a5083b.png~tplv-uwbnlip3yd-webp.webp",alt:""},null)},{title:"昵称",align:"center",dataIndex:"nickname"},{title:"状态",align:"center",dataIndex:"status",render:({record:e})=>c(i("a-tag"),{color:1==e.status?"green":"red"},{default:()=>[1==e.status?"正常":"禁用"]})},{title:"性别",align:"center",dataIndex:"gender",render:({record:e})=>c(i("a-tag"),null,{default:()=>[1==e.gender?"男":"女"]})},{title:"联系方式",align:"center",dataIndex:"phone"},{title:"部门",align:"center",dataIndex:"deptName"},{title:"创建时间",align:"center",dataIndex:"createTime"},{title:"操作",render:({record:e})=>c(i("a-space"),null,{default:()=>{return[(a="sys:user:edit",n().permissions.some((e=>a===e))&&c(i("a-button"),{icon:c(i("icon-edit"),null,null),type:"primary",size:"mini",onClick:()=>F(e.id)},{default:()=>[c("span",null,[w("编辑")])]})),c(i("a-popconfirm"),{type:"warning",content:"确定删除该用户吗?",onBeforeOk:()=>X(e.id)},{default:()=>[c(i("a-button"),{type:"primary",icon:c(i("icon-delete"),null,null),status:"danger",size:"mini",disabled:e.disabled},{default:()=>[c("span",null,[w("删除")])]})]})];var a}})}],formatResult:e=>(e.forEach((e=>{e.disabled=!!e.disabled})),e)}),q=d([]),J=e=>{if(K.deptId==e[0])return q.value=[],K.deptId=null,void A();K.deptId=e[0],A()},W=async()=>{if(!z.value.length)return x.warning("请选择用户！");await _({ids:z.value}),H()},X=async e=>{await _({ids:[e]}),H()};return(e,t)=>{const n=i("a-tree"),s=i("a-col"),d=i("icon-plus"),x=i("a-button"),h=i("a-select"),w=i("a-input"),_=i("a-input-group"),v=i("icon-search"),k=i("icon-refresh"),D=i("a-space"),F=i("icon-delete"),G=a,H=i("a-row"),X=i("a-table"),Z=i("a-card"),$=r("hasPerm");return o(),u("div",I,[c(Z,{title:"用户管理"},{default:p((()=>[c(H,{gutter:16},{default:p((()=>[c(s,{xs:0,md:6,lg:6,xl:6,xxl:4},{default:p((()=>[c(n,{ref_key:"treeRef",ref:S,"block-node":"","show-line":"","default-expand-all":"",data:m(C),"selected-keys":m(q),"onUpdate:selectedKeys":t[0]||(t[0]=e=>g(q)?q.value=e:null),"field-names":{key:"id",title:"name",children:"children"},onSelect:J},null,8,["data","selected-keys"])])),_:1}),c(s,{xs:24,md:18,lg:18,xl:18,xxl:20},{default:p((()=>[c(H,{justify:"space-between"},{default:p((()=>[c(D,{wrap:""},{default:p((()=>[y((o(),f(x,{type:"primary",onClick:m(R)},{icon:p((()=>[c(d)])),default:p((()=>[t[5]||(t[5]=b("span",null,"新增",-1))])),_:1},8,["onClick"])),[[$,["sys:btn:add"]]]),c(_,null,{default:p((()=>[c(h,{modelValue:m(K).status,"onUpdate:modelValue":t[1]||(t[1]=e=>m(K).status=e),options:m(j),placeholder:"用户状态","allow-clear":"",style:{width:"150px"}},null,8,["modelValue","options"]),c(w,{modelValue:m(K).username,"onUpdate:modelValue":t[2]||(t[2]=e=>m(K).username=e),placeholder:"输入用户名搜索","allow-clear":"",style:{"max-width":"250px"}},null,8,["modelValue"])])),_:1}),c(x,{type:"primary",onClick:m(A)},{icon:p((()=>[c(v)])),default:p((()=>[t[6]||(t[6]=b("span",null,"查询",-1))])),_:1},8,["onClick"]),c(x,{onClick:m(Q)},{icon:p((()=>[c(k)])),default:p((()=>[t[7]||(t[7]=b("span",null,"重置",-1))])),_:1},8,["onClick"])])),_:1}),c(D,{wrap:""},{default:p((()=>[c(x,{type:"primary",status:"danger",onClick:W,disabled:0===m(z).length},{icon:p((()=>[c(F)])),default:p((()=>[t[8]||(t[8]=b("span",null,"批量删除",-1))])),_:1},8,["disabled"]),c(G,{columns:m(Y),"onUpdate:columns":t[3]||(t[3]=e=>g(Y)?Y.value=e:null)},null,8,["columns"])])),_:1})])),_:1}),c(X,{columns:m(U),data:m(V),pagination:m(T),selectedKeys:m(z),onSelect:m(P),onSelectAll:m(L),"row-key":m(M),"row-selection":{type:"checkbox",showCheckedAll:!0},loading:m(B)},null,8,["columns","data","pagination","selectedKeys","onSelect","onSelectAll","row-key","loading"])])),_:1})])),_:1})])),_:1}),c(l,{operateType:m(N),editData:m(O),visible:m(E),"onUpdate:visible":t[4]||(t[4]=e=>g(E)?E.value=e:null),onSaveSuccess:m(A)},null,8,["operateType","editData","visible","onSaveSuccess"])])}}});export{j as default};

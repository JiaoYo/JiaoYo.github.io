import{V as e,L as a,a1 as t,b as n,M as l,Y as s,k as o}from"./index-Ds44FQ2x.js";import{h as i}from"./index-CPhqr4hp.js";function u(n,l={defaultPageSize:10}){const{breakpoint:s}=function(){const e=i({xs:576,sm:576,md:768,lg:992,xl:1200,xxl:1600}).current(),a=o((()=>e.value[e.value.length-1]||"xs"));return{breakpoint:a}}(),u=e({showPageSize:!0,showTotal:!0,current:1,pageSize:l.defaultPageSize,pageSizeOptions:[10,20,50,100],total:0,simple:!1,onChange:e=>{u.current=e,n&&n()},onPageSizeChange:e=>{u.current=1,u.pageSize=e,n&&n()}});a((()=>s.value),(()=>{u.simple=["xs"].includes(s.value),u.showTotal=!["xs"].includes(s.value)}),{immediate:!0});const r=u.onChange,c=u.onPageSizeChange;const{current:g,pageSize:d,total:v}=t(u);return{current:g,pageSize:d,total:v,pagination:u,changeCurrent:r,changePageSize:c,setTotal:function(e){u.total=e}}}function r(e,a){const{formatResult:t,onSuccess:o,immediate:i,rowKey:r}=a||{},{pagination:c,setTotal:g}=u((()=>h())),d=n(!1),v=n([]),p=n({});async function h(){try{d.value=!0;const a=await e({page:c.current,size:c.pageSize,...p.value}),n=a.data;v.value=t?t(n.list):n.list;const l=Array.isArray(a.data)?n.length:a.data.total;g(l),o&&o()}finally{d.value=!1}}(i??!0)&&h();const m=n([]);return{loading:d,tableData:v,getTableData:h,search:(e={})=>{p.value=e,m.value=[],c.onChange(1)},pagination:c,selectedKeys:m,select:e=>{m.value=e},selectAll:e=>{const a=r??"id",t=v.value.filter((e=>!(null==e?void 0:e.disabled)));m.value=e?t.map((e=>e[a])):[]},handleDelete:async(e,a)=>{const t=async()=>{try{const t=await e();return 200===t.status&&(s.success((null==a?void 0:a.message)||"删除成功！"),m.value=[],h()),t.success}catch(t){return!1}};if(!((null==a?void 0:a.showModal)??!0))return t();l.warning({title:(null==a?void 0:a.title)||"提示",content:(null==a?void 0:a.content)||"是否确认删除？",hideCancel:!1,maskClosable:!1,onBeforeOk:t})}}}export{r as u};

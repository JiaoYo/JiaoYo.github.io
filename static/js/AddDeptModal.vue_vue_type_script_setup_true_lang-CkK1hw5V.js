import{d as e,b as a,k as l,e as t,o as s,c as d,w as o,h as i,g as u,H as m,Y as r}from"./index-BxLtnPqY.js";import{u as n}from"./useForm-BJmYEhb2.js";import{u as c,g as p,s as f}from"./useDept-BUpgySNS.js";const v=e({__name:"AddDeptModal",emits:["save-success"],setup(e,{expose:v,emit:h}){const V=h,w=a(),b=a(""),x=a(!1),_=l((()=>!!b.value)),g=l((()=>_.value?"编辑部门":"新增部门")),{deptList:k,getDeptList:y}=c();y();const{form:U,resetForm:j}=n({id:"",pid:"",name:"",sort:0,status:1,description:""}),M={name:[{required:!0,message:"请输入部门名称"},{min:3,max:10,message:"长度在 3 - 10个字符"}]},D=()=>{var e;null==(e=w.value)||e.resetFields(),j()};v({add:()=>{b.value="",x.value=!0},edit:async e=>{k.value.length||await y(),b.value=e,x.value=!0;const a=await p(e);Object.assign(U,a.data)}});const F=async()=>{var e;try{if(await(null==(e=w.value)?void 0:e.validate()))return!1;await f(U),r.success((U.id?"编辑":"新增")+"成功"),V("save-success")}catch(a){return!1}};return(e,a)=>{const l=t("a-tree-select"),r=t("a-form-item"),n=t("a-input"),c=t("a-input-number"),p=t("a-textarea"),f=t("a-switch"),v=t("a-form"),h=t("a-modal");return s(),d(h,{visible:u(x),"onUpdate:visible":a[5]||(a[5]=e=>m(x)?x.value=e:null),title:u(g),width:"90%","modal-style":{maxWidth:"520px"},"mask-closable":!1,onBeforeOk:F,onClose:D},{default:o((()=>[i(v,{ref_key:"formRef",ref:w,model:u(U),rules:M,size:"medium","auto-label-width":""},{default:o((()=>[i(r,{label:"上级部门",field:"pid"},{default:o((()=>[i(l,{modelValue:u(U).pid,"onUpdate:modelValue":a[0]||(a[0]=e=>u(U).pid=e),"allow-clear":"",data:u(k),placeholder:"请选择上级部门","field-names":{key:"id",title:"name",children:"children"}},null,8,["modelValue","data"])])),_:1}),i(r,{label:"部门名称",field:"name"},{default:o((()=>[i(n,{modelValue:u(U).name,"onUpdate:modelValue":a[1]||(a[1]=e=>u(U).name=e),modelModifiers:{trim:!0},placeholder:"请输入部门名称","allow-clear":"","max-length":10},null,8,["modelValue"])])),_:1}),i(r,{label:"排序",field:"sort"},{default:o((()=>[i(c,{modelValue:u(U).sort,"onUpdate:modelValue":a[2]||(a[2]=e=>u(U).sort=e),style:{width:"120px"}},null,8,["modelValue"])])),_:1}),i(r,{label:"描述",field:"description"},{default:o((()=>[i(p,{modelValue:u(U).description,"onUpdate:modelValue":a[3]||(a[3]=e=>u(U).description=e),modelModifiers:{trim:!0},"max-length":200,placeholder:"请填写描述","auto-size":{minRows:3},"show-word-limit":""},null,8,["modelValue"])])),_:1}),i(r,{label:"状态",field:"status"},{default:o((()=>[i(f,{modelValue:u(U).status,"onUpdate:modelValue":a[4]||(a[4]=e=>u(U).status=e),type:"round","checked-value":1,"unchecked-value":0,"checked-text":"正常","unchecked-text":"禁用"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","title"])}}});export{v as _};

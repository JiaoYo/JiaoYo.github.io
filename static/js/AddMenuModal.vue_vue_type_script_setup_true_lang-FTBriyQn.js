import{_ as e}from"./index-Cz7P_fu5.js";import{d as l,k as a,P as d,z as t,b as u,gS as o,e as n,o as i,c as s,w as c,h as r,g as m,G as p,fT as f,fA as h,a as v,i as y,t as V,H as k,v as b,Y as _}from"./index-BxLtnPqY.js";import{g as x,s as g}from"./menu-4mfY8c9i.js";import{u as w}from"./useForm-BJmYEhb2.js";const U=l({__name:"AddMenuModal",props:{menus:{default:()=>[]}},emits:["save-success"],setup(l,{expose:U,emit:M}){const I=l,S=M,j=a((()=>{const e=JSON.parse(JSON.stringify(I.menus)),l=d(e,(e=>[1,2].includes(e.type)));return t.mapTree(l,(e=>({id:e.id,title:e.title,children:e.children})))})),q={xs:24,sm:24,md:12,lg:12,xl:12,xxl:12},A={xs:12,sm:12,md:8,lg:8,xl:8,xxl:8},T=u(),O=u(""),F=u(!1),N=a((()=>!!O.value)),z=a((()=>N.value?"编辑菜单":"新增菜单")),C=u(!1),{form:H,resetForm:J}=w({type:1,icon:"",svgIcon:"",title:"",sort:0,status:1,path:"",component:"",keepAlive:!1,hidden:!0,pid:"",redirect:"",breadcrumb:!0,showInTabs:!0,alwaysShow:!1,permission:"",affix:!1}),B=a((()=>o(H.path))),E={pid:[{required:!0,message:"请选择上级菜单"}],title:[{required:!0,message:"请输入菜单标题"}],path:[{required:!0,message:"请输入路由路径"}],component:[{required:!0,message:"请输入组件路径"}],permission:[{required:!0,message:"请输入权限标识"}]},G=a((()=>{if([1,2].includes(H.type)){const{title:e,path:l}=E;return{title:e,path:l}}if(3===H.type){const{pid:e,title:l,permission:a}=E;return{pid:e,title:l,permission:a}}return{}})),L=()=>{var e;null==(e=T.value)||e.clearValidate()},P=()=>{var e;null==(e=T.value)||e.resetFields(),J()};U({add:(e=1,l="")=>{H.type=e,H.pid=l,O.value="",F.value=!0},edit:async e=>{F.value=!0,O.value=e;const l=await x(e);Object.assign(H,l.data),H.sort=Number(H.sort),b(H.path)&&(C.value=!0)}});const R=async()=>{var e;try{H.pid=H.pid?H.pid:0,0==H.pid&&(H.component="Layout");if(await(null==(e=T.value)?void 0:e.validate()))return!1;let l={...H};N.value&&(l={...l,id:O.value}),await g(l),_.success((N.value?"编辑":"新增")+"成功"),S("save-success"),F.value=!1}catch(l){return!1}};return(l,a)=>{const d=n("a-radio"),t=n("a-radio-group"),u=n("a-form-item"),o=n("a-tree-select"),b=e,_=n("icon-question-circle-fill"),x=n("a-tooltip"),g=n("a-col"),w=n("a-row"),U=n("a-input"),M=n("a-tag"),I=n("a-switch"),S=n("a-input-number"),O=n("a-form"),J=n("a-modal");return i(),s(J,{visible:m(F),"onUpdate:visible":a[20]||(a[20]=e=>k(F)?F.value=e:null),title:m(z),width:"90%","modal-style":{maxWidth:"625px"},"body-style":{maxHeight:"70vh"},"mask-closable":!1,onBeforeOk:R,onClose:P},{default:c((()=>[r(O,{ref_key:"formRef",ref:T,model:m(H),rules:m(G),"auto-label-width":""},{default:c((()=>[r(u,{label:"菜单类型",field:"type"},{default:c((()=>[r(t,{modelValue:m(H).type,"onUpdate:modelValue":a[0]||(a[0]=e=>m(H).type=e),type:"button",disabled:m(N),onChange:L},{default:c((()=>[r(d,{value:1},{default:c((()=>a[21]||(a[21]=[p("目录")]))),_:1}),r(d,{value:2},{default:c((()=>a[22]||(a[22]=[p("菜单")]))),_:1}),r(d,{value:3},{default:c((()=>a[23]||(a[23]=[p("按钮")]))),_:1})])),_:1},8,["modelValue","disabled"])])),_:1}),r(u,{label:"上级菜单",field:"pid"},{default:c((()=>[r(o,{modelValue:m(H).pid,"onUpdate:modelValue":a[1]||(a[1]=e=>m(H).pid=e),placeholder:"请选择上级菜单","allow-clear":"","allow-search":"",disabled:m(N),data:m(j),"field-names":{key:"id",title:"title",children:"children"}},null,8,["modelValue","disabled","data"])])),_:1}),[1,2].includes(m(H).type)?(i(),s(w,{key:0,gutter:16},{default:c((()=>[r(g,f(h(q)),{default:c((()=>[r(u,{label:"自定义图标",field:"svgIcon"},{default:c((()=>[r(b,{modelValue:m(H).svgIcon,"onUpdate:modelValue":a[2]||(a[2]=e=>m(H).svgIcon=e),type:"custom"},null,8,["modelValue"]),r(x,{content:"优先显示"},{default:c((()=>[r(_,{size:18,style:{color:"rgba(var(--warning-6))","margin-left":"8px"}})])),_:1})])),_:1})])),_:1},16),r(g,f(h(q)),{default:c((()=>[r(u,{label:"菜单图标",field:"icon"},{default:c((()=>[r(b,{modelValue:m(H).icon,"onUpdate:modelValue":a[3]||(a[3]=e=>m(H).icon=e)},null,8,["modelValue"])])),_:1})])),_:1},16)])),_:1})):v("",!0),r(u,{label:"菜单标题",field:"title"},{default:c((()=>[r(U,{modelValue:m(H).title,"onUpdate:modelValue":a[4]||(a[4]=e=>m(H).title=e),modelModifiers:{trim:!0},placeholder:"请输入菜单标题","allow-clear":"","max-length":10},null,8,["modelValue"])])),_:1}),[1,2].includes(m(H).type)?(i(),s(u,{key:1,label:"路由路径",field:"path"},{extra:c((()=>[y("div",null,[a[24]||(a[24]=y("span",null,"路由名称由系统自动生成：",-1)),m(B)?(i(),s(M,{key:0},{default:c((()=>[p(V(m(B)),1)])),_:1})):v("",!0)])])),default:c((()=>[r(U,{modelValue:m(H).path,"onUpdate:modelValue":a[5]||(a[5]=e=>m(H).path=e),modelModifiers:{trim:!0},placeholder:"请输入路由路径","allow-clear":"","max-length":50},null,8,["modelValue"])])),_:1})):v("",!0),[1,2].includes(m(H).type)?(i(),s(u,{key:2,label:"重定向",field:"redirect"},{default:c((()=>[r(U,{modelValue:m(H).redirect,"onUpdate:modelValue":a[6]||(a[6]=e=>m(H).redirect=e),modelModifiers:{trim:!0},placeholder:"请输入重定向地址","allow-clear":"","max-length":50},null,8,["modelValue"])])),_:1})):v("",!0),[1,2].includes(m(H).type)?(i(),s(u,{key:3,label:"是否外链",field:"isExternalUrl"},{default:c((()=>[r(t,{modelValue:m(C),"onUpdate:modelValue":a[7]||(a[7]=e=>k(C)?C.value=e:null),type:"button"},{default:c((()=>[r(d,{value:!0},{default:c((()=>a[25]||(a[25]=[p("是")]))),_:1}),r(d,{value:!1},{default:c((()=>a[26]||(a[26]=[p("否")]))),_:1})])),_:1},8,["modelValue"])])),_:1})):v("",!0),2===m(H).type?(i(),s(u,{key:4,label:"组件路径",field:"component"},{default:c((()=>[m(C)?(i(),s(U,{key:0,modelValue:m(H).component,"onUpdate:modelValue":a[8]||(a[8]=e=>m(H).component=e),modelModifiers:{trim:!0},placeholder:"请输入组件路径","allow-clear":"","max-length":50},null,8,["modelValue"])):(i(),s(U,{key:1,modelValue:m(H).component,"onUpdate:modelValue":a[9]||(a[9]=e=>m(H).component=e),modelModifiers:{trim:!0},placeholder:"请输入组件路径","allow-clear":"","max-length":50},{prepend:c((()=>a[27]||(a[27]=[p("@/views/")]))),append:c((()=>a[28]||(a[28]=[p(".vue")]))),_:1},8,["modelValue"]))])),_:1})):v("",!0),[3].includes(m(H).type)?(i(),s(w,{key:5,gutter:16},{default:c((()=>[r(g,f(h(A)),{default:c((()=>[r(u,{label:"状态",field:"status"},{default:c((()=>[r(I,{modelValue:m(H).status,"onUpdate:modelValue":a[10]||(a[10]=e=>m(H).status=e),type:"round","checked-value":1,"unchecked-value":0,"checked-text":"启用","unchecked-text":"禁用"},null,8,["modelValue"])])),_:1})])),_:1},16)])),_:1})):v("",!0),[1,2].includes(m(H).type)?(i(),s(w,{key:6,gutter:16},{default:c((()=>[r(g,f(h(A)),{default:c((()=>[r(u,{label:"状态",field:"status"},{default:c((()=>[r(I,{modelValue:m(H).status,"onUpdate:modelValue":a[11]||(a[11]=e=>m(H).status=e),type:"round","checked-value":1,"unchecked-value":0,"checked-text":"启用","unchecked-text":"禁用"},null,8,["modelValue"])])),_:1})])),_:1},16),r(g,f(h(A)),{default:c((()=>[r(u,{label:"是否隐藏",field:"hidden"},{default:c((()=>[r(I,{modelValue:m(H).hidden,"onUpdate:modelValue":a[12]||(a[12]=e=>m(H).hidden=e),type:"round","checked-value":!0,"unchecked-value":!1,"checked-text":"是","unchecked-text":"否"},null,8,["modelValue"])])),_:1})])),_:1},16),r(g,f(h(A)),{default:c((()=>[r(u,{label:"是否缓存",field:"keepAlive"},{default:c((()=>[r(I,{modelValue:m(H).keepAlive,"onUpdate:modelValue":a[13]||(a[13]=e=>m(H).keepAlive=e),type:"round","checked-value":!0,"unchecked-value":!1,"checked-text":"是","unchecked-text":"否"},null,8,["modelValue"])])),_:1})])),_:1},16),r(g,f(h(A)),{default:c((()=>[r(u,{label:"面包屑",field:"breadcrumb"},{default:c((()=>[r(I,{modelValue:m(H).breadcrumb,"onUpdate:modelValue":a[14]||(a[14]=e=>m(H).breadcrumb=e),type:"round","checked-value":!0,"unchecked-value":!1,"checked-text":"显示","unchecked-text":"隐藏"},null,8,["modelValue"])])),_:1})])),_:1},16),r(g,f(h(A)),{default:c((()=>[1===m(H).type?(i(),s(u,{key:0,label:"总是显示",field:"alwaysShow"},{default:c((()=>[r(I,{modelValue:m(H).alwaysShow,"onUpdate:modelValue":a[15]||(a[15]=e=>m(H).alwaysShow=e),type:"round","checked-value":!0,"unchecked-value":!1,"checked-text":"显示","unchecked-text":"隐藏"},null,8,["modelValue"])])),_:1})):v("",!0),2===m(H).type?(i(),s(u,{key:1,label:"页签显示",field:"showInTabs"},{default:c((()=>[r(I,{modelValue:m(H).showInTabs,"onUpdate:modelValue":a[16]||(a[16]=e=>m(H).showInTabs=e),type:"round","checked-value":!0,"unchecked-value":!1,"checked-text":"显示","unchecked-text":"隐藏"},null,8,["modelValue"])])),_:1})):v("",!0)])),_:1},16),r(g,f(h(A)),{default:c((()=>[2===m(H).type?(i(),s(u,{key:0,label:"tabs默认显示",field:"affix"},{default:c((()=>[r(I,{modelValue:m(H).affix,"onUpdate:modelValue":a[17]||(a[17]=e=>m(H).affix=e),type:"round","checked-value":!0,"unchecked-value":!1,"checked-text":"显示","unchecked-text":"隐藏"},null,8,["modelValue"])])),_:1})):v("",!0)])),_:1},16)])),_:1})):v("",!0),3===m(H).type?(i(),s(u,{key:7,label:"权限标识",field:"permission"},{default:c((()=>[r(U,{modelValue:m(H).permission,"onUpdate:modelValue":a[18]||(a[18]=e=>m(H).permission=e),modelModifiers:{trim:!0},placeholder:"sys:btn:add","allow-clear":"","max-length":20},null,8,["modelValue"])])),_:1})):v("",!0),r(u,{label:"菜单排序",field:"sort"},{default:c((()=>[r(S,{modelValue:m(H).sort,"onUpdate:modelValue":a[19]||(a[19]=e=>m(H).sort=e),placeholder:"请输入菜单排序",min:1,mode:"button",style:{width:"120px"}},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["visible","title"])}}});export{U as _};

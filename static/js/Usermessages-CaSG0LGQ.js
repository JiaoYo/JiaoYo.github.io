import{d as e,b as t,I as s,L as a,e as n,o as r,f as o,F as i,j as l,t as u,a as c,g,h as m,i as d,w as f,G as v,c as w,_ as D}from"./index-Ds44FQ2x.js";const p=(e,t)=>{var s;let a=t[e]||[];return a=a.filter((e=>1!=e.status)),(null==(s=a[a.length-1])?void 0:s.message)||""},y=(e,t)=>{var s;let a=t[e]||[];if(a=a.filter((e=>1!=e.status)),0==a.length)return"";const n=(null==(s=a[a.length-1])?void 0:s.createTime)||"";if(x(n)){const e=new Date(n),t=e.getHours(),s=e.getMinutes();return` ${t<10?"0"+t:t}:${s<10?"0"+s:s}`}if(function(e){const t=new Date(e),s=new Date;t.setHours(0,0,0,0),s.setHours(0,0,0,0);const a=new Date(s);return a.setDate(a.getDate()-1),t.getTime()===a.getTime()}(n))return"昨天";if(_(n))return _(n);const r=new Date(n);return`${String(r.getFullYear()).slice(-2)}/${r.getMonth()+1}/${r.getDate()}`},k=(e,t)=>{var s;return null==(s=t.filter((t=>t.id==e))[0])?void 0:s.text};function x(e){const t=new Date(e),s=new Date;return t.setHours(0,0,0,0),s.setHours(0,0,0,0),t.getTime()===s.getTime()}function _(e){const t=new Date(e),s=new Date,a=s.getDay(),n=new Date(s);n.setDate(s.getDate()-a);const r=new Date(n);if(r.setDate(n.getDate()+7),t>=n&&t<=r){return`${["星期日","星期一","星期二","星期三","星期四","星期五","星期六"][t.getDay()]}`}return""}function h(e){const t=new Date,s=new Date(e),a=t.getTime()-s.getTime();return Math.floor(a/6e4)<=5}const I={key:0,class:"timeline"},T={key:1,class:"msgItem-left"},C={class:"msgBox"},b={key:0,class:"name"},$={key:2,class:"withdrawBox"},M=["onClick"],U={key:3,class:"msgItem-right"},H={class:"msgBox"},j={key:0,style:{"text-align":"center"}},S=D(e({__name:"Usermessages",props:{messages:{type:Array,default:[]}},emits:["withdraw","reEdit"],setup(e,{expose:D,emit:p}){const y=p,k=t(),_=s(),S=e;a(S.messages,(e=>{}));const z=(e,t)=>{var s;const a=null==(s=S.messages[t-1])?void 0:s.createTime;return a?!!function(e,t){const s=new Date(e),a=new Date(t);return Math.abs(a-s)/6e4>5}(a,e)&&(e=>{if(x(e)){const t=new Date(e),s=t.getHours(),a=t.getMinutes();return` ${s<10?"0"+s:s}:${a<10?"0"+a:a}`}return e})(e):e},B=e=>{e&&navigator.clipboard.writeText(e)},E=e=>{let t=document.createRange();t.selectNodeContents(e.target);let s=window.getSelection();null==s||s.removeAllRanges(),null==s||s.addRange(t)};return D({content:k}),(e,t)=>{const s=n("a-avatar"),a=n("a-doption"),D=n("a-dropdown");return r(),o("div",{class:"content",ref_key:"content",ref:k},[(r(!0),o(i,null,l(S.messages,((e,n)=>(r(),o("div",{class:"msgItem",key:e.id},[z(e.createTime,n)?(r(),o("div",I,u(z(e.createTime,n)),1)):c("",!0),e.formId==g(_).userInfo.id||e.status?c("",!0):(r(),o("div",T,[m(s,{size:40,imageUrl:e.formUrl,shape:"square"},null,8,["imageUrl"]),d("div",C,["room"==e.type?(r(),o("span",b,u(e.formName),1)):c("",!0),m(D,{trigger:"contextMenu",alignPoint:"",style:{display:"block"}},{content:f((()=>[m(a,{onClick:t=>B(e.message)},{default:f((()=>t[0]||(t[0]=[v("复制")]))),_:2},1032,["onClick"])])),default:f((()=>[d("span",{class:"text",onContextmenu:E},u(e.message),33)])),_:2},1024)])])),e.status?(r(),o("div",$,[d("span",null,[v(u(e.formId==g(_).userInfo.id?"你":`"${e.formName}"`)+"撤回了一条消息 ",1),e.formId==g(_).userInfo.id&&g(h)(e.createTime)?(r(),o("span",{key:0,class:"reEdit",onClick:t=>{return s=e.message,void y("reEdit",s);var s}},"重新编辑",8,M)):c("",!0)])])):c("",!0),e.formId!=g(_).userInfo.id||e.status?c("",!0):(r(),o("div",U,[d("div",H,[m(D,{trigger:"contextMenu",alignPoint:"",style:{display:"block"}},{content:f((()=>[g(h)(e.createTime)?(r(),w(a,{key:0,onClick:t=>{return s=e.id,void y("withdraw",s);var s}},{default:f((()=>t[1]||(t[1]=[v("撤回")]))),_:2},1032,["onClick"])):c("",!0),m(a,{onClick:t=>B(e.message)},{default:f((()=>t[2]||(t[2]=[v("复制")]))),_:2},1032,["onClick"])])),default:f((()=>[d("span",{class:"text",onContextmenu:E},u(e.message),33)])),_:2},1024)]),m(s,{size:40,imageUrl:g(_).userInfo.avatar,shape:"square"},null,8,["imageUrl"])]))])))),128)),0==S.messages.length?(r(),o("div",j,"暂无消息")):c("",!0)],512)}}}),[["__scopeId","data-v-d6c70438"]]),z=Object.freeze(Object.defineProperty({__proto__:null,default:S},Symbol.toStringTag,{value:"Module"}));export{y as L,S as U,p as a,z as b,k as f};

import{ae as e,af as t,ag as r,b as a,a3 as i,d as n,W as o,e as s,o as l,c as u,w as c,h as v,g as d,G as f,i as h}from"./index-7Ke4gaSZ.js";var p=/\s/;var m=/^\s+/;function b(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&p.test(e.charAt(t)););return t}(e)+1).replace(m,""):e}var g=NaN,w=/^[-+]0x[0-9a-f]+$/i,y=/^0b[01]+$/i,E=/^0o[0-7]+$/i,O=parseInt;function k(r){if("number"==typeof r)return r;if(e(r))return g;if(t(r)){var a="function"==typeof r.valueOf?r.valueOf():r;r=t(a)?a+"":a}if("string"!=typeof r)return 0===r?r:+r;r=b(r);var i=y.test(r);return i||E.test(r)?O(r.slice(2),i?2:8):w.test(r)?g:+r}var x=function(){return r.Date.now()},M="Expected a function",z=Math.max,W=Math.min;function R(e,r,a){var i,n,o,s,l,u,c=0,v=!1,d=!1,f=!0;if("function"!=typeof e)throw new TypeError(M);function h(t){var r=i,a=n;return i=n=void 0,c=t,s=e.apply(a,r)}function p(e){var t=e-u;return void 0===u||t>=r||t<0||d&&e-c>=o}function m(){var e=x();if(p(e))return b(e);l=setTimeout(m,function(e){var t=r-(e-u);return d?W(t,o-(e-c)):t}(e))}function b(e){return l=void 0,f&&i?h(e):(i=n=void 0,s)}function g(){var e=x(),t=p(e);if(i=arguments,n=this,u=e,t){if(void 0===l)return function(e){return c=e,l=setTimeout(m,r),v?h(e):s}(u);if(d)return clearTimeout(l),l=setTimeout(m,r),h(u)}return void 0===l&&(l=setTimeout(m,r)),s}return r=k(r)||0,t(a)&&(v=!!a.leading,o=(d="maxWait"in a)?z(k(a.maxWait)||0,r):o,f="trailing"in a?!!a.trailing:f),g.cancel=function(){void 0!==l&&clearTimeout(l),c=0,i=u=n=l=void 0},g.flush=function(){return void 0===l?s:b(x())},g}const C={defense:!0,color:"#c0c4cc",opacity:.5,size:16,family:"serif",angle:-20,width:300,height:200},T=a(document.body);function $(e=T){let t,r,a=null;const n={watermarkElMutationObserver:void 0,parentElMutationObserver:void 0,parentElResizeObserver:void 0},o=()=>{const t=e.value.tagName.toLowerCase()===T.value.tagName.toLowerCase(),r=t?"fixed":"absolute",i=t?"":"relative";a=document.createElement("div"),a.style.pointerEvents="none",a.style.top="0",a.style.left="0",a.style.position=r,a.style.zIndex="99999";const{clientWidth:n,clientHeight:o}=e.value;s({width:n,height:o}),e.value.style.position=i,e.value.appendChild(a)},s=(e={})=>{a&&(t&&(a.style.background=`url(${l()}) left top repeat`),e.width&&(a.style.width=`${e.width}px`),e.height&&(a.style.height=`${e.height}px`))},l=()=>{const{color:e,opacity:a,size:i,family:n,angle:o,width:s,height:l}=r,u=document.createElement("canvas");u.width=s,u.height=l;const c=u.getContext("2d");return c&&(c.fillStyle=e,c.globalAlpha=a,c.font=`${i}px ${n}`,c.rotate(Math.PI/180*o),c.fillText(t,0,l/2)),u.toDataURL()},u=()=>{if(e.value&&a){d();try{e.value.removeChild(a)}catch{}finally{a=null}}},c=R((()=>{u(),o(),v(e.value)}),100),v=e=>{r.defense?n.watermarkElMutationObserver||n.parentElMutationObserver||f(e):d("mutation"),n.parentElResizeObserver||h(e)},d=(e="all")=>{var t,r,a;"mutation"!==e&&"all"!==e||(null==(t=n.watermarkElMutationObserver)||t.disconnect(),n.watermarkElMutationObserver=void 0,null==(r=n.parentElMutationObserver)||r.disconnect(),n.parentElMutationObserver=void 0),"resize"!==e&&"all"!==e||(null==(a=n.parentElResizeObserver)||a.disconnect(),n.parentElResizeObserver=void 0)},f=e=>{const t=R((t=>{t.forEach(R((t=>{switch(t.type){case"attributes":t.target===a&&c();break;case"childList":t.removedNodes.forEach((t=>{t===a&&e.appendChild(a)}))}}),100))}),100);n.watermarkElMutationObserver=new MutationObserver(t),n.parentElMutationObserver=new MutationObserver(t),n.watermarkElMutationObserver.observe(a,{attributes:!0,childList:!1,subtree:!1}),n.parentElMutationObserver.observe(e,{attributes:!1,childList:!0,subtree:!1})},h=e=>{const t=R((()=>{const{clientWidth:t,clientHeight:r}=e;s({width:t,height:r})}),500);n.parentElResizeObserver=new ResizeObserver(t),n.parentElResizeObserver.observe(e)};return i((()=>{u()})),{setWatermark:(i,n={})=>{e.value&&(t=i,r={...C,...n},a?s():o(),v(e.value))},clearWatermark:u}}const _=n({__name:"index",setup(e){const t=a(),{setWatermark:r,clearWatermark:n}=$(t),{setWatermark:p,clearWatermark:m}=$();return o((()=>{r("水印",{color:"#409eff",defense:!1})})),i((()=>{})),(e,r)=>{const a=s("el-button"),i=s("el-card");return l(),u(i,{shadow:"never",class:"h-full"},{default:c((()=>[v(a,{onClick:r[0]||(r[0]=e=>d(p)("admin",{color:"#180e",width:200,height:200,opacity:.2}))},{default:c((()=>r[2]||(r[2]=[f("设置全屏水印")]))),_:1}),v(a,{onClick:r[1]||(r[1]=e=>d(m)())},{default:c((()=>r[3]||(r[3]=[f("清除水印")]))),_:1}),h("div",{ref_key:"divRef",ref:t,style:{width:"600px",height:"600px"}},null,512)])),_:1})}}});export{_};
